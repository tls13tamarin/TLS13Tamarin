theory TLS_13_lemmas begin

// Function signature and definition of the equational theory E

builtins: diffie-hellman
functions: Expand/3, Extract/2, fst/1, h/1, hmac/1, mac/1, mask/2,
           pair/2, pk/1, sdec/2, senc/2, sign/2, snd/1, true/0, unmask/2, verify/3
equations:
    fst(<x.1, x.2>) = x.1,
    sdec(senc(x.1, x.2), x.2) = x.1,
    snd(<x.1, x.2>) = x.2,
    unmask(mask(x, y), x) = y,
    unmask(mask(x, y), y) = x,
    verify(sign(x.1, x.2), x.1, pk(x.2)) = true

/*
looping facts with injective instances:
  DHExp/3, EarlySendStream/6, F_State_C1/29
*/

section{* TLS 1.3 *}

axiom Eq_check_succeed:
  "∀ x y #i. (Eq( x, y ) @ #i) ⇒ (x = y)"
  // safety formula

axiom Neq_check_succeed:
  "∀ x y #i. (Neq( x, y ) @ #i) ⇒ (¬(x = y))"
  // safety formula

axiom one_ltk:
  "∀ A x y #i #j.
    ((GenLtk( A, x ) @ #i) ∧ (GenLtk( A, y ) @ #j)) ⇒ (#i = #j)"
  // safety formula

axiom one_role_per_actor:
  "∀ actor tid tid2 role role2 #i #j.
    ((Start( tid, actor, role ) @ #i) ∧ (Start( tid2, actor, role2 ) @ #j)) ⇒
    (role = role2)"
  // safety formula

rule (modulo E) Register_pk:
   [ Fr( ~ltkA ) ]
  --[ GenLtk( $A, ~ltkA ), HonestUse( ~ltkA ) ]->
   [ !Ltk( $A, ~ltkA ), !Pk( $A, pk(~ltkA) ), Out( pk(~ltkA) ) ]

  /* has exactly the trivial AC variant */

rule (modulo E) Reveal_Ltk:
   [ !Ltk( $A, ~ltkA ) ] --[ RevLtk( $A ) ]-> [ Out( ~ltkA ) ]

  /* has exactly the trivial AC variant */

rule (modulo E) client_hello:
   [ Fr( ~nc ), Fr( ~x ) ]
  --[
  C0( ~nc ), Start( ~nc, $C, 'client' ),
  RIdentity( ~nc, $C, 'client', $C ), Neq( $g1, $g2 ), DH( ~nc, $C, ~x ),
  HonestUse( ~x ), HonestUse( $g1^~x )
  ]->
   [
   F_State_C1( ~nc, $C, $S, '0',
               <'0', '1', '0x0303', ~nc, '0', $cipher_suites, '0', <'43', '0x0304'>, 
                <'10', $g1, $g2>, <'13', $sig_algs>, '40', $g1, $g1^~x>,
               ~nc, '0', $g1, <$g1, $g2>, '0', ~x, '0', $g1^~x, '0', '0', 'na', '0',
               '0', Extract('0', '0'), '0', '0', '0', '0', '0', '0', <'0', '0'>, '0',
               '0', '0'
   ),
   DHExp( ~x, ~nc, $C ),
   Out( <'1', '0x0303', ~nc, '0', $cipher_suites, '0', <'43', '0x0304'>, 
         <'10', $g1, $g2>, <'13', $sig_algs>, '40', $g1, $g1^~x>
   )
   ]

  /* has exactly the trivial AC variant */

rule (modulo E) recv_hello_retry_request:
   [
   F_State_C1( ~tid, $C, $S, p_res_psk, p_messages, p_nc, p_ns, $g1,
               <$g1, $g2>, '0', p_x, p_y, p_gx, p_gy, p_gxy, p_psk_ke_mode, p_psk_id,
               p_edi, p_es, p_hs, p_ms, p_cats, p_sats, p_hs_keyc, p_hs_keys,
               p_auth_status, p_ems, p_rms, p_cert_req
   ),
   Fr( ~new_x ), In( <'6', '0x0303', '40', $g2> ), DHExp( p_x, ~tid, $C )
   ]
  --[
  C1_retry( ~tid ), Neq( $g1, $g2 ), Instance( ~tid, $C, 'client' ),
  DeleteDH( ~tid, $C, p_x ), DH( ~tid, $C, ~new_x )
  ]->
   [
   Out( <'1', '0x0303', p_nc, '0', $cipher_suites, '0', <'43', '0x0304'>, 
         <'10', $g1, $g2>, <'13', $sig_algs>, '40', $g2, $g2^~new_x>
   ),
   DHExp( ~new_x, ~tid, $C ),
   F_State_C1( ~tid, $C, $S, p_res_psk,
               <<p_messages, '6', '0x0303', '40', $g2>, '1', '0x0303', p_nc, '0', 
                $cipher_suites, '0', <'43', '0x0304'>, <'10', $g1, $g2>, 
                <'13', $sig_algs>, '40', $g2, $g2^~new_x>,
               p_nc, p_ns, $g2, <$g1, $g2>, 'hrr', ~new_x, p_y, $g2^~new_x, p_gy, p_gxy,
               'na', p_psk_id, p_edi, Extract(p_res_psk, '0'), p_hs, p_ms, p_cats,
               p_sats, p_hs_keyc, p_hs_keys, <'0', '0'>, p_ems, p_rms, p_cert_req
   )
   ]

  // loop breaker: [3]
  /* has exactly the trivial AC variant */

rule (modulo E) recv_server_hello:
   [
   F_State_C1( ~tid, $C, $S, p_res_psk, p_messages, p_nc, p_ns, $g, p_sg,
               p_hrr, ~x, p_y, p_gx, p_gy, p_gxy, p_psk_ke_mode, p_psk_id, p_edi, p_es,
               p_hs, p_ms, p_cats, p_sats, p_hs_keyc, p_hs_keys, p_auth_status, p_ems,
               p_rms, p_cert_req
   ),
   In( <'2', '0x0303', new_ns, $cipher_suite, <'13', $sig_algs>, '40', $g, 
        $g^new_y>
   )
   ]
  --[
  C1( ~tid ), Instance( ~tid, $C, 'client' ), Neq( $g^new_y, $g ),
  Neq( $g^new_y^~x, $g ),
  DHChal( $g, ~x, new_y, p_gx, $g^new_y, $g^new_y^~x ),
  RNonces( ~tid, $C, 'client', <p_nc, new_ns> )
  ]->
   [
   F_State_C2a( ~tid, $C, $S, p_res_psk,
                <p_messages, '2', '0x0303', new_ns, $cipher_suite, <'13', $sig_algs>, 
                 '40', $g, $g^new_y>,
                p_nc, new_ns, $g, p_sg, p_hrr, ~x, p_y, p_gx, $g^new_y, $g^new_y^~x,
                'na', p_psk_id, p_edi, p_es, p_hs, p_ms, p_cats, p_sats, p_hs_keyc,
                p_hs_keys, <'0', '0'>, p_ems, p_rms, p_cert_req
   )
   ]

  /*
  rule (modulo AC) recv_server_hello:
     [
     F_State_C1( ~tid, $C, $S, p_res_psk, p_messages, p_nc, p_ns, $g, p_sg,
                 p_hrr, ~x, p_y, p_gx, p_gy, p_gxy, p_psk_ke_mode, p_psk_id, p_edi, p_es,
                 p_hs, p_ms, p_cats, p_sats, p_hs_keyc, p_hs_keys, p_auth_status, p_ems,
                 p_rms, p_cert_req
     ),
     In( <'2', '0x0303', new_ns, $cipher_suite, <'13', $sig_algs>, '40', $g, z
         >
     )
     ]
    --[
    C1( ~tid ), Instance( ~tid, $C, 'client' ), Neq( z, $g ), Neq( z.1, $g ),
    DHChal( $g, ~x, new_y, p_gx, z, z.1 ),
    RNonces( ~tid, $C, 'client', <p_nc, new_ns> )
    ]->
     [
     F_State_C2a( ~tid, $C, $S, p_res_psk,
                  <p_messages, '2', '0x0303', new_ns, $cipher_suite, <'13', $sig_algs>, 
                   '40', $g, z>,
                  p_nc, new_ns, $g, p_sg, p_hrr, ~x, p_y, p_gx, z, z.1, 'na', p_psk_id,
                  p_edi, p_es, p_hs, p_ms, p_cats, p_sats, p_hs_keyc, p_hs_keys,
                  <'0', '0'>, p_ems, p_rms, p_cert_req
     )
     ]
    variants (modulo AC)
    1. $g    = $g.44
       ~x    = ~x.47
       new_y = inv(~x.47)
       z     = $g.44^inv(~x.47)
       z.1   = $g.44
    
    2. $g    = $g.44
       ~x    = ~x.47
       new_y = one
       z     = $g.44
       z.1   = $g.44^~x.47
    
    3. $g    = $g.46
       ~x    = ~x.49
       new_y = new_y.51
       z     = $g.46^new_y.51
       z.1   = $g.46^(~x.49*new_y.51)
    
    4. $g    = $g.276
       ~x    = ~x.279
       new_y = inv((~x.279*x.547))
       z     = $g.276^inv((~x.279*x.547))
       z.1   = $g.276^inv(x.547)
    
    5. $g    = $g.276
       ~x    = ~x.279
       new_y = (x.547*inv(~x.279))
       z     = $g.276^(x.547*inv(~x.279))
       z.1   = $g.276^x.547
    
    6. $g    = $g.277
       ~x    = ~x.280
       new_y = (x.549*inv((~x.280*x.548)))
       z     = $g.277^(x.549*inv((~x.280*x.548)))
       z.1   = $g.277^(x.549*inv(x.548))
  */

rule (modulo E) client_gen_keys:
   [
   F_State_C2a( ~tid, $C, $S, p_res_psk, p_messages, p_nc, p_ns, p_g, p_sg,
                p_hrr, p_x, p_y, p_gx, p_gy, p_gxy, p_psk_ke_mode, p_psk_id, p_edi, p_es,
                p_hs, p_ms, p_cats, p_sats, p_hs_keyc, p_hs_keys, p_auth_status, p_ems,
                p_rms, p_cert_req
   ),
   DHExp( p_x, ~tid, $C )
   ]
  --[
  C2a( ~tid ), Instance( ~tid, $C, 'client' ),
  RMS( ~tid, $C, 'client', Extract('0', Extract(p_gxy, p_es)) ),
  RHS( ~tid, $C, 'client', Extract(p_gxy, p_es) ),
  DeleteDH( ~tid, $C, p_x )
  ]->
   [
   F_State_C2b( ~tid, $C, $S, p_res_psk, p_messages, p_nc, p_ns, p_g, p_sg,
                p_hrr, p_x, p_y, p_gx, p_gy, p_gxy, p_psk_ke_mode, p_psk_id, p_edi, p_es,
                Extract(p_gxy, p_es), Extract('0', Extract(p_gxy, p_es)), p_cats, p_sats,
                Expand(Expand(Extract(p_gxy, p_es), <'clienthts', h(p_messages)>, '32'),
                       <'kshe_wk', '0'>, '32'),
                Expand(Expand(Extract(p_gxy, p_es), <'serverhts', h(p_messages)>, '32'),
                       <'kshe_wk', '0'>, '32'),
                p_auth_status, p_ems, p_rms, p_cert_req
   )
   ]

  /* has exactly the trivial AC variant */

rule (modulo E) recv_encrypted_extensions:
   [
   F_State_C2b( ~tid, $C, $S, p_res_psk, p_messages, p_nc, p_ns, p_g, p_sg,
                p_hrr, p_x, p_y, p_gx, p_gy, p_gxy, p_psk_ke_mode, p_psk_id, p_edi, p_es,
                p_hs, p_ms, p_cats, p_sats, p_hs_keyc, p_hs_keys, p_auth_status, p_ems,
                p_rms, p_cert_req
   ),
   In( senc(<'8', $exts>, p_hs_keys) )
   ]
  --[ C2b( ~tid ), Instance( ~tid, $C, 'client' ) ]->
   [
   F_State_C2c( ~tid, $C, $S, p_res_psk, <p_messages, '8', $exts>, p_nc,
                p_ns, p_g, p_sg, p_hrr, p_x, p_y, p_gx, p_gy, p_gxy, p_psk_ke_mode,
                p_psk_id, p_edi, p_es, p_hs, p_ms, p_cats, p_sats, p_hs_keyc, p_hs_keys,
                p_auth_status, p_ems, p_rms, p_cert_req
   )
   ]

  /* has exactly the trivial AC variant */

rule (modulo E) recv_certificate_request:
   [
   F_State_C2c( ~tid, $C, $S, p_res_psk, p_messages, p_nc, p_ns, p_g, p_sg,
                p_hrr, p_x, p_y, p_gx, p_gy, p_gxy, 'na', p_psk_id, p_edi, p_es, p_hs,
                p_ms, p_cats, p_sats, p_hs_keyc, p_hs_keys, p_auth_status, p_ems, p_rms,
                p_cert_req
   ),
   In( senc(<'13', '0', $certificate_extensions>, p_hs_keys) )
   ]
  --[ C2c_req( ~tid ), Instance( ~tid, $C, 'client' ) ]->
   [
   F_State_C2d( ~tid, $C, $S, p_res_psk,
                <p_messages, '13', '0', $certificate_extensions>, p_nc, p_ns, p_g, p_sg,
                p_hrr, p_x, p_y, p_gx, p_gy, p_gxy, 'na', p_psk_id, p_edi, p_es, p_hs,
                p_ms, p_cats, p_sats, p_hs_keyc, p_hs_keys, p_auth_status, p_ems, p_rms,
                '1'
   )
   ]

  /* has exactly the trivial AC variant */

rule (modulo E) skip_recv_certificate_request:
   [
   F_State_C2c( ~tid, $C, $S, p_res_psk, p_messages, p_nc, p_ns, p_g, p_sg,
                p_hrr, p_x, p_y, p_gx, p_gy, p_gxy, p_psk_ke_mode, p_psk_id, p_edi, p_es,
                p_hs, p_ms, p_cats, p_sats, p_hs_keyc, p_hs_keys, p_auth_status, p_ems,
                p_rms, p_cert_req
   )
   ]
  --[ C2c( ~tid ), Instance( ~tid, $C, 'client' ) ]->
   [
   F_State_C2d( ~tid, $C, $S, p_res_psk, p_messages, p_nc, p_ns, p_g, p_sg,
                p_hrr, p_x, p_y, p_gx, p_gy, p_gxy, p_psk_ke_mode, p_psk_id, p_edi, p_es,
                p_hs, p_ms, p_cats, p_sats, p_hs_keyc, p_hs_keys, p_auth_status, p_ems,
                p_rms, '0'
   )
   ]

  /* has exactly the trivial AC variant */

rule (modulo E) recv_server_auth:
   [
   F_State_C2d( ~tid, $C, $S, p_res_psk, p_messages, p_nc, p_ns, p_g, p_sg,
                p_hrr, p_x, p_y, p_gx, p_gy, p_gxy, 'na', p_psk_id, p_edi, p_es, p_hs,
                p_ms, p_cats, p_sats, p_hs_keyc, p_hs_keys, p_auth_status, p_ems, p_rms,
                p_cert_req
   ),
   !Pk( $S, pk(~ltkS) ),
   In( senc(<<'11', '0', pk(~ltkS)>, <'15', signature>, '20', verify_data>,
            p_hs_keys)
   )
   ]
  --[
  C2d( ~tid ), Instance( ~tid, $C, 'client' ), Eq( 'na', 'na' ),
  Eq( verify(signature,
             <'server_cv', h(<p_messages, '11', '0', pk(~ltkS)>)>, pk(~ltkS)),
      true
  ),
  Eq( verify_data,
      hmac(<
            Expand(Expand(p_hs,
                          <'serverhts', h(<<p_messages, '11', '0', pk(~ltkS)>, '15', signature>)>,
                          '32'),
                   <'fin', '0'>, '32'), 
            h(<<p_messages, '11', '0', pk(~ltkS)>, '15', signature>)>)
  ),
  RMode( ~tid, $C, 'client', 'na' ),
  CIdentity( ~tid, $C, 'client', <$S, '0', 'auth'> ),
  CHS( ~tid, $C, 'client', p_hs ),
  CTranscript( ~tid, $C, 'client',
               <<<p_messages, '11', '0', pk(~ltkS)>, '15', signature>, '20', verify_data
               >
  ),
  CNonces( ~tid, $C, 'client', <p_nc, p_ns> )
  ]->
   [
   F_State_C3( ~tid, $C, $S, p_res_psk,
               <<<p_messages, '11', '0', pk(~ltkS)>, '15', signature>, '20', verify_data
               >,
               p_nc, p_ns, p_g, p_sg, p_hrr, p_x, p_y, p_gx, p_gy, p_gxy, 'na',
               p_psk_id, p_edi, p_es, p_hs, p_ms,
               Expand(p_ms,
                      <'clientats', 
                       h(<<<p_messages, '11', '0', pk(~ltkS)>, '15', signature>, '20', 
                          verify_data>)
                      >,
                      '32'),
               Expand(p_ms,
                      <'serverats', 
                       h(<<<p_messages, '11', '0', pk(~ltkS)>, '15', signature>, '20', 
                          verify_data>)
                      >,
                      '32'),
               p_hs_keyc, p_hs_keys, <'0', 'auth'>,
               Expand(p_ms,
                      <'ems', 
                       h(<<<p_messages, '11', '0', pk(~ltkS)>, '15', signature>, '20', 
                          verify_data>)
                      >,
                      '32'),
               p_rms, p_cert_req
   ),
   RecvStream( ~tid, $C, $S, <'0', 'auth'>,
               Expand(Expand(p_ms,
                             <'serverats', 
                              h(<<<p_messages, '11', '0', pk(~ltkS)>, '15', signature>, '20', 
                                 verify_data>)
                             >,
                             '32'),
                      <'adke_wk', '0'>, '32')
   )
   ]

  /*
  rule (modulo AC) recv_server_auth:
     [
     F_State_C2d( ~tid, $C, $S, p_res_psk, p_messages, p_nc, p_ns, p_g, p_sg,
                  p_hrr, p_x, p_y, p_gx, p_gy, p_gxy, 'na', p_psk_id, p_edi, p_es, p_hs,
                  p_ms, p_cats, p_sats, p_hs_keyc, p_hs_keys, p_auth_status, p_ems, p_rms,
                  p_cert_req
     ),
     !Pk( $S, pk(~ltkS) ),
     In( senc(<<'11', '0', pk(~ltkS)>, <'15', signature>, '20', verify_data>,
              p_hs_keys)
     )
     ]
    --[
    C2d( ~tid ), Instance( ~tid, $C, 'client' ), Eq( 'na', 'na' ),
    Eq( z, true ),
    Eq( verify_data,
        hmac(<
              Expand(Expand(p_hs,
                            <'serverhts', h(<<p_messages, '11', '0', pk(~ltkS)>, '15', signature>)>,
                            '32'),
                     <'fin', '0'>, '32'), 
              h(<<p_messages, '11', '0', pk(~ltkS)>, '15', signature>)>)
    ),
    RMode( ~tid, $C, 'client', 'na' ),
    CIdentity( ~tid, $C, 'client', <$S, '0', 'auth'> ),
    CHS( ~tid, $C, 'client', p_hs ),
    CTranscript( ~tid, $C, 'client',
                 <<<p_messages, '11', '0', pk(~ltkS)>, '15', signature>, '20', verify_data
                 >
    ),
    CNonces( ~tid, $C, 'client', <p_nc, p_ns> )
    ]->
     [
     F_State_C3( ~tid, $C, $S, p_res_psk,
                 <<<p_messages, '11', '0', pk(~ltkS)>, '15', signature>, '20', verify_data
                 >,
                 p_nc, p_ns, p_g, p_sg, p_hrr, p_x, p_y, p_gx, p_gy, p_gxy, 'na',
                 p_psk_id, p_edi, p_es, p_hs, p_ms,
                 Expand(p_ms,
                        <'clientats', 
                         h(<<<p_messages, '11', '0', pk(~ltkS)>, '15', signature>, '20', 
                            verify_data>)
                        >,
                        '32'),
                 Expand(p_ms,
                        <'serverats', 
                         h(<<<p_messages, '11', '0', pk(~ltkS)>, '15', signature>, '20', 
                            verify_data>)
                        >,
                        '32'),
                 p_hs_keyc, p_hs_keys, <'0', 'auth'>,
                 Expand(p_ms,
                        <'ems', 
                         h(<<<p_messages, '11', '0', pk(~ltkS)>, '15', signature>, '20', 
                            verify_data>)
                        >,
                        '32'),
                 p_rms, p_cert_req
     ),
     RecvStream( ~tid, $C, $S, <'0', 'auth'>,
                 Expand(Expand(p_ms,
                               <'serverats', 
                                h(<<<p_messages, '11', '0', pk(~ltkS)>, '15', signature>, '20', 
                                   verify_data>)
                               >,
                               '32'),
                        <'adke_wk', '0'>, '32')
     )
     ]
    variants (modulo AC)
    1. ~ltkS = ~ltkS.62
       p_messages
             = p_messages.78
       signature
             = sign(<'server_cv', h(<p_messages.78, '11', '0', pk(~ltkS.62)>)>,
                    ~ltkS.62)
       z     = true
    
    2. ~ltkS = ~ltkS.73
       p_messages
             = p_messages.89
       signature
             = signature.100
       z     = verify(signature.100,
                      <'server_cv', h(<p_messages.89, '11', '0', pk(~ltkS.73)>)>, pk(~ltkS.73))
  */

rule (modulo E) client_auth:
   [
   F_State_C3( ~tid, $C, $S, p_res_psk, p_messages, p_nc, p_ns, p_g, p_sg,
               p_hrr, p_x, p_y, p_gx, p_gy, p_gxy, p_psk_ke_mode, p_psk_id, p_edi, p_es,
               p_hs, p_ms, p_cats, p_sats, p_hs_keyc, p_hs_keys, p_auth_status, p_ems,
               p_rms, '0'
   )
   ]
  --[
  C3( ~tid ), Instance( ~tid, $C, 'client' ),
  RTranscript( ~tid, $C, 'client',
               <p_messages, '20', 
                hmac(<
                      Expand(Expand(p_hs, <'clienthts', h(p_messages)>, '32'), <'fin', '0'>,
                             '32'), 
                      h(p_messages)>)
               >
  ),
  RHSMS( ~tid, $C, 'client', <p_hs, p_ms> ),
  RRMS( ~tid, $C, 'client',
        <$S, 
         Expand(p_ms,
                <'rms', 
                 h(<p_messages, '20', 
                    hmac(<
                          Expand(Expand(p_hs, <'clienthts', h(p_messages)>, '32'), <'fin', '0'>,
                                 '32'), 
                          h(p_messages)>)
                   >)
                >,
                '32'), 
         p_messages, '20', 
         hmac(<
               Expand(Expand(p_hs, <'clienthts', h(p_messages)>, '32'), <'fin', '0'>,
                      '32'), 
               h(p_messages)>)
        >
  ),
  RMode( ~tid, $C, 'client', p_psk_ke_mode ),
  SessionKey( ~tid, $C, $S, p_auth_status,
              <Expand(p_cats, <'adke_wk', '0'>, '32'), 
               Expand(p_sats, <'adke_wk', '0'>, '32')>
  )
  ]->
   [
   L_State_C4( ~tid, $C, $S, p_res_psk,
               <p_messages, '20', 
                hmac(<
                      Expand(Expand(p_hs, <'clienthts', h(p_messages)>, '32'), <'fin', '0'>,
                             '32'), 
                      h(p_messages)>)
               >,
               p_nc, p_ns, p_g, p_sg, p_hrr, p_x, p_y, p_gx, p_gy, p_gxy, p_psk_ke_mode,
               p_psk_id, p_edi, p_es, p_hs, p_ms, p_cats, p_sats, p_hs_keyc, p_hs_keys,
               p_auth_status, p_ems,
               Expand(p_ms,
                      <'rms', 
                       h(<p_messages, '20', 
                          hmac(<
                                Expand(Expand(p_hs, <'clienthts', h(p_messages)>, '32'), <'fin', '0'>,
                                       '32'), 
                                h(p_messages)>)
                         >)
                      >,
                      '32'),
               '0'
   ),
   Out( senc(<'20', 
              hmac(<
                    Expand(Expand(p_hs, <'clienthts', h(p_messages)>, '32'), <'fin', '0'>,
                           '32'), 
                    h(p_messages)>)
             >,
             p_hs_keyc)
   ),
   SendStream( ~tid, $C, $S, p_auth_status,
               Expand(p_cats, <'adke_wk', '0'>, '32')
   )
   ]

  /* has exactly the trivial AC variant */

rule (modulo E) client_auth_cert:
   [
   F_State_C3( ~tid, $C, $S, p_res_psk, p_messages, p_nc, p_ns, p_g, p_sg,
               p_hrr, p_x, p_y, p_gx, p_gy, p_gxy, 'na', p_psk_id, p_edi, p_es, p_hs,
               p_ms, p_cats, p_sats, p_hs_keyc, p_hs_keys, p_auth_status, p_ems, p_rms,
               '1'
   ),
   RecvStream( ~tid, $C, $S, p_auth_status,
               Expand(p_sats, <'adke_wk', '0'>, '32')
   ),
   !Ltk( $C, ~ltkC )
   ]
  --[
  C3_cert( ~tid ), Instance( ~tid, $C, 'client' ),
  UseLtk( ~ltkC,
          sign(<'client_cv', h(<p_messages, '11', '0', pk(~ltkC)>)>, ~ltkC)
  ),
  RHSMS( ~tid, $C, 'client', <p_hs, p_ms> ),
  RTranscript( ~tid, $C, 'client',
               <
                <<p_messages, '11', '0', pk(~ltkC)>, '15', 
                 sign(<'client_cv', h(<p_messages, '11', '0', pk(~ltkC)>)>, ~ltkC)>, 
                '20', 
                hmac(<
                      Expand(Expand(p_hs,
                                    <'clienthts', 
                                     h(<<p_messages, '11', '0', pk(~ltkC)>, '15', 
                                        sign(<'client_cv', h(<p_messages, '11', '0', pk(~ltkC)>)>, ~ltkC)>)
                                    >,
                                    '32'),
                             <'fin', '0'>, '32'), 
                      h(<<p_messages, '11', '0', pk(~ltkC)>, '15', 
                         sign(<'client_cv', h(<p_messages, '11', '0', pk(~ltkC)>)>, ~ltkC)>)
                     >)
               >
  ),
  RRMS( ~tid, $C, 'client',
        <$S, 
         Expand(p_ms,
                <'rms', 
                 h(<
                    <<p_messages, '11', '0', pk(~ltkC)>, '15', 
                     sign(<'client_cv', h(<p_messages, '11', '0', pk(~ltkC)>)>, ~ltkC)>, 
                    '20', 
                    hmac(<
                          Expand(Expand(p_hs,
                                        <'clienthts', 
                                         h(<<p_messages, '11', '0', pk(~ltkC)>, '15', 
                                            sign(<'client_cv', h(<p_messages, '11', '0', pk(~ltkC)>)>, ~ltkC)
                                           >)
                                        >,
                                        '32'),
                                 <'fin', '0'>, '32'), 
                          h(<<p_messages, '11', '0', pk(~ltkC)>, '15', 
                             sign(<'client_cv', h(<p_messages, '11', '0', pk(~ltkC)>)>, ~ltkC)>)
                         >)
                   >)
                >,
                '32'), 
         <<p_messages, '11', '0', pk(~ltkC)>, '15', 
          sign(<'client_cv', h(<p_messages, '11', '0', pk(~ltkC)>)>, ~ltkC)>, 
         '20', 
         hmac(<
               Expand(Expand(p_hs,
                             <'clienthts', 
                              h(<<p_messages, '11', '0', pk(~ltkC)>, '15', 
                                 sign(<'client_cv', h(<p_messages, '11', '0', pk(~ltkC)>)>, ~ltkC)>)
                             >,
                             '32'),
                      <'fin', '0'>, '32'), 
               h(<<p_messages, '11', '0', pk(~ltkC)>, '15', 
                  sign(<'client_cv', h(<p_messages, '11', '0', pk(~ltkC)>)>, ~ltkC)>)
              >)
        >
  ),
  RMode( ~tid, $C, 'client', 'na' ),
  SessionKey( ~tid, $C, $S, <'auth', 'auth'>,
              <Expand(p_cats, <'adke_wk', '0'>, '32'), 
               Expand(p_sats, <'adke_wk', '0'>, '32')>
  )
  ]->
   [
   L_State_C4( ~tid, $C, $S, p_res_psk,
               <
                <<p_messages, '11', '0', pk(~ltkC)>, '15', 
                 sign(<'client_cv', h(<p_messages, '11', '0', pk(~ltkC)>)>, ~ltkC)>, 
                '20', 
                hmac(<
                      Expand(Expand(p_hs,
                                    <'clienthts', 
                                     h(<<p_messages, '11', '0', pk(~ltkC)>, '15', 
                                        sign(<'client_cv', h(<p_messages, '11', '0', pk(~ltkC)>)>, ~ltkC)>)
                                    >,
                                    '32'),
                             <'fin', '0'>, '32'), 
                      h(<<p_messages, '11', '0', pk(~ltkC)>, '15', 
                         sign(<'client_cv', h(<p_messages, '11', '0', pk(~ltkC)>)>, ~ltkC)>)
                     >)
               >,
               p_nc, p_ns, p_g, p_sg, p_hrr, p_x, p_y, p_gx, p_gy, p_gxy, 'na',
               p_psk_id, p_edi, p_es, p_hs, p_ms, p_cats, p_sats, p_hs_keyc, p_hs_keys,
               <'auth', 'auth'>, p_ems,
               Expand(p_ms,
                      <'rms', 
                       h(<
                          <<p_messages, '11', '0', pk(~ltkC)>, '15', 
                           sign(<'client_cv', h(<p_messages, '11', '0', pk(~ltkC)>)>, ~ltkC)>, 
                          '20', 
                          hmac(<
                                Expand(Expand(p_hs,
                                              <'clienthts', 
                                               h(<<p_messages, '11', '0', pk(~ltkC)>, '15', 
                                                  sign(<'client_cv', h(<p_messages, '11', '0', pk(~ltkC)>)>,
                                                       ~ltkC)
                                                 >)
                                              >,
                                              '32'),
                                       <'fin', '0'>, '32'), 
                                h(<<p_messages, '11', '0', pk(~ltkC)>, '15', 
                                   sign(<'client_cv', h(<p_messages, '11', '0', pk(~ltkC)>)>, ~ltkC)>)
                               >)
                         >)
                      >,
                      '32'),
               '0'
   ),
   Out( senc(<<'11', '0', pk(~ltkC)>, 
              <'15', sign(<'client_cv', h(<p_messages, '11', '0', pk(~ltkC)>)>, ~ltkC)
              >, 
              '20', 
              hmac(<
                    Expand(Expand(p_hs,
                                  <'clienthts', 
                                   h(<<p_messages, '11', '0', pk(~ltkC)>, '15', 
                                      sign(<'client_cv', h(<p_messages, '11', '0', pk(~ltkC)>)>, ~ltkC)>)
                                  >,
                                  '32'),
                           <'fin', '0'>, '32'), 
                    h(<<p_messages, '11', '0', pk(~ltkC)>, '15', 
                       sign(<'client_cv', h(<p_messages, '11', '0', pk(~ltkC)>)>, ~ltkC)>)
                   >)
             >,
             p_hs_keyc)
   ),
   SendStream( ~tid, $C, $S, <'auth', 'auth'>,
               Expand(p_cats, <'adke_wk', '0'>, '32')
   ),
   RecvStream( ~tid, $C, $S, <'auth', 'auth'>,
               Expand(p_sats, <'adke_wk', '0'>, '32')
   )
   ]

  // loop breaker: [1]
  /* has exactly the trivial AC variant */

rule (modulo E) start_server:
   [ Fr( ~tid ) ]
  --[ Start( ~tid, $S, 'server' ), RIdentity( ~tid, $S, 'server', $S ) ]->
   [
   F_State_S0( ~tid, $S, $C, '0', '0', '0', '0', '0', $g, '0', '0', '0',
               '0', '0', '0', 'na', '0', '0', '0', '0', '0', '0', '0', '0', '0',
               <'0', '0'>, '0', '0', '0'
   )
   ]

  /* has exactly the trivial AC variant */

rule (modulo E) recv_client_hello:
   [
   In( <'1', '0x0303', new_nc, '0', $cipher_suites, '0', <'43', '0x0304'>, 
        <'10', $g1, $g2>, <'13', $sig_algs>, '40', $new_g, $new_g^new_x>
   ),
   Fr( ~new_ns ),
   F_State_S0( ~tid, $S, $C, p_res_psk, p_messages, p_nc, p_ns, p_g, p_sg,
               p_hrr, p_x, p_y, p_gx, p_gy, p_gxy, p_psk_ke_mode, p_psk_id, p_edi, p_es,
               p_hs, p_ms, p_cats, p_sats, p_hs_keyc, p_hs_keys, p_auth_status, p_ems,
               p_rms, p_cert_req
   )
   ]
  --[ S0( ~tid ), Neq( $g1, $g2 ) ]->
   [
   F_State_S1( ~tid, $S, $C, p_res_psk,
               <p_messages, '1', '0x0303', new_nc, '0', $cipher_suites, '0', 
                <'43', '0x0304'>, <'10', $g1, $g2>, <'13', $sig_algs>, '40', $new_g, 
                $new_g^new_x>,
               new_nc, ~new_ns, $new_g, p_sg, p_hrr, p_x, p_y, $new_g^new_x, p_gy,
               p_gxy, 'na', p_psk_id, p_edi, p_es, p_hs, p_ms, p_cats, p_sats,
               p_hs_keyc, p_hs_keys, p_auth_status, p_ems, p_rms, p_cert_req
   )
   ]

  /*
  rule (modulo AC) recv_client_hello:
     [
     In( <'1', '0x0303', new_nc, '0', $cipher_suites, '0', <'43', '0x0304'>, 
          <'10', $g1, $g2>, <'13', $sig_algs>, '40', $new_g, z>
     ),
     Fr( ~new_ns ),
     F_State_S0( ~tid, $S, $C, p_res_psk, p_messages, p_nc, p_ns, p_g, p_sg,
                 p_hrr, p_x, p_y, p_gx, p_gy, p_gxy, p_psk_ke_mode, p_psk_id, p_edi, p_es,
                 p_hs, p_ms, p_cats, p_sats, p_hs_keyc, p_hs_keys, p_auth_status, p_ems,
                 p_rms, p_cert_req
     )
     ]
    --[ S0( ~tid ), Neq( $g1, $g2 ) ]->
     [
     F_State_S1( ~tid, $S, $C, p_res_psk,
                 <p_messages, '1', '0x0303', new_nc, '0', $cipher_suites, '0', 
                  <'43', '0x0304'>, <'10', $g1, $g2>, <'13', $sig_algs>, '40', $new_g, z>,
                 new_nc, ~new_ns, $new_g, p_sg, p_hrr, p_x, p_y, z, p_gy, p_gxy, 'na',
                 p_psk_id, p_edi, p_es, p_hs, p_ms, p_cats, p_sats, p_hs_keyc, p_hs_keys,
                 p_auth_status, p_ems, p_rms, p_cert_req
     )
     ]
    variants (modulo AC)
    1. $new_g
             = $new_g.48
       z     = $new_g.48
    
    2. $new_g
             = $new_g.384
       z     = $new_g.384^new_x.761
  */

rule (modulo E) hello_retry_request:
   [
   F_State_S1( ~tid, $S, $C, p_res_psk, p_messages, p_nc, p_ns, p_g, $p_sg,
               '0', p_x, p_y, p_gx, p_gy, p_gxy, p_psk_ke_mode, p_psk_id, p_edi, p_es,
               p_hs, p_ms, p_cats, p_sats, p_hs_keyc, p_hs_keys, p_auth_status, p_ems,
               p_rms, p_cert_req
   )
   ]
  --[ S1_retry( ~tid ), Neq( p_g, $p_sg ), Instance( ~tid, $S, 'server' )
  ]->
   [
   Out( <'6', '0x0303', '40', $p_sg> ),
   F_State_S0( ~tid, $S, $C, p_res_psk,
               <p_messages, '6', '0x0303', '40', $p_sg>, p_nc, p_ns, $p_sg, $p_sg,
               'hrr', p_x, p_y, p_gx, p_gy, p_gxy, p_psk_ke_mode, p_psk_id, p_edi, p_es,
               p_hs, p_ms, p_cats, p_sats, p_hs_keyc, p_hs_keys, p_auth_status, p_ems,
               p_rms, p_cert_req
   )
   ]

  // loop breaker: [0]
  /* has exactly the trivial AC variant */

rule (modulo E) server_hello:
   [
   F_State_S1( ~tid, $S, $C, p_res_psk, p_messages, p_nc, p_ns, $p_g, p_sg,
               p_hrr, p_x, p_y, $p_g^some_x, p_gy, p_gxy, p_psk_ke_mode, p_psk_id,
               p_edi, p_es, p_hs, p_ms, p_cats, p_sats, p_hs_keyc, p_hs_keys,
               p_auth_status, p_ems, p_rms, p_cert_req
   ),
   Fr( ~y )
   ]
  --[
  S1( ~tid ), Eq( $p_g, p_sg ), Neq( $p_g^some_x, $p_g ),
  Neq( $p_g^some_x^~y, $p_g ), Instance( ~tid, $S, 'server' ),
  RNonces( ~tid, $S, 'server', <p_nc, p_ns> ),
  DHChal( $p_g, some_x, ~y, $p_g^some_x, $p_g^~y, $p_g^some_x^~y ),
  DH( ~tid, $S, ~y )
  ]->
   [
   F_State_S2a( ~tid, $S, $C, p_res_psk,
                <p_messages, '2', '0x0303', p_ns, $cipher_suite, <'13', $sig_algs>, 
                 '40', $p_g, $p_g^~y>,
                p_nc, p_ns, $p_g, p_sg, p_hrr, p_x, ~y, $p_g^some_x, $p_g^~y,
                $p_g^some_x^~y, 'na', p_psk_id, p_edi, Extract(p_res_psk, '0'), p_hs,
                p_ms, p_cats, p_sats, p_hs_keyc, p_hs_keys, <'0', '0'>, p_ems, p_rms,
                p_cert_req
   ),
   DHExp( ~y, ~tid, $S ),
   Out( <'2', '0x0303', p_ns, $cipher_suite, <'13', $sig_algs>, '40', $p_g, 
         $p_g^~y>
   )
   ]

  /*
  rule (modulo AC) server_hello:
     [
     F_State_S1( ~tid, $S, $C, p_res_psk, p_messages, p_nc, p_ns, $p_g, p_sg,
                 p_hrr, p_x, p_y, z, p_gy, p_gxy, p_psk_ke_mode, p_psk_id, p_edi, p_es,
                 p_hs, p_ms, p_cats, p_sats, p_hs_keyc, p_hs_keys, p_auth_status, p_ems,
                 p_rms, p_cert_req
     ),
     Fr( ~y )
     ]
    --[
    S1( ~tid ), Eq( $p_g, p_sg ), Neq( z, $p_g ), Neq( z.1, $p_g ),
    Instance( ~tid, $S, 'server' ),
    RNonces( ~tid, $S, 'server', <p_nc, p_ns> ),
    DHChal( $p_g, some_x, ~y, z, $p_g^~y, z.1 ), DH( ~tid, $S, ~y )
    ]->
     [
     F_State_S2a( ~tid, $S, $C, p_res_psk,
                  <p_messages, '2', '0x0303', p_ns, $cipher_suite, <'13', $sig_algs>, 
                   '40', $p_g, $p_g^~y>,
                  p_nc, p_ns, $p_g, p_sg, p_hrr, p_x, ~y, z, $p_g^~y, z.1, 'na', p_psk_id,
                  p_edi, Extract(p_res_psk, '0'), p_hs, p_ms, p_cats, p_sats, p_hs_keyc,
                  p_hs_keys, <'0', '0'>, p_ems, p_rms, p_cert_req
     ),
     DHExp( ~y, ~tid, $S ),
     Out( <'2', '0x0303', p_ns, $cipher_suite, <'13', $sig_algs>, '40', $p_g, 
           $p_g^~y>
     )
     ]
    variants (modulo AC)
    1. $p_g  = $p_g.44
       ~y    = ~y.47
       some_x
             = inv(~y.47)
       z     = $p_g.44^inv(~y.47)
       z.1   = $p_g.44
    
    2. $p_g  = $p_g.44
       ~y    = ~y.47
       some_x
             = one
       z     = $p_g.44
       z.1   = $p_g.44^~y.47
    
    3. $p_g  = $p_g.69
       ~y    = ~y.72
       some_x
             = some_x.97
       z     = $p_g.69^some_x.97
       z.1   = $p_g.69^(~y.72*some_x.97)
    
    4. $p_g  = $p_g.491
       ~y    = ~y.494
       some_x
             = inv((~y.494*x.977))
       z     = $p_g.491^inv((~y.494*x.977))
       z.1   = $p_g.491^inv(x.977)
    
    5. $p_g  = $p_g.491
       ~y    = ~y.494
       some_x
             = (x.977*inv(~y.494))
       z     = $p_g.491^(x.977*inv(~y.494))
       z.1   = $p_g.491^x.977
    
    6. $p_g  = $p_g.492
       ~y    = ~y.495
       some_x
             = (x.979*inv((~y.495*x.978)))
       z     = $p_g.492^(x.979*inv((~y.495*x.978)))
       z.1   = $p_g.492^(x.979*inv(x.978))
  */

rule (modulo E) server_gen_keys:
   [
   F_State_S2a( ~tid, $S, $C, p_res_psk, p_messages, p_nc, p_ns, p_g, p_sg,
                p_hrr, p_x, p_y, p_gx, p_gy, p_gxy, p_psk_ke_mode, p_psk_id, p_edi, p_es,
                p_hs, p_ms, p_cats, p_sats, p_hs_keyc, p_hs_keys, p_auth_status, p_ems,
                p_rms, p_cert_req
   ),
   DHExp( p_y, ~tid, $S )
   ]
  --[
  S2a( ~tid ), Extract( '0', Extract(p_gxy, p_es) ),
  Instance( ~tid, $S, 'server' ),
  RHS( ~tid, $S, 'server', Extract(p_gxy, p_es) ),
  RMS( ~tid, $S, 'server', Extract('0', Extract(p_gxy, p_es)) ),
  DeleteDH( ~tid, $S, p_y )
  ]->
   [
   F_State_S2b( ~tid, $S, $C, p_res_psk, p_messages, p_nc, p_ns, p_g, p_sg,
                p_hrr, p_x, p_y, p_gx, p_gy, p_gxy, p_psk_ke_mode, p_psk_id, p_edi, p_es,
                Extract(p_gxy, p_es), Extract('0', Extract(p_gxy, p_es)), p_cats, p_sats,
                Expand(Expand(Extract(p_gxy, p_es), <'clienthts', h(p_messages)>, '32'),
                       <'kshe_wk', '0'>, '32'),
                Expand(Expand(Extract(p_gxy, p_es), <'serverhts', h(p_messages)>, '32'),
                       <'kshe_wk', '0'>, '32'),
                p_auth_status, p_ems, p_rms, p_cert_req
   )
   ]

  /* has exactly the trivial AC variant */

rule (modulo E) encrypted_extensions:
   [
   F_State_S2b( ~tid, $S, $C, p_res_psk, p_messages, p_nc, p_ns, p_g, p_sg,
                p_hrr, p_x, p_y, p_gx, p_gy, p_gxy, p_psk_ke_mode, p_psk_id, p_edi, p_es,
                p_hs, p_ms, p_cats, p_sats, p_hs_keyc, p_hs_keys, p_auth_status, p_ems,
                p_rms, p_cert_req
   )
   ]
  --[ S2b( ~tid ), Instance( ~tid, $S, 'server' ) ]->
   [
   F_State_S2c( ~tid, $S, $C, p_res_psk, <p_messages, '8', $exts>, p_nc,
                p_ns, p_g, p_sg, p_hrr, p_x, p_y, p_gx, p_gy, p_gxy, p_psk_ke_mode,
                p_psk_id, p_edi, p_es, p_hs, p_ms, p_cats, p_sats, p_hs_keyc, p_hs_keys,
                p_auth_status, p_ems, p_rms, p_cert_req
   ),
   Out( senc(<'8', $exts>, p_hs_keys) )
   ]

  /* has exactly the trivial AC variant */

rule (modulo E) certificate_request:
   [
   F_State_S2c( ~tid, $S, $C, p_res_psk, p_messages, p_nc, p_ns, p_g, p_sg,
                p_hrr, p_x, p_y, p_gx, p_gy, p_gxy, 'na', p_psk_id, p_edi, p_es, p_hs,
                p_ms, p_cats, p_sats, p_hs_keyc, p_hs_keys, p_auth_status, p_ems, p_rms,
                p_cert_req
   )
   ]
  --[
  S2c_req( ~tid ), Instance( ~tid, $S, 'server' ),
  RCertReqCtxt( ~tid, $S, 'server', '0' )
  ]->
   [
   F_State_S2d( ~tid, $S, $C, p_res_psk,
                <p_messages, '13', '0', $certificate_extensions>, p_nc, p_ns, p_g, p_sg,
                p_hrr, p_x, p_y, p_gx, p_gy, p_gxy, 'na', p_psk_id, p_edi, p_es, p_hs,
                p_ms, p_cats, p_sats, p_hs_keyc, p_hs_keys, p_auth_status, p_ems, p_rms,
                '1'
   ),
   Out( senc(<'13', '0', $certificate_extensions>, p_hs_keys) )
   ]

  /* has exactly the trivial AC variant */

rule (modulo E) skip_certificate_request:
   [
   F_State_S2c( ~tid, $S, $C, p_res_psk, p_messages, p_nc, p_ns, p_g, p_sg,
                p_hrr, p_x, p_y, p_gx, p_gy, p_gxy, p_psk_ke_mode, p_psk_id, p_edi, p_es,
                p_hs, p_ms, p_cats, p_sats, p_hs_keyc, p_hs_keys, p_auth_status, p_ems,
                p_rms, p_cert_req
   )
   ]
  --[ S2c( ~tid ), Instance( ~tid, $S, 'server' ) ]->
   [
   F_State_S2d( ~tid, $S, $C, p_res_psk, p_messages, p_nc, p_ns, p_g, p_sg,
                p_hrr, p_x, p_y, p_gx, p_gy, p_gxy, p_psk_ke_mode, p_psk_id, p_edi, p_es,
                p_hs, p_ms, p_cats, p_sats, p_hs_keyc, p_hs_keys, p_auth_status, p_ems,
                p_rms, '0'
   )
   ]

  /* has exactly the trivial AC variant */

rule (modulo E) server_auth:
   [
   F_State_S2d( ~tid, $S, $C, p_res_psk, p_messages, p_nc, p_ns, p_g, p_sg,
                p_hrr, p_x, p_y, p_gx, p_gy, p_gxy, p_psk_ke_mode, p_psk_id, p_edi, p_es,
                p_hs, p_ms, p_cats, p_sats, p_hs_keyc, p_hs_keys, p_auth_status, p_ems,
                p_rms, p_cert_req
   ),
   !Ltk( $S, ~ltkS )
   ]
  --[
  S2d( ~tid ), Instance( ~tid, $S, 'server' ), Eq( p_psk_ke_mode, 'na' ),
  UseLtk( ~ltkS,
          sign(<'server_cv', h(<p_messages, '11', '0', pk(~ltkS)>)>, ~ltkS)
  ),
  RTranscript( ~tid, $S, 'server',
               <
                <<p_messages, '11', '0', pk(~ltkS)>, '15', 
                 sign(<'server_cv', h(<p_messages, '11', '0', pk(~ltkS)>)>, ~ltkS)>, 
                '20', 
                hmac(<
                      Expand(Expand(p_hs,
                                    <'serverhts', 
                                     h(<<p_messages, '11', '0', pk(~ltkS)>, '15', 
                                        sign(<'server_cv', h(<p_messages, '11', '0', pk(~ltkS)>)>, ~ltkS)>)
                                    >,
                                    '32'),
                             <'fin', '0'>, '32'), 
                      h(<<p_messages, '11', '0', pk(~ltkS)>, '15', 
                         sign(<'server_cv', h(<p_messages, '11', '0', pk(~ltkS)>)>, ~ltkS)>)
                     >)
               >
  )
  ]->
   [
   F_State_S3( ~tid, $S, $C, p_res_psk,
               <
                <<p_messages, '11', '0', pk(~ltkS)>, '15', 
                 sign(<'server_cv', h(<p_messages, '11', '0', pk(~ltkS)>)>, ~ltkS)>, 
                '20', 
                hmac(<
                      Expand(Expand(p_hs,
                                    <'serverhts', 
                                     h(<<p_messages, '11', '0', pk(~ltkS)>, '15', 
                                        sign(<'server_cv', h(<p_messages, '11', '0', pk(~ltkS)>)>, ~ltkS)>)
                                    >,
                                    '32'),
                             <'fin', '0'>, '32'), 
                      h(<<p_messages, '11', '0', pk(~ltkS)>, '15', 
                         sign(<'server_cv', h(<p_messages, '11', '0', pk(~ltkS)>)>, ~ltkS)>)
                     >)
               >,
               p_nc, p_ns, p_g, p_sg, p_hrr, p_x, p_y, p_gx, p_gy, p_gxy, p_psk_ke_mode,
               p_psk_id, p_edi, p_es, p_hs, p_ms,
               Expand(p_ms,
                      <'clientats', 
                       h(<
                          <<p_messages, '11', '0', pk(~ltkS)>, '15', 
                           sign(<'server_cv', h(<p_messages, '11', '0', pk(~ltkS)>)>, ~ltkS)>, 
                          '20', 
                          hmac(<
                                Expand(Expand(p_hs,
                                              <'serverhts', 
                                               h(<<p_messages, '11', '0', pk(~ltkS)>, '15', 
                                                  sign(<'server_cv', h(<p_messages, '11', '0', pk(~ltkS)>)>,
                                                       ~ltkS)
                                                 >)
                                              >,
                                              '32'),
                                       <'fin', '0'>, '32'), 
                                h(<<p_messages, '11', '0', pk(~ltkS)>, '15', 
                                   sign(<'server_cv', h(<p_messages, '11', '0', pk(~ltkS)>)>, ~ltkS)>)
                               >)
                         >)
                      >,
                      '32'),
               Expand(p_ms,
                      <'serverats', 
                       h(<
                          <<p_messages, '11', '0', pk(~ltkS)>, '15', 
                           sign(<'server_cv', h(<p_messages, '11', '0', pk(~ltkS)>)>, ~ltkS)>, 
                          '20', 
                          hmac(<
                                Expand(Expand(p_hs,
                                              <'serverhts', 
                                               h(<<p_messages, '11', '0', pk(~ltkS)>, '15', 
                                                  sign(<'server_cv', h(<p_messages, '11', '0', pk(~ltkS)>)>,
                                                       ~ltkS)
                                                 >)
                                              >,
                                              '32'),
                                       <'fin', '0'>, '32'), 
                                h(<<p_messages, '11', '0', pk(~ltkS)>, '15', 
                                   sign(<'server_cv', h(<p_messages, '11', '0', pk(~ltkS)>)>, ~ltkS)>)
                               >)
                         >)
                      >,
                      '32'),
               p_hs_keyc, p_hs_keys, <'auth', '0'>,
               Expand(p_ms,
                      <'ems', 
                       h(<
                          <<p_messages, '11', '0', pk(~ltkS)>, '15', 
                           sign(<'server_cv', h(<p_messages, '11', '0', pk(~ltkS)>)>, ~ltkS)>, 
                          '20', 
                          hmac(<
                                Expand(Expand(p_hs,
                                              <'serverhts', 
                                               h(<<p_messages, '11', '0', pk(~ltkS)>, '15', 
                                                  sign(<'server_cv', h(<p_messages, '11', '0', pk(~ltkS)>)>,
                                                       ~ltkS)
                                                 >)
                                              >,
                                              '32'),
                                       <'fin', '0'>, '32'), 
                                h(<<p_messages, '11', '0', pk(~ltkS)>, '15', 
                                   sign(<'server_cv', h(<p_messages, '11', '0', pk(~ltkS)>)>, ~ltkS)>)
                               >)
                         >)
                      >,
                      '32'),
               p_rms, p_cert_req
   ),
   SendStream( ~tid, $S, $C, <'auth', '0'>,
               Expand(Expand(p_ms,
                             <'serverats', 
                              h(<
                                 <<p_messages, '11', '0', pk(~ltkS)>, '15', 
                                  sign(<'server_cv', h(<p_messages, '11', '0', pk(~ltkS)>)>, ~ltkS)>, 
                                 '20', 
                                 hmac(<
                                       Expand(Expand(p_hs,
                                                     <'serverhts', 
                                                      h(<<p_messages, '11', '0', pk(~ltkS)>, '15', 
                                                         sign(<'server_cv', 
                                                               h(<p_messages, '11', '0', pk(~ltkS)>)>,
                                                              ~ltkS)
                                                        >)
                                                     >,
                                                     '32'),
                                              <'fin', '0'>, '32'), 
                                       h(<<p_messages, '11', '0', pk(~ltkS)>, '15', 
                                          sign(<'server_cv', h(<p_messages, '11', '0', pk(~ltkS)>)>, ~ltkS)>)
                                      >)
                                >)
                             >,
                             '32'),
                      <'adke_wk', '0'>, '32')
   ),
   Out( senc(<<'11', '0', pk(~ltkS)>, 
              <'15', sign(<'server_cv', h(<p_messages, '11', '0', pk(~ltkS)>)>, ~ltkS)
              >, 
              '20', 
              hmac(<
                    Expand(Expand(p_hs,
                                  <'serverhts', 
                                   h(<<p_messages, '11', '0', pk(~ltkS)>, '15', 
                                      sign(<'server_cv', h(<p_messages, '11', '0', pk(~ltkS)>)>, ~ltkS)>)
                                  >,
                                  '32'),
                           <'fin', '0'>, '32'), 
                    h(<<p_messages, '11', '0', pk(~ltkS)>, '15', 
                       sign(<'server_cv', h(<p_messages, '11', '0', pk(~ltkS)>)>, ~ltkS)>)
                   >)
             >,
             p_hs_keys)
   )
   ]

  /* has exactly the trivial AC variant */

rule (modulo E) recv_client_auth:
   [
   F_State_S3( ~tid, $S, $C, p_res_psk, p_messages, p_nc, p_ns, p_g, p_sg,
               p_hrr, p_x, p_y, p_gx, p_gy, p_gxy, p_psk_ke_mode, p_psk_id, p_edi, p_es,
               p_hs, p_ms, p_cats, p_sats, p_hs_keyc, p_hs_keys, p_auth_status, p_ems,
               p_rms, '0'
   ),
   In( senc(<'20', verify_data>, p_hs_keyc) )
   ]
  --[
  S3( ~tid ), Instance( ~tid, $S, 'server' ),
  Eq( verify_data,
      hmac(<
            Expand(Expand(p_hs, <'clienthts', h(p_messages)>, '32'), <'fin', '0'>,
                   '32'), 
            h(p_messages)>)
  ),
  RMode( ~tid, $S, 'server', p_psk_ke_mode ),
  CIdentity( ~tid, $S, 'server', <$C, p_auth_status> ),
  CHS( ~tid, $S, 'server', p_hs ),
  RHSMS( ~tid, $S, 'server', <p_hs, p_ms> ),
  RRMS( ~tid, $S, 'server',
        <$C, Expand(p_ms, <'rms', h(<p_messages, '20', verify_data>)>, '32'), 
         p_messages, '20', verify_data>
  ),
  CTranscript( ~tid, $S, 'server', <p_messages, '20', verify_data> ),
  CNonces( ~tid, $S, 'server', <p_nc, p_ns> ),
  SessionKey( ~tid, $S, $C, p_auth_status,
              <Expand(p_sats, <'adke_wk', '0'>, '32'), 
               Expand(p_cats, <'adke_wk', '0'>, '32')>
  )
  ]->
   [
   L_State_S4( ~tid, $S, $C, p_res_psk, <p_messages, '20', verify_data>,
               p_nc, p_ns, p_g, p_sg, p_hrr, p_x, p_y, p_gx, p_gy, p_gxy, p_psk_ke_mode,
               p_psk_id, p_edi, p_es, p_hs, p_ms, p_cats, p_sats, p_hs_keyc, p_hs_keys,
               p_auth_status, p_ems,
               Expand(p_ms, <'rms', h(<p_messages, '20', verify_data>)>, '32'), '0'
   ),
   RecvStream( ~tid, $S, $C, p_auth_status,
               Expand(p_cats, <'adke_wk', '0'>, '32')
   )
   ]

  /* has exactly the trivial AC variant */

rule (modulo E) recv_client_auth_cert:
   [
   F_State_S3( ~tid, $S, $C, p_res_psk, p_messages, p_nc, p_ns, p_g, p_sg,
               p_hrr, p_x, p_y, p_gx, p_gy, p_gxy, p_psk_ke_mode, p_psk_id, p_edi, p_es,
               p_hs, p_ms, p_cats, p_sats, p_hs_keyc, p_hs_keys, p_auth_status, p_ems,
               p_rms, '1'
   ),
   !Pk( $C, pk(~ltkC) ),
   SendStream( ~tid, $S, $C, p_auth_status, app_keys ),
   In( senc(<<'11', '0', pk(~ltkC)>, <'15', signature>, '20', verify_data>,
            p_hs_keyc)
   )
   ]
  --[
  S3_cert( ~tid ), Instance( ~tid, $S, 'server' ),
  Eq( verify(signature,
             <'client_cv', h(<p_messages, '11', '0', pk(~ltkC)>)>, pk(~ltkC)),
      true
  ),
  Eq( verify_data,
      hmac(<
            Expand(Expand(p_hs,
                          <'clienthts', h(<<p_messages, '11', '0', pk(~ltkC)>, '15', signature>)>,
                          '32'),
                   <'fin', '0'>, '32'), 
            h(<<p_messages, '11', '0', pk(~ltkC)>, '15', signature>)>)
  ),
  RMode( ~tid, $S, 'server', p_psk_ke_mode ),
  CIdentity( ~tid, $S, 'server', <$C, 'auth', 'auth'> ),
  CHS( ~tid, $S, 'server', p_hs ),
  RHSMS( ~tid, $S, 'server', <p_hs, p_ms> ),
  RRMS( ~tid, $S, 'server',
        <$C, 
         Expand(p_ms,
                <'rms', 
                 h(<<<p_messages, '11', '0', pk(~ltkC)>, '15', signature>, '20', 
                    verify_data>)
                >,
                '32'), 
         <<p_messages, '11', '0', pk(~ltkC)>, '15', signature>, '20', verify_data>
  ),
  CTranscript( ~tid, $S, 'server',
               <<<p_messages, '11', '0', pk(~ltkC)>, '15', signature>, '20', verify_data
               >
  ),
  SessionKey( ~tid, $S, $C, <'auth', 'auth'>,
              <app_keys, Expand(p_cats, <'adke_wk', '0'>, '32')>
  ),
  CNonces( ~tid, $S, 'server', <p_nc, p_ns> )
  ]->
   [
   L_State_S4( ~tid, $S, $C, p_res_psk,
               <<<p_messages, '11', '0', pk(~ltkC)>, '15', signature>, '20', verify_data
               >,
               p_nc, p_ns, p_g, p_sg, p_hrr, p_x, p_y, p_gx, p_gy, p_gxy, p_psk_ke_mode,
               p_psk_id, p_edi, p_es, p_hs, p_ms, p_cats, p_sats, p_hs_keyc, p_hs_keys,
               <'auth', 'auth'>, p_ems,
               Expand(p_ms,
                      <'rms', 
                       h(<<<p_messages, '11', '0', pk(~ltkC)>, '15', signature>, '20', 
                          verify_data>)
                      >,
                      '32'),
               '0'
   ),
   SendStream( ~tid, $S, $C, <'auth', 'auth'>, app_keys ),
   RecvStream( ~tid, $S, $C, <'auth', 'auth'>,
               Expand(p_cats, <'adke_wk', '0'>, '32')
   )
   ]

  // loop breaker: [2]
  /*
  rule (modulo AC) recv_client_auth_cert:
     [
     F_State_S3( ~tid, $S, $C, p_res_psk, p_messages, p_nc, p_ns, p_g, p_sg,
                 p_hrr, p_x, p_y, p_gx, p_gy, p_gxy, p_psk_ke_mode, p_psk_id, p_edi, p_es,
                 p_hs, p_ms, p_cats, p_sats, p_hs_keyc, p_hs_keys, p_auth_status, p_ems,
                 p_rms, '1'
     ),
     !Pk( $C, pk(~ltkC) ),
     SendStream( ~tid, $S, $C, p_auth_status, app_keys ),
     In( senc(<<'11', '0', pk(~ltkC)>, <'15', signature>, '20', verify_data>,
              p_hs_keyc)
     )
     ]
    --[
    S3_cert( ~tid ), Instance( ~tid, $S, 'server' ), Eq( z, true ),
    Eq( verify_data,
        hmac(<
              Expand(Expand(p_hs,
                            <'clienthts', h(<<p_messages, '11', '0', pk(~ltkC)>, '15', signature>)>,
                            '32'),
                     <'fin', '0'>, '32'), 
              h(<<p_messages, '11', '0', pk(~ltkC)>, '15', signature>)>)
    ),
    RMode( ~tid, $S, 'server', p_psk_ke_mode ),
    CIdentity( ~tid, $S, 'server', <$C, 'auth', 'auth'> ),
    CHS( ~tid, $S, 'server', p_hs ),
    RHSMS( ~tid, $S, 'server', <p_hs, p_ms> ),
    RRMS( ~tid, $S, 'server',
          <$C, 
           Expand(p_ms,
                  <'rms', 
                   h(<<<p_messages, '11', '0', pk(~ltkC)>, '15', signature>, '20', 
                      verify_data>)
                  >,
                  '32'), 
           <<p_messages, '11', '0', pk(~ltkC)>, '15', signature>, '20', verify_data>
    ),
    CTranscript( ~tid, $S, 'server',
                 <<<p_messages, '11', '0', pk(~ltkC)>, '15', signature>, '20', verify_data
                 >
    ),
    SessionKey( ~tid, $S, $C, <'auth', 'auth'>,
                <app_keys, Expand(p_cats, <'adke_wk', '0'>, '32')>
    ),
    CNonces( ~tid, $S, 'server', <p_nc, p_ns> )
    ]->
     [
     L_State_S4( ~tid, $S, $C, p_res_psk,
                 <<<p_messages, '11', '0', pk(~ltkC)>, '15', signature>, '20', verify_data
                 >,
                 p_nc, p_ns, p_g, p_sg, p_hrr, p_x, p_y, p_gx, p_gy, p_gxy, p_psk_ke_mode,
                 p_psk_id, p_edi, p_es, p_hs, p_ms, p_cats, p_sats, p_hs_keyc, p_hs_keys,
                 <'auth', 'auth'>, p_ems,
                 Expand(p_ms,
                        <'rms', 
                         h(<<<p_messages, '11', '0', pk(~ltkC)>, '15', signature>, '20', 
                            verify_data>)
                        >,
                        '32'),
                 '0'
     ),
     SendStream( ~tid, $S, $C, <'auth', 'auth'>, app_keys ),
     RecvStream( ~tid, $S, $C, <'auth', 'auth'>,
                 Expand(p_cats, <'adke_wk', '0'>, '32')
     )
     ]
    variants (modulo AC)
    1. ~ltkC = ~ltkC.61
       p_messages
             = p_messages.77
       signature
             = sign(<'client_cv', h(<p_messages.77, '11', '0', pk(~ltkC.61)>)>,
                    ~ltkC.61)
       z     = true
    
    2. ~ltkC = ~ltkC.73
       p_messages
             = p_messages.89
       signature
             = signature.101
       z     = verify(signature.101,
                      <'client_cv', h(<p_messages.89, '11', '0', pk(~ltkC.73)>)>, pk(~ltkC.73))
    // loop breaker: [2]
  */

rule (modulo E) client_hello_psk:
   [
   Fr( ~nc ), Fr( ~x ),
   !ClientPSK( $C, $S, p_res_psk, p_auth_status,
               <'4', $ticket_lifetime, ticket_age_add, ticket, '46', 
                $max_early_data_size>,
               psk_type
   )
   ]
  --[
  C0_PSK( ~nc ), Start( ~nc, $C, 'client' ),
  RPSK( ~nc, $C, 'client', <$S, p_res_psk, p_auth_status> ),
  Neq( p_res_psk, '0' ), DH( ~nc, $C, ~x )
  ]->
   [
   F_State_C1( ~nc, $C, $S, p_res_psk,
               <'0', '1', '0x0303', ~nc, '0', $cipher_suites, '0', <'43', '0x0304'>, 
                <'10', $g1, $g2>, <'40', $g1, $g1^~x>, <'45', '0', '1'>, <'42', '0'>, 
                '41', <ticket, mask(ticket_age_add, $ticket_age)>, 
                hmac(<
                      Expand(Expand(Extract(p_res_psk, '0'), <psk_type, 'pbk'>, '32'),
                             <'0', '0'>, '32'), 
                      h(<'0', '1', '0x0303', ~nc, '0', $cipher_suites, '0', <'43', '0x0304'>, 
                         <'10', $g1, $g2>, <'40', $g1, $g1^~x>, <'45', '0', '1'>, <'42', '0'>, 
                         '41', <ticket, mask(ticket_age_add, $ticket_age)>, '0'>)
                     >)
               >,
               ~nc, '0', $g1, <$g1, $g2>, '0', ~x, '0', $g1^~x, '0', '0', <'0', '1'>,
               ticket, <'42', '0'>, Extract(p_res_psk, '0'), '0', '0', '0', '0', '0',
               '0', p_auth_status, '0', '0', '0'
   ),
   F_CachePSK( ~nc, $S, p_res_psk, p_auth_status,
               <'4', $ticket_lifetime, ticket_age_add, ticket, '46', 
                $max_early_data_size>,
               psk_type
   ),
   EarlySendStream( ~nc, $C, $S, p_auth_status,
                    Expand(Expand(Extract(p_res_psk, '0'),
                                  <'cets', 
                                   h(<'0', '1', '0x0303', ~nc, '0', $cipher_suites, '0', <'43', '0x0304'>, 
                                      <'10', $g1, $g2>, <'40', $g1, $g1^~x>, <'45', '0', '1'>, <'42', '0'>, 
                                      '41', <ticket, mask(ticket_age_add, $ticket_age)>, 
                                      hmac(<
                                            Expand(Expand(Extract(p_res_psk, '0'), <psk_type, 'pbk'>, '32'),
                                                   <'0', '0'>, '32'), 
                                            h(<'0', '1', '0x0303', ~nc, '0', $cipher_suites, '0', 
                                               <'43', '0x0304'>, <'10', $g1, $g2>, <'40', $g1, $g1^~x>, 
                                               <'45', '0', '1'>, <'42', '0'>, '41', 
                                               <ticket, mask(ticket_age_add, $ticket_age)>, '0'>)
                                           >)
                                     >)
                                  >,
                                  '32'),
                           <'eadke_wk', '0'>, '32'),
                    <'42', '0'>
   ),
   DHExp( ~x, ~nc, $C ),
   Out( <'1', '0x0303', ~nc, '0', $cipher_suites, '0', <'43', '0x0304'>, 
         <'10', $g1, $g2>, <'40', $g1, $g1^~x>, <'45', '0', '1'>, <'42', '0'>, 
         '41', <ticket, mask(ticket_age_add, $ticket_age)>, 
         hmac(<
               Expand(Expand(Extract(p_res_psk, '0'), <psk_type, 'pbk'>, '32'),
                      <'0', '0'>, '32'), 
               h(<'0', '1', '0x0303', ~nc, '0', $cipher_suites, '0', <'43', '0x0304'>, 
                  <'10', $g1, $g2>, <'40', $g1, $g1^~x>, <'45', '0', '1'>, <'42', '0'>, 
                  '41', <ticket, mask(ticket_age_add, $ticket_age)>, '0'>)
              >)
        >
   )
   ]

  /* has exactly the trivial AC variant */

rule (modulo E) recv_hello_retry_request_psk:
   [
   F_State_C1( ~tid, $C, $S, p_res_psk, p_messages, p_nc, p_ns, $g1,
               <$g1, $g2>, '0', p_x, p_y, p_gx, p_gy, p_gxy, <'0', '1'>, p_psk_id,
               p_edi, p_es, p_hs, p_ms, p_cats, p_sats, p_hs_keyc, p_hs_keys,
               p_auth_status, p_ems, p_rms, p_cert_req
   ),
   F_CachePSK( ~tid, $S, p_res_psk, p_auth_status,
               <'4', $ticket_lifetime, ticket_age_add, ticket, '46', 
                $max_early_data_size>,
               psk_type
   ),
   Fr( ~new_nc ), Fr( ~new_x ), DHExp( p_x, ~tid, $C ),
   In( <'6', '0x0303', '40', $g2> )
   ]
  --[
  C1_retry_PSK( ~tid ), Neq( $g1, $g2 ), Instance( ~tid, $C, 'client' ),
  RPSK( ~tid, $C, 'client', <$S, p_res_psk, p_auth_status> ),
  DeleteDH( ~tid, $C, p_x ), DH( ~tid, $C, ~new_x )
  ]->
   [
   Out( <'1', '0x0303', ~new_nc, '0', $cipher_suites, '0', 
         <'43', '0x0304'>, <'10', $g1, $g2>, <'40', $g2, $g2^~new_x>, 
         <'45', '0', '1'>, '0', '41', <ticket, mask(ticket_age_add, '1')>, 
         hmac(<
               Expand(Expand(Extract(p_res_psk, '0'), <psk_type, 'pbk'>, '32'),
                      <'0', '0'>, '32'), 
               h(<<p_messages, '6', '0x0303', '40', $g2>, '1', '0x0303', ~new_nc, '0', 
                  $cipher_suites, '0', <'43', '0x0304'>, <'10', $g1, $g2>, 
                  <'40', $g2, $g2^~new_x>, <'45', '0', '1'>, '0', '41', 
                  <ticket, mask(ticket_age_add, '1')>, '0'>)
              >)
        >
   ),
   DHExp( ~new_x, ~tid, $C ),
   F_State_C1( ~tid, $C, $S, p_res_psk,
               <<p_messages, '6', '0x0303', '40', $g2>, '1', '0x0303', ~new_nc, '0', 
                $cipher_suites, '0', <'43', '0x0304'>, <'10', $g1, $g2>, 
                <'40', $g2, $g2^~new_x>, <'45', '0', '1'>, '0', '41', 
                <ticket, mask(ticket_age_add, '1')>, 
                hmac(<
                      Expand(Expand(Extract(p_res_psk, '0'), <psk_type, 'pbk'>, '32'),
                             <'0', '0'>, '32'), 
                      h(<<p_messages, '6', '0x0303', '40', $g2>, '1', '0x0303', ~new_nc, '0', 
                         $cipher_suites, '0', <'43', '0x0304'>, <'10', $g1, $g2>, 
                         <'40', $g2, $g2^~new_x>, <'45', '0', '1'>, '0', '41', 
                         <ticket, mask(ticket_age_add, '1')>, '0'>)
                     >)
               >,
               ~new_nc, p_ns, $g2, <$g1, $g2>, 'hrr', ~new_x, p_y, $g2^~new_x, p_gy,
               p_gxy, <'0', '1'>, ticket, '0', Extract(p_res_psk, '0'), p_hs, p_ms,
               p_cats, p_sats, p_hs_keyc, p_hs_keys, p_auth_status, p_ems, p_rms,
               p_cert_req
   )
   ]

  // loop breaker: [4]
  /* has exactly the trivial AC variant */

rule (modulo E) recv_server_hello_psk_dhe:
   [
   F_State_C1( ~tid, $C, $S, p_res_psk, p_messages, p_nc, p_ns, $g, p_sg,
               p_hrr, ~x, p_y, p_gx, p_gy, p_gxy, <'0', '1'>, ~ticket, p_edi, p_es,
               p_hs, p_ms, p_cats, p_sats, p_hs_keyc, p_hs_keys, p_auth_status, p_ems,
               p_rms, p_cert_req
   ),
   In( <'2', '0x0303', new_ns, $cipher_suite, <'13', $sig_algs>, 
        <'40', $g, $g^new_y>, <'41', '0'>, p_edi>
   )
   ]
  --[
  C1_PSK_DHE( ~tid ), Neq( $g^new_y, $g ), Instance( ~tid, $C, 'client' ),
  DHChal( $g, ~x, new_y, p_gx, $g^new_y, $g^new_y^~x ),
  RNonces( ~tid, $C, 'client', <p_nc, new_ns> )
  ]->
   [
   F_State_C2a( ~tid, $C, $S, p_res_psk,
                <p_messages, '2', '0x0303', new_ns, $cipher_suite, <'13', $sig_algs>, 
                 <'40', $g, $g^new_y>, <'41', '0'>, p_edi>,
                p_nc, new_ns, $g, p_sg, p_hrr, ~x, p_y, p_gx, $g^new_y, $g^new_y^~x, '1',
                ~ticket, p_edi, p_es, p_hs, p_ms, p_cats, p_sats, p_hs_keyc, p_hs_keys,
                p_auth_status, p_ems, p_rms, p_cert_req
   )
   ]

  /*
  rule (modulo AC) recv_server_hello_psk_dhe:
     [
     F_State_C1( ~tid, $C, $S, p_res_psk, p_messages, p_nc, p_ns, $g, p_sg,
                 p_hrr, ~x, p_y, p_gx, p_gy, p_gxy, <'0', '1'>, ~ticket, p_edi, p_es,
                 p_hs, p_ms, p_cats, p_sats, p_hs_keyc, p_hs_keys, p_auth_status, p_ems,
                 p_rms, p_cert_req
     ),
     In( <'2', '0x0303', new_ns, $cipher_suite, <'13', $sig_algs>, 
          <'40', $g, z>, <'41', '0'>, p_edi>
     )
     ]
    --[
    C1_PSK_DHE( ~tid ), Neq( z, $g ), Instance( ~tid, $C, 'client' ),
    DHChal( $g, ~x, new_y, p_gx, z, z.1 ),
    RNonces( ~tid, $C, 'client', <p_nc, new_ns> )
    ]->
     [
     F_State_C2a( ~tid, $C, $S, p_res_psk,
                  <p_messages, '2', '0x0303', new_ns, $cipher_suite, <'13', $sig_algs>, 
                   <'40', $g, z>, <'41', '0'>, p_edi>,
                  p_nc, new_ns, $g, p_sg, p_hrr, ~x, p_y, p_gx, z, z.1, '1', ~ticket,
                  p_edi, p_es, p_hs, p_ms, p_cats, p_sats, p_hs_keyc, p_hs_keys,
                  p_auth_status, p_ems, p_rms, p_cert_req
     )
     ]
    variants (modulo AC)
    1. $g    = $g.47
       ~x    = ~x.51
       new_y = inv(~x.51)
       z     = $g.47^inv(~x.51)
       z.1   = $g.47
    
    2. $g    = $g.47
       ~x    = ~x.51
       new_y = one
       z     = $g.47
       z.1   = $g.47^~x.51
    
    3. $g    = $g.49
       ~x    = ~x.53
       new_y = new_y.55
       z     = $g.49^new_y.55
       z.1   = $g.49^(~x.53*new_y.55)
    
    4. $g    = $g.317
       ~x    = ~x.321
       new_y = inv((~x.321*x.629))
       z     = $g.317^inv((~x.321*x.629))
       z.1   = $g.317^inv(x.629)
    
    5. $g    = $g.317
       ~x    = ~x.321
       new_y = (x.629*inv(~x.321))
       z     = $g.317^(x.629*inv(~x.321))
       z.1   = $g.317^x.629
    
    6. $g    = $g.318
       ~x    = ~x.322
       new_y = (x.631*inv((~x.322*x.630)))
       z     = $g.318^(x.631*inv((~x.322*x.630)))
       z.1   = $g.318^(x.631*inv(x.630))
  */

rule (modulo E) recv_server_hello_psk:
   [
   F_State_C1( ~tid, $C, $S, p_res_psk, p_messages, p_nc, p_ns, p_g, p_sg,
               p_hrr, p_x, p_y, p_gx, p_gy, p_gxy, <'0', '1'>, p_psk_id, p_edi, p_es,
               p_hs, p_ms, p_cats, p_sats, p_hs_keyc, p_hs_keys, p_auth_status, p_ems,
               p_rms, p_cert_req
   ),
   In( <'2', '0x0303', new_ns, $cipher_suite, <'13', $sig_algs>, 
        <'41', '0'>, p_edi>
   )
   ]
  --[
  C1_PSK( ~tid ), Instance( ~tid, $C, 'client' ),
  RNonces( ~tid, $C, 'client', <p_nc, new_ns> )
  ]->
   [
   F_State_C2a( ~tid, $C, $S, p_res_psk,
                <p_messages, '2', '0x0303', new_ns, $cipher_suite, <'13', $sig_algs>, 
                 <'41', '0'>, p_edi>,
                p_nc, new_ns, p_g, p_sg, p_hrr, p_x, p_y, p_gx, p_gy, p_gxy, '0',
                p_psk_id, p_edi, p_es, p_hs, p_ms, p_cats, p_sats, p_hs_keyc, p_hs_keys,
                p_auth_status, p_ems, p_rms, p_cert_req
   )
   ]

  /* has exactly the trivial AC variant */

rule (modulo E) recv_server_auth_psk:
   [
   F_State_C2d( ~tid, $C, $S, p_res_psk, p_messages, p_nc, p_ns, p_g, p_sg,
                p_hrr, p_x, p_y, p_gx, p_gy, p_gxy, p_psk_ke_mode, p_psk_id, p_edi, p_es,
                p_hs, p_ms, p_cats, p_sats, p_hs_keyc, p_hs_keys, p_auth_status, p_ems,
                p_rms, p_cert_req
   ),
   In( senc(<'20', verify_data>, p_hs_keys) )
   ]
  --[
  C2d_PSK( ~tid ), Neq( p_psk_ke_mode, 'na' ),
  Instance( ~tid, $C, 'client' ),
  Eq( verify_data,
      hmac(<
            Expand(Expand(p_hs, <'serverhts', h(p_messages)>, '32'), <'fin', '0'>,
                   '32'), 
            h(p_messages)>)
  ),
  RMode( ~tid, $C, 'client', p_psk_ke_mode ),
  CIdentity( ~tid, $C, 'client', <$S, p_auth_status> ),
  CHS( ~tid, $C, 'client', p_hs ),
  CNonces( ~tid, $C, 'client', <p_nc, p_ns> ),
  CTranscript( ~tid, $C, 'client', <p_messages, '20', verify_data> )
  ]->
   [
   F_State_C3( ~tid, $C, $S, p_res_psk, <p_messages, '20', verify_data>,
               p_nc, p_ns, p_g, p_sg, p_hrr, p_x, p_y, p_gx, p_gy, p_gxy, p_psk_ke_mode,
               p_psk_id, p_edi, p_es, p_hs, p_ms,
               Expand(p_ms, <'clientats', h(<p_messages, '20', verify_data>)>, '32'),
               Expand(p_ms, <'serverats', h(<p_messages, '20', verify_data>)>, '32'),
               p_hs_keyc, p_hs_keys, p_auth_status,
               Expand(p_ms, <'ems', h(<p_messages, '20', verify_data>)>, '32'), p_rms,
               p_cert_req
   ),
   RecvStream( ~tid, $C, $S, p_auth_status,
               Expand(Expand(p_ms, <'serverats', h(<p_messages, '20', verify_data>)>,
                             '32'),
                      <'adke_wk', '0'>, '32')
   )
   ]

  /* has exactly the trivial AC variant */

rule (modulo E) recv_client_hello_psk:
   [
   F_State_S0( ~tid, $S, $C, p_res_psk, p_messages, p_nc, p_ns, p_g, p_sg,
               p_hrr, p_x, p_y, p_gx, p_gy, p_gxy, p_psk_ke_mode, p_psk_id, p_edi, p_es,
               p_hs, p_ms, p_cats, p_sats, p_hs_keyc, p_hs_keys, p_auth_status, p_ems,
               p_rms, p_cert_req
   ),
   In( <'1', '0x0303', new_nc, '0', $cipher_suites, '0', <'43', '0x0304'>, 
        <'10', $g1, $g2>, <'40', $new_g, $new_g^new_x>, <'45', '0', '1'>, 
        new_edi, '41', <~ticket, obfuscated_ticket_age>, binder>
   ),
   Fr( ~ns ),
   !ServerPSK( $S, $C, psk_res_psk, psk_auth_status,
               <'4', $ticket_lifetime, ~ticket_age_add, ~ticket, '46', 
                $max_early_data_size>,
               psk_type
   )
   ]
  --[
  S0_PSK( ~tid ), Neq( $g1, $g2 ),
  Eq( unmask(obfuscated_ticket_age, ~ticket_age_add), '1' ),
  Eq( hmac(<
            Expand(Expand(Extract(psk_res_psk, '0'), <psk_type, 'pbk'>, '32'),
                   <'0', '0'>, '32'), 
            h(<p_messages, '1', '0x0303', new_nc, '0', $cipher_suites, '0', 
               <'43', '0x0304'>, <'10', $g1, $g2>, <'40', $new_g, $new_g^new_x>, 
               <'45', '0', '1'>, new_edi, '41', <~ticket, obfuscated_ticket_age>, '0'>)
           >),
      binder
  ),
  RPSK( ~tid, $S, 'server', <$C, psk_res_psk, psk_auth_status> ),
  Neq( psk_res_psk, '0' )
  ]->
   [
   F_State_S1( ~tid, $S, $C, psk_res_psk,
               <p_messages, '1', '0x0303', new_nc, '0', $cipher_suites, '0', 
                <'43', '0x0304'>, <'10', $g1, $g2>, <'40', $new_g, $new_g^new_x>, 
                <'45', '0', '1'>, new_edi, '41', <~ticket, obfuscated_ticket_age>, binder
               >,
               new_nc, ~ns, $new_g, p_sg, p_hrr, p_x, p_y, $new_g^new_x, p_gy, p_gxy,
               <'0', '1'>, ~ticket, new_edi, Extract(psk_res_psk, '0'), p_hs, p_ms,
               p_cats, p_sats, p_hs_keyc, p_hs_keys, psk_auth_status, p_ems, p_rms,
               p_cert_req
   ),
   EarlyRecvStream( ~tid, $S, $C, psk_auth_status,
                    Expand(Expand(Extract(psk_res_psk, '0'),
                                  <'cets', 
                                   h(<p_messages, '1', '0x0303', new_nc, '0', $cipher_suites, '0', 
                                      <'43', '0x0304'>, <'10', $g1, $g2>, <'40', $new_g, $new_g^new_x>, 
                                      <'45', '0', '1'>, new_edi, '41', <~ticket, obfuscated_ticket_age>, 
                                      binder>)
                                  >,
                                  '32'),
                           <'eadke_wk', '0'>, '32'),
                    new_edi
   )
   ]

  /*
  rule (modulo AC) recv_client_hello_psk:
     [
     F_State_S0( ~tid, $S, $C, p_res_psk, p_messages, p_nc, p_ns, p_g, p_sg,
                 p_hrr, p_x, p_y, p_gx, p_gy, p_gxy, p_psk_ke_mode, p_psk_id, p_edi, p_es,
                 p_hs, p_ms, p_cats, p_sats, p_hs_keyc, p_hs_keys, p_auth_status, p_ems,
                 p_rms, p_cert_req
     ),
     In( <'1', '0x0303', new_nc, '0', $cipher_suites, '0', <'43', '0x0304'>, 
          <'10', $g1, $g2>, <'40', $new_g, z>, <'45', '0', '1'>, new_edi, '41', 
          <~ticket, obfuscated_ticket_age>, binder>
     ),
     Fr( ~ns ),
     !ServerPSK( $S, $C, psk_res_psk, psk_auth_status,
                 <'4', $ticket_lifetime, ~ticket_age_add, ~ticket, '46', 
                  $max_early_data_size>,
                 psk_type
     )
     ]
    --[
    S0_PSK( ~tid ), Neq( $g1, $g2 ), Eq( z.1, '1' ),
    Eq( hmac(<
              Expand(Expand(Extract(psk_res_psk, '0'), <psk_type, 'pbk'>, '32'),
                     <'0', '0'>, '32'), 
              h(<p_messages, '1', '0x0303', new_nc, '0', $cipher_suites, '0', 
                 <'43', '0x0304'>, <'10', $g1, $g2>, <'40', $new_g, z>, <'45', '0', '1'>, 
                 new_edi, '41', <~ticket, obfuscated_ticket_age>, '0'>)
             >),
        binder
    ),
    RPSK( ~tid, $S, 'server', <$C, psk_res_psk, psk_auth_status> ),
    Neq( psk_res_psk, '0' )
    ]->
     [
     F_State_S1( ~tid, $S, $C, psk_res_psk,
                 <p_messages, '1', '0x0303', new_nc, '0', $cipher_suites, '0', 
                  <'43', '0x0304'>, <'10', $g1, $g2>, <'40', $new_g, z>, <'45', '0', '1'>, 
                  new_edi, '41', <~ticket, obfuscated_ticket_age>, binder>,
                 new_nc, ~ns, $new_g, p_sg, p_hrr, p_x, p_y, z, p_gy, p_gxy, <'0', '1'>,
                 ~ticket, new_edi, Extract(psk_res_psk, '0'), p_hs, p_ms, p_cats, p_sats,
                 p_hs_keyc, p_hs_keys, psk_auth_status, p_ems, p_rms, p_cert_req
     ),
     EarlyRecvStream( ~tid, $S, $C, psk_auth_status,
                      Expand(Expand(Extract(psk_res_psk, '0'),
                                    <'cets', 
                                     h(<p_messages, '1', '0x0303', new_nc, '0', $cipher_suites, '0', 
                                        <'43', '0x0304'>, <'10', $g1, $g2>, <'40', $new_g, z>, 
                                        <'45', '0', '1'>, new_edi, '41', <~ticket, obfuscated_ticket_age>, 
                                        binder>)
                                    >,
                                    '32'),
                             <'eadke_wk', '0'>, '32'),
                      new_edi
     )
     ]
    variants (modulo AC)
    1. $new_g
             = $new_g.74
       ~ticket_age_add
             = ~ticket_age_add.78
       obfuscated_ticket_age
             = obfuscated_ticket_age.84
       z     = $new_g.74
       z.1   = unmask(obfuscated_ticket_age.84, ~ticket_age_add.78)
    
    2. $new_g
             = $new_g.119
       ~ticket_age_add
             = ~ticket_age_add.123
       obfuscated_ticket_age
             = mask(~ticket_age_add.123, z.174)
       z     = $new_g.119
       z.1   = z.174
    
    3. $new_g
             = $new_g.119
       ~ticket_age_add
             = ~ticket_age_add.123
       obfuscated_ticket_age
             = mask(z.174, ~ticket_age_add.123)
       z     = $new_g.119
       z.1   = z.174
    
    4. $new_g
             = $new_g.934
       ~ticket_age_add
             = ~ticket_age_add.938
       obfuscated_ticket_age
             = obfuscated_ticket_age.944
       z     = $new_g.934^new_x.1860
       z.1   = unmask(obfuscated_ticket_age.944, ~ticket_age_add.938)
    
    5. $new_g
             = $new_g.936
       ~ticket_age_add
             = ~ticket_age_add.940
       obfuscated_ticket_age
             = mask(~ticket_age_add.940, z.991)
       z     = $new_g.936^new_x.1864
       z.1   = z.991
    
    6. $new_g
             = $new_g.936
       ~ticket_age_add
             = ~ticket_age_add.940
       obfuscated_ticket_age
             = mask(z.991, ~ticket_age_add.940)
       z     = $new_g.936^new_x.1864
       z.1   = z.991
  */

rule (modulo E) server_hello_psk_dhe:
   [
   F_State_S1( ~tid, $S, $C, p_res_psk, p_messages, p_nc, ~ns, $g, p_sg,
               p_hrr, p_x, p_y, $g^some_x, p_gy, p_gxy, <'0', '1'>, ~ticket, p_edi,
               p_es, p_hs, p_ms, p_cats, p_sats, p_hs_keyc, p_hs_keys, p_auth_status,
               p_ems, p_rms, p_cert_req
   ),
   Fr( ~y )
   ]
  --[
  S1_PSK_DHE( ~tid ), Neq( $g^some_x, $g ), Neq( p_x, inv(~y) ),
  Instance( ~tid, $S, 'server' ),
  DHChal( $g, some_x, ~y, $g^some_x, $g^~y, $g^some_x^~y ),
  RNonces( ~tid, $S, 'server', <p_nc, ~ns> ), DH( ~tid, $S, ~y )
  ]->
   [
   F_State_S2a( ~tid, $S, $C, p_res_psk,
                <p_messages, '2', '0x0303', ~ns, $cipher_suite, <'13', $sig_algs>, 
                 <'40', $g, $g^~y>, <'41', '0'>, p_edi>,
                p_nc, ~ns, $g, p_sg, p_hrr, p_x, ~y, $g^some_x, $g^~y, $g^some_x^~y, '1',
                ~ticket, p_edi, Extract(p_res_psk, '0'), p_hs, p_ms, p_cats, p_sats,
                p_hs_keyc, p_hs_keys, p_auth_status, p_ems, p_rms, p_cert_req
   ),
   DHExp( ~y, ~tid, $S ),
   Out( <'2', '0x0303', ~ns, $cipher_suite, <'13', $sig_algs>, 
         <'40', $g, $g^~y>, <'41', '0'>, p_edi>
   )
   ]

  /*
  rule (modulo AC) server_hello_psk_dhe:
     [
     F_State_S1( ~tid, $S, $C, p_res_psk, p_messages, p_nc, ~ns, $g, p_sg,
                 p_hrr, p_x, p_y, z, p_gy, p_gxy, <'0', '1'>, ~ticket, p_edi, p_es, p_hs,
                 p_ms, p_cats, p_sats, p_hs_keyc, p_hs_keys, p_auth_status, p_ems, p_rms,
                 p_cert_req
     ),
     Fr( ~y )
     ]
    --[
    S1_PSK_DHE( ~tid ), Neq( z, $g ), Neq( p_x, inv(~y) ),
    Instance( ~tid, $S, 'server' ), DHChal( $g, some_x, ~y, z, $g^~y, z.1 ),
    RNonces( ~tid, $S, 'server', <p_nc, ~ns> ), DH( ~tid, $S, ~y )
    ]->
     [
     F_State_S2a( ~tid, $S, $C, p_res_psk,
                  <p_messages, '2', '0x0303', ~ns, $cipher_suite, <'13', $sig_algs>, 
                   <'40', $g, $g^~y>, <'41', '0'>, p_edi>,
                  p_nc, ~ns, $g, p_sg, p_hrr, p_x, ~y, z, $g^~y, z.1, '1', ~ticket, p_edi,
                  Extract(p_res_psk, '0'), p_hs, p_ms, p_cats, p_sats, p_hs_keyc,
                  p_hs_keys, p_auth_status, p_ems, p_rms, p_cert_req
     ),
     DHExp( ~y, ~tid, $S ),
     Out( <'2', '0x0303', ~ns, $cipher_suite, <'13', $sig_algs>, 
           <'40', $g, $g^~y>, <'41', '0'>, p_edi>
     )
     ]
    variants (modulo AC)
    1. $g    = $g.48
       ~y    = ~y.53
       some_x
             = inv(~y.53)
       z     = $g.48^inv(~y.53)
       z.1   = $g.48
    
    2. $g    = $g.48
       ~y    = ~y.53
       some_x
             = one
       z     = $g.48
       z.1   = $g.48^~y.53
    
    3. $g    = $g.70
       ~y    = ~y.75
       some_x
             = some_x.97
       z     = $g.70^some_x.97
       z.1   = $g.70^(~y.75*some_x.97)
    
    4. $g    = $g.642
       ~y    = ~y.647
       some_x
             = inv((~y.647*x.1279))
       z     = $g.642^inv((~y.647*x.1279))
       z.1   = $g.642^inv(x.1279)
    
    5. $g    = $g.642
       ~y    = ~y.647
       some_x
             = (x.1279*inv(~y.647))
       z     = $g.642^(x.1279*inv(~y.647))
       z.1   = $g.642^x.1279
    
    6. $g    = $g.643
       ~y    = ~y.648
       some_x
             = (x.1281*inv((~y.648*x.1280)))
       z     = $g.643^(x.1281*inv((~y.648*x.1280)))
       z.1   = $g.643^(x.1281*inv(x.1280))
  */

rule (modulo E) server_hello_psk:
   [
   F_State_S1( ~tid, $S, $C, p_res_psk, p_messages, p_nc, ~ns, p_g, p_sg,
               p_hrr, p_x, p_y, p_gx, p_gy, p_gxy, <'0', '1'>, ~ticket, p_edi, p_es,
               p_hs, p_ms, p_cats, p_sats, p_hs_keyc, p_hs_keys, p_auth_status, p_ems,
               p_rms, p_cert_req
   ),
   Fr( ~y_ignored )
   ]
  --[
  S1_PSK( ~tid ), Instance( ~tid, $S, 'server' ),
  RNonces( ~tid, $S, 'server', <p_nc, ~ns> ), DH( ~tid, $S, ~y_ignored )
  ]->
   [
   F_State_S2a( ~tid, $S, $C, p_res_psk,
                <p_messages, '2', '0x0303', ~ns, $cipher_suite, <'13', $sig_algs>, 
                 <'41', '0'>, p_edi>,
                p_nc, ~ns, p_g, p_sg, p_hrr, p_x, ~y_ignored, p_gx, p_gy, p_gxy, '0',
                ~ticket, p_edi, Extract(p_res_psk, '0'), p_hs, p_ms, p_cats, p_sats,
                p_hs_keyc, p_hs_keys, p_auth_status, p_ems, p_rms, p_cert_req
   ),
   DHExp( ~y_ignored, ~tid, $S ),
   Out( <'2', '0x0303', ~ns, $cipher_suite, <'13', $sig_algs>, <'41', '0'>, 
         p_edi>
   )
   ]

  /* has exactly the trivial AC variant */

rule (modulo E) server_auth_psk:
   [
   F_State_S2d( ~tid, $S, $C, p_res_psk, p_messages, p_nc, p_ns, p_g, p_sg,
                p_hrr, p_x, p_y, p_gx, p_gy, p_gxy, p_psk_ke_mode, p_psk_id, p_edi, p_es,
                p_hs, p_ms, p_cats, p_sats, p_hs_keyc, p_hs_keys, p_auth_status, p_ems,
                p_rms, p_cert_req
   )
   ]
  --[
  S2d_PSK( ~tid ), Neq( p_psk_ke_mode, 'na' ),
  Instance( ~tid, $S, 'server' ),
  RTranscript( ~tid, $S, 'server',
               <p_messages, '20', 
                hmac(<
                      Expand(Expand(p_hs, <'serverhts', h(p_messages)>, '32'), <'fin', '0'>,
                             '32'), 
                      h(p_messages)>)
               >
  )
  ]->
   [
   F_State_S3( ~tid, $S, $C, p_res_psk,
               <p_messages, '20', 
                hmac(<
                      Expand(Expand(p_hs, <'serverhts', h(p_messages)>, '32'), <'fin', '0'>,
                             '32'), 
                      h(p_messages)>)
               >,
               p_nc, p_ns, p_g, p_sg, p_hrr, p_x, p_y, p_gx, p_gy, p_gxy, p_psk_ke_mode,
               p_psk_id, p_edi, p_es, p_hs, p_ms,
               Expand(p_ms,
                      <'clientats', 
                       h(<p_messages, '20', 
                          hmac(<
                                Expand(Expand(p_hs, <'serverhts', h(p_messages)>, '32'), <'fin', '0'>,
                                       '32'), 
                                h(p_messages)>)
                         >)
                      >,
                      '32'),
               Expand(p_ms,
                      <'serverats', 
                       h(<p_messages, '20', 
                          hmac(<
                                Expand(Expand(p_hs, <'serverhts', h(p_messages)>, '32'), <'fin', '0'>,
                                       '32'), 
                                h(p_messages)>)
                         >)
                      >,
                      '32'),
               p_hs_keyc, p_hs_keys, p_auth_status,
               Expand(p_ms,
                      <'ems', 
                       h(<p_messages, '20', 
                          hmac(<
                                Expand(Expand(p_hs, <'serverhts', h(p_messages)>, '32'), <'fin', '0'>,
                                       '32'), 
                                h(p_messages)>)
                         >)
                      >,
                      '32'),
               p_rms, p_cert_req
   ),
   SendStream( ~tid, $S, $C, p_auth_status,
               Expand(Expand(p_ms,
                             <'serverats', 
                              h(<p_messages, '20', 
                                 hmac(<
                                       Expand(Expand(p_hs, <'serverhts', h(p_messages)>, '32'), <'fin', '0'>,
                                              '32'), 
                                       h(p_messages)>)
                                >)
                             >,
                             '32'),
                      <'adke_wk', '0'>, '32')
   ),
   Out( senc(<'20', 
              hmac(<
                    Expand(Expand(p_hs, <'serverhts', h(p_messages)>, '32'), <'fin', '0'>,
                           '32'), 
                    h(p_messages)>)
             >,
             p_hs_keys)
   )
   ]

  /* has exactly the trivial AC variant */

rule (modulo E) send:
   [
   SendStream( ~tid, $actor, $peer, auth_status, app_key_out ), Fr( ~data )
   ]
  --[ Send( ~tid ), SendData( ~tid, $actor, $peer, auth_status, ~data ) ]->
   [
   SendStream( ~tid, $actor, $peer, auth_status, app_key_out ),
   Out( senc(<~data, '23'>, app_key_out) )
   ]

  // loop breaker: [0]
  /* has exactly the trivial AC variant */

rule (modulo E) recv:
   [
   RecvStream( ~tid, $actor, $peer, auth_status, app_key_in ),
   In( senc(<data, '23'>, app_key_in) )
   ]
  --[ Recv( ~tid ), RecvData( ~tid, $actor, $peer, auth_status, data ) ]->
   [ RecvStream( ~tid, $actor, $peer, auth_status, app_key_in ) ]

  // loop breaker: [0]
  /* has exactly the trivial AC variant */

rule (modulo E) end_early_data:
   [ EarlySendStream( tid, $C, $S, auth_status, ead_keyc, <'42', '0'> ) ]
  --[ C_EndZeroRTT( tid ) ]->
   [ Out( senc(<'1', '21'>, ead_keyc) ) ]

  /* has exactly the trivial AC variant */

rule (modulo E) recv_end_early_data:
   [
   EarlyRecvStream( tid, $S, $C, auth_status, ead_keyc, <'42', '0'> ),
   In( senc(<'1', '21'>, ead_keyc) )
   ]
  --[ S_RecvEndZeroRTT( tid ) ]->
   [ ]

  /* has exactly the trivial AC variant */

rule (modulo E) send_early_data:
   [
   EarlySendStream( tid, $C, $S, auth_status, ead_keyc, <'42', '0'> ),
   Fr( ~data )
   ]
  --[ C_SendZeroRTT( tid ) ]->
   [
   EarlySendStream( tid, $C, $S, auth_status, ead_keyc, <'42', '0'> ),
   Out( senc(<~data, '23'>, ead_keyc) )
   ]

  // loop breaker: [0]
  /* has exactly the trivial AC variant */

rule (modulo E) recv_early_data:
   [
   EarlyRecvStream( tid, $S, $C, auth_status, ead_keyc, <'42', '0'> ),
   In( senc(<data, '23'>, ead_keyc) )
   ]
  --[ S_RecvZeroRTT( tid ) ]->
   [ EarlyRecvStream( tid, $S, $C, auth_status, ead_keyc, <'42', '0'> ) ]

  // loop breaker: [0]
  /* has exactly the trivial AC variant */

rule (modulo E) out_of_band_psk:
   [ Fr( ~ticket ), Fr( ~res_psk ), Fr( ~ticket_age_add ) ]
  --[
  GenPSK( $S, 'server' ), GenPSK( $C, 'client' ),
  FreshPSK( ~ticket, ~res_psk )
  ]->
   [
   !ClientPSK( $C, $S, ~res_psk, <'oob_auth', 'oob_auth'>,
               <'4', $ticket_lifetime, ~ticket_age_add, ~ticket, '46', 
                $max_early_data_size>,
               'ext'
   ),
   !ServerPSK( $S, $C, ~res_psk, <'oob_auth', 'oob_auth'>,
               <'4', $ticket_lifetime, ~ticket_age_add, ~ticket, '46', 
                $max_early_data_size>,
               'ext'
   ),
   SecretPSK( $S, ~res_psk ), SecretPSK( $C, ~res_psk )
   ]

  /* has exactly the trivial AC variant */

rule (modulo E) new_session_ticket:
   [
   L_State_S4( ~tid, $S, $C, p_res_psk, p_messages, p_nc, p_ns, p_g, p_sg,
               p_hrr, p_x, p_y, p_gx, p_gy, p_gxy, p_psk_ke_mode, p_psk_id, p_edi, p_es,
               p_hs, p_ms, p_cats, p_sats, p_hs_keyc, p_hs_keys, p_auth_status, p_ems,
               Expand(ms, <'rms', h(messages)>, '32'), p_cert_req
   ),
   SendStream( ~tid, $S, $C, p_auth_status, app_keys ), Fr( ~ticket ),
   Fr( ~ticket_age_add )
   ]
  --[
  S4_NST( ~tid ), Instance( ~tid, $S, 'server' ),
  RPostHS( ~tid, $S, 'server',
           <p_hs, Expand(ms, <'rms', h(messages)>, '32'), $C, p_auth_status, 
            p_messages>
  ),
  RNST( ~tid, $S, 'server', <~ticket, ~ticket_age_add> )
  ]->
   [
   L_State_S4( ~tid, $S, $C, Expand(ms, <'rms', h(messages)>, '32'),
               p_messages, p_nc, p_ns, p_g, p_sg, p_hrr, p_x, p_y, p_gx, p_gy, p_gxy,
               p_psk_ke_mode, p_psk_id, p_edi, p_es, p_hs, p_ms, p_cats, p_sats,
               p_hs_keyc, p_hs_keys, p_auth_status, p_ems,
               Expand(ms, <'rms', h(messages)>, '32'), p_cert_req
   ),
   SendStream( ~tid, $S, $C, p_auth_status, app_keys ),
   !ServerPSK( $S, $C, Expand(ms, <'rms', h(messages)>, '32'),
               p_auth_status,
               <'4', $ticket_lifetime, ~ticket_age_add, ~ticket, '46', 
                $max_early_data_size>,
               'res'
   ),
   SecretPSK( $S, Expand(ms, <'rms', h(messages)>, '32') ),
   Out( senc(<'4', $ticket_lifetime, ~ticket_age_add, ~ticket, '46', 
              $max_early_data_size>,
             app_keys)
   )
   ]

  // loop breakers: [0,1]
  /* has exactly the trivial AC variant */

rule (modulo E) recv_new_session_ticket:
   [
   L_State_C4( ~tid, $C, $S, p_res_psk, p_messages, p_nc, p_ns, p_g, p_sg,
               p_hrr, p_x, p_y, p_gx, p_gy, p_gxy, p_psk_ke_mode, p_psk_id, p_edi, p_es,
               p_hs, p_ms, p_cats, p_sats, p_hs_keyc, p_hs_keys, p_auth_status, p_ems,
               Expand(ms, <'rms', h(messages)>, '32'), p_cert_req
   ),
   RecvStream( ~tid, $C, $S, p_auth_status, app_keys ),
   In( senc(<'4', $ticket_lifetime, ticket_age_add, ticket, '46', 
             $max_early_data_size>,
            app_keys)
   )
   ]
  --[
  C4_NST( ~tid ), Instance( ~tid, $C, 'client' ),
  RPostHS( ~tid, $C, 'client',
           <p_hs, Expand(ms, <'rms', h(messages)>, '32'), $S, p_auth_status, 
            p_messages>
  )
  ]->
   [
   L_State_C4( ~tid, $C, $S, Expand(ms, <'rms', h(messages)>, '32'),
               p_messages, p_nc, p_ns, p_g, p_sg, p_hrr, p_x, p_y, p_gx, p_gy, p_gxy,
               p_psk_ke_mode, p_psk_id, p_edi, p_es, p_hs, p_ms, p_cats, p_sats,
               p_hs_keyc, p_hs_keys, p_auth_status, p_ems,
               Expand(ms, <'rms', h(messages)>, '32'), p_cert_req
   ),
   RecvStream( ~tid, $C, $S, p_auth_status, app_keys ),
   !ClientPSK( $C, $S, Expand(ms, <'rms', h(messages)>, '32'),
               p_auth_status,
               <'4', $ticket_lifetime, ticket_age_add, ticket, '46', 
                $max_early_data_size>,
               'res'
   ),
   SecretPSK( $C, Expand(ms, <'rms', h(messages)>, '32') )
   ]

  // loop breakers: [0,1]
  /* has exactly the trivial AC variant */

rule (modulo E) certificate_request_post:
   [
   L_State_S4( ~tid, $S, $C, p_res_psk, p_messages, p_nc, p_ns, p_g, p_sg,
               p_hrr, p_x, p_y, p_gx, p_gy, p_gxy, p_psk_ke_mode, p_psk_id, p_edi, p_es,
               p_hs, p_ms, p_cats, p_sats, p_hs_keyc, p_hs_keys, p_auth_status, p_ems,
               p_rms, p_cert_req
   ),
   SendStream( ~tid, $S, $C, p_auth_status, app_keys ), Fr( ~cert_req_ctxt )
   ]
  --[
  S4_req( ~tid ), Instance( ~tid, $S, 'server' ),
  RCertReqCtxt( ~tid, $S, 'server', ~cert_req_ctxt ),
  RPostHS( ~tid, $S, 'server', <p_hs, p_rms, $C, p_auth_status, p_messages>
  )
  ]->
   [
   L_State_S4( ~tid, $S, $C, p_res_psk, p_messages, p_nc, p_ns, p_g, p_sg,
               p_hrr, p_x, p_y, p_gx, p_gy, p_gxy, p_psk_ke_mode, p_psk_id, p_edi, p_es,
               p_hs, p_ms, p_cats, p_sats, p_hs_keyc, p_hs_keys, p_auth_status, p_ems,
               p_rms, p_cert_req
   ),
   SendStream( ~tid, $S, $C, p_auth_status, app_keys ),
   L_ServerCertReq( ~tid, $S, $C, ~cert_req_ctxt ),
   Out( senc(<'13', ~cert_req_ctxt, $certificate_extensions>, app_keys) )
   ]

  // loop breakers: [1,0]
  /* has exactly the trivial AC variant */

rule (modulo E) recv_certificate_request_post:
   [
   L_State_C4( ~tid, $C, $S, p_res_psk, p_messages, p_nc, p_ns, p_g, p_sg,
               p_hrr, p_x, p_y, p_gx, p_gy, p_gxy, p_psk_ke_mode, p_psk_id, p_edi, p_es,
               p_hs, p_ms, p_cats, p_sats, p_hs_keyc, p_hs_keys, p_auth_status, p_ems,
               p_rms, p_cert_req
   ),
   RecvStream( ~tid, $C, $S, p_auth_status, app_keys ),
   In( senc(<'13', certificate_request_context, $certificate_extensions>,
            app_keys)
   )
   ]
  --[
  C4_req( ~tid ), Neq( certificate_request_context, '0' ),
  Instance( ~tid, $C, 'client' ),
  RPostHS( ~tid, $C, 'client', <p_hs, p_rms, $S, p_auth_status, p_messages>
  )
  ]->
   [
   L_State_C4( ~tid, $C, $S, p_res_psk, p_messages, p_nc, p_ns, p_g, p_sg,
               p_hrr, p_x, p_y, p_gx, p_gy, p_gxy, p_psk_ke_mode, p_psk_id, p_edi, p_es,
               p_hs, p_ms, p_cats, p_sats, p_hs_keyc, p_hs_keys, p_auth_status, p_ems,
               p_rms, p_cert_req
   ),
   RecvStream( ~tid, $C, $S, p_auth_status, app_keys ),
   L_ClientCertReq( ~tid, $C, $S, certificate_request_context )
   ]

  // loop breakers: [1,0]
  /* has exactly the trivial AC variant */

rule (modulo E) client_auth_post:
   [
   L_State_C4( ~tid, $C, $S, p_res_psk, p_messages, p_nc, p_ns, p_g, p_sg,
               p_hrr, p_x, p_y, p_gx, p_gy, p_gxy, p_psk_ke_mode, p_psk_id, p_edi, p_es,
               p_hs, p_ms, p_cats, p_sats, p_hs_keyc, p_hs_keys, <p_cas, p_sas>, p_ems,
               p_rms, p_cert_req
   ),
   SendStream( ~tid, $C, $S, <p_cas, p_sas>, app_keyc ), !Ltk( $C, ~ltkC ),
   L_ClientCertReq( ~tid, $C, $S, certificate_request_context )
   ]
  --[
  C4_cert( ~tid ), Instance( ~tid, $C, 'client' ),
  Neq( certificate_request_context, '0' ),
  UseLtk( ~ltkC,
          sign(<'client_cv', 
                h(<p_messages, '13', certificate_request_context, $certificate_extensions
                  >)
               >,
               ~ltkC)
  ),
  RTranscriptPost( ~tid, $C, 'client',
                   <p_messages, certificate_request_context>
  ),
  RPostHS( ~tid, $C, 'client',
           <p_hs, p_rms, $S, <'auth', p_sas>, p_messages>
  )
  ]->
   [
   L_State_C4( ~tid, $C, $S, p_res_psk, p_messages, p_nc, p_ns, p_g, p_sg,
               p_hrr, p_x, p_y, p_gx, p_gy, p_gxy, p_psk_ke_mode, p_psk_id, p_edi, p_es,
               p_hs, p_ms, p_cats, p_sats, p_hs_keyc, p_hs_keys, <'auth', p_sas>, p_ems,
               p_rms, p_cert_req
   ),
   SendStream( ~tid, $C, $S, <'auth', p_sas>, app_keyc ),
   Out( senc(<<'11', certificate_request_context, pk(~ltkC)>, 
              <'15', 
               sign(<'client_cv', 
                     h(<p_messages, '13', certificate_request_context, $certificate_extensions
                       >)
                    >,
                    ~ltkC)
              >, 
              '20', 
              hmac(<
                    Expand(Expand(p_hs,
                                  <'fin_keychts', 
                                   h(<p_messages, '13', certificate_request_context, $certificate_extensions
                                     >)
                                  >,
                                  '32'),
                           <'fin', '0'>, '32'), 
                    h(<p_messages, '13', certificate_request_context, $certificate_extensions
                      >)
                   >)
             >,
             app_keyc)
   )
   ]

  // loop breakers: [0,1]
  /* has exactly the trivial AC variant */

rule (modulo E) recv_client_auth_post:
   [
   L_State_S4( ~tid, $S, $C, p_res_psk, p_messages, p_nc, p_ns, p_g, p_sg,
               p_hrr, p_x, p_y, p_gx, p_gy, p_gxy, p_psk_ke_mode, p_psk_id, p_edi, p_es,
               p_hs, p_ms, p_cats, p_sats, p_hs_keyc, p_hs_keys, <p_sas, p_cas>, p_ems,
               p_rms, p_cert_req
   ),
   RecvStream( ~tid, $S, $C, <p_sas, p_cas>, app_keyc ),
   !Pk( $C, pk(~ltkC) ), L_ServerCertReq( ~tid, $S, $C, ~cert_req_ctxt ),
   In( senc(<<'11', ~cert_req_ctxt, pk(~ltkC)>, <'15', signature>, '20', 
             verify_data>,
            app_keyc)
   )
   ]
  --[
  S4_cert( ~tid ), Instance( ~tid, $S, 'server' ),
  Neq( ~cert_req_ctxt, '0' ),
  Eq( verify(signature,
             <'client_cv', 
              h(<p_messages, '13', ~cert_req_ctxt, $certificate_extensions>)>,
             pk(~ltkC)),
      true
  ),
  Eq( verify_data,
      hmac(<
            Expand(Expand(p_hs,
                          <'fin_keychts', 
                           h(<p_messages, '13', ~cert_req_ctxt, $certificate_extensions>)>,
                          '32'),
                   <'fin', '0'>, '32'), 
            h(<p_messages, '13', ~cert_req_ctxt, $certificate_extensions>)>)
  ),
  CIdentityPost( ~tid, $S, 'server', <$C, p_sas, 'auth'> ),
  CTranscriptPost( ~tid, $S, 'server', <p_messages, ~cert_req_ctxt> ),
  CHS( ~tid, $S, 'server', p_hs ),
  RPostHS( ~tid, $S, 'server',
           <p_hs, p_rms, $C, <p_sas, 'auth'>, p_messages>
  )
  ]->
   [
   L_State_S4( ~tid, $S, $C, p_res_psk, p_messages, p_nc, p_ns, p_g, p_sg,
               p_hrr, p_x, p_y, p_gx, p_gy, p_gxy, p_psk_ke_mode, p_psk_id, p_edi, p_es,
               p_hs, p_ms, p_cats, p_sats, p_hs_keyc, p_hs_keys, <p_sas, 'auth'>, p_ems,
               p_rms, p_cert_req
   ),
   RecvStream( ~tid, $S, $C, <p_sas, 'auth'>, app_keyc )
   ]

  // loop breakers: [1,0]
  /*
  rule (modulo AC) recv_client_auth_post:
     [
     L_State_S4( ~tid, $S, $C, p_res_psk, p_messages, p_nc, p_ns, p_g, p_sg,
                 p_hrr, p_x, p_y, p_gx, p_gy, p_gxy, p_psk_ke_mode, p_psk_id, p_edi, p_es,
                 p_hs, p_ms, p_cats, p_sats, p_hs_keyc, p_hs_keys, <p_sas, p_cas>, p_ems,
                 p_rms, p_cert_req
     ),
     RecvStream( ~tid, $S, $C, <p_sas, p_cas>, app_keyc ),
     !Pk( $C, pk(~ltkC) ), L_ServerCertReq( ~tid, $S, $C, ~cert_req_ctxt ),
     In( senc(<<'11', ~cert_req_ctxt, pk(~ltkC)>, <'15', signature>, '20', 
               verify_data>,
              app_keyc)
     )
     ]
    --[
    S4_cert( ~tid ), Instance( ~tid, $S, 'server' ),
    Neq( ~cert_req_ctxt, '0' ), Eq( z, true ),
    Eq( verify_data,
        hmac(<
              Expand(Expand(p_hs,
                            <'fin_keychts', 
                             h(<p_messages, '13', ~cert_req_ctxt, $certificate_extensions>)>,
                            '32'),
                     <'fin', '0'>, '32'), 
              h(<p_messages, '13', ~cert_req_ctxt, $certificate_extensions>)>)
    ),
    CIdentityPost( ~tid, $S, 'server', <$C, p_sas, 'auth'> ),
    CTranscriptPost( ~tid, $S, 'server', <p_messages, ~cert_req_ctxt> ),
    CHS( ~tid, $S, 'server', p_hs ),
    RPostHS( ~tid, $S, 'server',
             <p_hs, p_rms, $C, <p_sas, 'auth'>, p_messages>
    )
    ]->
     [
     L_State_S4( ~tid, $S, $C, p_res_psk, p_messages, p_nc, p_ns, p_g, p_sg,
                 p_hrr, p_x, p_y, p_gx, p_gy, p_gxy, p_psk_ke_mode, p_psk_id, p_edi, p_es,
                 p_hs, p_ms, p_cats, p_sats, p_hs_keyc, p_hs_keys, <p_sas, 'auth'>, p_ems,
                 p_rms, p_cert_req
     ),
     RecvStream( ~tid, $S, $C, <p_sas, 'auth'>, app_keyc )
     ]
    variants (modulo AC)
    1. $certificate_extensions
             = $certificate_extensions.64
       ~cert_req_ctxt
             = ~cert_req_ctxt.65
       ~ltkC = ~ltkC.66
       p_messages
             = p_messages.83
       signature
             = sign(<'client_cv', 
                     h(<p_messages.83, '13', ~cert_req_ctxt.65, $certificate_extensions.64>)>,
                    ~ltkC.66)
       z     = true
    
    2. $certificate_extensions
             = $certificate_extensions.77
       ~cert_req_ctxt
             = ~cert_req_ctxt.78
       ~ltkC = ~ltkC.79
       p_messages
             = p_messages.96
       signature
             = signature.109
       z     = verify(signature.109,
                      <'client_cv', 
                       h(<p_messages.96, '13', ~cert_req_ctxt.78, $certificate_extensions.77>)>,
                      pk(~ltkC.79))
    // loop breakers: [1,0]
  */

rule (modulo E) update_req_client:
   [
   L_State_C4( ~tid, $C, $S, p_res_psk, p_messages, p_nc, p_ns, p_g, p_sg,
               p_hrr, p_x, p_y, p_gx, p_gy, p_gxy, p_psk_ke_mode, p_psk_id, p_edi, p_es,
               p_hs, p_ms, p_cats, p_sats, p_hs_keyc, p_hs_keys, p_auth_status, p_ems,
               p_rms, p_cert_req
   ),
   SendStream( ~tid, $C, $S, p_auth_status, p_app_keyc )
   ]
  --[
  C4_update_req( ~tid ), Instance( ~tid, $C, 'client' ),
  RPostHS( ~tid, $C, 'client', <p_hs, p_rms, $S, p_auth_status, p_messages>
  )
  ]->
   [
   L_State_C4( ~tid, $C, $S, p_res_psk, p_messages, p_nc, p_ns, p_g, p_sg,
               p_hrr, p_x, p_y, p_gx, p_gy, p_gxy, p_psk_ke_mode, p_psk_id, p_edi, p_es,
               p_hs, p_ms, Expand(p_cats, <'ats', '0'>, '32'), p_sats, p_hs_keyc,
               p_hs_keys, p_auth_status, p_ems, p_rms, p_cert_req
   ),
   SendStream( ~tid, $C, $S, p_auth_status,
               Expand(Expand(p_cats, <'ats', '0'>, '32'), <'adke_wk', '0'>, '32')
   ),
   Out( senc(<'24', '1'>, p_app_keyc) )
   ]

  // loop breakers: [0,1]
  /* has exactly the trivial AC variant */

rule (modulo E) update_req_server:
   [
   L_State_S4( ~tid, $S, $C, p_res_psk, p_messages, p_nc, p_ns, p_g, p_sg,
               p_hrr, p_x, p_y, p_gx, p_gy, p_gxy, p_psk_ke_mode, p_psk_id, p_edi, p_es,
               p_hs, p_ms, p_cats, p_sats, p_hs_keyc, p_hs_keys, p_auth_status, p_ems,
               p_rms, p_cert_req
   ),
   SendStream( ~tid, $S, $C, p_auth_status, p_app_keys )
   ]
  --[
  S4_update_req( ~tid ), Instance( ~tid, $S, 'server' ),
  RPostHS( ~tid, $S, 'server', <p_hs, p_rms, $C, p_auth_status, p_messages>
  )
  ]->
   [
   L_State_S4( ~tid, $S, $C, p_res_psk, p_messages, p_nc, p_ns, p_g, p_sg,
               p_hrr, p_x, p_y, p_gx, p_gy, p_gxy, p_psk_ke_mode, p_psk_id, p_edi, p_es,
               p_hs, p_ms, p_cats, Expand(p_sats, <'ats', '0'>, '32'), p_hs_keyc,
               p_hs_keys, p_auth_status, p_ems, p_rms, p_cert_req
   ),
   SendStream( ~tid, $S, $C, p_auth_status,
               Expand(Expand(p_sats, <'ats', '0'>, '32'), <'adke_wk', '0'>, '32')
   ),
   Out( senc(<'24', '1'>, p_app_keys) )
   ]

  // loop breakers: [1,0]
  /* has exactly the trivial AC variant */

rule (modulo E) update_recv_client:
   [
   L_State_C4( ~tid, $C, $S, p_res_psk, p_messages, p_nc, p_ns, p_g, p_sg,
               p_hrr, p_x, p_y, p_gx, p_gy, p_gxy, p_psk_ke_mode, p_psk_id, p_edi, p_es,
               p_hs, p_ms, p_cats, p_sats, p_hs_keyc, p_hs_keys, p_auth_status, p_ems,
               p_rms, p_cert_req
   ),
   RecvStream( ~tid, $C, $S, p_auth_status, p_app_keys ),
   SendStream( ~tid, $C, $S, p_auth_status, p_app_keyc ),
   In( senc(<'24', '1'>, p_app_keys) )
   ]
  --[
  C4_update_recv( ~tid ), Instance( ~tid, $C, 'client' ),
  RPostHS( ~tid, $C, 'client', <p_hs, p_rms, $S, p_auth_status, p_messages>
  )
  ]->
   [
   L_State_C4( ~tid, $C, $S, p_res_psk, p_messages, p_nc, p_ns, p_g, p_sg,
               p_hrr, p_x, p_y, p_gx, p_gy, p_gxy, p_psk_ke_mode, p_psk_id, p_edi, p_es,
               p_hs, p_ms, Expand(p_cats, <'ats', '0'>, '32'),
               Expand(p_sats, <'ats', '0'>, '32'), p_hs_keyc, p_hs_keys, p_auth_status,
               p_ems, p_rms, p_cert_req
   ),
   RecvStream( ~tid, $C, $S, p_auth_status,
               Expand(Expand(p_sats, <'ats', '0'>, '32'), <'adke_wk', '0'>, '32')
   ),
   SendStream( ~tid, $C, $S, p_auth_status,
               Expand(Expand(p_cats, <'ats', '0'>, '32'), <'adke_wk', '0'>, '32')
   ),
   Out( senc(<'24', '0'>, p_app_keyc) )
   ]

  // loop breakers: [1,0,2]
  /* has exactly the trivial AC variant */

rule (modulo E) update_recv_server:
   [
   L_State_S4( ~tid, $S, $C, p_res_psk, p_messages, p_nc, p_ns, p_g, p_sg,
               p_hrr, p_x, p_y, p_gx, p_gy, p_gxy, p_psk_ke_mode, p_psk_id, p_edi, p_es,
               p_hs, p_ms, p_cats, p_sats, p_hs_keyc, p_hs_keys, p_auth_status, p_ems,
               p_rms, p_cert_req
   ),
   RecvStream( ~tid, $S, $C, p_auth_status, p_app_keyc ),
   SendStream( ~tid, $S, $C, p_auth_status, p_app_keys ),
   In( senc(<'24', '1'>, p_app_keyc) )
   ]
  --[
  S4_update_recv( ~tid ), Instance( ~tid, $S, 'server' ),
  RPostHS( ~tid, $S, 'server', <p_hs, p_rms, $C, p_auth_status, p_messages>
  )
  ]->
   [
   L_State_S4( ~tid, $S, $C, p_res_psk, p_messages, p_nc, p_ns, p_g, p_sg,
               p_hrr, p_x, p_y, p_gx, p_gy, p_gxy, p_psk_ke_mode, p_psk_id, p_edi, p_es,
               p_hs, p_ms, Expand(p_cats, <'ats', '0'>, '32'),
               Expand(p_sats, <'ats', '0'>, '32'), p_hs_keyc, p_hs_keys, p_auth_status,
               p_ems, p_rms, p_cert_req
   ),
   RecvStream( ~tid, $S, $C, p_auth_status,
               Expand(Expand(p_cats, <'ats', '0'>, '32'), <'adke_wk', '0'>, '32')
   ),
   SendStream( ~tid, $S, $C, p_auth_status,
               Expand(Expand(p_sats, <'ats', '0'>, '32'), <'adke_wk', '0'>, '32')
   ),
   Out( senc(<'24', '0'>, p_app_keys) )
   ]

  // loop breakers: [1,2,0]
  /* has exactly the trivial AC variant */

rule (modulo E) update_fin_client:
   [
   L_State_C4( ~tid, $C, $S, p_res_psk, p_messages, p_nc, p_ns, p_g, p_sg,
               p_hrr, p_x, p_y, p_gx, p_gy, p_gxy, p_psk_ke_mode, p_psk_id, p_edi, p_es,
               p_hs, p_ms, p_cats, p_sats, p_hs_keyc, p_hs_keys, p_auth_status, p_ems,
               p_rms, p_cert_req
   ),
   RecvStream( ~tid, $C, $S, p_auth_status, p_app_keys ),
   In( senc(<'24', '0'>, p_app_keys) )
   ]
  --[
  C4_update_fin( ~tid ), Instance( ~tid, $C, 'client' ),
  RPostHS( ~tid, $C, 'client', <p_hs, p_rms, $S, p_auth_status, p_messages>
  )
  ]->
   [
   L_State_C4( ~tid, $C, $S, p_res_psk, p_messages, p_nc, p_ns, p_g, p_sg,
               p_hrr, p_x, p_y, p_gx, p_gy, p_gxy, p_psk_ke_mode, p_psk_id, p_edi, p_es,
               p_hs, p_ms, p_cats, Expand(p_sats, <'ats', '0'>, '32'), p_hs_keyc,
               p_hs_keys, p_auth_status, p_ems, p_rms, p_cert_req
   ),
   RecvStream( ~tid, $C, $S, p_auth_status,
               Expand(Expand(p_sats, <'ats', '0'>, '32'), <'adke_wk', '0'>, '32')
   )
   ]

  // loop breakers: [1,0]
  /* has exactly the trivial AC variant */

rule (modulo E) update_fin_server:
   [
   L_State_S4( ~tid, $S, $C, p_res_psk, p_messages, p_nc, p_ns, p_g, p_sg,
               p_hrr, p_x, p_y, p_gx, p_gy, p_gxy, p_psk_ke_mode, p_psk_id, p_edi, p_es,
               p_hs, p_ms, p_cats, p_sats, p_hs_keyc, p_hs_keys, p_auth_status, p_ems,
               p_rms, p_cert_req
   ),
   RecvStream( ~tid, $S, $C, p_auth_status, p_app_keyc ),
   In( senc(<'24', '0'>, p_app_keyc) )
   ]
  --[
  S4_update_fin( ~tid ), Instance( ~tid, $S, 'server' ),
  RPostHS( ~tid, $S, 'server', <p_hs, p_rms, $C, p_auth_status, p_messages>
  )
  ]->
   [
   L_State_S4( ~tid, $S, $C, p_res_psk, p_messages, p_nc, p_ns, p_g, p_sg,
               p_hrr, p_x, p_y, p_gx, p_gy, p_gxy, p_psk_ke_mode, p_psk_id, p_edi, p_es,
               p_hs, p_ms, Expand(p_cats, <'ats', '0'>, '32'), p_sats, p_hs_keyc,
               p_hs_keys, p_auth_status, p_ems, p_rms, p_cert_req
   ),
   RecvStream( ~tid, $S, $C, p_auth_status,
               Expand(Expand(p_cats, <'ats', '0'>, '32'), <'adke_wk', '0'>, '32')
   )
   ]

  // loop breakers: [1,0]
  /* has exactly the trivial AC variant */

rule (modulo E) Reveal_Ltk:
   [ !Ltk( $A, ~ltkA ) ] --[ RevLtk( $A ) ]-> [ Out( ~ltkA ) ]

  /* has exactly the trivial AC variant */

rule (modulo E) Reveal_DHExp:
   [ DHExp( ~x, ~tid, $A ) ]
  --[ RevDHExp( ~tid, $A, ~x ) ]->
   [ Out( ~x ), DHExp( ~x, ~tid, $A ) ]

  // loop breaker: [0]
  /* has exactly the trivial AC variant */

rule (modulo E) Reveal_PSK:
   [ SecretPSK( $A, res_psk ) ]
  --[ RevealPSK( $A, res_psk ) ]->
   [ Out( res_psk ) ]

  /* has exactly the trivial AC variant */

lemma one_C2d_per_tid [reuse]:
  all-traces
  "∀ tid #i #j. ((C2d( tid ) @ #i) ∧ (C2d( tid ) @ #j)) ⇒ (#i = #j)"
/*
guarded formula characterizing all counter-examples:
"∃ tid #i #j. (C2d( tid ) @ #i) ∧ (C2d( tid ) @ #j) ∧ ¬(#i = #j)"
*/
by sorry

lemma one_C2d_PSK_per_tid [reuse]:
  all-traces
  "∀ tid #i #j.
    ((C2d_PSK( tid ) @ #i) ∧ (C2d_PSK( tid ) @ #j)) ⇒ (#i = #j)"
/*
guarded formula characterizing all counter-examples:
"∃ tid #i #j. (C2d_PSK( tid ) @ #i) ∧ (C2d_PSK( tid ) @ #j) ∧ ¬(#i = #j)"
*/
by sorry

lemma one_S2d_per_tid [reuse]:
  all-traces
  "∀ tid #i #j. ((S2d( tid ) @ #i) ∧ (S2d( tid ) @ #j)) ⇒ (#i = #j)"
/*
guarded formula characterizing all counter-examples:
"∃ tid #i #j. (S2d( tid ) @ #i) ∧ (S2d( tid ) @ #j) ∧ ¬(#i = #j)"
*/
by sorry

lemma one_S2d_PSK_per_tid [reuse]:
  all-traces
  "∀ tid #i #j.
    ((S2d_PSK( tid ) @ #i) ∧ (S2d_PSK( tid ) @ #j)) ⇒ (#i = #j)"
/*
guarded formula characterizing all counter-examples:
"∃ tid #i #j. (S2d_PSK( tid ) @ #i) ∧ (S2d_PSK( tid ) @ #j) ∧ ¬(#i = #j)"
*/
by sorry

lemma one_C3_per_tid [reuse]:
  all-traces
  "∀ tid #i #j. ((C3( tid ) @ #i) ∧ (C3( tid ) @ #j)) ⇒ (#i = #j)"
/*
guarded formula characterizing all counter-examples:
"∃ tid #i #j. (C3( tid ) @ #i) ∧ (C3( tid ) @ #j) ∧ ¬(#i = #j)"
*/
by sorry

lemma one_C3_cert_per_tid [reuse]:
  all-traces
  "∀ tid #i #j.
    ((C3_cert( tid ) @ #i) ∧ (C3_cert( tid ) @ #j)) ⇒ (#i = #j)"
/*
guarded formula characterizing all counter-examples:
"∃ tid #i #j. (C3_cert( tid ) @ #i) ∧ (C3_cert( tid ) @ #j) ∧ ¬(#i = #j)"
*/
by sorry

lemma one_S3_per_tid [reuse]:
  all-traces
  "∀ tid #i #j. ((S3( tid ) @ #i) ∧ (S3( tid ) @ #j)) ⇒ (#i = #j)"
/*
guarded formula characterizing all counter-examples:
"∃ tid #i #j. (S3( tid ) @ #i) ∧ (S3( tid ) @ #j) ∧ ¬(#i = #j)"
*/
by sorry

lemma one_S3_cert_per_tid [reuse]:
  all-traces
  "∀ tid #i #j.
    ((S3_cert( tid ) @ #i) ∧ (S3_cert( tid ) @ #j)) ⇒ (#i = #j)"
/*
guarded formula characterizing all counter-examples:
"∃ tid #i #j. (S3_cert( tid ) @ #i) ∧ (S3_cert( tid ) @ #j) ∧ ¬(#i = #j)"
*/
by sorry

lemma S3_vs_S3_cert [reuse]:
  all-traces
  "∀ tid #i #j. ((S3( tid ) @ #i) ∧ (S3_cert( tid ) @ #j)) ⇒ (⊥)"
/*
guarded formula characterizing all counter-examples:
"∃ tid #i #j. (S3( tid ) @ #i) ∧ (S3_cert( tid ) @ #j)"
*/
by sorry

lemma C3_vs_C3_cert [reuse]:
  all-traces
  "∀ tid #i #j. ((C3( tid ) @ #i) ∧ (C3_cert( tid ) @ #j)) ⇒ (⊥)"
/*
guarded formula characterizing all counter-examples:
"∃ tid #i #j. (C3( tid ) @ #i) ∧ (C3_cert( tid ) @ #j)"
*/
by sorry

lemma S2d_vs_S2d_PSK [reuse]:
  all-traces
  "∀ tid #i #j. ((S2d( tid ) @ #i) ∧ (S2d_PSK( tid ) @ #j)) ⇒ (⊥)"
/*
guarded formula characterizing all counter-examples:
"∃ tid #i #j. (S2d( tid ) @ #i) ∧ (S2d_PSK( tid ) @ #j)"
*/
by sorry

lemma C2d_vs_C2d_PSK [reuse]:
  all-traces
  "∀ tid #i #j. ((C2d( tid ) @ #i) ∧ (C2d_PSK( tid ) @ #j)) ⇒ (⊥)"
/*
guarded formula characterizing all counter-examples:
"∃ tid #i #j. (C2d( tid ) @ #i) ∧ (C2d_PSK( tid ) @ #j)"
*/
by sorry

lemma cert_req_origin [typing]:
  all-traces
  "∀ certificate_request_context certificate_extensions keys #i.
    (!KU( senc(<'13', certificate_request_context, certificate_extensions>,
               keys)
     ) @ #i) ⇒
    ((∃ #j. (!KU( certificate_request_context ) @ #j) ∧ (#j < #i)) ∨
     (∃ #j tid actor role.
       (RCertReqCtxt( tid, actor, role, certificate_request_context ) @ #j) ∧
       (#j < #i)))"
/*
guarded formula characterizing all counter-examples:
"∃ certificate_request_context certificate_extensions keys #i.
  (!KU( senc(<'13', certificate_request_context, certificate_extensions>,
             keys)
   ) @ #i)
 ∧
  (∀ #j. (!KU( certificate_request_context ) @ #j) ⇒ ¬(#j < #i)) ∧
  (∀ #j tid actor role.
    (RCertReqCtxt( tid, actor, role, certificate_request_context ) @ #j)
   ⇒
    ¬(#j < #i))"
*/
by sorry

lemma nst_source [typing]:
  all-traces
  "∀ ticket ticket_age_add tkt_lt tkt_exts app_key #i.
    (!KU( senc(<'4', tkt_lt, ticket_age_add, ticket, tkt_exts>, app_key)
     ) @ #i) ⇒
    ((∃ #j #k.
       (((!KU( ticket ) @ #j) ∧ (!KU( ticket_age_add ) @ #k)) ∧ (#j < #i)) ∧
       (#k < #i)) ∨
     (∃ tid S #j.
       (RNST( tid, S, 'server', <ticket, ticket_age_add> ) @ #j) ∧ (#j < #i)))"
/*
guarded formula characterizing all counter-examples:
"∃ ticket ticket_age_add tkt_lt tkt_exts app_key #i.
  (!KU( senc(<'4', tkt_lt, ticket_age_add, ticket, tkt_exts>, app_key)
   ) @ #i)
 ∧
  (∀ #j #k.
    (!KU( ticket ) @ #j) ∧ (!KU( ticket_age_add ) @ #k)
   ⇒
    ((¬(#j < #i)) ∨ (¬(#k < #i)))) ∧
  (∀ tid S #j.
    (RNST( tid, S, 'server', <ticket, ticket_age_add> ) @ #j) ⇒ ¬(#j < #i))"
*/
by sorry

lemma ku_extract [reuse, use_induction]:
  all-traces
  "∀ a b #i.
    (!KU( Extract(a, b) ) @ #i) ⇒
    (∃ #j #k. (((!KU( a ) @ #j) ∧ (!KU( b ) @ #k)) ∧ (#j < #i)) ∧ (#k < #i))"
/*
guarded formula characterizing all counter-examples:
"∃ a b #i.
  (!KU( Extract(a, b) ) @ #i)
 ∧
  ∀ #j #k.
   (!KU( a ) @ #j) ∧ (!KU( b ) @ #k) ⇒ ((¬(#j < #i)) ∨ (¬(#k < #i)))"
*/
by sorry

lemma ku_expand [reuse, use_induction]:
  all-traces
  "∀ secret label len #i.
    (!KU( Expand(secret, label, len) ) @ #i) ⇒
    ((∃ #j. (!KU( secret ) @ #j) ∧ (#j < #i)) ∨
     ((¬(∃ #k. (!KU( secret ) @ #k) ∧ (#k < #i))) ∧
      (∃ actor #l.
        (RevealPSK( actor, Expand(secret, label, len) ) @ #l) ∧ (#l < #i))))"
/*
guarded formula characterizing all counter-examples:
"∃ secret label len #i.
  (!KU( Expand(secret, label, len) ) @ #i)
 ∧
  (∀ #j. (!KU( secret ) @ #j) ⇒ ¬(#j < #i)) ∧
  (((∃ #k. (!KU( secret ) @ #k) ∧ #k < #i) ∨
    (∀ actor #l.
      (RevealPSK( actor, Expand(secret, label, len) ) @ #l) ⇒ ¬(#l < #i))))"
*/
by sorry

lemma ku_ltk [reuse]:
  all-traces
  "∀ actor ltkA #i #j.
    ((GenLtk( actor, ltkA ) @ #i) ∧ (!KU( ltkA ) @ #j)) ⇒
    (∃ #k. (RevLtk( actor ) @ #k) ∧ (#k < #j))"
/*
guarded formula characterizing all counter-examples:
"∃ actor ltkA #i #j.
  (GenLtk( actor, ltkA ) @ #i) ∧ (!KU( ltkA ) @ #j)
 ∧
  ∀ #k. (RevLtk( actor ) @ #k) ⇒ ¬(#k < #j)"
*/
by sorry

lemma hsms_derive [reuse]:
  all-traces
  "∀ tid actor role hs ms #i.
    (RHSMS( tid, actor, role, <hs, ms> ) @ #i) ⇒ (ms = Extract('0', hs))"
/*
guarded formula characterizing all counter-examples:
"∃ tid actor role hs ms #i.
  (RHSMS( tid, actor, role, <hs, ms> ) @ #i) ∧ ¬(ms = Extract('0', hs))"
*/
by sorry

lemma posths_rms [reuse, use_induction]:
  all-traces
  "∀ tid actor role hs rms peer auth_status messages #i.
    (RPostHS( tid, actor, role, <hs, rms, peer, auth_status, messages>
     ) @ #i) ⇒
    (∃ aas pas ms #j.
      (((((RRMS( tid, actor, role, <peer, rms, messages> ) @ #j) ∧
          (ms = Extract('0', hs))) ∧
         (rms = Expand(ms, <'rms', h(messages)>, '32'))) ∧
        (#j < #i)) ∧
       (auth_status = <aas, pas>)) ∧
      ((∃ aas2 #k.
         (CIdentity( tid, actor, role, <peer, aas2, pas> ) @ #k) ∧ (#k < #i)) ∨
       (∃ aas2 #k.
         (((CIdentityPost( tid, actor, role, <peer, aas2, pas> ) @ #k) ∧
           (role = 'server')) ∧
          (pas = 'auth')) ∧
         ((#k < #i) ∨ (#k = #i)))))"
/*
guarded formula characterizing all counter-examples:
"∃ tid actor role hs rms peer auth_status messages #i.
  (RPostHS( tid, actor, role, <hs, rms, peer, auth_status, messages>
   ) @ #i)
 ∧
  ∀ aas pas ms #j.
   (RRMS( tid, actor, role, <peer, rms, messages> ) @ #j) ∧
   (ms = Extract('0', hs)) ∧
   (rms = Expand(ms, <'rms', h(messages)>, '32')) ∧
   (auth_status = <aas, pas>)
  ⇒
   ((¬(#j < #i)) ∨
    ((∀ aas2 #k.
       (CIdentity( tid, actor, role, <peer, aas2, pas> ) @ #k) ⇒ ¬(#k < #i)) ∧
     (∀ aas2 #k.
       (CIdentityPost( tid, actor, role, <peer, aas2, pas> ) @ #k) ∧
       (role = 'server') ∧
       (pas = 'auth')
      ⇒
       (¬(#k < #i)) ∧ (¬(#k = #i)))))"
*/
by sorry

lemma matching_transcripts_posths [reuse]:
  all-traces
  "∀ tid tid2 actor peer actor2 peer2 role role2 rms rms2 messages #i #j.
    (((RRMS( tid, actor, role, <peer2, rms, messages> ) @ #i) ∧
      (RRMS( tid2, peer, role2, <actor2, rms2, messages> ) @ #j)) ∧
     (¬(role = role2))) ⇒
    (rms = rms2)"
/*
guarded formula characterizing all counter-examples:
"∃ tid tid2 actor peer actor2 peer2 role role2 rms rms2 messages #i #j.
  (RRMS( tid, actor, role, <peer2, rms, messages> ) @ #i) ∧
  (RRMS( tid2, peer, role2, <actor2, rms2, messages> ) @ #j)
 ∧
  (¬(role = role2)) ∧ (¬(rms = rms2))"
*/
by sorry

lemma matching_rms_posths [reuse]:
  all-traces
  "∀ tid tid2 actor peer actor2 peer2 role role2 rms messages messages2 #i
     #j.
    (((RRMS( tid, actor, role, <peer2, rms, messages> ) @ #i) ∧
      (RRMS( tid2, peer, role2, <actor2, rms, messages2> ) @ #j)) ∧
     (¬(role = role2))) ⇒
    (messages = messages2)"
/*
guarded formula characterizing all counter-examples:
"∃ tid tid2 actor peer actor2 peer2 role role2 rms messages messages2 #i
   #j.
  (RRMS( tid, actor, role, <peer2, rms, messages> ) @ #i) ∧
  (RRMS( tid2, peer, role2, <actor2, rms, messages2> ) @ #j)
 ∧
  (¬(role = role2)) ∧ (¬(messages = messages2))"
*/
by sorry

lemma sig_origin [reuse]:
  all-traces
  "∀ certificate certificate_request_context signature verify_data hs_key
     sig_messages ltkA #i.
    ((!KU( senc(<<'11', certificate_request_context, certificate>, 
                 <'15', signature>, '20', verify_data>,
                hs_key)
      ) @ #i) ∧
     (signature = sign(sig_messages, ltkA))) ⇒
    ((∃ #j. (!KU( ltkA ) @ #j) ∧ (#j < #i)) ∨
     (∃ #k. (UseLtk( ltkA, signature ) @ #k) ∧ (#k < #i)))"
/*
guarded formula characterizing all counter-examples:
"∃ certificate certificate_request_context signature verify_data hs_key
   sig_messages ltkA #i.
  (!KU( senc(<<'11', certificate_request_context, certificate>, 
              <'15', signature>, '20', verify_data>,
             hs_key)
   ) @ #i) ∧
  (signature = sign(sig_messages, ltkA))
 ∧
  (∀ #j. (!KU( ltkA ) @ #j) ⇒ ¬(#j < #i)) ∧
  (∀ #k. (UseLtk( ltkA, signature ) @ #k) ⇒ ¬(#k < #i))"
*/
by sorry

lemma post_master_secret [reuse, hide_lemma=posths_rms]:
  all-traces
  "∀ tid actor peer role hs rms aas messages #i #k.
    ((((RPostHS( tid, actor, role, <hs, rms, peer, <aas, 'auth'>, messages>
        ) @ #i) ∧
       (CHS( tid, actor, role, hs ) @ #i)) ∧
      (CIdentityPost( tid, actor, role, <peer, aas, 'auth'> ) @ #i)) ∧
     (!KU( rms ) @ #k)) ⇒
    (((((∃ #r. (RevLtk( peer ) @ #r) ∧ (#r < #i)) ∨
        (∃ tid3 x #r. (RevDHExp( tid3, peer, x ) @ #r) ∧ (#r < #i))) ∨
       (∃ tid4 y #r. (RevDHExp( tid4, actor, y ) @ #r) ∧ (#r < #i))) ∨
      (∃ rms2 #r. (RevealPSK( actor, rms2 ) @ #r) ∧ (#r < #k))) ∨
     (∃ rms2 #r. (RevealPSK( peer, rms2 ) @ #r) ∧ (#r < #k)))"
/*
guarded formula characterizing all counter-examples:
"∃ tid actor peer role hs rms aas messages #i #k.
  (RPostHS( tid, actor, role, <hs, rms, peer, <aas, 'auth'>, messages>
   ) @ #i) ∧
  (CHS( tid, actor, role, hs ) @ #i) ∧
  (CIdentityPost( tid, actor, role, <peer, aas, 'auth'> ) @ #i) ∧
  (!KU( rms ) @ #k)
 ∧
  (∀ #r. (RevLtk( peer ) @ #r) ⇒ ¬(#r < #i)) ∧
  (∀ tid3 x #r. (RevDHExp( tid3, peer, x ) @ #r) ⇒ ¬(#r < #i)) ∧
  (∀ tid4 y #r. (RevDHExp( tid4, actor, y ) @ #r) ⇒ ¬(#r < #i)) ∧
  (∀ rms2 #r. (RevealPSK( actor, rms2 ) @ #r) ⇒ ¬(#r < #k)) ∧
  (∀ rms2 #r. (RevealPSK( peer, rms2 ) @ #r) ⇒ ¬(#r < #k))"
*/
by sorry

lemma invariant_post_hs [reuse, use_induction, hide_lemma=posths_rms]:
  all-traces
  "∀ tid actor peer peer2 role hs hs2 rms rms2 as as2 msgs msgs2 #i #j.
    ((RPostHS( tid, actor, role, <hs, rms, peer, as, msgs> ) @ #i) ∧
     (RPostHS( tid, actor, role, <hs2, rms2, peer2, as2, msgs2> ) @ #j)) ⇒
    ((((peer = peer2) ∧ (rms = rms2)) ∧ (msgs = msgs2)) ∧ (hs = hs2))"
/*
guarded formula characterizing all counter-examples:
"∃ tid actor peer peer2 role hs hs2 rms rms2 as as2 msgs msgs2 #i #j.
  (RPostHS( tid, actor, role, <hs, rms, peer, as, msgs> ) @ #i) ∧
  (RPostHS( tid, actor, role, <hs2, rms2, peer2, as2, msgs2> ) @ #j)
 ∧
  ((¬(peer = peer2)) ∨
   (¬(rms = rms2)) ∨
   (¬(msgs = msgs2)) ∨
   (¬(hs = hs2)))"
*/
by sorry

lemma handshake_secret [reuse, use_induction,
                        hide_lemma=posths_rms_weak]:
  all-traces
  "∀ tid actor peer role hs aas #i #k.
    (((CHS( tid, actor, role, hs ) @ #i) ∧
      (CIdentity( tid, actor, role, <peer, aas, 'auth'> ) @ #i)) ∧
     (!KU( hs ) @ #k)) ⇒
    (((((∃ #r. (RevLtk( peer ) @ #r) ∧ (#r < #i)) ∨
        (∃ tid3 x #r. (RevDHExp( tid3, peer, x ) @ #r) ∧ (#r < #i))) ∨
       (∃ tid4 y #r. (RevDHExp( tid4, actor, y ) @ #r) ∧ (#r < #i))) ∨
      (∃ rms #r. (RevealPSK( actor, rms ) @ #r) ∧ (#r < #k))) ∨
     (∃ rms #r. (RevealPSK( peer, rms ) @ #r) ∧ (#r < #k)))"
/*
guarded formula characterizing all counter-examples:
"∃ tid actor peer role hs aas #i #k.
  (CHS( tid, actor, role, hs ) @ #i) ∧
  (CIdentity( tid, actor, role, <peer, aas, 'auth'> ) @ #i) ∧
  (!KU( hs ) @ #k)
 ∧
  (∀ #r. (RevLtk( peer ) @ #r) ⇒ ¬(#r < #i)) ∧
  (∀ tid3 x #r. (RevDHExp( tid3, peer, x ) @ #r) ⇒ ¬(#r < #i)) ∧
  (∀ tid4 y #r. (RevDHExp( tid4, actor, y ) @ #r) ⇒ ¬(#r < #i)) ∧
  (∀ rms #r. (RevealPSK( actor, rms ) @ #r) ⇒ ¬(#r < #k)) ∧
  (∀ rms #r. (RevealPSK( peer, rms ) @ #r) ⇒ ¬(#r < #k))"
*/
by sorry

lemma secret_session_keys [hide_lemma=sig_origin, hide_lemma=posths_rms]:
  all-traces
  "∀ tid actor peer kw kr pas #i.
    ((((((SessionKey( tid, actor, peer, <pas, 'auth'>, <kw, kr> ) @ #i) ∧
         (¬(∃ #r. (RevLtk( peer ) @ #r) ∧ (#r < #i)))) ∧
        (¬(∃ tid3 x #r. (RevDHExp( tid3, peer, x ) @ #r) ∧ (#r < #i)))) ∧
       (¬(∃ tid4 y #r. (RevDHExp( tid4, actor, y ) @ #r) ∧ (#r < #i)))) ∧
      (¬(∃ rms #r. RevealPSK( actor, rms ) @ #r))) ∧
     (¬(∃ rms #r. RevealPSK( peer, rms ) @ #r))) ⇒
    (¬(∃ #j. K( kr ) @ #j))"
/*
guarded formula characterizing all counter-examples:
"∃ tid actor peer kw kr pas #i.
  (SessionKey( tid, actor, peer, <pas, 'auth'>, <kw, kr> ) @ #i)
 ∧
  (∀ #r. (RevLtk( peer ) @ #r) ⇒ ¬(#r < #i)) ∧
  (∀ tid3 x #r. (RevDHExp( tid3, peer, x ) @ #r) ⇒ ¬(#r < #i)) ∧
  (∀ tid4 y #r. (RevDHExp( tid4, actor, y ) @ #r) ⇒ ¬(#r < #i)) ∧
  (∀ rms #r. (RevealPSK( actor, rms ) @ #r) ⇒ ⊥) ∧
  (∀ rms #r. (RevealPSK( peer, rms ) @ #r) ⇒ ⊥) ∧
  (∃ #j. (K( kr ) @ #j))"
*/
simplify
solve( SessionKey( tid, actor, peer, <pas, 'auth'>, <kw, kr> ) @ #i )
  case client_auth
  solve( (∃ #j. (!KU( p_sats ) @ #j) ∧ #j < #vk)  ∥
         ((∀ #k. (!KU( p_sats ) @ #k) ⇒ ¬(#k < #vk)) ∧
          (∃ actor #l.
            (RevealPSK( actor, Expand(p_sats, <'adke_wk', '0'>, '32') ) @ #l)
           ∧
            #l < #vk)) )
    case case_1
    solve( F_State_C3( ~tid, $C, $S, p_res_psk, p_messages, p_nc, p_ns, p_g,
                       p_sg, p_hrr, p_x, p_y, p_gx, p_gy, p_gxy, p_psk_ke_mode, p_psk_id, p_edi,
                       p_es, p_hs, Extract('0', p_hs), p_cats, p_sats, p_hs_keyc, p_hs_keys,
                       <pas, 'auth'>, p_ems, p_rms, '0'
           ) ▶₀ #i )
      case recv_server_auth_case_01
      solve( (∃ #j.2.
               (!KU( Extract('0', Extract(p_gxy, Extract('0', '0'))) ) @ #j.2)
              ∧
               #j.2 < #j.1)  ∥
             ((∀ #k.
                (!KU( Extract('0', Extract(p_gxy, Extract('0', '0'))) ) @ #k)
               ⇒
                ¬(#k < #j.1)) ∧
              (∃ actor #l.
                (RevealPSK( actor,
                            Expand(Extract('0', Extract(p_gxy, Extract('0', '0'))),
                                   <'serverats', 
                                    h(<
                                       <
                                        <
                                         <
                                          <
                                           <'0', '1', '0x0303', ~tid, '0', $cipher_suites, '0', 
                                            <'43', '0x0304'>, <'10', $g, $g2>, <'13', $sig_algs>, '40', $g, 
                                            $g^~x>, 
                                           '2', '0x0303', p_ns, $cipher_suite, <'13', $sig_algs.1>, '40', $g, 
                                           p_gy>, 
                                          '8', $exts>, 
                                         '11', '0', pk(~ltkS)>, 
                                        '15', 
                                        sign(<'server_cv', 
                                              h(<
                                                 <
                                                  <
                                                   <'0', '1', '0x0303', ~tid, '0', $cipher_suites, '0', 
                                                    <'43', '0x0304'>, <'10', $g, $g2>, <'13', $sig_algs>, 
                                                    '40', $g, $g^~x>, 
                                                   '2', '0x0303', p_ns, $cipher_suite, <'13', $sig_algs.1>, 
                                                   '40', $g, p_gy>, 
                                                  '8', $exts>, 
                                                 '11', '0', pk(~ltkS)>)
                                             >,
                                             ~ltkS)
                                       >, 
                                       '20', 
                                       hmac(<
                                             Expand(Expand(Extract(p_gxy, Extract('0', '0')),
                                                           <'serverhts', 
                                                            h(<
                                                               <
                                                                <
                                                                 <
                                                                  <'0', '1', '0x0303', ~tid, '0', 
                                                                   $cipher_suites, '0', <'43', '0x0304'>, 
                                                                   <'10', $g, $g2>, <'13', $sig_algs>, '40', 
                                                                   $g, $g^~x>, 
                                                                  '2', '0x0303', p_ns, $cipher_suite, 
                                                                  <'13', $sig_algs.1>, '40', $g, p_gy>, 
                                                                 '8', $exts>, 
                                                                '11', '0', pk(~ltkS)>, 
                                                               '15', 
                                                               sign(<'server_cv', 
                                                                     h(<
                                                                        <
                                                                         <
                                                                          <'0', '1', '0x0303', ~tid, '0', 
                                                                           $cipher_suites, '0', 
                                                                           <'43', '0x0304'>, <'10', $g, $g2>, 
                                                                           <'13', $sig_algs>, '40', $g, $g^~x
                                                                          >, 
                                                                          '2', '0x0303', p_ns, $cipher_suite, 
                                                                          <'13', $sig_algs.1>, '40', $g, p_gy
                                                                         >, 
                                                                         '8', $exts>, 
                                                                        '11', '0', pk(~ltkS)>)
                                                                    >,
                                                                    ~ltkS)
                                                              >)
                                                           >,
                                                           '32'),
                                                    <'fin', '0'>, '32'), 
                                             h(<
                                                <
                                                 <
                                                  <
                                                   <'0', '1', '0x0303', ~tid, '0', $cipher_suites, '0', 
                                                    <'43', '0x0304'>, <'10', $g, $g2>, <'13', $sig_algs>, 
                                                    '40', $g, $g^~x>, 
                                                   '2', '0x0303', p_ns, $cipher_suite, <'13', $sig_algs.1>, 
                                                   '40', $g, p_gy>, 
                                                  '8', $exts>, 
                                                 '11', '0', pk(~ltkS)>, 
                                                '15', 
                                                sign(<'server_cv', 
                                                      h(<
                                                         <
                                                          <
                                                           <'0', '1', '0x0303', ~tid, '0', $cipher_suites, 
                                                            '0', <'43', '0x0304'>, <'10', $g, $g2>, 
                                                            <'13', $sig_algs>, '40', $g, $g^~x>, 
                                                           '2', '0x0303', p_ns, $cipher_suite, 
                                                           <'13', $sig_algs.1>, '40', $g, p_gy>, 
                                                          '8', $exts>, 
                                                         '11', '0', pk(~ltkS)>)
                                                     >,
                                                     ~ltkS)
                                               >)
                                            >)
                                      >)
                                   >,
                                   '32')
                 ) @ #l)
               ∧
                #l < #j.1)) )
        case case_1
        solve( (∃ #r. (RevLtk( $S ) @ #r) ∧ #r < #vr)  ∥
               (∃ tid3 x #r. (RevDHExp( tid3, $S, x ) @ #r) ∧ #r < #vr)  ∥
               (∃ tid4 y #r. (RevDHExp( tid4, $C, y ) @ #r) ∧ #r < #vr)  ∥
               (∃ rms #r. (RevealPSK( $C, rms ) @ #r) ∧ #r < #k.1)  ∥
               (∃ rms #r. (RevealPSK( $S, rms ) @ #r) ∧ #r < #k.1) )
          case case_1
          by contradiction /* from formulas */
        next
          case case_2
          by contradiction /* from formulas */
        next
          case case_3
          by contradiction /* from formulas */
        next
          case case_4
          by contradiction /* from formulas */
        next
          case case_5
          by contradiction /* from formulas */
        qed
      next
        case case_2
        by solve( SecretPSK( $A,
                             Expand(Extract('0', Extract(p_gxy, Extract('0', '0'))),
                                    <'serverats', 
                                     h(<
                                        <
                                         <
                                          <
                                           <
                                            <'0', '1', '0x0303', ~tid, '0', $cipher_suites, '0', 
                                             <'43', '0x0304'>, <'10', $g, $g2>, <'13', $sig_algs>, '40', $g, 
                                             $g^~x>, 
                                            '2', '0x0303', p_ns, $cipher_suite, <'13', $sig_algs.1>, '40', 
                                            $g, p_gy>, 
                                           '8', $exts>, 
                                          '11', '0', pk(~ltkS)>, 
                                         '15', 
                                         sign(<'server_cv', 
                                               h(<
                                                  <
                                                   <
                                                    <'0', '1', '0x0303', ~tid, '0', $cipher_suites, '0', 
                                                     <'43', '0x0304'>, <'10', $g, $g2>, <'13', $sig_algs>, 
                                                     '40', $g, $g^~x>, 
                                                    '2', '0x0303', p_ns, $cipher_suite, <'13', $sig_algs.1>, 
                                                    '40', $g, p_gy>, 
                                                   '8', $exts>, 
                                                  '11', '0', pk(~ltkS)>)
                                              >,
                                              ~ltkS)
                                        >, 
                                        '20', 
                                        hmac(<
                                              Expand(Expand(Extract(p_gxy, Extract('0', '0')),
                                                            <'serverhts', 
                                                             h(<
                                                                <
                                                                 <
                                                                  <
                                                                   <'0', '1', '0x0303', ~tid, '0', 
                                                                    $cipher_suites, '0', <'43', '0x0304'>, 
                                                                    <'10', $g, $g2>, <'13', $sig_algs>, '40', 
                                                                    $g, $g^~x>, 
                                                                   '2', '0x0303', p_ns, $cipher_suite, 
                                                                   <'13', $sig_algs.1>, '40', $g, p_gy>, 
                                                                  '8', $exts>, 
                                                                 '11', '0', pk(~ltkS)>, 
                                                                '15', 
                                                                sign(<'server_cv', 
                                                                      h(<
                                                                         <
                                                                          <
                                                                           <'0', '1', '0x0303', ~tid, '0', 
                                                                            $cipher_suites, '0', 
                                                                            <'43', '0x0304'>, 
                                                                            <'10', $g, $g2>, 
                                                                            <'13', $sig_algs>, '40', $g, $g^~x
                                                                           >, 
                                                                           '2', '0x0303', p_ns, 
                                                                           $cipher_suite, 
                                                                           <'13', $sig_algs.1>, '40', $g, p_gy
                                                                          >, 
                                                                          '8', $exts>, 
                                                                         '11', '0', pk(~ltkS)>)
                                                                     >,
                                                                     ~ltkS)
                                                               >)
                                                            >,
                                                            '32'),
                                                     <'fin', '0'>, '32'), 
                                              h(<
                                                 <
                                                  <
                                                   <
                                                    <'0', '1', '0x0303', ~tid, '0', $cipher_suites, '0', 
                                                     <'43', '0x0304'>, <'10', $g, $g2>, <'13', $sig_algs>, 
                                                     '40', $g, $g^~x>, 
                                                    '2', '0x0303', p_ns, $cipher_suite, <'13', $sig_algs.1>, 
                                                    '40', $g, p_gy>, 
                                                   '8', $exts>, 
                                                  '11', '0', pk(~ltkS)>, 
                                                 '15', 
                                                 sign(<'server_cv', 
                                                       h(<
                                                          <
                                                           <
                                                            <'0', '1', '0x0303', ~tid, '0', $cipher_suites, 
                                                             '0', <'43', '0x0304'>, <'10', $g, $g2>, 
                                                             <'13', $sig_algs>, '40', $g, $g^~x>, 
                                                            '2', '0x0303', p_ns, $cipher_suite, 
                                                            <'13', $sig_algs.1>, '40', $g, p_gy>, 
                                                           '8', $exts>, 
                                                          '11', '0', pk(~ltkS)>)
                                                      >,
                                                      ~ltkS)
                                                >)
                                             >)
                                       >)
                                    >,
                                    '32')
                  ) ▶₀ #l )
      qed
    next
      case recv_server_auth_case_02
      solve( (∃ #j.2.
               (!KU( Extract('0', Extract(p_gxy, Extract('0', '0'))) ) @ #j.2)
              ∧
               #j.2 < #j.1)  ∥
             ((∀ #k.
                (!KU( Extract('0', Extract(p_gxy, Extract('0', '0'))) ) @ #k)
               ⇒
                ¬(#k < #j.1)) ∧
              (∃ actor #l.
                (RevealPSK( actor,
                            Expand(Extract('0', Extract(p_gxy, Extract('0', '0'))),
                                   <'serverats', 
                                    h(<
                                       <
                                        <
                                         <
                                          <
                                           <
                                            <
                                             <'0', '1', '0x0303', ~tid, '0', $cipher_suites, '0', 
                                              <'43', '0x0304'>, <'10', $g1, $g>, <'13', $sig_algs>, '40', 
                                              $g1, $g1^~x>, 
                                             '6', '0x0303', '40', $g>, 
                                            '1', '0x0303', ~tid, '0', $cipher_suites.1, '0', 
                                            <'43', '0x0304'>, <'10', $g1, $g>, <'13', $sig_algs.1>, '40', $g, 
                                            $g^~x.1>, 
                                           '2', '0x0303', p_ns, $cipher_suite, <'13', $sig_algs.2>, '40', $g, 
                                           p_gy>, 
                                          '8', $exts>, 
                                         '11', '0', pk(~ltkS)>, 
                                        '15', 
                                        sign(<'server_cv', 
                                              h(<
                                                 <
                                                  <
                                                   <
                                                    <
                                                     <'0', '1', '0x0303', ~tid, '0', $cipher_suites, '0', 
                                                      <'43', '0x0304'>, <'10', $g1, $g>, <'13', $sig_algs>, 
                                                      '40', $g1, $g1^~x>, 
                                                     '6', '0x0303', '40', $g>, 
                                                    '1', '0x0303', ~tid, '0', $cipher_suites.1, '0', 
                                                    <'43', '0x0304'>, <'10', $g1, $g>, <'13', $sig_algs.1>, 
                                                    '40', $g, $g^~x.1>, 
                                                   '2', '0x0303', p_ns, $cipher_suite, <'13', $sig_algs.2>, 
                                                   '40', $g, p_gy>, 
                                                  '8', $exts>, 
                                                 '11', '0', pk(~ltkS)>)
                                             >,
                                             ~ltkS)
                                       >, 
                                       '20', 
                                       hmac(<
                                             Expand(Expand(Extract(p_gxy, Extract('0', '0')),
                                                           <'serverhts', 
                                                            h(<
                                                               <
                                                                <
                                                                 <
                                                                  <
                                                                   <
                                                                    <'0', '1', '0x0303', ~tid, '0', 
                                                                     $cipher_suites, '0', <'43', '0x0304'>, 
                                                                     <'10', $g1, $g>, <'13', $sig_algs>, 
                                                                     '40', $g1, $g1^~x>, 
                                                                    '6', '0x0303', '40', $g>, 
                                                                   '1', '0x0303', ~tid, '0', 
                                                                   $cipher_suites.1, '0', <'43', '0x0304'>, 
                                                                   <'10', $g1, $g>, <'13', $sig_algs.1>, 
                                                                   '40', $g, $g^~x.1>, 
                                                                  '2', '0x0303', p_ns, $cipher_suite, 
                                                                  <'13', $sig_algs.2>, '40', $g, p_gy>, 
                                                                 '8', $exts>, 
                                                                '11', '0', pk(~ltkS)>, 
                                                               '15', 
                                                               sign(<'server_cv', 
                                                                     h(<
                                                                        <
                                                                         <
                                                                          <
                                                                           <
                                                                            <'0', '1', '0x0303', ~tid, '0', 
                                                                             $cipher_suites, '0', 
                                                                             <'43', '0x0304'>, 
                                                                             <'10', $g1, $g>, 
                                                                             <'13', $sig_algs>, '40', $g1, 
                                                                             $g1^~x>, 
                                                                            '6', '0x0303', '40', $g>, 
                                                                           '1', '0x0303', ~tid, '0', 
                                                                           $cipher_suites.1, '0', 
                                                                           <'43', '0x0304'>, <'10', $g1, $g>, 
                                                                           <'13', $sig_algs.1>, '40', $g, 
                                                                           $g^~x.1>, 
                                                                          '2', '0x0303', p_ns, $cipher_suite, 
                                                                          <'13', $sig_algs.2>, '40', $g, p_gy
                                                                         >, 
                                                                         '8', $exts>, 
                                                                        '11', '0', pk(~ltkS)>)
                                                                    >,
                                                                    ~ltkS)
                                                              >)
                                                           >,
                                                           '32'),
                                                    <'fin', '0'>, '32'), 
                                             h(<
                                                <
                                                 <
                                                  <
                                                   <
                                                    <
                                                     <'0', '1', '0x0303', ~tid, '0', $cipher_suites, '0', 
                                                      <'43', '0x0304'>, <'10', $g1, $g>, <'13', $sig_algs>, 
                                                      '40', $g1, $g1^~x>, 
                                                     '6', '0x0303', '40', $g>, 
                                                    '1', '0x0303', ~tid, '0', $cipher_suites.1, '0', 
                                                    <'43', '0x0304'>, <'10', $g1, $g>, <'13', $sig_algs.1>, 
                                                    '40', $g, $g^~x.1>, 
                                                   '2', '0x0303', p_ns, $cipher_suite, <'13', $sig_algs.2>, 
                                                   '40', $g, p_gy>, 
                                                  '8', $exts>, 
                                                 '11', '0', pk(~ltkS)>, 
                                                '15', 
                                                sign(<'server_cv', 
                                                      h(<
                                                         <
                                                          <
                                                           <
                                                            <
                                                             <'0', '1', '0x0303', ~tid, '0', $cipher_suites, 
                                                              '0', <'43', '0x0304'>, <'10', $g1, $g>, 
                                                              <'13', $sig_algs>, '40', $g1, $g1^~x>, 
                                                             '6', '0x0303', '40', $g>, 
                                                            '1', '0x0303', ~tid, '0', $cipher_suites.1, '0', 
                                                            <'43', '0x0304'>, <'10', $g1, $g>, 
                                                            <'13', $sig_algs.1>, '40', $g, $g^~x.1>, 
                                                           '2', '0x0303', p_ns, $cipher_suite, 
                                                           <'13', $sig_algs.2>, '40', $g, p_gy>, 
                                                          '8', $exts>, 
                                                         '11', '0', pk(~ltkS)>)
                                                     >,
                                                     ~ltkS)
                                               >)
                                            >)
                                      >)
                                   >,
                                   '32')
                 ) @ #l)
               ∧
                #l < #j.1)) )
        case case_1
        solve( (∃ #r. (RevLtk( $S ) @ #r) ∧ #r < #vr)  ∥
               (∃ tid3 x #r. (RevDHExp( tid3, $S, x ) @ #r) ∧ #r < #vr)  ∥
               (∃ tid4 y #r. (RevDHExp( tid4, $C, y ) @ #r) ∧ #r < #vr)  ∥
               (∃ rms #r. (RevealPSK( $C, rms ) @ #r) ∧ #r < #k.1)  ∥
               (∃ rms #r. (RevealPSK( $S, rms ) @ #r) ∧ #r < #k.1) )
          case case_1
          by contradiction /* from formulas */
        next
          case case_2
          by contradiction /* from formulas */
        next
          case case_3
          by contradiction /* from formulas */
        next
          case case_4
          by contradiction /* from formulas */
        next
          case case_5
          by contradiction /* from formulas */
        qed
      next
        case case_2
        by solve( SecretPSK( $A,
                             Expand(Extract('0', Extract(p_gxy, Extract('0', '0'))),
                                    <'serverats', 
                                     h(<
                                        <
                                         <
                                          <
                                           <
                                            <
                                             <
                                              <'0', '1', '0x0303', ~tid, '0', $cipher_suites, '0', 
                                               <'43', '0x0304'>, <'10', $g1, $g>, <'13', $sig_algs>, '40', 
                                               $g1, $g1^~x>, 
                                              '6', '0x0303', '40', $g>, 
                                             '1', '0x0303', ~tid, '0', $cipher_suites.1, '0', 
                                             <'43', '0x0304'>, <'10', $g1, $g>, <'13', $sig_algs.1>, '40', 
                                             $g, $g^~x.1>, 
                                            '2', '0x0303', p_ns, $cipher_suite, <'13', $sig_algs.2>, '40', 
                                            $g, p_gy>, 
                                           '8', $exts>, 
                                          '11', '0', pk(~ltkS)>, 
                                         '15', 
                                         sign(<'server_cv', 
                                               h(<
                                                  <
                                                   <
                                                    <
                                                     <
                                                      <'0', '1', '0x0303', ~tid, '0', $cipher_suites, '0', 
                                                       <'43', '0x0304'>, <'10', $g1, $g>, <'13', $sig_algs>, 
                                                       '40', $g1, $g1^~x>, 
                                                      '6', '0x0303', '40', $g>, 
                                                     '1', '0x0303', ~tid, '0', $cipher_suites.1, '0', 
                                                     <'43', '0x0304'>, <'10', $g1, $g>, <'13', $sig_algs.1>, 
                                                     '40', $g, $g^~x.1>, 
                                                    '2', '0x0303', p_ns, $cipher_suite, <'13', $sig_algs.2>, 
                                                    '40', $g, p_gy>, 
                                                   '8', $exts>, 
                                                  '11', '0', pk(~ltkS)>)
                                              >,
                                              ~ltkS)
                                        >, 
                                        '20', 
                                        hmac(<
                                              Expand(Expand(Extract(p_gxy, Extract('0', '0')),
                                                            <'serverhts', 
                                                             h(<
                                                                <
                                                                 <
                                                                  <
                                                                   <
                                                                    <
                                                                     <'0', '1', '0x0303', ~tid, '0', 
                                                                      $cipher_suites, '0', <'43', '0x0304'>, 
                                                                      <'10', $g1, $g>, <'13', $sig_algs>, 
                                                                      '40', $g1, $g1^~x>, 
                                                                     '6', '0x0303', '40', $g>, 
                                                                    '1', '0x0303', ~tid, '0', 
                                                                    $cipher_suites.1, '0', <'43', '0x0304'>, 
                                                                    <'10', $g1, $g>, <'13', $sig_algs.1>, 
                                                                    '40', $g, $g^~x.1>, 
                                                                   '2', '0x0303', p_ns, $cipher_suite, 
                                                                   <'13', $sig_algs.2>, '40', $g, p_gy>, 
                                                                  '8', $exts>, 
                                                                 '11', '0', pk(~ltkS)>, 
                                                                '15', 
                                                                sign(<'server_cv', 
                                                                      h(<
                                                                         <
                                                                          <
                                                                           <
                                                                            <
                                                                             <'0', '1', '0x0303', ~tid, '0', 
                                                                              $cipher_suites, '0', 
                                                                              <'43', '0x0304'>, 
                                                                              <'10', $g1, $g>, 
                                                                              <'13', $sig_algs>, '40', $g1, 
                                                                              $g1^~x>, 
                                                                             '6', '0x0303', '40', $g>, 
                                                                            '1', '0x0303', ~tid, '0', 
                                                                            $cipher_suites.1, '0', 
                                                                            <'43', '0x0304'>, 
                                                                            <'10', $g1, $g>, 
                                                                            <'13', $sig_algs.1>, '40', $g, 
                                                                            $g^~x.1>, 
                                                                           '2', '0x0303', p_ns, 
                                                                           $cipher_suite, 
                                                                           <'13', $sig_algs.2>, '40', $g, p_gy
                                                                          >, 
                                                                          '8', $exts>, 
                                                                         '11', '0', pk(~ltkS)>)
                                                                     >,
                                                                     ~ltkS)
                                                               >)
                                                            >,
                                                            '32'),
                                                     <'fin', '0'>, '32'), 
                                              h(<
                                                 <
                                                  <
                                                   <
                                                    <
                                                     <
                                                      <'0', '1', '0x0303', ~tid, '0', $cipher_suites, '0', 
                                                       <'43', '0x0304'>, <'10', $g1, $g>, <'13', $sig_algs>, 
                                                       '40', $g1, $g1^~x>, 
                                                      '6', '0x0303', '40', $g>, 
                                                     '1', '0x0303', ~tid, '0', $cipher_suites.1, '0', 
                                                     <'43', '0x0304'>, <'10', $g1, $g>, <'13', $sig_algs.1>, 
                                                     '40', $g, $g^~x.1>, 
                                                    '2', '0x0303', p_ns, $cipher_suite, <'13', $sig_algs.2>, 
                                                    '40', $g, p_gy>, 
                                                   '8', $exts>, 
                                                  '11', '0', pk(~ltkS)>, 
                                                 '15', 
                                                 sign(<'server_cv', 
                                                       h(<
                                                          <
                                                           <
                                                            <
                                                             <
                                                              <'0', '1', '0x0303', ~tid, '0', $cipher_suites, 
                                                               '0', <'43', '0x0304'>, <'10', $g1, $g>, 
                                                               <'13', $sig_algs>, '40', $g1, $g1^~x>, 
                                                              '6', '0x0303', '40', $g>, 
                                                             '1', '0x0303', ~tid, '0', $cipher_suites.1, '0', 
                                                             <'43', '0x0304'>, <'10', $g1, $g>, 
                                                             <'13', $sig_algs.1>, '40', $g, $g^~x.1>, 
                                                            '2', '0x0303', p_ns, $cipher_suite, 
                                                            <'13', $sig_algs.2>, '40', $g, p_gy>, 
                                                           '8', $exts>, 
                                                          '11', '0', pk(~ltkS)>)
                                                      >,
                                                      ~ltkS)
                                                >)
                                             >)
                                       >)
                                    >,
                                    '32')
                  ) ▶₀ #l )
      qed
    next
      case recv_server_auth_case_03
      solve( (∃ #j.2.
               (!KU( Extract('0', Extract(p_gxy, Extract(~res_psk, '0'))) ) @ #j.2)
              ∧
               #j.2 < #j.1)  ∥
             ((∀ #k.
                (!KU( Extract('0', Extract(p_gxy, Extract(~res_psk, '0'))) ) @ #k)
               ⇒
                ¬(#k < #j.1)) ∧
              (∃ actor #l.
                (RevealPSK( actor,
                            Expand(Extract('0', Extract(p_gxy, Extract(~res_psk, '0'))),
                                   <'serverats', 
                                    h(<
                                       <
                                        <
                                         <
                                          <
                                           <
                                            <
                                             <'0', '1', '0x0303', ~tid, '0', $cipher_suites, '0', 
                                              <'43', '0x0304'>, <'10', $g1, $g>, <'40', $g1, $g1^~x>, 
                                              <'45', '0', '1'>, <'42', '0'>, '41', 
                                              <~ticket, mask(~ticket_age_add, $ticket_age)>, 
                                              hmac(<
                                                    Expand(Expand(Extract(~res_psk, '0'), <'ext', 'pbk'>,
                                                                  '32'),
                                                           <'0', '0'>, '32'), 
                                                    h(<'0', '1', '0x0303', ~tid, '0', $cipher_suites, '0', 
                                                       <'43', '0x0304'>, <'10', $g1, $g>, 
                                                       <'40', $g1, $g1^~x>, <'45', '0', '1'>, <'42', '0'>, 
                                                       '41', <~ticket, mask(~ticket_age_add, $ticket_age)>, 
                                                       '0'>)
                                                   >)
                                             >, 
                                             '6', '0x0303', '40', $g>, 
                                            '1', '0x0303', ~tid, '0', $cipher_suites.1, '0', 
                                            <'43', '0x0304'>, <'10', $g1, $g>, <'13', $sig_algs>, '40', $g, 
                                            $g^~x.1>, 
                                           '2', '0x0303', p_ns, $cipher_suite, <'13', $sig_algs.1>, '40', $g, 
                                           p_gy>, 
                                          '8', $exts>, 
                                         '11', '0', pk(~ltkS)>, 
                                        '15', 
                                        sign(<'server_cv', 
                                              h(<
                                                 <
                                                  <
                                                   <
                                                    <
                                                     <'0', '1', '0x0303', ~tid, '0', $cipher_suites, '0', 
                                                      <'43', '0x0304'>, <'10', $g1, $g>, <'40', $g1, $g1^~x>, 
                                                      <'45', '0', '1'>, <'42', '0'>, '41', 
                                                      <~ticket, mask(~ticket_age_add, $ticket_age)>, 
                                                      hmac(<
                                                            Expand(Expand(Extract(~res_psk, '0'),
                                                                          <'ext', 'pbk'>, '32'),
                                                                   <'0', '0'>, '32'), 
                                                            h(<'0', '1', '0x0303', ~tid, '0', $cipher_suites, 
                                                               '0', <'43', '0x0304'>, <'10', $g1, $g>, 
                                                               <'40', $g1, $g1^~x>, <'45', '0', '1'>, 
                                                               <'42', '0'>, '41', 
                                                               <~ticket, mask(~ticket_age_add, $ticket_age)>, 
                                                               '0'>)
                                                           >)
                                                     >, 
                                                     '6', '0x0303', '40', $g>, 
                                                    '1', '0x0303', ~tid, '0', $cipher_suites.1, '0', 
                                                    <'43', '0x0304'>, <'10', $g1, $g>, <'13', $sig_algs>, 
                                                    '40', $g, $g^~x.1>, 
                                                   '2', '0x0303', p_ns, $cipher_suite, <'13', $sig_algs.1>, 
                                                   '40', $g, p_gy>, 
                                                  '8', $exts>, 
                                                 '11', '0', pk(~ltkS)>)
                                             >,
                                             ~ltkS)
                                       >, 
                                       '20', 
                                       hmac(<
                                             Expand(Expand(Extract(p_gxy, Extract(~res_psk, '0')),
                                                           <'serverhts', 
                                                            h(<
                                                               <
                                                                <
                                                                 <
                                                                  <
                                                                   <
                                                                    <'0', '1', '0x0303', ~tid, '0', 
                                                                     $cipher_suites, '0', <'43', '0x0304'>, 
                                                                     <'10', $g1, $g>, <'40', $g1, $g1^~x>, 
                                                                     <'45', '0', '1'>, <'42', '0'>, '41', 
                                                                     <~ticket, 
                                                                      mask(~ticket_age_add, $ticket_age)>, 
                                                                     hmac(<
                                                                           Expand(Expand(Extract(~res_psk,
                                                                                                 '0'),
                                                                                         <'ext', 'pbk'>,
                                                                                         '32'),
                                                                                  <'0', '0'>, '32'), 
                                                                           h(<'0', '1', '0x0303', ~tid, '0', 
                                                                              $cipher_suites, '0', 
                                                                              <'43', '0x0304'>, 
                                                                              <'10', $g1, $g>, 
                                                                              <'40', $g1, $g1^~x>, 
                                                                              <'45', '0', '1'>, <'42', '0'>, 
                                                                              '41', 
                                                                              <~ticket, 
                                                                               mask(~ticket_age_add,
                                                                                    $ticket_age)
                                                                              >, 
                                                                              '0'>)
                                                                          >)
                                                                    >, 
                                                                    '6', '0x0303', '40', $g>, 
                                                                   '1', '0x0303', ~tid, '0', 
                                                                   $cipher_suites.1, '0', <'43', '0x0304'>, 
                                                                   <'10', $g1, $g>, <'13', $sig_algs>, '40', 
                                                                   $g, $g^~x.1>, 
                                                                  '2', '0x0303', p_ns, $cipher_suite, 
                                                                  <'13', $sig_algs.1>, '40', $g, p_gy>, 
                                                                 '8', $exts>, 
                                                                '11', '0', pk(~ltkS)>, 
                                                               '15', 
                                                               sign(<'server_cv', 
                                                                     h(<
                                                                        <
                                                                         <
                                                                          <
                                                                           <
                                                                            <'0', '1', '0x0303', ~tid, '0', 
                                                                             $cipher_suites, '0', 
                                                                             <'43', '0x0304'>, 
                                                                             <'10', $g1, $g>, 
                                                                             <'40', $g1, $g1^~x>, 
                                                                             <'45', '0', '1'>, <'42', '0'>, 
                                                                             '41', 
                                                                             <~ticket, 
                                                                              mask(~ticket_age_add,
                                                                                   $ticket_age)
                                                                             >, 
                                                                             hmac(<
                                                                                   Expand(Expand(Extract(~res_psk,
                                                                                                         '0'),
                                                                                                 <'ext', 'pbk'
                                                                                                 >,
                                                                                                 '32'),
                                                                                          <'0', '0'>, '32'), 
                                                                                   h(<'0', '1', '0x0303', 
                                                                                      ~tid, '0', 
                                                                                      $cipher_suites, '0', 
                                                                                      <'43', '0x0304'>, 
                                                                                      <'10', $g1, $g>, 
                                                                                      <'40', $g1, $g1^~x>, 
                                                                                      <'45', '0', '1'>, 
                                                                                      <'42', '0'>, '41', 
                                                                                      <~ticket, 
                                                                                       mask(~ticket_age_add,
                                                                                            $ticket_age)
                                                                                      >, 
                                                                                      '0'>)
                                                                                  >)
                                                                            >, 
                                                                            '6', '0x0303', '40', $g>, 
                                                                           '1', '0x0303', ~tid, '0', 
                                                                           $cipher_suites.1, '0', 
                                                                           <'43', '0x0304'>, <'10', $g1, $g>, 
                                                                           <'13', $sig_algs>, '40', $g, 
                                                                           $g^~x.1>, 
                                                                          '2', '0x0303', p_ns, $cipher_suite, 
                                                                          <'13', $sig_algs.1>, '40', $g, p_gy
                                                                         >, 
                                                                         '8', $exts>, 
                                                                        '11', '0', pk(~ltkS)>)
                                                                    >,
                                                                    ~ltkS)
                                                              >)
                                                           >,
                                                           '32'),
                                                    <'fin', '0'>, '32'), 
                                             h(<
                                                <
                                                 <
                                                  <
                                                   <
                                                    <
                                                     <'0', '1', '0x0303', ~tid, '0', $cipher_suites, '0', 
                                                      <'43', '0x0304'>, <'10', $g1, $g>, <'40', $g1, $g1^~x>, 
                                                      <'45', '0', '1'>, <'42', '0'>, '41', 
                                                      <~ticket, mask(~ticket_age_add, $ticket_age)>, 
                                                      hmac(<
                                                            Expand(Expand(Extract(~res_psk, '0'),
                                                                          <'ext', 'pbk'>, '32'),
                                                                   <'0', '0'>, '32'), 
                                                            h(<'0', '1', '0x0303', ~tid, '0', $cipher_suites, 
                                                               '0', <'43', '0x0304'>, <'10', $g1, $g>, 
                                                               <'40', $g1, $g1^~x>, <'45', '0', '1'>, 
                                                               <'42', '0'>, '41', 
                                                               <~ticket, mask(~ticket_age_add, $ticket_age)>, 
                                                               '0'>)
                                                           >)
                                                     >, 
                                                     '6', '0x0303', '40', $g>, 
                                                    '1', '0x0303', ~tid, '0', $cipher_suites.1, '0', 
                                                    <'43', '0x0304'>, <'10', $g1, $g>, <'13', $sig_algs>, 
                                                    '40', $g, $g^~x.1>, 
                                                   '2', '0x0303', p_ns, $cipher_suite, <'13', $sig_algs.1>, 
                                                   '40', $g, p_gy>, 
                                                  '8', $exts>, 
                                                 '11', '0', pk(~ltkS)>, 
                                                '15', 
                                                sign(<'server_cv', 
                                                      h(<
                                                         <
                                                          <
                                                           <
                                                            <
                                                             <'0', '1', '0x0303', ~tid, '0', $cipher_suites, 
                                                              '0', <'43', '0x0304'>, <'10', $g1, $g>, 
                                                              <'40', $g1, $g1^~x>, <'45', '0', '1'>, 
                                                              <'42', '0'>, '41', 
                                                              <~ticket, mask(~ticket_age_add, $ticket_age)>, 
                                                              hmac(<
                                                                    Expand(Expand(Extract(~res_psk, '0'),
                                                                                  <'ext', 'pbk'>, '32'),
                                                                           <'0', '0'>, '32'), 
                                                                    h(<'0', '1', '0x0303', ~tid, '0', 
                                                                       $cipher_suites, '0', <'43', '0x0304'>, 
                                                                       <'10', $g1, $g>, <'40', $g1, $g1^~x>, 
                                                                       <'45', '0', '1'>, <'42', '0'>, '41', 
                                                                       <~ticket, 
                                                                        mask(~ticket_age_add, $ticket_age)>, 
                                                                       '0'>)
                                                                   >)
                                                             >, 
                                                             '6', '0x0303', '40', $g>, 
                                                            '1', '0x0303', ~tid, '0', $cipher_suites.1, '0', 
                                                            <'43', '0x0304'>, <'10', $g1, $g>, 
                                                            <'13', $sig_algs>, '40', $g, $g^~x.1>, 
                                                           '2', '0x0303', p_ns, $cipher_suite, 
                                                           <'13', $sig_algs.1>, '40', $g, p_gy>, 
                                                          '8', $exts>, 
                                                         '11', '0', pk(~ltkS)>)
                                                     >,
                                                     ~ltkS)
                                               >)
                                            >)
                                      >)
                                   >,
                                   '32')
                 ) @ #l)
               ∧
                #l < #j.1)) )
        case case_1
        solve( (∃ #r. (RevLtk( $S ) @ #r) ∧ #r < #vr)  ∥
               (∃ tid3 x #r. (RevDHExp( tid3, $S, x ) @ #r) ∧ #r < #vr)  ∥
               (∃ tid4 y #r. (RevDHExp( tid4, $C, y ) @ #r) ∧ #r < #vr)  ∥
               (∃ rms #r. (RevealPSK( $C, rms ) @ #r) ∧ #r < #k.1)  ∥
               (∃ rms #r. (RevealPSK( $S, rms ) @ #r) ∧ #r < #k.1) )
          case case_1
          by contradiction /* from formulas */
        next
          case case_2
          by contradiction /* from formulas */
        next
          case case_3
          by contradiction /* from formulas */
        next
          case case_4
          by contradiction /* from formulas */
        next
          case case_5
          by contradiction /* from formulas */
        qed
      next
        case case_2
        by solve( SecretPSK( $A,
                             Expand(Extract('0', Extract(p_gxy, Extract(~res_psk, '0'))),
                                    <'serverats', 
                                     h(<
                                        <
                                         <
                                          <
                                           <
                                            <
                                             <
                                              <'0', '1', '0x0303', ~tid, '0', $cipher_suites, '0', 
                                               <'43', '0x0304'>, <'10', $g1, $g>, <'40', $g1, $g1^~x>, 
                                               <'45', '0', '1'>, <'42', '0'>, '41', 
                                               <~ticket, mask(~ticket_age_add, $ticket_age)>, 
                                               hmac(<
                                                     Expand(Expand(Extract(~res_psk, '0'), <'ext', 'pbk'>,
                                                                   '32'),
                                                            <'0', '0'>, '32'), 
                                                     h(<'0', '1', '0x0303', ~tid, '0', $cipher_suites, '0', 
                                                        <'43', '0x0304'>, <'10', $g1, $g>, 
                                                        <'40', $g1, $g1^~x>, <'45', '0', '1'>, <'42', '0'>, 
                                                        '41', <~ticket, mask(~ticket_age_add, $ticket_age)>, 
                                                        '0'>)
                                                    >)
                                              >, 
                                              '6', '0x0303', '40', $g>, 
                                             '1', '0x0303', ~tid, '0', $cipher_suites.1, '0', 
                                             <'43', '0x0304'>, <'10', $g1, $g>, <'13', $sig_algs>, '40', $g, 
                                             $g^~x.1>, 
                                            '2', '0x0303', p_ns, $cipher_suite, <'13', $sig_algs.1>, '40', 
                                            $g, p_gy>, 
                                           '8', $exts>, 
                                          '11', '0', pk(~ltkS)>, 
                                         '15', 
                                         sign(<'server_cv', 
                                               h(<
                                                  <
                                                   <
                                                    <
                                                     <
                                                      <'0', '1', '0x0303', ~tid, '0', $cipher_suites, '0', 
                                                       <'43', '0x0304'>, <'10', $g1, $g>, 
                                                       <'40', $g1, $g1^~x>, <'45', '0', '1'>, <'42', '0'>, 
                                                       '41', <~ticket, mask(~ticket_age_add, $ticket_age)>, 
                                                       hmac(<
                                                             Expand(Expand(Extract(~res_psk, '0'),
                                                                           <'ext', 'pbk'>, '32'),
                                                                    <'0', '0'>, '32'), 
                                                             h(<'0', '1', '0x0303', ~tid, '0', 
                                                                $cipher_suites, '0', <'43', '0x0304'>, 
                                                                <'10', $g1, $g>, <'40', $g1, $g1^~x>, 
                                                                <'45', '0', '1'>, <'42', '0'>, '41', 
                                                                <~ticket, mask(~ticket_age_add, $ticket_age)
                                                                >, 
                                                                '0'>)
                                                            >)
                                                      >, 
                                                      '6', '0x0303', '40', $g>, 
                                                     '1', '0x0303', ~tid, '0', $cipher_suites.1, '0', 
                                                     <'43', '0x0304'>, <'10', $g1, $g>, <'13', $sig_algs>, 
                                                     '40', $g, $g^~x.1>, 
                                                    '2', '0x0303', p_ns, $cipher_suite, <'13', $sig_algs.1>, 
                                                    '40', $g, p_gy>, 
                                                   '8', $exts>, 
                                                  '11', '0', pk(~ltkS)>)
                                              >,
                                              ~ltkS)
                                        >, 
                                        '20', 
                                        hmac(<
                                              Expand(Expand(Extract(p_gxy, Extract(~res_psk, '0')),
                                                            <'serverhts', 
                                                             h(<
                                                                <
                                                                 <
                                                                  <
                                                                   <
                                                                    <
                                                                     <'0', '1', '0x0303', ~tid, '0', 
                                                                      $cipher_suites, '0', <'43', '0x0304'>, 
                                                                      <'10', $g1, $g>, <'40', $g1, $g1^~x>, 
                                                                      <'45', '0', '1'>, <'42', '0'>, '41', 
                                                                      <~ticket, 
                                                                       mask(~ticket_age_add, $ticket_age)>, 
                                                                      hmac(<
                                                                            Expand(Expand(Extract(~res_psk,
                                                                                                  '0'),
                                                                                          <'ext', 'pbk'>,
                                                                                          '32'),
                                                                                   <'0', '0'>, '32'), 
                                                                            h(<'0', '1', '0x0303', ~tid, '0', 
                                                                               $cipher_suites, '0', 
                                                                               <'43', '0x0304'>, 
                                                                               <'10', $g1, $g>, 
                                                                               <'40', $g1, $g1^~x>, 
                                                                               <'45', '0', '1'>, <'42', '0'>, 
                                                                               '41', 
                                                                               <~ticket, 
                                                                                mask(~ticket_age_add,
                                                                                     $ticket_age)
                                                                               >, 
                                                                               '0'>)
                                                                           >)
                                                                     >, 
                                                                     '6', '0x0303', '40', $g>, 
                                                                    '1', '0x0303', ~tid, '0', 
                                                                    $cipher_suites.1, '0', <'43', '0x0304'>, 
                                                                    <'10', $g1, $g>, <'13', $sig_algs>, '40', 
                                                                    $g, $g^~x.1>, 
                                                                   '2', '0x0303', p_ns, $cipher_suite, 
                                                                   <'13', $sig_algs.1>, '40', $g, p_gy>, 
                                                                  '8', $exts>, 
                                                                 '11', '0', pk(~ltkS)>, 
                                                                '15', 
                                                                sign(<'server_cv', 
                                                                      h(<
                                                                         <
                                                                          <
                                                                           <
                                                                            <
                                                                             <'0', '1', '0x0303', ~tid, '0', 
                                                                              $cipher_suites, '0', 
                                                                              <'43', '0x0304'>, 
                                                                              <'10', $g1, $g>, 
                                                                              <'40', $g1, $g1^~x>, 
                                                                              <'45', '0', '1'>, <'42', '0'>, 
                                                                              '41', 
                                                                              <~ticket, 
                                                                               mask(~ticket_age_add,
                                                                                    $ticket_age)
                                                                              >, 
                                                                              hmac(<
                                                                                    Expand(Expand(Extract(~res_psk,
                                                                                                          '0'),
                                                                                                  <'ext', 
                                                                                                   'pbk'>,
                                                                                                  '32'),
                                                                                           <'0', '0'>, '32'), 
                                                                                    h(<'0', '1', '0x0303', 
                                                                                       ~tid, '0', 
                                                                                       $cipher_suites, '0', 
                                                                                       <'43', '0x0304'>, 
                                                                                       <'10', $g1, $g>, 
                                                                                       <'40', $g1, $g1^~x>, 
                                                                                       <'45', '0', '1'>, 
                                                                                       <'42', '0'>, '41', 
                                                                                       <~ticket, 
                                                                                        mask(~ticket_age_add,
                                                                                             $ticket_age)
                                                                                       >, 
                                                                                       '0'>)
                                                                                   >)
                                                                             >, 
                                                                             '6', '0x0303', '40', $g>, 
                                                                            '1', '0x0303', ~tid, '0', 
                                                                            $cipher_suites.1, '0', 
                                                                            <'43', '0x0304'>, 
                                                                            <'10', $g1, $g>, 
                                                                            <'13', $sig_algs>, '40', $g, 
                                                                            $g^~x.1>, 
                                                                           '2', '0x0303', p_ns, 
                                                                           $cipher_suite, 
                                                                           <'13', $sig_algs.1>, '40', $g, p_gy
                                                                          >, 
                                                                          '8', $exts>, 
                                                                         '11', '0', pk(~ltkS)>)
                                                                     >,
                                                                     ~ltkS)
                                                               >)
                                                            >,
                                                            '32'),
                                                     <'fin', '0'>, '32'), 
                                              h(<
                                                 <
                                                  <
                                                   <
                                                    <
                                                     <
                                                      <'0', '1', '0x0303', ~tid, '0', $cipher_suites, '0', 
                                                       <'43', '0x0304'>, <'10', $g1, $g>, 
                                                       <'40', $g1, $g1^~x>, <'45', '0', '1'>, <'42', '0'>, 
                                                       '41', <~ticket, mask(~ticket_age_add, $ticket_age)>, 
                                                       hmac(<
                                                             Expand(Expand(Extract(~res_psk, '0'),
                                                                           <'ext', 'pbk'>, '32'),
                                                                    <'0', '0'>, '32'), 
                                                             h(<'0', '1', '0x0303', ~tid, '0', 
                                                                $cipher_suites, '0', <'43', '0x0304'>, 
                                                                <'10', $g1, $g>, <'40', $g1, $g1^~x>, 
                                                                <'45', '0', '1'>, <'42', '0'>, '41', 
                                                                <~ticket, mask(~ticket_age_add, $ticket_age)
                                                                >, 
                                                                '0'>)
                                                            >)
                                                      >, 
                                                      '6', '0x0303', '40', $g>, 
                                                     '1', '0x0303', ~tid, '0', $cipher_suites.1, '0', 
                                                     <'43', '0x0304'>, <'10', $g1, $g>, <'13', $sig_algs>, 
                                                     '40', $g, $g^~x.1>, 
                                                    '2', '0x0303', p_ns, $cipher_suite, <'13', $sig_algs.1>, 
                                                    '40', $g, p_gy>, 
                                                   '8', $exts>, 
                                                  '11', '0', pk(~ltkS)>, 
                                                 '15', 
                                                 sign(<'server_cv', 
                                                       h(<
                                                          <
                                                           <
                                                            <
                                                             <
                                                              <'0', '1', '0x0303', ~tid, '0', $cipher_suites, 
                                                               '0', <'43', '0x0304'>, <'10', $g1, $g>, 
                                                               <'40', $g1, $g1^~x>, <'45', '0', '1'>, 
                                                               <'42', '0'>, '41', 
                                                               <~ticket, mask(~ticket_age_add, $ticket_age)>, 
                                                               hmac(<
                                                                     Expand(Expand(Extract(~res_psk, '0'),
                                                                                   <'ext', 'pbk'>, '32'),
                                                                            <'0', '0'>, '32'), 
                                                                     h(<'0', '1', '0x0303', ~tid, '0', 
                                                                        $cipher_suites, '0', 
                                                                        <'43', '0x0304'>, <'10', $g1, $g>, 
                                                                        <'40', $g1, $g1^~x>, 
                                                                        <'45', '0', '1'>, <'42', '0'>, '41', 
                                                                        <~ticket, 
                                                                         mask(~ticket_age_add, $ticket_age)>, 
                                                                        '0'>)
                                                                    >)
                                                              >, 
                                                              '6', '0x0303', '40', $g>, 
                                                             '1', '0x0303', ~tid, '0', $cipher_suites.1, '0', 
                                                             <'43', '0x0304'>, <'10', $g1, $g>, 
                                                             <'13', $sig_algs>, '40', $g, $g^~x.1>, 
                                                            '2', '0x0303', p_ns, $cipher_suite, 
                                                            <'13', $sig_algs.1>, '40', $g, p_gy>, 
                                                           '8', $exts>, 
                                                          '11', '0', pk(~ltkS)>)
                                                      >,
                                                      ~ltkS)
                                                >)
                                             >)
                                       >)
                                    >,
                                    '32')
                  ) ▶₀ #l )
      qed
    next
      case recv_server_auth_case_04
      solve( (∃ #j.2.
               (!KU( Extract('0',
                             Extract(p_gxy, Extract(Expand(ms, <'rms', h(messages)>, '32'), '0')))
                ) @ #j.2)
              ∧
               #j.2 < #j.1)  ∥
             ((∀ #k.
                (!KU( Extract('0',
                              Extract(p_gxy, Extract(Expand(ms, <'rms', h(messages)>, '32'), '0')))
                 ) @ #k)
               ⇒
                ¬(#k < #j.1)) ∧
              (∃ actor #l.
                (RevealPSK( actor,
                            Expand(Extract('0',
                                           Extract(p_gxy,
                                                   Extract(Expand(ms, <'rms', h(messages)>, '32'), '0'))),
                                   <'serverats', 
                                    h(<
                                       <
                                        <
                                         <
                                          <
                                           <
                                            <
                                             <'0', '1', '0x0303', ~tid, '0', $cipher_suites, '0', 
                                              <'43', '0x0304'>, <'10', $g1, $g>, <'40', $g1, $g1^~x>, 
                                              <'45', '0', '1'>, <'42', '0'>, '41', 
                                              <p_psk_id, mask(ticket_age_add, $ticket_age)>, 
                                              hmac(<
                                                    Expand(Expand(Extract(Expand(ms, <'rms', h(messages)>,
                                                                                 '32'),
                                                                          '0'),
                                                                  <'res', 'pbk'>, '32'),
                                                           <'0', '0'>, '32'), 
                                                    h(<'0', '1', '0x0303', ~tid, '0', $cipher_suites, '0', 
                                                       <'43', '0x0304'>, <'10', $g1, $g>, 
                                                       <'40', $g1, $g1^~x>, <'45', '0', '1'>, <'42', '0'>, 
                                                       '41', <p_psk_id, mask(ticket_age_add, $ticket_age)>, 
                                                       '0'>)
                                                   >)
                                             >, 
                                             '6', '0x0303', '40', $g>, 
                                            '1', '0x0303', ~tid, '0', $cipher_suites.1, '0', 
                                            <'43', '0x0304'>, <'10', $g1, $g>, <'13', $sig_algs>, '40', $g, 
                                            $g^~x.1>, 
                                           '2', '0x0303', p_ns, $cipher_suite, <'13', $sig_algs.1>, '40', $g, 
                                           p_gy>, 
                                          '8', $exts>, 
                                         '11', '0', pk(~ltkS)>, 
                                        '15', 
                                        sign(<'server_cv', 
                                              h(<
                                                 <
                                                  <
                                                   <
                                                    <
                                                     <'0', '1', '0x0303', ~tid, '0', $cipher_suites, '0', 
                                                      <'43', '0x0304'>, <'10', $g1, $g>, <'40', $g1, $g1^~x>, 
                                                      <'45', '0', '1'>, <'42', '0'>, '41', 
                                                      <p_psk_id, mask(ticket_age_add, $ticket_age)>, 
                                                      hmac(<
                                                            Expand(Expand(Extract(Expand(ms,
                                                                                         <'rms', h(messages)>,
                                                                                         '32'),
                                                                                  '0'),
                                                                          <'res', 'pbk'>, '32'),
                                                                   <'0', '0'>, '32'), 
                                                            h(<'0', '1', '0x0303', ~tid, '0', $cipher_suites, 
                                                               '0', <'43', '0x0304'>, <'10', $g1, $g>, 
                                                               <'40', $g1, $g1^~x>, <'45', '0', '1'>, 
                                                               <'42', '0'>, '41', 
                                                               <p_psk_id, mask(ticket_age_add, $ticket_age)>, 
                                                               '0'>)
                                                           >)
                                                     >, 
                                                     '6', '0x0303', '40', $g>, 
                                                    '1', '0x0303', ~tid, '0', $cipher_suites.1, '0', 
                                                    <'43', '0x0304'>, <'10', $g1, $g>, <'13', $sig_algs>, 
                                                    '40', $g, $g^~x.1>, 
                                                   '2', '0x0303', p_ns, $cipher_suite, <'13', $sig_algs.1>, 
                                                   '40', $g, p_gy>, 
                                                  '8', $exts>, 
                                                 '11', '0', pk(~ltkS)>)
                                             >,
                                             ~ltkS)
                                       >, 
                                       '20', 
                                       hmac(<
                                             Expand(Expand(Extract(p_gxy,
                                                                   Extract(Expand(ms, <'rms', h(messages)>,
                                                                                  '32'),
                                                                           '0')),
                                                           <'serverhts', 
                                                            h(<
                                                               <
                                                                <
                                                                 <
                                                                  <
                                                                   <
                                                                    <'0', '1', '0x0303', ~tid, '0', 
                                                                     $cipher_suites, '0', <'43', '0x0304'>, 
                                                                     <'10', $g1, $g>, <'40', $g1, $g1^~x>, 
                                                                     <'45', '0', '1'>, <'42', '0'>, '41', 
                                                                     <p_psk_id, 
                                                                      mask(ticket_age_add, $ticket_age)>, 
                                                                     hmac(<
                                                                           Expand(Expand(Extract(Expand(ms,
                                                                                                        <
                                                                                                         'rms', 
                                                                                                         h(messages)
                                                                                                        >,
                                                                                                        '32'),
                                                                                                 '0'),
                                                                                         <'res', 'pbk'>,
                                                                                         '32'),
                                                                                  <'0', '0'>, '32'), 
                                                                           h(<'0', '1', '0x0303', ~tid, '0', 
                                                                              $cipher_suites, '0', 
                                                                              <'43', '0x0304'>, 
                                                                              <'10', $g1, $g>, 
                                                                              <'40', $g1, $g1^~x>, 
                                                                              <'45', '0', '1'>, <'42', '0'>, 
                                                                              '41', 
                                                                              <p_psk_id, 
                                                                               mask(ticket_age_add,
                                                                                    $ticket_age)
                                                                              >, 
                                                                              '0'>)
                                                                          >)
                                                                    >, 
                                                                    '6', '0x0303', '40', $g>, 
                                                                   '1', '0x0303', ~tid, '0', 
                                                                   $cipher_suites.1, '0', <'43', '0x0304'>, 
                                                                   <'10', $g1, $g>, <'13', $sig_algs>, '40', 
                                                                   $g, $g^~x.1>, 
                                                                  '2', '0x0303', p_ns, $cipher_suite, 
                                                                  <'13', $sig_algs.1>, '40', $g, p_gy>, 
                                                                 '8', $exts>, 
                                                                '11', '0', pk(~ltkS)>, 
                                                               '15', 
                                                               sign(<'server_cv', 
                                                                     h(<
                                                                        <
                                                                         <
                                                                          <
                                                                           <
                                                                            <'0', '1', '0x0303', ~tid, '0', 
                                                                             $cipher_suites, '0', 
                                                                             <'43', '0x0304'>, 
                                                                             <'10', $g1, $g>, 
                                                                             <'40', $g1, $g1^~x>, 
                                                                             <'45', '0', '1'>, <'42', '0'>, 
                                                                             '41', 
                                                                             <p_psk_id, 
                                                                              mask(ticket_age_add,
                                                                                   $ticket_age)
                                                                             >, 
                                                                             hmac(<
                                                                                   Expand(Expand(Extract(Expand(ms,
                                                                                                                <
                                                                                                                 'rms', 
                                                                                                                 h(messages)
                                                                                                                >,
                                                                                                                '32'),
                                                                                                         '0'),
                                                                                                 <'res', 'pbk'
                                                                                                 >,
                                                                                                 '32'),
                                                                                          <'0', '0'>, '32'), 
                                                                                   h(<'0', '1', '0x0303', 
                                                                                      ~tid, '0', 
                                                                                      $cipher_suites, '0', 
                                                                                      <'43', '0x0304'>, 
                                                                                      <'10', $g1, $g>, 
                                                                                      <'40', $g1, $g1^~x>, 
                                                                                      <'45', '0', '1'>, 
                                                                                      <'42', '0'>, '41', 
                                                                                      <p_psk_id, 
                                                                                       mask(ticket_age_add,
                                                                                            $ticket_age)
                                                                                      >, 
                                                                                      '0'>)
                                                                                  >)
                                                                            >, 
                                                                            '6', '0x0303', '40', $g>, 
                                                                           '1', '0x0303', ~tid, '0', 
                                                                           $cipher_suites.1, '0', 
                                                                           <'43', '0x0304'>, <'10', $g1, $g>, 
                                                                           <'13', $sig_algs>, '40', $g, 
                                                                           $g^~x.1>, 
                                                                          '2', '0x0303', p_ns, $cipher_suite, 
                                                                          <'13', $sig_algs.1>, '40', $g, p_gy
                                                                         >, 
                                                                         '8', $exts>, 
                                                                        '11', '0', pk(~ltkS)>)
                                                                    >,
                                                                    ~ltkS)
                                                              >)
                                                           >,
                                                           '32'),
                                                    <'fin', '0'>, '32'), 
                                             h(<
                                                <
                                                 <
                                                  <
                                                   <
                                                    <
                                                     <'0', '1', '0x0303', ~tid, '0', $cipher_suites, '0', 
                                                      <'43', '0x0304'>, <'10', $g1, $g>, <'40', $g1, $g1^~x>, 
                                                      <'45', '0', '1'>, <'42', '0'>, '41', 
                                                      <p_psk_id, mask(ticket_age_add, $ticket_age)>, 
                                                      hmac(<
                                                            Expand(Expand(Extract(Expand(ms,
                                                                                         <'rms', h(messages)>,
                                                                                         '32'),
                                                                                  '0'),
                                                                          <'res', 'pbk'>, '32'),
                                                                   <'0', '0'>, '32'), 
                                                            h(<'0', '1', '0x0303', ~tid, '0', $cipher_suites, 
                                                               '0', <'43', '0x0304'>, <'10', $g1, $g>, 
                                                               <'40', $g1, $g1^~x>, <'45', '0', '1'>, 
                                                               <'42', '0'>, '41', 
                                                               <p_psk_id, mask(ticket_age_add, $ticket_age)>, 
                                                               '0'>)
                                                           >)
                                                     >, 
                                                     '6', '0x0303', '40', $g>, 
                                                    '1', '0x0303', ~tid, '0', $cipher_suites.1, '0', 
                                                    <'43', '0x0304'>, <'10', $g1, $g>, <'13', $sig_algs>, 
                                                    '40', $g, $g^~x.1>, 
                                                   '2', '0x0303', p_ns, $cipher_suite, <'13', $sig_algs.1>, 
                                                   '40', $g, p_gy>, 
                                                  '8', $exts>, 
                                                 '11', '0', pk(~ltkS)>, 
                                                '15', 
                                                sign(<'server_cv', 
                                                      h(<
                                                         <
                                                          <
                                                           <
                                                            <
                                                             <'0', '1', '0x0303', ~tid, '0', $cipher_suites, 
                                                              '0', <'43', '0x0304'>, <'10', $g1, $g>, 
                                                              <'40', $g1, $g1^~x>, <'45', '0', '1'>, 
                                                              <'42', '0'>, '41', 
                                                              <p_psk_id, mask(ticket_age_add, $ticket_age)>, 
                                                              hmac(<
                                                                    Expand(Expand(Extract(Expand(ms,
                                                                                                 <'rms', 
                                                                                                  h(messages)
                                                                                                 >,
                                                                                                 '32'),
                                                                                          '0'),
                                                                                  <'res', 'pbk'>, '32'),
                                                                           <'0', '0'>, '32'), 
                                                                    h(<'0', '1', '0x0303', ~tid, '0', 
                                                                       $cipher_suites, '0', <'43', '0x0304'>, 
                                                                       <'10', $g1, $g>, <'40', $g1, $g1^~x>, 
                                                                       <'45', '0', '1'>, <'42', '0'>, '41', 
                                                                       <p_psk_id, 
                                                                        mask(ticket_age_add, $ticket_age)>, 
                                                                       '0'>)
                                                                   >)
                                                             >, 
                                                             '6', '0x0303', '40', $g>, 
                                                            '1', '0x0303', ~tid, '0', $cipher_suites.1, '0', 
                                                            <'43', '0x0304'>, <'10', $g1, $g>, 
                                                            <'13', $sig_algs>, '40', $g, $g^~x.1>, 
                                                           '2', '0x0303', p_ns, $cipher_suite, 
                                                           <'13', $sig_algs.1>, '40', $g, p_gy>, 
                                                          '8', $exts>, 
                                                         '11', '0', pk(~ltkS)>)
                                                     >,
                                                     ~ltkS)
                                               >)
                                            >)
                                      >)
                                   >,
                                   '32')
                 ) @ #l)
               ∧
                #l < #j.1)) )
        case case_1
        solve( (∃ #r. (RevLtk( $S ) @ #r) ∧ #r < #vr)  ∥
               (∃ tid3 x #r. (RevDHExp( tid3, $S, x ) @ #r) ∧ #r < #vr)  ∥
               (∃ tid4 y #r. (RevDHExp( tid4, $C, y ) @ #r) ∧ #r < #vr)  ∥
               (∃ rms #r. (RevealPSK( $C, rms ) @ #r) ∧ #r < #k.1)  ∥
               (∃ rms #r. (RevealPSK( $S, rms ) @ #r) ∧ #r < #k.1) )
          case case_1
          by contradiction /* from formulas */
        next
          case case_2
          by contradiction /* from formulas */
        next
          case case_3
          by contradiction /* from formulas */
        next
          case case_4
          by contradiction /* from formulas */
        next
          case case_5
          by contradiction /* from formulas */
        qed
      next
        case case_2
        by solve( SecretPSK( $A,
                             Expand(Extract('0',
                                            Extract(p_gxy,
                                                    Extract(Expand(ms, <'rms', h(messages)>, '32'), '0'))),
                                    <'serverats', 
                                     h(<
                                        <
                                         <
                                          <
                                           <
                                            <
                                             <
                                              <'0', '1', '0x0303', ~tid, '0', $cipher_suites, '0', 
                                               <'43', '0x0304'>, <'10', $g1, $g>, <'40', $g1, $g1^~x>, 
                                               <'45', '0', '1'>, <'42', '0'>, '41', 
                                               <p_psk_id, mask(ticket_age_add, $ticket_age)>, 
                                               hmac(<
                                                     Expand(Expand(Extract(Expand(ms, <'rms', h(messages)>,
                                                                                  '32'),
                                                                           '0'),
                                                                   <'res', 'pbk'>, '32'),
                                                            <'0', '0'>, '32'), 
                                                     h(<'0', '1', '0x0303', ~tid, '0', $cipher_suites, '0', 
                                                        <'43', '0x0304'>, <'10', $g1, $g>, 
                                                        <'40', $g1, $g1^~x>, <'45', '0', '1'>, <'42', '0'>, 
                                                        '41', <p_psk_id, mask(ticket_age_add, $ticket_age)>, 
                                                        '0'>)
                                                    >)
                                              >, 
                                              '6', '0x0303', '40', $g>, 
                                             '1', '0x0303', ~tid, '0', $cipher_suites.1, '0', 
                                             <'43', '0x0304'>, <'10', $g1, $g>, <'13', $sig_algs>, '40', $g, 
                                             $g^~x.1>, 
                                            '2', '0x0303', p_ns, $cipher_suite, <'13', $sig_algs.1>, '40', 
                                            $g, p_gy>, 
                                           '8', $exts>, 
                                          '11', '0', pk(~ltkS)>, 
                                         '15', 
                                         sign(<'server_cv', 
                                               h(<
                                                  <
                                                   <
                                                    <
                                                     <
                                                      <'0', '1', '0x0303', ~tid, '0', $cipher_suites, '0', 
                                                       <'43', '0x0304'>, <'10', $g1, $g>, 
                                                       <'40', $g1, $g1^~x>, <'45', '0', '1'>, <'42', '0'>, 
                                                       '41', <p_psk_id, mask(ticket_age_add, $ticket_age)>, 
                                                       hmac(<
                                                             Expand(Expand(Extract(Expand(ms,
                                                                                          <'rms', h(messages)
                                                                                          >,
                                                                                          '32'),
                                                                                   '0'),
                                                                           <'res', 'pbk'>, '32'),
                                                                    <'0', '0'>, '32'), 
                                                             h(<'0', '1', '0x0303', ~tid, '0', 
                                                                $cipher_suites, '0', <'43', '0x0304'>, 
                                                                <'10', $g1, $g>, <'40', $g1, $g1^~x>, 
                                                                <'45', '0', '1'>, <'42', '0'>, '41', 
                                                                <p_psk_id, mask(ticket_age_add, $ticket_age)
                                                                >, 
                                                                '0'>)
                                                            >)
                                                      >, 
                                                      '6', '0x0303', '40', $g>, 
                                                     '1', '0x0303', ~tid, '0', $cipher_suites.1, '0', 
                                                     <'43', '0x0304'>, <'10', $g1, $g>, <'13', $sig_algs>, 
                                                     '40', $g, $g^~x.1>, 
                                                    '2', '0x0303', p_ns, $cipher_suite, <'13', $sig_algs.1>, 
                                                    '40', $g, p_gy>, 
                                                   '8', $exts>, 
                                                  '11', '0', pk(~ltkS)>)
                                              >,
                                              ~ltkS)
                                        >, 
                                        '20', 
                                        hmac(<
                                              Expand(Expand(Extract(p_gxy,
                                                                    Extract(Expand(ms, <'rms', h(messages)>,
                                                                                   '32'),
                                                                            '0')),
                                                            <'serverhts', 
                                                             h(<
                                                                <
                                                                 <
                                                                  <
                                                                   <
                                                                    <
                                                                     <'0', '1', '0x0303', ~tid, '0', 
                                                                      $cipher_suites, '0', <'43', '0x0304'>, 
                                                                      <'10', $g1, $g>, <'40', $g1, $g1^~x>, 
                                                                      <'45', '0', '1'>, <'42', '0'>, '41', 
                                                                      <p_psk_id, 
                                                                       mask(ticket_age_add, $ticket_age)>, 
                                                                      hmac(<
                                                                            Expand(Expand(Extract(Expand(ms,
                                                                                                         <
                                                                                                          'rms', 
                                                                                                          h(messages)
                                                                                                         >,
                                                                                                         '32'),
                                                                                                  '0'),
                                                                                          <'res', 'pbk'>,
                                                                                          '32'),
                                                                                   <'0', '0'>, '32'), 
                                                                            h(<'0', '1', '0x0303', ~tid, '0', 
                                                                               $cipher_suites, '0', 
                                                                               <'43', '0x0304'>, 
                                                                               <'10', $g1, $g>, 
                                                                               <'40', $g1, $g1^~x>, 
                                                                               <'45', '0', '1'>, <'42', '0'>, 
                                                                               '41', 
                                                                               <p_psk_id, 
                                                                                mask(ticket_age_add,
                                                                                     $ticket_age)
                                                                               >, 
                                                                               '0'>)
                                                                           >)
                                                                     >, 
                                                                     '6', '0x0303', '40', $g>, 
                                                                    '1', '0x0303', ~tid, '0', 
                                                                    $cipher_suites.1, '0', <'43', '0x0304'>, 
                                                                    <'10', $g1, $g>, <'13', $sig_algs>, '40', 
                                                                    $g, $g^~x.1>, 
                                                                   '2', '0x0303', p_ns, $cipher_suite, 
                                                                   <'13', $sig_algs.1>, '40', $g, p_gy>, 
                                                                  '8', $exts>, 
                                                                 '11', '0', pk(~ltkS)>, 
                                                                '15', 
                                                                sign(<'server_cv', 
                                                                      h(<
                                                                         <
                                                                          <
                                                                           <
                                                                            <
                                                                             <'0', '1', '0x0303', ~tid, '0', 
                                                                              $cipher_suites, '0', 
                                                                              <'43', '0x0304'>, 
                                                                              <'10', $g1, $g>, 
                                                                              <'40', $g1, $g1^~x>, 
                                                                              <'45', '0', '1'>, <'42', '0'>, 
                                                                              '41', 
                                                                              <p_psk_id, 
                                                                               mask(ticket_age_add,
                                                                                    $ticket_age)
                                                                              >, 
                                                                              hmac(<
                                                                                    Expand(Expand(Extract(Expand(ms,
                                                                                                                 <
                                                                                                                  'rms', 
                                                                                                                  h(messages)
                                                                                                                 >,
                                                                                                                 '32'),
                                                                                                          '0'),
                                                                                                  <'res', 
                                                                                                   'pbk'>,
                                                                                                  '32'),
                                                                                           <'0', '0'>, '32'), 
                                                                                    h(<'0', '1', '0x0303', 
                                                                                       ~tid, '0', 
                                                                                       $cipher_suites, '0', 
                                                                                       <'43', '0x0304'>, 
                                                                                       <'10', $g1, $g>, 
                                                                                       <'40', $g1, $g1^~x>, 
                                                                                       <'45', '0', '1'>, 
                                                                                       <'42', '0'>, '41', 
                                                                                       <p_psk_id, 
                                                                                        mask(ticket_age_add,
                                                                                             $ticket_age)
                                                                                       >, 
                                                                                       '0'>)
                                                                                   >)
                                                                             >, 
                                                                             '6', '0x0303', '40', $g>, 
                                                                            '1', '0x0303', ~tid, '0', 
                                                                            $cipher_suites.1, '0', 
                                                                            <'43', '0x0304'>, 
                                                                            <'10', $g1, $g>, 
                                                                            <'13', $sig_algs>, '40', $g, 
                                                                            $g^~x.1>, 
                                                                           '2', '0x0303', p_ns, 
                                                                           $cipher_suite, 
                                                                           <'13', $sig_algs.1>, '40', $g, p_gy
                                                                          >, 
                                                                          '8', $exts>, 
                                                                         '11', '0', pk(~ltkS)>)
                                                                     >,
                                                                     ~ltkS)
                                                               >)
                                                            >,
                                                            '32'),
                                                     <'fin', '0'>, '32'), 
                                              h(<
                                                 <
                                                  <
                                                   <
                                                    <
                                                     <
                                                      <'0', '1', '0x0303', ~tid, '0', $cipher_suites, '0', 
                                                       <'43', '0x0304'>, <'10', $g1, $g>, 
                                                       <'40', $g1, $g1^~x>, <'45', '0', '1'>, <'42', '0'>, 
                                                       '41', <p_psk_id, mask(ticket_age_add, $ticket_age)>, 
                                                       hmac(<
                                                             Expand(Expand(Extract(Expand(ms,
                                                                                          <'rms', h(messages)
                                                                                          >,
                                                                                          '32'),
                                                                                   '0'),
                                                                           <'res', 'pbk'>, '32'),
                                                                    <'0', '0'>, '32'), 
                                                             h(<'0', '1', '0x0303', ~tid, '0', 
                                                                $cipher_suites, '0', <'43', '0x0304'>, 
                                                                <'10', $g1, $g>, <'40', $g1, $g1^~x>, 
                                                                <'45', '0', '1'>, <'42', '0'>, '41', 
                                                                <p_psk_id, mask(ticket_age_add, $ticket_age)
                                                                >, 
                                                                '0'>)
                                                            >)
                                                      >, 
                                                      '6', '0x0303', '40', $g>, 
                                                     '1', '0x0303', ~tid, '0', $cipher_suites.1, '0', 
                                                     <'43', '0x0304'>, <'10', $g1, $g>, <'13', $sig_algs>, 
                                                     '40', $g, $g^~x.1>, 
                                                    '2', '0x0303', p_ns, $cipher_suite, <'13', $sig_algs.1>, 
                                                    '40', $g, p_gy>, 
                                                   '8', $exts>, 
                                                  '11', '0', pk(~ltkS)>, 
                                                 '15', 
                                                 sign(<'server_cv', 
                                                       h(<
                                                          <
                                                           <
                                                            <
                                                             <
                                                              <'0', '1', '0x0303', ~tid, '0', $cipher_suites, 
                                                               '0', <'43', '0x0304'>, <'10', $g1, $g>, 
                                                               <'40', $g1, $g1^~x>, <'45', '0', '1'>, 
                                                               <'42', '0'>, '41', 
                                                               <p_psk_id, mask(ticket_age_add, $ticket_age)>, 
                                                               hmac(<
                                                                     Expand(Expand(Extract(Expand(ms,
                                                                                                  <'rms', 
                                                                                                   h(messages)
                                                                                                  >,
                                                                                                  '32'),
                                                                                           '0'),
                                                                                   <'res', 'pbk'>, '32'),
                                                                            <'0', '0'>, '32'), 
                                                                     h(<'0', '1', '0x0303', ~tid, '0', 
                                                                        $cipher_suites, '0', 
                                                                        <'43', '0x0304'>, <'10', $g1, $g>, 
                                                                        <'40', $g1, $g1^~x>, 
                                                                        <'45', '0', '1'>, <'42', '0'>, '41', 
                                                                        <p_psk_id, 
                                                                         mask(ticket_age_add, $ticket_age)>, 
                                                                        '0'>)
                                                                    >)
                                                              >, 
                                                              '6', '0x0303', '40', $g>, 
                                                             '1', '0x0303', ~tid, '0', $cipher_suites.1, '0', 
                                                             <'43', '0x0304'>, <'10', $g1, $g>, 
                                                             <'13', $sig_algs>, '40', $g, $g^~x.1>, 
                                                            '2', '0x0303', p_ns, $cipher_suite, 
                                                            <'13', $sig_algs.1>, '40', $g, p_gy>, 
                                                           '8', $exts>, 
                                                          '11', '0', pk(~ltkS)>)
                                                      >,
                                                      ~ltkS)
                                                >)
                                             >)
                                       >)
                                    >,
                                    '32')
                  ) ▶₀ #l )
      qed
    next
      case recv_server_auth_case_05
      solve( (∃ #j.2.
               (!KU( Extract('0', Extract(p_gxy, Extract(~res_psk, '0'))) ) @ #j.2)
              ∧
               #j.2 < #j.1)  ∥
             ((∀ #k.
                (!KU( Extract('0', Extract(p_gxy, Extract(~res_psk, '0'))) ) @ #k)
               ⇒
                ¬(#k < #j.1)) ∧
              (∃ actor #l.
                (RevealPSK( actor,
                            Expand(Extract('0', Extract(p_gxy, Extract(~res_psk, '0'))),
                                   <'serverats', 
                                    h(<
                                       <
                                        <
                                         <
                                          <
                                           <'0', '1', '0x0303', ~tid, '0', $cipher_suites, '0', 
                                            <'43', '0x0304'>, <'10', $g, $g2>, <'40', $g, $g^~x>, 
                                            <'45', '0', '1'>, <'42', '0'>, '41', 
                                            <~ticket, mask(~ticket_age_add, $ticket_age)>, 
                                            hmac(<
                                                  Expand(Expand(Extract(~res_psk, '0'), <'ext', 'pbk'>, '32'),
                                                         <'0', '0'>, '32'), 
                                                  h(<'0', '1', '0x0303', ~tid, '0', $cipher_suites, '0', 
                                                     <'43', '0x0304'>, <'10', $g, $g2>, <'40', $g, $g^~x>, 
                                                     <'45', '0', '1'>, <'42', '0'>, '41', 
                                                     <~ticket, mask(~ticket_age_add, $ticket_age)>, '0'>)
                                                 >)
                                           >, 
                                           '2', '0x0303', p_ns, $cipher_suite, <'13', $sig_algs>, '40', $g, 
                                           p_gy>, 
                                          '8', $exts>, 
                                         '11', '0', pk(~ltkS)>, 
                                        '15', 
                                        sign(<'server_cv', 
                                              h(<
                                                 <
                                                  <
                                                   <'0', '1', '0x0303', ~tid, '0', $cipher_suites, '0', 
                                                    <'43', '0x0304'>, <'10', $g, $g2>, <'40', $g, $g^~x>, 
                                                    <'45', '0', '1'>, <'42', '0'>, '41', 
                                                    <~ticket, mask(~ticket_age_add, $ticket_age)>, 
                                                    hmac(<
                                                          Expand(Expand(Extract(~res_psk, '0'),
                                                                        <'ext', 'pbk'>, '32'),
                                                                 <'0', '0'>, '32'), 
                                                          h(<'0', '1', '0x0303', ~tid, '0', $cipher_suites, 
                                                             '0', <'43', '0x0304'>, <'10', $g, $g2>, 
                                                             <'40', $g, $g^~x>, <'45', '0', '1'>, 
                                                             <'42', '0'>, '41', 
                                                             <~ticket, mask(~ticket_age_add, $ticket_age)>, 
                                                             '0'>)
                                                         >)
                                                   >, 
                                                   '2', '0x0303', p_ns, $cipher_suite, <'13', $sig_algs>, 
                                                   '40', $g, p_gy>, 
                                                  '8', $exts>, 
                                                 '11', '0', pk(~ltkS)>)
                                             >,
                                             ~ltkS)
                                       >, 
                                       '20', 
                                       hmac(<
                                             Expand(Expand(Extract(p_gxy, Extract(~res_psk, '0')),
                                                           <'serverhts', 
                                                            h(<
                                                               <
                                                                <
                                                                 <
                                                                  <'0', '1', '0x0303', ~tid, '0', 
                                                                   $cipher_suites, '0', <'43', '0x0304'>, 
                                                                   <'10', $g, $g2>, <'40', $g, $g^~x>, 
                                                                   <'45', '0', '1'>, <'42', '0'>, '41', 
                                                                   <~ticket, 
                                                                    mask(~ticket_age_add, $ticket_age)>, 
                                                                   hmac(<
                                                                         Expand(Expand(Extract(~res_psk, '0'),
                                                                                       <'ext', 'pbk'>, '32'),
                                                                                <'0', '0'>, '32'), 
                                                                         h(<'0', '1', '0x0303', ~tid, '0', 
                                                                            $cipher_suites, '0', 
                                                                            <'43', '0x0304'>, 
                                                                            <'10', $g, $g2>, 
                                                                            <'40', $g, $g^~x>, 
                                                                            <'45', '0', '1'>, <'42', '0'>, 
                                                                            '41', 
                                                                            <~ticket, 
                                                                             mask(~ticket_age_add,
                                                                                  $ticket_age)
                                                                            >, 
                                                                            '0'>)
                                                                        >)
                                                                  >, 
                                                                  '2', '0x0303', p_ns, $cipher_suite, 
                                                                  <'13', $sig_algs>, '40', $g, p_gy>, 
                                                                 '8', $exts>, 
                                                                '11', '0', pk(~ltkS)>, 
                                                               '15', 
                                                               sign(<'server_cv', 
                                                                     h(<
                                                                        <
                                                                         <
                                                                          <'0', '1', '0x0303', ~tid, '0', 
                                                                           $cipher_suites, '0', 
                                                                           <'43', '0x0304'>, <'10', $g, $g2>, 
                                                                           <'40', $g, $g^~x>, 
                                                                           <'45', '0', '1'>, <'42', '0'>, 
                                                                           '41', 
                                                                           <~ticket, 
                                                                            mask(~ticket_age_add, $ticket_age)
                                                                           >, 
                                                                           hmac(<
                                                                                 Expand(Expand(Extract(~res_psk,
                                                                                                       '0'),
                                                                                               <'ext', 'pbk'>,
                                                                                               '32'),
                                                                                        <'0', '0'>, '32'), 
                                                                                 h(<'0', '1', '0x0303', ~tid, 
                                                                                    '0', $cipher_suites, '0', 
                                                                                    <'43', '0x0304'>, 
                                                                                    <'10', $g, $g2>, 
                                                                                    <'40', $g, $g^~x>, 
                                                                                    <'45', '0', '1'>, 
                                                                                    <'42', '0'>, '41', 
                                                                                    <~ticket, 
                                                                                     mask(~ticket_age_add,
                                                                                          $ticket_age)
                                                                                    >, 
                                                                                    '0'>)
                                                                                >)
                                                                          >, 
                                                                          '2', '0x0303', p_ns, $cipher_suite, 
                                                                          <'13', $sig_algs>, '40', $g, p_gy>, 
                                                                         '8', $exts>, 
                                                                        '11', '0', pk(~ltkS)>)
                                                                    >,
                                                                    ~ltkS)
                                                              >)
                                                           >,
                                                           '32'),
                                                    <'fin', '0'>, '32'), 
                                             h(<
                                                <
                                                 <
                                                  <
                                                   <'0', '1', '0x0303', ~tid, '0', $cipher_suites, '0', 
                                                    <'43', '0x0304'>, <'10', $g, $g2>, <'40', $g, $g^~x>, 
                                                    <'45', '0', '1'>, <'42', '0'>, '41', 
                                                    <~ticket, mask(~ticket_age_add, $ticket_age)>, 
                                                    hmac(<
                                                          Expand(Expand(Extract(~res_psk, '0'),
                                                                        <'ext', 'pbk'>, '32'),
                                                                 <'0', '0'>, '32'), 
                                                          h(<'0', '1', '0x0303', ~tid, '0', $cipher_suites, 
                                                             '0', <'43', '0x0304'>, <'10', $g, $g2>, 
                                                             <'40', $g, $g^~x>, <'45', '0', '1'>, 
                                                             <'42', '0'>, '41', 
                                                             <~ticket, mask(~ticket_age_add, $ticket_age)>, 
                                                             '0'>)
                                                         >)
                                                   >, 
                                                   '2', '0x0303', p_ns, $cipher_suite, <'13', $sig_algs>, 
                                                   '40', $g, p_gy>, 
                                                  '8', $exts>, 
                                                 '11', '0', pk(~ltkS)>, 
                                                '15', 
                                                sign(<'server_cv', 
                                                      h(<
                                                         <
                                                          <
                                                           <'0', '1', '0x0303', ~tid, '0', $cipher_suites, 
                                                            '0', <'43', '0x0304'>, <'10', $g, $g2>, 
                                                            <'40', $g, $g^~x>, <'45', '0', '1'>, <'42', '0'>, 
                                                            '41', 
                                                            <~ticket, mask(~ticket_age_add, $ticket_age)>, 
                                                            hmac(<
                                                                  Expand(Expand(Extract(~res_psk, '0'),
                                                                                <'ext', 'pbk'>, '32'),
                                                                         <'0', '0'>, '32'), 
                                                                  h(<'0', '1', '0x0303', ~tid, '0', 
                                                                     $cipher_suites, '0', <'43', '0x0304'>, 
                                                                     <'10', $g, $g2>, <'40', $g, $g^~x>, 
                                                                     <'45', '0', '1'>, <'42', '0'>, '41', 
                                                                     <~ticket, 
                                                                      mask(~ticket_age_add, $ticket_age)>, 
                                                                     '0'>)
                                                                 >)
                                                           >, 
                                                           '2', '0x0303', p_ns, $cipher_suite, 
                                                           <'13', $sig_algs>, '40', $g, p_gy>, 
                                                          '8', $exts>, 
                                                         '11', '0', pk(~ltkS)>)
                                                     >,
                                                     ~ltkS)
                                               >)
                                            >)
                                      >)
                                   >,
                                   '32')
                 ) @ #l)
               ∧
                #l < #j.1)) )
        case case_1
        solve( (∃ #r. (RevLtk( $S ) @ #r) ∧ #r < #vr)  ∥
               (∃ tid3 x #r. (RevDHExp( tid3, $S, x ) @ #r) ∧ #r < #vr)  ∥
               (∃ tid4 y #r. (RevDHExp( tid4, $C, y ) @ #r) ∧ #r < #vr)  ∥
               (∃ rms #r. (RevealPSK( $C, rms ) @ #r) ∧ #r < #k.1)  ∥
               (∃ rms #r. (RevealPSK( $S, rms ) @ #r) ∧ #r < #k.1) )
          case case_1
          by contradiction /* from formulas */
        next
          case case_2
          by contradiction /* from formulas */
        next
          case case_3
          by contradiction /* from formulas */
        next
          case case_4
          by contradiction /* from formulas */
        next
          case case_5
          by contradiction /* from formulas */
        qed
      next
        case case_2
        by solve( SecretPSK( $A,
                             Expand(Extract('0', Extract(p_gxy, Extract(~res_psk, '0'))),
                                    <'serverats', 
                                     h(<
                                        <
                                         <
                                          <
                                           <
                                            <'0', '1', '0x0303', ~tid, '0', $cipher_suites, '0', 
                                             <'43', '0x0304'>, <'10', $g, $g2>, <'40', $g, $g^~x>, 
                                             <'45', '0', '1'>, <'42', '0'>, '41', 
                                             <~ticket, mask(~ticket_age_add, $ticket_age)>, 
                                             hmac(<
                                                   Expand(Expand(Extract(~res_psk, '0'), <'ext', 'pbk'>,
                                                                 '32'),
                                                          <'0', '0'>, '32'), 
                                                   h(<'0', '1', '0x0303', ~tid, '0', $cipher_suites, '0', 
                                                      <'43', '0x0304'>, <'10', $g, $g2>, <'40', $g, $g^~x>, 
                                                      <'45', '0', '1'>, <'42', '0'>, '41', 
                                                      <~ticket, mask(~ticket_age_add, $ticket_age)>, '0'>)
                                                  >)
                                            >, 
                                            '2', '0x0303', p_ns, $cipher_suite, <'13', $sig_algs>, '40', $g, 
                                            p_gy>, 
                                           '8', $exts>, 
                                          '11', '0', pk(~ltkS)>, 
                                         '15', 
                                         sign(<'server_cv', 
                                               h(<
                                                  <
                                                   <
                                                    <'0', '1', '0x0303', ~tid, '0', $cipher_suites, '0', 
                                                     <'43', '0x0304'>, <'10', $g, $g2>, <'40', $g, $g^~x>, 
                                                     <'45', '0', '1'>, <'42', '0'>, '41', 
                                                     <~ticket, mask(~ticket_age_add, $ticket_age)>, 
                                                     hmac(<
                                                           Expand(Expand(Extract(~res_psk, '0'),
                                                                         <'ext', 'pbk'>, '32'),
                                                                  <'0', '0'>, '32'), 
                                                           h(<'0', '1', '0x0303', ~tid, '0', $cipher_suites, 
                                                              '0', <'43', '0x0304'>, <'10', $g, $g2>, 
                                                              <'40', $g, $g^~x>, <'45', '0', '1'>, 
                                                              <'42', '0'>, '41', 
                                                              <~ticket, mask(~ticket_age_add, $ticket_age)>, 
                                                              '0'>)
                                                          >)
                                                    >, 
                                                    '2', '0x0303', p_ns, $cipher_suite, <'13', $sig_algs>, 
                                                    '40', $g, p_gy>, 
                                                   '8', $exts>, 
                                                  '11', '0', pk(~ltkS)>)
                                              >,
                                              ~ltkS)
                                        >, 
                                        '20', 
                                        hmac(<
                                              Expand(Expand(Extract(p_gxy, Extract(~res_psk, '0')),
                                                            <'serverhts', 
                                                             h(<
                                                                <
                                                                 <
                                                                  <
                                                                   <'0', '1', '0x0303', ~tid, '0', 
                                                                    $cipher_suites, '0', <'43', '0x0304'>, 
                                                                    <'10', $g, $g2>, <'40', $g, $g^~x>, 
                                                                    <'45', '0', '1'>, <'42', '0'>, '41', 
                                                                    <~ticket, 
                                                                     mask(~ticket_age_add, $ticket_age)>, 
                                                                    hmac(<
                                                                          Expand(Expand(Extract(~res_psk,
                                                                                                '0'),
                                                                                        <'ext', 'pbk'>, '32'),
                                                                                 <'0', '0'>, '32'), 
                                                                          h(<'0', '1', '0x0303', ~tid, '0', 
                                                                             $cipher_suites, '0', 
                                                                             <'43', '0x0304'>, 
                                                                             <'10', $g, $g2>, 
                                                                             <'40', $g, $g^~x>, 
                                                                             <'45', '0', '1'>, <'42', '0'>, 
                                                                             '41', 
                                                                             <~ticket, 
                                                                              mask(~ticket_age_add,
                                                                                   $ticket_age)
                                                                             >, 
                                                                             '0'>)
                                                                         >)
                                                                   >, 
                                                                   '2', '0x0303', p_ns, $cipher_suite, 
                                                                   <'13', $sig_algs>, '40', $g, p_gy>, 
                                                                  '8', $exts>, 
                                                                 '11', '0', pk(~ltkS)>, 
                                                                '15', 
                                                                sign(<'server_cv', 
                                                                      h(<
                                                                         <
                                                                          <
                                                                           <'0', '1', '0x0303', ~tid, '0', 
                                                                            $cipher_suites, '0', 
                                                                            <'43', '0x0304'>, 
                                                                            <'10', $g, $g2>, 
                                                                            <'40', $g, $g^~x>, 
                                                                            <'45', '0', '1'>, <'42', '0'>, 
                                                                            '41', 
                                                                            <~ticket, 
                                                                             mask(~ticket_age_add,
                                                                                  $ticket_age)
                                                                            >, 
                                                                            hmac(<
                                                                                  Expand(Expand(Extract(~res_psk,
                                                                                                        '0'),
                                                                                                <'ext', 'pbk'
                                                                                                >,
                                                                                                '32'),
                                                                                         <'0', '0'>, '32'), 
                                                                                  h(<'0', '1', '0x0303', 
                                                                                     ~tid, '0', 
                                                                                     $cipher_suites, '0', 
                                                                                     <'43', '0x0304'>, 
                                                                                     <'10', $g, $g2>, 
                                                                                     <'40', $g, $g^~x>, 
                                                                                     <'45', '0', '1'>, 
                                                                                     <'42', '0'>, '41', 
                                                                                     <~ticket, 
                                                                                      mask(~ticket_age_add,
                                                                                           $ticket_age)
                                                                                     >, 
                                                                                     '0'>)
                                                                                 >)
                                                                           >, 
                                                                           '2', '0x0303', p_ns, 
                                                                           $cipher_suite, <'13', $sig_algs>, 
                                                                           '40', $g, p_gy>, 
                                                                          '8', $exts>, 
                                                                         '11', '0', pk(~ltkS)>)
                                                                     >,
                                                                     ~ltkS)
                                                               >)
                                                            >,
                                                            '32'),
                                                     <'fin', '0'>, '32'), 
                                              h(<
                                                 <
                                                  <
                                                   <
                                                    <'0', '1', '0x0303', ~tid, '0', $cipher_suites, '0', 
                                                     <'43', '0x0304'>, <'10', $g, $g2>, <'40', $g, $g^~x>, 
                                                     <'45', '0', '1'>, <'42', '0'>, '41', 
                                                     <~ticket, mask(~ticket_age_add, $ticket_age)>, 
                                                     hmac(<
                                                           Expand(Expand(Extract(~res_psk, '0'),
                                                                         <'ext', 'pbk'>, '32'),
                                                                  <'0', '0'>, '32'), 
                                                           h(<'0', '1', '0x0303', ~tid, '0', $cipher_suites, 
                                                              '0', <'43', '0x0304'>, <'10', $g, $g2>, 
                                                              <'40', $g, $g^~x>, <'45', '0', '1'>, 
                                                              <'42', '0'>, '41', 
                                                              <~ticket, mask(~ticket_age_add, $ticket_age)>, 
                                                              '0'>)
                                                          >)
                                                    >, 
                                                    '2', '0x0303', p_ns, $cipher_suite, <'13', $sig_algs>, 
                                                    '40', $g, p_gy>, 
                                                   '8', $exts>, 
                                                  '11', '0', pk(~ltkS)>, 
                                                 '15', 
                                                 sign(<'server_cv', 
                                                       h(<
                                                          <
                                                           <
                                                            <'0', '1', '0x0303', ~tid, '0', $cipher_suites, 
                                                             '0', <'43', '0x0304'>, <'10', $g, $g2>, 
                                                             <'40', $g, $g^~x>, <'45', '0', '1'>, 
                                                             <'42', '0'>, '41', 
                                                             <~ticket, mask(~ticket_age_add, $ticket_age)>, 
                                                             hmac(<
                                                                   Expand(Expand(Extract(~res_psk, '0'),
                                                                                 <'ext', 'pbk'>, '32'),
                                                                          <'0', '0'>, '32'), 
                                                                   h(<'0', '1', '0x0303', ~tid, '0', 
                                                                      $cipher_suites, '0', <'43', '0x0304'>, 
                                                                      <'10', $g, $g2>, <'40', $g, $g^~x>, 
                                                                      <'45', '0', '1'>, <'42', '0'>, '41', 
                                                                      <~ticket, 
                                                                       mask(~ticket_age_add, $ticket_age)>, 
                                                                      '0'>)
                                                                  >)
                                                            >, 
                                                            '2', '0x0303', p_ns, $cipher_suite, 
                                                            <'13', $sig_algs>, '40', $g, p_gy>, 
                                                           '8', $exts>, 
                                                          '11', '0', pk(~ltkS)>)
                                                      >,
                                                      ~ltkS)
                                                >)
                                             >)
                                       >)
                                    >,
                                    '32')
                  ) ▶₀ #l )
      qed
    next
      case recv_server_auth_case_06
      solve( (∃ #j.2.
               (!KU( Extract('0',
                             Extract(p_gxy, Extract(Expand(ms, <'rms', h(messages)>, '32'), '0')))
                ) @ #j.2)
              ∧
               #j.2 < #j.1)  ∥
             ((∀ #k.
                (!KU( Extract('0',
                              Extract(p_gxy, Extract(Expand(ms, <'rms', h(messages)>, '32'), '0')))
                 ) @ #k)
               ⇒
                ¬(#k < #j.1)) ∧
              (∃ actor #l.
                (RevealPSK( actor,
                            Expand(Extract('0',
                                           Extract(p_gxy,
                                                   Extract(Expand(ms, <'rms', h(messages)>, '32'), '0'))),
                                   <'serverats', 
                                    h(<
                                       <
                                        <
                                         <
                                          <
                                           <'0', '1', '0x0303', ~tid, '0', $cipher_suites, '0', 
                                            <'43', '0x0304'>, <'10', $g, $g2>, <'40', $g, $g^~x>, 
                                            <'45', '0', '1'>, <'42', '0'>, '41', 
                                            <p_psk_id, mask(ticket_age_add, $ticket_age)>, 
                                            hmac(<
                                                  Expand(Expand(Extract(Expand(ms, <'rms', h(messages)>,
                                                                               '32'),
                                                                        '0'),
                                                                <'res', 'pbk'>, '32'),
                                                         <'0', '0'>, '32'), 
                                                  h(<'0', '1', '0x0303', ~tid, '0', $cipher_suites, '0', 
                                                     <'43', '0x0304'>, <'10', $g, $g2>, <'40', $g, $g^~x>, 
                                                     <'45', '0', '1'>, <'42', '0'>, '41', 
                                                     <p_psk_id, mask(ticket_age_add, $ticket_age)>, '0'>)
                                                 >)
                                           >, 
                                           '2', '0x0303', p_ns, $cipher_suite, <'13', $sig_algs>, '40', $g, 
                                           p_gy>, 
                                          '8', $exts>, 
                                         '11', '0', pk(~ltkS)>, 
                                        '15', 
                                        sign(<'server_cv', 
                                              h(<
                                                 <
                                                  <
                                                   <'0', '1', '0x0303', ~tid, '0', $cipher_suites, '0', 
                                                    <'43', '0x0304'>, <'10', $g, $g2>, <'40', $g, $g^~x>, 
                                                    <'45', '0', '1'>, <'42', '0'>, '41', 
                                                    <p_psk_id, mask(ticket_age_add, $ticket_age)>, 
                                                    hmac(<
                                                          Expand(Expand(Extract(Expand(ms,
                                                                                       <'rms', h(messages)>,
                                                                                       '32'),
                                                                                '0'),
                                                                        <'res', 'pbk'>, '32'),
                                                                 <'0', '0'>, '32'), 
                                                          h(<'0', '1', '0x0303', ~tid, '0', $cipher_suites, 
                                                             '0', <'43', '0x0304'>, <'10', $g, $g2>, 
                                                             <'40', $g, $g^~x>, <'45', '0', '1'>, 
                                                             <'42', '0'>, '41', 
                                                             <p_psk_id, mask(ticket_age_add, $ticket_age)>, 
                                                             '0'>)
                                                         >)
                                                   >, 
                                                   '2', '0x0303', p_ns, $cipher_suite, <'13', $sig_algs>, 
                                                   '40', $g, p_gy>, 
                                                  '8', $exts>, 
                                                 '11', '0', pk(~ltkS)>)
                                             >,
                                             ~ltkS)
                                       >, 
                                       '20', 
                                       hmac(<
                                             Expand(Expand(Extract(p_gxy,
                                                                   Extract(Expand(ms, <'rms', h(messages)>,
                                                                                  '32'),
                                                                           '0')),
                                                           <'serverhts', 
                                                            h(<
                                                               <
                                                                <
                                                                 <
                                                                  <'0', '1', '0x0303', ~tid, '0', 
                                                                   $cipher_suites, '0', <'43', '0x0304'>, 
                                                                   <'10', $g, $g2>, <'40', $g, $g^~x>, 
                                                                   <'45', '0', '1'>, <'42', '0'>, '41', 
                                                                   <p_psk_id, 
                                                                    mask(ticket_age_add, $ticket_age)>, 
                                                                   hmac(<
                                                                         Expand(Expand(Extract(Expand(ms,
                                                                                                      <'rms', 
                                                                                                       h(messages)
                                                                                                      >,
                                                                                                      '32'),
                                                                                               '0'),
                                                                                       <'res', 'pbk'>, '32'),
                                                                                <'0', '0'>, '32'), 
                                                                         h(<'0', '1', '0x0303', ~tid, '0', 
                                                                            $cipher_suites, '0', 
                                                                            <'43', '0x0304'>, 
                                                                            <'10', $g, $g2>, 
                                                                            <'40', $g, $g^~x>, 
                                                                            <'45', '0', '1'>, <'42', '0'>, 
                                                                            '41', 
                                                                            <p_psk_id, 
                                                                             mask(ticket_age_add, $ticket_age)
                                                                            >, 
                                                                            '0'>)
                                                                        >)
                                                                  >, 
                                                                  '2', '0x0303', p_ns, $cipher_suite, 
                                                                  <'13', $sig_algs>, '40', $g, p_gy>, 
                                                                 '8', $exts>, 
                                                                '11', '0', pk(~ltkS)>, 
                                                               '15', 
                                                               sign(<'server_cv', 
                                                                     h(<
                                                                        <
                                                                         <
                                                                          <'0', '1', '0x0303', ~tid, '0', 
                                                                           $cipher_suites, '0', 
                                                                           <'43', '0x0304'>, <'10', $g, $g2>, 
                                                                           <'40', $g, $g^~x>, 
                                                                           <'45', '0', '1'>, <'42', '0'>, 
                                                                           '41', 
                                                                           <p_psk_id, 
                                                                            mask(ticket_age_add, $ticket_age)
                                                                           >, 
                                                                           hmac(<
                                                                                 Expand(Expand(Extract(Expand(ms,
                                                                                                              <
                                                                                                               'rms', 
                                                                                                               h(messages)
                                                                                                              >,
                                                                                                              '32'),
                                                                                                       '0'),
                                                                                               <'res', 'pbk'>,
                                                                                               '32'),
                                                                                        <'0', '0'>, '32'), 
                                                                                 h(<'0', '1', '0x0303', ~tid, 
                                                                                    '0', $cipher_suites, '0', 
                                                                                    <'43', '0x0304'>, 
                                                                                    <'10', $g, $g2>, 
                                                                                    <'40', $g, $g^~x>, 
                                                                                    <'45', '0', '1'>, 
                                                                                    <'42', '0'>, '41', 
                                                                                    <p_psk_id, 
                                                                                     mask(ticket_age_add,
                                                                                          $ticket_age)
                                                                                    >, 
                                                                                    '0'>)
                                                                                >)
                                                                          >, 
                                                                          '2', '0x0303', p_ns, $cipher_suite, 
                                                                          <'13', $sig_algs>, '40', $g, p_gy>, 
                                                                         '8', $exts>, 
                                                                        '11', '0', pk(~ltkS)>)
                                                                    >,
                                                                    ~ltkS)
                                                              >)
                                                           >,
                                                           '32'),
                                                    <'fin', '0'>, '32'), 
                                             h(<
                                                <
                                                 <
                                                  <
                                                   <'0', '1', '0x0303', ~tid, '0', $cipher_suites, '0', 
                                                    <'43', '0x0304'>, <'10', $g, $g2>, <'40', $g, $g^~x>, 
                                                    <'45', '0', '1'>, <'42', '0'>, '41', 
                                                    <p_psk_id, mask(ticket_age_add, $ticket_age)>, 
                                                    hmac(<
                                                          Expand(Expand(Extract(Expand(ms,
                                                                                       <'rms', h(messages)>,
                                                                                       '32'),
                                                                                '0'),
                                                                        <'res', 'pbk'>, '32'),
                                                                 <'0', '0'>, '32'), 
                                                          h(<'0', '1', '0x0303', ~tid, '0', $cipher_suites, 
                                                             '0', <'43', '0x0304'>, <'10', $g, $g2>, 
                                                             <'40', $g, $g^~x>, <'45', '0', '1'>, 
                                                             <'42', '0'>, '41', 
                                                             <p_psk_id, mask(ticket_age_add, $ticket_age)>, 
                                                             '0'>)
                                                         >)
                                                   >, 
                                                   '2', '0x0303', p_ns, $cipher_suite, <'13', $sig_algs>, 
                                                   '40', $g, p_gy>, 
                                                  '8', $exts>, 
                                                 '11', '0', pk(~ltkS)>, 
                                                '15', 
                                                sign(<'server_cv', 
                                                      h(<
                                                         <
                                                          <
                                                           <'0', '1', '0x0303', ~tid, '0', $cipher_suites, 
                                                            '0', <'43', '0x0304'>, <'10', $g, $g2>, 
                                                            <'40', $g, $g^~x>, <'45', '0', '1'>, <'42', '0'>, 
                                                            '41', 
                                                            <p_psk_id, mask(ticket_age_add, $ticket_age)>, 
                                                            hmac(<
                                                                  Expand(Expand(Extract(Expand(ms,
                                                                                               <'rms', 
                                                                                                h(messages)>,
                                                                                               '32'),
                                                                                        '0'),
                                                                                <'res', 'pbk'>, '32'),
                                                                         <'0', '0'>, '32'), 
                                                                  h(<'0', '1', '0x0303', ~tid, '0', 
                                                                     $cipher_suites, '0', <'43', '0x0304'>, 
                                                                     <'10', $g, $g2>, <'40', $g, $g^~x>, 
                                                                     <'45', '0', '1'>, <'42', '0'>, '41', 
                                                                     <p_psk_id, 
                                                                      mask(ticket_age_add, $ticket_age)>, 
                                                                     '0'>)
                                                                 >)
                                                           >, 
                                                           '2', '0x0303', p_ns, $cipher_suite, 
                                                           <'13', $sig_algs>, '40', $g, p_gy>, 
                                                          '8', $exts>, 
                                                         '11', '0', pk(~ltkS)>)
                                                     >,
                                                     ~ltkS)
                                               >)
                                            >)
                                      >)
                                   >,
                                   '32')
                 ) @ #l)
               ∧
                #l < #j.1)) )
        case case_1
        solve( (∃ #r. (RevLtk( $S ) @ #r) ∧ #r < #vr)  ∥
               (∃ tid3 x #r. (RevDHExp( tid3, $S, x ) @ #r) ∧ #r < #vr)  ∥
               (∃ tid4 y #r. (RevDHExp( tid4, $C, y ) @ #r) ∧ #r < #vr)  ∥
               (∃ rms #r. (RevealPSK( $C, rms ) @ #r) ∧ #r < #k.1)  ∥
               (∃ rms #r. (RevealPSK( $S, rms ) @ #r) ∧ #r < #k.1) )
          case case_1
          by contradiction /* from formulas */
        next
          case case_2
          by contradiction /* from formulas */
        next
          case case_3
          by contradiction /* from formulas */
        next
          case case_4
          by contradiction /* from formulas */
        next
          case case_5
          by contradiction /* from formulas */
        qed
      next
        case case_2
        by solve( SecretPSK( $A,
                             Expand(Extract('0',
                                            Extract(p_gxy,
                                                    Extract(Expand(ms, <'rms', h(messages)>, '32'), '0'))),
                                    <'serverats', 
                                     h(<
                                        <
                                         <
                                          <
                                           <
                                            <'0', '1', '0x0303', ~tid, '0', $cipher_suites, '0', 
                                             <'43', '0x0304'>, <'10', $g, $g2>, <'40', $g, $g^~x>, 
                                             <'45', '0', '1'>, <'42', '0'>, '41', 
                                             <p_psk_id, mask(ticket_age_add, $ticket_age)>, 
                                             hmac(<
                                                   Expand(Expand(Extract(Expand(ms, <'rms', h(messages)>,
                                                                                '32'),
                                                                         '0'),
                                                                 <'res', 'pbk'>, '32'),
                                                          <'0', '0'>, '32'), 
                                                   h(<'0', '1', '0x0303', ~tid, '0', $cipher_suites, '0', 
                                                      <'43', '0x0304'>, <'10', $g, $g2>, <'40', $g, $g^~x>, 
                                                      <'45', '0', '1'>, <'42', '0'>, '41', 
                                                      <p_psk_id, mask(ticket_age_add, $ticket_age)>, '0'>)
                                                  >)
                                            >, 
                                            '2', '0x0303', p_ns, $cipher_suite, <'13', $sig_algs>, '40', $g, 
                                            p_gy>, 
                                           '8', $exts>, 
                                          '11', '0', pk(~ltkS)>, 
                                         '15', 
                                         sign(<'server_cv', 
                                               h(<
                                                  <
                                                   <
                                                    <'0', '1', '0x0303', ~tid, '0', $cipher_suites, '0', 
                                                     <'43', '0x0304'>, <'10', $g, $g2>, <'40', $g, $g^~x>, 
                                                     <'45', '0', '1'>, <'42', '0'>, '41', 
                                                     <p_psk_id, mask(ticket_age_add, $ticket_age)>, 
                                                     hmac(<
                                                           Expand(Expand(Extract(Expand(ms,
                                                                                        <'rms', h(messages)>,
                                                                                        '32'),
                                                                                 '0'),
                                                                         <'res', 'pbk'>, '32'),
                                                                  <'0', '0'>, '32'), 
                                                           h(<'0', '1', '0x0303', ~tid, '0', $cipher_suites, 
                                                              '0', <'43', '0x0304'>, <'10', $g, $g2>, 
                                                              <'40', $g, $g^~x>, <'45', '0', '1'>, 
                                                              <'42', '0'>, '41', 
                                                              <p_psk_id, mask(ticket_age_add, $ticket_age)>, 
                                                              '0'>)
                                                          >)
                                                    >, 
                                                    '2', '0x0303', p_ns, $cipher_suite, <'13', $sig_algs>, 
                                                    '40', $g, p_gy>, 
                                                   '8', $exts>, 
                                                  '11', '0', pk(~ltkS)>)
                                              >,
                                              ~ltkS)
                                        >, 
                                        '20', 
                                        hmac(<
                                              Expand(Expand(Extract(p_gxy,
                                                                    Extract(Expand(ms, <'rms', h(messages)>,
                                                                                   '32'),
                                                                            '0')),
                                                            <'serverhts', 
                                                             h(<
                                                                <
                                                                 <
                                                                  <
                                                                   <'0', '1', '0x0303', ~tid, '0', 
                                                                    $cipher_suites, '0', <'43', '0x0304'>, 
                                                                    <'10', $g, $g2>, <'40', $g, $g^~x>, 
                                                                    <'45', '0', '1'>, <'42', '0'>, '41', 
                                                                    <p_psk_id, 
                                                                     mask(ticket_age_add, $ticket_age)>, 
                                                                    hmac(<
                                                                          Expand(Expand(Extract(Expand(ms,
                                                                                                       <
                                                                                                        'rms', 
                                                                                                        h(messages)
                                                                                                       >,
                                                                                                       '32'),
                                                                                                '0'),
                                                                                        <'res', 'pbk'>, '32'),
                                                                                 <'0', '0'>, '32'), 
                                                                          h(<'0', '1', '0x0303', ~tid, '0', 
                                                                             $cipher_suites, '0', 
                                                                             <'43', '0x0304'>, 
                                                                             <'10', $g, $g2>, 
                                                                             <'40', $g, $g^~x>, 
                                                                             <'45', '0', '1'>, <'42', '0'>, 
                                                                             '41', 
                                                                             <p_psk_id, 
                                                                              mask(ticket_age_add,
                                                                                   $ticket_age)
                                                                             >, 
                                                                             '0'>)
                                                                         >)
                                                                   >, 
                                                                   '2', '0x0303', p_ns, $cipher_suite, 
                                                                   <'13', $sig_algs>, '40', $g, p_gy>, 
                                                                  '8', $exts>, 
                                                                 '11', '0', pk(~ltkS)>, 
                                                                '15', 
                                                                sign(<'server_cv', 
                                                                      h(<
                                                                         <
                                                                          <
                                                                           <'0', '1', '0x0303', ~tid, '0', 
                                                                            $cipher_suites, '0', 
                                                                            <'43', '0x0304'>, 
                                                                            <'10', $g, $g2>, 
                                                                            <'40', $g, $g^~x>, 
                                                                            <'45', '0', '1'>, <'42', '0'>, 
                                                                            '41', 
                                                                            <p_psk_id, 
                                                                             mask(ticket_age_add, $ticket_age)
                                                                            >, 
                                                                            hmac(<
                                                                                  Expand(Expand(Extract(Expand(ms,
                                                                                                               <
                                                                                                                'rms', 
                                                                                                                h(messages)
                                                                                                               >,
                                                                                                               '32'),
                                                                                                        '0'),
                                                                                                <'res', 'pbk'
                                                                                                >,
                                                                                                '32'),
                                                                                         <'0', '0'>, '32'), 
                                                                                  h(<'0', '1', '0x0303', 
                                                                                     ~tid, '0', 
                                                                                     $cipher_suites, '0', 
                                                                                     <'43', '0x0304'>, 
                                                                                     <'10', $g, $g2>, 
                                                                                     <'40', $g, $g^~x>, 
                                                                                     <'45', '0', '1'>, 
                                                                                     <'42', '0'>, '41', 
                                                                                     <p_psk_id, 
                                                                                      mask(ticket_age_add,
                                                                                           $ticket_age)
                                                                                     >, 
                                                                                     '0'>)
                                                                                 >)
                                                                           >, 
                                                                           '2', '0x0303', p_ns, 
                                                                           $cipher_suite, <'13', $sig_algs>, 
                                                                           '40', $g, p_gy>, 
                                                                          '8', $exts>, 
                                                                         '11', '0', pk(~ltkS)>)
                                                                     >,
                                                                     ~ltkS)
                                                               >)
                                                            >,
                                                            '32'),
                                                     <'fin', '0'>, '32'), 
                                              h(<
                                                 <
                                                  <
                                                   <
                                                    <'0', '1', '0x0303', ~tid, '0', $cipher_suites, '0', 
                                                     <'43', '0x0304'>, <'10', $g, $g2>, <'40', $g, $g^~x>, 
                                                     <'45', '0', '1'>, <'42', '0'>, '41', 
                                                     <p_psk_id, mask(ticket_age_add, $ticket_age)>, 
                                                     hmac(<
                                                           Expand(Expand(Extract(Expand(ms,
                                                                                        <'rms', h(messages)>,
                                                                                        '32'),
                                                                                 '0'),
                                                                         <'res', 'pbk'>, '32'),
                                                                  <'0', '0'>, '32'), 
                                                           h(<'0', '1', '0x0303', ~tid, '0', $cipher_suites, 
                                                              '0', <'43', '0x0304'>, <'10', $g, $g2>, 
                                                              <'40', $g, $g^~x>, <'45', '0', '1'>, 
                                                              <'42', '0'>, '41', 
                                                              <p_psk_id, mask(ticket_age_add, $ticket_age)>, 
                                                              '0'>)
                                                          >)
                                                    >, 
                                                    '2', '0x0303', p_ns, $cipher_suite, <'13', $sig_algs>, 
                                                    '40', $g, p_gy>, 
                                                   '8', $exts>, 
                                                  '11', '0', pk(~ltkS)>, 
                                                 '15', 
                                                 sign(<'server_cv', 
                                                       h(<
                                                          <
                                                           <
                                                            <'0', '1', '0x0303', ~tid, '0', $cipher_suites, 
                                                             '0', <'43', '0x0304'>, <'10', $g, $g2>, 
                                                             <'40', $g, $g^~x>, <'45', '0', '1'>, 
                                                             <'42', '0'>, '41', 
                                                             <p_psk_id, mask(ticket_age_add, $ticket_age)>, 
                                                             hmac(<
                                                                   Expand(Expand(Extract(Expand(ms,
                                                                                                <'rms', 
                                                                                                 h(messages)>,
                                                                                                '32'),
                                                                                         '0'),
                                                                                 <'res', 'pbk'>, '32'),
                                                                          <'0', '0'>, '32'), 
                                                                   h(<'0', '1', '0x0303', ~tid, '0', 
                                                                      $cipher_suites, '0', <'43', '0x0304'>, 
                                                                      <'10', $g, $g2>, <'40', $g, $g^~x>, 
                                                                      <'45', '0', '1'>, <'42', '0'>, '41', 
                                                                      <p_psk_id, 
                                                                       mask(ticket_age_add, $ticket_age)>, 
                                                                      '0'>)
                                                                  >)
                                                            >, 
                                                            '2', '0x0303', p_ns, $cipher_suite, 
                                                            <'13', $sig_algs>, '40', $g, p_gy>, 
                                                           '8', $exts>, 
                                                          '11', '0', pk(~ltkS)>)
                                                      >,
                                                      ~ltkS)
                                                >)
                                             >)
                                       >)
                                    >,
                                    '32')
                  ) ▶₀ #l )
      qed
    next
      case recv_server_auth_case_07
      solve( (∃ #j.2.
               (!KU( Extract('0', Extract(p_gxy, Extract(~res_psk, '0'))) ) @ #j.2)
              ∧
               #j.2 < #j.1)  ∥
             ((∀ #k.
                (!KU( Extract('0', Extract(p_gxy, Extract(~res_psk, '0'))) ) @ #k)
               ⇒
                ¬(#k < #j.1)) ∧
              (∃ actor #l.
                (RevealPSK( actor,
                            Expand(Extract('0', Extract(p_gxy, Extract(~res_psk, '0'))),
                                   <'serverats', 
                                    h(<
                                       <
                                        <
                                         <
                                          <
                                           <
                                            <
                                             <'0', '1', '0x0303', ~tid, '0', $cipher_suites, '0', 
                                              <'43', '0x0304'>, <'10', $g1, $g>, <'40', $g1, $g1^~x>, 
                                              <'45', '0', '1'>, <'42', '0'>, '41', 
                                              <~ticket, mask(~ticket_age_add, $ticket_age)>, 
                                              hmac(<
                                                    Expand(Expand(Extract(~res_psk, '0'), <'ext', 'pbk'>,
                                                                  '32'),
                                                           <'0', '0'>, '32'), 
                                                    h(<'0', '1', '0x0303', ~tid, '0', $cipher_suites, '0', 
                                                       <'43', '0x0304'>, <'10', $g1, $g>, 
                                                       <'40', $g1, $g1^~x>, <'45', '0', '1'>, <'42', '0'>, 
                                                       '41', <~ticket, mask(~ticket_age_add, $ticket_age)>, 
                                                       '0'>)
                                                   >)
                                             >, 
                                             '6', '0x0303', '40', $g>, 
                                            '1', '0x0303', ~new_nc, '0', $cipher_suites.1, '0', 
                                            <'43', '0x0304'>, <'10', $g1, $g>, <'40', $g, $g^~x.1>, 
                                            <'45', '0', '1'>, '0', '41', 
                                            <~ticket, mask(~ticket_age_add, '1')>, 
                                            hmac(<
                                                  Expand(Expand(Extract(~res_psk, '0'), <'ext', 'pbk'>, '32'),
                                                         <'0', '0'>, '32'), 
                                                  h(<
                                                     <
                                                      <'0', '1', '0x0303', ~tid, '0', $cipher_suites, '0', 
                                                       <'43', '0x0304'>, <'10', $g1, $g>, 
                                                       <'40', $g1, $g1^~x>, <'45', '0', '1'>, <'42', '0'>, 
                                                       '41', <~ticket, mask(~ticket_age_add, $ticket_age)>, 
                                                       hmac(<
                                                             Expand(Expand(Extract(~res_psk, '0'),
                                                                           <'ext', 'pbk'>, '32'),
                                                                    <'0', '0'>, '32'), 
                                                             h(<'0', '1', '0x0303', ~tid, '0', 
                                                                $cipher_suites, '0', <'43', '0x0304'>, 
                                                                <'10', $g1, $g>, <'40', $g1, $g1^~x>, 
                                                                <'45', '0', '1'>, <'42', '0'>, '41', 
                                                                <~ticket, mask(~ticket_age_add, $ticket_age)
                                                                >, 
                                                                '0'>)
                                                            >)
                                                      >, 
                                                      '6', '0x0303', '40', $g>, 
                                                     '1', '0x0303', ~new_nc, '0', $cipher_suites.1, '0', 
                                                     <'43', '0x0304'>, <'10', $g1, $g>, <'40', $g, $g^~x.1>, 
                                                     <'45', '0', '1'>, '0', '41', 
                                                     <~ticket, mask(~ticket_age_add, '1')>, '0'>)
                                                 >)
                                           >, 
                                           '2', '0x0303', p_ns, $cipher_suite, <'13', $sig_algs>, '40', $g, 
                                           p_gy>, 
                                          '8', $exts>, 
                                         '11', '0', pk(~ltkS)>, 
                                        '15', 
                                        sign(<'server_cv', 
                                              h(<
                                                 <
                                                  <
                                                   <
                                                    <
                                                     <'0', '1', '0x0303', ~tid, '0', $cipher_suites, '0', 
                                                      <'43', '0x0304'>, <'10', $g1, $g>, <'40', $g1, $g1^~x>, 
                                                      <'45', '0', '1'>, <'42', '0'>, '41', 
                                                      <~ticket, mask(~ticket_age_add, $ticket_age)>, 
                                                      hmac(<
                                                            Expand(Expand(Extract(~res_psk, '0'),
                                                                          <'ext', 'pbk'>, '32'),
                                                                   <'0', '0'>, '32'), 
                                                            h(<'0', '1', '0x0303', ~tid, '0', $cipher_suites, 
                                                               '0', <'43', '0x0304'>, <'10', $g1, $g>, 
                                                               <'40', $g1, $g1^~x>, <'45', '0', '1'>, 
                                                               <'42', '0'>, '41', 
                                                               <~ticket, mask(~ticket_age_add, $ticket_age)>, 
                                                               '0'>)
                                                           >)
                                                     >, 
                                                     '6', '0x0303', '40', $g>, 
                                                    '1', '0x0303', ~new_nc, '0', $cipher_suites.1, '0', 
                                                    <'43', '0x0304'>, <'10', $g1, $g>, <'40', $g, $g^~x.1>, 
                                                    <'45', '0', '1'>, '0', '41', 
                                                    <~ticket, mask(~ticket_age_add, '1')>, 
                                                    hmac(<
                                                          Expand(Expand(Extract(~res_psk, '0'),
                                                                        <'ext', 'pbk'>, '32'),
                                                                 <'0', '0'>, '32'), 
                                                          h(<
                                                             <
                                                              <'0', '1', '0x0303', ~tid, '0', $cipher_suites, 
                                                               '0', <'43', '0x0304'>, <'10', $g1, $g>, 
                                                               <'40', $g1, $g1^~x>, <'45', '0', '1'>, 
                                                               <'42', '0'>, '41', 
                                                               <~ticket, mask(~ticket_age_add, $ticket_age)>, 
                                                               hmac(<
                                                                     Expand(Expand(Extract(~res_psk, '0'),
                                                                                   <'ext', 'pbk'>, '32'),
                                                                            <'0', '0'>, '32'), 
                                                                     h(<'0', '1', '0x0303', ~tid, '0', 
                                                                        $cipher_suites, '0', 
                                                                        <'43', '0x0304'>, <'10', $g1, $g>, 
                                                                        <'40', $g1, $g1^~x>, 
                                                                        <'45', '0', '1'>, <'42', '0'>, '41', 
                                                                        <~ticket, 
                                                                         mask(~ticket_age_add, $ticket_age)>, 
                                                                        '0'>)
                                                                    >)
                                                              >, 
                                                              '6', '0x0303', '40', $g>, 
                                                             '1', '0x0303', ~new_nc, '0', $cipher_suites.1, 
                                                             '0', <'43', '0x0304'>, <'10', $g1, $g>, 
                                                             <'40', $g, $g^~x.1>, <'45', '0', '1'>, '0', 
                                                             '41', <~ticket, mask(~ticket_age_add, '1')>, '0'
                                                            >)
                                                         >)
                                                   >, 
                                                   '2', '0x0303', p_ns, $cipher_suite, <'13', $sig_algs>, 
                                                   '40', $g, p_gy>, 
                                                  '8', $exts>, 
                                                 '11', '0', pk(~ltkS)>)
                                             >,
                                             ~ltkS)
                                       >, 
                                       '20', 
                                       hmac(<
                                             Expand(Expand(Extract(p_gxy, Extract(~res_psk, '0')),
                                                           <'serverhts', 
                                                            h(<
                                                               <
                                                                <
                                                                 <
                                                                  <
                                                                   <
                                                                    <'0', '1', '0x0303', ~tid, '0', 
                                                                     $cipher_suites, '0', <'43', '0x0304'>, 
                                                                     <'10', $g1, $g>, <'40', $g1, $g1^~x>, 
                                                                     <'45', '0', '1'>, <'42', '0'>, '41', 
                                                                     <~ticket, 
                                                                      mask(~ticket_age_add, $ticket_age)>, 
                                                                     hmac(<
                                                                           Expand(Expand(Extract(~res_psk,
                                                                                                 '0'),
                                                                                         <'ext', 'pbk'>,
                                                                                         '32'),
                                                                                  <'0', '0'>, '32'), 
                                                                           h(<'0', '1', '0x0303', ~tid, '0', 
                                                                              $cipher_suites, '0', 
                                                                              <'43', '0x0304'>, 
                                                                              <'10', $g1, $g>, 
                                                                              <'40', $g1, $g1^~x>, 
                                                                              <'45', '0', '1'>, <'42', '0'>, 
                                                                              '41', 
                                                                              <~ticket, 
                                                                               mask(~ticket_age_add,
                                                                                    $ticket_age)
                                                                              >, 
                                                                              '0'>)
                                                                          >)
                                                                    >, 
                                                                    '6', '0x0303', '40', $g>, 
                                                                   '1', '0x0303', ~new_nc, '0', 
                                                                   $cipher_suites.1, '0', <'43', '0x0304'>, 
                                                                   <'10', $g1, $g>, <'40', $g, $g^~x.1>, 
                                                                   <'45', '0', '1'>, '0', '41', 
                                                                   <~ticket, mask(~ticket_age_add, '1')>, 
                                                                   hmac(<
                                                                         Expand(Expand(Extract(~res_psk, '0'),
                                                                                       <'ext', 'pbk'>, '32'),
                                                                                <'0', '0'>, '32'), 
                                                                         h(<
                                                                            <
                                                                             <'0', '1', '0x0303', ~tid, '0', 
                                                                              $cipher_suites, '0', 
                                                                              <'43', '0x0304'>, 
                                                                              <'10', $g1, $g>, 
                                                                              <'40', $g1, $g1^~x>, 
                                                                              <'45', '0', '1'>, <'42', '0'>, 
                                                                              '41', 
                                                                              <~ticket, 
                                                                               mask(~ticket_age_add,
                                                                                    $ticket_age)
                                                                              >, 
                                                                              hmac(<
                                                                                    Expand(Expand(Extract(~res_psk,
                                                                                                          '0'),
                                                                                                  <'ext', 
                                                                                                   'pbk'>,
                                                                                                  '32'),
                                                                                           <'0', '0'>, '32'), 
                                                                                    h(<'0', '1', '0x0303', 
                                                                                       ~tid, '0', 
                                                                                       $cipher_suites, '0', 
                                                                                       <'43', '0x0304'>, 
                                                                                       <'10', $g1, $g>, 
                                                                                       <'40', $g1, $g1^~x>, 
                                                                                       <'45', '0', '1'>, 
                                                                                       <'42', '0'>, '41', 
                                                                                       <~ticket, 
                                                                                        mask(~ticket_age_add,
                                                                                             $ticket_age)
                                                                                       >, 
                                                                                       '0'>)
                                                                                   >)
                                                                             >, 
                                                                             '6', '0x0303', '40', $g>, 
                                                                            '1', '0x0303', ~new_nc, '0', 
                                                                            $cipher_suites.1, '0', 
                                                                            <'43', '0x0304'>, 
                                                                            <'10', $g1, $g>, 
                                                                            <'40', $g, $g^~x.1>, 
                                                                            <'45', '0', '1'>, '0', '41', 
                                                                            <~ticket, 
                                                                             mask(~ticket_age_add, '1')>, 
                                                                            '0'>)
                                                                        >)
                                                                  >, 
                                                                  '2', '0x0303', p_ns, $cipher_suite, 
                                                                  <'13', $sig_algs>, '40', $g, p_gy>, 
                                                                 '8', $exts>, 
                                                                '11', '0', pk(~ltkS)>, 
                                                               '15', 
                                                               sign(<'server_cv', 
                                                                     h(<
                                                                        <
                                                                         <
                                                                          <
                                                                           <
                                                                            <'0', '1', '0x0303', ~tid, '0', 
                                                                             $cipher_suites, '0', 
                                                                             <'43', '0x0304'>, 
                                                                             <'10', $g1, $g>, 
                                                                             <'40', $g1, $g1^~x>, 
                                                                             <'45', '0', '1'>, <'42', '0'>, 
                                                                             '41', 
                                                                             <~ticket, 
                                                                              mask(~ticket_age_add,
                                                                                   $ticket_age)
                                                                             >, 
                                                                             hmac(<
                                                                                   Expand(Expand(Extract(~res_psk,
                                                                                                         '0'),
                                                                                                 <'ext', 'pbk'
                                                                                                 >,
                                                                                                 '32'),
                                                                                          <'0', '0'>, '32'), 
                                                                                   h(<'0', '1', '0x0303', 
                                                                                      ~tid, '0', 
                                                                                      $cipher_suites, '0', 
                                                                                      <'43', '0x0304'>, 
                                                                                      <'10', $g1, $g>, 
                                                                                      <'40', $g1, $g1^~x>, 
                                                                                      <'45', '0', '1'>, 
                                                                                      <'42', '0'>, '41', 
                                                                                      <~ticket, 
                                                                                       mask(~ticket_age_add,
                                                                                            $ticket_age)
                                                                                      >, 
                                                                                      '0'>)
                                                                                  >)
                                                                            >, 
                                                                            '6', '0x0303', '40', $g>, 
                                                                           '1', '0x0303', ~new_nc, '0', 
                                                                           $cipher_suites.1, '0', 
                                                                           <'43', '0x0304'>, <'10', $g1, $g>, 
                                                                           <'40', $g, $g^~x.1>, 
                                                                           <'45', '0', '1'>, '0', '41', 
                                                                           <~ticket, 
                                                                            mask(~ticket_age_add, '1')>, 
                                                                           hmac(<
                                                                                 Expand(Expand(Extract(~res_psk,
                                                                                                       '0'),
                                                                                               <'ext', 'pbk'>,
                                                                                               '32'),
                                                                                        <'0', '0'>, '32'), 
                                                                                 h(<
                                                                                    <
                                                                                     <'0', '1', '0x0303', 
                                                                                      ~tid, '0', 
                                                                                      $cipher_suites, '0', 
                                                                                      <'43', '0x0304'>, 
                                                                                      <'10', $g1, $g>, 
                                                                                      <'40', $g1, $g1^~x>, 
                                                                                      <'45', '0', '1'>, 
                                                                                      <'42', '0'>, '41', 
                                                                                      <~ticket, 
                                                                                       mask(~ticket_age_add,
                                                                                            $ticket_age)
                                                                                      >, 
                                                                                      hmac(<
                                                                                            Expand(Expand(Extract(~res_psk,
                                                                                                                  '0'),
                                                                                                          <
                                                                                                           'ext', 
                                                                                                           'pbk'
                                                                                                          >,
                                                                                                          '32'),
                                                                                                   <'0', '0'>,
                                                                                                   '32'), 
                                                                                            h(<'0', '1', 
                                                                                               '0x0303', 
                                                                                               ~tid, '0', 
                                                                                               $cipher_suites, 
                                                                                               '0', 
                                                                                               <'43', '0x0304'
                                                                                               >, 
                                                                                               <'10', $g1, $g
                                                                                               >, 
                                                                                               <'40', $g1, 
                                                                                                $g1^~x>, 
                                                                                               <'45', '0', '1'
                                                                                               >, 
                                                                                               <'42', '0'>, 
                                                                                               '41', 
                                                                                               <~ticket, 
                                                                                                mask(~ticket_age_add,
                                                                                                     $ticket_age)
                                                                                               >, 
                                                                                               '0'>)
                                                                                           >)
                                                                                     >, 
                                                                                     '6', '0x0303', '40', $g
                                                                                    >, 
                                                                                    '1', '0x0303', ~new_nc, 
                                                                                    '0', $cipher_suites.1, 
                                                                                    '0', <'43', '0x0304'>, 
                                                                                    <'10', $g1, $g>, 
                                                                                    <'40', $g, $g^~x.1>, 
                                                                                    <'45', '0', '1'>, '0', 
                                                                                    '41', 
                                                                                    <~ticket, 
                                                                                     mask(~ticket_age_add,
                                                                                          '1')
                                                                                    >, 
                                                                                    '0'>)
                                                                                >)
                                                                          >, 
                                                                          '2', '0x0303', p_ns, $cipher_suite, 
                                                                          <'13', $sig_algs>, '40', $g, p_gy>, 
                                                                         '8', $exts>, 
                                                                        '11', '0', pk(~ltkS)>)
                                                                    >,
                                                                    ~ltkS)
                                                              >)
                                                           >,
                                                           '32'),
                                                    <'fin', '0'>, '32'), 
                                             h(<
                                                <
                                                 <
                                                  <
                                                   <
                                                    <
                                                     <'0', '1', '0x0303', ~tid, '0', $cipher_suites, '0', 
                                                      <'43', '0x0304'>, <'10', $g1, $g>, <'40', $g1, $g1^~x>, 
                                                      <'45', '0', '1'>, <'42', '0'>, '41', 
                                                      <~ticket, mask(~ticket_age_add, $ticket_age)>, 
                                                      hmac(<
                                                            Expand(Expand(Extract(~res_psk, '0'),
                                                                          <'ext', 'pbk'>, '32'),
                                                                   <'0', '0'>, '32'), 
                                                            h(<'0', '1', '0x0303', ~tid, '0', $cipher_suites, 
                                                               '0', <'43', '0x0304'>, <'10', $g1, $g>, 
                                                               <'40', $g1, $g1^~x>, <'45', '0', '1'>, 
                                                               <'42', '0'>, '41', 
                                                               <~ticket, mask(~ticket_age_add, $ticket_age)>, 
                                                               '0'>)
                                                           >)
                                                     >, 
                                                     '6', '0x0303', '40', $g>, 
                                                    '1', '0x0303', ~new_nc, '0', $cipher_suites.1, '0', 
                                                    <'43', '0x0304'>, <'10', $g1, $g>, <'40', $g, $g^~x.1>, 
                                                    <'45', '0', '1'>, '0', '41', 
                                                    <~ticket, mask(~ticket_age_add, '1')>, 
                                                    hmac(<
                                                          Expand(Expand(Extract(~res_psk, '0'),
                                                                        <'ext', 'pbk'>, '32'),
                                                                 <'0', '0'>, '32'), 
                                                          h(<
                                                             <
                                                              <'0', '1', '0x0303', ~tid, '0', $cipher_suites, 
                                                               '0', <'43', '0x0304'>, <'10', $g1, $g>, 
                                                               <'40', $g1, $g1^~x>, <'45', '0', '1'>, 
                                                               <'42', '0'>, '41', 
                                                               <~ticket, mask(~ticket_age_add, $ticket_age)>, 
                                                               hmac(<
                                                                     Expand(Expand(Extract(~res_psk, '0'),
                                                                                   <'ext', 'pbk'>, '32'),
                                                                            <'0', '0'>, '32'), 
                                                                     h(<'0', '1', '0x0303', ~tid, '0', 
                                                                        $cipher_suites, '0', 
                                                                        <'43', '0x0304'>, <'10', $g1, $g>, 
                                                                        <'40', $g1, $g1^~x>, 
                                                                        <'45', '0', '1'>, <'42', '0'>, '41', 
                                                                        <~ticket, 
                                                                         mask(~ticket_age_add, $ticket_age)>, 
                                                                        '0'>)
                                                                    >)
                                                              >, 
                                                              '6', '0x0303', '40', $g>, 
                                                             '1', '0x0303', ~new_nc, '0', $cipher_suites.1, 
                                                             '0', <'43', '0x0304'>, <'10', $g1, $g>, 
                                                             <'40', $g, $g^~x.1>, <'45', '0', '1'>, '0', 
                                                             '41', <~ticket, mask(~ticket_age_add, '1')>, '0'
                                                            >)
                                                         >)
                                                   >, 
                                                   '2', '0x0303', p_ns, $cipher_suite, <'13', $sig_algs>, 
                                                   '40', $g, p_gy>, 
                                                  '8', $exts>, 
                                                 '11', '0', pk(~ltkS)>, 
                                                '15', 
                                                sign(<'server_cv', 
                                                      h(<
                                                         <
                                                          <
                                                           <
                                                            <
                                                             <'0', '1', '0x0303', ~tid, '0', $cipher_suites, 
                                                              '0', <'43', '0x0304'>, <'10', $g1, $g>, 
                                                              <'40', $g1, $g1^~x>, <'45', '0', '1'>, 
                                                              <'42', '0'>, '41', 
                                                              <~ticket, mask(~ticket_age_add, $ticket_age)>, 
                                                              hmac(<
                                                                    Expand(Expand(Extract(~res_psk, '0'),
                                                                                  <'ext', 'pbk'>, '32'),
                                                                           <'0', '0'>, '32'), 
                                                                    h(<'0', '1', '0x0303', ~tid, '0', 
                                                                       $cipher_suites, '0', <'43', '0x0304'>, 
                                                                       <'10', $g1, $g>, <'40', $g1, $g1^~x>, 
                                                                       <'45', '0', '1'>, <'42', '0'>, '41', 
                                                                       <~ticket, 
                                                                        mask(~ticket_age_add, $ticket_age)>, 
                                                                       '0'>)
                                                                   >)
                                                             >, 
                                                             '6', '0x0303', '40', $g>, 
                                                            '1', '0x0303', ~new_nc, '0', $cipher_suites.1, 
                                                            '0', <'43', '0x0304'>, <'10', $g1, $g>, 
                                                            <'40', $g, $g^~x.1>, <'45', '0', '1'>, '0', '41', 
                                                            <~ticket, mask(~ticket_age_add, '1')>, 
                                                            hmac(<
                                                                  Expand(Expand(Extract(~res_psk, '0'),
                                                                                <'ext', 'pbk'>, '32'),
                                                                         <'0', '0'>, '32'), 
                                                                  h(<
                                                                     <
                                                                      <'0', '1', '0x0303', ~tid, '0', 
                                                                       $cipher_suites, '0', <'43', '0x0304'>, 
                                                                       <'10', $g1, $g>, <'40', $g1, $g1^~x>, 
                                                                       <'45', '0', '1'>, <'42', '0'>, '41', 
                                                                       <~ticket, 
                                                                        mask(~ticket_age_add, $ticket_age)>, 
                                                                       hmac(<
                                                                             Expand(Expand(Extract(~res_psk,
                                                                                                   '0'),
                                                                                           <'ext', 'pbk'>,
                                                                                           '32'),
                                                                                    <'0', '0'>, '32'), 
                                                                             h(<'0', '1', '0x0303', ~tid, 
                                                                                '0', $cipher_suites, '0', 
                                                                                <'43', '0x0304'>, 
                                                                                <'10', $g1, $g>, 
                                                                                <'40', $g1, $g1^~x>, 
                                                                                <'45', '0', '1'>, 
                                                                                <'42', '0'>, '41', 
                                                                                <~ticket, 
                                                                                 mask(~ticket_age_add,
                                                                                      $ticket_age)
                                                                                >, 
                                                                                '0'>)
                                                                            >)
                                                                      >, 
                                                                      '6', '0x0303', '40', $g>, 
                                                                     '1', '0x0303', ~new_nc, '0', 
                                                                     $cipher_suites.1, '0', <'43', '0x0304'>, 
                                                                     <'10', $g1, $g>, <'40', $g, $g^~x.1>, 
                                                                     <'45', '0', '1'>, '0', '41', 
                                                                     <~ticket, mask(~ticket_age_add, '1')>, 
                                                                     '0'>)
                                                                 >)
                                                           >, 
                                                           '2', '0x0303', p_ns, $cipher_suite, 
                                                           <'13', $sig_algs>, '40', $g, p_gy>, 
                                                          '8', $exts>, 
                                                         '11', '0', pk(~ltkS)>)
                                                     >,
                                                     ~ltkS)
                                               >)
                                            >)
                                      >)
                                   >,
                                   '32')
                 ) @ #l)
               ∧
                #l < #j.1)) )
        case case_1
        solve( (∃ #r. (RevLtk( $S ) @ #r) ∧ #r < #vr)  ∥
               (∃ tid3 x #r. (RevDHExp( tid3, $S, x ) @ #r) ∧ #r < #vr)  ∥
               (∃ tid4 y #r. (RevDHExp( tid4, $C, y ) @ #r) ∧ #r < #vr)  ∥
               (∃ rms #r. (RevealPSK( $C, rms ) @ #r) ∧ #r < #k.1)  ∥
               (∃ rms #r. (RevealPSK( $S, rms ) @ #r) ∧ #r < #k.1) )
          case case_1
          by contradiction /* from formulas */
        next
          case case_2
          by contradiction /* from formulas */
        next
          case case_3
          by contradiction /* from formulas */
        next
          case case_4
          by contradiction /* from formulas */
        next
          case case_5
          by contradiction /* from formulas */
        qed
      next
        case case_2
        by solve( SecretPSK( $A,
                             Expand(Extract('0', Extract(p_gxy, Extract(~res_psk, '0'))),
                                    <'serverats', 
                                     h(<
                                        <
                                         <
                                          <
                                           <
                                            <
                                             <
                                              <'0', '1', '0x0303', ~tid, '0', $cipher_suites, '0', 
                                               <'43', '0x0304'>, <'10', $g1, $g>, <'40', $g1, $g1^~x>, 
                                               <'45', '0', '1'>, <'42', '0'>, '41', 
                                               <~ticket, mask(~ticket_age_add, $ticket_age)>, 
                                               hmac(<
                                                     Expand(Expand(Extract(~res_psk, '0'), <'ext', 'pbk'>,
                                                                   '32'),
                                                            <'0', '0'>, '32'), 
                                                     h(<'0', '1', '0x0303', ~tid, '0', $cipher_suites, '0', 
                                                        <'43', '0x0304'>, <'10', $g1, $g>, 
                                                        <'40', $g1, $g1^~x>, <'45', '0', '1'>, <'42', '0'>, 
                                                        '41', <~ticket, mask(~ticket_age_add, $ticket_age)>, 
                                                        '0'>)
                                                    >)
                                              >, 
                                              '6', '0x0303', '40', $g>, 
                                             '1', '0x0303', ~new_nc, '0', $cipher_suites.1, '0', 
                                             <'43', '0x0304'>, <'10', $g1, $g>, <'40', $g, $g^~x.1>, 
                                             <'45', '0', '1'>, '0', '41', 
                                             <~ticket, mask(~ticket_age_add, '1')>, 
                                             hmac(<
                                                   Expand(Expand(Extract(~res_psk, '0'), <'ext', 'pbk'>,
                                                                 '32'),
                                                          <'0', '0'>, '32'), 
                                                   h(<
                                                      <
                                                       <'0', '1', '0x0303', ~tid, '0', $cipher_suites, '0', 
                                                        <'43', '0x0304'>, <'10', $g1, $g>, 
                                                        <'40', $g1, $g1^~x>, <'45', '0', '1'>, <'42', '0'>, 
                                                        '41', <~ticket, mask(~ticket_age_add, $ticket_age)>, 
                                                        hmac(<
                                                              Expand(Expand(Extract(~res_psk, '0'),
                                                                            <'ext', 'pbk'>, '32'),
                                                                     <'0', '0'>, '32'), 
                                                              h(<'0', '1', '0x0303', ~tid, '0', 
                                                                 $cipher_suites, '0', <'43', '0x0304'>, 
                                                                 <'10', $g1, $g>, <'40', $g1, $g1^~x>, 
                                                                 <'45', '0', '1'>, <'42', '0'>, '41', 
                                                                 <~ticket, mask(~ticket_age_add, $ticket_age)
                                                                 >, 
                                                                 '0'>)
                                                             >)
                                                       >, 
                                                       '6', '0x0303', '40', $g>, 
                                                      '1', '0x0303', ~new_nc, '0', $cipher_suites.1, '0', 
                                                      <'43', '0x0304'>, <'10', $g1, $g>, <'40', $g, $g^~x.1>, 
                                                      <'45', '0', '1'>, '0', '41', 
                                                      <~ticket, mask(~ticket_age_add, '1')>, '0'>)
                                                  >)
                                            >, 
                                            '2', '0x0303', p_ns, $cipher_suite, <'13', $sig_algs>, '40', $g, 
                                            p_gy>, 
                                           '8', $exts>, 
                                          '11', '0', pk(~ltkS)>, 
                                         '15', 
                                         sign(<'server_cv', 
                                               h(<
                                                  <
                                                   <
                                                    <
                                                     <
                                                      <'0', '1', '0x0303', ~tid, '0', $cipher_suites, '0', 
                                                       <'43', '0x0304'>, <'10', $g1, $g>, 
                                                       <'40', $g1, $g1^~x>, <'45', '0', '1'>, <'42', '0'>, 
                                                       '41', <~ticket, mask(~ticket_age_add, $ticket_age)>, 
                                                       hmac(<
                                                             Expand(Expand(Extract(~res_psk, '0'),
                                                                           <'ext', 'pbk'>, '32'),
                                                                    <'0', '0'>, '32'), 
                                                             h(<'0', '1', '0x0303', ~tid, '0', 
                                                                $cipher_suites, '0', <'43', '0x0304'>, 
                                                                <'10', $g1, $g>, <'40', $g1, $g1^~x>, 
                                                                <'45', '0', '1'>, <'42', '0'>, '41', 
                                                                <~ticket, mask(~ticket_age_add, $ticket_age)
                                                                >, 
                                                                '0'>)
                                                            >)
                                                      >, 
                                                      '6', '0x0303', '40', $g>, 
                                                     '1', '0x0303', ~new_nc, '0', $cipher_suites.1, '0', 
                                                     <'43', '0x0304'>, <'10', $g1, $g>, <'40', $g, $g^~x.1>, 
                                                     <'45', '0', '1'>, '0', '41', 
                                                     <~ticket, mask(~ticket_age_add, '1')>, 
                                                     hmac(<
                                                           Expand(Expand(Extract(~res_psk, '0'),
                                                                         <'ext', 'pbk'>, '32'),
                                                                  <'0', '0'>, '32'), 
                                                           h(<
                                                              <
                                                               <'0', '1', '0x0303', ~tid, '0', 
                                                                $cipher_suites, '0', <'43', '0x0304'>, 
                                                                <'10', $g1, $g>, <'40', $g1, $g1^~x>, 
                                                                <'45', '0', '1'>, <'42', '0'>, '41', 
                                                                <~ticket, mask(~ticket_age_add, $ticket_age)
                                                                >, 
                                                                hmac(<
                                                                      Expand(Expand(Extract(~res_psk, '0'),
                                                                                    <'ext', 'pbk'>, '32'),
                                                                             <'0', '0'>, '32'), 
                                                                      h(<'0', '1', '0x0303', ~tid, '0', 
                                                                         $cipher_suites, '0', 
                                                                         <'43', '0x0304'>, <'10', $g1, $g>, 
                                                                         <'40', $g1, $g1^~x>, 
                                                                         <'45', '0', '1'>, <'42', '0'>, '41', 
                                                                         <~ticket, 
                                                                          mask(~ticket_age_add, $ticket_age)
                                                                         >, 
                                                                         '0'>)
                                                                     >)
                                                               >, 
                                                               '6', '0x0303', '40', $g>, 
                                                              '1', '0x0303', ~new_nc, '0', $cipher_suites.1, 
                                                              '0', <'43', '0x0304'>, <'10', $g1, $g>, 
                                                              <'40', $g, $g^~x.1>, <'45', '0', '1'>, '0', 
                                                              '41', <~ticket, mask(~ticket_age_add, '1')>, '0'
                                                             >)
                                                          >)
                                                    >, 
                                                    '2', '0x0303', p_ns, $cipher_suite, <'13', $sig_algs>, 
                                                    '40', $g, p_gy>, 
                                                   '8', $exts>, 
                                                  '11', '0', pk(~ltkS)>)
                                              >,
                                              ~ltkS)
                                        >, 
                                        '20', 
                                        hmac(<
                                              Expand(Expand(Extract(p_gxy, Extract(~res_psk, '0')),
                                                            <'serverhts', 
                                                             h(<
                                                                <
                                                                 <
                                                                  <
                                                                   <
                                                                    <
                                                                     <'0', '1', '0x0303', ~tid, '0', 
                                                                      $cipher_suites, '0', <'43', '0x0304'>, 
                                                                      <'10', $g1, $g>, <'40', $g1, $g1^~x>, 
                                                                      <'45', '0', '1'>, <'42', '0'>, '41', 
                                                                      <~ticket, 
                                                                       mask(~ticket_age_add, $ticket_age)>, 
                                                                      hmac(<
                                                                            Expand(Expand(Extract(~res_psk,
                                                                                                  '0'),
                                                                                          <'ext', 'pbk'>,
                                                                                          '32'),
                                                                                   <'0', '0'>, '32'), 
                                                                            h(<'0', '1', '0x0303', ~tid, '0', 
                                                                               $cipher_suites, '0', 
                                                                               <'43', '0x0304'>, 
                                                                               <'10', $g1, $g>, 
                                                                               <'40', $g1, $g1^~x>, 
                                                                               <'45', '0', '1'>, <'42', '0'>, 
                                                                               '41', 
                                                                               <~ticket, 
                                                                                mask(~ticket_age_add,
                                                                                     $ticket_age)
                                                                               >, 
                                                                               '0'>)
                                                                           >)
                                                                     >, 
                                                                     '6', '0x0303', '40', $g>, 
                                                                    '1', '0x0303', ~new_nc, '0', 
                                                                    $cipher_suites.1, '0', <'43', '0x0304'>, 
                                                                    <'10', $g1, $g>, <'40', $g, $g^~x.1>, 
                                                                    <'45', '0', '1'>, '0', '41', 
                                                                    <~ticket, mask(~ticket_age_add, '1')>, 
                                                                    hmac(<
                                                                          Expand(Expand(Extract(~res_psk,
                                                                                                '0'),
                                                                                        <'ext', 'pbk'>, '32'),
                                                                                 <'0', '0'>, '32'), 
                                                                          h(<
                                                                             <
                                                                              <'0', '1', '0x0303', ~tid, '0', 
                                                                               $cipher_suites, '0', 
                                                                               <'43', '0x0304'>, 
                                                                               <'10', $g1, $g>, 
                                                                               <'40', $g1, $g1^~x>, 
                                                                               <'45', '0', '1'>, <'42', '0'>, 
                                                                               '41', 
                                                                               <~ticket, 
                                                                                mask(~ticket_age_add,
                                                                                     $ticket_age)
                                                                               >, 
                                                                               hmac(<
                                                                                     Expand(Expand(Extract(~res_psk,
                                                                                                           '0'),
                                                                                                   <'ext', 
                                                                                                    'pbk'>,
                                                                                                   '32'),
                                                                                            <'0', '0'>,
                                                                                            '32'), 
                                                                                     h(<'0', '1', '0x0303', 
                                                                                        ~tid, '0', 
                                                                                        $cipher_suites, '0', 
                                                                                        <'43', '0x0304'>, 
                                                                                        <'10', $g1, $g>, 
                                                                                        <'40', $g1, $g1^~x>, 
                                                                                        <'45', '0', '1'>, 
                                                                                        <'42', '0'>, '41', 
                                                                                        <~ticket, 
                                                                                         mask(~ticket_age_add,
                                                                                              $ticket_age)
                                                                                        >, 
                                                                                        '0'>)
                                                                                    >)
                                                                              >, 
                                                                              '6', '0x0303', '40', $g>, 
                                                                             '1', '0x0303', ~new_nc, '0', 
                                                                             $cipher_suites.1, '0', 
                                                                             <'43', '0x0304'>, 
                                                                             <'10', $g1, $g>, 
                                                                             <'40', $g, $g^~x.1>, 
                                                                             <'45', '0', '1'>, '0', '41', 
                                                                             <~ticket, 
                                                                              mask(~ticket_age_add, '1')>, 
                                                                             '0'>)
                                                                         >)
                                                                   >, 
                                                                   '2', '0x0303', p_ns, $cipher_suite, 
                                                                   <'13', $sig_algs>, '40', $g, p_gy>, 
                                                                  '8', $exts>, 
                                                                 '11', '0', pk(~ltkS)>, 
                                                                '15', 
                                                                sign(<'server_cv', 
                                                                      h(<
                                                                         <
                                                                          <
                                                                           <
                                                                            <
                                                                             <'0', '1', '0x0303', ~tid, '0', 
                                                                              $cipher_suites, '0', 
                                                                              <'43', '0x0304'>, 
                                                                              <'10', $g1, $g>, 
                                                                              <'40', $g1, $g1^~x>, 
                                                                              <'45', '0', '1'>, <'42', '0'>, 
                                                                              '41', 
                                                                              <~ticket, 
                                                                               mask(~ticket_age_add,
                                                                                    $ticket_age)
                                                                              >, 
                                                                              hmac(<
                                                                                    Expand(Expand(Extract(~res_psk,
                                                                                                          '0'),
                                                                                                  <'ext', 
                                                                                                   'pbk'>,
                                                                                                  '32'),
                                                                                           <'0', '0'>, '32'), 
                                                                                    h(<'0', '1', '0x0303', 
                                                                                       ~tid, '0', 
                                                                                       $cipher_suites, '0', 
                                                                                       <'43', '0x0304'>, 
                                                                                       <'10', $g1, $g>, 
                                                                                       <'40', $g1, $g1^~x>, 
                                                                                       <'45', '0', '1'>, 
                                                                                       <'42', '0'>, '41', 
                                                                                       <~ticket, 
                                                                                        mask(~ticket_age_add,
                                                                                             $ticket_age)
                                                                                       >, 
                                                                                       '0'>)
                                                                                   >)
                                                                             >, 
                                                                             '6', '0x0303', '40', $g>, 
                                                                            '1', '0x0303', ~new_nc, '0', 
                                                                            $cipher_suites.1, '0', 
                                                                            <'43', '0x0304'>, 
                                                                            <'10', $g1, $g>, 
                                                                            <'40', $g, $g^~x.1>, 
                                                                            <'45', '0', '1'>, '0', '41', 
                                                                            <~ticket, 
                                                                             mask(~ticket_age_add, '1')>, 
                                                                            hmac(<
                                                                                  Expand(Expand(Extract(~res_psk,
                                                                                                        '0'),
                                                                                                <'ext', 'pbk'
                                                                                                >,
                                                                                                '32'),
                                                                                         <'0', '0'>, '32'), 
                                                                                  h(<
                                                                                     <
                                                                                      <'0', '1', '0x0303', 
                                                                                       ~tid, '0', 
                                                                                       $cipher_suites, '0', 
                                                                                       <'43', '0x0304'>, 
                                                                                       <'10', $g1, $g>, 
                                                                                       <'40', $g1, $g1^~x>, 
                                                                                       <'45', '0', '1'>, 
                                                                                       <'42', '0'>, '41', 
                                                                                       <~ticket, 
                                                                                        mask(~ticket_age_add,
                                                                                             $ticket_age)
                                                                                       >, 
                                                                                       hmac(<
                                                                                             Expand(Expand(Extract(~res_psk,
                                                                                                                   '0'),
                                                                                                           <
                                                                                                            'ext', 
                                                                                                            'pbk'
                                                                                                           >,
                                                                                                           '32'),
                                                                                                    <'0', '0'
                                                                                                    >,
                                                                                                    '32'), 
                                                                                             h(<'0', '1', 
                                                                                                '0x0303', 
                                                                                                ~tid, '0', 
                                                                                                $cipher_suites, 
                                                                                                '0', 
                                                                                                <'43', 
                                                                                                 '0x0304'>, 
                                                                                                <'10', $g1, $g
                                                                                                >, 
                                                                                                <'40', $g1, 
                                                                                                 $g1^~x>, 
                                                                                                <'45', '0', 
                                                                                                 '1'>, 
                                                                                                <'42', '0'>, 
                                                                                                '41', 
                                                                                                <~ticket, 
                                                                                                 mask(~ticket_age_add,
                                                                                                      $ticket_age)
                                                                                                >, 
                                                                                                '0'>)
                                                                                            >)
                                                                                      >, 
                                                                                      '6', '0x0303', '40', $g
                                                                                     >, 
                                                                                     '1', '0x0303', ~new_nc, 
                                                                                     '0', $cipher_suites.1, 
                                                                                     '0', <'43', '0x0304'>, 
                                                                                     <'10', $g1, $g>, 
                                                                                     <'40', $g, $g^~x.1>, 
                                                                                     <'45', '0', '1'>, '0', 
                                                                                     '41', 
                                                                                     <~ticket, 
                                                                                      mask(~ticket_age_add,
                                                                                           '1')
                                                                                     >, 
                                                                                     '0'>)
                                                                                 >)
                                                                           >, 
                                                                           '2', '0x0303', p_ns, 
                                                                           $cipher_suite, <'13', $sig_algs>, 
                                                                           '40', $g, p_gy>, 
                                                                          '8', $exts>, 
                                                                         '11', '0', pk(~ltkS)>)
                                                                     >,
                                                                     ~ltkS)
                                                               >)
                                                            >,
                                                            '32'),
                                                     <'fin', '0'>, '32'), 
                                              h(<
                                                 <
                                                  <
                                                   <
                                                    <
                                                     <
                                                      <'0', '1', '0x0303', ~tid, '0', $cipher_suites, '0', 
                                                       <'43', '0x0304'>, <'10', $g1, $g>, 
                                                       <'40', $g1, $g1^~x>, <'45', '0', '1'>, <'42', '0'>, 
                                                       '41', <~ticket, mask(~ticket_age_add, $ticket_age)>, 
                                                       hmac(<
                                                             Expand(Expand(Extract(~res_psk, '0'),
                                                                           <'ext', 'pbk'>, '32'),
                                                                    <'0', '0'>, '32'), 
                                                             h(<'0', '1', '0x0303', ~tid, '0', 
                                                                $cipher_suites, '0', <'43', '0x0304'>, 
                                                                <'10', $g1, $g>, <'40', $g1, $g1^~x>, 
                                                                <'45', '0', '1'>, <'42', '0'>, '41', 
                                                                <~ticket, mask(~ticket_age_add, $ticket_age)
                                                                >, 
                                                                '0'>)
                                                            >)
                                                      >, 
                                                      '6', '0x0303', '40', $g>, 
                                                     '1', '0x0303', ~new_nc, '0', $cipher_suites.1, '0', 
                                                     <'43', '0x0304'>, <'10', $g1, $g>, <'40', $g, $g^~x.1>, 
                                                     <'45', '0', '1'>, '0', '41', 
                                                     <~ticket, mask(~ticket_age_add, '1')>, 
                                                     hmac(<
                                                           Expand(Expand(Extract(~res_psk, '0'),
                                                                         <'ext', 'pbk'>, '32'),
                                                                  <'0', '0'>, '32'), 
                                                           h(<
                                                              <
                                                               <'0', '1', '0x0303', ~tid, '0', 
                                                                $cipher_suites, '0', <'43', '0x0304'>, 
                                                                <'10', $g1, $g>, <'40', $g1, $g1^~x>, 
                                                                <'45', '0', '1'>, <'42', '0'>, '41', 
                                                                <~ticket, mask(~ticket_age_add, $ticket_age)
                                                                >, 
                                                                hmac(<
                                                                      Expand(Expand(Extract(~res_psk, '0'),
                                                                                    <'ext', 'pbk'>, '32'),
                                                                             <'0', '0'>, '32'), 
                                                                      h(<'0', '1', '0x0303', ~tid, '0', 
                                                                         $cipher_suites, '0', 
                                                                         <'43', '0x0304'>, <'10', $g1, $g>, 
                                                                         <'40', $g1, $g1^~x>, 
                                                                         <'45', '0', '1'>, <'42', '0'>, '41', 
                                                                         <~ticket, 
                                                                          mask(~ticket_age_add, $ticket_age)
                                                                         >, 
                                                                         '0'>)
                                                                     >)
                                                               >, 
                                                               '6', '0x0303', '40', $g>, 
                                                              '1', '0x0303', ~new_nc, '0', $cipher_suites.1, 
                                                              '0', <'43', '0x0304'>, <'10', $g1, $g>, 
                                                              <'40', $g, $g^~x.1>, <'45', '0', '1'>, '0', 
                                                              '41', <~ticket, mask(~ticket_age_add, '1')>, '0'
                                                             >)
                                                          >)
                                                    >, 
                                                    '2', '0x0303', p_ns, $cipher_suite, <'13', $sig_algs>, 
                                                    '40', $g, p_gy>, 
                                                   '8', $exts>, 
                                                  '11', '0', pk(~ltkS)>, 
                                                 '15', 
                                                 sign(<'server_cv', 
                                                       h(<
                                                          <
                                                           <
                                                            <
                                                             <
                                                              <'0', '1', '0x0303', ~tid, '0', $cipher_suites, 
                                                               '0', <'43', '0x0304'>, <'10', $g1, $g>, 
                                                               <'40', $g1, $g1^~x>, <'45', '0', '1'>, 
                                                               <'42', '0'>, '41', 
                                                               <~ticket, mask(~ticket_age_add, $ticket_age)>, 
                                                               hmac(<
                                                                     Expand(Expand(Extract(~res_psk, '0'),
                                                                                   <'ext', 'pbk'>, '32'),
                                                                            <'0', '0'>, '32'), 
                                                                     h(<'0', '1', '0x0303', ~tid, '0', 
                                                                        $cipher_suites, '0', 
                                                                        <'43', '0x0304'>, <'10', $g1, $g>, 
                                                                        <'40', $g1, $g1^~x>, 
                                                                        <'45', '0', '1'>, <'42', '0'>, '41', 
                                                                        <~ticket, 
                                                                         mask(~ticket_age_add, $ticket_age)>, 
                                                                        '0'>)
                                                                    >)
                                                              >, 
                                                              '6', '0x0303', '40', $g>, 
                                                             '1', '0x0303', ~new_nc, '0', $cipher_suites.1, 
                                                             '0', <'43', '0x0304'>, <'10', $g1, $g>, 
                                                             <'40', $g, $g^~x.1>, <'45', '0', '1'>, '0', 
                                                             '41', <~ticket, mask(~ticket_age_add, '1')>, 
                                                             hmac(<
                                                                   Expand(Expand(Extract(~res_psk, '0'),
                                                                                 <'ext', 'pbk'>, '32'),
                                                                          <'0', '0'>, '32'), 
                                                                   h(<
                                                                      <
                                                                       <'0', '1', '0x0303', ~tid, '0', 
                                                                        $cipher_suites, '0', 
                                                                        <'43', '0x0304'>, <'10', $g1, $g>, 
                                                                        <'40', $g1, $g1^~x>, 
                                                                        <'45', '0', '1'>, <'42', '0'>, '41', 
                                                                        <~ticket, 
                                                                         mask(~ticket_age_add, $ticket_age)>, 
                                                                        hmac(<
                                                                              Expand(Expand(Extract(~res_psk,
                                                                                                    '0'),
                                                                                            <'ext', 'pbk'>,
                                                                                            '32'),
                                                                                     <'0', '0'>, '32'), 
                                                                              h(<'0', '1', '0x0303', ~tid, 
                                                                                 '0', $cipher_suites, '0', 
                                                                                 <'43', '0x0304'>, 
                                                                                 <'10', $g1, $g>, 
                                                                                 <'40', $g1, $g1^~x>, 
                                                                                 <'45', '0', '1'>, 
                                                                                 <'42', '0'>, '41', 
                                                                                 <~ticket, 
                                                                                  mask(~ticket_age_add,
                                                                                       $ticket_age)
                                                                                 >, 
                                                                                 '0'>)
                                                                             >)
                                                                       >, 
                                                                       '6', '0x0303', '40', $g>, 
                                                                      '1', '0x0303', ~new_nc, '0', 
                                                                      $cipher_suites.1, '0', 
                                                                      <'43', '0x0304'>, <'10', $g1, $g>, 
                                                                      <'40', $g, $g^~x.1>, <'45', '0', '1'>, 
                                                                      '0', '41', 
                                                                      <~ticket, mask(~ticket_age_add, '1')>, 
                                                                      '0'>)
                                                                  >)
                                                            >, 
                                                            '2', '0x0303', p_ns, $cipher_suite, 
                                                            <'13', $sig_algs>, '40', $g, p_gy>, 
                                                           '8', $exts>, 
                                                          '11', '0', pk(~ltkS)>)
                                                      >,
                                                      ~ltkS)
                                                >)
                                             >)
                                       >)
                                    >,
                                    '32')
                  ) ▶₀ #l )
      qed
    next
      case recv_server_auth_case_08
      solve( (∃ #j.2.
               (!KU( Extract('0',
                             Extract(p_gxy, Extract(Expand(ms, <'rms', h(messages)>, '32'), '0')))
                ) @ #j.2)
              ∧
               #j.2 < #j.1)  ∥
             ((∀ #k.
                (!KU( Extract('0',
                              Extract(p_gxy, Extract(Expand(ms, <'rms', h(messages)>, '32'), '0')))
                 ) @ #k)
               ⇒
                ¬(#k < #j.1)) ∧
              (∃ actor #l.
                (RevealPSK( actor,
                            Expand(Extract('0',
                                           Extract(p_gxy,
                                                   Extract(Expand(ms, <'rms', h(messages)>, '32'), '0'))),
                                   <'serverats', 
                                    h(<
                                       <
                                        <
                                         <
                                          <
                                           <
                                            <
                                             <'0', '1', '0x0303', ~tid, '0', $cipher_suites, '0', 
                                              <'43', '0x0304'>, <'10', $g1, $g>, <'40', $g1, $g1^~x>, 
                                              <'45', '0', '1'>, <'42', '0'>, '41', 
                                              <p_psk_id, mask(ticket_age_add, $ticket_age)>, 
                                              hmac(<
                                                    Expand(Expand(Extract(Expand(ms, <'rms', h(messages)>,
                                                                                 '32'),
                                                                          '0'),
                                                                  <'res', 'pbk'>, '32'),
                                                           <'0', '0'>, '32'), 
                                                    h(<'0', '1', '0x0303', ~tid, '0', $cipher_suites, '0', 
                                                       <'43', '0x0304'>, <'10', $g1, $g>, 
                                                       <'40', $g1, $g1^~x>, <'45', '0', '1'>, <'42', '0'>, 
                                                       '41', <p_psk_id, mask(ticket_age_add, $ticket_age)>, 
                                                       '0'>)
                                                   >)
                                             >, 
                                             '6', '0x0303', '40', $g>, 
                                            '1', '0x0303', ~new_nc, '0', $cipher_suites.1, '0', 
                                            <'43', '0x0304'>, <'10', $g1, $g>, <'40', $g, $g^~x.1>, 
                                            <'45', '0', '1'>, '0', '41', 
                                            <p_psk_id, mask(ticket_age_add, '1')>, 
                                            hmac(<
                                                  Expand(Expand(Extract(Expand(ms, <'rms', h(messages)>,
                                                                               '32'),
                                                                        '0'),
                                                                <'res', 'pbk'>, '32'),
                                                         <'0', '0'>, '32'), 
                                                  h(<
                                                     <
                                                      <'0', '1', '0x0303', ~tid, '0', $cipher_suites, '0', 
                                                       <'43', '0x0304'>, <'10', $g1, $g>, 
                                                       <'40', $g1, $g1^~x>, <'45', '0', '1'>, <'42', '0'>, 
                                                       '41', <p_psk_id, mask(ticket_age_add, $ticket_age)>, 
                                                       hmac(<
                                                             Expand(Expand(Extract(Expand(ms,
                                                                                          <'rms', h(messages)
                                                                                          >,
                                                                                          '32'),
                                                                                   '0'),
                                                                           <'res', 'pbk'>, '32'),
                                                                    <'0', '0'>, '32'), 
                                                             h(<'0', '1', '0x0303', ~tid, '0', 
                                                                $cipher_suites, '0', <'43', '0x0304'>, 
                                                                <'10', $g1, $g>, <'40', $g1, $g1^~x>, 
                                                                <'45', '0', '1'>, <'42', '0'>, '41', 
                                                                <p_psk_id, mask(ticket_age_add, $ticket_age)
                                                                >, 
                                                                '0'>)
                                                            >)
                                                      >, 
                                                      '6', '0x0303', '40', $g>, 
                                                     '1', '0x0303', ~new_nc, '0', $cipher_suites.1, '0', 
                                                     <'43', '0x0304'>, <'10', $g1, $g>, <'40', $g, $g^~x.1>, 
                                                     <'45', '0', '1'>, '0', '41', 
                                                     <p_psk_id, mask(ticket_age_add, '1')>, '0'>)
                                                 >)
                                           >, 
                                           '2', '0x0303', p_ns, $cipher_suite, <'13', $sig_algs>, '40', $g, 
                                           p_gy>, 
                                          '8', $exts>, 
                                         '11', '0', pk(~ltkS)>, 
                                        '15', 
                                        sign(<'server_cv', 
                                              h(<
                                                 <
                                                  <
                                                   <
                                                    <
                                                     <'0', '1', '0x0303', ~tid, '0', $cipher_suites, '0', 
                                                      <'43', '0x0304'>, <'10', $g1, $g>, <'40', $g1, $g1^~x>, 
                                                      <'45', '0', '1'>, <'42', '0'>, '41', 
                                                      <p_psk_id, mask(ticket_age_add, $ticket_age)>, 
                                                      hmac(<
                                                            Expand(Expand(Extract(Expand(ms,
                                                                                         <'rms', h(messages)>,
                                                                                         '32'),
                                                                                  '0'),
                                                                          <'res', 'pbk'>, '32'),
                                                                   <'0', '0'>, '32'), 
                                                            h(<'0', '1', '0x0303', ~tid, '0', $cipher_suites, 
                                                               '0', <'43', '0x0304'>, <'10', $g1, $g>, 
                                                               <'40', $g1, $g1^~x>, <'45', '0', '1'>, 
                                                               <'42', '0'>, '41', 
                                                               <p_psk_id, mask(ticket_age_add, $ticket_age)>, 
                                                               '0'>)
                                                           >)
                                                     >, 
                                                     '6', '0x0303', '40', $g>, 
                                                    '1', '0x0303', ~new_nc, '0', $cipher_suites.1, '0', 
                                                    <'43', '0x0304'>, <'10', $g1, $g>, <'40', $g, $g^~x.1>, 
                                                    <'45', '0', '1'>, '0', '41', 
                                                    <p_psk_id, mask(ticket_age_add, '1')>, 
                                                    hmac(<
                                                          Expand(Expand(Extract(Expand(ms,
                                                                                       <'rms', h(messages)>,
                                                                                       '32'),
                                                                                '0'),
                                                                        <'res', 'pbk'>, '32'),
                                                                 <'0', '0'>, '32'), 
                                                          h(<
                                                             <
                                                              <'0', '1', '0x0303', ~tid, '0', $cipher_suites, 
                                                               '0', <'43', '0x0304'>, <'10', $g1, $g>, 
                                                               <'40', $g1, $g1^~x>, <'45', '0', '1'>, 
                                                               <'42', '0'>, '41', 
                                                               <p_psk_id, mask(ticket_age_add, $ticket_age)>, 
                                                               hmac(<
                                                                     Expand(Expand(Extract(Expand(ms,
                                                                                                  <'rms', 
                                                                                                   h(messages)
                                                                                                  >,
                                                                                                  '32'),
                                                                                           '0'),
                                                                                   <'res', 'pbk'>, '32'),
                                                                            <'0', '0'>, '32'), 
                                                                     h(<'0', '1', '0x0303', ~tid, '0', 
                                                                        $cipher_suites, '0', 
                                                                        <'43', '0x0304'>, <'10', $g1, $g>, 
                                                                        <'40', $g1, $g1^~x>, 
                                                                        <'45', '0', '1'>, <'42', '0'>, '41', 
                                                                        <p_psk_id, 
                                                                         mask(ticket_age_add, $ticket_age)>, 
                                                                        '0'>)
                                                                    >)
                                                              >, 
                                                              '6', '0x0303', '40', $g>, 
                                                             '1', '0x0303', ~new_nc, '0', $cipher_suites.1, 
                                                             '0', <'43', '0x0304'>, <'10', $g1, $g>, 
                                                             <'40', $g, $g^~x.1>, <'45', '0', '1'>, '0', 
                                                             '41', <p_psk_id, mask(ticket_age_add, '1')>, '0'
                                                            >)
                                                         >)
                                                   >, 
                                                   '2', '0x0303', p_ns, $cipher_suite, <'13', $sig_algs>, 
                                                   '40', $g, p_gy>, 
                                                  '8', $exts>, 
                                                 '11', '0', pk(~ltkS)>)
                                             >,
                                             ~ltkS)
                                       >, 
                                       '20', 
                                       hmac(<
                                             Expand(Expand(Extract(p_gxy,
                                                                   Extract(Expand(ms, <'rms', h(messages)>,
                                                                                  '32'),
                                                                           '0')),
                                                           <'serverhts', 
                                                            h(<
                                                               <
                                                                <
                                                                 <
                                                                  <
                                                                   <
                                                                    <'0', '1', '0x0303', ~tid, '0', 
                                                                     $cipher_suites, '0', <'43', '0x0304'>, 
                                                                     <'10', $g1, $g>, <'40', $g1, $g1^~x>, 
                                                                     <'45', '0', '1'>, <'42', '0'>, '41', 
                                                                     <p_psk_id, 
                                                                      mask(ticket_age_add, $ticket_age)>, 
                                                                     hmac(<
                                                                           Expand(Expand(Extract(Expand(ms,
                                                                                                        <
                                                                                                         'rms', 
                                                                                                         h(messages)
                                                                                                        >,
                                                                                                        '32'),
                                                                                                 '0'),
                                                                                         <'res', 'pbk'>,
                                                                                         '32'),
                                                                                  <'0', '0'>, '32'), 
                                                                           h(<'0', '1', '0x0303', ~tid, '0', 
                                                                              $cipher_suites, '0', 
                                                                              <'43', '0x0304'>, 
                                                                              <'10', $g1, $g>, 
                                                                              <'40', $g1, $g1^~x>, 
                                                                              <'45', '0', '1'>, <'42', '0'>, 
                                                                              '41', 
                                                                              <p_psk_id, 
                                                                               mask(ticket_age_add,
                                                                                    $ticket_age)
                                                                              >, 
                                                                              '0'>)
                                                                          >)
                                                                    >, 
                                                                    '6', '0x0303', '40', $g>, 
                                                                   '1', '0x0303', ~new_nc, '0', 
                                                                   $cipher_suites.1, '0', <'43', '0x0304'>, 
                                                                   <'10', $g1, $g>, <'40', $g, $g^~x.1>, 
                                                                   <'45', '0', '1'>, '0', '41', 
                                                                   <p_psk_id, mask(ticket_age_add, '1')>, 
                                                                   hmac(<
                                                                         Expand(Expand(Extract(Expand(ms,
                                                                                                      <'rms', 
                                                                                                       h(messages)
                                                                                                      >,
                                                                                                      '32'),
                                                                                               '0'),
                                                                                       <'res', 'pbk'>, '32'),
                                                                                <'0', '0'>, '32'), 
                                                                         h(<
                                                                            <
                                                                             <'0', '1', '0x0303', ~tid, '0', 
                                                                              $cipher_suites, '0', 
                                                                              <'43', '0x0304'>, 
                                                                              <'10', $g1, $g>, 
                                                                              <'40', $g1, $g1^~x>, 
                                                                              <'45', '0', '1'>, <'42', '0'>, 
                                                                              '41', 
                                                                              <p_psk_id, 
                                                                               mask(ticket_age_add,
                                                                                    $ticket_age)
                                                                              >, 
                                                                              hmac(<
                                                                                    Expand(Expand(Extract(Expand(ms,
                                                                                                                 <
                                                                                                                  'rms', 
                                                                                                                  h(messages)
                                                                                                                 >,
                                                                                                                 '32'),
                                                                                                          '0'),
                                                                                                  <'res', 
                                                                                                   'pbk'>,
                                                                                                  '32'),
                                                                                           <'0', '0'>, '32'), 
                                                                                    h(<'0', '1', '0x0303', 
                                                                                       ~tid, '0', 
                                                                                       $cipher_suites, '0', 
                                                                                       <'43', '0x0304'>, 
                                                                                       <'10', $g1, $g>, 
                                                                                       <'40', $g1, $g1^~x>, 
                                                                                       <'45', '0', '1'>, 
                                                                                       <'42', '0'>, '41', 
                                                                                       <p_psk_id, 
                                                                                        mask(ticket_age_add,
                                                                                             $ticket_age)
                                                                                       >, 
                                                                                       '0'>)
                                                                                   >)
                                                                             >, 
                                                                             '6', '0x0303', '40', $g>, 
                                                                            '1', '0x0303', ~new_nc, '0', 
                                                                            $cipher_suites.1, '0', 
                                                                            <'43', '0x0304'>, 
                                                                            <'10', $g1, $g>, 
                                                                            <'40', $g, $g^~x.1>, 
                                                                            <'45', '0', '1'>, '0', '41', 
                                                                            <p_psk_id, 
                                                                             mask(ticket_age_add, '1')>, 
                                                                            '0'>)
                                                                        >)
                                                                  >, 
                                                                  '2', '0x0303', p_ns, $cipher_suite, 
                                                                  <'13', $sig_algs>, '40', $g, p_gy>, 
                                                                 '8', $exts>, 
                                                                '11', '0', pk(~ltkS)>, 
                                                               '15', 
                                                               sign(<'server_cv', 
                                                                     h(<
                                                                        <
                                                                         <
                                                                          <
                                                                           <
                                                                            <'0', '1', '0x0303', ~tid, '0', 
                                                                             $cipher_suites, '0', 
                                                                             <'43', '0x0304'>, 
                                                                             <'10', $g1, $g>, 
                                                                             <'40', $g1, $g1^~x>, 
                                                                             <'45', '0', '1'>, <'42', '0'>, 
                                                                             '41', 
                                                                             <p_psk_id, 
                                                                              mask(ticket_age_add,
                                                                                   $ticket_age)
                                                                             >, 
                                                                             hmac(<
                                                                                   Expand(Expand(Extract(Expand(ms,
                                                                                                                <
                                                                                                                 'rms', 
                                                                                                                 h(messages)
                                                                                                                >,
                                                                                                                '32'),
                                                                                                         '0'),
                                                                                                 <'res', 'pbk'
                                                                                                 >,
                                                                                                 '32'),
                                                                                          <'0', '0'>, '32'), 
                                                                                   h(<'0', '1', '0x0303', 
                                                                                      ~tid, '0', 
                                                                                      $cipher_suites, '0', 
                                                                                      <'43', '0x0304'>, 
                                                                                      <'10', $g1, $g>, 
                                                                                      <'40', $g1, $g1^~x>, 
                                                                                      <'45', '0', '1'>, 
                                                                                      <'42', '0'>, '41', 
                                                                                      <p_psk_id, 
                                                                                       mask(ticket_age_add,
                                                                                            $ticket_age)
                                                                                      >, 
                                                                                      '0'>)
                                                                                  >)
                                                                            >, 
                                                                            '6', '0x0303', '40', $g>, 
                                                                           '1', '0x0303', ~new_nc, '0', 
                                                                           $cipher_suites.1, '0', 
                                                                           <'43', '0x0304'>, <'10', $g1, $g>, 
                                                                           <'40', $g, $g^~x.1>, 
                                                                           <'45', '0', '1'>, '0', '41', 
                                                                           <p_psk_id, 
                                                                            mask(ticket_age_add, '1')>, 
                                                                           hmac(<
                                                                                 Expand(Expand(Extract(Expand(ms,
                                                                                                              <
                                                                                                               'rms', 
                                                                                                               h(messages)
                                                                                                              >,
                                                                                                              '32'),
                                                                                                       '0'),
                                                                                               <'res', 'pbk'>,
                                                                                               '32'),
                                                                                        <'0', '0'>, '32'), 
                                                                                 h(<
                                                                                    <
                                                                                     <'0', '1', '0x0303', 
                                                                                      ~tid, '0', 
                                                                                      $cipher_suites, '0', 
                                                                                      <'43', '0x0304'>, 
                                                                                      <'10', $g1, $g>, 
                                                                                      <'40', $g1, $g1^~x>, 
                                                                                      <'45', '0', '1'>, 
                                                                                      <'42', '0'>, '41', 
                                                                                      <p_psk_id, 
                                                                                       mask(ticket_age_add,
                                                                                            $ticket_age)
                                                                                      >, 
                                                                                      hmac(<
                                                                                            Expand(Expand(Extract(Expand(ms,
                                                                                                                         <
                                                                                                                          'rms', 
                                                                                                                          h(messages)
                                                                                                                         >,
                                                                                                                         '32'),
                                                                                                                  '0'),
                                                                                                          <
                                                                                                           'res', 
                                                                                                           'pbk'
                                                                                                          >,
                                                                                                          '32'),
                                                                                                   <'0', '0'>,
                                                                                                   '32'), 
                                                                                            h(<'0', '1', 
                                                                                               '0x0303', 
                                                                                               ~tid, '0', 
                                                                                               $cipher_suites, 
                                                                                               '0', 
                                                                                               <'43', '0x0304'
                                                                                               >, 
                                                                                               <'10', $g1, $g
                                                                                               >, 
                                                                                               <'40', $g1, 
                                                                                                $g1^~x>, 
                                                                                               <'45', '0', '1'
                                                                                               >, 
                                                                                               <'42', '0'>, 
                                                                                               '41', 
                                                                                               <p_psk_id, 
                                                                                                mask(ticket_age_add,
                                                                                                     $ticket_age)
                                                                                               >, 
                                                                                               '0'>)
                                                                                           >)
                                                                                     >, 
                                                                                     '6', '0x0303', '40', $g
                                                                                    >, 
                                                                                    '1', '0x0303', ~new_nc, 
                                                                                    '0', $cipher_suites.1, 
                                                                                    '0', <'43', '0x0304'>, 
                                                                                    <'10', $g1, $g>, 
                                                                                    <'40', $g, $g^~x.1>, 
                                                                                    <'45', '0', '1'>, '0', 
                                                                                    '41', 
                                                                                    <p_psk_id, 
                                                                                     mask(ticket_age_add, '1')
                                                                                    >, 
                                                                                    '0'>)
                                                                                >)
                                                                          >, 
                                                                          '2', '0x0303', p_ns, $cipher_suite, 
                                                                          <'13', $sig_algs>, '40', $g, p_gy>, 
                                                                         '8', $exts>, 
                                                                        '11', '0', pk(~ltkS)>)
                                                                    >,
                                                                    ~ltkS)
                                                              >)
                                                           >,
                                                           '32'),
                                                    <'fin', '0'>, '32'), 
                                             h(<
                                                <
                                                 <
                                                  <
                                                   <
                                                    <
                                                     <'0', '1', '0x0303', ~tid, '0', $cipher_suites, '0', 
                                                      <'43', '0x0304'>, <'10', $g1, $g>, <'40', $g1, $g1^~x>, 
                                                      <'45', '0', '1'>, <'42', '0'>, '41', 
                                                      <p_psk_id, mask(ticket_age_add, $ticket_age)>, 
                                                      hmac(<
                                                            Expand(Expand(Extract(Expand(ms,
                                                                                         <'rms', h(messages)>,
                                                                                         '32'),
                                                                                  '0'),
                                                                          <'res', 'pbk'>, '32'),
                                                                   <'0', '0'>, '32'), 
                                                            h(<'0', '1', '0x0303', ~tid, '0', $cipher_suites, 
                                                               '0', <'43', '0x0304'>, <'10', $g1, $g>, 
                                                               <'40', $g1, $g1^~x>, <'45', '0', '1'>, 
                                                               <'42', '0'>, '41', 
                                                               <p_psk_id, mask(ticket_age_add, $ticket_age)>, 
                                                               '0'>)
                                                           >)
                                                     >, 
                                                     '6', '0x0303', '40', $g>, 
                                                    '1', '0x0303', ~new_nc, '0', $cipher_suites.1, '0', 
                                                    <'43', '0x0304'>, <'10', $g1, $g>, <'40', $g, $g^~x.1>, 
                                                    <'45', '0', '1'>, '0', '41', 
                                                    <p_psk_id, mask(ticket_age_add, '1')>, 
                                                    hmac(<
                                                          Expand(Expand(Extract(Expand(ms,
                                                                                       <'rms', h(messages)>,
                                                                                       '32'),
                                                                                '0'),
                                                                        <'res', 'pbk'>, '32'),
                                                                 <'0', '0'>, '32'), 
                                                          h(<
                                                             <
                                                              <'0', '1', '0x0303', ~tid, '0', $cipher_suites, 
                                                               '0', <'43', '0x0304'>, <'10', $g1, $g>, 
                                                               <'40', $g1, $g1^~x>, <'45', '0', '1'>, 
                                                               <'42', '0'>, '41', 
                                                               <p_psk_id, mask(ticket_age_add, $ticket_age)>, 
                                                               hmac(<
                                                                     Expand(Expand(Extract(Expand(ms,
                                                                                                  <'rms', 
                                                                                                   h(messages)
                                                                                                  >,
                                                                                                  '32'),
                                                                                           '0'),
                                                                                   <'res', 'pbk'>, '32'),
                                                                            <'0', '0'>, '32'), 
                                                                     h(<'0', '1', '0x0303', ~tid, '0', 
                                                                        $cipher_suites, '0', 
                                                                        <'43', '0x0304'>, <'10', $g1, $g>, 
                                                                        <'40', $g1, $g1^~x>, 
                                                                        <'45', '0', '1'>, <'42', '0'>, '41', 
                                                                        <p_psk_id, 
                                                                         mask(ticket_age_add, $ticket_age)>, 
                                                                        '0'>)
                                                                    >)
                                                              >, 
                                                              '6', '0x0303', '40', $g>, 
                                                             '1', '0x0303', ~new_nc, '0', $cipher_suites.1, 
                                                             '0', <'43', '0x0304'>, <'10', $g1, $g>, 
                                                             <'40', $g, $g^~x.1>, <'45', '0', '1'>, '0', 
                                                             '41', <p_psk_id, mask(ticket_age_add, '1')>, '0'
                                                            >)
                                                         >)
                                                   >, 
                                                   '2', '0x0303', p_ns, $cipher_suite, <'13', $sig_algs>, 
                                                   '40', $g, p_gy>, 
                                                  '8', $exts>, 
                                                 '11', '0', pk(~ltkS)>, 
                                                '15', 
                                                sign(<'server_cv', 
                                                      h(<
                                                         <
                                                          <
                                                           <
                                                            <
                                                             <'0', '1', '0x0303', ~tid, '0', $cipher_suites, 
                                                              '0', <'43', '0x0304'>, <'10', $g1, $g>, 
                                                              <'40', $g1, $g1^~x>, <'45', '0', '1'>, 
                                                              <'42', '0'>, '41', 
                                                              <p_psk_id, mask(ticket_age_add, $ticket_age)>, 
                                                              hmac(<
                                                                    Expand(Expand(Extract(Expand(ms,
                                                                                                 <'rms', 
                                                                                                  h(messages)
                                                                                                 >,
                                                                                                 '32'),
                                                                                          '0'),
                                                                                  <'res', 'pbk'>, '32'),
                                                                           <'0', '0'>, '32'), 
                                                                    h(<'0', '1', '0x0303', ~tid, '0', 
                                                                       $cipher_suites, '0', <'43', '0x0304'>, 
                                                                       <'10', $g1, $g>, <'40', $g1, $g1^~x>, 
                                                                       <'45', '0', '1'>, <'42', '0'>, '41', 
                                                                       <p_psk_id, 
                                                                        mask(ticket_age_add, $ticket_age)>, 
                                                                       '0'>)
                                                                   >)
                                                             >, 
                                                             '6', '0x0303', '40', $g>, 
                                                            '1', '0x0303', ~new_nc, '0', $cipher_suites.1, 
                                                            '0', <'43', '0x0304'>, <'10', $g1, $g>, 
                                                            <'40', $g, $g^~x.1>, <'45', '0', '1'>, '0', '41', 
                                                            <p_psk_id, mask(ticket_age_add, '1')>, 
                                                            hmac(<
                                                                  Expand(Expand(Extract(Expand(ms,
                                                                                               <'rms', 
                                                                                                h(messages)>,
                                                                                               '32'),
                                                                                        '0'),
                                                                                <'res', 'pbk'>, '32'),
                                                                         <'0', '0'>, '32'), 
                                                                  h(<
                                                                     <
                                                                      <'0', '1', '0x0303', ~tid, '0', 
                                                                       $cipher_suites, '0', <'43', '0x0304'>, 
                                                                       <'10', $g1, $g>, <'40', $g1, $g1^~x>, 
                                                                       <'45', '0', '1'>, <'42', '0'>, '41', 
                                                                       <p_psk_id, 
                                                                        mask(ticket_age_add, $ticket_age)>, 
                                                                       hmac(<
                                                                             Expand(Expand(Extract(Expand(ms,
                                                                                                          <
                                                                                                           'rms', 
                                                                                                           h(messages)
                                                                                                          >,
                                                                                                          '32'),
                                                                                                   '0'),
                                                                                           <'res', 'pbk'>,
                                                                                           '32'),
                                                                                    <'0', '0'>, '32'), 
                                                                             h(<'0', '1', '0x0303', ~tid, 
                                                                                '0', $cipher_suites, '0', 
                                                                                <'43', '0x0304'>, 
                                                                                <'10', $g1, $g>, 
                                                                                <'40', $g1, $g1^~x>, 
                                                                                <'45', '0', '1'>, 
                                                                                <'42', '0'>, '41', 
                                                                                <p_psk_id, 
                                                                                 mask(ticket_age_add,
                                                                                      $ticket_age)
                                                                                >, 
                                                                                '0'>)
                                                                            >)
                                                                      >, 
                                                                      '6', '0x0303', '40', $g>, 
                                                                     '1', '0x0303', ~new_nc, '0', 
                                                                     $cipher_suites.1, '0', <'43', '0x0304'>, 
                                                                     <'10', $g1, $g>, <'40', $g, $g^~x.1>, 
                                                                     <'45', '0', '1'>, '0', '41', 
                                                                     <p_psk_id, mask(ticket_age_add, '1')>, 
                                                                     '0'>)
                                                                 >)
                                                           >, 
                                                           '2', '0x0303', p_ns, $cipher_suite, 
                                                           <'13', $sig_algs>, '40', $g, p_gy>, 
                                                          '8', $exts>, 
                                                         '11', '0', pk(~ltkS)>)
                                                     >,
                                                     ~ltkS)
                                               >)
                                            >)
                                      >)
                                   >,
                                   '32')
                 ) @ #l)
               ∧
                #l < #j.1)) )
        case case_1
        solve( (∃ #r. (RevLtk( $S ) @ #r) ∧ #r < #vr)  ∥
               (∃ tid3 x #r. (RevDHExp( tid3, $S, x ) @ #r) ∧ #r < #vr)  ∥
               (∃ tid4 y #r. (RevDHExp( tid4, $C, y ) @ #r) ∧ #r < #vr)  ∥
               (∃ rms #r. (RevealPSK( $C, rms ) @ #r) ∧ #r < #k.1)  ∥
               (∃ rms #r. (RevealPSK( $S, rms ) @ #r) ∧ #r < #k.1) )
          case case_1
          by contradiction /* from formulas */
        next
          case case_2
          by contradiction /* from formulas */
        next
          case case_3
          by contradiction /* from formulas */
        next
          case case_4
          by contradiction /* from formulas */
        next
          case case_5
          by contradiction /* from formulas */
        qed
      next
        case case_2
        by solve( SecretPSK( $A,
                             Expand(Extract('0',
                                            Extract(p_gxy,
                                                    Extract(Expand(ms, <'rms', h(messages)>, '32'), '0'))),
                                    <'serverats', 
                                     h(<
                                        <
                                         <
                                          <
                                           <
                                            <
                                             <
                                              <'0', '1', '0x0303', ~tid, '0', $cipher_suites, '0', 
                                               <'43', '0x0304'>, <'10', $g1, $g>, <'40', $g1, $g1^~x>, 
                                               <'45', '0', '1'>, <'42', '0'>, '41', 
                                               <p_psk_id, mask(ticket_age_add, $ticket_age)>, 
                                               hmac(<
                                                     Expand(Expand(Extract(Expand(ms, <'rms', h(messages)>,
                                                                                  '32'),
                                                                           '0'),
                                                                   <'res', 'pbk'>, '32'),
                                                            <'0', '0'>, '32'), 
                                                     h(<'0', '1', '0x0303', ~tid, '0', $cipher_suites, '0', 
                                                        <'43', '0x0304'>, <'10', $g1, $g>, 
                                                        <'40', $g1, $g1^~x>, <'45', '0', '1'>, <'42', '0'>, 
                                                        '41', <p_psk_id, mask(ticket_age_add, $ticket_age)>, 
                                                        '0'>)
                                                    >)
                                              >, 
                                              '6', '0x0303', '40', $g>, 
                                             '1', '0x0303', ~new_nc, '0', $cipher_suites.1, '0', 
                                             <'43', '0x0304'>, <'10', $g1, $g>, <'40', $g, $g^~x.1>, 
                                             <'45', '0', '1'>, '0', '41', 
                                             <p_psk_id, mask(ticket_age_add, '1')>, 
                                             hmac(<
                                                   Expand(Expand(Extract(Expand(ms, <'rms', h(messages)>,
                                                                                '32'),
                                                                         '0'),
                                                                 <'res', 'pbk'>, '32'),
                                                          <'0', '0'>, '32'), 
                                                   h(<
                                                      <
                                                       <'0', '1', '0x0303', ~tid, '0', $cipher_suites, '0', 
                                                        <'43', '0x0304'>, <'10', $g1, $g>, 
                                                        <'40', $g1, $g1^~x>, <'45', '0', '1'>, <'42', '0'>, 
                                                        '41', <p_psk_id, mask(ticket_age_add, $ticket_age)>, 
                                                        hmac(<
                                                              Expand(Expand(Extract(Expand(ms,
                                                                                           <'rms', h(messages)
                                                                                           >,
                                                                                           '32'),
                                                                                    '0'),
                                                                            <'res', 'pbk'>, '32'),
                                                                     <'0', '0'>, '32'), 
                                                              h(<'0', '1', '0x0303', ~tid, '0', 
                                                                 $cipher_suites, '0', <'43', '0x0304'>, 
                                                                 <'10', $g1, $g>, <'40', $g1, $g1^~x>, 
                                                                 <'45', '0', '1'>, <'42', '0'>, '41', 
                                                                 <p_psk_id, mask(ticket_age_add, $ticket_age)
                                                                 >, 
                                                                 '0'>)
                                                             >)
                                                       >, 
                                                       '6', '0x0303', '40', $g>, 
                                                      '1', '0x0303', ~new_nc, '0', $cipher_suites.1, '0', 
                                                      <'43', '0x0304'>, <'10', $g1, $g>, <'40', $g, $g^~x.1>, 
                                                      <'45', '0', '1'>, '0', '41', 
                                                      <p_psk_id, mask(ticket_age_add, '1')>, '0'>)
                                                  >)
                                            >, 
                                            '2', '0x0303', p_ns, $cipher_suite, <'13', $sig_algs>, '40', $g, 
                                            p_gy>, 
                                           '8', $exts>, 
                                          '11', '0', pk(~ltkS)>, 
                                         '15', 
                                         sign(<'server_cv', 
                                               h(<
                                                  <
                                                   <
                                                    <
                                                     <
                                                      <'0', '1', '0x0303', ~tid, '0', $cipher_suites, '0', 
                                                       <'43', '0x0304'>, <'10', $g1, $g>, 
                                                       <'40', $g1, $g1^~x>, <'45', '0', '1'>, <'42', '0'>, 
                                                       '41', <p_psk_id, mask(ticket_age_add, $ticket_age)>, 
                                                       hmac(<
                                                             Expand(Expand(Extract(Expand(ms,
                                                                                          <'rms', h(messages)
                                                                                          >,
                                                                                          '32'),
                                                                                   '0'),
                                                                           <'res', 'pbk'>, '32'),
                                                                    <'0', '0'>, '32'), 
                                                             h(<'0', '1', '0x0303', ~tid, '0', 
                                                                $cipher_suites, '0', <'43', '0x0304'>, 
                                                                <'10', $g1, $g>, <'40', $g1, $g1^~x>, 
                                                                <'45', '0', '1'>, <'42', '0'>, '41', 
                                                                <p_psk_id, mask(ticket_age_add, $ticket_age)
                                                                >, 
                                                                '0'>)
                                                            >)
                                                      >, 
                                                      '6', '0x0303', '40', $g>, 
                                                     '1', '0x0303', ~new_nc, '0', $cipher_suites.1, '0', 
                                                     <'43', '0x0304'>, <'10', $g1, $g>, <'40', $g, $g^~x.1>, 
                                                     <'45', '0', '1'>, '0', '41', 
                                                     <p_psk_id, mask(ticket_age_add, '1')>, 
                                                     hmac(<
                                                           Expand(Expand(Extract(Expand(ms,
                                                                                        <'rms', h(messages)>,
                                                                                        '32'),
                                                                                 '0'),
                                                                         <'res', 'pbk'>, '32'),
                                                                  <'0', '0'>, '32'), 
                                                           h(<
                                                              <
                                                               <'0', '1', '0x0303', ~tid, '0', 
                                                                $cipher_suites, '0', <'43', '0x0304'>, 
                                                                <'10', $g1, $g>, <'40', $g1, $g1^~x>, 
                                                                <'45', '0', '1'>, <'42', '0'>, '41', 
                                                                <p_psk_id, mask(ticket_age_add, $ticket_age)
                                                                >, 
                                                                hmac(<
                                                                      Expand(Expand(Extract(Expand(ms,
                                                                                                   <'rms', 
                                                                                                    h(messages)
                                                                                                   >,
                                                                                                   '32'),
                                                                                            '0'),
                                                                                    <'res', 'pbk'>, '32'),
                                                                             <'0', '0'>, '32'), 
                                                                      h(<'0', '1', '0x0303', ~tid, '0', 
                                                                         $cipher_suites, '0', 
                                                                         <'43', '0x0304'>, <'10', $g1, $g>, 
                                                                         <'40', $g1, $g1^~x>, 
                                                                         <'45', '0', '1'>, <'42', '0'>, '41', 
                                                                         <p_psk_id, 
                                                                          mask(ticket_age_add, $ticket_age)>, 
                                                                         '0'>)
                                                                     >)
                                                               >, 
                                                               '6', '0x0303', '40', $g>, 
                                                              '1', '0x0303', ~new_nc, '0', $cipher_suites.1, 
                                                              '0', <'43', '0x0304'>, <'10', $g1, $g>, 
                                                              <'40', $g, $g^~x.1>, <'45', '0', '1'>, '0', 
                                                              '41', <p_psk_id, mask(ticket_age_add, '1')>, '0'
                                                             >)
                                                          >)
                                                    >, 
                                                    '2', '0x0303', p_ns, $cipher_suite, <'13', $sig_algs>, 
                                                    '40', $g, p_gy>, 
                                                   '8', $exts>, 
                                                  '11', '0', pk(~ltkS)>)
                                              >,
                                              ~ltkS)
                                        >, 
                                        '20', 
                                        hmac(<
                                              Expand(Expand(Extract(p_gxy,
                                                                    Extract(Expand(ms, <'rms', h(messages)>,
                                                                                   '32'),
                                                                            '0')),
                                                            <'serverhts', 
                                                             h(<
                                                                <
                                                                 <
                                                                  <
                                                                   <
                                                                    <
                                                                     <'0', '1', '0x0303', ~tid, '0', 
                                                                      $cipher_suites, '0', <'43', '0x0304'>, 
                                                                      <'10', $g1, $g>, <'40', $g1, $g1^~x>, 
                                                                      <'45', '0', '1'>, <'42', '0'>, '41', 
                                                                      <p_psk_id, 
                                                                       mask(ticket_age_add, $ticket_age)>, 
                                                                      hmac(<
                                                                            Expand(Expand(Extract(Expand(ms,
                                                                                                         <
                                                                                                          'rms', 
                                                                                                          h(messages)
                                                                                                         >,
                                                                                                         '32'),
                                                                                                  '0'),
                                                                                          <'res', 'pbk'>,
                                                                                          '32'),
                                                                                   <'0', '0'>, '32'), 
                                                                            h(<'0', '1', '0x0303', ~tid, '0', 
                                                                               $cipher_suites, '0', 
                                                                               <'43', '0x0304'>, 
                                                                               <'10', $g1, $g>, 
                                                                               <'40', $g1, $g1^~x>, 
                                                                               <'45', '0', '1'>, <'42', '0'>, 
                                                                               '41', 
                                                                               <p_psk_id, 
                                                                                mask(ticket_age_add,
                                                                                     $ticket_age)
                                                                               >, 
                                                                               '0'>)
                                                                           >)
                                                                     >, 
                                                                     '6', '0x0303', '40', $g>, 
                                                                    '1', '0x0303', ~new_nc, '0', 
                                                                    $cipher_suites.1, '0', <'43', '0x0304'>, 
                                                                    <'10', $g1, $g>, <'40', $g, $g^~x.1>, 
                                                                    <'45', '0', '1'>, '0', '41', 
                                                                    <p_psk_id, mask(ticket_age_add, '1')>, 
                                                                    hmac(<
                                                                          Expand(Expand(Extract(Expand(ms,
                                                                                                       <
                                                                                                        'rms', 
                                                                                                        h(messages)
                                                                                                       >,
                                                                                                       '32'),
                                                                                                '0'),
                                                                                        <'res', 'pbk'>, '32'),
                                                                                 <'0', '0'>, '32'), 
                                                                          h(<
                                                                             <
                                                                              <'0', '1', '0x0303', ~tid, '0', 
                                                                               $cipher_suites, '0', 
                                                                               <'43', '0x0304'>, 
                                                                               <'10', $g1, $g>, 
                                                                               <'40', $g1, $g1^~x>, 
                                                                               <'45', '0', '1'>, <'42', '0'>, 
                                                                               '41', 
                                                                               <p_psk_id, 
                                                                                mask(ticket_age_add,
                                                                                     $ticket_age)
                                                                               >, 
                                                                               hmac(<
                                                                                     Expand(Expand(Extract(Expand(ms,
                                                                                                                  <
                                                                                                                   'rms', 
                                                                                                                   h(messages)
                                                                                                                  >,
                                                                                                                  '32'),
                                                                                                           '0'),
                                                                                                   <'res', 
                                                                                                    'pbk'>,
                                                                                                   '32'),
                                                                                            <'0', '0'>,
                                                                                            '32'), 
                                                                                     h(<'0', '1', '0x0303', 
                                                                                        ~tid, '0', 
                                                                                        $cipher_suites, '0', 
                                                                                        <'43', '0x0304'>, 
                                                                                        <'10', $g1, $g>, 
                                                                                        <'40', $g1, $g1^~x>, 
                                                                                        <'45', '0', '1'>, 
                                                                                        <'42', '0'>, '41', 
                                                                                        <p_psk_id, 
                                                                                         mask(ticket_age_add,
                                                                                              $ticket_age)
                                                                                        >, 
                                                                                        '0'>)
                                                                                    >)
                                                                              >, 
                                                                              '6', '0x0303', '40', $g>, 
                                                                             '1', '0x0303', ~new_nc, '0', 
                                                                             $cipher_suites.1, '0', 
                                                                             <'43', '0x0304'>, 
                                                                             <'10', $g1, $g>, 
                                                                             <'40', $g, $g^~x.1>, 
                                                                             <'45', '0', '1'>, '0', '41', 
                                                                             <p_psk_id, 
                                                                              mask(ticket_age_add, '1')>, 
                                                                             '0'>)
                                                                         >)
                                                                   >, 
                                                                   '2', '0x0303', p_ns, $cipher_suite, 
                                                                   <'13', $sig_algs>, '40', $g, p_gy>, 
                                                                  '8', $exts>, 
                                                                 '11', '0', pk(~ltkS)>, 
                                                                '15', 
                                                                sign(<'server_cv', 
                                                                      h(<
                                                                         <
                                                                          <
                                                                           <
                                                                            <
                                                                             <'0', '1', '0x0303', ~tid, '0', 
                                                                              $cipher_suites, '0', 
                                                                              <'43', '0x0304'>, 
                                                                              <'10', $g1, $g>, 
                                                                              <'40', $g1, $g1^~x>, 
                                                                              <'45', '0', '1'>, <'42', '0'>, 
                                                                              '41', 
                                                                              <p_psk_id, 
                                                                               mask(ticket_age_add,
                                                                                    $ticket_age)
                                                                              >, 
                                                                              hmac(<
                                                                                    Expand(Expand(Extract(Expand(ms,
                                                                                                                 <
                                                                                                                  'rms', 
                                                                                                                  h(messages)
                                                                                                                 >,
                                                                                                                 '32'),
                                                                                                          '0'),
                                                                                                  <'res', 
                                                                                                   'pbk'>,
                                                                                                  '32'),
                                                                                           <'0', '0'>, '32'), 
                                                                                    h(<'0', '1', '0x0303', 
                                                                                       ~tid, '0', 
                                                                                       $cipher_suites, '0', 
                                                                                       <'43', '0x0304'>, 
                                                                                       <'10', $g1, $g>, 
                                                                                       <'40', $g1, $g1^~x>, 
                                                                                       <'45', '0', '1'>, 
                                                                                       <'42', '0'>, '41', 
                                                                                       <p_psk_id, 
                                                                                        mask(ticket_age_add,
                                                                                             $ticket_age)
                                                                                       >, 
                                                                                       '0'>)
                                                                                   >)
                                                                             >, 
                                                                             '6', '0x0303', '40', $g>, 
                                                                            '1', '0x0303', ~new_nc, '0', 
                                                                            $cipher_suites.1, '0', 
                                                                            <'43', '0x0304'>, 
                                                                            <'10', $g1, $g>, 
                                                                            <'40', $g, $g^~x.1>, 
                                                                            <'45', '0', '1'>, '0', '41', 
                                                                            <p_psk_id, 
                                                                             mask(ticket_age_add, '1')>, 
                                                                            hmac(<
                                                                                  Expand(Expand(Extract(Expand(ms,
                                                                                                               <
                                                                                                                'rms', 
                                                                                                                h(messages)
                                                                                                               >,
                                                                                                               '32'),
                                                                                                        '0'),
                                                                                                <'res', 'pbk'
                                                                                                >,
                                                                                                '32'),
                                                                                         <'0', '0'>, '32'), 
                                                                                  h(<
                                                                                     <
                                                                                      <'0', '1', '0x0303', 
                                                                                       ~tid, '0', 
                                                                                       $cipher_suites, '0', 
                                                                                       <'43', '0x0304'>, 
                                                                                       <'10', $g1, $g>, 
                                                                                       <'40', $g1, $g1^~x>, 
                                                                                       <'45', '0', '1'>, 
                                                                                       <'42', '0'>, '41', 
                                                                                       <p_psk_id, 
                                                                                        mask(ticket_age_add,
                                                                                             $ticket_age)
                                                                                       >, 
                                                                                       hmac(<
                                                                                             Expand(Expand(Extract(Expand(ms,
                                                                                                                          <
                                                                                                                           'rms', 
                                                                                                                           h(messages)
                                                                                                                          >,
                                                                                                                          '32'),
                                                                                                                   '0'),
                                                                                                           <
                                                                                                            'res', 
                                                                                                            'pbk'
                                                                                                           >,
                                                                                                           '32'),
                                                                                                    <'0', '0'
                                                                                                    >,
                                                                                                    '32'), 
                                                                                             h(<'0', '1', 
                                                                                                '0x0303', 
                                                                                                ~tid, '0', 
                                                                                                $cipher_suites, 
                                                                                                '0', 
                                                                                                <'43', 
                                                                                                 '0x0304'>, 
                                                                                                <'10', $g1, $g
                                                                                                >, 
                                                                                                <'40', $g1, 
                                                                                                 $g1^~x>, 
                                                                                                <'45', '0', 
                                                                                                 '1'>, 
                                                                                                <'42', '0'>, 
                                                                                                '41', 
                                                                                                <p_psk_id, 
                                                                                                 mask(ticket_age_add,
                                                                                                      $ticket_age)
                                                                                                >, 
                                                                                                '0'>)
                                                                                            >)
                                                                                      >, 
                                                                                      '6', '0x0303', '40', $g
                                                                                     >, 
                                                                                     '1', '0x0303', ~new_nc, 
                                                                                     '0', $cipher_suites.1, 
                                                                                     '0', <'43', '0x0304'>, 
                                                                                     <'10', $g1, $g>, 
                                                                                     <'40', $g, $g^~x.1>, 
                                                                                     <'45', '0', '1'>, '0', 
                                                                                     '41', 
                                                                                     <p_psk_id, 
                                                                                      mask(ticket_age_add,
                                                                                           '1')
                                                                                     >, 
                                                                                     '0'>)
                                                                                 >)
                                                                           >, 
                                                                           '2', '0x0303', p_ns, 
                                                                           $cipher_suite, <'13', $sig_algs>, 
                                                                           '40', $g, p_gy>, 
                                                                          '8', $exts>, 
                                                                         '11', '0', pk(~ltkS)>)
                                                                     >,
                                                                     ~ltkS)
                                                               >)
                                                            >,
                                                            '32'),
                                                     <'fin', '0'>, '32'), 
                                              h(<
                                                 <
                                                  <
                                                   <
                                                    <
                                                     <
                                                      <'0', '1', '0x0303', ~tid, '0', $cipher_suites, '0', 
                                                       <'43', '0x0304'>, <'10', $g1, $g>, 
                                                       <'40', $g1, $g1^~x>, <'45', '0', '1'>, <'42', '0'>, 
                                                       '41', <p_psk_id, mask(ticket_age_add, $ticket_age)>, 
                                                       hmac(<
                                                             Expand(Expand(Extract(Expand(ms,
                                                                                          <'rms', h(messages)
                                                                                          >,
                                                                                          '32'),
                                                                                   '0'),
                                                                           <'res', 'pbk'>, '32'),
                                                                    <'0', '0'>, '32'), 
                                                             h(<'0', '1', '0x0303', ~tid, '0', 
                                                                $cipher_suites, '0', <'43', '0x0304'>, 
                                                                <'10', $g1, $g>, <'40', $g1, $g1^~x>, 
                                                                <'45', '0', '1'>, <'42', '0'>, '41', 
                                                                <p_psk_id, mask(ticket_age_add, $ticket_age)
                                                                >, 
                                                                '0'>)
                                                            >)
                                                      >, 
                                                      '6', '0x0303', '40', $g>, 
                                                     '1', '0x0303', ~new_nc, '0', $cipher_suites.1, '0', 
                                                     <'43', '0x0304'>, <'10', $g1, $g>, <'40', $g, $g^~x.1>, 
                                                     <'45', '0', '1'>, '0', '41', 
                                                     <p_psk_id, mask(ticket_age_add, '1')>, 
                                                     hmac(<
                                                           Expand(Expand(Extract(Expand(ms,
                                                                                        <'rms', h(messages)>,
                                                                                        '32'),
                                                                                 '0'),
                                                                         <'res', 'pbk'>, '32'),
                                                                  <'0', '0'>, '32'), 
                                                           h(<
                                                              <
                                                               <'0', '1', '0x0303', ~tid, '0', 
                                                                $cipher_suites, '0', <'43', '0x0304'>, 
                                                                <'10', $g1, $g>, <'40', $g1, $g1^~x>, 
                                                                <'45', '0', '1'>, <'42', '0'>, '41', 
                                                                <p_psk_id, mask(ticket_age_add, $ticket_age)
                                                                >, 
                                                                hmac(<
                                                                      Expand(Expand(Extract(Expand(ms,
                                                                                                   <'rms', 
                                                                                                    h(messages)
                                                                                                   >,
                                                                                                   '32'),
                                                                                            '0'),
                                                                                    <'res', 'pbk'>, '32'),
                                                                             <'0', '0'>, '32'), 
                                                                      h(<'0', '1', '0x0303', ~tid, '0', 
                                                                         $cipher_suites, '0', 
                                                                         <'43', '0x0304'>, <'10', $g1, $g>, 
                                                                         <'40', $g1, $g1^~x>, 
                                                                         <'45', '0', '1'>, <'42', '0'>, '41', 
                                                                         <p_psk_id, 
                                                                          mask(ticket_age_add, $ticket_age)>, 
                                                                         '0'>)
                                                                     >)
                                                               >, 
                                                               '6', '0x0303', '40', $g>, 
                                                              '1', '0x0303', ~new_nc, '0', $cipher_suites.1, 
                                                              '0', <'43', '0x0304'>, <'10', $g1, $g>, 
                                                              <'40', $g, $g^~x.1>, <'45', '0', '1'>, '0', 
                                                              '41', <p_psk_id, mask(ticket_age_add, '1')>, '0'
                                                             >)
                                                          >)
                                                    >, 
                                                    '2', '0x0303', p_ns, $cipher_suite, <'13', $sig_algs>, 
                                                    '40', $g, p_gy>, 
                                                   '8', $exts>, 
                                                  '11', '0', pk(~ltkS)>, 
                                                 '15', 
                                                 sign(<'server_cv', 
                                                       h(<
                                                          <
                                                           <
                                                            <
                                                             <
                                                              <'0', '1', '0x0303', ~tid, '0', $cipher_suites, 
                                                               '0', <'43', '0x0304'>, <'10', $g1, $g>, 
                                                               <'40', $g1, $g1^~x>, <'45', '0', '1'>, 
                                                               <'42', '0'>, '41', 
                                                               <p_psk_id, mask(ticket_age_add, $ticket_age)>, 
                                                               hmac(<
                                                                     Expand(Expand(Extract(Expand(ms,
                                                                                                  <'rms', 
                                                                                                   h(messages)
                                                                                                  >,
                                                                                                  '32'),
                                                                                           '0'),
                                                                                   <'res', 'pbk'>, '32'),
                                                                            <'0', '0'>, '32'), 
                                                                     h(<'0', '1', '0x0303', ~tid, '0', 
                                                                        $cipher_suites, '0', 
                                                                        <'43', '0x0304'>, <'10', $g1, $g>, 
                                                                        <'40', $g1, $g1^~x>, 
                                                                        <'45', '0', '1'>, <'42', '0'>, '41', 
                                                                        <p_psk_id, 
                                                                         mask(ticket_age_add, $ticket_age)>, 
                                                                        '0'>)
                                                                    >)
                                                              >, 
                                                              '6', '0x0303', '40', $g>, 
                                                             '1', '0x0303', ~new_nc, '0', $cipher_suites.1, 
                                                             '0', <'43', '0x0304'>, <'10', $g1, $g>, 
                                                             <'40', $g, $g^~x.1>, <'45', '0', '1'>, '0', 
                                                             '41', <p_psk_id, mask(ticket_age_add, '1')>, 
                                                             hmac(<
                                                                   Expand(Expand(Extract(Expand(ms,
                                                                                                <'rms', 
                                                                                                 h(messages)>,
                                                                                                '32'),
                                                                                         '0'),
                                                                                 <'res', 'pbk'>, '32'),
                                                                          <'0', '0'>, '32'), 
                                                                   h(<
                                                                      <
                                                                       <'0', '1', '0x0303', ~tid, '0', 
                                                                        $cipher_suites, '0', 
                                                                        <'43', '0x0304'>, <'10', $g1, $g>, 
                                                                        <'40', $g1, $g1^~x>, 
                                                                        <'45', '0', '1'>, <'42', '0'>, '41', 
                                                                        <p_psk_id, 
                                                                         mask(ticket_age_add, $ticket_age)>, 
                                                                        hmac(<
                                                                              Expand(Expand(Extract(Expand(ms,
                                                                                                           <
                                                                                                            'rms', 
                                                                                                            h(messages)
                                                                                                           >,
                                                                                                           '32'),
                                                                                                    '0'),
                                                                                            <'res', 'pbk'>,
                                                                                            '32'),
                                                                                     <'0', '0'>, '32'), 
                                                                              h(<'0', '1', '0x0303', ~tid, 
                                                                                 '0', $cipher_suites, '0', 
                                                                                 <'43', '0x0304'>, 
                                                                                 <'10', $g1, $g>, 
                                                                                 <'40', $g1, $g1^~x>, 
                                                                                 <'45', '0', '1'>, 
                                                                                 <'42', '0'>, '41', 
                                                                                 <p_psk_id, 
                                                                                  mask(ticket_age_add,
                                                                                       $ticket_age)
                                                                                 >, 
                                                                                 '0'>)
                                                                             >)
                                                                       >, 
                                                                       '6', '0x0303', '40', $g>, 
                                                                      '1', '0x0303', ~new_nc, '0', 
                                                                      $cipher_suites.1, '0', 
                                                                      <'43', '0x0304'>, <'10', $g1, $g>, 
                                                                      <'40', $g, $g^~x.1>, <'45', '0', '1'>, 
                                                                      '0', '41', 
                                                                      <p_psk_id, mask(ticket_age_add, '1')>, 
                                                                      '0'>)
                                                                  >)
                                                            >, 
                                                            '2', '0x0303', p_ns, $cipher_suite, 
                                                            <'13', $sig_algs>, '40', $g, p_gy>, 
                                                           '8', $exts>, 
                                                          '11', '0', pk(~ltkS)>)
                                                      >,
                                                      ~ltkS)
                                                >)
                                             >)
                                       >)
                                    >,
                                    '32')
                  ) ▶₀ #l )
      qed
    next
      case recv_server_auth_case_09
      by contradiction /* from formulas */
    next
      case recv_server_auth_case_10
      by contradiction /* from formulas */
    next
      case recv_server_auth_case_11
      by contradiction /* from formulas */
    next
      case recv_server_auth_case_12
      by contradiction /* from formulas */
    next
      case recv_server_auth_case_13
      by contradiction /* from formulas */
    next
      case recv_server_auth_case_14
      by contradiction /* from formulas */
    next
      case recv_server_auth_case_15
      by contradiction /* from formulas */
    next
      case recv_server_auth_case_16
      by contradiction /* from formulas */
    next
      case recv_server_auth_psk_case_1
      solve( (∃ #j.2.
               (!KU( Extract('0',
                             Extract(p_gxy, Extract(Expand(ms, <'rms', h(messages)>, '32'), '0')))
                ) @ #j.2)
              ∧
               #j.2 < #j.1)  ∥
             ((∀ #k.
                (!KU( Extract('0',
                              Extract(p_gxy, Extract(Expand(ms, <'rms', h(messages)>, '32'), '0')))
                 ) @ #k)
               ⇒
                ¬(#k < #j.1)) ∧
              (∃ actor #l.
                (RevealPSK( actor,
                            Expand(Extract('0',
                                           Extract(p_gxy,
                                                   Extract(Expand(ms, <'rms', h(messages)>, '32'), '0'))),
                                   <'serverats', 
                                    h(<
                                       <
                                        <
                                         <'0', '1', '0x0303', ~tid, '0', $cipher_suites, '0', 
                                          <'43', '0x0304'>, <'10', $g, $g2>, <'40', $g, $g^~x>, 
                                          <'45', '0', '1'>, <'42', '0'>, '41', 
                                          <~ticket, mask(ticket_age_add, $ticket_age)>, 
                                          hmac(<
                                                Expand(Expand(Extract(Expand(ms, <'rms', h(messages)>, '32'),
                                                                      '0'),
                                                              <'res', 'pbk'>, '32'),
                                                       <'0', '0'>, '32'), 
                                                h(<'0', '1', '0x0303', ~tid, '0', $cipher_suites, '0', 
                                                   <'43', '0x0304'>, <'10', $g, $g2>, <'40', $g, $g^~x>, 
                                                   <'45', '0', '1'>, <'42', '0'>, '41', 
                                                   <~ticket, mask(ticket_age_add, $ticket_age)>, '0'>)
                                               >)
                                         >, 
                                         '2', '0x0303', p_ns, $cipher_suite, <'13', $sig_algs>, 
                                         <'40', $g, p_gy>, <'41', '0'>, '42', '0'>, 
                                        '8', $exts>, 
                                       '20', 
                                       hmac(<
                                             Expand(Expand(Extract(p_gxy,
                                                                   Extract(Expand(ms, <'rms', h(messages)>,
                                                                                  '32'),
                                                                           '0')),
                                                           <'serverhts', 
                                                            h(<
                                                               <
                                                                <'0', '1', '0x0303', ~tid, '0', 
                                                                 $cipher_suites, '0', <'43', '0x0304'>, 
                                                                 <'10', $g, $g2>, <'40', $g, $g^~x>, 
                                                                 <'45', '0', '1'>, <'42', '0'>, '41', 
                                                                 <~ticket, mask(ticket_age_add, $ticket_age)
                                                                 >, 
                                                                 hmac(<
                                                                       Expand(Expand(Extract(Expand(ms,
                                                                                                    <'rms', 
                                                                                                     h(messages)
                                                                                                    >,
                                                                                                    '32'),
                                                                                             '0'),
                                                                                     <'res', 'pbk'>, '32'),
                                                                              <'0', '0'>, '32'), 
                                                                       h(<'0', '1', '0x0303', ~tid, '0', 
                                                                          $cipher_suites, '0', 
                                                                          <'43', '0x0304'>, <'10', $g, $g2>, 
                                                                          <'40', $g, $g^~x>, 
                                                                          <'45', '0', '1'>, <'42', '0'>, 
                                                                          '41', 
                                                                          <~ticket, 
                                                                           mask(ticket_age_add, $ticket_age)
                                                                          >, 
                                                                          '0'>)
                                                                      >)
                                                                >, 
                                                                '2', '0x0303', p_ns, $cipher_suite, 
                                                                <'13', $sig_algs>, <'40', $g, p_gy>, 
                                                                <'41', '0'>, '42', '0'>, 
                                                               '8', $exts>)
                                                           >,
                                                           '32'),
                                                    <'fin', '0'>, '32'), 
                                             h(<
                                                <
                                                 <'0', '1', '0x0303', ~tid, '0', $cipher_suites, '0', 
                                                  <'43', '0x0304'>, <'10', $g, $g2>, <'40', $g, $g^~x>, 
                                                  <'45', '0', '1'>, <'42', '0'>, '41', 
                                                  <~ticket, mask(ticket_age_add, $ticket_age)>, 
                                                  hmac(<
                                                        Expand(Expand(Extract(Expand(ms, <'rms', h(messages)>,
                                                                                     '32'),
                                                                              '0'),
                                                                      <'res', 'pbk'>, '32'),
                                                               <'0', '0'>, '32'), 
                                                        h(<'0', '1', '0x0303', ~tid, '0', $cipher_suites, 
                                                           '0', <'43', '0x0304'>, <'10', $g, $g2>, 
                                                           <'40', $g, $g^~x>, <'45', '0', '1'>, <'42', '0'>, 
                                                           '41', 
                                                           <~ticket, mask(ticket_age_add, $ticket_age)>, '0'>)
                                                       >)
                                                 >, 
                                                 '2', '0x0303', p_ns, $cipher_suite, <'13', $sig_algs>, 
                                                 <'40', $g, p_gy>, <'41', '0'>, '42', '0'>, 
                                                '8', $exts>)
                                            >)
                                      >)
                                   >,
                                   '32')
                 ) @ #l)
               ∧
                #l < #j.1)) )
        case case_1
        solve( (∃ #r. (RevLtk( $S ) @ #r) ∧ #r < #vr)  ∥
               (∃ tid3 x #r. (RevDHExp( tid3, $S, x ) @ #r) ∧ #r < #vr)  ∥
               (∃ tid4 y #r. (RevDHExp( tid4, $C, y ) @ #r) ∧ #r < #vr)  ∥
               (∃ rms #r. (RevealPSK( $C, rms ) @ #r) ∧ #r < #k.1)  ∥
               (∃ rms #r. (RevealPSK( $S, rms ) @ #r) ∧ #r < #k.1) )
          case case_1
          by contradiction /* from formulas */
        next
          case case_2
          by contradiction /* from formulas */
        next
          case case_3
          by contradiction /* from formulas */
        next
          case case_4
          by contradiction /* from formulas */
        next
          case case_5
          by contradiction /* from formulas */
        qed
      next
        case case_2
        by solve( SecretPSK( $A,
                             Expand(Extract('0',
                                            Extract(p_gxy,
                                                    Extract(Expand(ms, <'rms', h(messages)>, '32'), '0'))),
                                    <'serverats', 
                                     h(<
                                        <
                                         <
                                          <'0', '1', '0x0303', ~tid, '0', $cipher_suites, '0', 
                                           <'43', '0x0304'>, <'10', $g, $g2>, <'40', $g, $g^~x>, 
                                           <'45', '0', '1'>, <'42', '0'>, '41', 
                                           <~ticket, mask(ticket_age_add, $ticket_age)>, 
                                           hmac(<
                                                 Expand(Expand(Extract(Expand(ms, <'rms', h(messages)>, '32'),
                                                                       '0'),
                                                               <'res', 'pbk'>, '32'),
                                                        <'0', '0'>, '32'), 
                                                 h(<'0', '1', '0x0303', ~tid, '0', $cipher_suites, '0', 
                                                    <'43', '0x0304'>, <'10', $g, $g2>, <'40', $g, $g^~x>, 
                                                    <'45', '0', '1'>, <'42', '0'>, '41', 
                                                    <~ticket, mask(ticket_age_add, $ticket_age)>, '0'>)
                                                >)
                                          >, 
                                          '2', '0x0303', p_ns, $cipher_suite, <'13', $sig_algs>, 
                                          <'40', $g, p_gy>, <'41', '0'>, '42', '0'>, 
                                         '8', $exts>, 
                                        '20', 
                                        hmac(<
                                              Expand(Expand(Extract(p_gxy,
                                                                    Extract(Expand(ms, <'rms', h(messages)>,
                                                                                   '32'),
                                                                            '0')),
                                                            <'serverhts', 
                                                             h(<
                                                                <
                                                                 <'0', '1', '0x0303', ~tid, '0', 
                                                                  $cipher_suites, '0', <'43', '0x0304'>, 
                                                                  <'10', $g, $g2>, <'40', $g, $g^~x>, 
                                                                  <'45', '0', '1'>, <'42', '0'>, '41', 
                                                                  <~ticket, mask(ticket_age_add, $ticket_age)
                                                                  >, 
                                                                  hmac(<
                                                                        Expand(Expand(Extract(Expand(ms,
                                                                                                     <'rms', 
                                                                                                      h(messages)
                                                                                                     >,
                                                                                                     '32'),
                                                                                              '0'),
                                                                                      <'res', 'pbk'>, '32'),
                                                                               <'0', '0'>, '32'), 
                                                                        h(<'0', '1', '0x0303', ~tid, '0', 
                                                                           $cipher_suites, '0', 
                                                                           <'43', '0x0304'>, <'10', $g, $g2>, 
                                                                           <'40', $g, $g^~x>, 
                                                                           <'45', '0', '1'>, <'42', '0'>, 
                                                                           '41', 
                                                                           <~ticket, 
                                                                            mask(ticket_age_add, $ticket_age)
                                                                           >, 
                                                                           '0'>)
                                                                       >)
                                                                 >, 
                                                                 '2', '0x0303', p_ns, $cipher_suite, 
                                                                 <'13', $sig_algs>, <'40', $g, p_gy>, 
                                                                 <'41', '0'>, '42', '0'>, 
                                                                '8', $exts>)
                                                            >,
                                                            '32'),
                                                     <'fin', '0'>, '32'), 
                                              h(<
                                                 <
                                                  <'0', '1', '0x0303', ~tid, '0', $cipher_suites, '0', 
                                                   <'43', '0x0304'>, <'10', $g, $g2>, <'40', $g, $g^~x>, 
                                                   <'45', '0', '1'>, <'42', '0'>, '41', 
                                                   <~ticket, mask(ticket_age_add, $ticket_age)>, 
                                                   hmac(<
                                                         Expand(Expand(Extract(Expand(ms,
                                                                                      <'rms', h(messages)>,
                                                                                      '32'),
                                                                               '0'),
                                                                       <'res', 'pbk'>, '32'),
                                                                <'0', '0'>, '32'), 
                                                         h(<'0', '1', '0x0303', ~tid, '0', $cipher_suites, 
                                                            '0', <'43', '0x0304'>, <'10', $g, $g2>, 
                                                            <'40', $g, $g^~x>, <'45', '0', '1'>, <'42', '0'>, 
                                                            '41', 
                                                            <~ticket, mask(ticket_age_add, $ticket_age)>, '0'
                                                           >)
                                                        >)
                                                  >, 
                                                  '2', '0x0303', p_ns, $cipher_suite, <'13', $sig_algs>, 
                                                  <'40', $g, p_gy>, <'41', '0'>, '42', '0'>, 
                                                 '8', $exts>)
                                             >)
                                       >)
                                    >,
                                    '32')
                  ) ▶₀ #l )
      qed
    next
      case recv_server_auth_psk_case_2
      solve( (∃ #j.2.
               (!KU( Extract('0',
                             Extract(p_gxy, Extract(Expand(ms, <'rms', h(messages)>, '32'), '0')))
                ) @ #j.2)
              ∧
               #j.2 < #j.1)  ∥
             ((∀ #k.
                (!KU( Extract('0',
                              Extract(p_gxy, Extract(Expand(ms, <'rms', h(messages)>, '32'), '0')))
                 ) @ #k)
               ⇒
                ¬(#k < #j.1)) ∧
              (∃ actor #l.
                (RevealPSK( actor,
                            Expand(Extract('0',
                                           Extract(p_gxy,
                                                   Extract(Expand(ms, <'rms', h(messages)>, '32'), '0'))),
                                   <'serverats', 
                                    h(<
                                       <
                                        <
                                         <
                                          <
                                           <'0', '1', '0x0303', ~tid, '0', $cipher_suites, '0', 
                                            <'43', '0x0304'>, <'10', $g1, $g>, <'40', $g1, $g1^~x>, 
                                            <'45', '0', '1'>, <'42', '0'>, '41', 
                                            <~ticket, mask(ticket_age_add, $ticket_age)>, 
                                            hmac(<
                                                  Expand(Expand(Extract(Expand(ms, <'rms', h(messages)>,
                                                                               '32'),
                                                                        '0'),
                                                                <'res', 'pbk'>, '32'),
                                                         <'0', '0'>, '32'), 
                                                  h(<'0', '1', '0x0303', ~tid, '0', $cipher_suites, '0', 
                                                     <'43', '0x0304'>, <'10', $g1, $g>, <'40', $g1, $g1^~x>, 
                                                     <'45', '0', '1'>, <'42', '0'>, '41', 
                                                     <~ticket, mask(ticket_age_add, $ticket_age)>, '0'>)
                                                 >)
                                           >, 
                                           '6', '0x0303', '40', $g>, 
                                          '1', '0x0303', ~new_nc, '0', $cipher_suites.1, '0', 
                                          <'43', '0x0304'>, <'10', $g1, $g>, <'40', $g, $g^~x.1>, 
                                          <'45', '0', '1'>, '0', '41', <~ticket, mask(ticket_age_add, '1')>, 
                                          hmac(<
                                                Expand(Expand(Extract(Expand(ms, <'rms', h(messages)>, '32'),
                                                                      '0'),
                                                              <'res', 'pbk'>, '32'),
                                                       <'0', '0'>, '32'), 
                                                h(<
                                                   <
                                                    <'0', '1', '0x0303', ~tid, '0', $cipher_suites, '0', 
                                                     <'43', '0x0304'>, <'10', $g1, $g>, <'40', $g1, $g1^~x>, 
                                                     <'45', '0', '1'>, <'42', '0'>, '41', 
                                                     <~ticket, mask(ticket_age_add, $ticket_age)>, 
                                                     hmac(<
                                                           Expand(Expand(Extract(Expand(ms,
                                                                                        <'rms', h(messages)>,
                                                                                        '32'),
                                                                                 '0'),
                                                                         <'res', 'pbk'>, '32'),
                                                                  <'0', '0'>, '32'), 
                                                           h(<'0', '1', '0x0303', ~tid, '0', $cipher_suites, 
                                                              '0', <'43', '0x0304'>, <'10', $g1, $g>, 
                                                              <'40', $g1, $g1^~x>, <'45', '0', '1'>, 
                                                              <'42', '0'>, '41', 
                                                              <~ticket, mask(ticket_age_add, $ticket_age)>, 
                                                              '0'>)
                                                          >)
                                                    >, 
                                                    '6', '0x0303', '40', $g>, 
                                                   '1', '0x0303', ~new_nc, '0', $cipher_suites.1, '0', 
                                                   <'43', '0x0304'>, <'10', $g1, $g>, <'40', $g, $g^~x.1>, 
                                                   <'45', '0', '1'>, '0', '41', 
                                                   <~ticket, mask(ticket_age_add, '1')>, '0'>)
                                               >)
                                         >, 
                                         '2', '0x0303', p_ns, $cipher_suite, <'13', $sig_algs>, 
                                         <'40', $g, p_gy>, <'41', '0'>, '0'>, 
                                        '8', $exts>, 
                                       '20', 
                                       hmac(<
                                             Expand(Expand(Extract(p_gxy,
                                                                   Extract(Expand(ms, <'rms', h(messages)>,
                                                                                  '32'),
                                                                           '0')),
                                                           <'serverhts', 
                                                            h(<
                                                               <
                                                                <
                                                                 <
                                                                  <'0', '1', '0x0303', ~tid, '0', 
                                                                   $cipher_suites, '0', <'43', '0x0304'>, 
                                                                   <'10', $g1, $g>, <'40', $g1, $g1^~x>, 
                                                                   <'45', '0', '1'>, <'42', '0'>, '41', 
                                                                   <~ticket, mask(ticket_age_add, $ticket_age)
                                                                   >, 
                                                                   hmac(<
                                                                         Expand(Expand(Extract(Expand(ms,
                                                                                                      <'rms', 
                                                                                                       h(messages)
                                                                                                      >,
                                                                                                      '32'),
                                                                                               '0'),
                                                                                       <'res', 'pbk'>, '32'),
                                                                                <'0', '0'>, '32'), 
                                                                         h(<'0', '1', '0x0303', ~tid, '0', 
                                                                            $cipher_suites, '0', 
                                                                            <'43', '0x0304'>, 
                                                                            <'10', $g1, $g>, 
                                                                            <'40', $g1, $g1^~x>, 
                                                                            <'45', '0', '1'>, <'42', '0'>, 
                                                                            '41', 
                                                                            <~ticket, 
                                                                             mask(ticket_age_add, $ticket_age)
                                                                            >, 
                                                                            '0'>)
                                                                        >)
                                                                  >, 
                                                                  '6', '0x0303', '40', $g>, 
                                                                 '1', '0x0303', ~new_nc, '0', 
                                                                 $cipher_suites.1, '0', <'43', '0x0304'>, 
                                                                 <'10', $g1, $g>, <'40', $g, $g^~x.1>, 
                                                                 <'45', '0', '1'>, '0', '41', 
                                                                 <~ticket, mask(ticket_age_add, '1')>, 
                                                                 hmac(<
                                                                       Expand(Expand(Extract(Expand(ms,
                                                                                                    <'rms', 
                                                                                                     h(messages)
                                                                                                    >,
                                                                                                    '32'),
                                                                                             '0'),
                                                                                     <'res', 'pbk'>, '32'),
                                                                              <'0', '0'>, '32'), 
                                                                       h(<
                                                                          <
                                                                           <'0', '1', '0x0303', ~tid, '0', 
                                                                            $cipher_suites, '0', 
                                                                            <'43', '0x0304'>, 
                                                                            <'10', $g1, $g>, 
                                                                            <'40', $g1, $g1^~x>, 
                                                                            <'45', '0', '1'>, <'42', '0'>, 
                                                                            '41', 
                                                                            <~ticket, 
                                                                             mask(ticket_age_add, $ticket_age)
                                                                            >, 
                                                                            hmac(<
                                                                                  Expand(Expand(Extract(Expand(ms,
                                                                                                               <
                                                                                                                'rms', 
                                                                                                                h(messages)
                                                                                                               >,
                                                                                                               '32'),
                                                                                                        '0'),
                                                                                                <'res', 'pbk'
                                                                                                >,
                                                                                                '32'),
                                                                                         <'0', '0'>, '32'), 
                                                                                  h(<'0', '1', '0x0303', 
                                                                                     ~tid, '0', 
                                                                                     $cipher_suites, '0', 
                                                                                     <'43', '0x0304'>, 
                                                                                     <'10', $g1, $g>, 
                                                                                     <'40', $g1, $g1^~x>, 
                                                                                     <'45', '0', '1'>, 
                                                                                     <'42', '0'>, '41', 
                                                                                     <~ticket, 
                                                                                      mask(ticket_age_add,
                                                                                           $ticket_age)
                                                                                     >, 
                                                                                     '0'>)
                                                                                 >)
                                                                           >, 
                                                                           '6', '0x0303', '40', $g>, 
                                                                          '1', '0x0303', ~new_nc, '0', 
                                                                          $cipher_suites.1, '0', 
                                                                          <'43', '0x0304'>, <'10', $g1, $g>, 
                                                                          <'40', $g, $g^~x.1>, 
                                                                          <'45', '0', '1'>, '0', '41', 
                                                                          <~ticket, mask(ticket_age_add, '1')
                                                                          >, 
                                                                          '0'>)
                                                                      >)
                                                                >, 
                                                                '2', '0x0303', p_ns, $cipher_suite, 
                                                                <'13', $sig_algs>, <'40', $g, p_gy>, 
                                                                <'41', '0'>, '0'>, 
                                                               '8', $exts>)
                                                           >,
                                                           '32'),
                                                    <'fin', '0'>, '32'), 
                                             h(<
                                                <
                                                 <
                                                  <
                                                   <'0', '1', '0x0303', ~tid, '0', $cipher_suites, '0', 
                                                    <'43', '0x0304'>, <'10', $g1, $g>, <'40', $g1, $g1^~x>, 
                                                    <'45', '0', '1'>, <'42', '0'>, '41', 
                                                    <~ticket, mask(ticket_age_add, $ticket_age)>, 
                                                    hmac(<
                                                          Expand(Expand(Extract(Expand(ms,
                                                                                       <'rms', h(messages)>,
                                                                                       '32'),
                                                                                '0'),
                                                                        <'res', 'pbk'>, '32'),
                                                                 <'0', '0'>, '32'), 
                                                          h(<'0', '1', '0x0303', ~tid, '0', $cipher_suites, 
                                                             '0', <'43', '0x0304'>, <'10', $g1, $g>, 
                                                             <'40', $g1, $g1^~x>, <'45', '0', '1'>, 
                                                             <'42', '0'>, '41', 
                                                             <~ticket, mask(ticket_age_add, $ticket_age)>, '0'
                                                            >)
                                                         >)
                                                   >, 
                                                   '6', '0x0303', '40', $g>, 
                                                  '1', '0x0303', ~new_nc, '0', $cipher_suites.1, '0', 
                                                  <'43', '0x0304'>, <'10', $g1, $g>, <'40', $g, $g^~x.1>, 
                                                  <'45', '0', '1'>, '0', '41', 
                                                  <~ticket, mask(ticket_age_add, '1')>, 
                                                  hmac(<
                                                        Expand(Expand(Extract(Expand(ms, <'rms', h(messages)>,
                                                                                     '32'),
                                                                              '0'),
                                                                      <'res', 'pbk'>, '32'),
                                                               <'0', '0'>, '32'), 
                                                        h(<
                                                           <
                                                            <'0', '1', '0x0303', ~tid, '0', $cipher_suites, 
                                                             '0', <'43', '0x0304'>, <'10', $g1, $g>, 
                                                             <'40', $g1, $g1^~x>, <'45', '0', '1'>, 
                                                             <'42', '0'>, '41', 
                                                             <~ticket, mask(ticket_age_add, $ticket_age)>, 
                                                             hmac(<
                                                                   Expand(Expand(Extract(Expand(ms,
                                                                                                <'rms', 
                                                                                                 h(messages)>,
                                                                                                '32'),
                                                                                         '0'),
                                                                                 <'res', 'pbk'>, '32'),
                                                                          <'0', '0'>, '32'), 
                                                                   h(<'0', '1', '0x0303', ~tid, '0', 
                                                                      $cipher_suites, '0', <'43', '0x0304'>, 
                                                                      <'10', $g1, $g>, <'40', $g1, $g1^~x>, 
                                                                      <'45', '0', '1'>, <'42', '0'>, '41', 
                                                                      <~ticket, 
                                                                       mask(ticket_age_add, $ticket_age)>, 
                                                                      '0'>)
                                                                  >)
                                                            >, 
                                                            '6', '0x0303', '40', $g>, 
                                                           '1', '0x0303', ~new_nc, '0', $cipher_suites.1, 
                                                           '0', <'43', '0x0304'>, <'10', $g1, $g>, 
                                                           <'40', $g, $g^~x.1>, <'45', '0', '1'>, '0', '41', 
                                                           <~ticket, mask(ticket_age_add, '1')>, '0'>)
                                                       >)
                                                 >, 
                                                 '2', '0x0303', p_ns, $cipher_suite, <'13', $sig_algs>, 
                                                 <'40', $g, p_gy>, <'41', '0'>, '0'>, 
                                                '8', $exts>)
                                            >)
                                      >)
                                   >,
                                   '32')
                 ) @ #l)
               ∧
                #l < #j.1)) )
        case case_1
        solve( (∃ #r. (RevLtk( $S ) @ #r) ∧ #r < #vr)  ∥
               (∃ tid3 x #r. (RevDHExp( tid3, $S, x ) @ #r) ∧ #r < #vr)  ∥
               (∃ tid4 y #r. (RevDHExp( tid4, $C, y ) @ #r) ∧ #r < #vr)  ∥
               (∃ rms #r. (RevealPSK( $C, rms ) @ #r) ∧ #r < #k.1)  ∥
               (∃ rms #r. (RevealPSK( $S, rms ) @ #r) ∧ #r < #k.1) )
          case case_1
          by contradiction /* from formulas */
        next
          case case_2
          by contradiction /* from formulas */
        next
          case case_3
          by contradiction /* from formulas */
        next
          case case_4
          by contradiction /* from formulas */
        next
          case case_5
          by contradiction /* from formulas */
        qed
      next
        case case_2
        by solve( SecretPSK( $A,
                             Expand(Extract('0',
                                            Extract(p_gxy,
                                                    Extract(Expand(ms, <'rms', h(messages)>, '32'), '0'))),
                                    <'serverats', 
                                     h(<
                                        <
                                         <
                                          <
                                           <
                                            <'0', '1', '0x0303', ~tid, '0', $cipher_suites, '0', 
                                             <'43', '0x0304'>, <'10', $g1, $g>, <'40', $g1, $g1^~x>, 
                                             <'45', '0', '1'>, <'42', '0'>, '41', 
                                             <~ticket, mask(ticket_age_add, $ticket_age)>, 
                                             hmac(<
                                                   Expand(Expand(Extract(Expand(ms, <'rms', h(messages)>,
                                                                                '32'),
                                                                         '0'),
                                                                 <'res', 'pbk'>, '32'),
                                                          <'0', '0'>, '32'), 
                                                   h(<'0', '1', '0x0303', ~tid, '0', $cipher_suites, '0', 
                                                      <'43', '0x0304'>, <'10', $g1, $g>, <'40', $g1, $g1^~x>, 
                                                      <'45', '0', '1'>, <'42', '0'>, '41', 
                                                      <~ticket, mask(ticket_age_add, $ticket_age)>, '0'>)
                                                  >)
                                            >, 
                                            '6', '0x0303', '40', $g>, 
                                           '1', '0x0303', ~new_nc, '0', $cipher_suites.1, '0', 
                                           <'43', '0x0304'>, <'10', $g1, $g>, <'40', $g, $g^~x.1>, 
                                           <'45', '0', '1'>, '0', '41', <~ticket, mask(ticket_age_add, '1')>, 
                                           hmac(<
                                                 Expand(Expand(Extract(Expand(ms, <'rms', h(messages)>, '32'),
                                                                       '0'),
                                                               <'res', 'pbk'>, '32'),
                                                        <'0', '0'>, '32'), 
                                                 h(<
                                                    <
                                                     <'0', '1', '0x0303', ~tid, '0', $cipher_suites, '0', 
                                                      <'43', '0x0304'>, <'10', $g1, $g>, <'40', $g1, $g1^~x>, 
                                                      <'45', '0', '1'>, <'42', '0'>, '41', 
                                                      <~ticket, mask(ticket_age_add, $ticket_age)>, 
                                                      hmac(<
                                                            Expand(Expand(Extract(Expand(ms,
                                                                                         <'rms', h(messages)>,
                                                                                         '32'),
                                                                                  '0'),
                                                                          <'res', 'pbk'>, '32'),
                                                                   <'0', '0'>, '32'), 
                                                            h(<'0', '1', '0x0303', ~tid, '0', $cipher_suites, 
                                                               '0', <'43', '0x0304'>, <'10', $g1, $g>, 
                                                               <'40', $g1, $g1^~x>, <'45', '0', '1'>, 
                                                               <'42', '0'>, '41', 
                                                               <~ticket, mask(ticket_age_add, $ticket_age)>, 
                                                               '0'>)
                                                           >)
                                                     >, 
                                                     '6', '0x0303', '40', $g>, 
                                                    '1', '0x0303', ~new_nc, '0', $cipher_suites.1, '0', 
                                                    <'43', '0x0304'>, <'10', $g1, $g>, <'40', $g, $g^~x.1>, 
                                                    <'45', '0', '1'>, '0', '41', 
                                                    <~ticket, mask(ticket_age_add, '1')>, '0'>)
                                                >)
                                          >, 
                                          '2', '0x0303', p_ns, $cipher_suite, <'13', $sig_algs>, 
                                          <'40', $g, p_gy>, <'41', '0'>, '0'>, 
                                         '8', $exts>, 
                                        '20', 
                                        hmac(<
                                              Expand(Expand(Extract(p_gxy,
                                                                    Extract(Expand(ms, <'rms', h(messages)>,
                                                                                   '32'),
                                                                            '0')),
                                                            <'serverhts', 
                                                             h(<
                                                                <
                                                                 <
                                                                  <
                                                                   <'0', '1', '0x0303', ~tid, '0', 
                                                                    $cipher_suites, '0', <'43', '0x0304'>, 
                                                                    <'10', $g1, $g>, <'40', $g1, $g1^~x>, 
                                                                    <'45', '0', '1'>, <'42', '0'>, '41', 
                                                                    <~ticket, 
                                                                     mask(ticket_age_add, $ticket_age)>, 
                                                                    hmac(<
                                                                          Expand(Expand(Extract(Expand(ms,
                                                                                                       <
                                                                                                        'rms', 
                                                                                                        h(messages)
                                                                                                       >,
                                                                                                       '32'),
                                                                                                '0'),
                                                                                        <'res', 'pbk'>, '32'),
                                                                                 <'0', '0'>, '32'), 
                                                                          h(<'0', '1', '0x0303', ~tid, '0', 
                                                                             $cipher_suites, '0', 
                                                                             <'43', '0x0304'>, 
                                                                             <'10', $g1, $g>, 
                                                                             <'40', $g1, $g1^~x>, 
                                                                             <'45', '0', '1'>, <'42', '0'>, 
                                                                             '41', 
                                                                             <~ticket, 
                                                                              mask(ticket_age_add,
                                                                                   $ticket_age)
                                                                             >, 
                                                                             '0'>)
                                                                         >)
                                                                   >, 
                                                                   '6', '0x0303', '40', $g>, 
                                                                  '1', '0x0303', ~new_nc, '0', 
                                                                  $cipher_suites.1, '0', <'43', '0x0304'>, 
                                                                  <'10', $g1, $g>, <'40', $g, $g^~x.1>, 
                                                                  <'45', '0', '1'>, '0', '41', 
                                                                  <~ticket, mask(ticket_age_add, '1')>, 
                                                                  hmac(<
                                                                        Expand(Expand(Extract(Expand(ms,
                                                                                                     <'rms', 
                                                                                                      h(messages)
                                                                                                     >,
                                                                                                     '32'),
                                                                                              '0'),
                                                                                      <'res', 'pbk'>, '32'),
                                                                               <'0', '0'>, '32'), 
                                                                        h(<
                                                                           <
                                                                            <'0', '1', '0x0303', ~tid, '0', 
                                                                             $cipher_suites, '0', 
                                                                             <'43', '0x0304'>, 
                                                                             <'10', $g1, $g>, 
                                                                             <'40', $g1, $g1^~x>, 
                                                                             <'45', '0', '1'>, <'42', '0'>, 
                                                                             '41', 
                                                                             <~ticket, 
                                                                              mask(ticket_age_add,
                                                                                   $ticket_age)
                                                                             >, 
                                                                             hmac(<
                                                                                   Expand(Expand(Extract(Expand(ms,
                                                                                                                <
                                                                                                                 'rms', 
                                                                                                                 h(messages)
                                                                                                                >,
                                                                                                                '32'),
                                                                                                         '0'),
                                                                                                 <'res', 'pbk'
                                                                                                 >,
                                                                                                 '32'),
                                                                                          <'0', '0'>, '32'), 
                                                                                   h(<'0', '1', '0x0303', 
                                                                                      ~tid, '0', 
                                                                                      $cipher_suites, '0', 
                                                                                      <'43', '0x0304'>, 
                                                                                      <'10', $g1, $g>, 
                                                                                      <'40', $g1, $g1^~x>, 
                                                                                      <'45', '0', '1'>, 
                                                                                      <'42', '0'>, '41', 
                                                                                      <~ticket, 
                                                                                       mask(ticket_age_add,
                                                                                            $ticket_age)
                                                                                      >, 
                                                                                      '0'>)
                                                                                  >)
                                                                            >, 
                                                                            '6', '0x0303', '40', $g>, 
                                                                           '1', '0x0303', ~new_nc, '0', 
                                                                           $cipher_suites.1, '0', 
                                                                           <'43', '0x0304'>, <'10', $g1, $g>, 
                                                                           <'40', $g, $g^~x.1>, 
                                                                           <'45', '0', '1'>, '0', '41', 
                                                                           <~ticket, mask(ticket_age_add, '1')
                                                                           >, 
                                                                           '0'>)
                                                                       >)
                                                                 >, 
                                                                 '2', '0x0303', p_ns, $cipher_suite, 
                                                                 <'13', $sig_algs>, <'40', $g, p_gy>, 
                                                                 <'41', '0'>, '0'>, 
                                                                '8', $exts>)
                                                            >,
                                                            '32'),
                                                     <'fin', '0'>, '32'), 
                                              h(<
                                                 <
                                                  <
                                                   <
                                                    <'0', '1', '0x0303', ~tid, '0', $cipher_suites, '0', 
                                                     <'43', '0x0304'>, <'10', $g1, $g>, <'40', $g1, $g1^~x>, 
                                                     <'45', '0', '1'>, <'42', '0'>, '41', 
                                                     <~ticket, mask(ticket_age_add, $ticket_age)>, 
                                                     hmac(<
                                                           Expand(Expand(Extract(Expand(ms,
                                                                                        <'rms', h(messages)>,
                                                                                        '32'),
                                                                                 '0'),
                                                                         <'res', 'pbk'>, '32'),
                                                                  <'0', '0'>, '32'), 
                                                           h(<'0', '1', '0x0303', ~tid, '0', $cipher_suites, 
                                                              '0', <'43', '0x0304'>, <'10', $g1, $g>, 
                                                              <'40', $g1, $g1^~x>, <'45', '0', '1'>, 
                                                              <'42', '0'>, '41', 
                                                              <~ticket, mask(ticket_age_add, $ticket_age)>, 
                                                              '0'>)
                                                          >)
                                                    >, 
                                                    '6', '0x0303', '40', $g>, 
                                                   '1', '0x0303', ~new_nc, '0', $cipher_suites.1, '0', 
                                                   <'43', '0x0304'>, <'10', $g1, $g>, <'40', $g, $g^~x.1>, 
                                                   <'45', '0', '1'>, '0', '41', 
                                                   <~ticket, mask(ticket_age_add, '1')>, 
                                                   hmac(<
                                                         Expand(Expand(Extract(Expand(ms,
                                                                                      <'rms', h(messages)>,
                                                                                      '32'),
                                                                               '0'),
                                                                       <'res', 'pbk'>, '32'),
                                                                <'0', '0'>, '32'), 
                                                         h(<
                                                            <
                                                             <'0', '1', '0x0303', ~tid, '0', $cipher_suites, 
                                                              '0', <'43', '0x0304'>, <'10', $g1, $g>, 
                                                              <'40', $g1, $g1^~x>, <'45', '0', '1'>, 
                                                              <'42', '0'>, '41', 
                                                              <~ticket, mask(ticket_age_add, $ticket_age)>, 
                                                              hmac(<
                                                                    Expand(Expand(Extract(Expand(ms,
                                                                                                 <'rms', 
                                                                                                  h(messages)
                                                                                                 >,
                                                                                                 '32'),
                                                                                          '0'),
                                                                                  <'res', 'pbk'>, '32'),
                                                                           <'0', '0'>, '32'), 
                                                                    h(<'0', '1', '0x0303', ~tid, '0', 
                                                                       $cipher_suites, '0', <'43', '0x0304'>, 
                                                                       <'10', $g1, $g>, <'40', $g1, $g1^~x>, 
                                                                       <'45', '0', '1'>, <'42', '0'>, '41', 
                                                                       <~ticket, 
                                                                        mask(ticket_age_add, $ticket_age)>, 
                                                                       '0'>)
                                                                   >)
                                                             >, 
                                                             '6', '0x0303', '40', $g>, 
                                                            '1', '0x0303', ~new_nc, '0', $cipher_suites.1, 
                                                            '0', <'43', '0x0304'>, <'10', $g1, $g>, 
                                                            <'40', $g, $g^~x.1>, <'45', '0', '1'>, '0', '41', 
                                                            <~ticket, mask(ticket_age_add, '1')>, '0'>)
                                                        >)
                                                  >, 
                                                  '2', '0x0303', p_ns, $cipher_suite, <'13', $sig_algs>, 
                                                  <'40', $g, p_gy>, <'41', '0'>, '0'>, 
                                                 '8', $exts>)
                                             >)
                                       >)
                                    >,
                                    '32')
                  ) ▶₀ #l )
      qed
    next
      case recv_server_auth_psk_case_3
      by contradiction /* from formulas */
    next
      case recv_server_auth_psk_case_4
      by contradiction /* from formulas */
    next
      case recv_server_auth_psk_case_5
      solve( (∃ #j.2.
               (!KU( Extract('0',
                             Extract('0', Extract(Expand(ms, <'rms', h(messages)>, '32'), '0')))
                ) @ #j.2)
              ∧
               #j.2 < #j.1)  ∥
             ((∀ #k.
                (!KU( Extract('0',
                              Extract('0', Extract(Expand(ms, <'rms', h(messages)>, '32'), '0')))
                 ) @ #k)
               ⇒
                ¬(#k < #j.1)) ∧
              (∃ actor #l.
                (RevealPSK( actor,
                            Expand(Extract('0',
                                           Extract('0',
                                                   Extract(Expand(ms, <'rms', h(messages)>, '32'), '0'))),
                                   <'serverats', 
                                    h(<
                                       <
                                        <
                                         <'0', '1', '0x0303', ~tid, '0', $cipher_suites, '0', 
                                          <'43', '0x0304'>, <'10', $g1, $g2>, <'40', $g1, $g1^~x>, 
                                          <'45', '0', '1'>, <'42', '0'>, '41', 
                                          <p_psk_id, mask(ticket_age_add, $ticket_age)>, 
                                          hmac(<
                                                Expand(Expand(Extract(Expand(ms, <'rms', h(messages)>, '32'),
                                                                      '0'),
                                                              <'res', 'pbk'>, '32'),
                                                       <'0', '0'>, '32'), 
                                                h(<'0', '1', '0x0303', ~tid, '0', $cipher_suites, '0', 
                                                   <'43', '0x0304'>, <'10', $g1, $g2>, <'40', $g1, $g1^~x>, 
                                                   <'45', '0', '1'>, <'42', '0'>, '41', 
                                                   <p_psk_id, mask(ticket_age_add, $ticket_age)>, '0'>)
                                               >)
                                         >, 
                                         '2', '0x0303', p_ns, $cipher_suite, <'13', $sig_algs>, <'41', '0'>, 
                                         '42', '0'>, 
                                        '8', $exts>, 
                                       '20', 
                                       hmac(<
                                             Expand(Expand(Extract('0',
                                                                   Extract(Expand(ms, <'rms', h(messages)>,
                                                                                  '32'),
                                                                           '0')),
                                                           <'serverhts', 
                                                            h(<
                                                               <
                                                                <'0', '1', '0x0303', ~tid, '0', 
                                                                 $cipher_suites, '0', <'43', '0x0304'>, 
                                                                 <'10', $g1, $g2>, <'40', $g1, $g1^~x>, 
                                                                 <'45', '0', '1'>, <'42', '0'>, '41', 
                                                                 <p_psk_id, mask(ticket_age_add, $ticket_age)
                                                                 >, 
                                                                 hmac(<
                                                                       Expand(Expand(Extract(Expand(ms,
                                                                                                    <'rms', 
                                                                                                     h(messages)
                                                                                                    >,
                                                                                                    '32'),
                                                                                             '0'),
                                                                                     <'res', 'pbk'>, '32'),
                                                                              <'0', '0'>, '32'), 
                                                                       h(<'0', '1', '0x0303', ~tid, '0', 
                                                                          $cipher_suites, '0', 
                                                                          <'43', '0x0304'>, <'10', $g1, $g2>, 
                                                                          <'40', $g1, $g1^~x>, 
                                                                          <'45', '0', '1'>, <'42', '0'>, 
                                                                          '41', 
                                                                          <p_psk_id, 
                                                                           mask(ticket_age_add, $ticket_age)
                                                                          >, 
                                                                          '0'>)
                                                                      >)
                                                                >, 
                                                                '2', '0x0303', p_ns, $cipher_suite, 
                                                                <'13', $sig_algs>, <'41', '0'>, '42', '0'>, 
                                                               '8', $exts>)
                                                           >,
                                                           '32'),
                                                    <'fin', '0'>, '32'), 
                                             h(<
                                                <
                                                 <'0', '1', '0x0303', ~tid, '0', $cipher_suites, '0', 
                                                  <'43', '0x0304'>, <'10', $g1, $g2>, <'40', $g1, $g1^~x>, 
                                                  <'45', '0', '1'>, <'42', '0'>, '41', 
                                                  <p_psk_id, mask(ticket_age_add, $ticket_age)>, 
                                                  hmac(<
                                                        Expand(Expand(Extract(Expand(ms, <'rms', h(messages)>,
                                                                                     '32'),
                                                                              '0'),
                                                                      <'res', 'pbk'>, '32'),
                                                               <'0', '0'>, '32'), 
                                                        h(<'0', '1', '0x0303', ~tid, '0', $cipher_suites, 
                                                           '0', <'43', '0x0304'>, <'10', $g1, $g2>, 
                                                           <'40', $g1, $g1^~x>, <'45', '0', '1'>, 
                                                           <'42', '0'>, '41', 
                                                           <p_psk_id, mask(ticket_age_add, $ticket_age)>, '0'
                                                          >)
                                                       >)
                                                 >, 
                                                 '2', '0x0303', p_ns, $cipher_suite, <'13', $sig_algs>, 
                                                 <'41', '0'>, '42', '0'>, 
                                                '8', $exts>)
                                            >)
                                      >)
                                   >,
                                   '32')
                 ) @ #l)
               ∧
                #l < #j.1)) )
        case case_1
        solve( (∃ #r. (RevLtk( $S ) @ #r) ∧ #r < #vr)  ∥
               (∃ tid3 x #r. (RevDHExp( tid3, $S, x ) @ #r) ∧ #r < #vr)  ∥
               (∃ tid4 y #r. (RevDHExp( tid4, $C, y ) @ #r) ∧ #r < #vr)  ∥
               (∃ rms #r. (RevealPSK( $C, rms ) @ #r) ∧ #r < #k)  ∥
               (∃ rms #r. (RevealPSK( $S, rms ) @ #r) ∧ #r < #k) )
          case case_1
          by contradiction /* from formulas */
        next
          case case_2
          by contradiction /* from formulas */
        next
          case case_3
          by contradiction /* from formulas */
        next
          case case_4
          by contradiction /* from formulas */
        next
          case case_5
          by contradiction /* from formulas */
        qed
      next
        case case_2
        by solve( SecretPSK( $A,
                             Expand(Extract('0',
                                            Extract('0',
                                                    Extract(Expand(ms, <'rms', h(messages)>, '32'), '0'))),
                                    <'serverats', 
                                     h(<
                                        <
                                         <
                                          <'0', '1', '0x0303', ~tid, '0', $cipher_suites, '0', 
                                           <'43', '0x0304'>, <'10', $g1, $g2>, <'40', $g1, $g1^~x>, 
                                           <'45', '0', '1'>, <'42', '0'>, '41', 
                                           <p_psk_id, mask(ticket_age_add, $ticket_age)>, 
                                           hmac(<
                                                 Expand(Expand(Extract(Expand(ms, <'rms', h(messages)>, '32'),
                                                                       '0'),
                                                               <'res', 'pbk'>, '32'),
                                                        <'0', '0'>, '32'), 
                                                 h(<'0', '1', '0x0303', ~tid, '0', $cipher_suites, '0', 
                                                    <'43', '0x0304'>, <'10', $g1, $g2>, <'40', $g1, $g1^~x>, 
                                                    <'45', '0', '1'>, <'42', '0'>, '41', 
                                                    <p_psk_id, mask(ticket_age_add, $ticket_age)>, '0'>)
                                                >)
                                          >, 
                                          '2', '0x0303', p_ns, $cipher_suite, <'13', $sig_algs>, <'41', '0'>, 
                                          '42', '0'>, 
                                         '8', $exts>, 
                                        '20', 
                                        hmac(<
                                              Expand(Expand(Extract('0',
                                                                    Extract(Expand(ms, <'rms', h(messages)>,
                                                                                   '32'),
                                                                            '0')),
                                                            <'serverhts', 
                                                             h(<
                                                                <
                                                                 <'0', '1', '0x0303', ~tid, '0', 
                                                                  $cipher_suites, '0', <'43', '0x0304'>, 
                                                                  <'10', $g1, $g2>, <'40', $g1, $g1^~x>, 
                                                                  <'45', '0', '1'>, <'42', '0'>, '41', 
                                                                  <p_psk_id, mask(ticket_age_add, $ticket_age)
                                                                  >, 
                                                                  hmac(<
                                                                        Expand(Expand(Extract(Expand(ms,
                                                                                                     <'rms', 
                                                                                                      h(messages)
                                                                                                     >,
                                                                                                     '32'),
                                                                                              '0'),
                                                                                      <'res', 'pbk'>, '32'),
                                                                               <'0', '0'>, '32'), 
                                                                        h(<'0', '1', '0x0303', ~tid, '0', 
                                                                           $cipher_suites, '0', 
                                                                           <'43', '0x0304'>, 
                                                                           <'10', $g1, $g2>, 
                                                                           <'40', $g1, $g1^~x>, 
                                                                           <'45', '0', '1'>, <'42', '0'>, 
                                                                           '41', 
                                                                           <p_psk_id, 
                                                                            mask(ticket_age_add, $ticket_age)
                                                                           >, 
                                                                           '0'>)
                                                                       >)
                                                                 >, 
                                                                 '2', '0x0303', p_ns, $cipher_suite, 
                                                                 <'13', $sig_algs>, <'41', '0'>, '42', '0'>, 
                                                                '8', $exts>)
                                                            >,
                                                            '32'),
                                                     <'fin', '0'>, '32'), 
                                              h(<
                                                 <
                                                  <'0', '1', '0x0303', ~tid, '0', $cipher_suites, '0', 
                                                   <'43', '0x0304'>, <'10', $g1, $g2>, <'40', $g1, $g1^~x>, 
                                                   <'45', '0', '1'>, <'42', '0'>, '41', 
                                                   <p_psk_id, mask(ticket_age_add, $ticket_age)>, 
                                                   hmac(<
                                                         Expand(Expand(Extract(Expand(ms,
                                                                                      <'rms', h(messages)>,
                                                                                      '32'),
                                                                               '0'),
                                                                       <'res', 'pbk'>, '32'),
                                                                <'0', '0'>, '32'), 
                                                         h(<'0', '1', '0x0303', ~tid, '0', $cipher_suites, 
                                                            '0', <'43', '0x0304'>, <'10', $g1, $g2>, 
                                                            <'40', $g1, $g1^~x>, <'45', '0', '1'>, 
                                                            <'42', '0'>, '41', 
                                                            <p_psk_id, mask(ticket_age_add, $ticket_age)>, '0'
                                                           >)
                                                        >)
                                                  >, 
                                                  '2', '0x0303', p_ns, $cipher_suite, <'13', $sig_algs>, 
                                                  <'41', '0'>, '42', '0'>, 
                                                 '8', $exts>)
                                             >)
                                       >)
                                    >,
                                    '32')
                  ) ▶₀ #l )
      qed
    next
      case recv_server_auth_psk_case_6
      solve( (∃ #j.2.
               (!KU( Extract('0',
                             Extract('0', Extract(Expand(ms, <'rms', h(messages)>, '32'), '0')))
                ) @ #j.2)
              ∧
               #j.2 < #j.1)  ∥
             ((∀ #k.
                (!KU( Extract('0',
                              Extract('0', Extract(Expand(ms, <'rms', h(messages)>, '32'), '0')))
                 ) @ #k)
               ⇒
                ¬(#k < #j.1)) ∧
              (∃ actor #l.
                (RevealPSK( actor,
                            Expand(Extract('0',
                                           Extract('0',
                                                   Extract(Expand(ms, <'rms', h(messages)>, '32'), '0'))),
                                   <'serverats', 
                                    h(<
                                       <
                                        <
                                         <
                                          <
                                           <'0', '1', '0x0303', ~tid, '0', $cipher_suites, '0', 
                                            <'43', '0x0304'>, <'10', $g1, $g2>, <'40', $g1, $g1^~x>, 
                                            <'45', '0', '1'>, <'42', '0'>, '41', 
                                            <p_psk_id, mask(ticket_age_add, $ticket_age)>, 
                                            hmac(<
                                                  Expand(Expand(Extract(Expand(ms, <'rms', h(messages)>,
                                                                               '32'),
                                                                        '0'),
                                                                <'res', 'pbk'>, '32'),
                                                         <'0', '0'>, '32'), 
                                                  h(<'0', '1', '0x0303', ~tid, '0', $cipher_suites, '0', 
                                                     <'43', '0x0304'>, <'10', $g1, $g2>, <'40', $g1, $g1^~x>, 
                                                     <'45', '0', '1'>, <'42', '0'>, '41', 
                                                     <p_psk_id, mask(ticket_age_add, $ticket_age)>, '0'>)
                                                 >)
                                           >, 
                                           '6', '0x0303', '40', $g2>, 
                                          '1', '0x0303', ~new_nc, '0', $cipher_suites.1, '0', 
                                          <'43', '0x0304'>, <'10', $g1, $g2>, <'40', $g2, $g2^~new_x>, 
                                          <'45', '0', '1'>, '0', '41', <p_psk_id, mask(ticket_age_add, '1')>, 
                                          hmac(<
                                                Expand(Expand(Extract(Expand(ms, <'rms', h(messages)>, '32'),
                                                                      '0'),
                                                              <'res', 'pbk'>, '32'),
                                                       <'0', '0'>, '32'), 
                                                h(<
                                                   <
                                                    <'0', '1', '0x0303', ~tid, '0', $cipher_suites, '0', 
                                                     <'43', '0x0304'>, <'10', $g1, $g2>, <'40', $g1, $g1^~x>, 
                                                     <'45', '0', '1'>, <'42', '0'>, '41', 
                                                     <p_psk_id, mask(ticket_age_add, $ticket_age)>, 
                                                     hmac(<
                                                           Expand(Expand(Extract(Expand(ms,
                                                                                        <'rms', h(messages)>,
                                                                                        '32'),
                                                                                 '0'),
                                                                         <'res', 'pbk'>, '32'),
                                                                  <'0', '0'>, '32'), 
                                                           h(<'0', '1', '0x0303', ~tid, '0', $cipher_suites, 
                                                              '0', <'43', '0x0304'>, <'10', $g1, $g2>, 
                                                              <'40', $g1, $g1^~x>, <'45', '0', '1'>, 
                                                              <'42', '0'>, '41', 
                                                              <p_psk_id, mask(ticket_age_add, $ticket_age)>, 
                                                              '0'>)
                                                          >)
                                                    >, 
                                                    '6', '0x0303', '40', $g2>, 
                                                   '1', '0x0303', ~new_nc, '0', $cipher_suites.1, '0', 
                                                   <'43', '0x0304'>, <'10', $g1, $g2>, 
                                                   <'40', $g2, $g2^~new_x>, <'45', '0', '1'>, '0', '41', 
                                                   <p_psk_id, mask(ticket_age_add, '1')>, '0'>)
                                               >)
                                         >, 
                                         '2', '0x0303', p_ns, $cipher_suite, <'13', $sig_algs>, <'41', '0'>, 
                                         '0'>, 
                                        '8', $exts>, 
                                       '20', 
                                       hmac(<
                                             Expand(Expand(Extract('0',
                                                                   Extract(Expand(ms, <'rms', h(messages)>,
                                                                                  '32'),
                                                                           '0')),
                                                           <'serverhts', 
                                                            h(<
                                                               <
                                                                <
                                                                 <
                                                                  <'0', '1', '0x0303', ~tid, '0', 
                                                                   $cipher_suites, '0', <'43', '0x0304'>, 
                                                                   <'10', $g1, $g2>, <'40', $g1, $g1^~x>, 
                                                                   <'45', '0', '1'>, <'42', '0'>, '41', 
                                                                   <p_psk_id, 
                                                                    mask(ticket_age_add, $ticket_age)>, 
                                                                   hmac(<
                                                                         Expand(Expand(Extract(Expand(ms,
                                                                                                      <'rms', 
                                                                                                       h(messages)
                                                                                                      >,
                                                                                                      '32'),
                                                                                               '0'),
                                                                                       <'res', 'pbk'>, '32'),
                                                                                <'0', '0'>, '32'), 
                                                                         h(<'0', '1', '0x0303', ~tid, '0', 
                                                                            $cipher_suites, '0', 
                                                                            <'43', '0x0304'>, 
                                                                            <'10', $g1, $g2>, 
                                                                            <'40', $g1, $g1^~x>, 
                                                                            <'45', '0', '1'>, <'42', '0'>, 
                                                                            '41', 
                                                                            <p_psk_id, 
                                                                             mask(ticket_age_add, $ticket_age)
                                                                            >, 
                                                                            '0'>)
                                                                        >)
                                                                  >, 
                                                                  '6', '0x0303', '40', $g2>, 
                                                                 '1', '0x0303', ~new_nc, '0', 
                                                                 $cipher_suites.1, '0', <'43', '0x0304'>, 
                                                                 <'10', $g1, $g2>, <'40', $g2, $g2^~new_x>, 
                                                                 <'45', '0', '1'>, '0', '41', 
                                                                 <p_psk_id, mask(ticket_age_add, '1')>, 
                                                                 hmac(<
                                                                       Expand(Expand(Extract(Expand(ms,
                                                                                                    <'rms', 
                                                                                                     h(messages)
                                                                                                    >,
                                                                                                    '32'),
                                                                                             '0'),
                                                                                     <'res', 'pbk'>, '32'),
                                                                              <'0', '0'>, '32'), 
                                                                       h(<
                                                                          <
                                                                           <'0', '1', '0x0303', ~tid, '0', 
                                                                            $cipher_suites, '0', 
                                                                            <'43', '0x0304'>, 
                                                                            <'10', $g1, $g2>, 
                                                                            <'40', $g1, $g1^~x>, 
                                                                            <'45', '0', '1'>, <'42', '0'>, 
                                                                            '41', 
                                                                            <p_psk_id, 
                                                                             mask(ticket_age_add, $ticket_age)
                                                                            >, 
                                                                            hmac(<
                                                                                  Expand(Expand(Extract(Expand(ms,
                                                                                                               <
                                                                                                                'rms', 
                                                                                                                h(messages)
                                                                                                               >,
                                                                                                               '32'),
                                                                                                        '0'),
                                                                                                <'res', 'pbk'
                                                                                                >,
                                                                                                '32'),
                                                                                         <'0', '0'>, '32'), 
                                                                                  h(<'0', '1', '0x0303', 
                                                                                     ~tid, '0', 
                                                                                     $cipher_suites, '0', 
                                                                                     <'43', '0x0304'>, 
                                                                                     <'10', $g1, $g2>, 
                                                                                     <'40', $g1, $g1^~x>, 
                                                                                     <'45', '0', '1'>, 
                                                                                     <'42', '0'>, '41', 
                                                                                     <p_psk_id, 
                                                                                      mask(ticket_age_add,
                                                                                           $ticket_age)
                                                                                     >, 
                                                                                     '0'>)
                                                                                 >)
                                                                           >, 
                                                                           '6', '0x0303', '40', $g2>, 
                                                                          '1', '0x0303', ~new_nc, '0', 
                                                                          $cipher_suites.1, '0', 
                                                                          <'43', '0x0304'>, <'10', $g1, $g2>, 
                                                                          <'40', $g2, $g2^~new_x>, 
                                                                          <'45', '0', '1'>, '0', '41', 
                                                                          <p_psk_id, mask(ticket_age_add, '1')
                                                                          >, 
                                                                          '0'>)
                                                                      >)
                                                                >, 
                                                                '2', '0x0303', p_ns, $cipher_suite, 
                                                                <'13', $sig_algs>, <'41', '0'>, '0'>, 
                                                               '8', $exts>)
                                                           >,
                                                           '32'),
                                                    <'fin', '0'>, '32'), 
                                             h(<
                                                <
                                                 <
                                                  <
                                                   <'0', '1', '0x0303', ~tid, '0', $cipher_suites, '0', 
                                                    <'43', '0x0304'>, <'10', $g1, $g2>, <'40', $g1, $g1^~x>, 
                                                    <'45', '0', '1'>, <'42', '0'>, '41', 
                                                    <p_psk_id, mask(ticket_age_add, $ticket_age)>, 
                                                    hmac(<
                                                          Expand(Expand(Extract(Expand(ms,
                                                                                       <'rms', h(messages)>,
                                                                                       '32'),
                                                                                '0'),
                                                                        <'res', 'pbk'>, '32'),
                                                                 <'0', '0'>, '32'), 
                                                          h(<'0', '1', '0x0303', ~tid, '0', $cipher_suites, 
                                                             '0', <'43', '0x0304'>, <'10', $g1, $g2>, 
                                                             <'40', $g1, $g1^~x>, <'45', '0', '1'>, 
                                                             <'42', '0'>, '41', 
                                                             <p_psk_id, mask(ticket_age_add, $ticket_age)>, 
                                                             '0'>)
                                                         >)
                                                   >, 
                                                   '6', '0x0303', '40', $g2>, 
                                                  '1', '0x0303', ~new_nc, '0', $cipher_suites.1, '0', 
                                                  <'43', '0x0304'>, <'10', $g1, $g2>, 
                                                  <'40', $g2, $g2^~new_x>, <'45', '0', '1'>, '0', '41', 
                                                  <p_psk_id, mask(ticket_age_add, '1')>, 
                                                  hmac(<
                                                        Expand(Expand(Extract(Expand(ms, <'rms', h(messages)>,
                                                                                     '32'),
                                                                              '0'),
                                                                      <'res', 'pbk'>, '32'),
                                                               <'0', '0'>, '32'), 
                                                        h(<
                                                           <
                                                            <'0', '1', '0x0303', ~tid, '0', $cipher_suites, 
                                                             '0', <'43', '0x0304'>, <'10', $g1, $g2>, 
                                                             <'40', $g1, $g1^~x>, <'45', '0', '1'>, 
                                                             <'42', '0'>, '41', 
                                                             <p_psk_id, mask(ticket_age_add, $ticket_age)>, 
                                                             hmac(<
                                                                   Expand(Expand(Extract(Expand(ms,
                                                                                                <'rms', 
                                                                                                 h(messages)>,
                                                                                                '32'),
                                                                                         '0'),
                                                                                 <'res', 'pbk'>, '32'),
                                                                          <'0', '0'>, '32'), 
                                                                   h(<'0', '1', '0x0303', ~tid, '0', 
                                                                      $cipher_suites, '0', <'43', '0x0304'>, 
                                                                      <'10', $g1, $g2>, <'40', $g1, $g1^~x>, 
                                                                      <'45', '0', '1'>, <'42', '0'>, '41', 
                                                                      <p_psk_id, 
                                                                       mask(ticket_age_add, $ticket_age)>, 
                                                                      '0'>)
                                                                  >)
                                                            >, 
                                                            '6', '0x0303', '40', $g2>, 
                                                           '1', '0x0303', ~new_nc, '0', $cipher_suites.1, 
                                                           '0', <'43', '0x0304'>, <'10', $g1, $g2>, 
                                                           <'40', $g2, $g2^~new_x>, <'45', '0', '1'>, '0', 
                                                           '41', <p_psk_id, mask(ticket_age_add, '1')>, '0'>)
                                                       >)
                                                 >, 
                                                 '2', '0x0303', p_ns, $cipher_suite, <'13', $sig_algs>, 
                                                 <'41', '0'>, '0'>, 
                                                '8', $exts>)
                                            >)
                                      >)
                                   >,
                                   '32')
                 ) @ #l)
               ∧
                #l < #j.1)) )
        case case_1
        solve( (∃ #r. (RevLtk( $S ) @ #r) ∧ #r < #vr)  ∥
               (∃ tid3 x #r. (RevDHExp( tid3, $S, x ) @ #r) ∧ #r < #vr)  ∥
               (∃ tid4 y #r. (RevDHExp( tid4, $C, y ) @ #r) ∧ #r < #vr)  ∥
               (∃ rms #r. (RevealPSK( $C, rms ) @ #r) ∧ #r < #k)  ∥
               (∃ rms #r. (RevealPSK( $S, rms ) @ #r) ∧ #r < #k) )
          case case_1
          by contradiction /* from formulas */
        next
          case case_2
          by contradiction /* from formulas */
        next
          case case_3
          by contradiction /* from formulas */
        next
          case case_4
          by contradiction /* from formulas */
        next
          case case_5
          by contradiction /* from formulas */
        qed
      next
        case case_2
        by solve( SecretPSK( $A,
                             Expand(Extract('0',
                                            Extract('0',
                                                    Extract(Expand(ms, <'rms', h(messages)>, '32'), '0'))),
                                    <'serverats', 
                                     h(<
                                        <
                                         <
                                          <
                                           <
                                            <'0', '1', '0x0303', ~tid, '0', $cipher_suites, '0', 
                                             <'43', '0x0304'>, <'10', $g1, $g2>, <'40', $g1, $g1^~x>, 
                                             <'45', '0', '1'>, <'42', '0'>, '41', 
                                             <p_psk_id, mask(ticket_age_add, $ticket_age)>, 
                                             hmac(<
                                                   Expand(Expand(Extract(Expand(ms, <'rms', h(messages)>,
                                                                                '32'),
                                                                         '0'),
                                                                 <'res', 'pbk'>, '32'),
                                                          <'0', '0'>, '32'), 
                                                   h(<'0', '1', '0x0303', ~tid, '0', $cipher_suites, '0', 
                                                      <'43', '0x0304'>, <'10', $g1, $g2>, 
                                                      <'40', $g1, $g1^~x>, <'45', '0', '1'>, <'42', '0'>, 
                                                      '41', <p_psk_id, mask(ticket_age_add, $ticket_age)>, '0'
                                                     >)
                                                  >)
                                            >, 
                                            '6', '0x0303', '40', $g2>, 
                                           '1', '0x0303', ~new_nc, '0', $cipher_suites.1, '0', 
                                           <'43', '0x0304'>, <'10', $g1, $g2>, <'40', $g2, $g2^~new_x>, 
                                           <'45', '0', '1'>, '0', '41', 
                                           <p_psk_id, mask(ticket_age_add, '1')>, 
                                           hmac(<
                                                 Expand(Expand(Extract(Expand(ms, <'rms', h(messages)>, '32'),
                                                                       '0'),
                                                               <'res', 'pbk'>, '32'),
                                                        <'0', '0'>, '32'), 
                                                 h(<
                                                    <
                                                     <'0', '1', '0x0303', ~tid, '0', $cipher_suites, '0', 
                                                      <'43', '0x0304'>, <'10', $g1, $g2>, 
                                                      <'40', $g1, $g1^~x>, <'45', '0', '1'>, <'42', '0'>, 
                                                      '41', <p_psk_id, mask(ticket_age_add, $ticket_age)>, 
                                                      hmac(<
                                                            Expand(Expand(Extract(Expand(ms,
                                                                                         <'rms', h(messages)>,
                                                                                         '32'),
                                                                                  '0'),
                                                                          <'res', 'pbk'>, '32'),
                                                                   <'0', '0'>, '32'), 
                                                            h(<'0', '1', '0x0303', ~tid, '0', $cipher_suites, 
                                                               '0', <'43', '0x0304'>, <'10', $g1, $g2>, 
                                                               <'40', $g1, $g1^~x>, <'45', '0', '1'>, 
                                                               <'42', '0'>, '41', 
                                                               <p_psk_id, mask(ticket_age_add, $ticket_age)>, 
                                                               '0'>)
                                                           >)
                                                     >, 
                                                     '6', '0x0303', '40', $g2>, 
                                                    '1', '0x0303', ~new_nc, '0', $cipher_suites.1, '0', 
                                                    <'43', '0x0304'>, <'10', $g1, $g2>, 
                                                    <'40', $g2, $g2^~new_x>, <'45', '0', '1'>, '0', '41', 
                                                    <p_psk_id, mask(ticket_age_add, '1')>, '0'>)
                                                >)
                                          >, 
                                          '2', '0x0303', p_ns, $cipher_suite, <'13', $sig_algs>, <'41', '0'>, 
                                          '0'>, 
                                         '8', $exts>, 
                                        '20', 
                                        hmac(<
                                              Expand(Expand(Extract('0',
                                                                    Extract(Expand(ms, <'rms', h(messages)>,
                                                                                   '32'),
                                                                            '0')),
                                                            <'serverhts', 
                                                             h(<
                                                                <
                                                                 <
                                                                  <
                                                                   <'0', '1', '0x0303', ~tid, '0', 
                                                                    $cipher_suites, '0', <'43', '0x0304'>, 
                                                                    <'10', $g1, $g2>, <'40', $g1, $g1^~x>, 
                                                                    <'45', '0', '1'>, <'42', '0'>, '41', 
                                                                    <p_psk_id, 
                                                                     mask(ticket_age_add, $ticket_age)>, 
                                                                    hmac(<
                                                                          Expand(Expand(Extract(Expand(ms,
                                                                                                       <
                                                                                                        'rms', 
                                                                                                        h(messages)
                                                                                                       >,
                                                                                                       '32'),
                                                                                                '0'),
                                                                                        <'res', 'pbk'>, '32'),
                                                                                 <'0', '0'>, '32'), 
                                                                          h(<'0', '1', '0x0303', ~tid, '0', 
                                                                             $cipher_suites, '0', 
                                                                             <'43', '0x0304'>, 
                                                                             <'10', $g1, $g2>, 
                                                                             <'40', $g1, $g1^~x>, 
                                                                             <'45', '0', '1'>, <'42', '0'>, 
                                                                             '41', 
                                                                             <p_psk_id, 
                                                                              mask(ticket_age_add,
                                                                                   $ticket_age)
                                                                             >, 
                                                                             '0'>)
                                                                         >)
                                                                   >, 
                                                                   '6', '0x0303', '40', $g2>, 
                                                                  '1', '0x0303', ~new_nc, '0', 
                                                                  $cipher_suites.1, '0', <'43', '0x0304'>, 
                                                                  <'10', $g1, $g2>, <'40', $g2, $g2^~new_x>, 
                                                                  <'45', '0', '1'>, '0', '41', 
                                                                  <p_psk_id, mask(ticket_age_add, '1')>, 
                                                                  hmac(<
                                                                        Expand(Expand(Extract(Expand(ms,
                                                                                                     <'rms', 
                                                                                                      h(messages)
                                                                                                     >,
                                                                                                     '32'),
                                                                                              '0'),
                                                                                      <'res', 'pbk'>, '32'),
                                                                               <'0', '0'>, '32'), 
                                                                        h(<
                                                                           <
                                                                            <'0', '1', '0x0303', ~tid, '0', 
                                                                             $cipher_suites, '0', 
                                                                             <'43', '0x0304'>, 
                                                                             <'10', $g1, $g2>, 
                                                                             <'40', $g1, $g1^~x>, 
                                                                             <'45', '0', '1'>, <'42', '0'>, 
                                                                             '41', 
                                                                             <p_psk_id, 
                                                                              mask(ticket_age_add,
                                                                                   $ticket_age)
                                                                             >, 
                                                                             hmac(<
                                                                                   Expand(Expand(Extract(Expand(ms,
                                                                                                                <
                                                                                                                 'rms', 
                                                                                                                 h(messages)
                                                                                                                >,
                                                                                                                '32'),
                                                                                                         '0'),
                                                                                                 <'res', 'pbk'
                                                                                                 >,
                                                                                                 '32'),
                                                                                          <'0', '0'>, '32'), 
                                                                                   h(<'0', '1', '0x0303', 
                                                                                      ~tid, '0', 
                                                                                      $cipher_suites, '0', 
                                                                                      <'43', '0x0304'>, 
                                                                                      <'10', $g1, $g2>, 
                                                                                      <'40', $g1, $g1^~x>, 
                                                                                      <'45', '0', '1'>, 
                                                                                      <'42', '0'>, '41', 
                                                                                      <p_psk_id, 
                                                                                       mask(ticket_age_add,
                                                                                            $ticket_age)
                                                                                      >, 
                                                                                      '0'>)
                                                                                  >)
                                                                            >, 
                                                                            '6', '0x0303', '40', $g2>, 
                                                                           '1', '0x0303', ~new_nc, '0', 
                                                                           $cipher_suites.1, '0', 
                                                                           <'43', '0x0304'>, 
                                                                           <'10', $g1, $g2>, 
                                                                           <'40', $g2, $g2^~new_x>, 
                                                                           <'45', '0', '1'>, '0', '41', 
                                                                           <p_psk_id, 
                                                                            mask(ticket_age_add, '1')>, 
                                                                           '0'>)
                                                                       >)
                                                                 >, 
                                                                 '2', '0x0303', p_ns, $cipher_suite, 
                                                                 <'13', $sig_algs>, <'41', '0'>, '0'>, 
                                                                '8', $exts>)
                                                            >,
                                                            '32'),
                                                     <'fin', '0'>, '32'), 
                                              h(<
                                                 <
                                                  <
                                                   <
                                                    <'0', '1', '0x0303', ~tid, '0', $cipher_suites, '0', 
                                                     <'43', '0x0304'>, <'10', $g1, $g2>, <'40', $g1, $g1^~x>, 
                                                     <'45', '0', '1'>, <'42', '0'>, '41', 
                                                     <p_psk_id, mask(ticket_age_add, $ticket_age)>, 
                                                     hmac(<
                                                           Expand(Expand(Extract(Expand(ms,
                                                                                        <'rms', h(messages)>,
                                                                                        '32'),
                                                                                 '0'),
                                                                         <'res', 'pbk'>, '32'),
                                                                  <'0', '0'>, '32'), 
                                                           h(<'0', '1', '0x0303', ~tid, '0', $cipher_suites, 
                                                              '0', <'43', '0x0304'>, <'10', $g1, $g2>, 
                                                              <'40', $g1, $g1^~x>, <'45', '0', '1'>, 
                                                              <'42', '0'>, '41', 
                                                              <p_psk_id, mask(ticket_age_add, $ticket_age)>, 
                                                              '0'>)
                                                          >)
                                                    >, 
                                                    '6', '0x0303', '40', $g2>, 
                                                   '1', '0x0303', ~new_nc, '0', $cipher_suites.1, '0', 
                                                   <'43', '0x0304'>, <'10', $g1, $g2>, 
                                                   <'40', $g2, $g2^~new_x>, <'45', '0', '1'>, '0', '41', 
                                                   <p_psk_id, mask(ticket_age_add, '1')>, 
                                                   hmac(<
                                                         Expand(Expand(Extract(Expand(ms,
                                                                                      <'rms', h(messages)>,
                                                                                      '32'),
                                                                               '0'),
                                                                       <'res', 'pbk'>, '32'),
                                                                <'0', '0'>, '32'), 
                                                         h(<
                                                            <
                                                             <'0', '1', '0x0303', ~tid, '0', $cipher_suites, 
                                                              '0', <'43', '0x0304'>, <'10', $g1, $g2>, 
                                                              <'40', $g1, $g1^~x>, <'45', '0', '1'>, 
                                                              <'42', '0'>, '41', 
                                                              <p_psk_id, mask(ticket_age_add, $ticket_age)>, 
                                                              hmac(<
                                                                    Expand(Expand(Extract(Expand(ms,
                                                                                                 <'rms', 
                                                                                                  h(messages)
                                                                                                 >,
                                                                                                 '32'),
                                                                                          '0'),
                                                                                  <'res', 'pbk'>, '32'),
                                                                           <'0', '0'>, '32'), 
                                                                    h(<'0', '1', '0x0303', ~tid, '0', 
                                                                       $cipher_suites, '0', <'43', '0x0304'>, 
                                                                       <'10', $g1, $g2>, <'40', $g1, $g1^~x>, 
                                                                       <'45', '0', '1'>, <'42', '0'>, '41', 
                                                                       <p_psk_id, 
                                                                        mask(ticket_age_add, $ticket_age)>, 
                                                                       '0'>)
                                                                   >)
                                                             >, 
                                                             '6', '0x0303', '40', $g2>, 
                                                            '1', '0x0303', ~new_nc, '0', $cipher_suites.1, 
                                                            '0', <'43', '0x0304'>, <'10', $g1, $g2>, 
                                                            <'40', $g2, $g2^~new_x>, <'45', '0', '1'>, '0', 
                                                            '41', <p_psk_id, mask(ticket_age_add, '1')>, '0'>)
                                                        >)
                                                  >, 
                                                  '2', '0x0303', p_ns, $cipher_suite, <'13', $sig_algs>, 
                                                  <'41', '0'>, '0'>, 
                                                 '8', $exts>)
                                             >)
                                       >)
                                    >,
                                    '32')
                  ) ▶₀ #l )
      qed
    next
      case recv_server_auth_psk_case_7
      by contradiction /* from formulas */
    next
      case recv_server_auth_psk_case_8
      by contradiction /* from formulas */
    qed
  next
    case case_2
    solve( F_State_C3( ~tid, $C, $S, p_res_psk, p_messages, p_nc, p_ns, p_g,
                       p_sg, p_hrr, p_x, p_y, p_gx, p_gy, p_gxy, p_psk_ke_mode, p_psk_id, p_edi,
                       p_es, p_hs, Extract('0', p_hs), p_cats, p_sats, p_hs_keyc, p_hs_keys,
                       <pas, 'auth'>, p_ems, p_rms, '0'
           ) ▶₀ #i )
      case recv_server_auth_case_01
      by solve( SecretPSK( $A,
                           Expand(Expand(Extract('0', Extract(p_gxy, Extract('0', '0'))),
                                         <'serverats', 
                                          h(<
                                             <
                                              <
                                               <
                                                <
                                                 <'0', '1', '0x0303', ~tid, '0', $cipher_suites, '0', 
                                                  <'43', '0x0304'>, <'10', $g, $g2>, <'13', $sig_algs>, '40', 
                                                  $g, $g^~x>, 
                                                 '2', '0x0303', p_ns, $cipher_suite, <'13', $sig_algs.1>, 
                                                 '40', $g, p_gy>, 
                                                '8', $exts>, 
                                               '11', '0', pk(~ltkS)>, 
                                              '15', 
                                              sign(<'server_cv', 
                                                    h(<
                                                       <
                                                        <
                                                         <'0', '1', '0x0303', ~tid, '0', $cipher_suites, '0', 
                                                          <'43', '0x0304'>, <'10', $g, $g2>, 
                                                          <'13', $sig_algs>, '40', $g, $g^~x>, 
                                                         '2', '0x0303', p_ns, $cipher_suite, 
                                                         <'13', $sig_algs.1>, '40', $g, p_gy>, 
                                                        '8', $exts>, 
                                                       '11', '0', pk(~ltkS)>)
                                                   >,
                                                   ~ltkS)
                                             >, 
                                             '20', 
                                             hmac(<
                                                   Expand(Expand(Extract(p_gxy, Extract('0', '0')),
                                                                 <'serverhts', 
                                                                  h(<
                                                                     <
                                                                      <
                                                                       <
                                                                        <'0', '1', '0x0303', ~tid, '0', 
                                                                         $cipher_suites, '0', 
                                                                         <'43', '0x0304'>, <'10', $g, $g2>, 
                                                                         <'13', $sig_algs>, '40', $g, $g^~x>, 
                                                                        '2', '0x0303', p_ns, $cipher_suite, 
                                                                        <'13', $sig_algs.1>, '40', $g, p_gy>, 
                                                                       '8', $exts>, 
                                                                      '11', '0', pk(~ltkS)>, 
                                                                     '15', 
                                                                     sign(<'server_cv', 
                                                                           h(<
                                                                              <
                                                                               <
                                                                                <'0', '1', '0x0303', ~tid, 
                                                                                 '0', $cipher_suites, '0', 
                                                                                 <'43', '0x0304'>, 
                                                                                 <'10', $g, $g2>, 
                                                                                 <'13', $sig_algs>, '40', $g, 
                                                                                 $g^~x>, 
                                                                                '2', '0x0303', p_ns, 
                                                                                $cipher_suite, 
                                                                                <'13', $sig_algs.1>, '40', 
                                                                                $g, p_gy>, 
                                                                               '8', $exts>, 
                                                                              '11', '0', pk(~ltkS)>)
                                                                          >,
                                                                          ~ltkS)
                                                                    >)
                                                                 >,
                                                                 '32'),
                                                          <'fin', '0'>, '32'), 
                                                   h(<
                                                      <
                                                       <
                                                        <
                                                         <'0', '1', '0x0303', ~tid, '0', $cipher_suites, '0', 
                                                          <'43', '0x0304'>, <'10', $g, $g2>, 
                                                          <'13', $sig_algs>, '40', $g, $g^~x>, 
                                                         '2', '0x0303', p_ns, $cipher_suite, 
                                                         <'13', $sig_algs.1>, '40', $g, p_gy>, 
                                                        '8', $exts>, 
                                                       '11', '0', pk(~ltkS)>, 
                                                      '15', 
                                                      sign(<'server_cv', 
                                                            h(<
                                                               <
                                                                <
                                                                 <'0', '1', '0x0303', ~tid, '0', 
                                                                  $cipher_suites, '0', <'43', '0x0304'>, 
                                                                  <'10', $g, $g2>, <'13', $sig_algs>, '40', 
                                                                  $g, $g^~x>, 
                                                                 '2', '0x0303', p_ns, $cipher_suite, 
                                                                 <'13', $sig_algs.1>, '40', $g, p_gy>, 
                                                                '8', $exts>, 
                                                               '11', '0', pk(~ltkS)>)
                                                           >,
                                                           ~ltkS)
                                                     >)
                                                  >)
                                            >)
                                         >,
                                         '32'),
                                  <'adke_wk', '0'>, '32')
                ) ▶₀ #l )
    next
      case recv_server_auth_case_02
      by solve( SecretPSK( $A,
                           Expand(Expand(Extract('0', Extract(p_gxy, Extract('0', '0'))),
                                         <'serverats', 
                                          h(<
                                             <
                                              <
                                               <
                                                <
                                                 <
                                                  <
                                                   <'0', '1', '0x0303', ~tid, '0', $cipher_suites, '0', 
                                                    <'43', '0x0304'>, <'10', $g1, $g>, <'13', $sig_algs>, 
                                                    '40', $g1, $g1^~x>, 
                                                   '6', '0x0303', '40', $g>, 
                                                  '1', '0x0303', ~tid, '0', $cipher_suites.1, '0', 
                                                  <'43', '0x0304'>, <'10', $g1, $g>, <'13', $sig_algs.1>, 
                                                  '40', $g, $g^~x.1>, 
                                                 '2', '0x0303', p_ns, $cipher_suite, <'13', $sig_algs.2>, 
                                                 '40', $g, p_gy>, 
                                                '8', $exts>, 
                                               '11', '0', pk(~ltkS)>, 
                                              '15', 
                                              sign(<'server_cv', 
                                                    h(<
                                                       <
                                                        <
                                                         <
                                                          <
                                                           <'0', '1', '0x0303', ~tid, '0', $cipher_suites, 
                                                            '0', <'43', '0x0304'>, <'10', $g1, $g>, 
                                                            <'13', $sig_algs>, '40', $g1, $g1^~x>, 
                                                           '6', '0x0303', '40', $g>, 
                                                          '1', '0x0303', ~tid, '0', $cipher_suites.1, '0', 
                                                          <'43', '0x0304'>, <'10', $g1, $g>, 
                                                          <'13', $sig_algs.1>, '40', $g, $g^~x.1>, 
                                                         '2', '0x0303', p_ns, $cipher_suite, 
                                                         <'13', $sig_algs.2>, '40', $g, p_gy>, 
                                                        '8', $exts>, 
                                                       '11', '0', pk(~ltkS)>)
                                                   >,
                                                   ~ltkS)
                                             >, 
                                             '20', 
                                             hmac(<
                                                   Expand(Expand(Extract(p_gxy, Extract('0', '0')),
                                                                 <'serverhts', 
                                                                  h(<
                                                                     <
                                                                      <
                                                                       <
                                                                        <
                                                                         <
                                                                          <'0', '1', '0x0303', ~tid, '0', 
                                                                           $cipher_suites, '0', 
                                                                           <'43', '0x0304'>, <'10', $g1, $g>, 
                                                                           <'13', $sig_algs>, '40', $g1, 
                                                                           $g1^~x>, 
                                                                          '6', '0x0303', '40', $g>, 
                                                                         '1', '0x0303', ~tid, '0', 
                                                                         $cipher_suites.1, '0', 
                                                                         <'43', '0x0304'>, <'10', $g1, $g>, 
                                                                         <'13', $sig_algs.1>, '40', $g, 
                                                                         $g^~x.1>, 
                                                                        '2', '0x0303', p_ns, $cipher_suite, 
                                                                        <'13', $sig_algs.2>, '40', $g, p_gy>, 
                                                                       '8', $exts>, 
                                                                      '11', '0', pk(~ltkS)>, 
                                                                     '15', 
                                                                     sign(<'server_cv', 
                                                                           h(<
                                                                              <
                                                                               <
                                                                                <
                                                                                 <
                                                                                  <'0', '1', '0x0303', ~tid, 
                                                                                   '0', $cipher_suites, '0', 
                                                                                   <'43', '0x0304'>, 
                                                                                   <'10', $g1, $g>, 
                                                                                   <'13', $sig_algs>, '40', 
                                                                                   $g1, $g1^~x>, 
                                                                                  '6', '0x0303', '40', $g>, 
                                                                                 '1', '0x0303', ~tid, '0', 
                                                                                 $cipher_suites.1, '0', 
                                                                                 <'43', '0x0304'>, 
                                                                                 <'10', $g1, $g>, 
                                                                                 <'13', $sig_algs.1>, '40', 
                                                                                 $g, $g^~x.1>, 
                                                                                '2', '0x0303', p_ns, 
                                                                                $cipher_suite, 
                                                                                <'13', $sig_algs.2>, '40', 
                                                                                $g, p_gy>, 
                                                                               '8', $exts>, 
                                                                              '11', '0', pk(~ltkS)>)
                                                                          >,
                                                                          ~ltkS)
                                                                    >)
                                                                 >,
                                                                 '32'),
                                                          <'fin', '0'>, '32'), 
                                                   h(<
                                                      <
                                                       <
                                                        <
                                                         <
                                                          <
                                                           <'0', '1', '0x0303', ~tid, '0', $cipher_suites, 
                                                            '0', <'43', '0x0304'>, <'10', $g1, $g>, 
                                                            <'13', $sig_algs>, '40', $g1, $g1^~x>, 
                                                           '6', '0x0303', '40', $g>, 
                                                          '1', '0x0303', ~tid, '0', $cipher_suites.1, '0', 
                                                          <'43', '0x0304'>, <'10', $g1, $g>, 
                                                          <'13', $sig_algs.1>, '40', $g, $g^~x.1>, 
                                                         '2', '0x0303', p_ns, $cipher_suite, 
                                                         <'13', $sig_algs.2>, '40', $g, p_gy>, 
                                                        '8', $exts>, 
                                                       '11', '0', pk(~ltkS)>, 
                                                      '15', 
                                                      sign(<'server_cv', 
                                                            h(<
                                                               <
                                                                <
                                                                 <
                                                                  <
                                                                   <'0', '1', '0x0303', ~tid, '0', 
                                                                    $cipher_suites, '0', <'43', '0x0304'>, 
                                                                    <'10', $g1, $g>, <'13', $sig_algs>, '40', 
                                                                    $g1, $g1^~x>, 
                                                                   '6', '0x0303', '40', $g>, 
                                                                  '1', '0x0303', ~tid, '0', $cipher_suites.1, 
                                                                  '0', <'43', '0x0304'>, <'10', $g1, $g>, 
                                                                  <'13', $sig_algs.1>, '40', $g, $g^~x.1>, 
                                                                 '2', '0x0303', p_ns, $cipher_suite, 
                                                                 <'13', $sig_algs.2>, '40', $g, p_gy>, 
                                                                '8', $exts>, 
                                                               '11', '0', pk(~ltkS)>)
                                                           >,
                                                           ~ltkS)
                                                     >)
                                                  >)
                                            >)
                                         >,
                                         '32'),
                                  <'adke_wk', '0'>, '32')
                ) ▶₀ #l )
    next
      case recv_server_auth_case_03
      by solve( SecretPSK( $A,
                           Expand(Expand(Extract('0', Extract(p_gxy, Extract(~res_psk, '0'))),
                                         <'serverats', 
                                          h(<
                                             <
                                              <
                                               <
                                                <
                                                 <
                                                  <
                                                   <'0', '1', '0x0303', ~tid, '0', $cipher_suites, '0', 
                                                    <'43', '0x0304'>, <'10', $g1, $g>, <'40', $g1, $g1^~x>, 
                                                    <'45', '0', '1'>, <'42', '0'>, '41', 
                                                    <~ticket, mask(~ticket_age_add, $ticket_age)>, 
                                                    hmac(<
                                                          Expand(Expand(Extract(~res_psk, '0'),
                                                                        <'ext', 'pbk'>, '32'),
                                                                 <'0', '0'>, '32'), 
                                                          h(<'0', '1', '0x0303', ~tid, '0', $cipher_suites, 
                                                             '0', <'43', '0x0304'>, <'10', $g1, $g>, 
                                                             <'40', $g1, $g1^~x>, <'45', '0', '1'>, 
                                                             <'42', '0'>, '41', 
                                                             <~ticket, mask(~ticket_age_add, $ticket_age)>, 
                                                             '0'>)
                                                         >)
                                                   >, 
                                                   '6', '0x0303', '40', $g>, 
                                                  '1', '0x0303', ~tid, '0', $cipher_suites.1, '0', 
                                                  <'43', '0x0304'>, <'10', $g1, $g>, <'13', $sig_algs>, '40', 
                                                  $g, $g^~x.1>, 
                                                 '2', '0x0303', p_ns, $cipher_suite, <'13', $sig_algs.1>, 
                                                 '40', $g, p_gy>, 
                                                '8', $exts>, 
                                               '11', '0', pk(~ltkS)>, 
                                              '15', 
                                              sign(<'server_cv', 
                                                    h(<
                                                       <
                                                        <
                                                         <
                                                          <
                                                           <'0', '1', '0x0303', ~tid, '0', $cipher_suites, 
                                                            '0', <'43', '0x0304'>, <'10', $g1, $g>, 
                                                            <'40', $g1, $g1^~x>, <'45', '0', '1'>, 
                                                            <'42', '0'>, '41', 
                                                            <~ticket, mask(~ticket_age_add, $ticket_age)>, 
                                                            hmac(<
                                                                  Expand(Expand(Extract(~res_psk, '0'),
                                                                                <'ext', 'pbk'>, '32'),
                                                                         <'0', '0'>, '32'), 
                                                                  h(<'0', '1', '0x0303', ~tid, '0', 
                                                                     $cipher_suites, '0', <'43', '0x0304'>, 
                                                                     <'10', $g1, $g>, <'40', $g1, $g1^~x>, 
                                                                     <'45', '0', '1'>, <'42', '0'>, '41', 
                                                                     <~ticket, 
                                                                      mask(~ticket_age_add, $ticket_age)>, 
                                                                     '0'>)
                                                                 >)
                                                           >, 
                                                           '6', '0x0303', '40', $g>, 
                                                          '1', '0x0303', ~tid, '0', $cipher_suites.1, '0', 
                                                          <'43', '0x0304'>, <'10', $g1, $g>, 
                                                          <'13', $sig_algs>, '40', $g, $g^~x.1>, 
                                                         '2', '0x0303', p_ns, $cipher_suite, 
                                                         <'13', $sig_algs.1>, '40', $g, p_gy>, 
                                                        '8', $exts>, 
                                                       '11', '0', pk(~ltkS)>)
                                                   >,
                                                   ~ltkS)
                                             >, 
                                             '20', 
                                             hmac(<
                                                   Expand(Expand(Extract(p_gxy, Extract(~res_psk, '0')),
                                                                 <'serverhts', 
                                                                  h(<
                                                                     <
                                                                      <
                                                                       <
                                                                        <
                                                                         <
                                                                          <'0', '1', '0x0303', ~tid, '0', 
                                                                           $cipher_suites, '0', 
                                                                           <'43', '0x0304'>, <'10', $g1, $g>, 
                                                                           <'40', $g1, $g1^~x>, 
                                                                           <'45', '0', '1'>, <'42', '0'>, 
                                                                           '41', 
                                                                           <~ticket, 
                                                                            mask(~ticket_age_add, $ticket_age)
                                                                           >, 
                                                                           hmac(<
                                                                                 Expand(Expand(Extract(~res_psk,
                                                                                                       '0'),
                                                                                               <'ext', 'pbk'>,
                                                                                               '32'),
                                                                                        <'0', '0'>, '32'), 
                                                                                 h(<'0', '1', '0x0303', ~tid, 
                                                                                    '0', $cipher_suites, '0', 
                                                                                    <'43', '0x0304'>, 
                                                                                    <'10', $g1, $g>, 
                                                                                    <'40', $g1, $g1^~x>, 
                                                                                    <'45', '0', '1'>, 
                                                                                    <'42', '0'>, '41', 
                                                                                    <~ticket, 
                                                                                     mask(~ticket_age_add,
                                                                                          $ticket_age)
                                                                                    >, 
                                                                                    '0'>)
                                                                                >)
                                                                          >, 
                                                                          '6', '0x0303', '40', $g>, 
                                                                         '1', '0x0303', ~tid, '0', 
                                                                         $cipher_suites.1, '0', 
                                                                         <'43', '0x0304'>, <'10', $g1, $g>, 
                                                                         <'13', $sig_algs>, '40', $g, $g^~x.1
                                                                        >, 
                                                                        '2', '0x0303', p_ns, $cipher_suite, 
                                                                        <'13', $sig_algs.1>, '40', $g, p_gy>, 
                                                                       '8', $exts>, 
                                                                      '11', '0', pk(~ltkS)>, 
                                                                     '15', 
                                                                     sign(<'server_cv', 
                                                                           h(<
                                                                              <
                                                                               <
                                                                                <
                                                                                 <
                                                                                  <'0', '1', '0x0303', ~tid, 
                                                                                   '0', $cipher_suites, '0', 
                                                                                   <'43', '0x0304'>, 
                                                                                   <'10', $g1, $g>, 
                                                                                   <'40', $g1, $g1^~x>, 
                                                                                   <'45', '0', '1'>, 
                                                                                   <'42', '0'>, '41', 
                                                                                   <~ticket, 
                                                                                    mask(~ticket_age_add,
                                                                                         $ticket_age)
                                                                                   >, 
                                                                                   hmac(<
                                                                                         Expand(Expand(Extract(~res_psk,
                                                                                                               '0'),
                                                                                                       <
                                                                                                        'ext', 
                                                                                                        'pbk'
                                                                                                       >,
                                                                                                       '32'),
                                                                                                <'0', '0'>,
                                                                                                '32'), 
                                                                                         h(<'0', '1', 
                                                                                            '0x0303', ~tid, 
                                                                                            '0', 
                                                                                            $cipher_suites, 
                                                                                            '0', 
                                                                                            <'43', '0x0304'>, 
                                                                                            <'10', $g1, $g>, 
                                                                                            <'40', $g1, $g1^~x
                                                                                            >, 
                                                                                            <'45', '0', '1'>, 
                                                                                            <'42', '0'>, 
                                                                                            '41', 
                                                                                            <~ticket, 
                                                                                             mask(~ticket_age_add,
                                                                                                  $ticket_age)
                                                                                            >, 
                                                                                            '0'>)
                                                                                        >)
                                                                                  >, 
                                                                                  '6', '0x0303', '40', $g>, 
                                                                                 '1', '0x0303', ~tid, '0', 
                                                                                 $cipher_suites.1, '0', 
                                                                                 <'43', '0x0304'>, 
                                                                                 <'10', $g1, $g>, 
                                                                                 <'13', $sig_algs>, '40', $g, 
                                                                                 $g^~x.1>, 
                                                                                '2', '0x0303', p_ns, 
                                                                                $cipher_suite, 
                                                                                <'13', $sig_algs.1>, '40', 
                                                                                $g, p_gy>, 
                                                                               '8', $exts>, 
                                                                              '11', '0', pk(~ltkS)>)
                                                                          >,
                                                                          ~ltkS)
                                                                    >)
                                                                 >,
                                                                 '32'),
                                                          <'fin', '0'>, '32'), 
                                                   h(<
                                                      <
                                                       <
                                                        <
                                                         <
                                                          <
                                                           <'0', '1', '0x0303', ~tid, '0', $cipher_suites, 
                                                            '0', <'43', '0x0304'>, <'10', $g1, $g>, 
                                                            <'40', $g1, $g1^~x>, <'45', '0', '1'>, 
                                                            <'42', '0'>, '41', 
                                                            <~ticket, mask(~ticket_age_add, $ticket_age)>, 
                                                            hmac(<
                                                                  Expand(Expand(Extract(~res_psk, '0'),
                                                                                <'ext', 'pbk'>, '32'),
                                                                         <'0', '0'>, '32'), 
                                                                  h(<'0', '1', '0x0303', ~tid, '0', 
                                                                     $cipher_suites, '0', <'43', '0x0304'>, 
                                                                     <'10', $g1, $g>, <'40', $g1, $g1^~x>, 
                                                                     <'45', '0', '1'>, <'42', '0'>, '41', 
                                                                     <~ticket, 
                                                                      mask(~ticket_age_add, $ticket_age)>, 
                                                                     '0'>)
                                                                 >)
                                                           >, 
                                                           '6', '0x0303', '40', $g>, 
                                                          '1', '0x0303', ~tid, '0', $cipher_suites.1, '0', 
                                                          <'43', '0x0304'>, <'10', $g1, $g>, 
                                                          <'13', $sig_algs>, '40', $g, $g^~x.1>, 
                                                         '2', '0x0303', p_ns, $cipher_suite, 
                                                         <'13', $sig_algs.1>, '40', $g, p_gy>, 
                                                        '8', $exts>, 
                                                       '11', '0', pk(~ltkS)>, 
                                                      '15', 
                                                      sign(<'server_cv', 
                                                            h(<
                                                               <
                                                                <
                                                                 <
                                                                  <
                                                                   <'0', '1', '0x0303', ~tid, '0', 
                                                                    $cipher_suites, '0', <'43', '0x0304'>, 
                                                                    <'10', $g1, $g>, <'40', $g1, $g1^~x>, 
                                                                    <'45', '0', '1'>, <'42', '0'>, '41', 
                                                                    <~ticket, 
                                                                     mask(~ticket_age_add, $ticket_age)>, 
                                                                    hmac(<
                                                                          Expand(Expand(Extract(~res_psk,
                                                                                                '0'),
                                                                                        <'ext', 'pbk'>, '32'),
                                                                                 <'0', '0'>, '32'), 
                                                                          h(<'0', '1', '0x0303', ~tid, '0', 
                                                                             $cipher_suites, '0', 
                                                                             <'43', '0x0304'>, 
                                                                             <'10', $g1, $g>, 
                                                                             <'40', $g1, $g1^~x>, 
                                                                             <'45', '0', '1'>, <'42', '0'>, 
                                                                             '41', 
                                                                             <~ticket, 
                                                                              mask(~ticket_age_add,
                                                                                   $ticket_age)
                                                                             >, 
                                                                             '0'>)
                                                                         >)
                                                                   >, 
                                                                   '6', '0x0303', '40', $g>, 
                                                                  '1', '0x0303', ~tid, '0', $cipher_suites.1, 
                                                                  '0', <'43', '0x0304'>, <'10', $g1, $g>, 
                                                                  <'13', $sig_algs>, '40', $g, $g^~x.1>, 
                                                                 '2', '0x0303', p_ns, $cipher_suite, 
                                                                 <'13', $sig_algs.1>, '40', $g, p_gy>, 
                                                                '8', $exts>, 
                                                               '11', '0', pk(~ltkS)>)
                                                           >,
                                                           ~ltkS)
                                                     >)
                                                  >)
                                            >)
                                         >,
                                         '32'),
                                  <'adke_wk', '0'>, '32')
                ) ▶₀ #l )
    next
      case recv_server_auth_case_04
      by solve( SecretPSK( $A,
                           Expand(Expand(Extract('0',
                                                 Extract(p_gxy,
                                                         Extract(Expand(ms, <'rms', h(messages)>, '32'),
                                                                 '0'))),
                                         <'serverats', 
                                          h(<
                                             <
                                              <
                                               <
                                                <
                                                 <
                                                  <
                                                   <'0', '1', '0x0303', ~tid, '0', $cipher_suites, '0', 
                                                    <'43', '0x0304'>, <'10', $g1, $g>, <'40', $g1, $g1^~x>, 
                                                    <'45', '0', '1'>, <'42', '0'>, '41', 
                                                    <p_psk_id, mask(ticket_age_add, $ticket_age)>, 
                                                    hmac(<
                                                          Expand(Expand(Extract(Expand(ms,
                                                                                       <'rms', h(messages)>,
                                                                                       '32'),
                                                                                '0'),
                                                                        <'res', 'pbk'>, '32'),
                                                                 <'0', '0'>, '32'), 
                                                          h(<'0', '1', '0x0303', ~tid, '0', $cipher_suites, 
                                                             '0', <'43', '0x0304'>, <'10', $g1, $g>, 
                                                             <'40', $g1, $g1^~x>, <'45', '0', '1'>, 
                                                             <'42', '0'>, '41', 
                                                             <p_psk_id, mask(ticket_age_add, $ticket_age)>, 
                                                             '0'>)
                                                         >)
                                                   >, 
                                                   '6', '0x0303', '40', $g>, 
                                                  '1', '0x0303', ~tid, '0', $cipher_suites.1, '0', 
                                                  <'43', '0x0304'>, <'10', $g1, $g>, <'13', $sig_algs>, '40', 
                                                  $g, $g^~x.1>, 
                                                 '2', '0x0303', p_ns, $cipher_suite, <'13', $sig_algs.1>, 
                                                 '40', $g, p_gy>, 
                                                '8', $exts>, 
                                               '11', '0', pk(~ltkS)>, 
                                              '15', 
                                              sign(<'server_cv', 
                                                    h(<
                                                       <
                                                        <
                                                         <
                                                          <
                                                           <'0', '1', '0x0303', ~tid, '0', $cipher_suites, 
                                                            '0', <'43', '0x0304'>, <'10', $g1, $g>, 
                                                            <'40', $g1, $g1^~x>, <'45', '0', '1'>, 
                                                            <'42', '0'>, '41', 
                                                            <p_psk_id, mask(ticket_age_add, $ticket_age)>, 
                                                            hmac(<
                                                                  Expand(Expand(Extract(Expand(ms,
                                                                                               <'rms', 
                                                                                                h(messages)>,
                                                                                               '32'),
                                                                                        '0'),
                                                                                <'res', 'pbk'>, '32'),
                                                                         <'0', '0'>, '32'), 
                                                                  h(<'0', '1', '0x0303', ~tid, '0', 
                                                                     $cipher_suites, '0', <'43', '0x0304'>, 
                                                                     <'10', $g1, $g>, <'40', $g1, $g1^~x>, 
                                                                     <'45', '0', '1'>, <'42', '0'>, '41', 
                                                                     <p_psk_id, 
                                                                      mask(ticket_age_add, $ticket_age)>, 
                                                                     '0'>)
                                                                 >)
                                                           >, 
                                                           '6', '0x0303', '40', $g>, 
                                                          '1', '0x0303', ~tid, '0', $cipher_suites.1, '0', 
                                                          <'43', '0x0304'>, <'10', $g1, $g>, 
                                                          <'13', $sig_algs>, '40', $g, $g^~x.1>, 
                                                         '2', '0x0303', p_ns, $cipher_suite, 
                                                         <'13', $sig_algs.1>, '40', $g, p_gy>, 
                                                        '8', $exts>, 
                                                       '11', '0', pk(~ltkS)>)
                                                   >,
                                                   ~ltkS)
                                             >, 
                                             '20', 
                                             hmac(<
                                                   Expand(Expand(Extract(p_gxy,
                                                                         Extract(Expand(ms,
                                                                                        <'rms', h(messages)>,
                                                                                        '32'),
                                                                                 '0')),
                                                                 <'serverhts', 
                                                                  h(<
                                                                     <
                                                                      <
                                                                       <
                                                                        <
                                                                         <
                                                                          <'0', '1', '0x0303', ~tid, '0', 
                                                                           $cipher_suites, '0', 
                                                                           <'43', '0x0304'>, <'10', $g1, $g>, 
                                                                           <'40', $g1, $g1^~x>, 
                                                                           <'45', '0', '1'>, <'42', '0'>, 
                                                                           '41', 
                                                                           <p_psk_id, 
                                                                            mask(ticket_age_add, $ticket_age)
                                                                           >, 
                                                                           hmac(<
                                                                                 Expand(Expand(Extract(Expand(ms,
                                                                                                              <
                                                                                                               'rms', 
                                                                                                               h(messages)
                                                                                                              >,
                                                                                                              '32'),
                                                                                                       '0'),
                                                                                               <'res', 'pbk'>,
                                                                                               '32'),
                                                                                        <'0', '0'>, '32'), 
                                                                                 h(<'0', '1', '0x0303', ~tid, 
                                                                                    '0', $cipher_suites, '0', 
                                                                                    <'43', '0x0304'>, 
                                                                                    <'10', $g1, $g>, 
                                                                                    <'40', $g1, $g1^~x>, 
                                                                                    <'45', '0', '1'>, 
                                                                                    <'42', '0'>, '41', 
                                                                                    <p_psk_id, 
                                                                                     mask(ticket_age_add,
                                                                                          $ticket_age)
                                                                                    >, 
                                                                                    '0'>)
                                                                                >)
                                                                          >, 
                                                                          '6', '0x0303', '40', $g>, 
                                                                         '1', '0x0303', ~tid, '0', 
                                                                         $cipher_suites.1, '0', 
                                                                         <'43', '0x0304'>, <'10', $g1, $g>, 
                                                                         <'13', $sig_algs>, '40', $g, $g^~x.1
                                                                        >, 
                                                                        '2', '0x0303', p_ns, $cipher_suite, 
                                                                        <'13', $sig_algs.1>, '40', $g, p_gy>, 
                                                                       '8', $exts>, 
                                                                      '11', '0', pk(~ltkS)>, 
                                                                     '15', 
                                                                     sign(<'server_cv', 
                                                                           h(<
                                                                              <
                                                                               <
                                                                                <
                                                                                 <
                                                                                  <'0', '1', '0x0303', ~tid, 
                                                                                   '0', $cipher_suites, '0', 
                                                                                   <'43', '0x0304'>, 
                                                                                   <'10', $g1, $g>, 
                                                                                   <'40', $g1, $g1^~x>, 
                                                                                   <'45', '0', '1'>, 
                                                                                   <'42', '0'>, '41', 
                                                                                   <p_psk_id, 
                                                                                    mask(ticket_age_add,
                                                                                         $ticket_age)
                                                                                   >, 
                                                                                   hmac(<
                                                                                         Expand(Expand(Extract(Expand(ms,
                                                                                                                      <
                                                                                                                       'rms', 
                                                                                                                       h(messages)
                                                                                                                      >,
                                                                                                                      '32'),
                                                                                                               '0'),
                                                                                                       <
                                                                                                        'res', 
                                                                                                        'pbk'
                                                                                                       >,
                                                                                                       '32'),
                                                                                                <'0', '0'>,
                                                                                                '32'), 
                                                                                         h(<'0', '1', 
                                                                                            '0x0303', ~tid, 
                                                                                            '0', 
                                                                                            $cipher_suites, 
                                                                                            '0', 
                                                                                            <'43', '0x0304'>, 
                                                                                            <'10', $g1, $g>, 
                                                                                            <'40', $g1, $g1^~x
                                                                                            >, 
                                                                                            <'45', '0', '1'>, 
                                                                                            <'42', '0'>, 
                                                                                            '41', 
                                                                                            <p_psk_id, 
                                                                                             mask(ticket_age_add,
                                                                                                  $ticket_age)
                                                                                            >, 
                                                                                            '0'>)
                                                                                        >)
                                                                                  >, 
                                                                                  '6', '0x0303', '40', $g>, 
                                                                                 '1', '0x0303', ~tid, '0', 
                                                                                 $cipher_suites.1, '0', 
                                                                                 <'43', '0x0304'>, 
                                                                                 <'10', $g1, $g>, 
                                                                                 <'13', $sig_algs>, '40', $g, 
                                                                                 $g^~x.1>, 
                                                                                '2', '0x0303', p_ns, 
                                                                                $cipher_suite, 
                                                                                <'13', $sig_algs.1>, '40', 
                                                                                $g, p_gy>, 
                                                                               '8', $exts>, 
                                                                              '11', '0', pk(~ltkS)>)
                                                                          >,
                                                                          ~ltkS)
                                                                    >)
                                                                 >,
                                                                 '32'),
                                                          <'fin', '0'>, '32'), 
                                                   h(<
                                                      <
                                                       <
                                                        <
                                                         <
                                                          <
                                                           <'0', '1', '0x0303', ~tid, '0', $cipher_suites, 
                                                            '0', <'43', '0x0304'>, <'10', $g1, $g>, 
                                                            <'40', $g1, $g1^~x>, <'45', '0', '1'>, 
                                                            <'42', '0'>, '41', 
                                                            <p_psk_id, mask(ticket_age_add, $ticket_age)>, 
                                                            hmac(<
                                                                  Expand(Expand(Extract(Expand(ms,
                                                                                               <'rms', 
                                                                                                h(messages)>,
                                                                                               '32'),
                                                                                        '0'),
                                                                                <'res', 'pbk'>, '32'),
                                                                         <'0', '0'>, '32'), 
                                                                  h(<'0', '1', '0x0303', ~tid, '0', 
                                                                     $cipher_suites, '0', <'43', '0x0304'>, 
                                                                     <'10', $g1, $g>, <'40', $g1, $g1^~x>, 
                                                                     <'45', '0', '1'>, <'42', '0'>, '41', 
                                                                     <p_psk_id, 
                                                                      mask(ticket_age_add, $ticket_age)>, 
                                                                     '0'>)
                                                                 >)
                                                           >, 
                                                           '6', '0x0303', '40', $g>, 
                                                          '1', '0x0303', ~tid, '0', $cipher_suites.1, '0', 
                                                          <'43', '0x0304'>, <'10', $g1, $g>, 
                                                          <'13', $sig_algs>, '40', $g, $g^~x.1>, 
                                                         '2', '0x0303', p_ns, $cipher_suite, 
                                                         <'13', $sig_algs.1>, '40', $g, p_gy>, 
                                                        '8', $exts>, 
                                                       '11', '0', pk(~ltkS)>, 
                                                      '15', 
                                                      sign(<'server_cv', 
                                                            h(<
                                                               <
                                                                <
                                                                 <
                                                                  <
                                                                   <'0', '1', '0x0303', ~tid, '0', 
                                                                    $cipher_suites, '0', <'43', '0x0304'>, 
                                                                    <'10', $g1, $g>, <'40', $g1, $g1^~x>, 
                                                                    <'45', '0', '1'>, <'42', '0'>, '41', 
                                                                    <p_psk_id, 
                                                                     mask(ticket_age_add, $ticket_age)>, 
                                                                    hmac(<
                                                                          Expand(Expand(Extract(Expand(ms,
                                                                                                       <
                                                                                                        'rms', 
                                                                                                        h(messages)
                                                                                                       >,
                                                                                                       '32'),
                                                                                                '0'),
                                                                                        <'res', 'pbk'>, '32'),
                                                                                 <'0', '0'>, '32'), 
                                                                          h(<'0', '1', '0x0303', ~tid, '0', 
                                                                             $cipher_suites, '0', 
                                                                             <'43', '0x0304'>, 
                                                                             <'10', $g1, $g>, 
                                                                             <'40', $g1, $g1^~x>, 
                                                                             <'45', '0', '1'>, <'42', '0'>, 
                                                                             '41', 
                                                                             <p_psk_id, 
                                                                              mask(ticket_age_add,
                                                                                   $ticket_age)
                                                                             >, 
                                                                             '0'>)
                                                                         >)
                                                                   >, 
                                                                   '6', '0x0303', '40', $g>, 
                                                                  '1', '0x0303', ~tid, '0', $cipher_suites.1, 
                                                                  '0', <'43', '0x0304'>, <'10', $g1, $g>, 
                                                                  <'13', $sig_algs>, '40', $g, $g^~x.1>, 
                                                                 '2', '0x0303', p_ns, $cipher_suite, 
                                                                 <'13', $sig_algs.1>, '40', $g, p_gy>, 
                                                                '8', $exts>, 
                                                               '11', '0', pk(~ltkS)>)
                                                           >,
                                                           ~ltkS)
                                                     >)
                                                  >)
                                            >)
                                         >,
                                         '32'),
                                  <'adke_wk', '0'>, '32')
                ) ▶₀ #l )
    next
      case recv_server_auth_case_05
      by solve( SecretPSK( $A,
                           Expand(Expand(Extract('0', Extract(p_gxy, Extract(~res_psk, '0'))),
                                         <'serverats', 
                                          h(<
                                             <
                                              <
                                               <
                                                <
                                                 <'0', '1', '0x0303', ~tid, '0', $cipher_suites, '0', 
                                                  <'43', '0x0304'>, <'10', $g, $g2>, <'40', $g, $g^~x>, 
                                                  <'45', '0', '1'>, <'42', '0'>, '41', 
                                                  <~ticket, mask(~ticket_age_add, $ticket_age)>, 
                                                  hmac(<
                                                        Expand(Expand(Extract(~res_psk, '0'), <'ext', 'pbk'>,
                                                                      '32'),
                                                               <'0', '0'>, '32'), 
                                                        h(<'0', '1', '0x0303', ~tid, '0', $cipher_suites, 
                                                           '0', <'43', '0x0304'>, <'10', $g, $g2>, 
                                                           <'40', $g, $g^~x>, <'45', '0', '1'>, <'42', '0'>, 
                                                           '41', 
                                                           <~ticket, mask(~ticket_age_add, $ticket_age)>, '0'
                                                          >)
                                                       >)
                                                 >, 
                                                 '2', '0x0303', p_ns, $cipher_suite, <'13', $sig_algs>, '40', 
                                                 $g, p_gy>, 
                                                '8', $exts>, 
                                               '11', '0', pk(~ltkS)>, 
                                              '15', 
                                              sign(<'server_cv', 
                                                    h(<
                                                       <
                                                        <
                                                         <'0', '1', '0x0303', ~tid, '0', $cipher_suites, '0', 
                                                          <'43', '0x0304'>, <'10', $g, $g2>, 
                                                          <'40', $g, $g^~x>, <'45', '0', '1'>, <'42', '0'>, 
                                                          '41', 
                                                          <~ticket, mask(~ticket_age_add, $ticket_age)>, 
                                                          hmac(<
                                                                Expand(Expand(Extract(~res_psk, '0'),
                                                                              <'ext', 'pbk'>, '32'),
                                                                       <'0', '0'>, '32'), 
                                                                h(<'0', '1', '0x0303', ~tid, '0', 
                                                                   $cipher_suites, '0', <'43', '0x0304'>, 
                                                                   <'10', $g, $g2>, <'40', $g, $g^~x>, 
                                                                   <'45', '0', '1'>, <'42', '0'>, '41', 
                                                                   <~ticket, 
                                                                    mask(~ticket_age_add, $ticket_age)>, 
                                                                   '0'>)
                                                               >)
                                                         >, 
                                                         '2', '0x0303', p_ns, $cipher_suite, 
                                                         <'13', $sig_algs>, '40', $g, p_gy>, 
                                                        '8', $exts>, 
                                                       '11', '0', pk(~ltkS)>)
                                                   >,
                                                   ~ltkS)
                                             >, 
                                             '20', 
                                             hmac(<
                                                   Expand(Expand(Extract(p_gxy, Extract(~res_psk, '0')),
                                                                 <'serverhts', 
                                                                  h(<
                                                                     <
                                                                      <
                                                                       <
                                                                        <'0', '1', '0x0303', ~tid, '0', 
                                                                         $cipher_suites, '0', 
                                                                         <'43', '0x0304'>, <'10', $g, $g2>, 
                                                                         <'40', $g, $g^~x>, <'45', '0', '1'>, 
                                                                         <'42', '0'>, '41', 
                                                                         <~ticket, 
                                                                          mask(~ticket_age_add, $ticket_age)
                                                                         >, 
                                                                         hmac(<
                                                                               Expand(Expand(Extract(~res_psk,
                                                                                                     '0'),
                                                                                             <'ext', 'pbk'>,
                                                                                             '32'),
                                                                                      <'0', '0'>, '32'), 
                                                                               h(<'0', '1', '0x0303', ~tid, 
                                                                                  '0', $cipher_suites, '0', 
                                                                                  <'43', '0x0304'>, 
                                                                                  <'10', $g, $g2>, 
                                                                                  <'40', $g, $g^~x>, 
                                                                                  <'45', '0', '1'>, 
                                                                                  <'42', '0'>, '41', 
                                                                                  <~ticket, 
                                                                                   mask(~ticket_age_add,
                                                                                        $ticket_age)
                                                                                  >, 
                                                                                  '0'>)
                                                                              >)
                                                                        >, 
                                                                        '2', '0x0303', p_ns, $cipher_suite, 
                                                                        <'13', $sig_algs>, '40', $g, p_gy>, 
                                                                       '8', $exts>, 
                                                                      '11', '0', pk(~ltkS)>, 
                                                                     '15', 
                                                                     sign(<'server_cv', 
                                                                           h(<
                                                                              <
                                                                               <
                                                                                <'0', '1', '0x0303', ~tid, 
                                                                                 '0', $cipher_suites, '0', 
                                                                                 <'43', '0x0304'>, 
                                                                                 <'10', $g, $g2>, 
                                                                                 <'40', $g, $g^~x>, 
                                                                                 <'45', '0', '1'>, 
                                                                                 <'42', '0'>, '41', 
                                                                                 <~ticket, 
                                                                                  mask(~ticket_age_add,
                                                                                       $ticket_age)
                                                                                 >, 
                                                                                 hmac(<
                                                                                       Expand(Expand(Extract(~res_psk,
                                                                                                             '0'),
                                                                                                     <'ext', 
                                                                                                      'pbk'>,
                                                                                                     '32'),
                                                                                              <'0', '0'>,
                                                                                              '32'), 
                                                                                       h(<'0', '1', '0x0303', 
                                                                                          ~tid, '0', 
                                                                                          $cipher_suites, 
                                                                                          '0', 
                                                                                          <'43', '0x0304'>, 
                                                                                          <'10', $g, $g2>, 
                                                                                          <'40', $g, $g^~x>, 
                                                                                          <'45', '0', '1'>, 
                                                                                          <'42', '0'>, '41', 
                                                                                          <~ticket, 
                                                                                           mask(~ticket_age_add,
                                                                                                $ticket_age)
                                                                                          >, 
                                                                                          '0'>)
                                                                                      >)
                                                                                >, 
                                                                                '2', '0x0303', p_ns, 
                                                                                $cipher_suite, 
                                                                                <'13', $sig_algs>, '40', $g, 
                                                                                p_gy>, 
                                                                               '8', $exts>, 
                                                                              '11', '0', pk(~ltkS)>)
                                                                          >,
                                                                          ~ltkS)
                                                                    >)
                                                                 >,
                                                                 '32'),
                                                          <'fin', '0'>, '32'), 
                                                   h(<
                                                      <
                                                       <
                                                        <
                                                         <'0', '1', '0x0303', ~tid, '0', $cipher_suites, '0', 
                                                          <'43', '0x0304'>, <'10', $g, $g2>, 
                                                          <'40', $g, $g^~x>, <'45', '0', '1'>, <'42', '0'>, 
                                                          '41', 
                                                          <~ticket, mask(~ticket_age_add, $ticket_age)>, 
                                                          hmac(<
                                                                Expand(Expand(Extract(~res_psk, '0'),
                                                                              <'ext', 'pbk'>, '32'),
                                                                       <'0', '0'>, '32'), 
                                                                h(<'0', '1', '0x0303', ~tid, '0', 
                                                                   $cipher_suites, '0', <'43', '0x0304'>, 
                                                                   <'10', $g, $g2>, <'40', $g, $g^~x>, 
                                                                   <'45', '0', '1'>, <'42', '0'>, '41', 
                                                                   <~ticket, 
                                                                    mask(~ticket_age_add, $ticket_age)>, 
                                                                   '0'>)
                                                               >)
                                                         >, 
                                                         '2', '0x0303', p_ns, $cipher_suite, 
                                                         <'13', $sig_algs>, '40', $g, p_gy>, 
                                                        '8', $exts>, 
                                                       '11', '0', pk(~ltkS)>, 
                                                      '15', 
                                                      sign(<'server_cv', 
                                                            h(<
                                                               <
                                                                <
                                                                 <'0', '1', '0x0303', ~tid, '0', 
                                                                  $cipher_suites, '0', <'43', '0x0304'>, 
                                                                  <'10', $g, $g2>, <'40', $g, $g^~x>, 
                                                                  <'45', '0', '1'>, <'42', '0'>, '41', 
                                                                  <~ticket, mask(~ticket_age_add, $ticket_age)
                                                                  >, 
                                                                  hmac(<
                                                                        Expand(Expand(Extract(~res_psk, '0'),
                                                                                      <'ext', 'pbk'>, '32'),
                                                                               <'0', '0'>, '32'), 
                                                                        h(<'0', '1', '0x0303', ~tid, '0', 
                                                                           $cipher_suites, '0', 
                                                                           <'43', '0x0304'>, <'10', $g, $g2>, 
                                                                           <'40', $g, $g^~x>, 
                                                                           <'45', '0', '1'>, <'42', '0'>, 
                                                                           '41', 
                                                                           <~ticket, 
                                                                            mask(~ticket_age_add, $ticket_age)
                                                                           >, 
                                                                           '0'>)
                                                                       >)
                                                                 >, 
                                                                 '2', '0x0303', p_ns, $cipher_suite, 
                                                                 <'13', $sig_algs>, '40', $g, p_gy>, 
                                                                '8', $exts>, 
                                                               '11', '0', pk(~ltkS)>)
                                                           >,
                                                           ~ltkS)
                                                     >)
                                                  >)
                                            >)
                                         >,
                                         '32'),
                                  <'adke_wk', '0'>, '32')
                ) ▶₀ #l )
    next
      case recv_server_auth_case_06
      by solve( SecretPSK( $A,
                           Expand(Expand(Extract('0',
                                                 Extract(p_gxy,
                                                         Extract(Expand(ms, <'rms', h(messages)>, '32'),
                                                                 '0'))),
                                         <'serverats', 
                                          h(<
                                             <
                                              <
                                               <
                                                <
                                                 <'0', '1', '0x0303', ~tid, '0', $cipher_suites, '0', 
                                                  <'43', '0x0304'>, <'10', $g, $g2>, <'40', $g, $g^~x>, 
                                                  <'45', '0', '1'>, <'42', '0'>, '41', 
                                                  <p_psk_id, mask(ticket_age_add, $ticket_age)>, 
                                                  hmac(<
                                                        Expand(Expand(Extract(Expand(ms, <'rms', h(messages)>,
                                                                                     '32'),
                                                                              '0'),
                                                                      <'res', 'pbk'>, '32'),
                                                               <'0', '0'>, '32'), 
                                                        h(<'0', '1', '0x0303', ~tid, '0', $cipher_suites, 
                                                           '0', <'43', '0x0304'>, <'10', $g, $g2>, 
                                                           <'40', $g, $g^~x>, <'45', '0', '1'>, <'42', '0'>, 
                                                           '41', 
                                                           <p_psk_id, mask(ticket_age_add, $ticket_age)>, '0'
                                                          >)
                                                       >)
                                                 >, 
                                                 '2', '0x0303', p_ns, $cipher_suite, <'13', $sig_algs>, '40', 
                                                 $g, p_gy>, 
                                                '8', $exts>, 
                                               '11', '0', pk(~ltkS)>, 
                                              '15', 
                                              sign(<'server_cv', 
                                                    h(<
                                                       <
                                                        <
                                                         <'0', '1', '0x0303', ~tid, '0', $cipher_suites, '0', 
                                                          <'43', '0x0304'>, <'10', $g, $g2>, 
                                                          <'40', $g, $g^~x>, <'45', '0', '1'>, <'42', '0'>, 
                                                          '41', 
                                                          <p_psk_id, mask(ticket_age_add, $ticket_age)>, 
                                                          hmac(<
                                                                Expand(Expand(Extract(Expand(ms,
                                                                                             <'rms', 
                                                                                              h(messages)>,
                                                                                             '32'),
                                                                                      '0'),
                                                                              <'res', 'pbk'>, '32'),
                                                                       <'0', '0'>, '32'), 
                                                                h(<'0', '1', '0x0303', ~tid, '0', 
                                                                   $cipher_suites, '0', <'43', '0x0304'>, 
                                                                   <'10', $g, $g2>, <'40', $g, $g^~x>, 
                                                                   <'45', '0', '1'>, <'42', '0'>, '41', 
                                                                   <p_psk_id, 
                                                                    mask(ticket_age_add, $ticket_age)>, 
                                                                   '0'>)
                                                               >)
                                                         >, 
                                                         '2', '0x0303', p_ns, $cipher_suite, 
                                                         <'13', $sig_algs>, '40', $g, p_gy>, 
                                                        '8', $exts>, 
                                                       '11', '0', pk(~ltkS)>)
                                                   >,
                                                   ~ltkS)
                                             >, 
                                             '20', 
                                             hmac(<
                                                   Expand(Expand(Extract(p_gxy,
                                                                         Extract(Expand(ms,
                                                                                        <'rms', h(messages)>,
                                                                                        '32'),
                                                                                 '0')),
                                                                 <'serverhts', 
                                                                  h(<
                                                                     <
                                                                      <
                                                                       <
                                                                        <'0', '1', '0x0303', ~tid, '0', 
                                                                         $cipher_suites, '0', 
                                                                         <'43', '0x0304'>, <'10', $g, $g2>, 
                                                                         <'40', $g, $g^~x>, <'45', '0', '1'>, 
                                                                         <'42', '0'>, '41', 
                                                                         <p_psk_id, 
                                                                          mask(ticket_age_add, $ticket_age)>, 
                                                                         hmac(<
                                                                               Expand(Expand(Extract(Expand(ms,
                                                                                                            <
                                                                                                             'rms', 
                                                                                                             h(messages)
                                                                                                            >,
                                                                                                            '32'),
                                                                                                     '0'),
                                                                                             <'res', 'pbk'>,
                                                                                             '32'),
                                                                                      <'0', '0'>, '32'), 
                                                                               h(<'0', '1', '0x0303', ~tid, 
                                                                                  '0', $cipher_suites, '0', 
                                                                                  <'43', '0x0304'>, 
                                                                                  <'10', $g, $g2>, 
                                                                                  <'40', $g, $g^~x>, 
                                                                                  <'45', '0', '1'>, 
                                                                                  <'42', '0'>, '41', 
                                                                                  <p_psk_id, 
                                                                                   mask(ticket_age_add,
                                                                                        $ticket_age)
                                                                                  >, 
                                                                                  '0'>)
                                                                              >)
                                                                        >, 
                                                                        '2', '0x0303', p_ns, $cipher_suite, 
                                                                        <'13', $sig_algs>, '40', $g, p_gy>, 
                                                                       '8', $exts>, 
                                                                      '11', '0', pk(~ltkS)>, 
                                                                     '15', 
                                                                     sign(<'server_cv', 
                                                                           h(<
                                                                              <
                                                                               <
                                                                                <'0', '1', '0x0303', ~tid, 
                                                                                 '0', $cipher_suites, '0', 
                                                                                 <'43', '0x0304'>, 
                                                                                 <'10', $g, $g2>, 
                                                                                 <'40', $g, $g^~x>, 
                                                                                 <'45', '0', '1'>, 
                                                                                 <'42', '0'>, '41', 
                                                                                 <p_psk_id, 
                                                                                  mask(ticket_age_add,
                                                                                       $ticket_age)
                                                                                 >, 
                                                                                 hmac(<
                                                                                       Expand(Expand(Extract(Expand(ms,
                                                                                                                    <
                                                                                                                     'rms', 
                                                                                                                     h(messages)
                                                                                                                    >,
                                                                                                                    '32'),
                                                                                                             '0'),
                                                                                                     <'res', 
                                                                                                      'pbk'>,
                                                                                                     '32'),
                                                                                              <'0', '0'>,
                                                                                              '32'), 
                                                                                       h(<'0', '1', '0x0303', 
                                                                                          ~tid, '0', 
                                                                                          $cipher_suites, 
                                                                                          '0', 
                                                                                          <'43', '0x0304'>, 
                                                                                          <'10', $g, $g2>, 
                                                                                          <'40', $g, $g^~x>, 
                                                                                          <'45', '0', '1'>, 
                                                                                          <'42', '0'>, '41', 
                                                                                          <p_psk_id, 
                                                                                           mask(ticket_age_add,
                                                                                                $ticket_age)
                                                                                          >, 
                                                                                          '0'>)
                                                                                      >)
                                                                                >, 
                                                                                '2', '0x0303', p_ns, 
                                                                                $cipher_suite, 
                                                                                <'13', $sig_algs>, '40', $g, 
                                                                                p_gy>, 
                                                                               '8', $exts>, 
                                                                              '11', '0', pk(~ltkS)>)
                                                                          >,
                                                                          ~ltkS)
                                                                    >)
                                                                 >,
                                                                 '32'),
                                                          <'fin', '0'>, '32'), 
                                                   h(<
                                                      <
                                                       <
                                                        <
                                                         <'0', '1', '0x0303', ~tid, '0', $cipher_suites, '0', 
                                                          <'43', '0x0304'>, <'10', $g, $g2>, 
                                                          <'40', $g, $g^~x>, <'45', '0', '1'>, <'42', '0'>, 
                                                          '41', 
                                                          <p_psk_id, mask(ticket_age_add, $ticket_age)>, 
                                                          hmac(<
                                                                Expand(Expand(Extract(Expand(ms,
                                                                                             <'rms', 
                                                                                              h(messages)>,
                                                                                             '32'),
                                                                                      '0'),
                                                                              <'res', 'pbk'>, '32'),
                                                                       <'0', '0'>, '32'), 
                                                                h(<'0', '1', '0x0303', ~tid, '0', 
                                                                   $cipher_suites, '0', <'43', '0x0304'>, 
                                                                   <'10', $g, $g2>, <'40', $g, $g^~x>, 
                                                                   <'45', '0', '1'>, <'42', '0'>, '41', 
                                                                   <p_psk_id, 
                                                                    mask(ticket_age_add, $ticket_age)>, 
                                                                   '0'>)
                                                               >)
                                                         >, 
                                                         '2', '0x0303', p_ns, $cipher_suite, 
                                                         <'13', $sig_algs>, '40', $g, p_gy>, 
                                                        '8', $exts>, 
                                                       '11', '0', pk(~ltkS)>, 
                                                      '15', 
                                                      sign(<'server_cv', 
                                                            h(<
                                                               <
                                                                <
                                                                 <'0', '1', '0x0303', ~tid, '0', 
                                                                  $cipher_suites, '0', <'43', '0x0304'>, 
                                                                  <'10', $g, $g2>, <'40', $g, $g^~x>, 
                                                                  <'45', '0', '1'>, <'42', '0'>, '41', 
                                                                  <p_psk_id, mask(ticket_age_add, $ticket_age)
                                                                  >, 
                                                                  hmac(<
                                                                        Expand(Expand(Extract(Expand(ms,
                                                                                                     <'rms', 
                                                                                                      h(messages)
                                                                                                     >,
                                                                                                     '32'),
                                                                                              '0'),
                                                                                      <'res', 'pbk'>, '32'),
                                                                               <'0', '0'>, '32'), 
                                                                        h(<'0', '1', '0x0303', ~tid, '0', 
                                                                           $cipher_suites, '0', 
                                                                           <'43', '0x0304'>, <'10', $g, $g2>, 
                                                                           <'40', $g, $g^~x>, 
                                                                           <'45', '0', '1'>, <'42', '0'>, 
                                                                           '41', 
                                                                           <p_psk_id, 
                                                                            mask(ticket_age_add, $ticket_age)
                                                                           >, 
                                                                           '0'>)
                                                                       >)
                                                                 >, 
                                                                 '2', '0x0303', p_ns, $cipher_suite, 
                                                                 <'13', $sig_algs>, '40', $g, p_gy>, 
                                                                '8', $exts>, 
                                                               '11', '0', pk(~ltkS)>)
                                                           >,
                                                           ~ltkS)
                                                     >)
                                                  >)
                                            >)
                                         >,
                                         '32'),
                                  <'adke_wk', '0'>, '32')
                ) ▶₀ #l )
    next
      case recv_server_auth_case_07
      by solve( SecretPSK( $A,
                           Expand(Expand(Extract('0', Extract(p_gxy, Extract(~res_psk, '0'))),
                                         <'serverats', 
                                          h(<
                                             <
                                              <
                                               <
                                                <
                                                 <
                                                  <
                                                   <'0', '1', '0x0303', ~tid, '0', $cipher_suites, '0', 
                                                    <'43', '0x0304'>, <'10', $g1, $g>, <'40', $g1, $g1^~x>, 
                                                    <'45', '0', '1'>, <'42', '0'>, '41', 
                                                    <~ticket, mask(~ticket_age_add, $ticket_age)>, 
                                                    hmac(<
                                                          Expand(Expand(Extract(~res_psk, '0'),
                                                                        <'ext', 'pbk'>, '32'),
                                                                 <'0', '0'>, '32'), 
                                                          h(<'0', '1', '0x0303', ~tid, '0', $cipher_suites, 
                                                             '0', <'43', '0x0304'>, <'10', $g1, $g>, 
                                                             <'40', $g1, $g1^~x>, <'45', '0', '1'>, 
                                                             <'42', '0'>, '41', 
                                                             <~ticket, mask(~ticket_age_add, $ticket_age)>, 
                                                             '0'>)
                                                         >)
                                                   >, 
                                                   '6', '0x0303', '40', $g>, 
                                                  '1', '0x0303', ~new_nc, '0', $cipher_suites.1, '0', 
                                                  <'43', '0x0304'>, <'10', $g1, $g>, <'40', $g, $g^~x.1>, 
                                                  <'45', '0', '1'>, '0', '41', 
                                                  <~ticket, mask(~ticket_age_add, '1')>, 
                                                  hmac(<
                                                        Expand(Expand(Extract(~res_psk, '0'), <'ext', 'pbk'>,
                                                                      '32'),
                                                               <'0', '0'>, '32'), 
                                                        h(<
                                                           <
                                                            <'0', '1', '0x0303', ~tid, '0', $cipher_suites, 
                                                             '0', <'43', '0x0304'>, <'10', $g1, $g>, 
                                                             <'40', $g1, $g1^~x>, <'45', '0', '1'>, 
                                                             <'42', '0'>, '41', 
                                                             <~ticket, mask(~ticket_age_add, $ticket_age)>, 
                                                             hmac(<
                                                                   Expand(Expand(Extract(~res_psk, '0'),
                                                                                 <'ext', 'pbk'>, '32'),
                                                                          <'0', '0'>, '32'), 
                                                                   h(<'0', '1', '0x0303', ~tid, '0', 
                                                                      $cipher_suites, '0', <'43', '0x0304'>, 
                                                                      <'10', $g1, $g>, <'40', $g1, $g1^~x>, 
                                                                      <'45', '0', '1'>, <'42', '0'>, '41', 
                                                                      <~ticket, 
                                                                       mask(~ticket_age_add, $ticket_age)>, 
                                                                      '0'>)
                                                                  >)
                                                            >, 
                                                            '6', '0x0303', '40', $g>, 
                                                           '1', '0x0303', ~new_nc, '0', $cipher_suites.1, 
                                                           '0', <'43', '0x0304'>, <'10', $g1, $g>, 
                                                           <'40', $g, $g^~x.1>, <'45', '0', '1'>, '0', '41', 
                                                           <~ticket, mask(~ticket_age_add, '1')>, '0'>)
                                                       >)
                                                 >, 
                                                 '2', '0x0303', p_ns, $cipher_suite, <'13', $sig_algs>, '40', 
                                                 $g, p_gy>, 
                                                '8', $exts>, 
                                               '11', '0', pk(~ltkS)>, 
                                              '15', 
                                              sign(<'server_cv', 
                                                    h(<
                                                       <
                                                        <
                                                         <
                                                          <
                                                           <'0', '1', '0x0303', ~tid, '0', $cipher_suites, 
                                                            '0', <'43', '0x0304'>, <'10', $g1, $g>, 
                                                            <'40', $g1, $g1^~x>, <'45', '0', '1'>, 
                                                            <'42', '0'>, '41', 
                                                            <~ticket, mask(~ticket_age_add, $ticket_age)>, 
                                                            hmac(<
                                                                  Expand(Expand(Extract(~res_psk, '0'),
                                                                                <'ext', 'pbk'>, '32'),
                                                                         <'0', '0'>, '32'), 
                                                                  h(<'0', '1', '0x0303', ~tid, '0', 
                                                                     $cipher_suites, '0', <'43', '0x0304'>, 
                                                                     <'10', $g1, $g>, <'40', $g1, $g1^~x>, 
                                                                     <'45', '0', '1'>, <'42', '0'>, '41', 
                                                                     <~ticket, 
                                                                      mask(~ticket_age_add, $ticket_age)>, 
                                                                     '0'>)
                                                                 >)
                                                           >, 
                                                           '6', '0x0303', '40', $g>, 
                                                          '1', '0x0303', ~new_nc, '0', $cipher_suites.1, '0', 
                                                          <'43', '0x0304'>, <'10', $g1, $g>, 
                                                          <'40', $g, $g^~x.1>, <'45', '0', '1'>, '0', '41', 
                                                          <~ticket, mask(~ticket_age_add, '1')>, 
                                                          hmac(<
                                                                Expand(Expand(Extract(~res_psk, '0'),
                                                                              <'ext', 'pbk'>, '32'),
                                                                       <'0', '0'>, '32'), 
                                                                h(<
                                                                   <
                                                                    <'0', '1', '0x0303', ~tid, '0', 
                                                                     $cipher_suites, '0', <'43', '0x0304'>, 
                                                                     <'10', $g1, $g>, <'40', $g1, $g1^~x>, 
                                                                     <'45', '0', '1'>, <'42', '0'>, '41', 
                                                                     <~ticket, 
                                                                      mask(~ticket_age_add, $ticket_age)>, 
                                                                     hmac(<
                                                                           Expand(Expand(Extract(~res_psk,
                                                                                                 '0'),
                                                                                         <'ext', 'pbk'>,
                                                                                         '32'),
                                                                                  <'0', '0'>, '32'), 
                                                                           h(<'0', '1', '0x0303', ~tid, '0', 
                                                                              $cipher_suites, '0', 
                                                                              <'43', '0x0304'>, 
                                                                              <'10', $g1, $g>, 
                                                                              <'40', $g1, $g1^~x>, 
                                                                              <'45', '0', '1'>, <'42', '0'>, 
                                                                              '41', 
                                                                              <~ticket, 
                                                                               mask(~ticket_age_add,
                                                                                    $ticket_age)
                                                                              >, 
                                                                              '0'>)
                                                                          >)
                                                                    >, 
                                                                    '6', '0x0303', '40', $g>, 
                                                                   '1', '0x0303', ~new_nc, '0', 
                                                                   $cipher_suites.1, '0', <'43', '0x0304'>, 
                                                                   <'10', $g1, $g>, <'40', $g, $g^~x.1>, 
                                                                   <'45', '0', '1'>, '0', '41', 
                                                                   <~ticket, mask(~ticket_age_add, '1')>, '0'
                                                                  >)
                                                               >)
                                                         >, 
                                                         '2', '0x0303', p_ns, $cipher_suite, 
                                                         <'13', $sig_algs>, '40', $g, p_gy>, 
                                                        '8', $exts>, 
                                                       '11', '0', pk(~ltkS)>)
                                                   >,
                                                   ~ltkS)
                                             >, 
                                             '20', 
                                             hmac(<
                                                   Expand(Expand(Extract(p_gxy, Extract(~res_psk, '0')),
                                                                 <'serverhts', 
                                                                  h(<
                                                                     <
                                                                      <
                                                                       <
                                                                        <
                                                                         <
                                                                          <'0', '1', '0x0303', ~tid, '0', 
                                                                           $cipher_suites, '0', 
                                                                           <'43', '0x0304'>, <'10', $g1, $g>, 
                                                                           <'40', $g1, $g1^~x>, 
                                                                           <'45', '0', '1'>, <'42', '0'>, 
                                                                           '41', 
                                                                           <~ticket, 
                                                                            mask(~ticket_age_add, $ticket_age)
                                                                           >, 
                                                                           hmac(<
                                                                                 Expand(Expand(Extract(~res_psk,
                                                                                                       '0'),
                                                                                               <'ext', 'pbk'>,
                                                                                               '32'),
                                                                                        <'0', '0'>, '32'), 
                                                                                 h(<'0', '1', '0x0303', ~tid, 
                                                                                    '0', $cipher_suites, '0', 
                                                                                    <'43', '0x0304'>, 
                                                                                    <'10', $g1, $g>, 
                                                                                    <'40', $g1, $g1^~x>, 
                                                                                    <'45', '0', '1'>, 
                                                                                    <'42', '0'>, '41', 
                                                                                    <~ticket, 
                                                                                     mask(~ticket_age_add,
                                                                                          $ticket_age)
                                                                                    >, 
                                                                                    '0'>)
                                                                                >)
                                                                          >, 
                                                                          '6', '0x0303', '40', $g>, 
                                                                         '1', '0x0303', ~new_nc, '0', 
                                                                         $cipher_suites.1, '0', 
                                                                         <'43', '0x0304'>, <'10', $g1, $g>, 
                                                                         <'40', $g, $g^~x.1>, 
                                                                         <'45', '0', '1'>, '0', '41', 
                                                                         <~ticket, mask(~ticket_age_add, '1')
                                                                         >, 
                                                                         hmac(<
                                                                               Expand(Expand(Extract(~res_psk,
                                                                                                     '0'),
                                                                                             <'ext', 'pbk'>,
                                                                                             '32'),
                                                                                      <'0', '0'>, '32'), 
                                                                               h(<
                                                                                  <
                                                                                   <'0', '1', '0x0303', ~tid, 
                                                                                    '0', $cipher_suites, '0', 
                                                                                    <'43', '0x0304'>, 
                                                                                    <'10', $g1, $g>, 
                                                                                    <'40', $g1, $g1^~x>, 
                                                                                    <'45', '0', '1'>, 
                                                                                    <'42', '0'>, '41', 
                                                                                    <~ticket, 
                                                                                     mask(~ticket_age_add,
                                                                                          $ticket_age)
                                                                                    >, 
                                                                                    hmac(<
                                                                                          Expand(Expand(Extract(~res_psk,
                                                                                                                '0'),
                                                                                                        <
                                                                                                         'ext', 
                                                                                                         'pbk'
                                                                                                        >,
                                                                                                        '32'),
                                                                                                 <'0', '0'>,
                                                                                                 '32'), 
                                                                                          h(<'0', '1', 
                                                                                             '0x0303', ~tid, 
                                                                                             '0', 
                                                                                             $cipher_suites, 
                                                                                             '0', 
                                                                                             <'43', '0x0304'
                                                                                             >, 
                                                                                             <'10', $g1, $g>, 
                                                                                             <'40', $g1, 
                                                                                              $g1^~x>, 
                                                                                             <'45', '0', '1'
                                                                                             >, 
                                                                                             <'42', '0'>, 
                                                                                             '41', 
                                                                                             <~ticket, 
                                                                                              mask(~ticket_age_add,
                                                                                                   $ticket_age)
                                                                                             >, 
                                                                                             '0'>)
                                                                                         >)
                                                                                   >, 
                                                                                   '6', '0x0303', '40', $g>, 
                                                                                  '1', '0x0303', ~new_nc, 
                                                                                  '0', $cipher_suites.1, '0', 
                                                                                  <'43', '0x0304'>, 
                                                                                  <'10', $g1, $g>, 
                                                                                  <'40', $g, $g^~x.1>, 
                                                                                  <'45', '0', '1'>, '0', 
                                                                                  '41', 
                                                                                  <~ticket, 
                                                                                   mask(~ticket_age_add, '1')
                                                                                  >, 
                                                                                  '0'>)
                                                                              >)
                                                                        >, 
                                                                        '2', '0x0303', p_ns, $cipher_suite, 
                                                                        <'13', $sig_algs>, '40', $g, p_gy>, 
                                                                       '8', $exts>, 
                                                                      '11', '0', pk(~ltkS)>, 
                                                                     '15', 
                                                                     sign(<'server_cv', 
                                                                           h(<
                                                                              <
                                                                               <
                                                                                <
                                                                                 <
                                                                                  <'0', '1', '0x0303', ~tid, 
                                                                                   '0', $cipher_suites, '0', 
                                                                                   <'43', '0x0304'>, 
                                                                                   <'10', $g1, $g>, 
                                                                                   <'40', $g1, $g1^~x>, 
                                                                                   <'45', '0', '1'>, 
                                                                                   <'42', '0'>, '41', 
                                                                                   <~ticket, 
                                                                                    mask(~ticket_age_add,
                                                                                         $ticket_age)
                                                                                   >, 
                                                                                   hmac(<
                                                                                         Expand(Expand(Extract(~res_psk,
                                                                                                               '0'),
                                                                                                       <
                                                                                                        'ext', 
                                                                                                        'pbk'
                                                                                                       >,
                                                                                                       '32'),
                                                                                                <'0', '0'>,
                                                                                                '32'), 
                                                                                         h(<'0', '1', 
                                                                                            '0x0303', ~tid, 
                                                                                            '0', 
                                                                                            $cipher_suites, 
                                                                                            '0', 
                                                                                            <'43', '0x0304'>, 
                                                                                            <'10', $g1, $g>, 
                                                                                            <'40', $g1, $g1^~x
                                                                                            >, 
                                                                                            <'45', '0', '1'>, 
                                                                                            <'42', '0'>, 
                                                                                            '41', 
                                                                                            <~ticket, 
                                                                                             mask(~ticket_age_add,
                                                                                                  $ticket_age)
                                                                                            >, 
                                                                                            '0'>)
                                                                                        >)
                                                                                  >, 
                                                                                  '6', '0x0303', '40', $g>, 
                                                                                 '1', '0x0303', ~new_nc, '0', 
                                                                                 $cipher_suites.1, '0', 
                                                                                 <'43', '0x0304'>, 
                                                                                 <'10', $g1, $g>, 
                                                                                 <'40', $g, $g^~x.1>, 
                                                                                 <'45', '0', '1'>, '0', '41', 
                                                                                 <~ticket, 
                                                                                  mask(~ticket_age_add, '1')
                                                                                 >, 
                                                                                 hmac(<
                                                                                       Expand(Expand(Extract(~res_psk,
                                                                                                             '0'),
                                                                                                     <'ext', 
                                                                                                      'pbk'>,
                                                                                                     '32'),
                                                                                              <'0', '0'>,
                                                                                              '32'), 
                                                                                       h(<
                                                                                          <
                                                                                           <'0', '1', 
                                                                                            '0x0303', ~tid, 
                                                                                            '0', 
                                                                                            $cipher_suites, 
                                                                                            '0', 
                                                                                            <'43', '0x0304'>, 
                                                                                            <'10', $g1, $g>, 
                                                                                            <'40', $g1, $g1^~x
                                                                                            >, 
                                                                                            <'45', '0', '1'>, 
                                                                                            <'42', '0'>, 
                                                                                            '41', 
                                                                                            <~ticket, 
                                                                                             mask(~ticket_age_add,
                                                                                                  $ticket_age)
                                                                                            >, 
                                                                                            hmac(<
                                                                                                  Expand(Expand(Extract(~res_psk,
                                                                                                                        '0'),
                                                                                                                <
                                                                                                                 'ext', 
                                                                                                                 'pbk'
                                                                                                                >,
                                                                                                                '32'),
                                                                                                         <
                                                                                                          '0', 
                                                                                                          '0'
                                                                                                         >,
                                                                                                         '32'), 
                                                                                                  h(<'0', 
                                                                                                     '1', 
                                                                                                     '0x0303', 
                                                                                                     ~tid, 
                                                                                                     '0', 
                                                                                                     $cipher_suites, 
                                                                                                     '0', 
                                                                                                     <'43', 
                                                                                                      '0x0304'
                                                                                                     >, 
                                                                                                     <'10', 
                                                                                                      $g1, $g
                                                                                                     >, 
                                                                                                     <'40', 
                                                                                                      $g1, 
                                                                                                      $g1^~x
                                                                                                     >, 
                                                                                                     <'45', 
                                                                                                      '0', '1'
                                                                                                     >, 
                                                                                                     <'42', 
                                                                                                      '0'>, 
                                                                                                     '41', 
                                                                                                     <
                                                                                                      ~ticket, 
                                                                                                      mask(~ticket_age_add,
                                                                                                           $ticket_age)
                                                                                                     >, 
                                                                                                     '0'>)
                                                                                                 >)
                                                                                           >, 
                                                                                           '6', '0x0303', 
                                                                                           '40', $g>, 
                                                                                          '1', '0x0303', 
                                                                                          ~new_nc, '0', 
                                                                                          $cipher_suites.1, 
                                                                                          '0', 
                                                                                          <'43', '0x0304'>, 
                                                                                          <'10', $g1, $g>, 
                                                                                          <'40', $g, $g^~x.1
                                                                                          >, 
                                                                                          <'45', '0', '1'>, 
                                                                                          '0', '41', 
                                                                                          <~ticket, 
                                                                                           mask(~ticket_age_add,
                                                                                                '1')
                                                                                          >, 
                                                                                          '0'>)
                                                                                      >)
                                                                                >, 
                                                                                '2', '0x0303', p_ns, 
                                                                                $cipher_suite, 
                                                                                <'13', $sig_algs>, '40', $g, 
                                                                                p_gy>, 
                                                                               '8', $exts>, 
                                                                              '11', '0', pk(~ltkS)>)
                                                                          >,
                                                                          ~ltkS)
                                                                    >)
                                                                 >,
                                                                 '32'),
                                                          <'fin', '0'>, '32'), 
                                                   h(<
                                                      <
                                                       <
                                                        <
                                                         <
                                                          <
                                                           <'0', '1', '0x0303', ~tid, '0', $cipher_suites, 
                                                            '0', <'43', '0x0304'>, <'10', $g1, $g>, 
                                                            <'40', $g1, $g1^~x>, <'45', '0', '1'>, 
                                                            <'42', '0'>, '41', 
                                                            <~ticket, mask(~ticket_age_add, $ticket_age)>, 
                                                            hmac(<
                                                                  Expand(Expand(Extract(~res_psk, '0'),
                                                                                <'ext', 'pbk'>, '32'),
                                                                         <'0', '0'>, '32'), 
                                                                  h(<'0', '1', '0x0303', ~tid, '0', 
                                                                     $cipher_suites, '0', <'43', '0x0304'>, 
                                                                     <'10', $g1, $g>, <'40', $g1, $g1^~x>, 
                                                                     <'45', '0', '1'>, <'42', '0'>, '41', 
                                                                     <~ticket, 
                                                                      mask(~ticket_age_add, $ticket_age)>, 
                                                                     '0'>)
                                                                 >)
                                                           >, 
                                                           '6', '0x0303', '40', $g>, 
                                                          '1', '0x0303', ~new_nc, '0', $cipher_suites.1, '0', 
                                                          <'43', '0x0304'>, <'10', $g1, $g>, 
                                                          <'40', $g, $g^~x.1>, <'45', '0', '1'>, '0', '41', 
                                                          <~ticket, mask(~ticket_age_add, '1')>, 
                                                          hmac(<
                                                                Expand(Expand(Extract(~res_psk, '0'),
                                                                              <'ext', 'pbk'>, '32'),
                                                                       <'0', '0'>, '32'), 
                                                                h(<
                                                                   <
                                                                    <'0', '1', '0x0303', ~tid, '0', 
                                                                     $cipher_suites, '0', <'43', '0x0304'>, 
                                                                     <'10', $g1, $g>, <'40', $g1, $g1^~x>, 
                                                                     <'45', '0', '1'>, <'42', '0'>, '41', 
                                                                     <~ticket, 
                                                                      mask(~ticket_age_add, $ticket_age)>, 
                                                                     hmac(<
                                                                           Expand(Expand(Extract(~res_psk,
                                                                                                 '0'),
                                                                                         <'ext', 'pbk'>,
                                                                                         '32'),
                                                                                  <'0', '0'>, '32'), 
                                                                           h(<'0', '1', '0x0303', ~tid, '0', 
                                                                              $cipher_suites, '0', 
                                                                              <'43', '0x0304'>, 
                                                                              <'10', $g1, $g>, 
                                                                              <'40', $g1, $g1^~x>, 
                                                                              <'45', '0', '1'>, <'42', '0'>, 
                                                                              '41', 
                                                                              <~ticket, 
                                                                               mask(~ticket_age_add,
                                                                                    $ticket_age)
                                                                              >, 
                                                                              '0'>)
                                                                          >)
                                                                    >, 
                                                                    '6', '0x0303', '40', $g>, 
                                                                   '1', '0x0303', ~new_nc, '0', 
                                                                   $cipher_suites.1, '0', <'43', '0x0304'>, 
                                                                   <'10', $g1, $g>, <'40', $g, $g^~x.1>, 
                                                                   <'45', '0', '1'>, '0', '41', 
                                                                   <~ticket, mask(~ticket_age_add, '1')>, '0'
                                                                  >)
                                                               >)
                                                         >, 
                                                         '2', '0x0303', p_ns, $cipher_suite, 
                                                         <'13', $sig_algs>, '40', $g, p_gy>, 
                                                        '8', $exts>, 
                                                       '11', '0', pk(~ltkS)>, 
                                                      '15', 
                                                      sign(<'server_cv', 
                                                            h(<
                                                               <
                                                                <
                                                                 <
                                                                  <
                                                                   <'0', '1', '0x0303', ~tid, '0', 
                                                                    $cipher_suites, '0', <'43', '0x0304'>, 
                                                                    <'10', $g1, $g>, <'40', $g1, $g1^~x>, 
                                                                    <'45', '0', '1'>, <'42', '0'>, '41', 
                                                                    <~ticket, 
                                                                     mask(~ticket_age_add, $ticket_age)>, 
                                                                    hmac(<
                                                                          Expand(Expand(Extract(~res_psk,
                                                                                                '0'),
                                                                                        <'ext', 'pbk'>, '32'),
                                                                                 <'0', '0'>, '32'), 
                                                                          h(<'0', '1', '0x0303', ~tid, '0', 
                                                                             $cipher_suites, '0', 
                                                                             <'43', '0x0304'>, 
                                                                             <'10', $g1, $g>, 
                                                                             <'40', $g1, $g1^~x>, 
                                                                             <'45', '0', '1'>, <'42', '0'>, 
                                                                             '41', 
                                                                             <~ticket, 
                                                                              mask(~ticket_age_add,
                                                                                   $ticket_age)
                                                                             >, 
                                                                             '0'>)
                                                                         >)
                                                                   >, 
                                                                   '6', '0x0303', '40', $g>, 
                                                                  '1', '0x0303', ~new_nc, '0', 
                                                                  $cipher_suites.1, '0', <'43', '0x0304'>, 
                                                                  <'10', $g1, $g>, <'40', $g, $g^~x.1>, 
                                                                  <'45', '0', '1'>, '0', '41', 
                                                                  <~ticket, mask(~ticket_age_add, '1')>, 
                                                                  hmac(<
                                                                        Expand(Expand(Extract(~res_psk, '0'),
                                                                                      <'ext', 'pbk'>, '32'),
                                                                               <'0', '0'>, '32'), 
                                                                        h(<
                                                                           <
                                                                            <'0', '1', '0x0303', ~tid, '0', 
                                                                             $cipher_suites, '0', 
                                                                             <'43', '0x0304'>, 
                                                                             <'10', $g1, $g>, 
                                                                             <'40', $g1, $g1^~x>, 
                                                                             <'45', '0', '1'>, <'42', '0'>, 
                                                                             '41', 
                                                                             <~ticket, 
                                                                              mask(~ticket_age_add,
                                                                                   $ticket_age)
                                                                             >, 
                                                                             hmac(<
                                                                                   Expand(Expand(Extract(~res_psk,
                                                                                                         '0'),
                                                                                                 <'ext', 'pbk'
                                                                                                 >,
                                                                                                 '32'),
                                                                                          <'0', '0'>, '32'), 
                                                                                   h(<'0', '1', '0x0303', 
                                                                                      ~tid, '0', 
                                                                                      $cipher_suites, '0', 
                                                                                      <'43', '0x0304'>, 
                                                                                      <'10', $g1, $g>, 
                                                                                      <'40', $g1, $g1^~x>, 
                                                                                      <'45', '0', '1'>, 
                                                                                      <'42', '0'>, '41', 
                                                                                      <~ticket, 
                                                                                       mask(~ticket_age_add,
                                                                                            $ticket_age)
                                                                                      >, 
                                                                                      '0'>)
                                                                                  >)
                                                                            >, 
                                                                            '6', '0x0303', '40', $g>, 
                                                                           '1', '0x0303', ~new_nc, '0', 
                                                                           $cipher_suites.1, '0', 
                                                                           <'43', '0x0304'>, <'10', $g1, $g>, 
                                                                           <'40', $g, $g^~x.1>, 
                                                                           <'45', '0', '1'>, '0', '41', 
                                                                           <~ticket, 
                                                                            mask(~ticket_age_add, '1')>, 
                                                                           '0'>)
                                                                       >)
                                                                 >, 
                                                                 '2', '0x0303', p_ns, $cipher_suite, 
                                                                 <'13', $sig_algs>, '40', $g, p_gy>, 
                                                                '8', $exts>, 
                                                               '11', '0', pk(~ltkS)>)
                                                           >,
                                                           ~ltkS)
                                                     >)
                                                  >)
                                            >)
                                         >,
                                         '32'),
                                  <'adke_wk', '0'>, '32')
                ) ▶₀ #l )
    next
      case recv_server_auth_case_08
      by solve( SecretPSK( $A,
                           Expand(Expand(Extract('0',
                                                 Extract(p_gxy,
                                                         Extract(Expand(ms, <'rms', h(messages)>, '32'),
                                                                 '0'))),
                                         <'serverats', 
                                          h(<
                                             <
                                              <
                                               <
                                                <
                                                 <
                                                  <
                                                   <'0', '1', '0x0303', ~tid, '0', $cipher_suites, '0', 
                                                    <'43', '0x0304'>, <'10', $g1, $g>, <'40', $g1, $g1^~x>, 
                                                    <'45', '0', '1'>, <'42', '0'>, '41', 
                                                    <p_psk_id, mask(ticket_age_add, $ticket_age)>, 
                                                    hmac(<
                                                          Expand(Expand(Extract(Expand(ms,
                                                                                       <'rms', h(messages)>,
                                                                                       '32'),
                                                                                '0'),
                                                                        <'res', 'pbk'>, '32'),
                                                                 <'0', '0'>, '32'), 
                                                          h(<'0', '1', '0x0303', ~tid, '0', $cipher_suites, 
                                                             '0', <'43', '0x0304'>, <'10', $g1, $g>, 
                                                             <'40', $g1, $g1^~x>, <'45', '0', '1'>, 
                                                             <'42', '0'>, '41', 
                                                             <p_psk_id, mask(ticket_age_add, $ticket_age)>, 
                                                             '0'>)
                                                         >)
                                                   >, 
                                                   '6', '0x0303', '40', $g>, 
                                                  '1', '0x0303', ~new_nc, '0', $cipher_suites.1, '0', 
                                                  <'43', '0x0304'>, <'10', $g1, $g>, <'40', $g, $g^~x.1>, 
                                                  <'45', '0', '1'>, '0', '41', 
                                                  <p_psk_id, mask(ticket_age_add, '1')>, 
                                                  hmac(<
                                                        Expand(Expand(Extract(Expand(ms, <'rms', h(messages)>,
                                                                                     '32'),
                                                                              '0'),
                                                                      <'res', 'pbk'>, '32'),
                                                               <'0', '0'>, '32'), 
                                                        h(<
                                                           <
                                                            <'0', '1', '0x0303', ~tid, '0', $cipher_suites, 
                                                             '0', <'43', '0x0304'>, <'10', $g1, $g>, 
                                                             <'40', $g1, $g1^~x>, <'45', '0', '1'>, 
                                                             <'42', '0'>, '41', 
                                                             <p_psk_id, mask(ticket_age_add, $ticket_age)>, 
                                                             hmac(<
                                                                   Expand(Expand(Extract(Expand(ms,
                                                                                                <'rms', 
                                                                                                 h(messages)>,
                                                                                                '32'),
                                                                                         '0'),
                                                                                 <'res', 'pbk'>, '32'),
                                                                          <'0', '0'>, '32'), 
                                                                   h(<'0', '1', '0x0303', ~tid, '0', 
                                                                      $cipher_suites, '0', <'43', '0x0304'>, 
                                                                      <'10', $g1, $g>, <'40', $g1, $g1^~x>, 
                                                                      <'45', '0', '1'>, <'42', '0'>, '41', 
                                                                      <p_psk_id, 
                                                                       mask(ticket_age_add, $ticket_age)>, 
                                                                      '0'>)
                                                                  >)
                                                            >, 
                                                            '6', '0x0303', '40', $g>, 
                                                           '1', '0x0303', ~new_nc, '0', $cipher_suites.1, 
                                                           '0', <'43', '0x0304'>, <'10', $g1, $g>, 
                                                           <'40', $g, $g^~x.1>, <'45', '0', '1'>, '0', '41', 
                                                           <p_psk_id, mask(ticket_age_add, '1')>, '0'>)
                                                       >)
                                                 >, 
                                                 '2', '0x0303', p_ns, $cipher_suite, <'13', $sig_algs>, '40', 
                                                 $g, p_gy>, 
                                                '8', $exts>, 
                                               '11', '0', pk(~ltkS)>, 
                                              '15', 
                                              sign(<'server_cv', 
                                                    h(<
                                                       <
                                                        <
                                                         <
                                                          <
                                                           <'0', '1', '0x0303', ~tid, '0', $cipher_suites, 
                                                            '0', <'43', '0x0304'>, <'10', $g1, $g>, 
                                                            <'40', $g1, $g1^~x>, <'45', '0', '1'>, 
                                                            <'42', '0'>, '41', 
                                                            <p_psk_id, mask(ticket_age_add, $ticket_age)>, 
                                                            hmac(<
                                                                  Expand(Expand(Extract(Expand(ms,
                                                                                               <'rms', 
                                                                                                h(messages)>,
                                                                                               '32'),
                                                                                        '0'),
                                                                                <'res', 'pbk'>, '32'),
                                                                         <'0', '0'>, '32'), 
                                                                  h(<'0', '1', '0x0303', ~tid, '0', 
                                                                     $cipher_suites, '0', <'43', '0x0304'>, 
                                                                     <'10', $g1, $g>, <'40', $g1, $g1^~x>, 
                                                                     <'45', '0', '1'>, <'42', '0'>, '41', 
                                                                     <p_psk_id, 
                                                                      mask(ticket_age_add, $ticket_age)>, 
                                                                     '0'>)
                                                                 >)
                                                           >, 
                                                           '6', '0x0303', '40', $g>, 
                                                          '1', '0x0303', ~new_nc, '0', $cipher_suites.1, '0', 
                                                          <'43', '0x0304'>, <'10', $g1, $g>, 
                                                          <'40', $g, $g^~x.1>, <'45', '0', '1'>, '0', '41', 
                                                          <p_psk_id, mask(ticket_age_add, '1')>, 
                                                          hmac(<
                                                                Expand(Expand(Extract(Expand(ms,
                                                                                             <'rms', 
                                                                                              h(messages)>,
                                                                                             '32'),
                                                                                      '0'),
                                                                              <'res', 'pbk'>, '32'),
                                                                       <'0', '0'>, '32'), 
                                                                h(<
                                                                   <
                                                                    <'0', '1', '0x0303', ~tid, '0', 
                                                                     $cipher_suites, '0', <'43', '0x0304'>, 
                                                                     <'10', $g1, $g>, <'40', $g1, $g1^~x>, 
                                                                     <'45', '0', '1'>, <'42', '0'>, '41', 
                                                                     <p_psk_id, 
                                                                      mask(ticket_age_add, $ticket_age)>, 
                                                                     hmac(<
                                                                           Expand(Expand(Extract(Expand(ms,
                                                                                                        <
                                                                                                         'rms', 
                                                                                                         h(messages)
                                                                                                        >,
                                                                                                        '32'),
                                                                                                 '0'),
                                                                                         <'res', 'pbk'>,
                                                                                         '32'),
                                                                                  <'0', '0'>, '32'), 
                                                                           h(<'0', '1', '0x0303', ~tid, '0', 
                                                                              $cipher_suites, '0', 
                                                                              <'43', '0x0304'>, 
                                                                              <'10', $g1, $g>, 
                                                                              <'40', $g1, $g1^~x>, 
                                                                              <'45', '0', '1'>, <'42', '0'>, 
                                                                              '41', 
                                                                              <p_psk_id, 
                                                                               mask(ticket_age_add,
                                                                                    $ticket_age)
                                                                              >, 
                                                                              '0'>)
                                                                          >)
                                                                    >, 
                                                                    '6', '0x0303', '40', $g>, 
                                                                   '1', '0x0303', ~new_nc, '0', 
                                                                   $cipher_suites.1, '0', <'43', '0x0304'>, 
                                                                   <'10', $g1, $g>, <'40', $g, $g^~x.1>, 
                                                                   <'45', '0', '1'>, '0', '41', 
                                                                   <p_psk_id, mask(ticket_age_add, '1')>, '0'
                                                                  >)
                                                               >)
                                                         >, 
                                                         '2', '0x0303', p_ns, $cipher_suite, 
                                                         <'13', $sig_algs>, '40', $g, p_gy>, 
                                                        '8', $exts>, 
                                                       '11', '0', pk(~ltkS)>)
                                                   >,
                                                   ~ltkS)
                                             >, 
                                             '20', 
                                             hmac(<
                                                   Expand(Expand(Extract(p_gxy,
                                                                         Extract(Expand(ms,
                                                                                        <'rms', h(messages)>,
                                                                                        '32'),
                                                                                 '0')),
                                                                 <'serverhts', 
                                                                  h(<
                                                                     <
                                                                      <
                                                                       <
                                                                        <
                                                                         <
                                                                          <'0', '1', '0x0303', ~tid, '0', 
                                                                           $cipher_suites, '0', 
                                                                           <'43', '0x0304'>, <'10', $g1, $g>, 
                                                                           <'40', $g1, $g1^~x>, 
                                                                           <'45', '0', '1'>, <'42', '0'>, 
                                                                           '41', 
                                                                           <p_psk_id, 
                                                                            mask(ticket_age_add, $ticket_age)
                                                                           >, 
                                                                           hmac(<
                                                                                 Expand(Expand(Extract(Expand(ms,
                                                                                                              <
                                                                                                               'rms', 
                                                                                                               h(messages)
                                                                                                              >,
                                                                                                              '32'),
                                                                                                       '0'),
                                                                                               <'res', 'pbk'>,
                                                                                               '32'),
                                                                                        <'0', '0'>, '32'), 
                                                                                 h(<'0', '1', '0x0303', ~tid, 
                                                                                    '0', $cipher_suites, '0', 
                                                                                    <'43', '0x0304'>, 
                                                                                    <'10', $g1, $g>, 
                                                                                    <'40', $g1, $g1^~x>, 
                                                                                    <'45', '0', '1'>, 
                                                                                    <'42', '0'>, '41', 
                                                                                    <p_psk_id, 
                                                                                     mask(ticket_age_add,
                                                                                          $ticket_age)
                                                                                    >, 
                                                                                    '0'>)
                                                                                >)
                                                                          >, 
                                                                          '6', '0x0303', '40', $g>, 
                                                                         '1', '0x0303', ~new_nc, '0', 
                                                                         $cipher_suites.1, '0', 
                                                                         <'43', '0x0304'>, <'10', $g1, $g>, 
                                                                         <'40', $g, $g^~x.1>, 
                                                                         <'45', '0', '1'>, '0', '41', 
                                                                         <p_psk_id, mask(ticket_age_add, '1')
                                                                         >, 
                                                                         hmac(<
                                                                               Expand(Expand(Extract(Expand(ms,
                                                                                                            <
                                                                                                             'rms', 
                                                                                                             h(messages)
                                                                                                            >,
                                                                                                            '32'),
                                                                                                     '0'),
                                                                                             <'res', 'pbk'>,
                                                                                             '32'),
                                                                                      <'0', '0'>, '32'), 
                                                                               h(<
                                                                                  <
                                                                                   <'0', '1', '0x0303', ~tid, 
                                                                                    '0', $cipher_suites, '0', 
                                                                                    <'43', '0x0304'>, 
                                                                                    <'10', $g1, $g>, 
                                                                                    <'40', $g1, $g1^~x>, 
                                                                                    <'45', '0', '1'>, 
                                                                                    <'42', '0'>, '41', 
                                                                                    <p_psk_id, 
                                                                                     mask(ticket_age_add,
                                                                                          $ticket_age)
                                                                                    >, 
                                                                                    hmac(<
                                                                                          Expand(Expand(Extract(Expand(ms,
                                                                                                                       <
                                                                                                                        'rms', 
                                                                                                                        h(messages)
                                                                                                                       >,
                                                                                                                       '32'),
                                                                                                                '0'),
                                                                                                        <
                                                                                                         'res', 
                                                                                                         'pbk'
                                                                                                        >,
                                                                                                        '32'),
                                                                                                 <'0', '0'>,
                                                                                                 '32'), 
                                                                                          h(<'0', '1', 
                                                                                             '0x0303', ~tid, 
                                                                                             '0', 
                                                                                             $cipher_suites, 
                                                                                             '0', 
                                                                                             <'43', '0x0304'
                                                                                             >, 
                                                                                             <'10', $g1, $g>, 
                                                                                             <'40', $g1, 
                                                                                              $g1^~x>, 
                                                                                             <'45', '0', '1'
                                                                                             >, 
                                                                                             <'42', '0'>, 
                                                                                             '41', 
                                                                                             <p_psk_id, 
                                                                                              mask(ticket_age_add,
                                                                                                   $ticket_age)
                                                                                             >, 
                                                                                             '0'>)
                                                                                         >)
                                                                                   >, 
                                                                                   '6', '0x0303', '40', $g>, 
                                                                                  '1', '0x0303', ~new_nc, 
                                                                                  '0', $cipher_suites.1, '0', 
                                                                                  <'43', '0x0304'>, 
                                                                                  <'10', $g1, $g>, 
                                                                                  <'40', $g, $g^~x.1>, 
                                                                                  <'45', '0', '1'>, '0', 
                                                                                  '41', 
                                                                                  <p_psk_id, 
                                                                                   mask(ticket_age_add, '1')
                                                                                  >, 
                                                                                  '0'>)
                                                                              >)
                                                                        >, 
                                                                        '2', '0x0303', p_ns, $cipher_suite, 
                                                                        <'13', $sig_algs>, '40', $g, p_gy>, 
                                                                       '8', $exts>, 
                                                                      '11', '0', pk(~ltkS)>, 
                                                                     '15', 
                                                                     sign(<'server_cv', 
                                                                           h(<
                                                                              <
                                                                               <
                                                                                <
                                                                                 <
                                                                                  <'0', '1', '0x0303', ~tid, 
                                                                                   '0', $cipher_suites, '0', 
                                                                                   <'43', '0x0304'>, 
                                                                                   <'10', $g1, $g>, 
                                                                                   <'40', $g1, $g1^~x>, 
                                                                                   <'45', '0', '1'>, 
                                                                                   <'42', '0'>, '41', 
                                                                                   <p_psk_id, 
                                                                                    mask(ticket_age_add,
                                                                                         $ticket_age)
                                                                                   >, 
                                                                                   hmac(<
                                                                                         Expand(Expand(Extract(Expand(ms,
                                                                                                                      <
                                                                                                                       'rms', 
                                                                                                                       h(messages)
                                                                                                                      >,
                                                                                                                      '32'),
                                                                                                               '0'),
                                                                                                       <
                                                                                                        'res', 
                                                                                                        'pbk'
                                                                                                       >,
                                                                                                       '32'),
                                                                                                <'0', '0'>,
                                                                                                '32'), 
                                                                                         h(<'0', '1', 
                                                                                            '0x0303', ~tid, 
                                                                                            '0', 
                                                                                            $cipher_suites, 
                                                                                            '0', 
                                                                                            <'43', '0x0304'>, 
                                                                                            <'10', $g1, $g>, 
                                                                                            <'40', $g1, $g1^~x
                                                                                            >, 
                                                                                            <'45', '0', '1'>, 
                                                                                            <'42', '0'>, 
                                                                                            '41', 
                                                                                            <p_psk_id, 
                                                                                             mask(ticket_age_add,
                                                                                                  $ticket_age)
                                                                                            >, 
                                                                                            '0'>)
                                                                                        >)
                                                                                  >, 
                                                                                  '6', '0x0303', '40', $g>, 
                                                                                 '1', '0x0303', ~new_nc, '0', 
                                                                                 $cipher_suites.1, '0', 
                                                                                 <'43', '0x0304'>, 
                                                                                 <'10', $g1, $g>, 
                                                                                 <'40', $g, $g^~x.1>, 
                                                                                 <'45', '0', '1'>, '0', '41', 
                                                                                 <p_psk_id, 
                                                                                  mask(ticket_age_add, '1')>, 
                                                                                 hmac(<
                                                                                       Expand(Expand(Extract(Expand(ms,
                                                                                                                    <
                                                                                                                     'rms', 
                                                                                                                     h(messages)
                                                                                                                    >,
                                                                                                                    '32'),
                                                                                                             '0'),
                                                                                                     <'res', 
                                                                                                      'pbk'>,
                                                                                                     '32'),
                                                                                              <'0', '0'>,
                                                                                              '32'), 
                                                                                       h(<
                                                                                          <
                                                                                           <'0', '1', 
                                                                                            '0x0303', ~tid, 
                                                                                            '0', 
                                                                                            $cipher_suites, 
                                                                                            '0', 
                                                                                            <'43', '0x0304'>, 
                                                                                            <'10', $g1, $g>, 
                                                                                            <'40', $g1, $g1^~x
                                                                                            >, 
                                                                                            <'45', '0', '1'>, 
                                                                                            <'42', '0'>, 
                                                                                            '41', 
                                                                                            <p_psk_id, 
                                                                                             mask(ticket_age_add,
                                                                                                  $ticket_age)
                                                                                            >, 
                                                                                            hmac(<
                                                                                                  Expand(Expand(Extract(Expand(ms,
                                                                                                                               <
                                                                                                                                'rms', 
                                                                                                                                h(messages)
                                                                                                                               >,
                                                                                                                               '32'),
                                                                                                                        '0'),
                                                                                                                <
                                                                                                                 'res', 
                                                                                                                 'pbk'
                                                                                                                >,
                                                                                                                '32'),
                                                                                                         <
                                                                                                          '0', 
                                                                                                          '0'
                                                                                                         >,
                                                                                                         '32'), 
                                                                                                  h(<'0', 
                                                                                                     '1', 
                                                                                                     '0x0303', 
                                                                                                     ~tid, 
                                                                                                     '0', 
                                                                                                     $cipher_suites, 
                                                                                                     '0', 
                                                                                                     <'43', 
                                                                                                      '0x0304'
                                                                                                     >, 
                                                                                                     <'10', 
                                                                                                      $g1, $g
                                                                                                     >, 
                                                                                                     <'40', 
                                                                                                      $g1, 
                                                                                                      $g1^~x
                                                                                                     >, 
                                                                                                     <'45', 
                                                                                                      '0', '1'
                                                                                                     >, 
                                                                                                     <'42', 
                                                                                                      '0'>, 
                                                                                                     '41', 
                                                                                                     <
                                                                                                      p_psk_id, 
                                                                                                      mask(ticket_age_add,
                                                                                                           $ticket_age)
                                                                                                     >, 
                                                                                                     '0'>)
                                                                                                 >)
                                                                                           >, 
                                                                                           '6', '0x0303', 
                                                                                           '40', $g>, 
                                                                                          '1', '0x0303', 
                                                                                          ~new_nc, '0', 
                                                                                          $cipher_suites.1, 
                                                                                          '0', 
                                                                                          <'43', '0x0304'>, 
                                                                                          <'10', $g1, $g>, 
                                                                                          <'40', $g, $g^~x.1
                                                                                          >, 
                                                                                          <'45', '0', '1'>, 
                                                                                          '0', '41', 
                                                                                          <p_psk_id, 
                                                                                           mask(ticket_age_add,
                                                                                                '1')
                                                                                          >, 
                                                                                          '0'>)
                                                                                      >)
                                                                                >, 
                                                                                '2', '0x0303', p_ns, 
                                                                                $cipher_suite, 
                                                                                <'13', $sig_algs>, '40', $g, 
                                                                                p_gy>, 
                                                                               '8', $exts>, 
                                                                              '11', '0', pk(~ltkS)>)
                                                                          >,
                                                                          ~ltkS)
                                                                    >)
                                                                 >,
                                                                 '32'),
                                                          <'fin', '0'>, '32'), 
                                                   h(<
                                                      <
                                                       <
                                                        <
                                                         <
                                                          <
                                                           <'0', '1', '0x0303', ~tid, '0', $cipher_suites, 
                                                            '0', <'43', '0x0304'>, <'10', $g1, $g>, 
                                                            <'40', $g1, $g1^~x>, <'45', '0', '1'>, 
                                                            <'42', '0'>, '41', 
                                                            <p_psk_id, mask(ticket_age_add, $ticket_age)>, 
                                                            hmac(<
                                                                  Expand(Expand(Extract(Expand(ms,
                                                                                               <'rms', 
                                                                                                h(messages)>,
                                                                                               '32'),
                                                                                        '0'),
                                                                                <'res', 'pbk'>, '32'),
                                                                         <'0', '0'>, '32'), 
                                                                  h(<'0', '1', '0x0303', ~tid, '0', 
                                                                     $cipher_suites, '0', <'43', '0x0304'>, 
                                                                     <'10', $g1, $g>, <'40', $g1, $g1^~x>, 
                                                                     <'45', '0', '1'>, <'42', '0'>, '41', 
                                                                     <p_psk_id, 
                                                                      mask(ticket_age_add, $ticket_age)>, 
                                                                     '0'>)
                                                                 >)
                                                           >, 
                                                           '6', '0x0303', '40', $g>, 
                                                          '1', '0x0303', ~new_nc, '0', $cipher_suites.1, '0', 
                                                          <'43', '0x0304'>, <'10', $g1, $g>, 
                                                          <'40', $g, $g^~x.1>, <'45', '0', '1'>, '0', '41', 
                                                          <p_psk_id, mask(ticket_age_add, '1')>, 
                                                          hmac(<
                                                                Expand(Expand(Extract(Expand(ms,
                                                                                             <'rms', 
                                                                                              h(messages)>,
                                                                                             '32'),
                                                                                      '0'),
                                                                              <'res', 'pbk'>, '32'),
                                                                       <'0', '0'>, '32'), 
                                                                h(<
                                                                   <
                                                                    <'0', '1', '0x0303', ~tid, '0', 
                                                                     $cipher_suites, '0', <'43', '0x0304'>, 
                                                                     <'10', $g1, $g>, <'40', $g1, $g1^~x>, 
                                                                     <'45', '0', '1'>, <'42', '0'>, '41', 
                                                                     <p_psk_id, 
                                                                      mask(ticket_age_add, $ticket_age)>, 
                                                                     hmac(<
                                                                           Expand(Expand(Extract(Expand(ms,
                                                                                                        <
                                                                                                         'rms', 
                                                                                                         h(messages)
                                                                                                        >,
                                                                                                        '32'),
                                                                                                 '0'),
                                                                                         <'res', 'pbk'>,
                                                                                         '32'),
                                                                                  <'0', '0'>, '32'), 
                                                                           h(<'0', '1', '0x0303', ~tid, '0', 
                                                                              $cipher_suites, '0', 
                                                                              <'43', '0x0304'>, 
                                                                              <'10', $g1, $g>, 
                                                                              <'40', $g1, $g1^~x>, 
                                                                              <'45', '0', '1'>, <'42', '0'>, 
                                                                              '41', 
                                                                              <p_psk_id, 
                                                                               mask(ticket_age_add,
                                                                                    $ticket_age)
                                                                              >, 
                                                                              '0'>)
                                                                          >)
                                                                    >, 
                                                                    '6', '0x0303', '40', $g>, 
                                                                   '1', '0x0303', ~new_nc, '0', 
                                                                   $cipher_suites.1, '0', <'43', '0x0304'>, 
                                                                   <'10', $g1, $g>, <'40', $g, $g^~x.1>, 
                                                                   <'45', '0', '1'>, '0', '41', 
                                                                   <p_psk_id, mask(ticket_age_add, '1')>, '0'
                                                                  >)
                                                               >)
                                                         >, 
                                                         '2', '0x0303', p_ns, $cipher_suite, 
                                                         <'13', $sig_algs>, '40', $g, p_gy>, 
                                                        '8', $exts>, 
                                                       '11', '0', pk(~ltkS)>, 
                                                      '15', 
                                                      sign(<'server_cv', 
                                                            h(<
                                                               <
                                                                <
                                                                 <
                                                                  <
                                                                   <'0', '1', '0x0303', ~tid, '0', 
                                                                    $cipher_suites, '0', <'43', '0x0304'>, 
                                                                    <'10', $g1, $g>, <'40', $g1, $g1^~x>, 
                                                                    <'45', '0', '1'>, <'42', '0'>, '41', 
                                                                    <p_psk_id, 
                                                                     mask(ticket_age_add, $ticket_age)>, 
                                                                    hmac(<
                                                                          Expand(Expand(Extract(Expand(ms,
                                                                                                       <
                                                                                                        'rms', 
                                                                                                        h(messages)
                                                                                                       >,
                                                                                                       '32'),
                                                                                                '0'),
                                                                                        <'res', 'pbk'>, '32'),
                                                                                 <'0', '0'>, '32'), 
                                                                          h(<'0', '1', '0x0303', ~tid, '0', 
                                                                             $cipher_suites, '0', 
                                                                             <'43', '0x0304'>, 
                                                                             <'10', $g1, $g>, 
                                                                             <'40', $g1, $g1^~x>, 
                                                                             <'45', '0', '1'>, <'42', '0'>, 
                                                                             '41', 
                                                                             <p_psk_id, 
                                                                              mask(ticket_age_add,
                                                                                   $ticket_age)
                                                                             >, 
                                                                             '0'>)
                                                                         >)
                                                                   >, 
                                                                   '6', '0x0303', '40', $g>, 
                                                                  '1', '0x0303', ~new_nc, '0', 
                                                                  $cipher_suites.1, '0', <'43', '0x0304'>, 
                                                                  <'10', $g1, $g>, <'40', $g, $g^~x.1>, 
                                                                  <'45', '0', '1'>, '0', '41', 
                                                                  <p_psk_id, mask(ticket_age_add, '1')>, 
                                                                  hmac(<
                                                                        Expand(Expand(Extract(Expand(ms,
                                                                                                     <'rms', 
                                                                                                      h(messages)
                                                                                                     >,
                                                                                                     '32'),
                                                                                              '0'),
                                                                                      <'res', 'pbk'>, '32'),
                                                                               <'0', '0'>, '32'), 
                                                                        h(<
                                                                           <
                                                                            <'0', '1', '0x0303', ~tid, '0', 
                                                                             $cipher_suites, '0', 
                                                                             <'43', '0x0304'>, 
                                                                             <'10', $g1, $g>, 
                                                                             <'40', $g1, $g1^~x>, 
                                                                             <'45', '0', '1'>, <'42', '0'>, 
                                                                             '41', 
                                                                             <p_psk_id, 
                                                                              mask(ticket_age_add,
                                                                                   $ticket_age)
                                                                             >, 
                                                                             hmac(<
                                                                                   Expand(Expand(Extract(Expand(ms,
                                                                                                                <
                                                                                                                 'rms', 
                                                                                                                 h(messages)
                                                                                                                >,
                                                                                                                '32'),
                                                                                                         '0'),
                                                                                                 <'res', 'pbk'
                                                                                                 >,
                                                                                                 '32'),
                                                                                          <'0', '0'>, '32'), 
                                                                                   h(<'0', '1', '0x0303', 
                                                                                      ~tid, '0', 
                                                                                      $cipher_suites, '0', 
                                                                                      <'43', '0x0304'>, 
                                                                                      <'10', $g1, $g>, 
                                                                                      <'40', $g1, $g1^~x>, 
                                                                                      <'45', '0', '1'>, 
                                                                                      <'42', '0'>, '41', 
                                                                                      <p_psk_id, 
                                                                                       mask(ticket_age_add,
                                                                                            $ticket_age)
                                                                                      >, 
                                                                                      '0'>)
                                                                                  >)
                                                                            >, 
                                                                            '6', '0x0303', '40', $g>, 
                                                                           '1', '0x0303', ~new_nc, '0', 
                                                                           $cipher_suites.1, '0', 
                                                                           <'43', '0x0304'>, <'10', $g1, $g>, 
                                                                           <'40', $g, $g^~x.1>, 
                                                                           <'45', '0', '1'>, '0', '41', 
                                                                           <p_psk_id, 
                                                                            mask(ticket_age_add, '1')>, 
                                                                           '0'>)
                                                                       >)
                                                                 >, 
                                                                 '2', '0x0303', p_ns, $cipher_suite, 
                                                                 <'13', $sig_algs>, '40', $g, p_gy>, 
                                                                '8', $exts>, 
                                                               '11', '0', pk(~ltkS)>)
                                                           >,
                                                           ~ltkS)
                                                     >)
                                                  >)
                                            >)
                                         >,
                                         '32'),
                                  <'adke_wk', '0'>, '32')
                ) ▶₀ #l )
    next
      case recv_server_auth_case_09
      by contradiction /* from formulas */
    next
      case recv_server_auth_case_10
      by contradiction /* from formulas */
    next
      case recv_server_auth_case_11
      by contradiction /* from formulas */
    next
      case recv_server_auth_case_12
      by contradiction /* from formulas */
    next
      case recv_server_auth_case_13
      by contradiction /* from formulas */
    next
      case recv_server_auth_case_14
      by contradiction /* from formulas */
    next
      case recv_server_auth_case_15
      by contradiction /* from formulas */
    next
      case recv_server_auth_case_16
      by contradiction /* from formulas */
    next
      case recv_server_auth_psk_case_1
      by solve( SecretPSK( $A,
                           Expand(Expand(Extract('0',
                                                 Extract(p_gxy,
                                                         Extract(Expand(ms, <'rms', h(messages)>, '32'),
                                                                 '0'))),
                                         <'serverats', 
                                          h(<
                                             <
                                              <
                                               <'0', '1', '0x0303', ~tid, '0', $cipher_suites, '0', 
                                                <'43', '0x0304'>, <'10', $g, $g2>, <'40', $g, $g^~x>, 
                                                <'45', '0', '1'>, <'42', '0'>, '41', 
                                                <~ticket, mask(ticket_age_add, $ticket_age)>, 
                                                hmac(<
                                                      Expand(Expand(Extract(Expand(ms, <'rms', h(messages)>,
                                                                                   '32'),
                                                                            '0'),
                                                                    <'res', 'pbk'>, '32'),
                                                             <'0', '0'>, '32'), 
                                                      h(<'0', '1', '0x0303', ~tid, '0', $cipher_suites, '0', 
                                                         <'43', '0x0304'>, <'10', $g, $g2>, 
                                                         <'40', $g, $g^~x>, <'45', '0', '1'>, <'42', '0'>, 
                                                         '41', <~ticket, mask(ticket_age_add, $ticket_age)>, 
                                                         '0'>)
                                                     >)
                                               >, 
                                               '2', '0x0303', p_ns, $cipher_suite, <'13', $sig_algs>, 
                                               <'40', $g, p_gy>, <'41', '0'>, '42', '0'>, 
                                              '8', $exts>, 
                                             '20', 
                                             hmac(<
                                                   Expand(Expand(Extract(p_gxy,
                                                                         Extract(Expand(ms,
                                                                                        <'rms', h(messages)>,
                                                                                        '32'),
                                                                                 '0')),
                                                                 <'serverhts', 
                                                                  h(<
                                                                     <
                                                                      <'0', '1', '0x0303', ~tid, '0', 
                                                                       $cipher_suites, '0', <'43', '0x0304'>, 
                                                                       <'10', $g, $g2>, <'40', $g, $g^~x>, 
                                                                       <'45', '0', '1'>, <'42', '0'>, '41', 
                                                                       <~ticket, 
                                                                        mask(ticket_age_add, $ticket_age)>, 
                                                                       hmac(<
                                                                             Expand(Expand(Extract(Expand(ms,
                                                                                                          <
                                                                                                           'rms', 
                                                                                                           h(messages)
                                                                                                          >,
                                                                                                          '32'),
                                                                                                   '0'),
                                                                                           <'res', 'pbk'>,
                                                                                           '32'),
                                                                                    <'0', '0'>, '32'), 
                                                                             h(<'0', '1', '0x0303', ~tid, 
                                                                                '0', $cipher_suites, '0', 
                                                                                <'43', '0x0304'>, 
                                                                                <'10', $g, $g2>, 
                                                                                <'40', $g, $g^~x>, 
                                                                                <'45', '0', '1'>, 
                                                                                <'42', '0'>, '41', 
                                                                                <~ticket, 
                                                                                 mask(ticket_age_add,
                                                                                      $ticket_age)
                                                                                >, 
                                                                                '0'>)
                                                                            >)
                                                                      >, 
                                                                      '2', '0x0303', p_ns, $cipher_suite, 
                                                                      <'13', $sig_algs>, <'40', $g, p_gy>, 
                                                                      <'41', '0'>, '42', '0'>, 
                                                                     '8', $exts>)
                                                                 >,
                                                                 '32'),
                                                          <'fin', '0'>, '32'), 
                                                   h(<
                                                      <
                                                       <'0', '1', '0x0303', ~tid, '0', $cipher_suites, '0', 
                                                        <'43', '0x0304'>, <'10', $g, $g2>, <'40', $g, $g^~x>, 
                                                        <'45', '0', '1'>, <'42', '0'>, '41', 
                                                        <~ticket, mask(ticket_age_add, $ticket_age)>, 
                                                        hmac(<
                                                              Expand(Expand(Extract(Expand(ms,
                                                                                           <'rms', h(messages)
                                                                                           >,
                                                                                           '32'),
                                                                                    '0'),
                                                                            <'res', 'pbk'>, '32'),
                                                                     <'0', '0'>, '32'), 
                                                              h(<'0', '1', '0x0303', ~tid, '0', 
                                                                 $cipher_suites, '0', <'43', '0x0304'>, 
                                                                 <'10', $g, $g2>, <'40', $g, $g^~x>, 
                                                                 <'45', '0', '1'>, <'42', '0'>, '41', 
                                                                 <~ticket, mask(ticket_age_add, $ticket_age)
                                                                 >, 
                                                                 '0'>)
                                                             >)
                                                       >, 
                                                       '2', '0x0303', p_ns, $cipher_suite, <'13', $sig_algs>, 
                                                       <'40', $g, p_gy>, <'41', '0'>, '42', '0'>, 
                                                      '8', $exts>)
                                                  >)
                                            >)
                                         >,
                                         '32'),
                                  <'adke_wk', '0'>, '32')
                ) ▶₀ #l )
    next
      case recv_server_auth_psk_case_2
      by solve( SecretPSK( $A,
                           Expand(Expand(Extract('0',
                                                 Extract(p_gxy,
                                                         Extract(Expand(ms, <'rms', h(messages)>, '32'),
                                                                 '0'))),
                                         <'serverats', 
                                          h(<
                                             <
                                              <
                                               <
                                                <
                                                 <'0', '1', '0x0303', ~tid, '0', $cipher_suites, '0', 
                                                  <'43', '0x0304'>, <'10', $g1, $g>, <'40', $g1, $g1^~x>, 
                                                  <'45', '0', '1'>, <'42', '0'>, '41', 
                                                  <~ticket, mask(ticket_age_add, $ticket_age)>, 
                                                  hmac(<
                                                        Expand(Expand(Extract(Expand(ms, <'rms', h(messages)>,
                                                                                     '32'),
                                                                              '0'),
                                                                      <'res', 'pbk'>, '32'),
                                                               <'0', '0'>, '32'), 
                                                        h(<'0', '1', '0x0303', ~tid, '0', $cipher_suites, 
                                                           '0', <'43', '0x0304'>, <'10', $g1, $g>, 
                                                           <'40', $g1, $g1^~x>, <'45', '0', '1'>, 
                                                           <'42', '0'>, '41', 
                                                           <~ticket, mask(ticket_age_add, $ticket_age)>, '0'>)
                                                       >)
                                                 >, 
                                                 '6', '0x0303', '40', $g>, 
                                                '1', '0x0303', ~new_nc, '0', $cipher_suites.1, '0', 
                                                <'43', '0x0304'>, <'10', $g1, $g>, <'40', $g, $g^~x.1>, 
                                                <'45', '0', '1'>, '0', '41', 
                                                <~ticket, mask(ticket_age_add, '1')>, 
                                                hmac(<
                                                      Expand(Expand(Extract(Expand(ms, <'rms', h(messages)>,
                                                                                   '32'),
                                                                            '0'),
                                                                    <'res', 'pbk'>, '32'),
                                                             <'0', '0'>, '32'), 
                                                      h(<
                                                         <
                                                          <'0', '1', '0x0303', ~tid, '0', $cipher_suites, 
                                                           '0', <'43', '0x0304'>, <'10', $g1, $g>, 
                                                           <'40', $g1, $g1^~x>, <'45', '0', '1'>, 
                                                           <'42', '0'>, '41', 
                                                           <~ticket, mask(ticket_age_add, $ticket_age)>, 
                                                           hmac(<
                                                                 Expand(Expand(Extract(Expand(ms,
                                                                                              <'rms', 
                                                                                               h(messages)>,
                                                                                              '32'),
                                                                                       '0'),
                                                                               <'res', 'pbk'>, '32'),
                                                                        <'0', '0'>, '32'), 
                                                                 h(<'0', '1', '0x0303', ~tid, '0', 
                                                                    $cipher_suites, '0', <'43', '0x0304'>, 
                                                                    <'10', $g1, $g>, <'40', $g1, $g1^~x>, 
                                                                    <'45', '0', '1'>, <'42', '0'>, '41', 
                                                                    <~ticket, 
                                                                     mask(ticket_age_add, $ticket_age)>, 
                                                                    '0'>)
                                                                >)
                                                          >, 
                                                          '6', '0x0303', '40', $g>, 
                                                         '1', '0x0303', ~new_nc, '0', $cipher_suites.1, '0', 
                                                         <'43', '0x0304'>, <'10', $g1, $g>, 
                                                         <'40', $g, $g^~x.1>, <'45', '0', '1'>, '0', '41', 
                                                         <~ticket, mask(ticket_age_add, '1')>, '0'>)
                                                     >)
                                               >, 
                                               '2', '0x0303', p_ns, $cipher_suite, <'13', $sig_algs>, 
                                               <'40', $g, p_gy>, <'41', '0'>, '0'>, 
                                              '8', $exts>, 
                                             '20', 
                                             hmac(<
                                                   Expand(Expand(Extract(p_gxy,
                                                                         Extract(Expand(ms,
                                                                                        <'rms', h(messages)>,
                                                                                        '32'),
                                                                                 '0')),
                                                                 <'serverhts', 
                                                                  h(<
                                                                     <
                                                                      <
                                                                       <
                                                                        <'0', '1', '0x0303', ~tid, '0', 
                                                                         $cipher_suites, '0', 
                                                                         <'43', '0x0304'>, <'10', $g1, $g>, 
                                                                         <'40', $g1, $g1^~x>, 
                                                                         <'45', '0', '1'>, <'42', '0'>, '41', 
                                                                         <~ticket, 
                                                                          mask(ticket_age_add, $ticket_age)>, 
                                                                         hmac(<
                                                                               Expand(Expand(Extract(Expand(ms,
                                                                                                            <
                                                                                                             'rms', 
                                                                                                             h(messages)
                                                                                                            >,
                                                                                                            '32'),
                                                                                                     '0'),
                                                                                             <'res', 'pbk'>,
                                                                                             '32'),
                                                                                      <'0', '0'>, '32'), 
                                                                               h(<'0', '1', '0x0303', ~tid, 
                                                                                  '0', $cipher_suites, '0', 
                                                                                  <'43', '0x0304'>, 
                                                                                  <'10', $g1, $g>, 
                                                                                  <'40', $g1, $g1^~x>, 
                                                                                  <'45', '0', '1'>, 
                                                                                  <'42', '0'>, '41', 
                                                                                  <~ticket, 
                                                                                   mask(ticket_age_add,
                                                                                        $ticket_age)
                                                                                  >, 
                                                                                  '0'>)
                                                                              >)
                                                                        >, 
                                                                        '6', '0x0303', '40', $g>, 
                                                                       '1', '0x0303', ~new_nc, '0', 
                                                                       $cipher_suites.1, '0', 
                                                                       <'43', '0x0304'>, <'10', $g1, $g>, 
                                                                       <'40', $g, $g^~x.1>, <'45', '0', '1'>, 
                                                                       '0', '41', 
                                                                       <~ticket, mask(ticket_age_add, '1')>, 
                                                                       hmac(<
                                                                             Expand(Expand(Extract(Expand(ms,
                                                                                                          <
                                                                                                           'rms', 
                                                                                                           h(messages)
                                                                                                          >,
                                                                                                          '32'),
                                                                                                   '0'),
                                                                                           <'res', 'pbk'>,
                                                                                           '32'),
                                                                                    <'0', '0'>, '32'), 
                                                                             h(<
                                                                                <
                                                                                 <'0', '1', '0x0303', ~tid, 
                                                                                  '0', $cipher_suites, '0', 
                                                                                  <'43', '0x0304'>, 
                                                                                  <'10', $g1, $g>, 
                                                                                  <'40', $g1, $g1^~x>, 
                                                                                  <'45', '0', '1'>, 
                                                                                  <'42', '0'>, '41', 
                                                                                  <~ticket, 
                                                                                   mask(ticket_age_add,
                                                                                        $ticket_age)
                                                                                  >, 
                                                                                  hmac(<
                                                                                        Expand(Expand(Extract(Expand(ms,
                                                                                                                     <
                                                                                                                      'rms', 
                                                                                                                      h(messages)
                                                                                                                     >,
                                                                                                                     '32'),
                                                                                                              '0'),
                                                                                                      <'res', 
                                                                                                       'pbk'>,
                                                                                                      '32'),
                                                                                               <'0', '0'>,
                                                                                               '32'), 
                                                                                        h(<'0', '1', 
                                                                                           '0x0303', ~tid, 
                                                                                           '0', 
                                                                                           $cipher_suites, 
                                                                                           '0', 
                                                                                           <'43', '0x0304'>, 
                                                                                           <'10', $g1, $g>, 
                                                                                           <'40', $g1, $g1^~x
                                                                                           >, 
                                                                                           <'45', '0', '1'>, 
                                                                                           <'42', '0'>, '41', 
                                                                                           <~ticket, 
                                                                                            mask(ticket_age_add,
                                                                                                 $ticket_age)
                                                                                           >, 
                                                                                           '0'>)
                                                                                       >)
                                                                                 >, 
                                                                                 '6', '0x0303', '40', $g>, 
                                                                                '1', '0x0303', ~new_nc, '0', 
                                                                                $cipher_suites.1, '0', 
                                                                                <'43', '0x0304'>, 
                                                                                <'10', $g1, $g>, 
                                                                                <'40', $g, $g^~x.1>, 
                                                                                <'45', '0', '1'>, '0', '41', 
                                                                                <~ticket, 
                                                                                 mask(ticket_age_add, '1')>, 
                                                                                '0'>)
                                                                            >)
                                                                      >, 
                                                                      '2', '0x0303', p_ns, $cipher_suite, 
                                                                      <'13', $sig_algs>, <'40', $g, p_gy>, 
                                                                      <'41', '0'>, '0'>, 
                                                                     '8', $exts>)
                                                                 >,
                                                                 '32'),
                                                          <'fin', '0'>, '32'), 
                                                   h(<
                                                      <
                                                       <
                                                        <
                                                         <'0', '1', '0x0303', ~tid, '0', $cipher_suites, '0', 
                                                          <'43', '0x0304'>, <'10', $g1, $g>, 
                                                          <'40', $g1, $g1^~x>, <'45', '0', '1'>, <'42', '0'>, 
                                                          '41', <~ticket, mask(ticket_age_add, $ticket_age)>, 
                                                          hmac(<
                                                                Expand(Expand(Extract(Expand(ms,
                                                                                             <'rms', 
                                                                                              h(messages)>,
                                                                                             '32'),
                                                                                      '0'),
                                                                              <'res', 'pbk'>, '32'),
                                                                       <'0', '0'>, '32'), 
                                                                h(<'0', '1', '0x0303', ~tid, '0', 
                                                                   $cipher_suites, '0', <'43', '0x0304'>, 
                                                                   <'10', $g1, $g>, <'40', $g1, $g1^~x>, 
                                                                   <'45', '0', '1'>, <'42', '0'>, '41', 
                                                                   <~ticket, mask(ticket_age_add, $ticket_age)
                                                                   >, 
                                                                   '0'>)
                                                               >)
                                                         >, 
                                                         '6', '0x0303', '40', $g>, 
                                                        '1', '0x0303', ~new_nc, '0', $cipher_suites.1, '0', 
                                                        <'43', '0x0304'>, <'10', $g1, $g>, 
                                                        <'40', $g, $g^~x.1>, <'45', '0', '1'>, '0', '41', 
                                                        <~ticket, mask(ticket_age_add, '1')>, 
                                                        hmac(<
                                                              Expand(Expand(Extract(Expand(ms,
                                                                                           <'rms', h(messages)
                                                                                           >,
                                                                                           '32'),
                                                                                    '0'),
                                                                            <'res', 'pbk'>, '32'),
                                                                     <'0', '0'>, '32'), 
                                                              h(<
                                                                 <
                                                                  <'0', '1', '0x0303', ~tid, '0', 
                                                                   $cipher_suites, '0', <'43', '0x0304'>, 
                                                                   <'10', $g1, $g>, <'40', $g1, $g1^~x>, 
                                                                   <'45', '0', '1'>, <'42', '0'>, '41', 
                                                                   <~ticket, mask(ticket_age_add, $ticket_age)
                                                                   >, 
                                                                   hmac(<
                                                                         Expand(Expand(Extract(Expand(ms,
                                                                                                      <'rms', 
                                                                                                       h(messages)
                                                                                                      >,
                                                                                                      '32'),
                                                                                               '0'),
                                                                                       <'res', 'pbk'>, '32'),
                                                                                <'0', '0'>, '32'), 
                                                                         h(<'0', '1', '0x0303', ~tid, '0', 
                                                                            $cipher_suites, '0', 
                                                                            <'43', '0x0304'>, 
                                                                            <'10', $g1, $g>, 
                                                                            <'40', $g1, $g1^~x>, 
                                                                            <'45', '0', '1'>, <'42', '0'>, 
                                                                            '41', 
                                                                            <~ticket, 
                                                                             mask(ticket_age_add, $ticket_age)
                                                                            >, 
                                                                            '0'>)
                                                                        >)
                                                                  >, 
                                                                  '6', '0x0303', '40', $g>, 
                                                                 '1', '0x0303', ~new_nc, '0', 
                                                                 $cipher_suites.1, '0', <'43', '0x0304'>, 
                                                                 <'10', $g1, $g>, <'40', $g, $g^~x.1>, 
                                                                 <'45', '0', '1'>, '0', '41', 
                                                                 <~ticket, mask(ticket_age_add, '1')>, '0'>)
                                                             >)
                                                       >, 
                                                       '2', '0x0303', p_ns, $cipher_suite, <'13', $sig_algs>, 
                                                       <'40', $g, p_gy>, <'41', '0'>, '0'>, 
                                                      '8', $exts>)
                                                  >)
                                            >)
                                         >,
                                         '32'),
                                  <'adke_wk', '0'>, '32')
                ) ▶₀ #l )
    next
      case recv_server_auth_psk_case_3
      by contradiction /* from formulas */
    next
      case recv_server_auth_psk_case_4
      by contradiction /* from formulas */
    next
      case recv_server_auth_psk_case_5
      by solve( SecretPSK( $A,
                           Expand(Expand(Extract('0',
                                                 Extract('0',
                                                         Extract(Expand(ms, <'rms', h(messages)>, '32'),
                                                                 '0'))),
                                         <'serverats', 
                                          h(<
                                             <
                                              <
                                               <'0', '1', '0x0303', ~tid, '0', $cipher_suites, '0', 
                                                <'43', '0x0304'>, <'10', $g1, $g2>, <'40', $g1, $g1^~x>, 
                                                <'45', '0', '1'>, <'42', '0'>, '41', 
                                                <p_psk_id, mask(ticket_age_add, $ticket_age)>, 
                                                hmac(<
                                                      Expand(Expand(Extract(Expand(ms, <'rms', h(messages)>,
                                                                                   '32'),
                                                                            '0'),
                                                                    <'res', 'pbk'>, '32'),
                                                             <'0', '0'>, '32'), 
                                                      h(<'0', '1', '0x0303', ~tid, '0', $cipher_suites, '0', 
                                                         <'43', '0x0304'>, <'10', $g1, $g2>, 
                                                         <'40', $g1, $g1^~x>, <'45', '0', '1'>, <'42', '0'>, 
                                                         '41', <p_psk_id, mask(ticket_age_add, $ticket_age)>, 
                                                         '0'>)
                                                     >)
                                               >, 
                                               '2', '0x0303', p_ns, $cipher_suite, <'13', $sig_algs>, 
                                               <'41', '0'>, '42', '0'>, 
                                              '8', $exts>, 
                                             '20', 
                                             hmac(<
                                                   Expand(Expand(Extract('0',
                                                                         Extract(Expand(ms,
                                                                                        <'rms', h(messages)>,
                                                                                        '32'),
                                                                                 '0')),
                                                                 <'serverhts', 
                                                                  h(<
                                                                     <
                                                                      <'0', '1', '0x0303', ~tid, '0', 
                                                                       $cipher_suites, '0', <'43', '0x0304'>, 
                                                                       <'10', $g1, $g2>, <'40', $g1, $g1^~x>, 
                                                                       <'45', '0', '1'>, <'42', '0'>, '41', 
                                                                       <p_psk_id, 
                                                                        mask(ticket_age_add, $ticket_age)>, 
                                                                       hmac(<
                                                                             Expand(Expand(Extract(Expand(ms,
                                                                                                          <
                                                                                                           'rms', 
                                                                                                           h(messages)
                                                                                                          >,
                                                                                                          '32'),
                                                                                                   '0'),
                                                                                           <'res', 'pbk'>,
                                                                                           '32'),
                                                                                    <'0', '0'>, '32'), 
                                                                             h(<'0', '1', '0x0303', ~tid, 
                                                                                '0', $cipher_suites, '0', 
                                                                                <'43', '0x0304'>, 
                                                                                <'10', $g1, $g2>, 
                                                                                <'40', $g1, $g1^~x>, 
                                                                                <'45', '0', '1'>, 
                                                                                <'42', '0'>, '41', 
                                                                                <p_psk_id, 
                                                                                 mask(ticket_age_add,
                                                                                      $ticket_age)
                                                                                >, 
                                                                                '0'>)
                                                                            >)
                                                                      >, 
                                                                      '2', '0x0303', p_ns, $cipher_suite, 
                                                                      <'13', $sig_algs>, <'41', '0'>, '42', 
                                                                      '0'>, 
                                                                     '8', $exts>)
                                                                 >,
                                                                 '32'),
                                                          <'fin', '0'>, '32'), 
                                                   h(<
                                                      <
                                                       <'0', '1', '0x0303', ~tid, '0', $cipher_suites, '0', 
                                                        <'43', '0x0304'>, <'10', $g1, $g2>, 
                                                        <'40', $g1, $g1^~x>, <'45', '0', '1'>, <'42', '0'>, 
                                                        '41', <p_psk_id, mask(ticket_age_add, $ticket_age)>, 
                                                        hmac(<
                                                              Expand(Expand(Extract(Expand(ms,
                                                                                           <'rms', h(messages)
                                                                                           >,
                                                                                           '32'),
                                                                                    '0'),
                                                                            <'res', 'pbk'>, '32'),
                                                                     <'0', '0'>, '32'), 
                                                              h(<'0', '1', '0x0303', ~tid, '0', 
                                                                 $cipher_suites, '0', <'43', '0x0304'>, 
                                                                 <'10', $g1, $g2>, <'40', $g1, $g1^~x>, 
                                                                 <'45', '0', '1'>, <'42', '0'>, '41', 
                                                                 <p_psk_id, mask(ticket_age_add, $ticket_age)
                                                                 >, 
                                                                 '0'>)
                                                             >)
                                                       >, 
                                                       '2', '0x0303', p_ns, $cipher_suite, <'13', $sig_algs>, 
                                                       <'41', '0'>, '42', '0'>, 
                                                      '8', $exts>)
                                                  >)
                                            >)
                                         >,
                                         '32'),
                                  <'adke_wk', '0'>, '32')
                ) ▶₀ #l )
    next
      case recv_server_auth_psk_case_6
      by solve( SecretPSK( $A,
                           Expand(Expand(Extract('0',
                                                 Extract('0',
                                                         Extract(Expand(ms, <'rms', h(messages)>, '32'),
                                                                 '0'))),
                                         <'serverats', 
                                          h(<
                                             <
                                              <
                                               <
                                                <
                                                 <'0', '1', '0x0303', ~tid, '0', $cipher_suites, '0', 
                                                  <'43', '0x0304'>, <'10', $g1, $g2>, <'40', $g1, $g1^~x>, 
                                                  <'45', '0', '1'>, <'42', '0'>, '41', 
                                                  <p_psk_id, mask(ticket_age_add, $ticket_age)>, 
                                                  hmac(<
                                                        Expand(Expand(Extract(Expand(ms, <'rms', h(messages)>,
                                                                                     '32'),
                                                                              '0'),
                                                                      <'res', 'pbk'>, '32'),
                                                               <'0', '0'>, '32'), 
                                                        h(<'0', '1', '0x0303', ~tid, '0', $cipher_suites, 
                                                           '0', <'43', '0x0304'>, <'10', $g1, $g2>, 
                                                           <'40', $g1, $g1^~x>, <'45', '0', '1'>, 
                                                           <'42', '0'>, '41', 
                                                           <p_psk_id, mask(ticket_age_add, $ticket_age)>, '0'
                                                          >)
                                                       >)
                                                 >, 
                                                 '6', '0x0303', '40', $g2>, 
                                                '1', '0x0303', ~new_nc, '0', $cipher_suites.1, '0', 
                                                <'43', '0x0304'>, <'10', $g1, $g2>, <'40', $g2, $g2^~new_x>, 
                                                <'45', '0', '1'>, '0', '41', 
                                                <p_psk_id, mask(ticket_age_add, '1')>, 
                                                hmac(<
                                                      Expand(Expand(Extract(Expand(ms, <'rms', h(messages)>,
                                                                                   '32'),
                                                                            '0'),
                                                                    <'res', 'pbk'>, '32'),
                                                             <'0', '0'>, '32'), 
                                                      h(<
                                                         <
                                                          <'0', '1', '0x0303', ~tid, '0', $cipher_suites, 
                                                           '0', <'43', '0x0304'>, <'10', $g1, $g2>, 
                                                           <'40', $g1, $g1^~x>, <'45', '0', '1'>, 
                                                           <'42', '0'>, '41', 
                                                           <p_psk_id, mask(ticket_age_add, $ticket_age)>, 
                                                           hmac(<
                                                                 Expand(Expand(Extract(Expand(ms,
                                                                                              <'rms', 
                                                                                               h(messages)>,
                                                                                              '32'),
                                                                                       '0'),
                                                                               <'res', 'pbk'>, '32'),
                                                                        <'0', '0'>, '32'), 
                                                                 h(<'0', '1', '0x0303', ~tid, '0', 
                                                                    $cipher_suites, '0', <'43', '0x0304'>, 
                                                                    <'10', $g1, $g2>, <'40', $g1, $g1^~x>, 
                                                                    <'45', '0', '1'>, <'42', '0'>, '41', 
                                                                    <p_psk_id, 
                                                                     mask(ticket_age_add, $ticket_age)>, 
                                                                    '0'>)
                                                                >)
                                                          >, 
                                                          '6', '0x0303', '40', $g2>, 
                                                         '1', '0x0303', ~new_nc, '0', $cipher_suites.1, '0', 
                                                         <'43', '0x0304'>, <'10', $g1, $g2>, 
                                                         <'40', $g2, $g2^~new_x>, <'45', '0', '1'>, '0', 
                                                         '41', <p_psk_id, mask(ticket_age_add, '1')>, '0'>)
                                                     >)
                                               >, 
                                               '2', '0x0303', p_ns, $cipher_suite, <'13', $sig_algs>, 
                                               <'41', '0'>, '0'>, 
                                              '8', $exts>, 
                                             '20', 
                                             hmac(<
                                                   Expand(Expand(Extract('0',
                                                                         Extract(Expand(ms,
                                                                                        <'rms', h(messages)>,
                                                                                        '32'),
                                                                                 '0')),
                                                                 <'serverhts', 
                                                                  h(<
                                                                     <
                                                                      <
                                                                       <
                                                                        <'0', '1', '0x0303', ~tid, '0', 
                                                                         $cipher_suites, '0', 
                                                                         <'43', '0x0304'>, <'10', $g1, $g2>, 
                                                                         <'40', $g1, $g1^~x>, 
                                                                         <'45', '0', '1'>, <'42', '0'>, '41', 
                                                                         <p_psk_id, 
                                                                          mask(ticket_age_add, $ticket_age)>, 
                                                                         hmac(<
                                                                               Expand(Expand(Extract(Expand(ms,
                                                                                                            <
                                                                                                             'rms', 
                                                                                                             h(messages)
                                                                                                            >,
                                                                                                            '32'),
                                                                                                     '0'),
                                                                                             <'res', 'pbk'>,
                                                                                             '32'),
                                                                                      <'0', '0'>, '32'), 
                                                                               h(<'0', '1', '0x0303', ~tid, 
                                                                                  '0', $cipher_suites, '0', 
                                                                                  <'43', '0x0304'>, 
                                                                                  <'10', $g1, $g2>, 
                                                                                  <'40', $g1, $g1^~x>, 
                                                                                  <'45', '0', '1'>, 
                                                                                  <'42', '0'>, '41', 
                                                                                  <p_psk_id, 
                                                                                   mask(ticket_age_add,
                                                                                        $ticket_age)
                                                                                  >, 
                                                                                  '0'>)
                                                                              >)
                                                                        >, 
                                                                        '6', '0x0303', '40', $g2>, 
                                                                       '1', '0x0303', ~new_nc, '0', 
                                                                       $cipher_suites.1, '0', 
                                                                       <'43', '0x0304'>, <'10', $g1, $g2>, 
                                                                       <'40', $g2, $g2^~new_x>, 
                                                                       <'45', '0', '1'>, '0', '41', 
                                                                       <p_psk_id, mask(ticket_age_add, '1')>, 
                                                                       hmac(<
                                                                             Expand(Expand(Extract(Expand(ms,
                                                                                                          <
                                                                                                           'rms', 
                                                                                                           h(messages)
                                                                                                          >,
                                                                                                          '32'),
                                                                                                   '0'),
                                                                                           <'res', 'pbk'>,
                                                                                           '32'),
                                                                                    <'0', '0'>, '32'), 
                                                                             h(<
                                                                                <
                                                                                 <'0', '1', '0x0303', ~tid, 
                                                                                  '0', $cipher_suites, '0', 
                                                                                  <'43', '0x0304'>, 
                                                                                  <'10', $g1, $g2>, 
                                                                                  <'40', $g1, $g1^~x>, 
                                                                                  <'45', '0', '1'>, 
                                                                                  <'42', '0'>, '41', 
                                                                                  <p_psk_id, 
                                                                                   mask(ticket_age_add,
                                                                                        $ticket_age)
                                                                                  >, 
                                                                                  hmac(<
                                                                                        Expand(Expand(Extract(Expand(ms,
                                                                                                                     <
                                                                                                                      'rms', 
                                                                                                                      h(messages)
                                                                                                                     >,
                                                                                                                     '32'),
                                                                                                              '0'),
                                                                                                      <'res', 
                                                                                                       'pbk'>,
                                                                                                      '32'),
                                                                                               <'0', '0'>,
                                                                                               '32'), 
                                                                                        h(<'0', '1', 
                                                                                           '0x0303', ~tid, 
                                                                                           '0', 
                                                                                           $cipher_suites, 
                                                                                           '0', 
                                                                                           <'43', '0x0304'>, 
                                                                                           <'10', $g1, $g2>, 
                                                                                           <'40', $g1, $g1^~x
                                                                                           >, 
                                                                                           <'45', '0', '1'>, 
                                                                                           <'42', '0'>, '41', 
                                                                                           <p_psk_id, 
                                                                                            mask(ticket_age_add,
                                                                                                 $ticket_age)
                                                                                           >, 
                                                                                           '0'>)
                                                                                       >)
                                                                                 >, 
                                                                                 '6', '0x0303', '40', $g2>, 
                                                                                '1', '0x0303', ~new_nc, '0', 
                                                                                $cipher_suites.1, '0', 
                                                                                <'43', '0x0304'>, 
                                                                                <'10', $g1, $g2>, 
                                                                                <'40', $g2, $g2^~new_x>, 
                                                                                <'45', '0', '1'>, '0', '41', 
                                                                                <p_psk_id, 
                                                                                 mask(ticket_age_add, '1')>, 
                                                                                '0'>)
                                                                            >)
                                                                      >, 
                                                                      '2', '0x0303', p_ns, $cipher_suite, 
                                                                      <'13', $sig_algs>, <'41', '0'>, '0'>, 
                                                                     '8', $exts>)
                                                                 >,
                                                                 '32'),
                                                          <'fin', '0'>, '32'), 
                                                   h(<
                                                      <
                                                       <
                                                        <
                                                         <'0', '1', '0x0303', ~tid, '0', $cipher_suites, '0', 
                                                          <'43', '0x0304'>, <'10', $g1, $g2>, 
                                                          <'40', $g1, $g1^~x>, <'45', '0', '1'>, <'42', '0'>, 
                                                          '41', 
                                                          <p_psk_id, mask(ticket_age_add, $ticket_age)>, 
                                                          hmac(<
                                                                Expand(Expand(Extract(Expand(ms,
                                                                                             <'rms', 
                                                                                              h(messages)>,
                                                                                             '32'),
                                                                                      '0'),
                                                                              <'res', 'pbk'>, '32'),
                                                                       <'0', '0'>, '32'), 
                                                                h(<'0', '1', '0x0303', ~tid, '0', 
                                                                   $cipher_suites, '0', <'43', '0x0304'>, 
                                                                   <'10', $g1, $g2>, <'40', $g1, $g1^~x>, 
                                                                   <'45', '0', '1'>, <'42', '0'>, '41', 
                                                                   <p_psk_id, 
                                                                    mask(ticket_age_add, $ticket_age)>, 
                                                                   '0'>)
                                                               >)
                                                         >, 
                                                         '6', '0x0303', '40', $g2>, 
                                                        '1', '0x0303', ~new_nc, '0', $cipher_suites.1, '0', 
                                                        <'43', '0x0304'>, <'10', $g1, $g2>, 
                                                        <'40', $g2, $g2^~new_x>, <'45', '0', '1'>, '0', '41', 
                                                        <p_psk_id, mask(ticket_age_add, '1')>, 
                                                        hmac(<
                                                              Expand(Expand(Extract(Expand(ms,
                                                                                           <'rms', h(messages)
                                                                                           >,
                                                                                           '32'),
                                                                                    '0'),
                                                                            <'res', 'pbk'>, '32'),
                                                                     <'0', '0'>, '32'), 
                                                              h(<
                                                                 <
                                                                  <'0', '1', '0x0303', ~tid, '0', 
                                                                   $cipher_suites, '0', <'43', '0x0304'>, 
                                                                   <'10', $g1, $g2>, <'40', $g1, $g1^~x>, 
                                                                   <'45', '0', '1'>, <'42', '0'>, '41', 
                                                                   <p_psk_id, 
                                                                    mask(ticket_age_add, $ticket_age)>, 
                                                                   hmac(<
                                                                         Expand(Expand(Extract(Expand(ms,
                                                                                                      <'rms', 
                                                                                                       h(messages)
                                                                                                      >,
                                                                                                      '32'),
                                                                                               '0'),
                                                                                       <'res', 'pbk'>, '32'),
                                                                                <'0', '0'>, '32'), 
                                                                         h(<'0', '1', '0x0303', ~tid, '0', 
                                                                            $cipher_suites, '0', 
                                                                            <'43', '0x0304'>, 
                                                                            <'10', $g1, $g2>, 
                                                                            <'40', $g1, $g1^~x>, 
                                                                            <'45', '0', '1'>, <'42', '0'>, 
                                                                            '41', 
                                                                            <p_psk_id, 
                                                                             mask(ticket_age_add, $ticket_age)
                                                                            >, 
                                                                            '0'>)
                                                                        >)
                                                                  >, 
                                                                  '6', '0x0303', '40', $g2>, 
                                                                 '1', '0x0303', ~new_nc, '0', 
                                                                 $cipher_suites.1, '0', <'43', '0x0304'>, 
                                                                 <'10', $g1, $g2>, <'40', $g2, $g2^~new_x>, 
                                                                 <'45', '0', '1'>, '0', '41', 
                                                                 <p_psk_id, mask(ticket_age_add, '1')>, '0'>)
                                                             >)
                                                       >, 
                                                       '2', '0x0303', p_ns, $cipher_suite, <'13', $sig_algs>, 
                                                       <'41', '0'>, '0'>, 
                                                      '8', $exts>)
                                                  >)
                                            >)
                                         >,
                                         '32'),
                                  <'adke_wk', '0'>, '32')
                ) ▶₀ #l )
    next
      case recv_server_auth_psk_case_7
      by contradiction /* from formulas */
    next
      case recv_server_auth_psk_case_8
      by contradiction /* from formulas */
    qed
  qed
next
  case client_auth_cert
  solve( (∃ #j. (!KU( p_sats ) @ #j) ∧ #j < #vk)  ∥
         ((∀ #k. (!KU( p_sats ) @ #k) ⇒ ¬(#k < #vk)) ∧
          (∃ actor #l.
            (RevealPSK( actor, Expand(p_sats, <'adke_wk', '0'>, '32') ) @ #l)
           ∧
            #l < #vk)) )
    case case_1
    solve( F_State_C3( ~tid, $C, $S, p_res_psk, p_messages, p_nc, p_ns, p_g,
                       p_sg, p_hrr, p_x, p_y, p_gx, p_gy, p_gxy, 'na', p_psk_id, p_edi, p_es,
                       p_hs, Extract('0', p_hs), p_cats, p_sats, p_hs_keyc, p_hs_keys,
                       p_auth_status, p_ems, p_rms, '1'
           ) ▶₀ #i )
      case recv_server_auth_case_01
      solve( (∃ #j.2.
               (!KU( Extract('0', Extract(p_gxy, Extract('0', '0'))) ) @ #j.2)
              ∧
               #j.2 < #j.1)  ∥
             ((∀ #k.
                (!KU( Extract('0', Extract(p_gxy, Extract('0', '0'))) ) @ #k)
               ⇒
                ¬(#k < #j.1)) ∧
              (∃ actor #l.
                (RevealPSK( actor,
                            Expand(Extract('0', Extract(p_gxy, Extract('0', '0'))),
                                   <'serverats', 
                                    h(<
                                       <
                                        <
                                         <
                                          <
                                           <
                                            <'0', '1', '0x0303', ~tid, '0', $cipher_suites, '0', 
                                             <'43', '0x0304'>, <'10', $g, $g2>, <'13', $sig_algs>, '40', $g, 
                                             $g^~x>, 
                                            '2', '0x0303', p_ns, $cipher_suite, <'13', $sig_algs.1>, '40', 
                                            $g, p_gy>, 
                                           '8', $exts>, 
                                          '13', '0', $certificate_extensions>, 
                                         '11', '0', pk(~ltkS)>, 
                                        '15', 
                                        sign(<'server_cv', 
                                              h(<
                                                 <
                                                  <
                                                   <
                                                    <'0', '1', '0x0303', ~tid, '0', $cipher_suites, '0', 
                                                     <'43', '0x0304'>, <'10', $g, $g2>, <'13', $sig_algs>, 
                                                     '40', $g, $g^~x>, 
                                                    '2', '0x0303', p_ns, $cipher_suite, <'13', $sig_algs.1>, 
                                                    '40', $g, p_gy>, 
                                                   '8', $exts>, 
                                                  '13', '0', $certificate_extensions>, 
                                                 '11', '0', pk(~ltkS)>)
                                             >,
                                             ~ltkS)
                                       >, 
                                       '20', 
                                       hmac(<
                                             Expand(Expand(Extract(p_gxy, Extract('0', '0')),
                                                           <'serverhts', 
                                                            h(<
                                                               <
                                                                <
                                                                 <
                                                                  <
                                                                   <'0', '1', '0x0303', ~tid, '0', 
                                                                    $cipher_suites, '0', <'43', '0x0304'>, 
                                                                    <'10', $g, $g2>, <'13', $sig_algs>, '40', 
                                                                    $g, $g^~x>, 
                                                                   '2', '0x0303', p_ns, $cipher_suite, 
                                                                   <'13', $sig_algs.1>, '40', $g, p_gy>, 
                                                                  '8', $exts>, 
                                                                 '13', '0', $certificate_extensions>, 
                                                                '11', '0', pk(~ltkS)>, 
                                                               '15', 
                                                               sign(<'server_cv', 
                                                                     h(<
                                                                        <
                                                                         <
                                                                          <
                                                                           <'0', '1', '0x0303', ~tid, '0', 
                                                                            $cipher_suites, '0', 
                                                                            <'43', '0x0304'>, 
                                                                            <'10', $g, $g2>, 
                                                                            <'13', $sig_algs>, '40', $g, $g^~x
                                                                           >, 
                                                                           '2', '0x0303', p_ns, 
                                                                           $cipher_suite, 
                                                                           <'13', $sig_algs.1>, '40', $g, p_gy
                                                                          >, 
                                                                          '8', $exts>, 
                                                                         '13', '0', $certificate_extensions>, 
                                                                        '11', '0', pk(~ltkS)>)
                                                                    >,
                                                                    ~ltkS)
                                                              >)
                                                           >,
                                                           '32'),
                                                    <'fin', '0'>, '32'), 
                                             h(<
                                                <
                                                 <
                                                  <
                                                   <
                                                    <'0', '1', '0x0303', ~tid, '0', $cipher_suites, '0', 
                                                     <'43', '0x0304'>, <'10', $g, $g2>, <'13', $sig_algs>, 
                                                     '40', $g, $g^~x>, 
                                                    '2', '0x0303', p_ns, $cipher_suite, <'13', $sig_algs.1>, 
                                                    '40', $g, p_gy>, 
                                                   '8', $exts>, 
                                                  '13', '0', $certificate_extensions>, 
                                                 '11', '0', pk(~ltkS)>, 
                                                '15', 
                                                sign(<'server_cv', 
                                                      h(<
                                                         <
                                                          <
                                                           <
                                                            <'0', '1', '0x0303', ~tid, '0', $cipher_suites, 
                                                             '0', <'43', '0x0304'>, <'10', $g, $g2>, 
                                                             <'13', $sig_algs>, '40', $g, $g^~x>, 
                                                            '2', '0x0303', p_ns, $cipher_suite, 
                                                            <'13', $sig_algs.1>, '40', $g, p_gy>, 
                                                           '8', $exts>, 
                                                          '13', '0', $certificate_extensions>, 
                                                         '11', '0', pk(~ltkS)>)
                                                     >,
                                                     ~ltkS)
                                               >)
                                            >)
                                      >)
                                   >,
                                   '32')
                 ) @ #l)
               ∧
                #l < #j.1)) )
        case case_1
        solve( (∃ #r. (RevLtk( $S ) @ #r) ∧ #r < #vr)  ∥
               (∃ tid3 x #r. (RevDHExp( tid3, $S, x ) @ #r) ∧ #r < #vr)  ∥
               (∃ tid4 y #r. (RevDHExp( tid4, $C, y ) @ #r) ∧ #r < #vr)  ∥
               (∃ rms #r. (RevealPSK( $C, rms ) @ #r) ∧ #r < #k.1)  ∥
               (∃ rms #r. (RevealPSK( $S, rms ) @ #r) ∧ #r < #k.1) )
          case case_1
          by contradiction /* from formulas */
        next
          case case_2
          by contradiction /* from formulas */
        next
          case case_3
          by contradiction /* from formulas */
        next
          case case_4
          by contradiction /* from formulas */
        next
          case case_5
          by contradiction /* from formulas */
        qed
      next
        case case_2
        solve( !Ltk( $C, ~ltkC ) ▶₂ #i )
          case Register_pk
          by solve( SecretPSK( $A,
                               Expand(Extract('0', Extract(p_gxy, Extract('0', '0'))),
                                      <'serverats', 
                                       h(<
                                          <
                                           <
                                            <
                                             <
                                              <
                                               <'0', '1', '0x0303', ~tid, '0', $cipher_suites, '0', 
                                                <'43', '0x0304'>, <'10', $g, $g2>, <'13', $sig_algs>, '40', 
                                                $g, $g^~x>, 
                                               '2', '0x0303', p_ns, $cipher_suite, <'13', $sig_algs.1>, '40', 
                                               $g, p_gy>, 
                                              '8', $exts>, 
                                             '13', '0', $certificate_extensions>, 
                                            '11', '0', pk(~ltkS)>, 
                                           '15', 
                                           sign(<'server_cv', 
                                                 h(<
                                                    <
                                                     <
                                                      <
                                                       <'0', '1', '0x0303', ~tid, '0', $cipher_suites, '0', 
                                                        <'43', '0x0304'>, <'10', $g, $g2>, <'13', $sig_algs>, 
                                                        '40', $g, $g^~x>, 
                                                       '2', '0x0303', p_ns, $cipher_suite, 
                                                       <'13', $sig_algs.1>, '40', $g, p_gy>, 
                                                      '8', $exts>, 
                                                     '13', '0', $certificate_extensions>, 
                                                    '11', '0', pk(~ltkS)>)
                                                >,
                                                ~ltkS)
                                          >, 
                                          '20', 
                                          hmac(<
                                                Expand(Expand(Extract(p_gxy, Extract('0', '0')),
                                                              <'serverhts', 
                                                               h(<
                                                                  <
                                                                   <
                                                                    <
                                                                     <
                                                                      <'0', '1', '0x0303', ~tid, '0', 
                                                                       $cipher_suites, '0', <'43', '0x0304'>, 
                                                                       <'10', $g, $g2>, <'13', $sig_algs>, 
                                                                       '40', $g, $g^~x>, 
                                                                      '2', '0x0303', p_ns, $cipher_suite, 
                                                                      <'13', $sig_algs.1>, '40', $g, p_gy>, 
                                                                     '8', $exts>, 
                                                                    '13', '0', $certificate_extensions>, 
                                                                   '11', '0', pk(~ltkS)>, 
                                                                  '15', 
                                                                  sign(<'server_cv', 
                                                                        h(<
                                                                           <
                                                                            <
                                                                             <
                                                                              <'0', '1', '0x0303', ~tid, '0', 
                                                                               $cipher_suites, '0', 
                                                                               <'43', '0x0304'>, 
                                                                               <'10', $g, $g2>, 
                                                                               <'13', $sig_algs>, '40', $g, 
                                                                               $g^~x>, 
                                                                              '2', '0x0303', p_ns, 
                                                                              $cipher_suite, 
                                                                              <'13', $sig_algs.1>, '40', $g, 
                                                                              p_gy>, 
                                                                             '8', $exts>, 
                                                                            '13', '0', $certificate_extensions
                                                                           >, 
                                                                           '11', '0', pk(~ltkS)>)
                                                                       >,
                                                                       ~ltkS)
                                                                 >)
                                                              >,
                                                              '32'),
                                                       <'fin', '0'>, '32'), 
                                                h(<
                                                   <
                                                    <
                                                     <
                                                      <
                                                       <'0', '1', '0x0303', ~tid, '0', $cipher_suites, '0', 
                                                        <'43', '0x0304'>, <'10', $g, $g2>, <'13', $sig_algs>, 
                                                        '40', $g, $g^~x>, 
                                                       '2', '0x0303', p_ns, $cipher_suite, 
                                                       <'13', $sig_algs.1>, '40', $g, p_gy>, 
                                                      '8', $exts>, 
                                                     '13', '0', $certificate_extensions>, 
                                                    '11', '0', pk(~ltkS)>, 
                                                   '15', 
                                                   sign(<'server_cv', 
                                                         h(<
                                                            <
                                                             <
                                                              <
                                                               <'0', '1', '0x0303', ~tid, '0', 
                                                                $cipher_suites, '0', <'43', '0x0304'>, 
                                                                <'10', $g, $g2>, <'13', $sig_algs>, '40', $g, 
                                                                $g^~x>, 
                                                               '2', '0x0303', p_ns, $cipher_suite, 
                                                               <'13', $sig_algs.1>, '40', $g, p_gy>, 
                                                              '8', $exts>, 
                                                             '13', '0', $certificate_extensions>, 
                                                            '11', '0', pk(~ltkS)>)
                                                        >,
                                                        ~ltkS)
                                                  >)
                                               >)
                                         >)
                                      >,
                                      '32')
                    ) ▶₀ #l )
        qed
      qed
    next
      case recv_server_auth_case_02
      solve( (∃ #j.2.
               (!KU( Extract('0', Extract(p_gxy, Extract('0', '0'))) ) @ #j.2)
              ∧
               #j.2 < #j.1)  ∥
             ((∀ #k.
                (!KU( Extract('0', Extract(p_gxy, Extract('0', '0'))) ) @ #k)
               ⇒
                ¬(#k < #j.1)) ∧
              (∃ actor #l.
                (RevealPSK( actor,
                            Expand(Extract('0', Extract(p_gxy, Extract('0', '0'))),
                                   <'serverats', 
                                    h(<
                                       <
                                        <
                                         <
                                          <
                                           <
                                            <
                                             <
                                              <'0', '1', '0x0303', ~tid, '0', $cipher_suites, '0', 
                                               <'43', '0x0304'>, <'10', $g1, $g>, <'13', $sig_algs>, '40', 
                                               $g1, $g1^~x>, 
                                              '6', '0x0303', '40', $g>, 
                                             '1', '0x0303', ~tid, '0', $cipher_suites.1, '0', 
                                             <'43', '0x0304'>, <'10', $g1, $g>, <'13', $sig_algs.1>, '40', 
                                             $g, $g^~x.1>, 
                                            '2', '0x0303', p_ns, $cipher_suite, <'13', $sig_algs.2>, '40', 
                                            $g, p_gy>, 
                                           '8', $exts>, 
                                          '13', '0', $certificate_extensions>, 
                                         '11', '0', pk(~ltkS)>, 
                                        '15', 
                                        sign(<'server_cv', 
                                              h(<
                                                 <
                                                  <
                                                   <
                                                    <
                                                     <
                                                      <'0', '1', '0x0303', ~tid, '0', $cipher_suites, '0', 
                                                       <'43', '0x0304'>, <'10', $g1, $g>, <'13', $sig_algs>, 
                                                       '40', $g1, $g1^~x>, 
                                                      '6', '0x0303', '40', $g>, 
                                                     '1', '0x0303', ~tid, '0', $cipher_suites.1, '0', 
                                                     <'43', '0x0304'>, <'10', $g1, $g>, <'13', $sig_algs.1>, 
                                                     '40', $g, $g^~x.1>, 
                                                    '2', '0x0303', p_ns, $cipher_suite, <'13', $sig_algs.2>, 
                                                    '40', $g, p_gy>, 
                                                   '8', $exts>, 
                                                  '13', '0', $certificate_extensions>, 
                                                 '11', '0', pk(~ltkS)>)
                                             >,
                                             ~ltkS)
                                       >, 
                                       '20', 
                                       hmac(<
                                             Expand(Expand(Extract(p_gxy, Extract('0', '0')),
                                                           <'serverhts', 
                                                            h(<
                                                               <
                                                                <
                                                                 <
                                                                  <
                                                                   <
                                                                    <
                                                                     <'0', '1', '0x0303', ~tid, '0', 
                                                                      $cipher_suites, '0', <'43', '0x0304'>, 
                                                                      <'10', $g1, $g>, <'13', $sig_algs>, 
                                                                      '40', $g1, $g1^~x>, 
                                                                     '6', '0x0303', '40', $g>, 
                                                                    '1', '0x0303', ~tid, '0', 
                                                                    $cipher_suites.1, '0', <'43', '0x0304'>, 
                                                                    <'10', $g1, $g>, <'13', $sig_algs.1>, 
                                                                    '40', $g, $g^~x.1>, 
                                                                   '2', '0x0303', p_ns, $cipher_suite, 
                                                                   <'13', $sig_algs.2>, '40', $g, p_gy>, 
                                                                  '8', $exts>, 
                                                                 '13', '0', $certificate_extensions>, 
                                                                '11', '0', pk(~ltkS)>, 
                                                               '15', 
                                                               sign(<'server_cv', 
                                                                     h(<
                                                                        <
                                                                         <
                                                                          <
                                                                           <
                                                                            <
                                                                             <'0', '1', '0x0303', ~tid, '0', 
                                                                              $cipher_suites, '0', 
                                                                              <'43', '0x0304'>, 
                                                                              <'10', $g1, $g>, 
                                                                              <'13', $sig_algs>, '40', $g1, 
                                                                              $g1^~x>, 
                                                                             '6', '0x0303', '40', $g>, 
                                                                            '1', '0x0303', ~tid, '0', 
                                                                            $cipher_suites.1, '0', 
                                                                            <'43', '0x0304'>, 
                                                                            <'10', $g1, $g>, 
                                                                            <'13', $sig_algs.1>, '40', $g, 
                                                                            $g^~x.1>, 
                                                                           '2', '0x0303', p_ns, 
                                                                           $cipher_suite, 
                                                                           <'13', $sig_algs.2>, '40', $g, p_gy
                                                                          >, 
                                                                          '8', $exts>, 
                                                                         '13', '0', $certificate_extensions>, 
                                                                        '11', '0', pk(~ltkS)>)
                                                                    >,
                                                                    ~ltkS)
                                                              >)
                                                           >,
                                                           '32'),
                                                    <'fin', '0'>, '32'), 
                                             h(<
                                                <
                                                 <
                                                  <
                                                   <
                                                    <
                                                     <
                                                      <'0', '1', '0x0303', ~tid, '0', $cipher_suites, '0', 
                                                       <'43', '0x0304'>, <'10', $g1, $g>, <'13', $sig_algs>, 
                                                       '40', $g1, $g1^~x>, 
                                                      '6', '0x0303', '40', $g>, 
                                                     '1', '0x0303', ~tid, '0', $cipher_suites.1, '0', 
                                                     <'43', '0x0304'>, <'10', $g1, $g>, <'13', $sig_algs.1>, 
                                                     '40', $g, $g^~x.1>, 
                                                    '2', '0x0303', p_ns, $cipher_suite, <'13', $sig_algs.2>, 
                                                    '40', $g, p_gy>, 
                                                   '8', $exts>, 
                                                  '13', '0', $certificate_extensions>, 
                                                 '11', '0', pk(~ltkS)>, 
                                                '15', 
                                                sign(<'server_cv', 
                                                      h(<
                                                         <
                                                          <
                                                           <
                                                            <
                                                             <
                                                              <'0', '1', '0x0303', ~tid, '0', $cipher_suites, 
                                                               '0', <'43', '0x0304'>, <'10', $g1, $g>, 
                                                               <'13', $sig_algs>, '40', $g1, $g1^~x>, 
                                                              '6', '0x0303', '40', $g>, 
                                                             '1', '0x0303', ~tid, '0', $cipher_suites.1, '0', 
                                                             <'43', '0x0304'>, <'10', $g1, $g>, 
                                                             <'13', $sig_algs.1>, '40', $g, $g^~x.1>, 
                                                            '2', '0x0303', p_ns, $cipher_suite, 
                                                            <'13', $sig_algs.2>, '40', $g, p_gy>, 
                                                           '8', $exts>, 
                                                          '13', '0', $certificate_extensions>, 
                                                         '11', '0', pk(~ltkS)>)
                                                     >,
                                                     ~ltkS)
                                               >)
                                            >)
                                      >)
                                   >,
                                   '32')
                 ) @ #l)
               ∧
                #l < #j.1)) )
        case case_1
        solve( (∃ #r. (RevLtk( $S ) @ #r) ∧ #r < #vr)  ∥
               (∃ tid3 x #r. (RevDHExp( tid3, $S, x ) @ #r) ∧ #r < #vr)  ∥
               (∃ tid4 y #r. (RevDHExp( tid4, $C, y ) @ #r) ∧ #r < #vr)  ∥
               (∃ rms #r. (RevealPSK( $C, rms ) @ #r) ∧ #r < #k.1)  ∥
               (∃ rms #r. (RevealPSK( $S, rms ) @ #r) ∧ #r < #k.1) )
          case case_1
          by contradiction /* from formulas */
        next
          case case_2
          by contradiction /* from formulas */
        next
          case case_3
          by contradiction /* from formulas */
        next
          case case_4
          by contradiction /* from formulas */
        next
          case case_5
          by contradiction /* from formulas */
        qed
      next
        case case_2
        solve( !Ltk( $C, ~ltkC ) ▶₂ #i )
          case Register_pk
          by solve( SecretPSK( $A,
                               Expand(Extract('0', Extract(p_gxy, Extract('0', '0'))),
                                      <'serverats', 
                                       h(<
                                          <
                                           <
                                            <
                                             <
                                              <
                                               <
                                                <
                                                 <'0', '1', '0x0303', ~tid, '0', $cipher_suites, '0', 
                                                  <'43', '0x0304'>, <'10', $g1, $g>, <'13', $sig_algs>, '40', 
                                                  $g1, $g1^~x>, 
                                                 '6', '0x0303', '40', $g>, 
                                                '1', '0x0303', ~tid, '0', $cipher_suites.1, '0', 
                                                <'43', '0x0304'>, <'10', $g1, $g>, <'13', $sig_algs.1>, '40', 
                                                $g, $g^~x.1>, 
                                               '2', '0x0303', p_ns, $cipher_suite, <'13', $sig_algs.2>, '40', 
                                               $g, p_gy>, 
                                              '8', $exts>, 
                                             '13', '0', $certificate_extensions>, 
                                            '11', '0', pk(~ltkS)>, 
                                           '15', 
                                           sign(<'server_cv', 
                                                 h(<
                                                    <
                                                     <
                                                      <
                                                       <
                                                        <
                                                         <'0', '1', '0x0303', ~tid, '0', $cipher_suites, '0', 
                                                          <'43', '0x0304'>, <'10', $g1, $g>, 
                                                          <'13', $sig_algs>, '40', $g1, $g1^~x>, 
                                                         '6', '0x0303', '40', $g>, 
                                                        '1', '0x0303', ~tid, '0', $cipher_suites.1, '0', 
                                                        <'43', '0x0304'>, <'10', $g1, $g>, 
                                                        <'13', $sig_algs.1>, '40', $g, $g^~x.1>, 
                                                       '2', '0x0303', p_ns, $cipher_suite, 
                                                       <'13', $sig_algs.2>, '40', $g, p_gy>, 
                                                      '8', $exts>, 
                                                     '13', '0', $certificate_extensions>, 
                                                    '11', '0', pk(~ltkS)>)
                                                >,
                                                ~ltkS)
                                          >, 
                                          '20', 
                                          hmac(<
                                                Expand(Expand(Extract(p_gxy, Extract('0', '0')),
                                                              <'serverhts', 
                                                               h(<
                                                                  <
                                                                   <
                                                                    <
                                                                     <
                                                                      <
                                                                       <
                                                                        <'0', '1', '0x0303', ~tid, '0', 
                                                                         $cipher_suites, '0', 
                                                                         <'43', '0x0304'>, <'10', $g1, $g>, 
                                                                         <'13', $sig_algs>, '40', $g1, $g1^~x
                                                                        >, 
                                                                        '6', '0x0303', '40', $g>, 
                                                                       '1', '0x0303', ~tid, '0', 
                                                                       $cipher_suites.1, '0', 
                                                                       <'43', '0x0304'>, <'10', $g1, $g>, 
                                                                       <'13', $sig_algs.1>, '40', $g, $g^~x.1
                                                                      >, 
                                                                      '2', '0x0303', p_ns, $cipher_suite, 
                                                                      <'13', $sig_algs.2>, '40', $g, p_gy>, 
                                                                     '8', $exts>, 
                                                                    '13', '0', $certificate_extensions>, 
                                                                   '11', '0', pk(~ltkS)>, 
                                                                  '15', 
                                                                  sign(<'server_cv', 
                                                                        h(<
                                                                           <
                                                                            <
                                                                             <
                                                                              <
                                                                               <
                                                                                <'0', '1', '0x0303', ~tid, 
                                                                                 '0', $cipher_suites, '0', 
                                                                                 <'43', '0x0304'>, 
                                                                                 <'10', $g1, $g>, 
                                                                                 <'13', $sig_algs>, '40', 
                                                                                 $g1, $g1^~x>, 
                                                                                '6', '0x0303', '40', $g>, 
                                                                               '1', '0x0303', ~tid, '0', 
                                                                               $cipher_suites.1, '0', 
                                                                               <'43', '0x0304'>, 
                                                                               <'10', $g1, $g>, 
                                                                               <'13', $sig_algs.1>, '40', $g, 
                                                                               $g^~x.1>, 
                                                                              '2', '0x0303', p_ns, 
                                                                              $cipher_suite, 
                                                                              <'13', $sig_algs.2>, '40', $g, 
                                                                              p_gy>, 
                                                                             '8', $exts>, 
                                                                            '13', '0', $certificate_extensions
                                                                           >, 
                                                                           '11', '0', pk(~ltkS)>)
                                                                       >,
                                                                       ~ltkS)
                                                                 >)
                                                              >,
                                                              '32'),
                                                       <'fin', '0'>, '32'), 
                                                h(<
                                                   <
                                                    <
                                                     <
                                                      <
                                                       <
                                                        <
                                                         <'0', '1', '0x0303', ~tid, '0', $cipher_suites, '0', 
                                                          <'43', '0x0304'>, <'10', $g1, $g>, 
                                                          <'13', $sig_algs>, '40', $g1, $g1^~x>, 
                                                         '6', '0x0303', '40', $g>, 
                                                        '1', '0x0303', ~tid, '0', $cipher_suites.1, '0', 
                                                        <'43', '0x0304'>, <'10', $g1, $g>, 
                                                        <'13', $sig_algs.1>, '40', $g, $g^~x.1>, 
                                                       '2', '0x0303', p_ns, $cipher_suite, 
                                                       <'13', $sig_algs.2>, '40', $g, p_gy>, 
                                                      '8', $exts>, 
                                                     '13', '0', $certificate_extensions>, 
                                                    '11', '0', pk(~ltkS)>, 
                                                   '15', 
                                                   sign(<'server_cv', 
                                                         h(<
                                                            <
                                                             <
                                                              <
                                                               <
                                                                <
                                                                 <'0', '1', '0x0303', ~tid, '0', 
                                                                  $cipher_suites, '0', <'43', '0x0304'>, 
                                                                  <'10', $g1, $g>, <'13', $sig_algs>, '40', 
                                                                  $g1, $g1^~x>, 
                                                                 '6', '0x0303', '40', $g>, 
                                                                '1', '0x0303', ~tid, '0', $cipher_suites.1, 
                                                                '0', <'43', '0x0304'>, <'10', $g1, $g>, 
                                                                <'13', $sig_algs.1>, '40', $g, $g^~x.1>, 
                                                               '2', '0x0303', p_ns, $cipher_suite, 
                                                               <'13', $sig_algs.2>, '40', $g, p_gy>, 
                                                              '8', $exts>, 
                                                             '13', '0', $certificate_extensions>, 
                                                            '11', '0', pk(~ltkS)>)
                                                        >,
                                                        ~ltkS)
                                                  >)
                                               >)
                                         >)
                                      >,
                                      '32')
                    ) ▶₀ #l )
        qed
      qed
    next
      case recv_server_auth_case_03
      solve( (∃ #j.2.
               (!KU( Extract('0', Extract(p_gxy, Extract(~res_psk, '0'))) ) @ #j.2)
              ∧
               #j.2 < #j.1)  ∥
             ((∀ #k.
                (!KU( Extract('0', Extract(p_gxy, Extract(~res_psk, '0'))) ) @ #k)
               ⇒
                ¬(#k < #j.1)) ∧
              (∃ actor #l.
                (RevealPSK( actor,
                            Expand(Extract('0', Extract(p_gxy, Extract(~res_psk, '0'))),
                                   <'serverats', 
                                    h(<
                                       <
                                        <
                                         <
                                          <
                                           <
                                            <
                                             <
                                              <'0', '1', '0x0303', ~tid, '0', $cipher_suites, '0', 
                                               <'43', '0x0304'>, <'10', $g1, $g>, <'40', $g1, $g1^~x>, 
                                               <'45', '0', '1'>, <'42', '0'>, '41', 
                                               <~ticket, mask(~ticket_age_add, $ticket_age)>, 
                                               hmac(<
                                                     Expand(Expand(Extract(~res_psk, '0'), <'ext', 'pbk'>,
                                                                   '32'),
                                                            <'0', '0'>, '32'), 
                                                     h(<'0', '1', '0x0303', ~tid, '0', $cipher_suites, '0', 
                                                        <'43', '0x0304'>, <'10', $g1, $g>, 
                                                        <'40', $g1, $g1^~x>, <'45', '0', '1'>, <'42', '0'>, 
                                                        '41', <~ticket, mask(~ticket_age_add, $ticket_age)>, 
                                                        '0'>)
                                                    >)
                                              >, 
                                              '6', '0x0303', '40', $g>, 
                                             '1', '0x0303', ~tid, '0', $cipher_suites.1, '0', 
                                             <'43', '0x0304'>, <'10', $g1, $g>, <'13', $sig_algs>, '40', $g, 
                                             $g^~x.1>, 
                                            '2', '0x0303', p_ns, $cipher_suite, <'13', $sig_algs.1>, '40', 
                                            $g, p_gy>, 
                                           '8', $exts>, 
                                          '13', '0', $certificate_extensions>, 
                                         '11', '0', pk(~ltkS)>, 
                                        '15', 
                                        sign(<'server_cv', 
                                              h(<
                                                 <
                                                  <
                                                   <
                                                    <
                                                     <
                                                      <'0', '1', '0x0303', ~tid, '0', $cipher_suites, '0', 
                                                       <'43', '0x0304'>, <'10', $g1, $g>, 
                                                       <'40', $g1, $g1^~x>, <'45', '0', '1'>, <'42', '0'>, 
                                                       '41', <~ticket, mask(~ticket_age_add, $ticket_age)>, 
                                                       hmac(<
                                                             Expand(Expand(Extract(~res_psk, '0'),
                                                                           <'ext', 'pbk'>, '32'),
                                                                    <'0', '0'>, '32'), 
                                                             h(<'0', '1', '0x0303', ~tid, '0', 
                                                                $cipher_suites, '0', <'43', '0x0304'>, 
                                                                <'10', $g1, $g>, <'40', $g1, $g1^~x>, 
                                                                <'45', '0', '1'>, <'42', '0'>, '41', 
                                                                <~ticket, mask(~ticket_age_add, $ticket_age)
                                                                >, 
                                                                '0'>)
                                                            >)
                                                      >, 
                                                      '6', '0x0303', '40', $g>, 
                                                     '1', '0x0303', ~tid, '0', $cipher_suites.1, '0', 
                                                     <'43', '0x0304'>, <'10', $g1, $g>, <'13', $sig_algs>, 
                                                     '40', $g, $g^~x.1>, 
                                                    '2', '0x0303', p_ns, $cipher_suite, <'13', $sig_algs.1>, 
                                                    '40', $g, p_gy>, 
                                                   '8', $exts>, 
                                                  '13', '0', $certificate_extensions>, 
                                                 '11', '0', pk(~ltkS)>)
                                             >,
                                             ~ltkS)
                                       >, 
                                       '20', 
                                       hmac(<
                                             Expand(Expand(Extract(p_gxy, Extract(~res_psk, '0')),
                                                           <'serverhts', 
                                                            h(<
                                                               <
                                                                <
                                                                 <
                                                                  <
                                                                   <
                                                                    <
                                                                     <'0', '1', '0x0303', ~tid, '0', 
                                                                      $cipher_suites, '0', <'43', '0x0304'>, 
                                                                      <'10', $g1, $g>, <'40', $g1, $g1^~x>, 
                                                                      <'45', '0', '1'>, <'42', '0'>, '41', 
                                                                      <~ticket, 
                                                                       mask(~ticket_age_add, $ticket_age)>, 
                                                                      hmac(<
                                                                            Expand(Expand(Extract(~res_psk,
                                                                                                  '0'),
                                                                                          <'ext', 'pbk'>,
                                                                                          '32'),
                                                                                   <'0', '0'>, '32'), 
                                                                            h(<'0', '1', '0x0303', ~tid, '0', 
                                                                               $cipher_suites, '0', 
                                                                               <'43', '0x0304'>, 
                                                                               <'10', $g1, $g>, 
                                                                               <'40', $g1, $g1^~x>, 
                                                                               <'45', '0', '1'>, <'42', '0'>, 
                                                                               '41', 
                                                                               <~ticket, 
                                                                                mask(~ticket_age_add,
                                                                                     $ticket_age)
                                                                               >, 
                                                                               '0'>)
                                                                           >)
                                                                     >, 
                                                                     '6', '0x0303', '40', $g>, 
                                                                    '1', '0x0303', ~tid, '0', 
                                                                    $cipher_suites.1, '0', <'43', '0x0304'>, 
                                                                    <'10', $g1, $g>, <'13', $sig_algs>, '40', 
                                                                    $g, $g^~x.1>, 
                                                                   '2', '0x0303', p_ns, $cipher_suite, 
                                                                   <'13', $sig_algs.1>, '40', $g, p_gy>, 
                                                                  '8', $exts>, 
                                                                 '13', '0', $certificate_extensions>, 
                                                                '11', '0', pk(~ltkS)>, 
                                                               '15', 
                                                               sign(<'server_cv', 
                                                                     h(<
                                                                        <
                                                                         <
                                                                          <
                                                                           <
                                                                            <
                                                                             <'0', '1', '0x0303', ~tid, '0', 
                                                                              $cipher_suites, '0', 
                                                                              <'43', '0x0304'>, 
                                                                              <'10', $g1, $g>, 
                                                                              <'40', $g1, $g1^~x>, 
                                                                              <'45', '0', '1'>, <'42', '0'>, 
                                                                              '41', 
                                                                              <~ticket, 
                                                                               mask(~ticket_age_add,
                                                                                    $ticket_age)
                                                                              >, 
                                                                              hmac(<
                                                                                    Expand(Expand(Extract(~res_psk,
                                                                                                          '0'),
                                                                                                  <'ext', 
                                                                                                   'pbk'>,
                                                                                                  '32'),
                                                                                           <'0', '0'>, '32'), 
                                                                                    h(<'0', '1', '0x0303', 
                                                                                       ~tid, '0', 
                                                                                       $cipher_suites, '0', 
                                                                                       <'43', '0x0304'>, 
                                                                                       <'10', $g1, $g>, 
                                                                                       <'40', $g1, $g1^~x>, 
                                                                                       <'45', '0', '1'>, 
                                                                                       <'42', '0'>, '41', 
                                                                                       <~ticket, 
                                                                                        mask(~ticket_age_add,
                                                                                             $ticket_age)
                                                                                       >, 
                                                                                       '0'>)
                                                                                   >)
                                                                             >, 
                                                                             '6', '0x0303', '40', $g>, 
                                                                            '1', '0x0303', ~tid, '0', 
                                                                            $cipher_suites.1, '0', 
                                                                            <'43', '0x0304'>, 
                                                                            <'10', $g1, $g>, 
                                                                            <'13', $sig_algs>, '40', $g, 
                                                                            $g^~x.1>, 
                                                                           '2', '0x0303', p_ns, 
                                                                           $cipher_suite, 
                                                                           <'13', $sig_algs.1>, '40', $g, p_gy
                                                                          >, 
                                                                          '8', $exts>, 
                                                                         '13', '0', $certificate_extensions>, 
                                                                        '11', '0', pk(~ltkS)>)
                                                                    >,
                                                                    ~ltkS)
                                                              >)
                                                           >,
                                                           '32'),
                                                    <'fin', '0'>, '32'), 
                                             h(<
                                                <
                                                 <
                                                  <
                                                   <
                                                    <
                                                     <
                                                      <'0', '1', '0x0303', ~tid, '0', $cipher_suites, '0', 
                                                       <'43', '0x0304'>, <'10', $g1, $g>, 
                                                       <'40', $g1, $g1^~x>, <'45', '0', '1'>, <'42', '0'>, 
                                                       '41', <~ticket, mask(~ticket_age_add, $ticket_age)>, 
                                                       hmac(<
                                                             Expand(Expand(Extract(~res_psk, '0'),
                                                                           <'ext', 'pbk'>, '32'),
                                                                    <'0', '0'>, '32'), 
                                                             h(<'0', '1', '0x0303', ~tid, '0', 
                                                                $cipher_suites, '0', <'43', '0x0304'>, 
                                                                <'10', $g1, $g>, <'40', $g1, $g1^~x>, 
                                                                <'45', '0', '1'>, <'42', '0'>, '41', 
                                                                <~ticket, mask(~ticket_age_add, $ticket_age)
                                                                >, 
                                                                '0'>)
                                                            >)
                                                      >, 
                                                      '6', '0x0303', '40', $g>, 
                                                     '1', '0x0303', ~tid, '0', $cipher_suites.1, '0', 
                                                     <'43', '0x0304'>, <'10', $g1, $g>, <'13', $sig_algs>, 
                                                     '40', $g, $g^~x.1>, 
                                                    '2', '0x0303', p_ns, $cipher_suite, <'13', $sig_algs.1>, 
                                                    '40', $g, p_gy>, 
                                                   '8', $exts>, 
                                                  '13', '0', $certificate_extensions>, 
                                                 '11', '0', pk(~ltkS)>, 
                                                '15', 
                                                sign(<'server_cv', 
                                                      h(<
                                                         <
                                                          <
                                                           <
                                                            <
                                                             <
                                                              <'0', '1', '0x0303', ~tid, '0', $cipher_suites, 
                                                               '0', <'43', '0x0304'>, <'10', $g1, $g>, 
                                                               <'40', $g1, $g1^~x>, <'45', '0', '1'>, 
                                                               <'42', '0'>, '41', 
                                                               <~ticket, mask(~ticket_age_add, $ticket_age)>, 
                                                               hmac(<
                                                                     Expand(Expand(Extract(~res_psk, '0'),
                                                                                   <'ext', 'pbk'>, '32'),
                                                                            <'0', '0'>, '32'), 
                                                                     h(<'0', '1', '0x0303', ~tid, '0', 
                                                                        $cipher_suites, '0', 
                                                                        <'43', '0x0304'>, <'10', $g1, $g>, 
                                                                        <'40', $g1, $g1^~x>, 
                                                                        <'45', '0', '1'>, <'42', '0'>, '41', 
                                                                        <~ticket, 
                                                                         mask(~ticket_age_add, $ticket_age)>, 
                                                                        '0'>)
                                                                    >)
                                                              >, 
                                                              '6', '0x0303', '40', $g>, 
                                                             '1', '0x0303', ~tid, '0', $cipher_suites.1, '0', 
                                                             <'43', '0x0304'>, <'10', $g1, $g>, 
                                                             <'13', $sig_algs>, '40', $g, $g^~x.1>, 
                                                            '2', '0x0303', p_ns, $cipher_suite, 
                                                            <'13', $sig_algs.1>, '40', $g, p_gy>, 
                                                           '8', $exts>, 
                                                          '13', '0', $certificate_extensions>, 
                                                         '11', '0', pk(~ltkS)>)
                                                     >,
                                                     ~ltkS)
                                               >)
                                            >)
                                      >)
                                   >,
                                   '32')
                 ) @ #l)
               ∧
                #l < #j.1)) )
        case case_1
        solve( (∃ #r. (RevLtk( $S ) @ #r) ∧ #r < #vr)  ∥
               (∃ tid3 x #r. (RevDHExp( tid3, $S, x ) @ #r) ∧ #r < #vr)  ∥
               (∃ tid4 y #r. (RevDHExp( tid4, $C, y ) @ #r) ∧ #r < #vr)  ∥
               (∃ rms #r. (RevealPSK( $C, rms ) @ #r) ∧ #r < #k.1)  ∥
               (∃ rms #r. (RevealPSK( $S, rms ) @ #r) ∧ #r < #k.1) )
          case case_1
          by contradiction /* from formulas */
        next
          case case_2
          by contradiction /* from formulas */
        next
          case case_3
          by contradiction /* from formulas */
        next
          case case_4
          by contradiction /* from formulas */
        next
          case case_5
          by contradiction /* from formulas */
        qed
      next
        case case_2
        solve( !Ltk( $C, ~ltkC ) ▶₂ #i )
          case Register_pk
          by solve( SecretPSK( $A,
                               Expand(Extract('0', Extract(p_gxy, Extract(~res_psk, '0'))),
                                      <'serverats', 
                                       h(<
                                          <
                                           <
                                            <
                                             <
                                              <
                                               <
                                                <
                                                 <'0', '1', '0x0303', ~tid, '0', $cipher_suites, '0', 
                                                  <'43', '0x0304'>, <'10', $g1, $g>, <'40', $g1, $g1^~x>, 
                                                  <'45', '0', '1'>, <'42', '0'>, '41', 
                                                  <~ticket, mask(~ticket_age_add, $ticket_age)>, 
                                                  hmac(<
                                                        Expand(Expand(Extract(~res_psk, '0'), <'ext', 'pbk'>,
                                                                      '32'),
                                                               <'0', '0'>, '32'), 
                                                        h(<'0', '1', '0x0303', ~tid, '0', $cipher_suites, 
                                                           '0', <'43', '0x0304'>, <'10', $g1, $g>, 
                                                           <'40', $g1, $g1^~x>, <'45', '0', '1'>, 
                                                           <'42', '0'>, '41', 
                                                           <~ticket, mask(~ticket_age_add, $ticket_age)>, '0'
                                                          >)
                                                       >)
                                                 >, 
                                                 '6', '0x0303', '40', $g>, 
                                                '1', '0x0303', ~tid, '0', $cipher_suites.1, '0', 
                                                <'43', '0x0304'>, <'10', $g1, $g>, <'13', $sig_algs>, '40', 
                                                $g, $g^~x.1>, 
                                               '2', '0x0303', p_ns, $cipher_suite, <'13', $sig_algs.1>, '40', 
                                               $g, p_gy>, 
                                              '8', $exts>, 
                                             '13', '0', $certificate_extensions>, 
                                            '11', '0', pk(~ltkS)>, 
                                           '15', 
                                           sign(<'server_cv', 
                                                 h(<
                                                    <
                                                     <
                                                      <
                                                       <
                                                        <
                                                         <'0', '1', '0x0303', ~tid, '0', $cipher_suites, '0', 
                                                          <'43', '0x0304'>, <'10', $g1, $g>, 
                                                          <'40', $g1, $g1^~x>, <'45', '0', '1'>, <'42', '0'>, 
                                                          '41', 
                                                          <~ticket, mask(~ticket_age_add, $ticket_age)>, 
                                                          hmac(<
                                                                Expand(Expand(Extract(~res_psk, '0'),
                                                                              <'ext', 'pbk'>, '32'),
                                                                       <'0', '0'>, '32'), 
                                                                h(<'0', '1', '0x0303', ~tid, '0', 
                                                                   $cipher_suites, '0', <'43', '0x0304'>, 
                                                                   <'10', $g1, $g>, <'40', $g1, $g1^~x>, 
                                                                   <'45', '0', '1'>, <'42', '0'>, '41', 
                                                                   <~ticket, 
                                                                    mask(~ticket_age_add, $ticket_age)>, 
                                                                   '0'>)
                                                               >)
                                                         >, 
                                                         '6', '0x0303', '40', $g>, 
                                                        '1', '0x0303', ~tid, '0', $cipher_suites.1, '0', 
                                                        <'43', '0x0304'>, <'10', $g1, $g>, <'13', $sig_algs>, 
                                                        '40', $g, $g^~x.1>, 
                                                       '2', '0x0303', p_ns, $cipher_suite, 
                                                       <'13', $sig_algs.1>, '40', $g, p_gy>, 
                                                      '8', $exts>, 
                                                     '13', '0', $certificate_extensions>, 
                                                    '11', '0', pk(~ltkS)>)
                                                >,
                                                ~ltkS)
                                          >, 
                                          '20', 
                                          hmac(<
                                                Expand(Expand(Extract(p_gxy, Extract(~res_psk, '0')),
                                                              <'serverhts', 
                                                               h(<
                                                                  <
                                                                   <
                                                                    <
                                                                     <
                                                                      <
                                                                       <
                                                                        <'0', '1', '0x0303', ~tid, '0', 
                                                                         $cipher_suites, '0', 
                                                                         <'43', '0x0304'>, <'10', $g1, $g>, 
                                                                         <'40', $g1, $g1^~x>, 
                                                                         <'45', '0', '1'>, <'42', '0'>, '41', 
                                                                         <~ticket, 
                                                                          mask(~ticket_age_add, $ticket_age)
                                                                         >, 
                                                                         hmac(<
                                                                               Expand(Expand(Extract(~res_psk,
                                                                                                     '0'),
                                                                                             <'ext', 'pbk'>,
                                                                                             '32'),
                                                                                      <'0', '0'>, '32'), 
                                                                               h(<'0', '1', '0x0303', ~tid, 
                                                                                  '0', $cipher_suites, '0', 
                                                                                  <'43', '0x0304'>, 
                                                                                  <'10', $g1, $g>, 
                                                                                  <'40', $g1, $g1^~x>, 
                                                                                  <'45', '0', '1'>, 
                                                                                  <'42', '0'>, '41', 
                                                                                  <~ticket, 
                                                                                   mask(~ticket_age_add,
                                                                                        $ticket_age)
                                                                                  >, 
                                                                                  '0'>)
                                                                              >)
                                                                        >, 
                                                                        '6', '0x0303', '40', $g>, 
                                                                       '1', '0x0303', ~tid, '0', 
                                                                       $cipher_suites.1, '0', 
                                                                       <'43', '0x0304'>, <'10', $g1, $g>, 
                                                                       <'13', $sig_algs>, '40', $g, $g^~x.1>, 
                                                                      '2', '0x0303', p_ns, $cipher_suite, 
                                                                      <'13', $sig_algs.1>, '40', $g, p_gy>, 
                                                                     '8', $exts>, 
                                                                    '13', '0', $certificate_extensions>, 
                                                                   '11', '0', pk(~ltkS)>, 
                                                                  '15', 
                                                                  sign(<'server_cv', 
                                                                        h(<
                                                                           <
                                                                            <
                                                                             <
                                                                              <
                                                                               <
                                                                                <'0', '1', '0x0303', ~tid, 
                                                                                 '0', $cipher_suites, '0', 
                                                                                 <'43', '0x0304'>, 
                                                                                 <'10', $g1, $g>, 
                                                                                 <'40', $g1, $g1^~x>, 
                                                                                 <'45', '0', '1'>, 
                                                                                 <'42', '0'>, '41', 
                                                                                 <~ticket, 
                                                                                  mask(~ticket_age_add,
                                                                                       $ticket_age)
                                                                                 >, 
                                                                                 hmac(<
                                                                                       Expand(Expand(Extract(~res_psk,
                                                                                                             '0'),
                                                                                                     <'ext', 
                                                                                                      'pbk'>,
                                                                                                     '32'),
                                                                                              <'0', '0'>,
                                                                                              '32'), 
                                                                                       h(<'0', '1', '0x0303', 
                                                                                          ~tid, '0', 
                                                                                          $cipher_suites, 
                                                                                          '0', 
                                                                                          <'43', '0x0304'>, 
                                                                                          <'10', $g1, $g>, 
                                                                                          <'40', $g1, $g1^~x
                                                                                          >, 
                                                                                          <'45', '0', '1'>, 
                                                                                          <'42', '0'>, '41', 
                                                                                          <~ticket, 
                                                                                           mask(~ticket_age_add,
                                                                                                $ticket_age)
                                                                                          >, 
                                                                                          '0'>)
                                                                                      >)
                                                                                >, 
                                                                                '6', '0x0303', '40', $g>, 
                                                                               '1', '0x0303', ~tid, '0', 
                                                                               $cipher_suites.1, '0', 
                                                                               <'43', '0x0304'>, 
                                                                               <'10', $g1, $g>, 
                                                                               <'13', $sig_algs>, '40', $g, 
                                                                               $g^~x.1>, 
                                                                              '2', '0x0303', p_ns, 
                                                                              $cipher_suite, 
                                                                              <'13', $sig_algs.1>, '40', $g, 
                                                                              p_gy>, 
                                                                             '8', $exts>, 
                                                                            '13', '0', $certificate_extensions
                                                                           >, 
                                                                           '11', '0', pk(~ltkS)>)
                                                                       >,
                                                                       ~ltkS)
                                                                 >)
                                                              >,
                                                              '32'),
                                                       <'fin', '0'>, '32'), 
                                                h(<
                                                   <
                                                    <
                                                     <
                                                      <
                                                       <
                                                        <
                                                         <'0', '1', '0x0303', ~tid, '0', $cipher_suites, '0', 
                                                          <'43', '0x0304'>, <'10', $g1, $g>, 
                                                          <'40', $g1, $g1^~x>, <'45', '0', '1'>, <'42', '0'>, 
                                                          '41', 
                                                          <~ticket, mask(~ticket_age_add, $ticket_age)>, 
                                                          hmac(<
                                                                Expand(Expand(Extract(~res_psk, '0'),
                                                                              <'ext', 'pbk'>, '32'),
                                                                       <'0', '0'>, '32'), 
                                                                h(<'0', '1', '0x0303', ~tid, '0', 
                                                                   $cipher_suites, '0', <'43', '0x0304'>, 
                                                                   <'10', $g1, $g>, <'40', $g1, $g1^~x>, 
                                                                   <'45', '0', '1'>, <'42', '0'>, '41', 
                                                                   <~ticket, 
                                                                    mask(~ticket_age_add, $ticket_age)>, 
                                                                   '0'>)
                                                               >)
                                                         >, 
                                                         '6', '0x0303', '40', $g>, 
                                                        '1', '0x0303', ~tid, '0', $cipher_suites.1, '0', 
                                                        <'43', '0x0304'>, <'10', $g1, $g>, <'13', $sig_algs>, 
                                                        '40', $g, $g^~x.1>, 
                                                       '2', '0x0303', p_ns, $cipher_suite, 
                                                       <'13', $sig_algs.1>, '40', $g, p_gy>, 
                                                      '8', $exts>, 
                                                     '13', '0', $certificate_extensions>, 
                                                    '11', '0', pk(~ltkS)>, 
                                                   '15', 
                                                   sign(<'server_cv', 
                                                         h(<
                                                            <
                                                             <
                                                              <
                                                               <
                                                                <
                                                                 <'0', '1', '0x0303', ~tid, '0', 
                                                                  $cipher_suites, '0', <'43', '0x0304'>, 
                                                                  <'10', $g1, $g>, <'40', $g1, $g1^~x>, 
                                                                  <'45', '0', '1'>, <'42', '0'>, '41', 
                                                                  <~ticket, mask(~ticket_age_add, $ticket_age)
                                                                  >, 
                                                                  hmac(<
                                                                        Expand(Expand(Extract(~res_psk, '0'),
                                                                                      <'ext', 'pbk'>, '32'),
                                                                               <'0', '0'>, '32'), 
                                                                        h(<'0', '1', '0x0303', ~tid, '0', 
                                                                           $cipher_suites, '0', 
                                                                           <'43', '0x0304'>, <'10', $g1, $g>, 
                                                                           <'40', $g1, $g1^~x>, 
                                                                           <'45', '0', '1'>, <'42', '0'>, 
                                                                           '41', 
                                                                           <~ticket, 
                                                                            mask(~ticket_age_add, $ticket_age)
                                                                           >, 
                                                                           '0'>)
                                                                       >)
                                                                 >, 
                                                                 '6', '0x0303', '40', $g>, 
                                                                '1', '0x0303', ~tid, '0', $cipher_suites.1, 
                                                                '0', <'43', '0x0304'>, <'10', $g1, $g>, 
                                                                <'13', $sig_algs>, '40', $g, $g^~x.1>, 
                                                               '2', '0x0303', p_ns, $cipher_suite, 
                                                               <'13', $sig_algs.1>, '40', $g, p_gy>, 
                                                              '8', $exts>, 
                                                             '13', '0', $certificate_extensions>, 
                                                            '11', '0', pk(~ltkS)>)
                                                        >,
                                                        ~ltkS)
                                                  >)
                                               >)
                                         >)
                                      >,
                                      '32')
                    ) ▶₀ #l )
        qed
      qed
    next
      case recv_server_auth_case_04
      solve( (∃ #j.2.
               (!KU( Extract('0',
                             Extract(p_gxy, Extract(Expand(ms, <'rms', h(messages)>, '32'), '0')))
                ) @ #j.2)
              ∧
               #j.2 < #j.1)  ∥
             ((∀ #k.
                (!KU( Extract('0',
                              Extract(p_gxy, Extract(Expand(ms, <'rms', h(messages)>, '32'), '0')))
                 ) @ #k)
               ⇒
                ¬(#k < #j.1)) ∧
              (∃ actor #l.
                (RevealPSK( actor,
                            Expand(Extract('0',
                                           Extract(p_gxy,
                                                   Extract(Expand(ms, <'rms', h(messages)>, '32'), '0'))),
                                   <'serverats', 
                                    h(<
                                       <
                                        <
                                         <
                                          <
                                           <
                                            <
                                             <
                                              <'0', '1', '0x0303', ~tid, '0', $cipher_suites, '0', 
                                               <'43', '0x0304'>, <'10', $g1, $g>, <'40', $g1, $g1^~x>, 
                                               <'45', '0', '1'>, <'42', '0'>, '41', 
                                               <p_psk_id, mask(ticket_age_add, $ticket_age)>, 
                                               hmac(<
                                                     Expand(Expand(Extract(Expand(ms, <'rms', h(messages)>,
                                                                                  '32'),
                                                                           '0'),
                                                                   <'res', 'pbk'>, '32'),
                                                            <'0', '0'>, '32'), 
                                                     h(<'0', '1', '0x0303', ~tid, '0', $cipher_suites, '0', 
                                                        <'43', '0x0304'>, <'10', $g1, $g>, 
                                                        <'40', $g1, $g1^~x>, <'45', '0', '1'>, <'42', '0'>, 
                                                        '41', <p_psk_id, mask(ticket_age_add, $ticket_age)>, 
                                                        '0'>)
                                                    >)
                                              >, 
                                              '6', '0x0303', '40', $g>, 
                                             '1', '0x0303', ~tid, '0', $cipher_suites.1, '0', 
                                             <'43', '0x0304'>, <'10', $g1, $g>, <'13', $sig_algs>, '40', $g, 
                                             $g^~x.1>, 
                                            '2', '0x0303', p_ns, $cipher_suite, <'13', $sig_algs.1>, '40', 
                                            $g, p_gy>, 
                                           '8', $exts>, 
                                          '13', '0', $certificate_extensions>, 
                                         '11', '0', pk(~ltkS)>, 
                                        '15', 
                                        sign(<'server_cv', 
                                              h(<
                                                 <
                                                  <
                                                   <
                                                    <
                                                     <
                                                      <'0', '1', '0x0303', ~tid, '0', $cipher_suites, '0', 
                                                       <'43', '0x0304'>, <'10', $g1, $g>, 
                                                       <'40', $g1, $g1^~x>, <'45', '0', '1'>, <'42', '0'>, 
                                                       '41', <p_psk_id, mask(ticket_age_add, $ticket_age)>, 
                                                       hmac(<
                                                             Expand(Expand(Extract(Expand(ms,
                                                                                          <'rms', h(messages)
                                                                                          >,
                                                                                          '32'),
                                                                                   '0'),
                                                                           <'res', 'pbk'>, '32'),
                                                                    <'0', '0'>, '32'), 
                                                             h(<'0', '1', '0x0303', ~tid, '0', 
                                                                $cipher_suites, '0', <'43', '0x0304'>, 
                                                                <'10', $g1, $g>, <'40', $g1, $g1^~x>, 
                                                                <'45', '0', '1'>, <'42', '0'>, '41', 
                                                                <p_psk_id, mask(ticket_age_add, $ticket_age)
                                                                >, 
                                                                '0'>)
                                                            >)
                                                      >, 
                                                      '6', '0x0303', '40', $g>, 
                                                     '1', '0x0303', ~tid, '0', $cipher_suites.1, '0', 
                                                     <'43', '0x0304'>, <'10', $g1, $g>, <'13', $sig_algs>, 
                                                     '40', $g, $g^~x.1>, 
                                                    '2', '0x0303', p_ns, $cipher_suite, <'13', $sig_algs.1>, 
                                                    '40', $g, p_gy>, 
                                                   '8', $exts>, 
                                                  '13', '0', $certificate_extensions>, 
                                                 '11', '0', pk(~ltkS)>)
                                             >,
                                             ~ltkS)
                                       >, 
                                       '20', 
                                       hmac(<
                                             Expand(Expand(Extract(p_gxy,
                                                                   Extract(Expand(ms, <'rms', h(messages)>,
                                                                                  '32'),
                                                                           '0')),
                                                           <'serverhts', 
                                                            h(<
                                                               <
                                                                <
                                                                 <
                                                                  <
                                                                   <
                                                                    <
                                                                     <'0', '1', '0x0303', ~tid, '0', 
                                                                      $cipher_suites, '0', <'43', '0x0304'>, 
                                                                      <'10', $g1, $g>, <'40', $g1, $g1^~x>, 
                                                                      <'45', '0', '1'>, <'42', '0'>, '41', 
                                                                      <p_psk_id, 
                                                                       mask(ticket_age_add, $ticket_age)>, 
                                                                      hmac(<
                                                                            Expand(Expand(Extract(Expand(ms,
                                                                                                         <
                                                                                                          'rms', 
                                                                                                          h(messages)
                                                                                                         >,
                                                                                                         '32'),
                                                                                                  '0'),
                                                                                          <'res', 'pbk'>,
                                                                                          '32'),
                                                                                   <'0', '0'>, '32'), 
                                                                            h(<'0', '1', '0x0303', ~tid, '0', 
                                                                               $cipher_suites, '0', 
                                                                               <'43', '0x0304'>, 
                                                                               <'10', $g1, $g>, 
                                                                               <'40', $g1, $g1^~x>, 
                                                                               <'45', '0', '1'>, <'42', '0'>, 
                                                                               '41', 
                                                                               <p_psk_id, 
                                                                                mask(ticket_age_add,
                                                                                     $ticket_age)
                                                                               >, 
                                                                               '0'>)
                                                                           >)
                                                                     >, 
                                                                     '6', '0x0303', '40', $g>, 
                                                                    '1', '0x0303', ~tid, '0', 
                                                                    $cipher_suites.1, '0', <'43', '0x0304'>, 
                                                                    <'10', $g1, $g>, <'13', $sig_algs>, '40', 
                                                                    $g, $g^~x.1>, 
                                                                   '2', '0x0303', p_ns, $cipher_suite, 
                                                                   <'13', $sig_algs.1>, '40', $g, p_gy>, 
                                                                  '8', $exts>, 
                                                                 '13', '0', $certificate_extensions>, 
                                                                '11', '0', pk(~ltkS)>, 
                                                               '15', 
                                                               sign(<'server_cv', 
                                                                     h(<
                                                                        <
                                                                         <
                                                                          <
                                                                           <
                                                                            <
                                                                             <'0', '1', '0x0303', ~tid, '0', 
                                                                              $cipher_suites, '0', 
                                                                              <'43', '0x0304'>, 
                                                                              <'10', $g1, $g>, 
                                                                              <'40', $g1, $g1^~x>, 
                                                                              <'45', '0', '1'>, <'42', '0'>, 
                                                                              '41', 
                                                                              <p_psk_id, 
                                                                               mask(ticket_age_add,
                                                                                    $ticket_age)
                                                                              >, 
                                                                              hmac(<
                                                                                    Expand(Expand(Extract(Expand(ms,
                                                                                                                 <
                                                                                                                  'rms', 
                                                                                                                  h(messages)
                                                                                                                 >,
                                                                                                                 '32'),
                                                                                                          '0'),
                                                                                                  <'res', 
                                                                                                   'pbk'>,
                                                                                                  '32'),
                                                                                           <'0', '0'>, '32'), 
                                                                                    h(<'0', '1', '0x0303', 
                                                                                       ~tid, '0', 
                                                                                       $cipher_suites, '0', 
                                                                                       <'43', '0x0304'>, 
                                                                                       <'10', $g1, $g>, 
                                                                                       <'40', $g1, $g1^~x>, 
                                                                                       <'45', '0', '1'>, 
                                                                                       <'42', '0'>, '41', 
                                                                                       <p_psk_id, 
                                                                                        mask(ticket_age_add,
                                                                                             $ticket_age)
                                                                                       >, 
                                                                                       '0'>)
                                                                                   >)
                                                                             >, 
                                                                             '6', '0x0303', '40', $g>, 
                                                                            '1', '0x0303', ~tid, '0', 
                                                                            $cipher_suites.1, '0', 
                                                                            <'43', '0x0304'>, 
                                                                            <'10', $g1, $g>, 
                                                                            <'13', $sig_algs>, '40', $g, 
                                                                            $g^~x.1>, 
                                                                           '2', '0x0303', p_ns, 
                                                                           $cipher_suite, 
                                                                           <'13', $sig_algs.1>, '40', $g, p_gy
                                                                          >, 
                                                                          '8', $exts>, 
                                                                         '13', '0', $certificate_extensions>, 
                                                                        '11', '0', pk(~ltkS)>)
                                                                    >,
                                                                    ~ltkS)
                                                              >)
                                                           >,
                                                           '32'),
                                                    <'fin', '0'>, '32'), 
                                             h(<
                                                <
                                                 <
                                                  <
                                                   <
                                                    <
                                                     <
                                                      <'0', '1', '0x0303', ~tid, '0', $cipher_suites, '0', 
                                                       <'43', '0x0304'>, <'10', $g1, $g>, 
                                                       <'40', $g1, $g1^~x>, <'45', '0', '1'>, <'42', '0'>, 
                                                       '41', <p_psk_id, mask(ticket_age_add, $ticket_age)>, 
                                                       hmac(<
                                                             Expand(Expand(Extract(Expand(ms,
                                                                                          <'rms', h(messages)
                                                                                          >,
                                                                                          '32'),
                                                                                   '0'),
                                                                           <'res', 'pbk'>, '32'),
                                                                    <'0', '0'>, '32'), 
                                                             h(<'0', '1', '0x0303', ~tid, '0', 
                                                                $cipher_suites, '0', <'43', '0x0304'>, 
                                                                <'10', $g1, $g>, <'40', $g1, $g1^~x>, 
                                                                <'45', '0', '1'>, <'42', '0'>, '41', 
                                                                <p_psk_id, mask(ticket_age_add, $ticket_age)
                                                                >, 
                                                                '0'>)
                                                            >)
                                                      >, 
                                                      '6', '0x0303', '40', $g>, 
                                                     '1', '0x0303', ~tid, '0', $cipher_suites.1, '0', 
                                                     <'43', '0x0304'>, <'10', $g1, $g>, <'13', $sig_algs>, 
                                                     '40', $g, $g^~x.1>, 
                                                    '2', '0x0303', p_ns, $cipher_suite, <'13', $sig_algs.1>, 
                                                    '40', $g, p_gy>, 
                                                   '8', $exts>, 
                                                  '13', '0', $certificate_extensions>, 
                                                 '11', '0', pk(~ltkS)>, 
                                                '15', 
                                                sign(<'server_cv', 
                                                      h(<
                                                         <
                                                          <
                                                           <
                                                            <
                                                             <
                                                              <'0', '1', '0x0303', ~tid, '0', $cipher_suites, 
                                                               '0', <'43', '0x0304'>, <'10', $g1, $g>, 
                                                               <'40', $g1, $g1^~x>, <'45', '0', '1'>, 
                                                               <'42', '0'>, '41', 
                                                               <p_psk_id, mask(ticket_age_add, $ticket_age)>, 
                                                               hmac(<
                                                                     Expand(Expand(Extract(Expand(ms,
                                                                                                  <'rms', 
                                                                                                   h(messages)
                                                                                                  >,
                                                                                                  '32'),
                                                                                           '0'),
                                                                                   <'res', 'pbk'>, '32'),
                                                                            <'0', '0'>, '32'), 
                                                                     h(<'0', '1', '0x0303', ~tid, '0', 
                                                                        $cipher_suites, '0', 
                                                                        <'43', '0x0304'>, <'10', $g1, $g>, 
                                                                        <'40', $g1, $g1^~x>, 
                                                                        <'45', '0', '1'>, <'42', '0'>, '41', 
                                                                        <p_psk_id, 
                                                                         mask(ticket_age_add, $ticket_age)>, 
                                                                        '0'>)
                                                                    >)
                                                              >, 
                                                              '6', '0x0303', '40', $g>, 
                                                             '1', '0x0303', ~tid, '0', $cipher_suites.1, '0', 
                                                             <'43', '0x0304'>, <'10', $g1, $g>, 
                                                             <'13', $sig_algs>, '40', $g, $g^~x.1>, 
                                                            '2', '0x0303', p_ns, $cipher_suite, 
                                                            <'13', $sig_algs.1>, '40', $g, p_gy>, 
                                                           '8', $exts>, 
                                                          '13', '0', $certificate_extensions>, 
                                                         '11', '0', pk(~ltkS)>)
                                                     >,
                                                     ~ltkS)
                                               >)
                                            >)
                                      >)
                                   >,
                                   '32')
                 ) @ #l)
               ∧
                #l < #j.1)) )
        case case_1
        solve( (∃ #r. (RevLtk( $S ) @ #r) ∧ #r < #vr)  ∥
               (∃ tid3 x #r. (RevDHExp( tid3, $S, x ) @ #r) ∧ #r < #vr)  ∥
               (∃ tid4 y #r. (RevDHExp( tid4, $C, y ) @ #r) ∧ #r < #vr)  ∥
               (∃ rms #r. (RevealPSK( $C, rms ) @ #r) ∧ #r < #k.1)  ∥
               (∃ rms #r. (RevealPSK( $S, rms ) @ #r) ∧ #r < #k.1) )
          case case_1
          by contradiction /* from formulas */
        next
          case case_2
          by contradiction /* from formulas */
        next
          case case_3
          by contradiction /* from formulas */
        next
          case case_4
          by contradiction /* from formulas */
        next
          case case_5
          by contradiction /* from formulas */
        qed
      next
        case case_2
        solve( !Ltk( $C, ~ltkC ) ▶₂ #i )
          case Register_pk
          by solve( SecretPSK( $A,
                               Expand(Extract('0',
                                              Extract(p_gxy,
                                                      Extract(Expand(ms, <'rms', h(messages)>, '32'), '0'))),
                                      <'serverats', 
                                       h(<
                                          <
                                           <
                                            <
                                             <
                                              <
                                               <
                                                <
                                                 <'0', '1', '0x0303', ~tid, '0', $cipher_suites, '0', 
                                                  <'43', '0x0304'>, <'10', $g1, $g>, <'40', $g1, $g1^~x>, 
                                                  <'45', '0', '1'>, <'42', '0'>, '41', 
                                                  <p_psk_id, mask(ticket_age_add, $ticket_age)>, 
                                                  hmac(<
                                                        Expand(Expand(Extract(Expand(ms, <'rms', h(messages)>,
                                                                                     '32'),
                                                                              '0'),
                                                                      <'res', 'pbk'>, '32'),
                                                               <'0', '0'>, '32'), 
                                                        h(<'0', '1', '0x0303', ~tid, '0', $cipher_suites, 
                                                           '0', <'43', '0x0304'>, <'10', $g1, $g>, 
                                                           <'40', $g1, $g1^~x>, <'45', '0', '1'>, 
                                                           <'42', '0'>, '41', 
                                                           <p_psk_id, mask(ticket_age_add, $ticket_age)>, '0'
                                                          >)
                                                       >)
                                                 >, 
                                                 '6', '0x0303', '40', $g>, 
                                                '1', '0x0303', ~tid, '0', $cipher_suites.1, '0', 
                                                <'43', '0x0304'>, <'10', $g1, $g>, <'13', $sig_algs>, '40', 
                                                $g, $g^~x.1>, 
                                               '2', '0x0303', p_ns, $cipher_suite, <'13', $sig_algs.1>, '40', 
                                               $g, p_gy>, 
                                              '8', $exts>, 
                                             '13', '0', $certificate_extensions>, 
                                            '11', '0', pk(~ltkS)>, 
                                           '15', 
                                           sign(<'server_cv', 
                                                 h(<
                                                    <
                                                     <
                                                      <
                                                       <
                                                        <
                                                         <'0', '1', '0x0303', ~tid, '0', $cipher_suites, '0', 
                                                          <'43', '0x0304'>, <'10', $g1, $g>, 
                                                          <'40', $g1, $g1^~x>, <'45', '0', '1'>, <'42', '0'>, 
                                                          '41', 
                                                          <p_psk_id, mask(ticket_age_add, $ticket_age)>, 
                                                          hmac(<
                                                                Expand(Expand(Extract(Expand(ms,
                                                                                             <'rms', 
                                                                                              h(messages)>,
                                                                                             '32'),
                                                                                      '0'),
                                                                              <'res', 'pbk'>, '32'),
                                                                       <'0', '0'>, '32'), 
                                                                h(<'0', '1', '0x0303', ~tid, '0', 
                                                                   $cipher_suites, '0', <'43', '0x0304'>, 
                                                                   <'10', $g1, $g>, <'40', $g1, $g1^~x>, 
                                                                   <'45', '0', '1'>, <'42', '0'>, '41', 
                                                                   <p_psk_id, 
                                                                    mask(ticket_age_add, $ticket_age)>, 
                                                                   '0'>)
                                                               >)
                                                         >, 
                                                         '6', '0x0303', '40', $g>, 
                                                        '1', '0x0303', ~tid, '0', $cipher_suites.1, '0', 
                                                        <'43', '0x0304'>, <'10', $g1, $g>, <'13', $sig_algs>, 
                                                        '40', $g, $g^~x.1>, 
                                                       '2', '0x0303', p_ns, $cipher_suite, 
                                                       <'13', $sig_algs.1>, '40', $g, p_gy>, 
                                                      '8', $exts>, 
                                                     '13', '0', $certificate_extensions>, 
                                                    '11', '0', pk(~ltkS)>)
                                                >,
                                                ~ltkS)
                                          >, 
                                          '20', 
                                          hmac(<
                                                Expand(Expand(Extract(p_gxy,
                                                                      Extract(Expand(ms, <'rms', h(messages)>,
                                                                                     '32'),
                                                                              '0')),
                                                              <'serverhts', 
                                                               h(<
                                                                  <
                                                                   <
                                                                    <
                                                                     <
                                                                      <
                                                                       <
                                                                        <'0', '1', '0x0303', ~tid, '0', 
                                                                         $cipher_suites, '0', 
                                                                         <'43', '0x0304'>, <'10', $g1, $g>, 
                                                                         <'40', $g1, $g1^~x>, 
                                                                         <'45', '0', '1'>, <'42', '0'>, '41', 
                                                                         <p_psk_id, 
                                                                          mask(ticket_age_add, $ticket_age)>, 
                                                                         hmac(<
                                                                               Expand(Expand(Extract(Expand(ms,
                                                                                                            <
                                                                                                             'rms', 
                                                                                                             h(messages)
                                                                                                            >,
                                                                                                            '32'),
                                                                                                     '0'),
                                                                                             <'res', 'pbk'>,
                                                                                             '32'),
                                                                                      <'0', '0'>, '32'), 
                                                                               h(<'0', '1', '0x0303', ~tid, 
                                                                                  '0', $cipher_suites, '0', 
                                                                                  <'43', '0x0304'>, 
                                                                                  <'10', $g1, $g>, 
                                                                                  <'40', $g1, $g1^~x>, 
                                                                                  <'45', '0', '1'>, 
                                                                                  <'42', '0'>, '41', 
                                                                                  <p_psk_id, 
                                                                                   mask(ticket_age_add,
                                                                                        $ticket_age)
                                                                                  >, 
                                                                                  '0'>)
                                                                              >)
                                                                        >, 
                                                                        '6', '0x0303', '40', $g>, 
                                                                       '1', '0x0303', ~tid, '0', 
                                                                       $cipher_suites.1, '0', 
                                                                       <'43', '0x0304'>, <'10', $g1, $g>, 
                                                                       <'13', $sig_algs>, '40', $g, $g^~x.1>, 
                                                                      '2', '0x0303', p_ns, $cipher_suite, 
                                                                      <'13', $sig_algs.1>, '40', $g, p_gy>, 
                                                                     '8', $exts>, 
                                                                    '13', '0', $certificate_extensions>, 
                                                                   '11', '0', pk(~ltkS)>, 
                                                                  '15', 
                                                                  sign(<'server_cv', 
                                                                        h(<
                                                                           <
                                                                            <
                                                                             <
                                                                              <
                                                                               <
                                                                                <'0', '1', '0x0303', ~tid, 
                                                                                 '0', $cipher_suites, '0', 
                                                                                 <'43', '0x0304'>, 
                                                                                 <'10', $g1, $g>, 
                                                                                 <'40', $g1, $g1^~x>, 
                                                                                 <'45', '0', '1'>, 
                                                                                 <'42', '0'>, '41', 
                                                                                 <p_psk_id, 
                                                                                  mask(ticket_age_add,
                                                                                       $ticket_age)
                                                                                 >, 
                                                                                 hmac(<
                                                                                       Expand(Expand(Extract(Expand(ms,
                                                                                                                    <
                                                                                                                     'rms', 
                                                                                                                     h(messages)
                                                                                                                    >,
                                                                                                                    '32'),
                                                                                                             '0'),
                                                                                                     <'res', 
                                                                                                      'pbk'>,
                                                                                                     '32'),
                                                                                              <'0', '0'>,
                                                                                              '32'), 
                                                                                       h(<'0', '1', '0x0303', 
                                                                                          ~tid, '0', 
                                                                                          $cipher_suites, 
                                                                                          '0', 
                                                                                          <'43', '0x0304'>, 
                                                                                          <'10', $g1, $g>, 
                                                                                          <'40', $g1, $g1^~x
                                                                                          >, 
                                                                                          <'45', '0', '1'>, 
                                                                                          <'42', '0'>, '41', 
                                                                                          <p_psk_id, 
                                                                                           mask(ticket_age_add,
                                                                                                $ticket_age)
                                                                                          >, 
                                                                                          '0'>)
                                                                                      >)
                                                                                >, 
                                                                                '6', '0x0303', '40', $g>, 
                                                                               '1', '0x0303', ~tid, '0', 
                                                                               $cipher_suites.1, '0', 
                                                                               <'43', '0x0304'>, 
                                                                               <'10', $g1, $g>, 
                                                                               <'13', $sig_algs>, '40', $g, 
                                                                               $g^~x.1>, 
                                                                              '2', '0x0303', p_ns, 
                                                                              $cipher_suite, 
                                                                              <'13', $sig_algs.1>, '40', $g, 
                                                                              p_gy>, 
                                                                             '8', $exts>, 
                                                                            '13', '0', $certificate_extensions
                                                                           >, 
                                                                           '11', '0', pk(~ltkS)>)
                                                                       >,
                                                                       ~ltkS)
                                                                 >)
                                                              >,
                                                              '32'),
                                                       <'fin', '0'>, '32'), 
                                                h(<
                                                   <
                                                    <
                                                     <
                                                      <
                                                       <
                                                        <
                                                         <'0', '1', '0x0303', ~tid, '0', $cipher_suites, '0', 
                                                          <'43', '0x0304'>, <'10', $g1, $g>, 
                                                          <'40', $g1, $g1^~x>, <'45', '0', '1'>, <'42', '0'>, 
                                                          '41', 
                                                          <p_psk_id, mask(ticket_age_add, $ticket_age)>, 
                                                          hmac(<
                                                                Expand(Expand(Extract(Expand(ms,
                                                                                             <'rms', 
                                                                                              h(messages)>,
                                                                                             '32'),
                                                                                      '0'),
                                                                              <'res', 'pbk'>, '32'),
                                                                       <'0', '0'>, '32'), 
                                                                h(<'0', '1', '0x0303', ~tid, '0', 
                                                                   $cipher_suites, '0', <'43', '0x0304'>, 
                                                                   <'10', $g1, $g>, <'40', $g1, $g1^~x>, 
                                                                   <'45', '0', '1'>, <'42', '0'>, '41', 
                                                                   <p_psk_id, 
                                                                    mask(ticket_age_add, $ticket_age)>, 
                                                                   '0'>)
                                                               >)
                                                         >, 
                                                         '6', '0x0303', '40', $g>, 
                                                        '1', '0x0303', ~tid, '0', $cipher_suites.1, '0', 
                                                        <'43', '0x0304'>, <'10', $g1, $g>, <'13', $sig_algs>, 
                                                        '40', $g, $g^~x.1>, 
                                                       '2', '0x0303', p_ns, $cipher_suite, 
                                                       <'13', $sig_algs.1>, '40', $g, p_gy>, 
                                                      '8', $exts>, 
                                                     '13', '0', $certificate_extensions>, 
                                                    '11', '0', pk(~ltkS)>, 
                                                   '15', 
                                                   sign(<'server_cv', 
                                                         h(<
                                                            <
                                                             <
                                                              <
                                                               <
                                                                <
                                                                 <'0', '1', '0x0303', ~tid, '0', 
                                                                  $cipher_suites, '0', <'43', '0x0304'>, 
                                                                  <'10', $g1, $g>, <'40', $g1, $g1^~x>, 
                                                                  <'45', '0', '1'>, <'42', '0'>, '41', 
                                                                  <p_psk_id, mask(ticket_age_add, $ticket_age)
                                                                  >, 
                                                                  hmac(<
                                                                        Expand(Expand(Extract(Expand(ms,
                                                                                                     <'rms', 
                                                                                                      h(messages)
                                                                                                     >,
                                                                                                     '32'),
                                                                                              '0'),
                                                                                      <'res', 'pbk'>, '32'),
                                                                               <'0', '0'>, '32'), 
                                                                        h(<'0', '1', '0x0303', ~tid, '0', 
                                                                           $cipher_suites, '0', 
                                                                           <'43', '0x0304'>, <'10', $g1, $g>, 
                                                                           <'40', $g1, $g1^~x>, 
                                                                           <'45', '0', '1'>, <'42', '0'>, 
                                                                           '41', 
                                                                           <p_psk_id, 
                                                                            mask(ticket_age_add, $ticket_age)
                                                                           >, 
                                                                           '0'>)
                                                                       >)
                                                                 >, 
                                                                 '6', '0x0303', '40', $g>, 
                                                                '1', '0x0303', ~tid, '0', $cipher_suites.1, 
                                                                '0', <'43', '0x0304'>, <'10', $g1, $g>, 
                                                                <'13', $sig_algs>, '40', $g, $g^~x.1>, 
                                                               '2', '0x0303', p_ns, $cipher_suite, 
                                                               <'13', $sig_algs.1>, '40', $g, p_gy>, 
                                                              '8', $exts>, 
                                                             '13', '0', $certificate_extensions>, 
                                                            '11', '0', pk(~ltkS)>)
                                                        >,
                                                        ~ltkS)
                                                  >)
                                               >)
                                         >)
                                      >,
                                      '32')
                    ) ▶₀ #l )
        qed
      qed
    next
      case recv_server_auth_case_05
      solve( (∃ #j.2.
               (!KU( Extract('0', Extract(p_gxy, Extract(~res_psk, '0'))) ) @ #j.2)
              ∧
               #j.2 < #j.1)  ∥
             ((∀ #k.
                (!KU( Extract('0', Extract(p_gxy, Extract(~res_psk, '0'))) ) @ #k)
               ⇒
                ¬(#k < #j.1)) ∧
              (∃ actor #l.
                (RevealPSK( actor,
                            Expand(Extract('0', Extract(p_gxy, Extract(~res_psk, '0'))),
                                   <'serverats', 
                                    h(<
                                       <
                                        <
                                         <
                                          <
                                           <
                                            <'0', '1', '0x0303', ~tid, '0', $cipher_suites, '0', 
                                             <'43', '0x0304'>, <'10', $g, $g2>, <'40', $g, $g^~x>, 
                                             <'45', '0', '1'>, <'42', '0'>, '41', 
                                             <~ticket, mask(~ticket_age_add, $ticket_age)>, 
                                             hmac(<
                                                   Expand(Expand(Extract(~res_psk, '0'), <'ext', 'pbk'>,
                                                                 '32'),
                                                          <'0', '0'>, '32'), 
                                                   h(<'0', '1', '0x0303', ~tid, '0', $cipher_suites, '0', 
                                                      <'43', '0x0304'>, <'10', $g, $g2>, <'40', $g, $g^~x>, 
                                                      <'45', '0', '1'>, <'42', '0'>, '41', 
                                                      <~ticket, mask(~ticket_age_add, $ticket_age)>, '0'>)
                                                  >)
                                            >, 
                                            '2', '0x0303', p_ns, $cipher_suite, <'13', $sig_algs>, '40', $g, 
                                            p_gy>, 
                                           '8', $exts>, 
                                          '13', '0', $certificate_extensions>, 
                                         '11', '0', pk(~ltkS)>, 
                                        '15', 
                                        sign(<'server_cv', 
                                              h(<
                                                 <
                                                  <
                                                   <
                                                    <'0', '1', '0x0303', ~tid, '0', $cipher_suites, '0', 
                                                     <'43', '0x0304'>, <'10', $g, $g2>, <'40', $g, $g^~x>, 
                                                     <'45', '0', '1'>, <'42', '0'>, '41', 
                                                     <~ticket, mask(~ticket_age_add, $ticket_age)>, 
                                                     hmac(<
                                                           Expand(Expand(Extract(~res_psk, '0'),
                                                                         <'ext', 'pbk'>, '32'),
                                                                  <'0', '0'>, '32'), 
                                                           h(<'0', '1', '0x0303', ~tid, '0', $cipher_suites, 
                                                              '0', <'43', '0x0304'>, <'10', $g, $g2>, 
                                                              <'40', $g, $g^~x>, <'45', '0', '1'>, 
                                                              <'42', '0'>, '41', 
                                                              <~ticket, mask(~ticket_age_add, $ticket_age)>, 
                                                              '0'>)
                                                          >)
                                                    >, 
                                                    '2', '0x0303', p_ns, $cipher_suite, <'13', $sig_algs>, 
                                                    '40', $g, p_gy>, 
                                                   '8', $exts>, 
                                                  '13', '0', $certificate_extensions>, 
                                                 '11', '0', pk(~ltkS)>)
                                             >,
                                             ~ltkS)
                                       >, 
                                       '20', 
                                       hmac(<
                                             Expand(Expand(Extract(p_gxy, Extract(~res_psk, '0')),
                                                           <'serverhts', 
                                                            h(<
                                                               <
                                                                <
                                                                 <
                                                                  <
                                                                   <'0', '1', '0x0303', ~tid, '0', 
                                                                    $cipher_suites, '0', <'43', '0x0304'>, 
                                                                    <'10', $g, $g2>, <'40', $g, $g^~x>, 
                                                                    <'45', '0', '1'>, <'42', '0'>, '41', 
                                                                    <~ticket, 
                                                                     mask(~ticket_age_add, $ticket_age)>, 
                                                                    hmac(<
                                                                          Expand(Expand(Extract(~res_psk,
                                                                                                '0'),
                                                                                        <'ext', 'pbk'>, '32'),
                                                                                 <'0', '0'>, '32'), 
                                                                          h(<'0', '1', '0x0303', ~tid, '0', 
                                                                             $cipher_suites, '0', 
                                                                             <'43', '0x0304'>, 
                                                                             <'10', $g, $g2>, 
                                                                             <'40', $g, $g^~x>, 
                                                                             <'45', '0', '1'>, <'42', '0'>, 
                                                                             '41', 
                                                                             <~ticket, 
                                                                              mask(~ticket_age_add,
                                                                                   $ticket_age)
                                                                             >, 
                                                                             '0'>)
                                                                         >)
                                                                   >, 
                                                                   '2', '0x0303', p_ns, $cipher_suite, 
                                                                   <'13', $sig_algs>, '40', $g, p_gy>, 
                                                                  '8', $exts>, 
                                                                 '13', '0', $certificate_extensions>, 
                                                                '11', '0', pk(~ltkS)>, 
                                                               '15', 
                                                               sign(<'server_cv', 
                                                                     h(<
                                                                        <
                                                                         <
                                                                          <
                                                                           <'0', '1', '0x0303', ~tid, '0', 
                                                                            $cipher_suites, '0', 
                                                                            <'43', '0x0304'>, 
                                                                            <'10', $g, $g2>, 
                                                                            <'40', $g, $g^~x>, 
                                                                            <'45', '0', '1'>, <'42', '0'>, 
                                                                            '41', 
                                                                            <~ticket, 
                                                                             mask(~ticket_age_add,
                                                                                  $ticket_age)
                                                                            >, 
                                                                            hmac(<
                                                                                  Expand(Expand(Extract(~res_psk,
                                                                                                        '0'),
                                                                                                <'ext', 'pbk'
                                                                                                >,
                                                                                                '32'),
                                                                                         <'0', '0'>, '32'), 
                                                                                  h(<'0', '1', '0x0303', 
                                                                                     ~tid, '0', 
                                                                                     $cipher_suites, '0', 
                                                                                     <'43', '0x0304'>, 
                                                                                     <'10', $g, $g2>, 
                                                                                     <'40', $g, $g^~x>, 
                                                                                     <'45', '0', '1'>, 
                                                                                     <'42', '0'>, '41', 
                                                                                     <~ticket, 
                                                                                      mask(~ticket_age_add,
                                                                                           $ticket_age)
                                                                                     >, 
                                                                                     '0'>)
                                                                                 >)
                                                                           >, 
                                                                           '2', '0x0303', p_ns, 
                                                                           $cipher_suite, <'13', $sig_algs>, 
                                                                           '40', $g, p_gy>, 
                                                                          '8', $exts>, 
                                                                         '13', '0', $certificate_extensions>, 
                                                                        '11', '0', pk(~ltkS)>)
                                                                    >,
                                                                    ~ltkS)
                                                              >)
                                                           >,
                                                           '32'),
                                                    <'fin', '0'>, '32'), 
                                             h(<
                                                <
                                                 <
                                                  <
                                                   <
                                                    <'0', '1', '0x0303', ~tid, '0', $cipher_suites, '0', 
                                                     <'43', '0x0304'>, <'10', $g, $g2>, <'40', $g, $g^~x>, 
                                                     <'45', '0', '1'>, <'42', '0'>, '41', 
                                                     <~ticket, mask(~ticket_age_add, $ticket_age)>, 
                                                     hmac(<
                                                           Expand(Expand(Extract(~res_psk, '0'),
                                                                         <'ext', 'pbk'>, '32'),
                                                                  <'0', '0'>, '32'), 
                                                           h(<'0', '1', '0x0303', ~tid, '0', $cipher_suites, 
                                                              '0', <'43', '0x0304'>, <'10', $g, $g2>, 
                                                              <'40', $g, $g^~x>, <'45', '0', '1'>, 
                                                              <'42', '0'>, '41', 
                                                              <~ticket, mask(~ticket_age_add, $ticket_age)>, 
                                                              '0'>)
                                                          >)
                                                    >, 
                                                    '2', '0x0303', p_ns, $cipher_suite, <'13', $sig_algs>, 
                                                    '40', $g, p_gy>, 
                                                   '8', $exts>, 
                                                  '13', '0', $certificate_extensions>, 
                                                 '11', '0', pk(~ltkS)>, 
                                                '15', 
                                                sign(<'server_cv', 
                                                      h(<
                                                         <
                                                          <
                                                           <
                                                            <'0', '1', '0x0303', ~tid, '0', $cipher_suites, 
                                                             '0', <'43', '0x0304'>, <'10', $g, $g2>, 
                                                             <'40', $g, $g^~x>, <'45', '0', '1'>, 
                                                             <'42', '0'>, '41', 
                                                             <~ticket, mask(~ticket_age_add, $ticket_age)>, 
                                                             hmac(<
                                                                   Expand(Expand(Extract(~res_psk, '0'),
                                                                                 <'ext', 'pbk'>, '32'),
                                                                          <'0', '0'>, '32'), 
                                                                   h(<'0', '1', '0x0303', ~tid, '0', 
                                                                      $cipher_suites, '0', <'43', '0x0304'>, 
                                                                      <'10', $g, $g2>, <'40', $g, $g^~x>, 
                                                                      <'45', '0', '1'>, <'42', '0'>, '41', 
                                                                      <~ticket, 
                                                                       mask(~ticket_age_add, $ticket_age)>, 
                                                                      '0'>)
                                                                  >)
                                                            >, 
                                                            '2', '0x0303', p_ns, $cipher_suite, 
                                                            <'13', $sig_algs>, '40', $g, p_gy>, 
                                                           '8', $exts>, 
                                                          '13', '0', $certificate_extensions>, 
                                                         '11', '0', pk(~ltkS)>)
                                                     >,
                                                     ~ltkS)
                                               >)
                                            >)
                                      >)
                                   >,
                                   '32')
                 ) @ #l)
               ∧
                #l < #j.1)) )
        case case_1
        solve( (∃ #r. (RevLtk( $S ) @ #r) ∧ #r < #vr)  ∥
               (∃ tid3 x #r. (RevDHExp( tid3, $S, x ) @ #r) ∧ #r < #vr)  ∥
               (∃ tid4 y #r. (RevDHExp( tid4, $C, y ) @ #r) ∧ #r < #vr)  ∥
               (∃ rms #r. (RevealPSK( $C, rms ) @ #r) ∧ #r < #k.1)  ∥
               (∃ rms #r. (RevealPSK( $S, rms ) @ #r) ∧ #r < #k.1) )
          case case_1
          by contradiction /* from formulas */
        next
          case case_2
          by contradiction /* from formulas */
        next
          case case_3
          by contradiction /* from formulas */
        next
          case case_4
          by contradiction /* from formulas */
        next
          case case_5
          by contradiction /* from formulas */
        qed
      next
        case case_2
        solve( !Ltk( $C, ~ltkC ) ▶₂ #i )
          case Register_pk
          by solve( SecretPSK( $A,
                               Expand(Extract('0', Extract(p_gxy, Extract(~res_psk, '0'))),
                                      <'serverats', 
                                       h(<
                                          <
                                           <
                                            <
                                             <
                                              <
                                               <'0', '1', '0x0303', ~tid, '0', $cipher_suites, '0', 
                                                <'43', '0x0304'>, <'10', $g, $g2>, <'40', $g, $g^~x>, 
                                                <'45', '0', '1'>, <'42', '0'>, '41', 
                                                <~ticket, mask(~ticket_age_add, $ticket_age)>, 
                                                hmac(<
                                                      Expand(Expand(Extract(~res_psk, '0'), <'ext', 'pbk'>,
                                                                    '32'),
                                                             <'0', '0'>, '32'), 
                                                      h(<'0', '1', '0x0303', ~tid, '0', $cipher_suites, '0', 
                                                         <'43', '0x0304'>, <'10', $g, $g2>, 
                                                         <'40', $g, $g^~x>, <'45', '0', '1'>, <'42', '0'>, 
                                                         '41', <~ticket, mask(~ticket_age_add, $ticket_age)>, 
                                                         '0'>)
                                                     >)
                                               >, 
                                               '2', '0x0303', p_ns, $cipher_suite, <'13', $sig_algs>, '40', 
                                               $g, p_gy>, 
                                              '8', $exts>, 
                                             '13', '0', $certificate_extensions>, 
                                            '11', '0', pk(~ltkS)>, 
                                           '15', 
                                           sign(<'server_cv', 
                                                 h(<
                                                    <
                                                     <
                                                      <
                                                       <'0', '1', '0x0303', ~tid, '0', $cipher_suites, '0', 
                                                        <'43', '0x0304'>, <'10', $g, $g2>, <'40', $g, $g^~x>, 
                                                        <'45', '0', '1'>, <'42', '0'>, '41', 
                                                        <~ticket, mask(~ticket_age_add, $ticket_age)>, 
                                                        hmac(<
                                                              Expand(Expand(Extract(~res_psk, '0'),
                                                                            <'ext', 'pbk'>, '32'),
                                                                     <'0', '0'>, '32'), 
                                                              h(<'0', '1', '0x0303', ~tid, '0', 
                                                                 $cipher_suites, '0', <'43', '0x0304'>, 
                                                                 <'10', $g, $g2>, <'40', $g, $g^~x>, 
                                                                 <'45', '0', '1'>, <'42', '0'>, '41', 
                                                                 <~ticket, mask(~ticket_age_add, $ticket_age)
                                                                 >, 
                                                                 '0'>)
                                                             >)
                                                       >, 
                                                       '2', '0x0303', p_ns, $cipher_suite, <'13', $sig_algs>, 
                                                       '40', $g, p_gy>, 
                                                      '8', $exts>, 
                                                     '13', '0', $certificate_extensions>, 
                                                    '11', '0', pk(~ltkS)>)
                                                >,
                                                ~ltkS)
                                          >, 
                                          '20', 
                                          hmac(<
                                                Expand(Expand(Extract(p_gxy, Extract(~res_psk, '0')),
                                                              <'serverhts', 
                                                               h(<
                                                                  <
                                                                   <
                                                                    <
                                                                     <
                                                                      <'0', '1', '0x0303', ~tid, '0', 
                                                                       $cipher_suites, '0', <'43', '0x0304'>, 
                                                                       <'10', $g, $g2>, <'40', $g, $g^~x>, 
                                                                       <'45', '0', '1'>, <'42', '0'>, '41', 
                                                                       <~ticket, 
                                                                        mask(~ticket_age_add, $ticket_age)>, 
                                                                       hmac(<
                                                                             Expand(Expand(Extract(~res_psk,
                                                                                                   '0'),
                                                                                           <'ext', 'pbk'>,
                                                                                           '32'),
                                                                                    <'0', '0'>, '32'), 
                                                                             h(<'0', '1', '0x0303', ~tid, 
                                                                                '0', $cipher_suites, '0', 
                                                                                <'43', '0x0304'>, 
                                                                                <'10', $g, $g2>, 
                                                                                <'40', $g, $g^~x>, 
                                                                                <'45', '0', '1'>, 
                                                                                <'42', '0'>, '41', 
                                                                                <~ticket, 
                                                                                 mask(~ticket_age_add,
                                                                                      $ticket_age)
                                                                                >, 
                                                                                '0'>)
                                                                            >)
                                                                      >, 
                                                                      '2', '0x0303', p_ns, $cipher_suite, 
                                                                      <'13', $sig_algs>, '40', $g, p_gy>, 
                                                                     '8', $exts>, 
                                                                    '13', '0', $certificate_extensions>, 
                                                                   '11', '0', pk(~ltkS)>, 
                                                                  '15', 
                                                                  sign(<'server_cv', 
                                                                        h(<
                                                                           <
                                                                            <
                                                                             <
                                                                              <'0', '1', '0x0303', ~tid, '0', 
                                                                               $cipher_suites, '0', 
                                                                               <'43', '0x0304'>, 
                                                                               <'10', $g, $g2>, 
                                                                               <'40', $g, $g^~x>, 
                                                                               <'45', '0', '1'>, <'42', '0'>, 
                                                                               '41', 
                                                                               <~ticket, 
                                                                                mask(~ticket_age_add,
                                                                                     $ticket_age)
                                                                               >, 
                                                                               hmac(<
                                                                                     Expand(Expand(Extract(~res_psk,
                                                                                                           '0'),
                                                                                                   <'ext', 
                                                                                                    'pbk'>,
                                                                                                   '32'),
                                                                                            <'0', '0'>,
                                                                                            '32'), 
                                                                                     h(<'0', '1', '0x0303', 
                                                                                        ~tid, '0', 
                                                                                        $cipher_suites, '0', 
                                                                                        <'43', '0x0304'>, 
                                                                                        <'10', $g, $g2>, 
                                                                                        <'40', $g, $g^~x>, 
                                                                                        <'45', '0', '1'>, 
                                                                                        <'42', '0'>, '41', 
                                                                                        <~ticket, 
                                                                                         mask(~ticket_age_add,
                                                                                              $ticket_age)
                                                                                        >, 
                                                                                        '0'>)
                                                                                    >)
                                                                              >, 
                                                                              '2', '0x0303', p_ns, 
                                                                              $cipher_suite, 
                                                                              <'13', $sig_algs>, '40', $g, 
                                                                              p_gy>, 
                                                                             '8', $exts>, 
                                                                            '13', '0', $certificate_extensions
                                                                           >, 
                                                                           '11', '0', pk(~ltkS)>)
                                                                       >,
                                                                       ~ltkS)
                                                                 >)
                                                              >,
                                                              '32'),
                                                       <'fin', '0'>, '32'), 
                                                h(<
                                                   <
                                                    <
                                                     <
                                                      <
                                                       <'0', '1', '0x0303', ~tid, '0', $cipher_suites, '0', 
                                                        <'43', '0x0304'>, <'10', $g, $g2>, <'40', $g, $g^~x>, 
                                                        <'45', '0', '1'>, <'42', '0'>, '41', 
                                                        <~ticket, mask(~ticket_age_add, $ticket_age)>, 
                                                        hmac(<
                                                              Expand(Expand(Extract(~res_psk, '0'),
                                                                            <'ext', 'pbk'>, '32'),
                                                                     <'0', '0'>, '32'), 
                                                              h(<'0', '1', '0x0303', ~tid, '0', 
                                                                 $cipher_suites, '0', <'43', '0x0304'>, 
                                                                 <'10', $g, $g2>, <'40', $g, $g^~x>, 
                                                                 <'45', '0', '1'>, <'42', '0'>, '41', 
                                                                 <~ticket, mask(~ticket_age_add, $ticket_age)
                                                                 >, 
                                                                 '0'>)
                                                             >)
                                                       >, 
                                                       '2', '0x0303', p_ns, $cipher_suite, <'13', $sig_algs>, 
                                                       '40', $g, p_gy>, 
                                                      '8', $exts>, 
                                                     '13', '0', $certificate_extensions>, 
                                                    '11', '0', pk(~ltkS)>, 
                                                   '15', 
                                                   sign(<'server_cv', 
                                                         h(<
                                                            <
                                                             <
                                                              <
                                                               <'0', '1', '0x0303', ~tid, '0', 
                                                                $cipher_suites, '0', <'43', '0x0304'>, 
                                                                <'10', $g, $g2>, <'40', $g, $g^~x>, 
                                                                <'45', '0', '1'>, <'42', '0'>, '41', 
                                                                <~ticket, mask(~ticket_age_add, $ticket_age)
                                                                >, 
                                                                hmac(<
                                                                      Expand(Expand(Extract(~res_psk, '0'),
                                                                                    <'ext', 'pbk'>, '32'),
                                                                             <'0', '0'>, '32'), 
                                                                      h(<'0', '1', '0x0303', ~tid, '0', 
                                                                         $cipher_suites, '0', 
                                                                         <'43', '0x0304'>, <'10', $g, $g2>, 
                                                                         <'40', $g, $g^~x>, <'45', '0', '1'>, 
                                                                         <'42', '0'>, '41', 
                                                                         <~ticket, 
                                                                          mask(~ticket_age_add, $ticket_age)
                                                                         >, 
                                                                         '0'>)
                                                                     >)
                                                               >, 
                                                               '2', '0x0303', p_ns, $cipher_suite, 
                                                               <'13', $sig_algs>, '40', $g, p_gy>, 
                                                              '8', $exts>, 
                                                             '13', '0', $certificate_extensions>, 
                                                            '11', '0', pk(~ltkS)>)
                                                        >,
                                                        ~ltkS)
                                                  >)
                                               >)
                                         >)
                                      >,
                                      '32')
                    ) ▶₀ #l )
        qed
      qed
    next
      case recv_server_auth_case_06
      solve( (∃ #j.2.
               (!KU( Extract('0',
                             Extract(p_gxy, Extract(Expand(ms, <'rms', h(messages)>, '32'), '0')))
                ) @ #j.2)
              ∧
               #j.2 < #j.1)  ∥
             ((∀ #k.
                (!KU( Extract('0',
                              Extract(p_gxy, Extract(Expand(ms, <'rms', h(messages)>, '32'), '0')))
                 ) @ #k)
               ⇒
                ¬(#k < #j.1)) ∧
              (∃ actor #l.
                (RevealPSK( actor,
                            Expand(Extract('0',
                                           Extract(p_gxy,
                                                   Extract(Expand(ms, <'rms', h(messages)>, '32'), '0'))),
                                   <'serverats', 
                                    h(<
                                       <
                                        <
                                         <
                                          <
                                           <
                                            <'0', '1', '0x0303', ~tid, '0', $cipher_suites, '0', 
                                             <'43', '0x0304'>, <'10', $g, $g2>, <'40', $g, $g^~x>, 
                                             <'45', '0', '1'>, <'42', '0'>, '41', 
                                             <p_psk_id, mask(ticket_age_add, $ticket_age)>, 
                                             hmac(<
                                                   Expand(Expand(Extract(Expand(ms, <'rms', h(messages)>,
                                                                                '32'),
                                                                         '0'),
                                                                 <'res', 'pbk'>, '32'),
                                                          <'0', '0'>, '32'), 
                                                   h(<'0', '1', '0x0303', ~tid, '0', $cipher_suites, '0', 
                                                      <'43', '0x0304'>, <'10', $g, $g2>, <'40', $g, $g^~x>, 
                                                      <'45', '0', '1'>, <'42', '0'>, '41', 
                                                      <p_psk_id, mask(ticket_age_add, $ticket_age)>, '0'>)
                                                  >)
                                            >, 
                                            '2', '0x0303', p_ns, $cipher_suite, <'13', $sig_algs>, '40', $g, 
                                            p_gy>, 
                                           '8', $exts>, 
                                          '13', '0', $certificate_extensions>, 
                                         '11', '0', pk(~ltkS)>, 
                                        '15', 
                                        sign(<'server_cv', 
                                              h(<
                                                 <
                                                  <
                                                   <
                                                    <'0', '1', '0x0303', ~tid, '0', $cipher_suites, '0', 
                                                     <'43', '0x0304'>, <'10', $g, $g2>, <'40', $g, $g^~x>, 
                                                     <'45', '0', '1'>, <'42', '0'>, '41', 
                                                     <p_psk_id, mask(ticket_age_add, $ticket_age)>, 
                                                     hmac(<
                                                           Expand(Expand(Extract(Expand(ms,
                                                                                        <'rms', h(messages)>,
                                                                                        '32'),
                                                                                 '0'),
                                                                         <'res', 'pbk'>, '32'),
                                                                  <'0', '0'>, '32'), 
                                                           h(<'0', '1', '0x0303', ~tid, '0', $cipher_suites, 
                                                              '0', <'43', '0x0304'>, <'10', $g, $g2>, 
                                                              <'40', $g, $g^~x>, <'45', '0', '1'>, 
                                                              <'42', '0'>, '41', 
                                                              <p_psk_id, mask(ticket_age_add, $ticket_age)>, 
                                                              '0'>)
                                                          >)
                                                    >, 
                                                    '2', '0x0303', p_ns, $cipher_suite, <'13', $sig_algs>, 
                                                    '40', $g, p_gy>, 
                                                   '8', $exts>, 
                                                  '13', '0', $certificate_extensions>, 
                                                 '11', '0', pk(~ltkS)>)
                                             >,
                                             ~ltkS)
                                       >, 
                                       '20', 
                                       hmac(<
                                             Expand(Expand(Extract(p_gxy,
                                                                   Extract(Expand(ms, <'rms', h(messages)>,
                                                                                  '32'),
                                                                           '0')),
                                                           <'serverhts', 
                                                            h(<
                                                               <
                                                                <
                                                                 <
                                                                  <
                                                                   <'0', '1', '0x0303', ~tid, '0', 
                                                                    $cipher_suites, '0', <'43', '0x0304'>, 
                                                                    <'10', $g, $g2>, <'40', $g, $g^~x>, 
                                                                    <'45', '0', '1'>, <'42', '0'>, '41', 
                                                                    <p_psk_id, 
                                                                     mask(ticket_age_add, $ticket_age)>, 
                                                                    hmac(<
                                                                          Expand(Expand(Extract(Expand(ms,
                                                                                                       <
                                                                                                        'rms', 
                                                                                                        h(messages)
                                                                                                       >,
                                                                                                       '32'),
                                                                                                '0'),
                                                                                        <'res', 'pbk'>, '32'),
                                                                                 <'0', '0'>, '32'), 
                                                                          h(<'0', '1', '0x0303', ~tid, '0', 
                                                                             $cipher_suites, '0', 
                                                                             <'43', '0x0304'>, 
                                                                             <'10', $g, $g2>, 
                                                                             <'40', $g, $g^~x>, 
                                                                             <'45', '0', '1'>, <'42', '0'>, 
                                                                             '41', 
                                                                             <p_psk_id, 
                                                                              mask(ticket_age_add,
                                                                                   $ticket_age)
                                                                             >, 
                                                                             '0'>)
                                                                         >)
                                                                   >, 
                                                                   '2', '0x0303', p_ns, $cipher_suite, 
                                                                   <'13', $sig_algs>, '40', $g, p_gy>, 
                                                                  '8', $exts>, 
                                                                 '13', '0', $certificate_extensions>, 
                                                                '11', '0', pk(~ltkS)>, 
                                                               '15', 
                                                               sign(<'server_cv', 
                                                                     h(<
                                                                        <
                                                                         <
                                                                          <
                                                                           <'0', '1', '0x0303', ~tid, '0', 
                                                                            $cipher_suites, '0', 
                                                                            <'43', '0x0304'>, 
                                                                            <'10', $g, $g2>, 
                                                                            <'40', $g, $g^~x>, 
                                                                            <'45', '0', '1'>, <'42', '0'>, 
                                                                            '41', 
                                                                            <p_psk_id, 
                                                                             mask(ticket_age_add, $ticket_age)
                                                                            >, 
                                                                            hmac(<
                                                                                  Expand(Expand(Extract(Expand(ms,
                                                                                                               <
                                                                                                                'rms', 
                                                                                                                h(messages)
                                                                                                               >,
                                                                                                               '32'),
                                                                                                        '0'),
                                                                                                <'res', 'pbk'
                                                                                                >,
                                                                                                '32'),
                                                                                         <'0', '0'>, '32'), 
                                                                                  h(<'0', '1', '0x0303', 
                                                                                     ~tid, '0', 
                                                                                     $cipher_suites, '0', 
                                                                                     <'43', '0x0304'>, 
                                                                                     <'10', $g, $g2>, 
                                                                                     <'40', $g, $g^~x>, 
                                                                                     <'45', '0', '1'>, 
                                                                                     <'42', '0'>, '41', 
                                                                                     <p_psk_id, 
                                                                                      mask(ticket_age_add,
                                                                                           $ticket_age)
                                                                                     >, 
                                                                                     '0'>)
                                                                                 >)
                                                                           >, 
                                                                           '2', '0x0303', p_ns, 
                                                                           $cipher_suite, <'13', $sig_algs>, 
                                                                           '40', $g, p_gy>, 
                                                                          '8', $exts>, 
                                                                         '13', '0', $certificate_extensions>, 
                                                                        '11', '0', pk(~ltkS)>)
                                                                    >,
                                                                    ~ltkS)
                                                              >)
                                                           >,
                                                           '32'),
                                                    <'fin', '0'>, '32'), 
                                             h(<
                                                <
                                                 <
                                                  <
                                                   <
                                                    <'0', '1', '0x0303', ~tid, '0', $cipher_suites, '0', 
                                                     <'43', '0x0304'>, <'10', $g, $g2>, <'40', $g, $g^~x>, 
                                                     <'45', '0', '1'>, <'42', '0'>, '41', 
                                                     <p_psk_id, mask(ticket_age_add, $ticket_age)>, 
                                                     hmac(<
                                                           Expand(Expand(Extract(Expand(ms,
                                                                                        <'rms', h(messages)>,
                                                                                        '32'),
                                                                                 '0'),
                                                                         <'res', 'pbk'>, '32'),
                                                                  <'0', '0'>, '32'), 
                                                           h(<'0', '1', '0x0303', ~tid, '0', $cipher_suites, 
                                                              '0', <'43', '0x0304'>, <'10', $g, $g2>, 
                                                              <'40', $g, $g^~x>, <'45', '0', '1'>, 
                                                              <'42', '0'>, '41', 
                                                              <p_psk_id, mask(ticket_age_add, $ticket_age)>, 
                                                              '0'>)
                                                          >)
                                                    >, 
                                                    '2', '0x0303', p_ns, $cipher_suite, <'13', $sig_algs>, 
                                                    '40', $g, p_gy>, 
                                                   '8', $exts>, 
                                                  '13', '0', $certificate_extensions>, 
                                                 '11', '0', pk(~ltkS)>, 
                                                '15', 
                                                sign(<'server_cv', 
                                                      h(<
                                                         <
                                                          <
                                                           <
                                                            <'0', '1', '0x0303', ~tid, '0', $cipher_suites, 
                                                             '0', <'43', '0x0304'>, <'10', $g, $g2>, 
                                                             <'40', $g, $g^~x>, <'45', '0', '1'>, 
                                                             <'42', '0'>, '41', 
                                                             <p_psk_id, mask(ticket_age_add, $ticket_age)>, 
                                                             hmac(<
                                                                   Expand(Expand(Extract(Expand(ms,
                                                                                                <'rms', 
                                                                                                 h(messages)>,
                                                                                                '32'),
                                                                                         '0'),
                                                                                 <'res', 'pbk'>, '32'),
                                                                          <'0', '0'>, '32'), 
                                                                   h(<'0', '1', '0x0303', ~tid, '0', 
                                                                      $cipher_suites, '0', <'43', '0x0304'>, 
                                                                      <'10', $g, $g2>, <'40', $g, $g^~x>, 
                                                                      <'45', '0', '1'>, <'42', '0'>, '41', 
                                                                      <p_psk_id, 
                                                                       mask(ticket_age_add, $ticket_age)>, 
                                                                      '0'>)
                                                                  >)
                                                            >, 
                                                            '2', '0x0303', p_ns, $cipher_suite, 
                                                            <'13', $sig_algs>, '40', $g, p_gy>, 
                                                           '8', $exts>, 
                                                          '13', '0', $certificate_extensions>, 
                                                         '11', '0', pk(~ltkS)>)
                                                     >,
                                                     ~ltkS)
                                               >)
                                            >)
                                      >)
                                   >,
                                   '32')
                 ) @ #l)
               ∧
                #l < #j.1)) )
        case case_1
        solve( (∃ #r. (RevLtk( $S ) @ #r) ∧ #r < #vr)  ∥
               (∃ tid3 x #r. (RevDHExp( tid3, $S, x ) @ #r) ∧ #r < #vr)  ∥
               (∃ tid4 y #r. (RevDHExp( tid4, $C, y ) @ #r) ∧ #r < #vr)  ∥
               (∃ rms #r. (RevealPSK( $C, rms ) @ #r) ∧ #r < #k.1)  ∥
               (∃ rms #r. (RevealPSK( $S, rms ) @ #r) ∧ #r < #k.1) )
          case case_1
          by contradiction /* from formulas */
        next
          case case_2
          by contradiction /* from formulas */
        next
          case case_3
          by contradiction /* from formulas */
        next
          case case_4
          by contradiction /* from formulas */
        next
          case case_5
          by contradiction /* from formulas */
        qed
      next
        case case_2
        solve( !Ltk( $C, ~ltkC ) ▶₂ #i )
          case Register_pk
          by solve( SecretPSK( $A,
                               Expand(Extract('0',
                                              Extract(p_gxy,
                                                      Extract(Expand(ms, <'rms', h(messages)>, '32'), '0'))),
                                      <'serverats', 
                                       h(<
                                          <
                                           <
                                            <
                                             <
                                              <
                                               <'0', '1', '0x0303', ~tid, '0', $cipher_suites, '0', 
                                                <'43', '0x0304'>, <'10', $g, $g2>, <'40', $g, $g^~x>, 
                                                <'45', '0', '1'>, <'42', '0'>, '41', 
                                                <p_psk_id, mask(ticket_age_add, $ticket_age)>, 
                                                hmac(<
                                                      Expand(Expand(Extract(Expand(ms, <'rms', h(messages)>,
                                                                                   '32'),
                                                                            '0'),
                                                                    <'res', 'pbk'>, '32'),
                                                             <'0', '0'>, '32'), 
                                                      h(<'0', '1', '0x0303', ~tid, '0', $cipher_suites, '0', 
                                                         <'43', '0x0304'>, <'10', $g, $g2>, 
                                                         <'40', $g, $g^~x>, <'45', '0', '1'>, <'42', '0'>, 
                                                         '41', <p_psk_id, mask(ticket_age_add, $ticket_age)>, 
                                                         '0'>)
                                                     >)
                                               >, 
                                               '2', '0x0303', p_ns, $cipher_suite, <'13', $sig_algs>, '40', 
                                               $g, p_gy>, 
                                              '8', $exts>, 
                                             '13', '0', $certificate_extensions>, 
                                            '11', '0', pk(~ltkS)>, 
                                           '15', 
                                           sign(<'server_cv', 
                                                 h(<
                                                    <
                                                     <
                                                      <
                                                       <'0', '1', '0x0303', ~tid, '0', $cipher_suites, '0', 
                                                        <'43', '0x0304'>, <'10', $g, $g2>, <'40', $g, $g^~x>, 
                                                        <'45', '0', '1'>, <'42', '0'>, '41', 
                                                        <p_psk_id, mask(ticket_age_add, $ticket_age)>, 
                                                        hmac(<
                                                              Expand(Expand(Extract(Expand(ms,
                                                                                           <'rms', h(messages)
                                                                                           >,
                                                                                           '32'),
                                                                                    '0'),
                                                                            <'res', 'pbk'>, '32'),
                                                                     <'0', '0'>, '32'), 
                                                              h(<'0', '1', '0x0303', ~tid, '0', 
                                                                 $cipher_suites, '0', <'43', '0x0304'>, 
                                                                 <'10', $g, $g2>, <'40', $g, $g^~x>, 
                                                                 <'45', '0', '1'>, <'42', '0'>, '41', 
                                                                 <p_psk_id, mask(ticket_age_add, $ticket_age)
                                                                 >, 
                                                                 '0'>)
                                                             >)
                                                       >, 
                                                       '2', '0x0303', p_ns, $cipher_suite, <'13', $sig_algs>, 
                                                       '40', $g, p_gy>, 
                                                      '8', $exts>, 
                                                     '13', '0', $certificate_extensions>, 
                                                    '11', '0', pk(~ltkS)>)
                                                >,
                                                ~ltkS)
                                          >, 
                                          '20', 
                                          hmac(<
                                                Expand(Expand(Extract(p_gxy,
                                                                      Extract(Expand(ms, <'rms', h(messages)>,
                                                                                     '32'),
                                                                              '0')),
                                                              <'serverhts', 
                                                               h(<
                                                                  <
                                                                   <
                                                                    <
                                                                     <
                                                                      <'0', '1', '0x0303', ~tid, '0', 
                                                                       $cipher_suites, '0', <'43', '0x0304'>, 
                                                                       <'10', $g, $g2>, <'40', $g, $g^~x>, 
                                                                       <'45', '0', '1'>, <'42', '0'>, '41', 
                                                                       <p_psk_id, 
                                                                        mask(ticket_age_add, $ticket_age)>, 
                                                                       hmac(<
                                                                             Expand(Expand(Extract(Expand(ms,
                                                                                                          <
                                                                                                           'rms', 
                                                                                                           h(messages)
                                                                                                          >,
                                                                                                          '32'),
                                                                                                   '0'),
                                                                                           <'res', 'pbk'>,
                                                                                           '32'),
                                                                                    <'0', '0'>, '32'), 
                                                                             h(<'0', '1', '0x0303', ~tid, 
                                                                                '0', $cipher_suites, '0', 
                                                                                <'43', '0x0304'>, 
                                                                                <'10', $g, $g2>, 
                                                                                <'40', $g, $g^~x>, 
                                                                                <'45', '0', '1'>, 
                                                                                <'42', '0'>, '41', 
                                                                                <p_psk_id, 
                                                                                 mask(ticket_age_add,
                                                                                      $ticket_age)
                                                                                >, 
                                                                                '0'>)
                                                                            >)
                                                                      >, 
                                                                      '2', '0x0303', p_ns, $cipher_suite, 
                                                                      <'13', $sig_algs>, '40', $g, p_gy>, 
                                                                     '8', $exts>, 
                                                                    '13', '0', $certificate_extensions>, 
                                                                   '11', '0', pk(~ltkS)>, 
                                                                  '15', 
                                                                  sign(<'server_cv', 
                                                                        h(<
                                                                           <
                                                                            <
                                                                             <
                                                                              <'0', '1', '0x0303', ~tid, '0', 
                                                                               $cipher_suites, '0', 
                                                                               <'43', '0x0304'>, 
                                                                               <'10', $g, $g2>, 
                                                                               <'40', $g, $g^~x>, 
                                                                               <'45', '0', '1'>, <'42', '0'>, 
                                                                               '41', 
                                                                               <p_psk_id, 
                                                                                mask(ticket_age_add,
                                                                                     $ticket_age)
                                                                               >, 
                                                                               hmac(<
                                                                                     Expand(Expand(Extract(Expand(ms,
                                                                                                                  <
                                                                                                                   'rms', 
                                                                                                                   h(messages)
                                                                                                                  >,
                                                                                                                  '32'),
                                                                                                           '0'),
                                                                                                   <'res', 
                                                                                                    'pbk'>,
                                                                                                   '32'),
                                                                                            <'0', '0'>,
                                                                                            '32'), 
                                                                                     h(<'0', '1', '0x0303', 
                                                                                        ~tid, '0', 
                                                                                        $cipher_suites, '0', 
                                                                                        <'43', '0x0304'>, 
                                                                                        <'10', $g, $g2>, 
                                                                                        <'40', $g, $g^~x>, 
                                                                                        <'45', '0', '1'>, 
                                                                                        <'42', '0'>, '41', 
                                                                                        <p_psk_id, 
                                                                                         mask(ticket_age_add,
                                                                                              $ticket_age)
                                                                                        >, 
                                                                                        '0'>)
                                                                                    >)
                                                                              >, 
                                                                              '2', '0x0303', p_ns, 
                                                                              $cipher_suite, 
                                                                              <'13', $sig_algs>, '40', $g, 
                                                                              p_gy>, 
                                                                             '8', $exts>, 
                                                                            '13', '0', $certificate_extensions
                                                                           >, 
                                                                           '11', '0', pk(~ltkS)>)
                                                                       >,
                                                                       ~ltkS)
                                                                 >)
                                                              >,
                                                              '32'),
                                                       <'fin', '0'>, '32'), 
                                                h(<
                                                   <
                                                    <
                                                     <
                                                      <
                                                       <'0', '1', '0x0303', ~tid, '0', $cipher_suites, '0', 
                                                        <'43', '0x0304'>, <'10', $g, $g2>, <'40', $g, $g^~x>, 
                                                        <'45', '0', '1'>, <'42', '0'>, '41', 
                                                        <p_psk_id, mask(ticket_age_add, $ticket_age)>, 
                                                        hmac(<
                                                              Expand(Expand(Extract(Expand(ms,
                                                                                           <'rms', h(messages)
                                                                                           >,
                                                                                           '32'),
                                                                                    '0'),
                                                                            <'res', 'pbk'>, '32'),
                                                                     <'0', '0'>, '32'), 
                                                              h(<'0', '1', '0x0303', ~tid, '0', 
                                                                 $cipher_suites, '0', <'43', '0x0304'>, 
                                                                 <'10', $g, $g2>, <'40', $g, $g^~x>, 
                                                                 <'45', '0', '1'>, <'42', '0'>, '41', 
                                                                 <p_psk_id, mask(ticket_age_add, $ticket_age)
                                                                 >, 
                                                                 '0'>)
                                                             >)
                                                       >, 
                                                       '2', '0x0303', p_ns, $cipher_suite, <'13', $sig_algs>, 
                                                       '40', $g, p_gy>, 
                                                      '8', $exts>, 
                                                     '13', '0', $certificate_extensions>, 
                                                    '11', '0', pk(~ltkS)>, 
                                                   '15', 
                                                   sign(<'server_cv', 
                                                         h(<
                                                            <
                                                             <
                                                              <
                                                               <'0', '1', '0x0303', ~tid, '0', 
                                                                $cipher_suites, '0', <'43', '0x0304'>, 
                                                                <'10', $g, $g2>, <'40', $g, $g^~x>, 
                                                                <'45', '0', '1'>, <'42', '0'>, '41', 
                                                                <p_psk_id, mask(ticket_age_add, $ticket_age)
                                                                >, 
                                                                hmac(<
                                                                      Expand(Expand(Extract(Expand(ms,
                                                                                                   <'rms', 
                                                                                                    h(messages)
                                                                                                   >,
                                                                                                   '32'),
                                                                                            '0'),
                                                                                    <'res', 'pbk'>, '32'),
                                                                             <'0', '0'>, '32'), 
                                                                      h(<'0', '1', '0x0303', ~tid, '0', 
                                                                         $cipher_suites, '0', 
                                                                         <'43', '0x0304'>, <'10', $g, $g2>, 
                                                                         <'40', $g, $g^~x>, <'45', '0', '1'>, 
                                                                         <'42', '0'>, '41', 
                                                                         <p_psk_id, 
                                                                          mask(ticket_age_add, $ticket_age)>, 
                                                                         '0'>)
                                                                     >)
                                                               >, 
                                                               '2', '0x0303', p_ns, $cipher_suite, 
                                                               <'13', $sig_algs>, '40', $g, p_gy>, 
                                                              '8', $exts>, 
                                                             '13', '0', $certificate_extensions>, 
                                                            '11', '0', pk(~ltkS)>)
                                                        >,
                                                        ~ltkS)
                                                  >)
                                               >)
                                         >)
                                      >,
                                      '32')
                    ) ▶₀ #l )
        qed
      qed
    next
      case recv_server_auth_case_07
      solve( (∃ #j.2.
               (!KU( Extract('0', Extract(p_gxy, Extract(~res_psk, '0'))) ) @ #j.2)
              ∧
               #j.2 < #j.1)  ∥
             ((∀ #k.
                (!KU( Extract('0', Extract(p_gxy, Extract(~res_psk, '0'))) ) @ #k)
               ⇒
                ¬(#k < #j.1)) ∧
              (∃ actor #l.
                (RevealPSK( actor,
                            Expand(Extract('0', Extract(p_gxy, Extract(~res_psk, '0'))),
                                   <'serverats', 
                                    h(<
                                       <
                                        <
                                         <
                                          <
                                           <
                                            <
                                             <
                                              <'0', '1', '0x0303', ~tid, '0', $cipher_suites, '0', 
                                               <'43', '0x0304'>, <'10', $g1, $g>, <'40', $g1, $g1^~x>, 
                                               <'45', '0', '1'>, <'42', '0'>, '41', 
                                               <~ticket, mask(~ticket_age_add, $ticket_age)>, 
                                               hmac(<
                                                     Expand(Expand(Extract(~res_psk, '0'), <'ext', 'pbk'>,
                                                                   '32'),
                                                            <'0', '0'>, '32'), 
                                                     h(<'0', '1', '0x0303', ~tid, '0', $cipher_suites, '0', 
                                                        <'43', '0x0304'>, <'10', $g1, $g>, 
                                                        <'40', $g1, $g1^~x>, <'45', '0', '1'>, <'42', '0'>, 
                                                        '41', <~ticket, mask(~ticket_age_add, $ticket_age)>, 
                                                        '0'>)
                                                    >)
                                              >, 
                                              '6', '0x0303', '40', $g>, 
                                             '1', '0x0303', ~new_nc, '0', $cipher_suites.1, '0', 
                                             <'43', '0x0304'>, <'10', $g1, $g>, <'40', $g, $g^~x.1>, 
                                             <'45', '0', '1'>, '0', '41', 
                                             <~ticket, mask(~ticket_age_add, '1')>, 
                                             hmac(<
                                                   Expand(Expand(Extract(~res_psk, '0'), <'ext', 'pbk'>,
                                                                 '32'),
                                                          <'0', '0'>, '32'), 
                                                   h(<
                                                      <
                                                       <'0', '1', '0x0303', ~tid, '0', $cipher_suites, '0', 
                                                        <'43', '0x0304'>, <'10', $g1, $g>, 
                                                        <'40', $g1, $g1^~x>, <'45', '0', '1'>, <'42', '0'>, 
                                                        '41', <~ticket, mask(~ticket_age_add, $ticket_age)>, 
                                                        hmac(<
                                                              Expand(Expand(Extract(~res_psk, '0'),
                                                                            <'ext', 'pbk'>, '32'),
                                                                     <'0', '0'>, '32'), 
                                                              h(<'0', '1', '0x0303', ~tid, '0', 
                                                                 $cipher_suites, '0', <'43', '0x0304'>, 
                                                                 <'10', $g1, $g>, <'40', $g1, $g1^~x>, 
                                                                 <'45', '0', '1'>, <'42', '0'>, '41', 
                                                                 <~ticket, mask(~ticket_age_add, $ticket_age)
                                                                 >, 
                                                                 '0'>)
                                                             >)
                                                       >, 
                                                       '6', '0x0303', '40', $g>, 
                                                      '1', '0x0303', ~new_nc, '0', $cipher_suites.1, '0', 
                                                      <'43', '0x0304'>, <'10', $g1, $g>, <'40', $g, $g^~x.1>, 
                                                      <'45', '0', '1'>, '0', '41', 
                                                      <~ticket, mask(~ticket_age_add, '1')>, '0'>)
                                                  >)
                                            >, 
                                            '2', '0x0303', p_ns, $cipher_suite, <'13', $sig_algs>, '40', $g, 
                                            p_gy>, 
                                           '8', $exts>, 
                                          '13', '0', $certificate_extensions>, 
                                         '11', '0', pk(~ltkS)>, 
                                        '15', 
                                        sign(<'server_cv', 
                                              h(<
                                                 <
                                                  <
                                                   <
                                                    <
                                                     <
                                                      <'0', '1', '0x0303', ~tid, '0', $cipher_suites, '0', 
                                                       <'43', '0x0304'>, <'10', $g1, $g>, 
                                                       <'40', $g1, $g1^~x>, <'45', '0', '1'>, <'42', '0'>, 
                                                       '41', <~ticket, mask(~ticket_age_add, $ticket_age)>, 
                                                       hmac(<
                                                             Expand(Expand(Extract(~res_psk, '0'),
                                                                           <'ext', 'pbk'>, '32'),
                                                                    <'0', '0'>, '32'), 
                                                             h(<'0', '1', '0x0303', ~tid, '0', 
                                                                $cipher_suites, '0', <'43', '0x0304'>, 
                                                                <'10', $g1, $g>, <'40', $g1, $g1^~x>, 
                                                                <'45', '0', '1'>, <'42', '0'>, '41', 
                                                                <~ticket, mask(~ticket_age_add, $ticket_age)
                                                                >, 
                                                                '0'>)
                                                            >)
                                                      >, 
                                                      '6', '0x0303', '40', $g>, 
                                                     '1', '0x0303', ~new_nc, '0', $cipher_suites.1, '0', 
                                                     <'43', '0x0304'>, <'10', $g1, $g>, <'40', $g, $g^~x.1>, 
                                                     <'45', '0', '1'>, '0', '41', 
                                                     <~ticket, mask(~ticket_age_add, '1')>, 
                                                     hmac(<
                                                           Expand(Expand(Extract(~res_psk, '0'),
                                                                         <'ext', 'pbk'>, '32'),
                                                                  <'0', '0'>, '32'), 
                                                           h(<
                                                              <
                                                               <'0', '1', '0x0303', ~tid, '0', 
                                                                $cipher_suites, '0', <'43', '0x0304'>, 
                                                                <'10', $g1, $g>, <'40', $g1, $g1^~x>, 
                                                                <'45', '0', '1'>, <'42', '0'>, '41', 
                                                                <~ticket, mask(~ticket_age_add, $ticket_age)
                                                                >, 
                                                                hmac(<
                                                                      Expand(Expand(Extract(~res_psk, '0'),
                                                                                    <'ext', 'pbk'>, '32'),
                                                                             <'0', '0'>, '32'), 
                                                                      h(<'0', '1', '0x0303', ~tid, '0', 
                                                                         $cipher_suites, '0', 
                                                                         <'43', '0x0304'>, <'10', $g1, $g>, 
                                                                         <'40', $g1, $g1^~x>, 
                                                                         <'45', '0', '1'>, <'42', '0'>, '41', 
                                                                         <~ticket, 
                                                                          mask(~ticket_age_add, $ticket_age)
                                                                         >, 
                                                                         '0'>)
                                                                     >)
                                                               >, 
                                                               '6', '0x0303', '40', $g>, 
                                                              '1', '0x0303', ~new_nc, '0', $cipher_suites.1, 
                                                              '0', <'43', '0x0304'>, <'10', $g1, $g>, 
                                                              <'40', $g, $g^~x.1>, <'45', '0', '1'>, '0', 
                                                              '41', <~ticket, mask(~ticket_age_add, '1')>, '0'
                                                             >)
                                                          >)
                                                    >, 
                                                    '2', '0x0303', p_ns, $cipher_suite, <'13', $sig_algs>, 
                                                    '40', $g, p_gy>, 
                                                   '8', $exts>, 
                                                  '13', '0', $certificate_extensions>, 
                                                 '11', '0', pk(~ltkS)>)
                                             >,
                                             ~ltkS)
                                       >, 
                                       '20', 
                                       hmac(<
                                             Expand(Expand(Extract(p_gxy, Extract(~res_psk, '0')),
                                                           <'serverhts', 
                                                            h(<
                                                               <
                                                                <
                                                                 <
                                                                  <
                                                                   <
                                                                    <
                                                                     <'0', '1', '0x0303', ~tid, '0', 
                                                                      $cipher_suites, '0', <'43', '0x0304'>, 
                                                                      <'10', $g1, $g>, <'40', $g1, $g1^~x>, 
                                                                      <'45', '0', '1'>, <'42', '0'>, '41', 
                                                                      <~ticket, 
                                                                       mask(~ticket_age_add, $ticket_age)>, 
                                                                      hmac(<
                                                                            Expand(Expand(Extract(~res_psk,
                                                                                                  '0'),
                                                                                          <'ext', 'pbk'>,
                                                                                          '32'),
                                                                                   <'0', '0'>, '32'), 
                                                                            h(<'0', '1', '0x0303', ~tid, '0', 
                                                                               $cipher_suites, '0', 
                                                                               <'43', '0x0304'>, 
                                                                               <'10', $g1, $g>, 
                                                                               <'40', $g1, $g1^~x>, 
                                                                               <'45', '0', '1'>, <'42', '0'>, 
                                                                               '41', 
                                                                               <~ticket, 
                                                                                mask(~ticket_age_add,
                                                                                     $ticket_age)
                                                                               >, 
                                                                               '0'>)
                                                                           >)
                                                                     >, 
                                                                     '6', '0x0303', '40', $g>, 
                                                                    '1', '0x0303', ~new_nc, '0', 
                                                                    $cipher_suites.1, '0', <'43', '0x0304'>, 
                                                                    <'10', $g1, $g>, <'40', $g, $g^~x.1>, 
                                                                    <'45', '0', '1'>, '0', '41', 
                                                                    <~ticket, mask(~ticket_age_add, '1')>, 
                                                                    hmac(<
                                                                          Expand(Expand(Extract(~res_psk,
                                                                                                '0'),
                                                                                        <'ext', 'pbk'>, '32'),
                                                                                 <'0', '0'>, '32'), 
                                                                          h(<
                                                                             <
                                                                              <'0', '1', '0x0303', ~tid, '0', 
                                                                               $cipher_suites, '0', 
                                                                               <'43', '0x0304'>, 
                                                                               <'10', $g1, $g>, 
                                                                               <'40', $g1, $g1^~x>, 
                                                                               <'45', '0', '1'>, <'42', '0'>, 
                                                                               '41', 
                                                                               <~ticket, 
                                                                                mask(~ticket_age_add,
                                                                                     $ticket_age)
                                                                               >, 
                                                                               hmac(<
                                                                                     Expand(Expand(Extract(~res_psk,
                                                                                                           '0'),
                                                                                                   <'ext', 
                                                                                                    'pbk'>,
                                                                                                   '32'),
                                                                                            <'0', '0'>,
                                                                                            '32'), 
                                                                                     h(<'0', '1', '0x0303', 
                                                                                        ~tid, '0', 
                                                                                        $cipher_suites, '0', 
                                                                                        <'43', '0x0304'>, 
                                                                                        <'10', $g1, $g>, 
                                                                                        <'40', $g1, $g1^~x>, 
                                                                                        <'45', '0', '1'>, 
                                                                                        <'42', '0'>, '41', 
                                                                                        <~ticket, 
                                                                                         mask(~ticket_age_add,
                                                                                              $ticket_age)
                                                                                        >, 
                                                                                        '0'>)
                                                                                    >)
                                                                              >, 
                                                                              '6', '0x0303', '40', $g>, 
                                                                             '1', '0x0303', ~new_nc, '0', 
                                                                             $cipher_suites.1, '0', 
                                                                             <'43', '0x0304'>, 
                                                                             <'10', $g1, $g>, 
                                                                             <'40', $g, $g^~x.1>, 
                                                                             <'45', '0', '1'>, '0', '41', 
                                                                             <~ticket, 
                                                                              mask(~ticket_age_add, '1')>, 
                                                                             '0'>)
                                                                         >)
                                                                   >, 
                                                                   '2', '0x0303', p_ns, $cipher_suite, 
                                                                   <'13', $sig_algs>, '40', $g, p_gy>, 
                                                                  '8', $exts>, 
                                                                 '13', '0', $certificate_extensions>, 
                                                                '11', '0', pk(~ltkS)>, 
                                                               '15', 
                                                               sign(<'server_cv', 
                                                                     h(<
                                                                        <
                                                                         <
                                                                          <
                                                                           <
                                                                            <
                                                                             <'0', '1', '0x0303', ~tid, '0', 
                                                                              $cipher_suites, '0', 
                                                                              <'43', '0x0304'>, 
                                                                              <'10', $g1, $g>, 
                                                                              <'40', $g1, $g1^~x>, 
                                                                              <'45', '0', '1'>, <'42', '0'>, 
                                                                              '41', 
                                                                              <~ticket, 
                                                                               mask(~ticket_age_add,
                                                                                    $ticket_age)
                                                                              >, 
                                                                              hmac(<
                                                                                    Expand(Expand(Extract(~res_psk,
                                                                                                          '0'),
                                                                                                  <'ext', 
                                                                                                   'pbk'>,
                                                                                                  '32'),
                                                                                           <'0', '0'>, '32'), 
                                                                                    h(<'0', '1', '0x0303', 
                                                                                       ~tid, '0', 
                                                                                       $cipher_suites, '0', 
                                                                                       <'43', '0x0304'>, 
                                                                                       <'10', $g1, $g>, 
                                                                                       <'40', $g1, $g1^~x>, 
                                                                                       <'45', '0', '1'>, 
                                                                                       <'42', '0'>, '41', 
                                                                                       <~ticket, 
                                                                                        mask(~ticket_age_add,
                                                                                             $ticket_age)
                                                                                       >, 
                                                                                       '0'>)
                                                                                   >)
                                                                             >, 
                                                                             '6', '0x0303', '40', $g>, 
                                                                            '1', '0x0303', ~new_nc, '0', 
                                                                            $cipher_suites.1, '0', 
                                                                            <'43', '0x0304'>, 
                                                                            <'10', $g1, $g>, 
                                                                            <'40', $g, $g^~x.1>, 
                                                                            <'45', '0', '1'>, '0', '41', 
                                                                            <~ticket, 
                                                                             mask(~ticket_age_add, '1')>, 
                                                                            hmac(<
                                                                                  Expand(Expand(Extract(~res_psk,
                                                                                                        '0'),
                                                                                                <'ext', 'pbk'
                                                                                                >,
                                                                                                '32'),
                                                                                         <'0', '0'>, '32'), 
                                                                                  h(<
                                                                                     <
                                                                                      <'0', '1', '0x0303', 
                                                                                       ~tid, '0', 
                                                                                       $cipher_suites, '0', 
                                                                                       <'43', '0x0304'>, 
                                                                                       <'10', $g1, $g>, 
                                                                                       <'40', $g1, $g1^~x>, 
                                                                                       <'45', '0', '1'>, 
                                                                                       <'42', '0'>, '41', 
                                                                                       <~ticket, 
                                                                                        mask(~ticket_age_add,
                                                                                             $ticket_age)
                                                                                       >, 
                                                                                       hmac(<
                                                                                             Expand(Expand(Extract(~res_psk,
                                                                                                                   '0'),
                                                                                                           <
                                                                                                            'ext', 
                                                                                                            'pbk'
                                                                                                           >,
                                                                                                           '32'),
                                                                                                    <'0', '0'
                                                                                                    >,
                                                                                                    '32'), 
                                                                                             h(<'0', '1', 
                                                                                                '0x0303', 
                                                                                                ~tid, '0', 
                                                                                                $cipher_suites, 
                                                                                                '0', 
                                                                                                <'43', 
                                                                                                 '0x0304'>, 
                                                                                                <'10', $g1, $g
                                                                                                >, 
                                                                                                <'40', $g1, 
                                                                                                 $g1^~x>, 
                                                                                                <'45', '0', 
                                                                                                 '1'>, 
                                                                                                <'42', '0'>, 
                                                                                                '41', 
                                                                                                <~ticket, 
                                                                                                 mask(~ticket_age_add,
                                                                                                      $ticket_age)
                                                                                                >, 
                                                                                                '0'>)
                                                                                            >)
                                                                                      >, 
                                                                                      '6', '0x0303', '40', $g
                                                                                     >, 
                                                                                     '1', '0x0303', ~new_nc, 
                                                                                     '0', $cipher_suites.1, 
                                                                                     '0', <'43', '0x0304'>, 
                                                                                     <'10', $g1, $g>, 
                                                                                     <'40', $g, $g^~x.1>, 
                                                                                     <'45', '0', '1'>, '0', 
                                                                                     '41', 
                                                                                     <~ticket, 
                                                                                      mask(~ticket_age_add,
                                                                                           '1')
                                                                                     >, 
                                                                                     '0'>)
                                                                                 >)
                                                                           >, 
                                                                           '2', '0x0303', p_ns, 
                                                                           $cipher_suite, <'13', $sig_algs>, 
                                                                           '40', $g, p_gy>, 
                                                                          '8', $exts>, 
                                                                         '13', '0', $certificate_extensions>, 
                                                                        '11', '0', pk(~ltkS)>)
                                                                    >,
                                                                    ~ltkS)
                                                              >)
                                                           >,
                                                           '32'),
                                                    <'fin', '0'>, '32'), 
                                             h(<
                                                <
                                                 <
                                                  <
                                                   <
                                                    <
                                                     <
                                                      <'0', '1', '0x0303', ~tid, '0', $cipher_suites, '0', 
                                                       <'43', '0x0304'>, <'10', $g1, $g>, 
                                                       <'40', $g1, $g1^~x>, <'45', '0', '1'>, <'42', '0'>, 
                                                       '41', <~ticket, mask(~ticket_age_add, $ticket_age)>, 
                                                       hmac(<
                                                             Expand(Expand(Extract(~res_psk, '0'),
                                                                           <'ext', 'pbk'>, '32'),
                                                                    <'0', '0'>, '32'), 
                                                             h(<'0', '1', '0x0303', ~tid, '0', 
                                                                $cipher_suites, '0', <'43', '0x0304'>, 
                                                                <'10', $g1, $g>, <'40', $g1, $g1^~x>, 
                                                                <'45', '0', '1'>, <'42', '0'>, '41', 
                                                                <~ticket, mask(~ticket_age_add, $ticket_age)
                                                                >, 
                                                                '0'>)
                                                            >)
                                                      >, 
                                                      '6', '0x0303', '40', $g>, 
                                                     '1', '0x0303', ~new_nc, '0', $cipher_suites.1, '0', 
                                                     <'43', '0x0304'>, <'10', $g1, $g>, <'40', $g, $g^~x.1>, 
                                                     <'45', '0', '1'>, '0', '41', 
                                                     <~ticket, mask(~ticket_age_add, '1')>, 
                                                     hmac(<
                                                           Expand(Expand(Extract(~res_psk, '0'),
                                                                         <'ext', 'pbk'>, '32'),
                                                                  <'0', '0'>, '32'), 
                                                           h(<
                                                              <
                                                               <'0', '1', '0x0303', ~tid, '0', 
                                                                $cipher_suites, '0', <'43', '0x0304'>, 
                                                                <'10', $g1, $g>, <'40', $g1, $g1^~x>, 
                                                                <'45', '0', '1'>, <'42', '0'>, '41', 
                                                                <~ticket, mask(~ticket_age_add, $ticket_age)
                                                                >, 
                                                                hmac(<
                                                                      Expand(Expand(Extract(~res_psk, '0'),
                                                                                    <'ext', 'pbk'>, '32'),
                                                                             <'0', '0'>, '32'), 
                                                                      h(<'0', '1', '0x0303', ~tid, '0', 
                                                                         $cipher_suites, '0', 
                                                                         <'43', '0x0304'>, <'10', $g1, $g>, 
                                                                         <'40', $g1, $g1^~x>, 
                                                                         <'45', '0', '1'>, <'42', '0'>, '41', 
                                                                         <~ticket, 
                                                                          mask(~ticket_age_add, $ticket_age)
                                                                         >, 
                                                                         '0'>)
                                                                     >)
                                                               >, 
                                                               '6', '0x0303', '40', $g>, 
                                                              '1', '0x0303', ~new_nc, '0', $cipher_suites.1, 
                                                              '0', <'43', '0x0304'>, <'10', $g1, $g>, 
                                                              <'40', $g, $g^~x.1>, <'45', '0', '1'>, '0', 
                                                              '41', <~ticket, mask(~ticket_age_add, '1')>, '0'
                                                             >)
                                                          >)
                                                    >, 
                                                    '2', '0x0303', p_ns, $cipher_suite, <'13', $sig_algs>, 
                                                    '40', $g, p_gy>, 
                                                   '8', $exts>, 
                                                  '13', '0', $certificate_extensions>, 
                                                 '11', '0', pk(~ltkS)>, 
                                                '15', 
                                                sign(<'server_cv', 
                                                      h(<
                                                         <
                                                          <
                                                           <
                                                            <
                                                             <
                                                              <'0', '1', '0x0303', ~tid, '0', $cipher_suites, 
                                                               '0', <'43', '0x0304'>, <'10', $g1, $g>, 
                                                               <'40', $g1, $g1^~x>, <'45', '0', '1'>, 
                                                               <'42', '0'>, '41', 
                                                               <~ticket, mask(~ticket_age_add, $ticket_age)>, 
                                                               hmac(<
                                                                     Expand(Expand(Extract(~res_psk, '0'),
                                                                                   <'ext', 'pbk'>, '32'),
                                                                            <'0', '0'>, '32'), 
                                                                     h(<'0', '1', '0x0303', ~tid, '0', 
                                                                        $cipher_suites, '0', 
                                                                        <'43', '0x0304'>, <'10', $g1, $g>, 
                                                                        <'40', $g1, $g1^~x>, 
                                                                        <'45', '0', '1'>, <'42', '0'>, '41', 
                                                                        <~ticket, 
                                                                         mask(~ticket_age_add, $ticket_age)>, 
                                                                        '0'>)
                                                                    >)
                                                              >, 
                                                              '6', '0x0303', '40', $g>, 
                                                             '1', '0x0303', ~new_nc, '0', $cipher_suites.1, 
                                                             '0', <'43', '0x0304'>, <'10', $g1, $g>, 
                                                             <'40', $g, $g^~x.1>, <'45', '0', '1'>, '0', 
                                                             '41', <~ticket, mask(~ticket_age_add, '1')>, 
                                                             hmac(<
                                                                   Expand(Expand(Extract(~res_psk, '0'),
                                                                                 <'ext', 'pbk'>, '32'),
                                                                          <'0', '0'>, '32'), 
                                                                   h(<
                                                                      <
                                                                       <'0', '1', '0x0303', ~tid, '0', 
                                                                        $cipher_suites, '0', 
                                                                        <'43', '0x0304'>, <'10', $g1, $g>, 
                                                                        <'40', $g1, $g1^~x>, 
                                                                        <'45', '0', '1'>, <'42', '0'>, '41', 
                                                                        <~ticket, 
                                                                         mask(~ticket_age_add, $ticket_age)>, 
                                                                        hmac(<
                                                                              Expand(Expand(Extract(~res_psk,
                                                                                                    '0'),
                                                                                            <'ext', 'pbk'>,
                                                                                            '32'),
                                                                                     <'0', '0'>, '32'), 
                                                                              h(<'0', '1', '0x0303', ~tid, 
                                                                                 '0', $cipher_suites, '0', 
                                                                                 <'43', '0x0304'>, 
                                                                                 <'10', $g1, $g>, 
                                                                                 <'40', $g1, $g1^~x>, 
                                                                                 <'45', '0', '1'>, 
                                                                                 <'42', '0'>, '41', 
                                                                                 <~ticket, 
                                                                                  mask(~ticket_age_add,
                                                                                       $ticket_age)
                                                                                 >, 
                                                                                 '0'>)
                                                                             >)
                                                                       >, 
                                                                       '6', '0x0303', '40', $g>, 
                                                                      '1', '0x0303', ~new_nc, '0', 
                                                                      $cipher_suites.1, '0', 
                                                                      <'43', '0x0304'>, <'10', $g1, $g>, 
                                                                      <'40', $g, $g^~x.1>, <'45', '0', '1'>, 
                                                                      '0', '41', 
                                                                      <~ticket, mask(~ticket_age_add, '1')>, 
                                                                      '0'>)
                                                                  >)
                                                            >, 
                                                            '2', '0x0303', p_ns, $cipher_suite, 
                                                            <'13', $sig_algs>, '40', $g, p_gy>, 
                                                           '8', $exts>, 
                                                          '13', '0', $certificate_extensions>, 
                                                         '11', '0', pk(~ltkS)>)
                                                     >,
                                                     ~ltkS)
                                               >)
                                            >)
                                      >)
                                   >,
                                   '32')
                 ) @ #l)
               ∧
                #l < #j.1)) )
        case case_1
        solve( (∃ #r. (RevLtk( $S ) @ #r) ∧ #r < #vr)  ∥
               (∃ tid3 x #r. (RevDHExp( tid3, $S, x ) @ #r) ∧ #r < #vr)  ∥
               (∃ tid4 y #r. (RevDHExp( tid4, $C, y ) @ #r) ∧ #r < #vr)  ∥
               (∃ rms #r. (RevealPSK( $C, rms ) @ #r) ∧ #r < #k.1)  ∥
               (∃ rms #r. (RevealPSK( $S, rms ) @ #r) ∧ #r < #k.1) )
          case case_1
          by contradiction /* from formulas */
        next
          case case_2
          by contradiction /* from formulas */
        next
          case case_3
          by contradiction /* from formulas */
        next
          case case_4
          by contradiction /* from formulas */
        next
          case case_5
          by contradiction /* from formulas */
        qed
      next
        case case_2
        solve( !Ltk( $C, ~ltkC ) ▶₂ #i )
          case Register_pk
          by solve( SecretPSK( $A,
                               Expand(Extract('0', Extract(p_gxy, Extract(~res_psk, '0'))),
                                      <'serverats', 
                                       h(<
                                          <
                                           <
                                            <
                                             <
                                              <
                                               <
                                                <
                                                 <'0', '1', '0x0303', ~tid, '0', $cipher_suites, '0', 
                                                  <'43', '0x0304'>, <'10', $g1, $g>, <'40', $g1, $g1^~x>, 
                                                  <'45', '0', '1'>, <'42', '0'>, '41', 
                                                  <~ticket, mask(~ticket_age_add, $ticket_age)>, 
                                                  hmac(<
                                                        Expand(Expand(Extract(~res_psk, '0'), <'ext', 'pbk'>,
                                                                      '32'),
                                                               <'0', '0'>, '32'), 
                                                        h(<'0', '1', '0x0303', ~tid, '0', $cipher_suites, 
                                                           '0', <'43', '0x0304'>, <'10', $g1, $g>, 
                                                           <'40', $g1, $g1^~x>, <'45', '0', '1'>, 
                                                           <'42', '0'>, '41', 
                                                           <~ticket, mask(~ticket_age_add, $ticket_age)>, '0'
                                                          >)
                                                       >)
                                                 >, 
                                                 '6', '0x0303', '40', $g>, 
                                                '1', '0x0303', ~new_nc, '0', $cipher_suites.1, '0', 
                                                <'43', '0x0304'>, <'10', $g1, $g>, <'40', $g, $g^~x.1>, 
                                                <'45', '0', '1'>, '0', '41', 
                                                <~ticket, mask(~ticket_age_add, '1')>, 
                                                hmac(<
                                                      Expand(Expand(Extract(~res_psk, '0'), <'ext', 'pbk'>,
                                                                    '32'),
                                                             <'0', '0'>, '32'), 
                                                      h(<
                                                         <
                                                          <'0', '1', '0x0303', ~tid, '0', $cipher_suites, 
                                                           '0', <'43', '0x0304'>, <'10', $g1, $g>, 
                                                           <'40', $g1, $g1^~x>, <'45', '0', '1'>, 
                                                           <'42', '0'>, '41', 
                                                           <~ticket, mask(~ticket_age_add, $ticket_age)>, 
                                                           hmac(<
                                                                 Expand(Expand(Extract(~res_psk, '0'),
                                                                               <'ext', 'pbk'>, '32'),
                                                                        <'0', '0'>, '32'), 
                                                                 h(<'0', '1', '0x0303', ~tid, '0', 
                                                                    $cipher_suites, '0', <'43', '0x0304'>, 
                                                                    <'10', $g1, $g>, <'40', $g1, $g1^~x>, 
                                                                    <'45', '0', '1'>, <'42', '0'>, '41', 
                                                                    <~ticket, 
                                                                     mask(~ticket_age_add, $ticket_age)>, 
                                                                    '0'>)
                                                                >)
                                                          >, 
                                                          '6', '0x0303', '40', $g>, 
                                                         '1', '0x0303', ~new_nc, '0', $cipher_suites.1, '0', 
                                                         <'43', '0x0304'>, <'10', $g1, $g>, 
                                                         <'40', $g, $g^~x.1>, <'45', '0', '1'>, '0', '41', 
                                                         <~ticket, mask(~ticket_age_add, '1')>, '0'>)
                                                     >)
                                               >, 
                                               '2', '0x0303', p_ns, $cipher_suite, <'13', $sig_algs>, '40', 
                                               $g, p_gy>, 
                                              '8', $exts>, 
                                             '13', '0', $certificate_extensions>, 
                                            '11', '0', pk(~ltkS)>, 
                                           '15', 
                                           sign(<'server_cv', 
                                                 h(<
                                                    <
                                                     <
                                                      <
                                                       <
                                                        <
                                                         <'0', '1', '0x0303', ~tid, '0', $cipher_suites, '0', 
                                                          <'43', '0x0304'>, <'10', $g1, $g>, 
                                                          <'40', $g1, $g1^~x>, <'45', '0', '1'>, <'42', '0'>, 
                                                          '41', 
                                                          <~ticket, mask(~ticket_age_add, $ticket_age)>, 
                                                          hmac(<
                                                                Expand(Expand(Extract(~res_psk, '0'),
                                                                              <'ext', 'pbk'>, '32'),
                                                                       <'0', '0'>, '32'), 
                                                                h(<'0', '1', '0x0303', ~tid, '0', 
                                                                   $cipher_suites, '0', <'43', '0x0304'>, 
                                                                   <'10', $g1, $g>, <'40', $g1, $g1^~x>, 
                                                                   <'45', '0', '1'>, <'42', '0'>, '41', 
                                                                   <~ticket, 
                                                                    mask(~ticket_age_add, $ticket_age)>, 
                                                                   '0'>)
                                                               >)
                                                         >, 
                                                         '6', '0x0303', '40', $g>, 
                                                        '1', '0x0303', ~new_nc, '0', $cipher_suites.1, '0', 
                                                        <'43', '0x0304'>, <'10', $g1, $g>, 
                                                        <'40', $g, $g^~x.1>, <'45', '0', '1'>, '0', '41', 
                                                        <~ticket, mask(~ticket_age_add, '1')>, 
                                                        hmac(<
                                                              Expand(Expand(Extract(~res_psk, '0'),
                                                                            <'ext', 'pbk'>, '32'),
                                                                     <'0', '0'>, '32'), 
                                                              h(<
                                                                 <
                                                                  <'0', '1', '0x0303', ~tid, '0', 
                                                                   $cipher_suites, '0', <'43', '0x0304'>, 
                                                                   <'10', $g1, $g>, <'40', $g1, $g1^~x>, 
                                                                   <'45', '0', '1'>, <'42', '0'>, '41', 
                                                                   <~ticket, 
                                                                    mask(~ticket_age_add, $ticket_age)>, 
                                                                   hmac(<
                                                                         Expand(Expand(Extract(~res_psk, '0'),
                                                                                       <'ext', 'pbk'>, '32'),
                                                                                <'0', '0'>, '32'), 
                                                                         h(<'0', '1', '0x0303', ~tid, '0', 
                                                                            $cipher_suites, '0', 
                                                                            <'43', '0x0304'>, 
                                                                            <'10', $g1, $g>, 
                                                                            <'40', $g1, $g1^~x>, 
                                                                            <'45', '0', '1'>, <'42', '0'>, 
                                                                            '41', 
                                                                            <~ticket, 
                                                                             mask(~ticket_age_add,
                                                                                  $ticket_age)
                                                                            >, 
                                                                            '0'>)
                                                                        >)
                                                                  >, 
                                                                  '6', '0x0303', '40', $g>, 
                                                                 '1', '0x0303', ~new_nc, '0', 
                                                                 $cipher_suites.1, '0', <'43', '0x0304'>, 
                                                                 <'10', $g1, $g>, <'40', $g, $g^~x.1>, 
                                                                 <'45', '0', '1'>, '0', '41', 
                                                                 <~ticket, mask(~ticket_age_add, '1')>, '0'>)
                                                             >)
                                                       >, 
                                                       '2', '0x0303', p_ns, $cipher_suite, <'13', $sig_algs>, 
                                                       '40', $g, p_gy>, 
                                                      '8', $exts>, 
                                                     '13', '0', $certificate_extensions>, 
                                                    '11', '0', pk(~ltkS)>)
                                                >,
                                                ~ltkS)
                                          >, 
                                          '20', 
                                          hmac(<
                                                Expand(Expand(Extract(p_gxy, Extract(~res_psk, '0')),
                                                              <'serverhts', 
                                                               h(<
                                                                  <
                                                                   <
                                                                    <
                                                                     <
                                                                      <
                                                                       <
                                                                        <'0', '1', '0x0303', ~tid, '0', 
                                                                         $cipher_suites, '0', 
                                                                         <'43', '0x0304'>, <'10', $g1, $g>, 
                                                                         <'40', $g1, $g1^~x>, 
                                                                         <'45', '0', '1'>, <'42', '0'>, '41', 
                                                                         <~ticket, 
                                                                          mask(~ticket_age_add, $ticket_age)
                                                                         >, 
                                                                         hmac(<
                                                                               Expand(Expand(Extract(~res_psk,
                                                                                                     '0'),
                                                                                             <'ext', 'pbk'>,
                                                                                             '32'),
                                                                                      <'0', '0'>, '32'), 
                                                                               h(<'0', '1', '0x0303', ~tid, 
                                                                                  '0', $cipher_suites, '0', 
                                                                                  <'43', '0x0304'>, 
                                                                                  <'10', $g1, $g>, 
                                                                                  <'40', $g1, $g1^~x>, 
                                                                                  <'45', '0', '1'>, 
                                                                                  <'42', '0'>, '41', 
                                                                                  <~ticket, 
                                                                                   mask(~ticket_age_add,
                                                                                        $ticket_age)
                                                                                  >, 
                                                                                  '0'>)
                                                                              >)
                                                                        >, 
                                                                        '6', '0x0303', '40', $g>, 
                                                                       '1', '0x0303', ~new_nc, '0', 
                                                                       $cipher_suites.1, '0', 
                                                                       <'43', '0x0304'>, <'10', $g1, $g>, 
                                                                       <'40', $g, $g^~x.1>, <'45', '0', '1'>, 
                                                                       '0', '41', 
                                                                       <~ticket, mask(~ticket_age_add, '1')>, 
                                                                       hmac(<
                                                                             Expand(Expand(Extract(~res_psk,
                                                                                                   '0'),
                                                                                           <'ext', 'pbk'>,
                                                                                           '32'),
                                                                                    <'0', '0'>, '32'), 
                                                                             h(<
                                                                                <
                                                                                 <'0', '1', '0x0303', ~tid, 
                                                                                  '0', $cipher_suites, '0', 
                                                                                  <'43', '0x0304'>, 
                                                                                  <'10', $g1, $g>, 
                                                                                  <'40', $g1, $g1^~x>, 
                                                                                  <'45', '0', '1'>, 
                                                                                  <'42', '0'>, '41', 
                                                                                  <~ticket, 
                                                                                   mask(~ticket_age_add,
                                                                                        $ticket_age)
                                                                                  >, 
                                                                                  hmac(<
                                                                                        Expand(Expand(Extract(~res_psk,
                                                                                                              '0'),
                                                                                                      <'ext', 
                                                                                                       'pbk'>,
                                                                                                      '32'),
                                                                                               <'0', '0'>,
                                                                                               '32'), 
                                                                                        h(<'0', '1', 
                                                                                           '0x0303', ~tid, 
                                                                                           '0', 
                                                                                           $cipher_suites, 
                                                                                           '0', 
                                                                                           <'43', '0x0304'>, 
                                                                                           <'10', $g1, $g>, 
                                                                                           <'40', $g1, $g1^~x
                                                                                           >, 
                                                                                           <'45', '0', '1'>, 
                                                                                           <'42', '0'>, '41', 
                                                                                           <~ticket, 
                                                                                            mask(~ticket_age_add,
                                                                                                 $ticket_age)
                                                                                           >, 
                                                                                           '0'>)
                                                                                       >)
                                                                                 >, 
                                                                                 '6', '0x0303', '40', $g>, 
                                                                                '1', '0x0303', ~new_nc, '0', 
                                                                                $cipher_suites.1, '0', 
                                                                                <'43', '0x0304'>, 
                                                                                <'10', $g1, $g>, 
                                                                                <'40', $g, $g^~x.1>, 
                                                                                <'45', '0', '1'>, '0', '41', 
                                                                                <~ticket, 
                                                                                 mask(~ticket_age_add, '1')>, 
                                                                                '0'>)
                                                                            >)
                                                                      >, 
                                                                      '2', '0x0303', p_ns, $cipher_suite, 
                                                                      <'13', $sig_algs>, '40', $g, p_gy>, 
                                                                     '8', $exts>, 
                                                                    '13', '0', $certificate_extensions>, 
                                                                   '11', '0', pk(~ltkS)>, 
                                                                  '15', 
                                                                  sign(<'server_cv', 
                                                                        h(<
                                                                           <
                                                                            <
                                                                             <
                                                                              <
                                                                               <
                                                                                <'0', '1', '0x0303', ~tid, 
                                                                                 '0', $cipher_suites, '0', 
                                                                                 <'43', '0x0304'>, 
                                                                                 <'10', $g1, $g>, 
                                                                                 <'40', $g1, $g1^~x>, 
                                                                                 <'45', '0', '1'>, 
                                                                                 <'42', '0'>, '41', 
                                                                                 <~ticket, 
                                                                                  mask(~ticket_age_add,
                                                                                       $ticket_age)
                                                                                 >, 
                                                                                 hmac(<
                                                                                       Expand(Expand(Extract(~res_psk,
                                                                                                             '0'),
                                                                                                     <'ext', 
                                                                                                      'pbk'>,
                                                                                                     '32'),
                                                                                              <'0', '0'>,
                                                                                              '32'), 
                                                                                       h(<'0', '1', '0x0303', 
                                                                                          ~tid, '0', 
                                                                                          $cipher_suites, 
                                                                                          '0', 
                                                                                          <'43', '0x0304'>, 
                                                                                          <'10', $g1, $g>, 
                                                                                          <'40', $g1, $g1^~x
                                                                                          >, 
                                                                                          <'45', '0', '1'>, 
                                                                                          <'42', '0'>, '41', 
                                                                                          <~ticket, 
                                                                                           mask(~ticket_age_add,
                                                                                                $ticket_age)
                                                                                          >, 
                                                                                          '0'>)
                                                                                      >)
                                                                                >, 
                                                                                '6', '0x0303', '40', $g>, 
                                                                               '1', '0x0303', ~new_nc, '0', 
                                                                               $cipher_suites.1, '0', 
                                                                               <'43', '0x0304'>, 
                                                                               <'10', $g1, $g>, 
                                                                               <'40', $g, $g^~x.1>, 
                                                                               <'45', '0', '1'>, '0', '41', 
                                                                               <~ticket, 
                                                                                mask(~ticket_age_add, '1')>, 
                                                                               hmac(<
                                                                                     Expand(Expand(Extract(~res_psk,
                                                                                                           '0'),
                                                                                                   <'ext', 
                                                                                                    'pbk'>,
                                                                                                   '32'),
                                                                                            <'0', '0'>,
                                                                                            '32'), 
                                                                                     h(<
                                                                                        <
                                                                                         <'0', '1', '0x0303', 
                                                                                          ~tid, '0', 
                                                                                          $cipher_suites, 
                                                                                          '0', 
                                                                                          <'43', '0x0304'>, 
                                                                                          <'10', $g1, $g>, 
                                                                                          <'40', $g1, $g1^~x
                                                                                          >, 
                                                                                          <'45', '0', '1'>, 
                                                                                          <'42', '0'>, '41', 
                                                                                          <~ticket, 
                                                                                           mask(~ticket_age_add,
                                                                                                $ticket_age)
                                                                                          >, 
                                                                                          hmac(<
                                                                                                Expand(Expand(Extract(~res_psk,
                                                                                                                      '0'),
                                                                                                              <
                                                                                                               'ext', 
                                                                                                               'pbk'
                                                                                                              >,
                                                                                                              '32'),
                                                                                                       <'0', 
                                                                                                        '0'>,
                                                                                                       '32'), 
                                                                                                h(<'0', '1', 
                                                                                                   '0x0303', 
                                                                                                   ~tid, '0', 
                                                                                                   $cipher_suites, 
                                                                                                   '0', 
                                                                                                   <'43', 
                                                                                                    '0x0304'
                                                                                                   >, 
                                                                                                   <'10', 
                                                                                                    $g1, $g>, 
                                                                                                   <'40', 
                                                                                                    $g1, 
                                                                                                    $g1^~x>, 
                                                                                                   <'45', 
                                                                                                    '0', '1'
                                                                                                   >, 
                                                                                                   <'42', '0'
                                                                                                   >, 
                                                                                                   '41', 
                                                                                                   <~ticket, 
                                                                                                    mask(~ticket_age_add,
                                                                                                         $ticket_age)
                                                                                                   >, 
                                                                                                   '0'>)
                                                                                               >)
                                                                                         >, 
                                                                                         '6', '0x0303', '40', 
                                                                                         $g>, 
                                                                                        '1', '0x0303', 
                                                                                        ~new_nc, '0', 
                                                                                        $cipher_suites.1, 
                                                                                        '0', 
                                                                                        <'43', '0x0304'>, 
                                                                                        <'10', $g1, $g>, 
                                                                                        <'40', $g, $g^~x.1>, 
                                                                                        <'45', '0', '1'>, 
                                                                                        '0', '41', 
                                                                                        <~ticket, 
                                                                                         mask(~ticket_age_add,
                                                                                              '1')
                                                                                        >, 
                                                                                        '0'>)
                                                                                    >)
                                                                              >, 
                                                                              '2', '0x0303', p_ns, 
                                                                              $cipher_suite, 
                                                                              <'13', $sig_algs>, '40', $g, 
                                                                              p_gy>, 
                                                                             '8', $exts>, 
                                                                            '13', '0', $certificate_extensions
                                                                           >, 
                                                                           '11', '0', pk(~ltkS)>)
                                                                       >,
                                                                       ~ltkS)
                                                                 >)
                                                              >,
                                                              '32'),
                                                       <'fin', '0'>, '32'), 
                                                h(<
                                                   <
                                                    <
                                                     <
                                                      <
                                                       <
                                                        <
                                                         <'0', '1', '0x0303', ~tid, '0', $cipher_suites, '0', 
                                                          <'43', '0x0304'>, <'10', $g1, $g>, 
                                                          <'40', $g1, $g1^~x>, <'45', '0', '1'>, <'42', '0'>, 
                                                          '41', 
                                                          <~ticket, mask(~ticket_age_add, $ticket_age)>, 
                                                          hmac(<
                                                                Expand(Expand(Extract(~res_psk, '0'),
                                                                              <'ext', 'pbk'>, '32'),
                                                                       <'0', '0'>, '32'), 
                                                                h(<'0', '1', '0x0303', ~tid, '0', 
                                                                   $cipher_suites, '0', <'43', '0x0304'>, 
                                                                   <'10', $g1, $g>, <'40', $g1, $g1^~x>, 
                                                                   <'45', '0', '1'>, <'42', '0'>, '41', 
                                                                   <~ticket, 
                                                                    mask(~ticket_age_add, $ticket_age)>, 
                                                                   '0'>)
                                                               >)
                                                         >, 
                                                         '6', '0x0303', '40', $g>, 
                                                        '1', '0x0303', ~new_nc, '0', $cipher_suites.1, '0', 
                                                        <'43', '0x0304'>, <'10', $g1, $g>, 
                                                        <'40', $g, $g^~x.1>, <'45', '0', '1'>, '0', '41', 
                                                        <~ticket, mask(~ticket_age_add, '1')>, 
                                                        hmac(<
                                                              Expand(Expand(Extract(~res_psk, '0'),
                                                                            <'ext', 'pbk'>, '32'),
                                                                     <'0', '0'>, '32'), 
                                                              h(<
                                                                 <
                                                                  <'0', '1', '0x0303', ~tid, '0', 
                                                                   $cipher_suites, '0', <'43', '0x0304'>, 
                                                                   <'10', $g1, $g>, <'40', $g1, $g1^~x>, 
                                                                   <'45', '0', '1'>, <'42', '0'>, '41', 
                                                                   <~ticket, 
                                                                    mask(~ticket_age_add, $ticket_age)>, 
                                                                   hmac(<
                                                                         Expand(Expand(Extract(~res_psk, '0'),
                                                                                       <'ext', 'pbk'>, '32'),
                                                                                <'0', '0'>, '32'), 
                                                                         h(<'0', '1', '0x0303', ~tid, '0', 
                                                                            $cipher_suites, '0', 
                                                                            <'43', '0x0304'>, 
                                                                            <'10', $g1, $g>, 
                                                                            <'40', $g1, $g1^~x>, 
                                                                            <'45', '0', '1'>, <'42', '0'>, 
                                                                            '41', 
                                                                            <~ticket, 
                                                                             mask(~ticket_age_add,
                                                                                  $ticket_age)
                                                                            >, 
                                                                            '0'>)
                                                                        >)
                                                                  >, 
                                                                  '6', '0x0303', '40', $g>, 
                                                                 '1', '0x0303', ~new_nc, '0', 
                                                                 $cipher_suites.1, '0', <'43', '0x0304'>, 
                                                                 <'10', $g1, $g>, <'40', $g, $g^~x.1>, 
                                                                 <'45', '0', '1'>, '0', '41', 
                                                                 <~ticket, mask(~ticket_age_add, '1')>, '0'>)
                                                             >)
                                                       >, 
                                                       '2', '0x0303', p_ns, $cipher_suite, <'13', $sig_algs>, 
                                                       '40', $g, p_gy>, 
                                                      '8', $exts>, 
                                                     '13', '0', $certificate_extensions>, 
                                                    '11', '0', pk(~ltkS)>, 
                                                   '15', 
                                                   sign(<'server_cv', 
                                                         h(<
                                                            <
                                                             <
                                                              <
                                                               <
                                                                <
                                                                 <'0', '1', '0x0303', ~tid, '0', 
                                                                  $cipher_suites, '0', <'43', '0x0304'>, 
                                                                  <'10', $g1, $g>, <'40', $g1, $g1^~x>, 
                                                                  <'45', '0', '1'>, <'42', '0'>, '41', 
                                                                  <~ticket, mask(~ticket_age_add, $ticket_age)
                                                                  >, 
                                                                  hmac(<
                                                                        Expand(Expand(Extract(~res_psk, '0'),
                                                                                      <'ext', 'pbk'>, '32'),
                                                                               <'0', '0'>, '32'), 
                                                                        h(<'0', '1', '0x0303', ~tid, '0', 
                                                                           $cipher_suites, '0', 
                                                                           <'43', '0x0304'>, <'10', $g1, $g>, 
                                                                           <'40', $g1, $g1^~x>, 
                                                                           <'45', '0', '1'>, <'42', '0'>, 
                                                                           '41', 
                                                                           <~ticket, 
                                                                            mask(~ticket_age_add, $ticket_age)
                                                                           >, 
                                                                           '0'>)
                                                                       >)
                                                                 >, 
                                                                 '6', '0x0303', '40', $g>, 
                                                                '1', '0x0303', ~new_nc, '0', 
                                                                $cipher_suites.1, '0', <'43', '0x0304'>, 
                                                                <'10', $g1, $g>, <'40', $g, $g^~x.1>, 
                                                                <'45', '0', '1'>, '0', '41', 
                                                                <~ticket, mask(~ticket_age_add, '1')>, 
                                                                hmac(<
                                                                      Expand(Expand(Extract(~res_psk, '0'),
                                                                                    <'ext', 'pbk'>, '32'),
                                                                             <'0', '0'>, '32'), 
                                                                      h(<
                                                                         <
                                                                          <'0', '1', '0x0303', ~tid, '0', 
                                                                           $cipher_suites, '0', 
                                                                           <'43', '0x0304'>, <'10', $g1, $g>, 
                                                                           <'40', $g1, $g1^~x>, 
                                                                           <'45', '0', '1'>, <'42', '0'>, 
                                                                           '41', 
                                                                           <~ticket, 
                                                                            mask(~ticket_age_add, $ticket_age)
                                                                           >, 
                                                                           hmac(<
                                                                                 Expand(Expand(Extract(~res_psk,
                                                                                                       '0'),
                                                                                               <'ext', 'pbk'>,
                                                                                               '32'),
                                                                                        <'0', '0'>, '32'), 
                                                                                 h(<'0', '1', '0x0303', ~tid, 
                                                                                    '0', $cipher_suites, '0', 
                                                                                    <'43', '0x0304'>, 
                                                                                    <'10', $g1, $g>, 
                                                                                    <'40', $g1, $g1^~x>, 
                                                                                    <'45', '0', '1'>, 
                                                                                    <'42', '0'>, '41', 
                                                                                    <~ticket, 
                                                                                     mask(~ticket_age_add,
                                                                                          $ticket_age)
                                                                                    >, 
                                                                                    '0'>)
                                                                                >)
                                                                          >, 
                                                                          '6', '0x0303', '40', $g>, 
                                                                         '1', '0x0303', ~new_nc, '0', 
                                                                         $cipher_suites.1, '0', 
                                                                         <'43', '0x0304'>, <'10', $g1, $g>, 
                                                                         <'40', $g, $g^~x.1>, 
                                                                         <'45', '0', '1'>, '0', '41', 
                                                                         <~ticket, mask(~ticket_age_add, '1')
                                                                         >, 
                                                                         '0'>)
                                                                     >)
                                                               >, 
                                                               '2', '0x0303', p_ns, $cipher_suite, 
                                                               <'13', $sig_algs>, '40', $g, p_gy>, 
                                                              '8', $exts>, 
                                                             '13', '0', $certificate_extensions>, 
                                                            '11', '0', pk(~ltkS)>)
                                                        >,
                                                        ~ltkS)
                                                  >)
                                               >)
                                         >)
                                      >,
                                      '32')
                    ) ▶₀ #l )
        qed
      qed
    next
      case recv_server_auth_case_08
      solve( (∃ #j.2.
               (!KU( Extract('0',
                             Extract(p_gxy, Extract(Expand(ms, <'rms', h(messages)>, '32'), '0')))
                ) @ #j.2)
              ∧
               #j.2 < #j.1)  ∥
             ((∀ #k.
                (!KU( Extract('0',
                              Extract(p_gxy, Extract(Expand(ms, <'rms', h(messages)>, '32'), '0')))
                 ) @ #k)
               ⇒
                ¬(#k < #j.1)) ∧
              (∃ actor #l.
                (RevealPSK( actor,
                            Expand(Extract('0',
                                           Extract(p_gxy,
                                                   Extract(Expand(ms, <'rms', h(messages)>, '32'), '0'))),
                                   <'serverats', 
                                    h(<
                                       <
                                        <
                                         <
                                          <
                                           <
                                            <
                                             <
                                              <'0', '1', '0x0303', ~tid, '0', $cipher_suites, '0', 
                                               <'43', '0x0304'>, <'10', $g1, $g>, <'40', $g1, $g1^~x>, 
                                               <'45', '0', '1'>, <'42', '0'>, '41', 
                                               <p_psk_id, mask(ticket_age_add, $ticket_age)>, 
                                               hmac(<
                                                     Expand(Expand(Extract(Expand(ms, <'rms', h(messages)>,
                                                                                  '32'),
                                                                           '0'),
                                                                   <'res', 'pbk'>, '32'),
                                                            <'0', '0'>, '32'), 
                                                     h(<'0', '1', '0x0303', ~tid, '0', $cipher_suites, '0', 
                                                        <'43', '0x0304'>, <'10', $g1, $g>, 
                                                        <'40', $g1, $g1^~x>, <'45', '0', '1'>, <'42', '0'>, 
                                                        '41', <p_psk_id, mask(ticket_age_add, $ticket_age)>, 
                                                        '0'>)
                                                    >)
                                              >, 
                                              '6', '0x0303', '40', $g>, 
                                             '1', '0x0303', ~new_nc, '0', $cipher_suites.1, '0', 
                                             <'43', '0x0304'>, <'10', $g1, $g>, <'40', $g, $g^~x.1>, 
                                             <'45', '0', '1'>, '0', '41', 
                                             <p_psk_id, mask(ticket_age_add, '1')>, 
                                             hmac(<
                                                   Expand(Expand(Extract(Expand(ms, <'rms', h(messages)>,
                                                                                '32'),
                                                                         '0'),
                                                                 <'res', 'pbk'>, '32'),
                                                          <'0', '0'>, '32'), 
                                                   h(<
                                                      <
                                                       <'0', '1', '0x0303', ~tid, '0', $cipher_suites, '0', 
                                                        <'43', '0x0304'>, <'10', $g1, $g>, 
                                                        <'40', $g1, $g1^~x>, <'45', '0', '1'>, <'42', '0'>, 
                                                        '41', <p_psk_id, mask(ticket_age_add, $ticket_age)>, 
                                                        hmac(<
                                                              Expand(Expand(Extract(Expand(ms,
                                                                                           <'rms', h(messages)
                                                                                           >,
                                                                                           '32'),
                                                                                    '0'),
                                                                            <'res', 'pbk'>, '32'),
                                                                     <'0', '0'>, '32'), 
                                                              h(<'0', '1', '0x0303', ~tid, '0', 
                                                                 $cipher_suites, '0', <'43', '0x0304'>, 
                                                                 <'10', $g1, $g>, <'40', $g1, $g1^~x>, 
                                                                 <'45', '0', '1'>, <'42', '0'>, '41', 
                                                                 <p_psk_id, mask(ticket_age_add, $ticket_age)
                                                                 >, 
                                                                 '0'>)
                                                             >)
                                                       >, 
                                                       '6', '0x0303', '40', $g>, 
                                                      '1', '0x0303', ~new_nc, '0', $cipher_suites.1, '0', 
                                                      <'43', '0x0304'>, <'10', $g1, $g>, <'40', $g, $g^~x.1>, 
                                                      <'45', '0', '1'>, '0', '41', 
                                                      <p_psk_id, mask(ticket_age_add, '1')>, '0'>)
                                                  >)
                                            >, 
                                            '2', '0x0303', p_ns, $cipher_suite, <'13', $sig_algs>, '40', $g, 
                                            p_gy>, 
                                           '8', $exts>, 
                                          '13', '0', $certificate_extensions>, 
                                         '11', '0', pk(~ltkS)>, 
                                        '15', 
                                        sign(<'server_cv', 
                                              h(<
                                                 <
                                                  <
                                                   <
                                                    <
                                                     <
                                                      <'0', '1', '0x0303', ~tid, '0', $cipher_suites, '0', 
                                                       <'43', '0x0304'>, <'10', $g1, $g>, 
                                                       <'40', $g1, $g1^~x>, <'45', '0', '1'>, <'42', '0'>, 
                                                       '41', <p_psk_id, mask(ticket_age_add, $ticket_age)>, 
                                                       hmac(<
                                                             Expand(Expand(Extract(Expand(ms,
                                                                                          <'rms', h(messages)
                                                                                          >,
                                                                                          '32'),
                                                                                   '0'),
                                                                           <'res', 'pbk'>, '32'),
                                                                    <'0', '0'>, '32'), 
                                                             h(<'0', '1', '0x0303', ~tid, '0', 
                                                                $cipher_suites, '0', <'43', '0x0304'>, 
                                                                <'10', $g1, $g>, <'40', $g1, $g1^~x>, 
                                                                <'45', '0', '1'>, <'42', '0'>, '41', 
                                                                <p_psk_id, mask(ticket_age_add, $ticket_age)
                                                                >, 
                                                                '0'>)
                                                            >)
                                                      >, 
                                                      '6', '0x0303', '40', $g>, 
                                                     '1', '0x0303', ~new_nc, '0', $cipher_suites.1, '0', 
                                                     <'43', '0x0304'>, <'10', $g1, $g>, <'40', $g, $g^~x.1>, 
                                                     <'45', '0', '1'>, '0', '41', 
                                                     <p_psk_id, mask(ticket_age_add, '1')>, 
                                                     hmac(<
                                                           Expand(Expand(Extract(Expand(ms,
                                                                                        <'rms', h(messages)>,
                                                                                        '32'),
                                                                                 '0'),
                                                                         <'res', 'pbk'>, '32'),
                                                                  <'0', '0'>, '32'), 
                                                           h(<
                                                              <
                                                               <'0', '1', '0x0303', ~tid, '0', 
                                                                $cipher_suites, '0', <'43', '0x0304'>, 
                                                                <'10', $g1, $g>, <'40', $g1, $g1^~x>, 
                                                                <'45', '0', '1'>, <'42', '0'>, '41', 
                                                                <p_psk_id, mask(ticket_age_add, $ticket_age)
                                                                >, 
                                                                hmac(<
                                                                      Expand(Expand(Extract(Expand(ms,
                                                                                                   <'rms', 
                                                                                                    h(messages)
                                                                                                   >,
                                                                                                   '32'),
                                                                                            '0'),
                                                                                    <'res', 'pbk'>, '32'),
                                                                             <'0', '0'>, '32'), 
                                                                      h(<'0', '1', '0x0303', ~tid, '0', 
                                                                         $cipher_suites, '0', 
                                                                         <'43', '0x0304'>, <'10', $g1, $g>, 
                                                                         <'40', $g1, $g1^~x>, 
                                                                         <'45', '0', '1'>, <'42', '0'>, '41', 
                                                                         <p_psk_id, 
                                                                          mask(ticket_age_add, $ticket_age)>, 
                                                                         '0'>)
                                                                     >)
                                                               >, 
                                                               '6', '0x0303', '40', $g>, 
                                                              '1', '0x0303', ~new_nc, '0', $cipher_suites.1, 
                                                              '0', <'43', '0x0304'>, <'10', $g1, $g>, 
                                                              <'40', $g, $g^~x.1>, <'45', '0', '1'>, '0', 
                                                              '41', <p_psk_id, mask(ticket_age_add, '1')>, '0'
                                                             >)
                                                          >)
                                                    >, 
                                                    '2', '0x0303', p_ns, $cipher_suite, <'13', $sig_algs>, 
                                                    '40', $g, p_gy>, 
                                                   '8', $exts>, 
                                                  '13', '0', $certificate_extensions>, 
                                                 '11', '0', pk(~ltkS)>)
                                             >,
                                             ~ltkS)
                                       >, 
                                       '20', 
                                       hmac(<
                                             Expand(Expand(Extract(p_gxy,
                                                                   Extract(Expand(ms, <'rms', h(messages)>,
                                                                                  '32'),
                                                                           '0')),
                                                           <'serverhts', 
                                                            h(<
                                                               <
                                                                <
                                                                 <
                                                                  <
                                                                   <
                                                                    <
                                                                     <'0', '1', '0x0303', ~tid, '0', 
                                                                      $cipher_suites, '0', <'43', '0x0304'>, 
                                                                      <'10', $g1, $g>, <'40', $g1, $g1^~x>, 
                                                                      <'45', '0', '1'>, <'42', '0'>, '41', 
                                                                      <p_psk_id, 
                                                                       mask(ticket_age_add, $ticket_age)>, 
                                                                      hmac(<
                                                                            Expand(Expand(Extract(Expand(ms,
                                                                                                         <
                                                                                                          'rms', 
                                                                                                          h(messages)
                                                                                                         >,
                                                                                                         '32'),
                                                                                                  '0'),
                                                                                          <'res', 'pbk'>,
                                                                                          '32'),
                                                                                   <'0', '0'>, '32'), 
                                                                            h(<'0', '1', '0x0303', ~tid, '0', 
                                                                               $cipher_suites, '0', 
                                                                               <'43', '0x0304'>, 
                                                                               <'10', $g1, $g>, 
                                                                               <'40', $g1, $g1^~x>, 
                                                                               <'45', '0', '1'>, <'42', '0'>, 
                                                                               '41', 
                                                                               <p_psk_id, 
                                                                                mask(ticket_age_add,
                                                                                     $ticket_age)
                                                                               >, 
                                                                               '0'>)
                                                                           >)
                                                                     >, 
                                                                     '6', '0x0303', '40', $g>, 
                                                                    '1', '0x0303', ~new_nc, '0', 
                                                                    $cipher_suites.1, '0', <'43', '0x0304'>, 
                                                                    <'10', $g1, $g>, <'40', $g, $g^~x.1>, 
                                                                    <'45', '0', '1'>, '0', '41', 
                                                                    <p_psk_id, mask(ticket_age_add, '1')>, 
                                                                    hmac(<
                                                                          Expand(Expand(Extract(Expand(ms,
                                                                                                       <
                                                                                                        'rms', 
                                                                                                        h(messages)
                                                                                                       >,
                                                                                                       '32'),
                                                                                                '0'),
                                                                                        <'res', 'pbk'>, '32'),
                                                                                 <'0', '0'>, '32'), 
                                                                          h(<
                                                                             <
                                                                              <'0', '1', '0x0303', ~tid, '0', 
                                                                               $cipher_suites, '0', 
                                                                               <'43', '0x0304'>, 
                                                                               <'10', $g1, $g>, 
                                                                               <'40', $g1, $g1^~x>, 
                                                                               <'45', '0', '1'>, <'42', '0'>, 
                                                                               '41', 
                                                                               <p_psk_id, 
                                                                                mask(ticket_age_add,
                                                                                     $ticket_age)
                                                                               >, 
                                                                               hmac(<
                                                                                     Expand(Expand(Extract(Expand(ms,
                                                                                                                  <
                                                                                                                   'rms', 
                                                                                                                   h(messages)
                                                                                                                  >,
                                                                                                                  '32'),
                                                                                                           '0'),
                                                                                                   <'res', 
                                                                                                    'pbk'>,
                                                                                                   '32'),
                                                                                            <'0', '0'>,
                                                                                            '32'), 
                                                                                     h(<'0', '1', '0x0303', 
                                                                                        ~tid, '0', 
                                                                                        $cipher_suites, '0', 
                                                                                        <'43', '0x0304'>, 
                                                                                        <'10', $g1, $g>, 
                                                                                        <'40', $g1, $g1^~x>, 
                                                                                        <'45', '0', '1'>, 
                                                                                        <'42', '0'>, '41', 
                                                                                        <p_psk_id, 
                                                                                         mask(ticket_age_add,
                                                                                              $ticket_age)
                                                                                        >, 
                                                                                        '0'>)
                                                                                    >)
                                                                              >, 
                                                                              '6', '0x0303', '40', $g>, 
                                                                             '1', '0x0303', ~new_nc, '0', 
                                                                             $cipher_suites.1, '0', 
                                                                             <'43', '0x0304'>, 
                                                                             <'10', $g1, $g>, 
                                                                             <'40', $g, $g^~x.1>, 
                                                                             <'45', '0', '1'>, '0', '41', 
                                                                             <p_psk_id, 
                                                                              mask(ticket_age_add, '1')>, 
                                                                             '0'>)
                                                                         >)
                                                                   >, 
                                                                   '2', '0x0303', p_ns, $cipher_suite, 
                                                                   <'13', $sig_algs>, '40', $g, p_gy>, 
                                                                  '8', $exts>, 
                                                                 '13', '0', $certificate_extensions>, 
                                                                '11', '0', pk(~ltkS)>, 
                                                               '15', 
                                                               sign(<'server_cv', 
                                                                     h(<
                                                                        <
                                                                         <
                                                                          <
                                                                           <
                                                                            <
                                                                             <'0', '1', '0x0303', ~tid, '0', 
                                                                              $cipher_suites, '0', 
                                                                              <'43', '0x0304'>, 
                                                                              <'10', $g1, $g>, 
                                                                              <'40', $g1, $g1^~x>, 
                                                                              <'45', '0', '1'>, <'42', '0'>, 
                                                                              '41', 
                                                                              <p_psk_id, 
                                                                               mask(ticket_age_add,
                                                                                    $ticket_age)
                                                                              >, 
                                                                              hmac(<
                                                                                    Expand(Expand(Extract(Expand(ms,
                                                                                                                 <
                                                                                                                  'rms', 
                                                                                                                  h(messages)
                                                                                                                 >,
                                                                                                                 '32'),
                                                                                                          '0'),
                                                                                                  <'res', 
                                                                                                   'pbk'>,
                                                                                                  '32'),
                                                                                           <'0', '0'>, '32'), 
                                                                                    h(<'0', '1', '0x0303', 
                                                                                       ~tid, '0', 
                                                                                       $cipher_suites, '0', 
                                                                                       <'43', '0x0304'>, 
                                                                                       <'10', $g1, $g>, 
                                                                                       <'40', $g1, $g1^~x>, 
                                                                                       <'45', '0', '1'>, 
                                                                                       <'42', '0'>, '41', 
                                                                                       <p_psk_id, 
                                                                                        mask(ticket_age_add,
                                                                                             $ticket_age)
                                                                                       >, 
                                                                                       '0'>)
                                                                                   >)
                                                                             >, 
                                                                             '6', '0x0303', '40', $g>, 
                                                                            '1', '0x0303', ~new_nc, '0', 
                                                                            $cipher_suites.1, '0', 
                                                                            <'43', '0x0304'>, 
                                                                            <'10', $g1, $g>, 
                                                                            <'40', $g, $g^~x.1>, 
                                                                            <'45', '0', '1'>, '0', '41', 
                                                                            <p_psk_id, 
                                                                             mask(ticket_age_add, '1')>, 
                                                                            hmac(<
                                                                                  Expand(Expand(Extract(Expand(ms,
                                                                                                               <
                                                                                                                'rms', 
                                                                                                                h(messages)
                                                                                                               >,
                                                                                                               '32'),
                                                                                                        '0'),
                                                                                                <'res', 'pbk'
                                                                                                >,
                                                                                                '32'),
                                                                                         <'0', '0'>, '32'), 
                                                                                  h(<
                                                                                     <
                                                                                      <'0', '1', '0x0303', 
                                                                                       ~tid, '0', 
                                                                                       $cipher_suites, '0', 
                                                                                       <'43', '0x0304'>, 
                                                                                       <'10', $g1, $g>, 
                                                                                       <'40', $g1, $g1^~x>, 
                                                                                       <'45', '0', '1'>, 
                                                                                       <'42', '0'>, '41', 
                                                                                       <p_psk_id, 
                                                                                        mask(ticket_age_add,
                                                                                             $ticket_age)
                                                                                       >, 
                                                                                       hmac(<
                                                                                             Expand(Expand(Extract(Expand(ms,
                                                                                                                          <
                                                                                                                           'rms', 
                                                                                                                           h(messages)
                                                                                                                          >,
                                                                                                                          '32'),
                                                                                                                   '0'),
                                                                                                           <
                                                                                                            'res', 
                                                                                                            'pbk'
                                                                                                           >,
                                                                                                           '32'),
                                                                                                    <'0', '0'
                                                                                                    >,
                                                                                                    '32'), 
                                                                                             h(<'0', '1', 
                                                                                                '0x0303', 
                                                                                                ~tid, '0', 
                                                                                                $cipher_suites, 
                                                                                                '0', 
                                                                                                <'43', 
                                                                                                 '0x0304'>, 
                                                                                                <'10', $g1, $g
                                                                                                >, 
                                                                                                <'40', $g1, 
                                                                                                 $g1^~x>, 
                                                                                                <'45', '0', 
                                                                                                 '1'>, 
                                                                                                <'42', '0'>, 
                                                                                                '41', 
                                                                                                <p_psk_id, 
                                                                                                 mask(ticket_age_add,
                                                                                                      $ticket_age)
                                                                                                >, 
                                                                                                '0'>)
                                                                                            >)
                                                                                      >, 
                                                                                      '6', '0x0303', '40', $g
                                                                                     >, 
                                                                                     '1', '0x0303', ~new_nc, 
                                                                                     '0', $cipher_suites.1, 
                                                                                     '0', <'43', '0x0304'>, 
                                                                                     <'10', $g1, $g>, 
                                                                                     <'40', $g, $g^~x.1>, 
                                                                                     <'45', '0', '1'>, '0', 
                                                                                     '41', 
                                                                                     <p_psk_id, 
                                                                                      mask(ticket_age_add,
                                                                                           '1')
                                                                                     >, 
                                                                                     '0'>)
                                                                                 >)
                                                                           >, 
                                                                           '2', '0x0303', p_ns, 
                                                                           $cipher_suite, <'13', $sig_algs>, 
                                                                           '40', $g, p_gy>, 
                                                                          '8', $exts>, 
                                                                         '13', '0', $certificate_extensions>, 
                                                                        '11', '0', pk(~ltkS)>)
                                                                    >,
                                                                    ~ltkS)
                                                              >)
                                                           >,
                                                           '32'),
                                                    <'fin', '0'>, '32'), 
                                             h(<
                                                <
                                                 <
                                                  <
                                                   <
                                                    <
                                                     <
                                                      <'0', '1', '0x0303', ~tid, '0', $cipher_suites, '0', 
                                                       <'43', '0x0304'>, <'10', $g1, $g>, 
                                                       <'40', $g1, $g1^~x>, <'45', '0', '1'>, <'42', '0'>, 
                                                       '41', <p_psk_id, mask(ticket_age_add, $ticket_age)>, 
                                                       hmac(<
                                                             Expand(Expand(Extract(Expand(ms,
                                                                                          <'rms', h(messages)
                                                                                          >,
                                                                                          '32'),
                                                                                   '0'),
                                                                           <'res', 'pbk'>, '32'),
                                                                    <'0', '0'>, '32'), 
                                                             h(<'0', '1', '0x0303', ~tid, '0', 
                                                                $cipher_suites, '0', <'43', '0x0304'>, 
                                                                <'10', $g1, $g>, <'40', $g1, $g1^~x>, 
                                                                <'45', '0', '1'>, <'42', '0'>, '41', 
                                                                <p_psk_id, mask(ticket_age_add, $ticket_age)
                                                                >, 
                                                                '0'>)
                                                            >)
                                                      >, 
                                                      '6', '0x0303', '40', $g>, 
                                                     '1', '0x0303', ~new_nc, '0', $cipher_suites.1, '0', 
                                                     <'43', '0x0304'>, <'10', $g1, $g>, <'40', $g, $g^~x.1>, 
                                                     <'45', '0', '1'>, '0', '41', 
                                                     <p_psk_id, mask(ticket_age_add, '1')>, 
                                                     hmac(<
                                                           Expand(Expand(Extract(Expand(ms,
                                                                                        <'rms', h(messages)>,
                                                                                        '32'),
                                                                                 '0'),
                                                                         <'res', 'pbk'>, '32'),
                                                                  <'0', '0'>, '32'), 
                                                           h(<
                                                              <
                                                               <'0', '1', '0x0303', ~tid, '0', 
                                                                $cipher_suites, '0', <'43', '0x0304'>, 
                                                                <'10', $g1, $g>, <'40', $g1, $g1^~x>, 
                                                                <'45', '0', '1'>, <'42', '0'>, '41', 
                                                                <p_psk_id, mask(ticket_age_add, $ticket_age)
                                                                >, 
                                                                hmac(<
                                                                      Expand(Expand(Extract(Expand(ms,
                                                                                                   <'rms', 
                                                                                                    h(messages)
                                                                                                   >,
                                                                                                   '32'),
                                                                                            '0'),
                                                                                    <'res', 'pbk'>, '32'),
                                                                             <'0', '0'>, '32'), 
                                                                      h(<'0', '1', '0x0303', ~tid, '0', 
                                                                         $cipher_suites, '0', 
                                                                         <'43', '0x0304'>, <'10', $g1, $g>, 
                                                                         <'40', $g1, $g1^~x>, 
                                                                         <'45', '0', '1'>, <'42', '0'>, '41', 
                                                                         <p_psk_id, 
                                                                          mask(ticket_age_add, $ticket_age)>, 
                                                                         '0'>)
                                                                     >)
                                                               >, 
                                                               '6', '0x0303', '40', $g>, 
                                                              '1', '0x0303', ~new_nc, '0', $cipher_suites.1, 
                                                              '0', <'43', '0x0304'>, <'10', $g1, $g>, 
                                                              <'40', $g, $g^~x.1>, <'45', '0', '1'>, '0', 
                                                              '41', <p_psk_id, mask(ticket_age_add, '1')>, '0'
                                                             >)
                                                          >)
                                                    >, 
                                                    '2', '0x0303', p_ns, $cipher_suite, <'13', $sig_algs>, 
                                                    '40', $g, p_gy>, 
                                                   '8', $exts>, 
                                                  '13', '0', $certificate_extensions>, 
                                                 '11', '0', pk(~ltkS)>, 
                                                '15', 
                                                sign(<'server_cv', 
                                                      h(<
                                                         <
                                                          <
                                                           <
                                                            <
                                                             <
                                                              <'0', '1', '0x0303', ~tid, '0', $cipher_suites, 
                                                               '0', <'43', '0x0304'>, <'10', $g1, $g>, 
                                                               <'40', $g1, $g1^~x>, <'45', '0', '1'>, 
                                                               <'42', '0'>, '41', 
                                                               <p_psk_id, mask(ticket_age_add, $ticket_age)>, 
                                                               hmac(<
                                                                     Expand(Expand(Extract(Expand(ms,
                                                                                                  <'rms', 
                                                                                                   h(messages)
                                                                                                  >,
                                                                                                  '32'),
                                                                                           '0'),
                                                                                   <'res', 'pbk'>, '32'),
                                                                            <'0', '0'>, '32'), 
                                                                     h(<'0', '1', '0x0303', ~tid, '0', 
                                                                        $cipher_suites, '0', 
                                                                        <'43', '0x0304'>, <'10', $g1, $g>, 
                                                                        <'40', $g1, $g1^~x>, 
                                                                        <'45', '0', '1'>, <'42', '0'>, '41', 
                                                                        <p_psk_id, 
                                                                         mask(ticket_age_add, $ticket_age)>, 
                                                                        '0'>)
                                                                    >)
                                                              >, 
                                                              '6', '0x0303', '40', $g>, 
                                                             '1', '0x0303', ~new_nc, '0', $cipher_suites.1, 
                                                             '0', <'43', '0x0304'>, <'10', $g1, $g>, 
                                                             <'40', $g, $g^~x.1>, <'45', '0', '1'>, '0', 
                                                             '41', <p_psk_id, mask(ticket_age_add, '1')>, 
                                                             hmac(<
                                                                   Expand(Expand(Extract(Expand(ms,
                                                                                                <'rms', 
                                                                                                 h(messages)>,
                                                                                                '32'),
                                                                                         '0'),
                                                                                 <'res', 'pbk'>, '32'),
                                                                          <'0', '0'>, '32'), 
                                                                   h(<
                                                                      <
                                                                       <'0', '1', '0x0303', ~tid, '0', 
                                                                        $cipher_suites, '0', 
                                                                        <'43', '0x0304'>, <'10', $g1, $g>, 
                                                                        <'40', $g1, $g1^~x>, 
                                                                        <'45', '0', '1'>, <'42', '0'>, '41', 
                                                                        <p_psk_id, 
                                                                         mask(ticket_age_add, $ticket_age)>, 
                                                                        hmac(<
                                                                              Expand(Expand(Extract(Expand(ms,
                                                                                                           <
                                                                                                            'rms', 
                                                                                                            h(messages)
                                                                                                           >,
                                                                                                           '32'),
                                                                                                    '0'),
                                                                                            <'res', 'pbk'>,
                                                                                            '32'),
                                                                                     <'0', '0'>, '32'), 
                                                                              h(<'0', '1', '0x0303', ~tid, 
                                                                                 '0', $cipher_suites, '0', 
                                                                                 <'43', '0x0304'>, 
                                                                                 <'10', $g1, $g>, 
                                                                                 <'40', $g1, $g1^~x>, 
                                                                                 <'45', '0', '1'>, 
                                                                                 <'42', '0'>, '41', 
                                                                                 <p_psk_id, 
                                                                                  mask(ticket_age_add,
                                                                                       $ticket_age)
                                                                                 >, 
                                                                                 '0'>)
                                                                             >)
                                                                       >, 
                                                                       '6', '0x0303', '40', $g>, 
                                                                      '1', '0x0303', ~new_nc, '0', 
                                                                      $cipher_suites.1, '0', 
                                                                      <'43', '0x0304'>, <'10', $g1, $g>, 
                                                                      <'40', $g, $g^~x.1>, <'45', '0', '1'>, 
                                                                      '0', '41', 
                                                                      <p_psk_id, mask(ticket_age_add, '1')>, 
                                                                      '0'>)
                                                                  >)
                                                            >, 
                                                            '2', '0x0303', p_ns, $cipher_suite, 
                                                            <'13', $sig_algs>, '40', $g, p_gy>, 
                                                           '8', $exts>, 
                                                          '13', '0', $certificate_extensions>, 
                                                         '11', '0', pk(~ltkS)>)
                                                     >,
                                                     ~ltkS)
                                               >)
                                            >)
                                      >)
                                   >,
                                   '32')
                 ) @ #l)
               ∧
                #l < #j.1)) )
        case case_1
        solve( (∃ #r. (RevLtk( $S ) @ #r) ∧ #r < #vr)  ∥
               (∃ tid3 x #r. (RevDHExp( tid3, $S, x ) @ #r) ∧ #r < #vr)  ∥
               (∃ tid4 y #r. (RevDHExp( tid4, $C, y ) @ #r) ∧ #r < #vr)  ∥
               (∃ rms #r. (RevealPSK( $C, rms ) @ #r) ∧ #r < #k.1)  ∥
               (∃ rms #r. (RevealPSK( $S, rms ) @ #r) ∧ #r < #k.1) )
          case case_1
          by contradiction /* from formulas */
        next
          case case_2
          by contradiction /* from formulas */
        next
          case case_3
          by contradiction /* from formulas */
        next
          case case_4
          by contradiction /* from formulas */
        next
          case case_5
          by contradiction /* from formulas */
        qed
      next
        case case_2
        solve( !Ltk( $C, ~ltkC ) ▶₂ #i )
          case Register_pk
          by solve( SecretPSK( $A,
                               Expand(Extract('0',
                                              Extract(p_gxy,
                                                      Extract(Expand(ms, <'rms', h(messages)>, '32'), '0'))),
                                      <'serverats', 
                                       h(<
                                          <
                                           <
                                            <
                                             <
                                              <
                                               <
                                                <
                                                 <'0', '1', '0x0303', ~tid, '0', $cipher_suites, '0', 
                                                  <'43', '0x0304'>, <'10', $g1, $g>, <'40', $g1, $g1^~x>, 
                                                  <'45', '0', '1'>, <'42', '0'>, '41', 
                                                  <p_psk_id, mask(ticket_age_add, $ticket_age)>, 
                                                  hmac(<
                                                        Expand(Expand(Extract(Expand(ms, <'rms', h(messages)>,
                                                                                     '32'),
                                                                              '0'),
                                                                      <'res', 'pbk'>, '32'),
                                                               <'0', '0'>, '32'), 
                                                        h(<'0', '1', '0x0303', ~tid, '0', $cipher_suites, 
                                                           '0', <'43', '0x0304'>, <'10', $g1, $g>, 
                                                           <'40', $g1, $g1^~x>, <'45', '0', '1'>, 
                                                           <'42', '0'>, '41', 
                                                           <p_psk_id, mask(ticket_age_add, $ticket_age)>, '0'
                                                          >)
                                                       >)
                                                 >, 
                                                 '6', '0x0303', '40', $g>, 
                                                '1', '0x0303', ~new_nc, '0', $cipher_suites.1, '0', 
                                                <'43', '0x0304'>, <'10', $g1, $g>, <'40', $g, $g^~x.1>, 
                                                <'45', '0', '1'>, '0', '41', 
                                                <p_psk_id, mask(ticket_age_add, '1')>, 
                                                hmac(<
                                                      Expand(Expand(Extract(Expand(ms, <'rms', h(messages)>,
                                                                                   '32'),
                                                                            '0'),
                                                                    <'res', 'pbk'>, '32'),
                                                             <'0', '0'>, '32'), 
                                                      h(<
                                                         <
                                                          <'0', '1', '0x0303', ~tid, '0', $cipher_suites, 
                                                           '0', <'43', '0x0304'>, <'10', $g1, $g>, 
                                                           <'40', $g1, $g1^~x>, <'45', '0', '1'>, 
                                                           <'42', '0'>, '41', 
                                                           <p_psk_id, mask(ticket_age_add, $ticket_age)>, 
                                                           hmac(<
                                                                 Expand(Expand(Extract(Expand(ms,
                                                                                              <'rms', 
                                                                                               h(messages)>,
                                                                                              '32'),
                                                                                       '0'),
                                                                               <'res', 'pbk'>, '32'),
                                                                        <'0', '0'>, '32'), 
                                                                 h(<'0', '1', '0x0303', ~tid, '0', 
                                                                    $cipher_suites, '0', <'43', '0x0304'>, 
                                                                    <'10', $g1, $g>, <'40', $g1, $g1^~x>, 
                                                                    <'45', '0', '1'>, <'42', '0'>, '41', 
                                                                    <p_psk_id, 
                                                                     mask(ticket_age_add, $ticket_age)>, 
                                                                    '0'>)
                                                                >)
                                                          >, 
                                                          '6', '0x0303', '40', $g>, 
                                                         '1', '0x0303', ~new_nc, '0', $cipher_suites.1, '0', 
                                                         <'43', '0x0304'>, <'10', $g1, $g>, 
                                                         <'40', $g, $g^~x.1>, <'45', '0', '1'>, '0', '41', 
                                                         <p_psk_id, mask(ticket_age_add, '1')>, '0'>)
                                                     >)
                                               >, 
                                               '2', '0x0303', p_ns, $cipher_suite, <'13', $sig_algs>, '40', 
                                               $g, p_gy>, 
                                              '8', $exts>, 
                                             '13', '0', $certificate_extensions>, 
                                            '11', '0', pk(~ltkS)>, 
                                           '15', 
                                           sign(<'server_cv', 
                                                 h(<
                                                    <
                                                     <
                                                      <
                                                       <
                                                        <
                                                         <'0', '1', '0x0303', ~tid, '0', $cipher_suites, '0', 
                                                          <'43', '0x0304'>, <'10', $g1, $g>, 
                                                          <'40', $g1, $g1^~x>, <'45', '0', '1'>, <'42', '0'>, 
                                                          '41', 
                                                          <p_psk_id, mask(ticket_age_add, $ticket_age)>, 
                                                          hmac(<
                                                                Expand(Expand(Extract(Expand(ms,
                                                                                             <'rms', 
                                                                                              h(messages)>,
                                                                                             '32'),
                                                                                      '0'),
                                                                              <'res', 'pbk'>, '32'),
                                                                       <'0', '0'>, '32'), 
                                                                h(<'0', '1', '0x0303', ~tid, '0', 
                                                                   $cipher_suites, '0', <'43', '0x0304'>, 
                                                                   <'10', $g1, $g>, <'40', $g1, $g1^~x>, 
                                                                   <'45', '0', '1'>, <'42', '0'>, '41', 
                                                                   <p_psk_id, 
                                                                    mask(ticket_age_add, $ticket_age)>, 
                                                                   '0'>)
                                                               >)
                                                         >, 
                                                         '6', '0x0303', '40', $g>, 
                                                        '1', '0x0303', ~new_nc, '0', $cipher_suites.1, '0', 
                                                        <'43', '0x0304'>, <'10', $g1, $g>, 
                                                        <'40', $g, $g^~x.1>, <'45', '0', '1'>, '0', '41', 
                                                        <p_psk_id, mask(ticket_age_add, '1')>, 
                                                        hmac(<
                                                              Expand(Expand(Extract(Expand(ms,
                                                                                           <'rms', h(messages)
                                                                                           >,
                                                                                           '32'),
                                                                                    '0'),
                                                                            <'res', 'pbk'>, '32'),
                                                                     <'0', '0'>, '32'), 
                                                              h(<
                                                                 <
                                                                  <'0', '1', '0x0303', ~tid, '0', 
                                                                   $cipher_suites, '0', <'43', '0x0304'>, 
                                                                   <'10', $g1, $g>, <'40', $g1, $g1^~x>, 
                                                                   <'45', '0', '1'>, <'42', '0'>, '41', 
                                                                   <p_psk_id, 
                                                                    mask(ticket_age_add, $ticket_age)>, 
                                                                   hmac(<
                                                                         Expand(Expand(Extract(Expand(ms,
                                                                                                      <'rms', 
                                                                                                       h(messages)
                                                                                                      >,
                                                                                                      '32'),
                                                                                               '0'),
                                                                                       <'res', 'pbk'>, '32'),
                                                                                <'0', '0'>, '32'), 
                                                                         h(<'0', '1', '0x0303', ~tid, '0', 
                                                                            $cipher_suites, '0', 
                                                                            <'43', '0x0304'>, 
                                                                            <'10', $g1, $g>, 
                                                                            <'40', $g1, $g1^~x>, 
                                                                            <'45', '0', '1'>, <'42', '0'>, 
                                                                            '41', 
                                                                            <p_psk_id, 
                                                                             mask(ticket_age_add, $ticket_age)
                                                                            >, 
                                                                            '0'>)
                                                                        >)
                                                                  >, 
                                                                  '6', '0x0303', '40', $g>, 
                                                                 '1', '0x0303', ~new_nc, '0', 
                                                                 $cipher_suites.1, '0', <'43', '0x0304'>, 
                                                                 <'10', $g1, $g>, <'40', $g, $g^~x.1>, 
                                                                 <'45', '0', '1'>, '0', '41', 
                                                                 <p_psk_id, mask(ticket_age_add, '1')>, '0'>)
                                                             >)
                                                       >, 
                                                       '2', '0x0303', p_ns, $cipher_suite, <'13', $sig_algs>, 
                                                       '40', $g, p_gy>, 
                                                      '8', $exts>, 
                                                     '13', '0', $certificate_extensions>, 
                                                    '11', '0', pk(~ltkS)>)
                                                >,
                                                ~ltkS)
                                          >, 
                                          '20', 
                                          hmac(<
                                                Expand(Expand(Extract(p_gxy,
                                                                      Extract(Expand(ms, <'rms', h(messages)>,
                                                                                     '32'),
                                                                              '0')),
                                                              <'serverhts', 
                                                               h(<
                                                                  <
                                                                   <
                                                                    <
                                                                     <
                                                                      <
                                                                       <
                                                                        <'0', '1', '0x0303', ~tid, '0', 
                                                                         $cipher_suites, '0', 
                                                                         <'43', '0x0304'>, <'10', $g1, $g>, 
                                                                         <'40', $g1, $g1^~x>, 
                                                                         <'45', '0', '1'>, <'42', '0'>, '41', 
                                                                         <p_psk_id, 
                                                                          mask(ticket_age_add, $ticket_age)>, 
                                                                         hmac(<
                                                                               Expand(Expand(Extract(Expand(ms,
                                                                                                            <
                                                                                                             'rms', 
                                                                                                             h(messages)
                                                                                                            >,
                                                                                                            '32'),
                                                                                                     '0'),
                                                                                             <'res', 'pbk'>,
                                                                                             '32'),
                                                                                      <'0', '0'>, '32'), 
                                                                               h(<'0', '1', '0x0303', ~tid, 
                                                                                  '0', $cipher_suites, '0', 
                                                                                  <'43', '0x0304'>, 
                                                                                  <'10', $g1, $g>, 
                                                                                  <'40', $g1, $g1^~x>, 
                                                                                  <'45', '0', '1'>, 
                                                                                  <'42', '0'>, '41', 
                                                                                  <p_psk_id, 
                                                                                   mask(ticket_age_add,
                                                                                        $ticket_age)
                                                                                  >, 
                                                                                  '0'>)
                                                                              >)
                                                                        >, 
                                                                        '6', '0x0303', '40', $g>, 
                                                                       '1', '0x0303', ~new_nc, '0', 
                                                                       $cipher_suites.1, '0', 
                                                                       <'43', '0x0304'>, <'10', $g1, $g>, 
                                                                       <'40', $g, $g^~x.1>, <'45', '0', '1'>, 
                                                                       '0', '41', 
                                                                       <p_psk_id, mask(ticket_age_add, '1')>, 
                                                                       hmac(<
                                                                             Expand(Expand(Extract(Expand(ms,
                                                                                                          <
                                                                                                           'rms', 
                                                                                                           h(messages)
                                                                                                          >,
                                                                                                          '32'),
                                                                                                   '0'),
                                                                                           <'res', 'pbk'>,
                                                                                           '32'),
                                                                                    <'0', '0'>, '32'), 
                                                                             h(<
                                                                                <
                                                                                 <'0', '1', '0x0303', ~tid, 
                                                                                  '0', $cipher_suites, '0', 
                                                                                  <'43', '0x0304'>, 
                                                                                  <'10', $g1, $g>, 
                                                                                  <'40', $g1, $g1^~x>, 
                                                                                  <'45', '0', '1'>, 
                                                                                  <'42', '0'>, '41', 
                                                                                  <p_psk_id, 
                                                                                   mask(ticket_age_add,
                                                                                        $ticket_age)
                                                                                  >, 
                                                                                  hmac(<
                                                                                        Expand(Expand(Extract(Expand(ms,
                                                                                                                     <
                                                                                                                      'rms', 
                                                                                                                      h(messages)
                                                                                                                     >,
                                                                                                                     '32'),
                                                                                                              '0'),
                                                                                                      <'res', 
                                                                                                       'pbk'>,
                                                                                                      '32'),
                                                                                               <'0', '0'>,
                                                                                               '32'), 
                                                                                        h(<'0', '1', 
                                                                                           '0x0303', ~tid, 
                                                                                           '0', 
                                                                                           $cipher_suites, 
                                                                                           '0', 
                                                                                           <'43', '0x0304'>, 
                                                                                           <'10', $g1, $g>, 
                                                                                           <'40', $g1, $g1^~x
                                                                                           >, 
                                                                                           <'45', '0', '1'>, 
                                                                                           <'42', '0'>, '41', 
                                                                                           <p_psk_id, 
                                                                                            mask(ticket_age_add,
                                                                                                 $ticket_age)
                                                                                           >, 
                                                                                           '0'>)
                                                                                       >)
                                                                                 >, 
                                                                                 '6', '0x0303', '40', $g>, 
                                                                                '1', '0x0303', ~new_nc, '0', 
                                                                                $cipher_suites.1, '0', 
                                                                                <'43', '0x0304'>, 
                                                                                <'10', $g1, $g>, 
                                                                                <'40', $g, $g^~x.1>, 
                                                                                <'45', '0', '1'>, '0', '41', 
                                                                                <p_psk_id, 
                                                                                 mask(ticket_age_add, '1')>, 
                                                                                '0'>)
                                                                            >)
                                                                      >, 
                                                                      '2', '0x0303', p_ns, $cipher_suite, 
                                                                      <'13', $sig_algs>, '40', $g, p_gy>, 
                                                                     '8', $exts>, 
                                                                    '13', '0', $certificate_extensions>, 
                                                                   '11', '0', pk(~ltkS)>, 
                                                                  '15', 
                                                                  sign(<'server_cv', 
                                                                        h(<
                                                                           <
                                                                            <
                                                                             <
                                                                              <
                                                                               <
                                                                                <'0', '1', '0x0303', ~tid, 
                                                                                 '0', $cipher_suites, '0', 
                                                                                 <'43', '0x0304'>, 
                                                                                 <'10', $g1, $g>, 
                                                                                 <'40', $g1, $g1^~x>, 
                                                                                 <'45', '0', '1'>, 
                                                                                 <'42', '0'>, '41', 
                                                                                 <p_psk_id, 
                                                                                  mask(ticket_age_add,
                                                                                       $ticket_age)
                                                                                 >, 
                                                                                 hmac(<
                                                                                       Expand(Expand(Extract(Expand(ms,
                                                                                                                    <
                                                                                                                     'rms', 
                                                                                                                     h(messages)
                                                                                                                    >,
                                                                                                                    '32'),
                                                                                                             '0'),
                                                                                                     <'res', 
                                                                                                      'pbk'>,
                                                                                                     '32'),
                                                                                              <'0', '0'>,
                                                                                              '32'), 
                                                                                       h(<'0', '1', '0x0303', 
                                                                                          ~tid, '0', 
                                                                                          $cipher_suites, 
                                                                                          '0', 
                                                                                          <'43', '0x0304'>, 
                                                                                          <'10', $g1, $g>, 
                                                                                          <'40', $g1, $g1^~x
                                                                                          >, 
                                                                                          <'45', '0', '1'>, 
                                                                                          <'42', '0'>, '41', 
                                                                                          <p_psk_id, 
                                                                                           mask(ticket_age_add,
                                                                                                $ticket_age)
                                                                                          >, 
                                                                                          '0'>)
                                                                                      >)
                                                                                >, 
                                                                                '6', '0x0303', '40', $g>, 
                                                                               '1', '0x0303', ~new_nc, '0', 
                                                                               $cipher_suites.1, '0', 
                                                                               <'43', '0x0304'>, 
                                                                               <'10', $g1, $g>, 
                                                                               <'40', $g, $g^~x.1>, 
                                                                               <'45', '0', '1'>, '0', '41', 
                                                                               <p_psk_id, 
                                                                                mask(ticket_age_add, '1')>, 
                                                                               hmac(<
                                                                                     Expand(Expand(Extract(Expand(ms,
                                                                                                                  <
                                                                                                                   'rms', 
                                                                                                                   h(messages)
                                                                                                                  >,
                                                                                                                  '32'),
                                                                                                           '0'),
                                                                                                   <'res', 
                                                                                                    'pbk'>,
                                                                                                   '32'),
                                                                                            <'0', '0'>,
                                                                                            '32'), 
                                                                                     h(<
                                                                                        <
                                                                                         <'0', '1', '0x0303', 
                                                                                          ~tid, '0', 
                                                                                          $cipher_suites, 
                                                                                          '0', 
                                                                                          <'43', '0x0304'>, 
                                                                                          <'10', $g1, $g>, 
                                                                                          <'40', $g1, $g1^~x
                                                                                          >, 
                                                                                          <'45', '0', '1'>, 
                                                                                          <'42', '0'>, '41', 
                                                                                          <p_psk_id, 
                                                                                           mask(ticket_age_add,
                                                                                                $ticket_age)
                                                                                          >, 
                                                                                          hmac(<
                                                                                                Expand(Expand(Extract(Expand(ms,
                                                                                                                             <
                                                                                                                              'rms', 
                                                                                                                              h(messages)
                                                                                                                             >,
                                                                                                                             '32'),
                                                                                                                      '0'),
                                                                                                              <
                                                                                                               'res', 
                                                                                                               'pbk'
                                                                                                              >,
                                                                                                              '32'),
                                                                                                       <'0', 
                                                                                                        '0'>,
                                                                                                       '32'), 
                                                                                                h(<'0', '1', 
                                                                                                   '0x0303', 
                                                                                                   ~tid, '0', 
                                                                                                   $cipher_suites, 
                                                                                                   '0', 
                                                                                                   <'43', 
                                                                                                    '0x0304'
                                                                                                   >, 
                                                                                                   <'10', 
                                                                                                    $g1, $g>, 
                                                                                                   <'40', 
                                                                                                    $g1, 
                                                                                                    $g1^~x>, 
                                                                                                   <'45', 
                                                                                                    '0', '1'
                                                                                                   >, 
                                                                                                   <'42', '0'
                                                                                                   >, 
                                                                                                   '41', 
                                                                                                   <p_psk_id, 
                                                                                                    mask(ticket_age_add,
                                                                                                         $ticket_age)
                                                                                                   >, 
                                                                                                   '0'>)
                                                                                               >)
                                                                                         >, 
                                                                                         '6', '0x0303', '40', 
                                                                                         $g>, 
                                                                                        '1', '0x0303', 
                                                                                        ~new_nc, '0', 
                                                                                        $cipher_suites.1, 
                                                                                        '0', 
                                                                                        <'43', '0x0304'>, 
                                                                                        <'10', $g1, $g>, 
                                                                                        <'40', $g, $g^~x.1>, 
                                                                                        <'45', '0', '1'>, 
                                                                                        '0', '41', 
                                                                                        <p_psk_id, 
                                                                                         mask(ticket_age_add,
                                                                                              '1')
                                                                                        >, 
                                                                                        '0'>)
                                                                                    >)
                                                                              >, 
                                                                              '2', '0x0303', p_ns, 
                                                                              $cipher_suite, 
                                                                              <'13', $sig_algs>, '40', $g, 
                                                                              p_gy>, 
                                                                             '8', $exts>, 
                                                                            '13', '0', $certificate_extensions
                                                                           >, 
                                                                           '11', '0', pk(~ltkS)>)
                                                                       >,
                                                                       ~ltkS)
                                                                 >)
                                                              >,
                                                              '32'),
                                                       <'fin', '0'>, '32'), 
                                                h(<
                                                   <
                                                    <
                                                     <
                                                      <
                                                       <
                                                        <
                                                         <'0', '1', '0x0303', ~tid, '0', $cipher_suites, '0', 
                                                          <'43', '0x0304'>, <'10', $g1, $g>, 
                                                          <'40', $g1, $g1^~x>, <'45', '0', '1'>, <'42', '0'>, 
                                                          '41', 
                                                          <p_psk_id, mask(ticket_age_add, $ticket_age)>, 
                                                          hmac(<
                                                                Expand(Expand(Extract(Expand(ms,
                                                                                             <'rms', 
                                                                                              h(messages)>,
                                                                                             '32'),
                                                                                      '0'),
                                                                              <'res', 'pbk'>, '32'),
                                                                       <'0', '0'>, '32'), 
                                                                h(<'0', '1', '0x0303', ~tid, '0', 
                                                                   $cipher_suites, '0', <'43', '0x0304'>, 
                                                                   <'10', $g1, $g>, <'40', $g1, $g1^~x>, 
                                                                   <'45', '0', '1'>, <'42', '0'>, '41', 
                                                                   <p_psk_id, 
                                                                    mask(ticket_age_add, $ticket_age)>, 
                                                                   '0'>)
                                                               >)
                                                         >, 
                                                         '6', '0x0303', '40', $g>, 
                                                        '1', '0x0303', ~new_nc, '0', $cipher_suites.1, '0', 
                                                        <'43', '0x0304'>, <'10', $g1, $g>, 
                                                        <'40', $g, $g^~x.1>, <'45', '0', '1'>, '0', '41', 
                                                        <p_psk_id, mask(ticket_age_add, '1')>, 
                                                        hmac(<
                                                              Expand(Expand(Extract(Expand(ms,
                                                                                           <'rms', h(messages)
                                                                                           >,
                                                                                           '32'),
                                                                                    '0'),
                                                                            <'res', 'pbk'>, '32'),
                                                                     <'0', '0'>, '32'), 
                                                              h(<
                                                                 <
                                                                  <'0', '1', '0x0303', ~tid, '0', 
                                                                   $cipher_suites, '0', <'43', '0x0304'>, 
                                                                   <'10', $g1, $g>, <'40', $g1, $g1^~x>, 
                                                                   <'45', '0', '1'>, <'42', '0'>, '41', 
                                                                   <p_psk_id, 
                                                                    mask(ticket_age_add, $ticket_age)>, 
                                                                   hmac(<
                                                                         Expand(Expand(Extract(Expand(ms,
                                                                                                      <'rms', 
                                                                                                       h(messages)
                                                                                                      >,
                                                                                                      '32'),
                                                                                               '0'),
                                                                                       <'res', 'pbk'>, '32'),
                                                                                <'0', '0'>, '32'), 
                                                                         h(<'0', '1', '0x0303', ~tid, '0', 
                                                                            $cipher_suites, '0', 
                                                                            <'43', '0x0304'>, 
                                                                            <'10', $g1, $g>, 
                                                                            <'40', $g1, $g1^~x>, 
                                                                            <'45', '0', '1'>, <'42', '0'>, 
                                                                            '41', 
                                                                            <p_psk_id, 
                                                                             mask(ticket_age_add, $ticket_age)
                                                                            >, 
                                                                            '0'>)
                                                                        >)
                                                                  >, 
                                                                  '6', '0x0303', '40', $g>, 
                                                                 '1', '0x0303', ~new_nc, '0', 
                                                                 $cipher_suites.1, '0', <'43', '0x0304'>, 
                                                                 <'10', $g1, $g>, <'40', $g, $g^~x.1>, 
                                                                 <'45', '0', '1'>, '0', '41', 
                                                                 <p_psk_id, mask(ticket_age_add, '1')>, '0'>)
                                                             >)
                                                       >, 
                                                       '2', '0x0303', p_ns, $cipher_suite, <'13', $sig_algs>, 
                                                       '40', $g, p_gy>, 
                                                      '8', $exts>, 
                                                     '13', '0', $certificate_extensions>, 
                                                    '11', '0', pk(~ltkS)>, 
                                                   '15', 
                                                   sign(<'server_cv', 
                                                         h(<
                                                            <
                                                             <
                                                              <
                                                               <
                                                                <
                                                                 <'0', '1', '0x0303', ~tid, '0', 
                                                                  $cipher_suites, '0', <'43', '0x0304'>, 
                                                                  <'10', $g1, $g>, <'40', $g1, $g1^~x>, 
                                                                  <'45', '0', '1'>, <'42', '0'>, '41', 
                                                                  <p_psk_id, mask(ticket_age_add, $ticket_age)
                                                                  >, 
                                                                  hmac(<
                                                                        Expand(Expand(Extract(Expand(ms,
                                                                                                     <'rms', 
                                                                                                      h(messages)
                                                                                                     >,
                                                                                                     '32'),
                                                                                              '0'),
                                                                                      <'res', 'pbk'>, '32'),
                                                                               <'0', '0'>, '32'), 
                                                                        h(<'0', '1', '0x0303', ~tid, '0', 
                                                                           $cipher_suites, '0', 
                                                                           <'43', '0x0304'>, <'10', $g1, $g>, 
                                                                           <'40', $g1, $g1^~x>, 
                                                                           <'45', '0', '1'>, <'42', '0'>, 
                                                                           '41', 
                                                                           <p_psk_id, 
                                                                            mask(ticket_age_add, $ticket_age)
                                                                           >, 
                                                                           '0'>)
                                                                       >)
                                                                 >, 
                                                                 '6', '0x0303', '40', $g>, 
                                                                '1', '0x0303', ~new_nc, '0', 
                                                                $cipher_suites.1, '0', <'43', '0x0304'>, 
                                                                <'10', $g1, $g>, <'40', $g, $g^~x.1>, 
                                                                <'45', '0', '1'>, '0', '41', 
                                                                <p_psk_id, mask(ticket_age_add, '1')>, 
                                                                hmac(<
                                                                      Expand(Expand(Extract(Expand(ms,
                                                                                                   <'rms', 
                                                                                                    h(messages)
                                                                                                   >,
                                                                                                   '32'),
                                                                                            '0'),
                                                                                    <'res', 'pbk'>, '32'),
                                                                             <'0', '0'>, '32'), 
                                                                      h(<
                                                                         <
                                                                          <'0', '1', '0x0303', ~tid, '0', 
                                                                           $cipher_suites, '0', 
                                                                           <'43', '0x0304'>, <'10', $g1, $g>, 
                                                                           <'40', $g1, $g1^~x>, 
                                                                           <'45', '0', '1'>, <'42', '0'>, 
                                                                           '41', 
                                                                           <p_psk_id, 
                                                                            mask(ticket_age_add, $ticket_age)
                                                                           >, 
                                                                           hmac(<
                                                                                 Expand(Expand(Extract(Expand(ms,
                                                                                                              <
                                                                                                               'rms', 
                                                                                                               h(messages)
                                                                                                              >,
                                                                                                              '32'),
                                                                                                       '0'),
                                                                                               <'res', 'pbk'>,
                                                                                               '32'),
                                                                                        <'0', '0'>, '32'), 
                                                                                 h(<'0', '1', '0x0303', ~tid, 
                                                                                    '0', $cipher_suites, '0', 
                                                                                    <'43', '0x0304'>, 
                                                                                    <'10', $g1, $g>, 
                                                                                    <'40', $g1, $g1^~x>, 
                                                                                    <'45', '0', '1'>, 
                                                                                    <'42', '0'>, '41', 
                                                                                    <p_psk_id, 
                                                                                     mask(ticket_age_add,
                                                                                          $ticket_age)
                                                                                    >, 
                                                                                    '0'>)
                                                                                >)
                                                                          >, 
                                                                          '6', '0x0303', '40', $g>, 
                                                                         '1', '0x0303', ~new_nc, '0', 
                                                                         $cipher_suites.1, '0', 
                                                                         <'43', '0x0304'>, <'10', $g1, $g>, 
                                                                         <'40', $g, $g^~x.1>, 
                                                                         <'45', '0', '1'>, '0', '41', 
                                                                         <p_psk_id, mask(ticket_age_add, '1')
                                                                         >, 
                                                                         '0'>)
                                                                     >)
                                                               >, 
                                                               '2', '0x0303', p_ns, $cipher_suite, 
                                                               <'13', $sig_algs>, '40', $g, p_gy>, 
                                                              '8', $exts>, 
                                                             '13', '0', $certificate_extensions>, 
                                                            '11', '0', pk(~ltkS)>)
                                                        >,
                                                        ~ltkS)
                                                  >)
                                               >)
                                         >)
                                      >,
                                      '32')
                    ) ▶₀ #l )
        qed
      qed
    next
      case recv_server_auth_case_09
      by contradiction /* from formulas */
    next
      case recv_server_auth_case_10
      by contradiction /* from formulas */
    next
      case recv_server_auth_case_11
      by contradiction /* from formulas */
    next
      case recv_server_auth_case_12
      by contradiction /* from formulas */
    next
      case recv_server_auth_case_13
      by contradiction /* from formulas */
    next
      case recv_server_auth_case_14
      by contradiction /* from formulas */
    next
      case recv_server_auth_case_15
      by contradiction /* from formulas */
    next
      case recv_server_auth_case_16
      by contradiction /* from formulas */
    qed
  next
    case case_2
    solve( F_State_C3( ~tid, $C, $S, p_res_psk, p_messages, p_nc, p_ns, p_g,
                       p_sg, p_hrr, p_x, p_y, p_gx, p_gy, p_gxy, 'na', p_psk_id, p_edi, p_es,
                       p_hs, Extract('0', p_hs), p_cats, p_sats, p_hs_keyc, p_hs_keys,
                       p_auth_status, p_ems, p_rms, '1'
           ) ▶₀ #i )
      case recv_server_auth_case_01
      solve( !Ltk( $C, ~ltkC ) ▶₂ #i )
        case Register_pk
        by solve( SecretPSK( $A,
                             Expand(Expand(Extract('0', Extract(p_gxy, Extract('0', '0'))),
                                           <'serverats', 
                                            h(<
                                               <
                                                <
                                                 <
                                                  <
                                                   <
                                                    <'0', '1', '0x0303', ~tid, '0', $cipher_suites, '0', 
                                                     <'43', '0x0304'>, <'10', $g, $g2>, <'13', $sig_algs>, 
                                                     '40', $g, $g^~x>, 
                                                    '2', '0x0303', p_ns, $cipher_suite, <'13', $sig_algs.1>, 
                                                    '40', $g, p_gy>, 
                                                   '8', $exts>, 
                                                  '13', '0', $certificate_extensions>, 
                                                 '11', '0', pk(~ltkS)>, 
                                                '15', 
                                                sign(<'server_cv', 
                                                      h(<
                                                         <
                                                          <
                                                           <
                                                            <'0', '1', '0x0303', ~tid, '0', $cipher_suites, 
                                                             '0', <'43', '0x0304'>, <'10', $g, $g2>, 
                                                             <'13', $sig_algs>, '40', $g, $g^~x>, 
                                                            '2', '0x0303', p_ns, $cipher_suite, 
                                                            <'13', $sig_algs.1>, '40', $g, p_gy>, 
                                                           '8', $exts>, 
                                                          '13', '0', $certificate_extensions>, 
                                                         '11', '0', pk(~ltkS)>)
                                                     >,
                                                     ~ltkS)
                                               >, 
                                               '20', 
                                               hmac(<
                                                     Expand(Expand(Extract(p_gxy, Extract('0', '0')),
                                                                   <'serverhts', 
                                                                    h(<
                                                                       <
                                                                        <
                                                                         <
                                                                          <
                                                                           <'0', '1', '0x0303', ~tid, '0', 
                                                                            $cipher_suites, '0', 
                                                                            <'43', '0x0304'>, 
                                                                            <'10', $g, $g2>, 
                                                                            <'13', $sig_algs>, '40', $g, $g^~x
                                                                           >, 
                                                                           '2', '0x0303', p_ns, 
                                                                           $cipher_suite, 
                                                                           <'13', $sig_algs.1>, '40', $g, p_gy
                                                                          >, 
                                                                          '8', $exts>, 
                                                                         '13', '0', $certificate_extensions>, 
                                                                        '11', '0', pk(~ltkS)>, 
                                                                       '15', 
                                                                       sign(<'server_cv', 
                                                                             h(<
                                                                                <
                                                                                 <
                                                                                  <
                                                                                   <'0', '1', '0x0303', ~tid, 
                                                                                    '0', $cipher_suites, '0', 
                                                                                    <'43', '0x0304'>, 
                                                                                    <'10', $g, $g2>, 
                                                                                    <'13', $sig_algs>, '40', 
                                                                                    $g, $g^~x>, 
                                                                                   '2', '0x0303', p_ns, 
                                                                                   $cipher_suite, 
                                                                                   <'13', $sig_algs.1>, '40', 
                                                                                   $g, p_gy>, 
                                                                                  '8', $exts>, 
                                                                                 '13', '0', 
                                                                                 $certificate_extensions>, 
                                                                                '11', '0', pk(~ltkS)>)
                                                                            >,
                                                                            ~ltkS)
                                                                      >)
                                                                   >,
                                                                   '32'),
                                                            <'fin', '0'>, '32'), 
                                                     h(<
                                                        <
                                                         <
                                                          <
                                                           <
                                                            <'0', '1', '0x0303', ~tid, '0', $cipher_suites, 
                                                             '0', <'43', '0x0304'>, <'10', $g, $g2>, 
                                                             <'13', $sig_algs>, '40', $g, $g^~x>, 
                                                            '2', '0x0303', p_ns, $cipher_suite, 
                                                            <'13', $sig_algs.1>, '40', $g, p_gy>, 
                                                           '8', $exts>, 
                                                          '13', '0', $certificate_extensions>, 
                                                         '11', '0', pk(~ltkS)>, 
                                                        '15', 
                                                        sign(<'server_cv', 
                                                              h(<
                                                                 <
                                                                  <
                                                                   <
                                                                    <'0', '1', '0x0303', ~tid, '0', 
                                                                     $cipher_suites, '0', <'43', '0x0304'>, 
                                                                     <'10', $g, $g2>, <'13', $sig_algs>, 
                                                                     '40', $g, $g^~x>, 
                                                                    '2', '0x0303', p_ns, $cipher_suite, 
                                                                    <'13', $sig_algs.1>, '40', $g, p_gy>, 
                                                                   '8', $exts>, 
                                                                  '13', '0', $certificate_extensions>, 
                                                                 '11', '0', pk(~ltkS)>)
                                                             >,
                                                             ~ltkS)
                                                       >)
                                                    >)
                                              >)
                                           >,
                                           '32'),
                                    <'adke_wk', '0'>, '32')
                  ) ▶₀ #l )
      qed
    next
      case recv_server_auth_case_02
      solve( !Ltk( $C, ~ltkC ) ▶₂ #i )
        case Register_pk
        by solve( SecretPSK( $A,
                             Expand(Expand(Extract('0', Extract(p_gxy, Extract('0', '0'))),
                                           <'serverats', 
                                            h(<
                                               <
                                                <
                                                 <
                                                  <
                                                   <
                                                    <
                                                     <
                                                      <'0', '1', '0x0303', ~tid, '0', $cipher_suites, '0', 
                                                       <'43', '0x0304'>, <'10', $g1, $g>, <'13', $sig_algs>, 
                                                       '40', $g1, $g1^~x>, 
                                                      '6', '0x0303', '40', $g>, 
                                                     '1', '0x0303', ~tid, '0', $cipher_suites.1, '0', 
                                                     <'43', '0x0304'>, <'10', $g1, $g>, <'13', $sig_algs.1>, 
                                                     '40', $g, $g^~x.1>, 
                                                    '2', '0x0303', p_ns, $cipher_suite, <'13', $sig_algs.2>, 
                                                    '40', $g, p_gy>, 
                                                   '8', $exts>, 
                                                  '13', '0', $certificate_extensions>, 
                                                 '11', '0', pk(~ltkS)>, 
                                                '15', 
                                                sign(<'server_cv', 
                                                      h(<
                                                         <
                                                          <
                                                           <
                                                            <
                                                             <
                                                              <'0', '1', '0x0303', ~tid, '0', $cipher_suites, 
                                                               '0', <'43', '0x0304'>, <'10', $g1, $g>, 
                                                               <'13', $sig_algs>, '40', $g1, $g1^~x>, 
                                                              '6', '0x0303', '40', $g>, 
                                                             '1', '0x0303', ~tid, '0', $cipher_suites.1, '0', 
                                                             <'43', '0x0304'>, <'10', $g1, $g>, 
                                                             <'13', $sig_algs.1>, '40', $g, $g^~x.1>, 
                                                            '2', '0x0303', p_ns, $cipher_suite, 
                                                            <'13', $sig_algs.2>, '40', $g, p_gy>, 
                                                           '8', $exts>, 
                                                          '13', '0', $certificate_extensions>, 
                                                         '11', '0', pk(~ltkS)>)
                                                     >,
                                                     ~ltkS)
                                               >, 
                                               '20', 
                                               hmac(<
                                                     Expand(Expand(Extract(p_gxy, Extract('0', '0')),
                                                                   <'serverhts', 
                                                                    h(<
                                                                       <
                                                                        <
                                                                         <
                                                                          <
                                                                           <
                                                                            <
                                                                             <'0', '1', '0x0303', ~tid, '0', 
                                                                              $cipher_suites, '0', 
                                                                              <'43', '0x0304'>, 
                                                                              <'10', $g1, $g>, 
                                                                              <'13', $sig_algs>, '40', $g1, 
                                                                              $g1^~x>, 
                                                                             '6', '0x0303', '40', $g>, 
                                                                            '1', '0x0303', ~tid, '0', 
                                                                            $cipher_suites.1, '0', 
                                                                            <'43', '0x0304'>, 
                                                                            <'10', $g1, $g>, 
                                                                            <'13', $sig_algs.1>, '40', $g, 
                                                                            $g^~x.1>, 
                                                                           '2', '0x0303', p_ns, 
                                                                           $cipher_suite, 
                                                                           <'13', $sig_algs.2>, '40', $g, p_gy
                                                                          >, 
                                                                          '8', $exts>, 
                                                                         '13', '0', $certificate_extensions>, 
                                                                        '11', '0', pk(~ltkS)>, 
                                                                       '15', 
                                                                       sign(<'server_cv', 
                                                                             h(<
                                                                                <
                                                                                 <
                                                                                  <
                                                                                   <
                                                                                    <
                                                                                     <'0', '1', '0x0303', 
                                                                                      ~tid, '0', 
                                                                                      $cipher_suites, '0', 
                                                                                      <'43', '0x0304'>, 
                                                                                      <'10', $g1, $g>, 
                                                                                      <'13', $sig_algs>, 
                                                                                      '40', $g1, $g1^~x>, 
                                                                                     '6', '0x0303', '40', $g
                                                                                    >, 
                                                                                    '1', '0x0303', ~tid, '0', 
                                                                                    $cipher_suites.1, '0', 
                                                                                    <'43', '0x0304'>, 
                                                                                    <'10', $g1, $g>, 
                                                                                    <'13', $sig_algs.1>, 
                                                                                    '40', $g, $g^~x.1>, 
                                                                                   '2', '0x0303', p_ns, 
                                                                                   $cipher_suite, 
                                                                                   <'13', $sig_algs.2>, '40', 
                                                                                   $g, p_gy>, 
                                                                                  '8', $exts>, 
                                                                                 '13', '0', 
                                                                                 $certificate_extensions>, 
                                                                                '11', '0', pk(~ltkS)>)
                                                                            >,
                                                                            ~ltkS)
                                                                      >)
                                                                   >,
                                                                   '32'),
                                                            <'fin', '0'>, '32'), 
                                                     h(<
                                                        <
                                                         <
                                                          <
                                                           <
                                                            <
                                                             <
                                                              <'0', '1', '0x0303', ~tid, '0', $cipher_suites, 
                                                               '0', <'43', '0x0304'>, <'10', $g1, $g>, 
                                                               <'13', $sig_algs>, '40', $g1, $g1^~x>, 
                                                              '6', '0x0303', '40', $g>, 
                                                             '1', '0x0303', ~tid, '0', $cipher_suites.1, '0', 
                                                             <'43', '0x0304'>, <'10', $g1, $g>, 
                                                             <'13', $sig_algs.1>, '40', $g, $g^~x.1>, 
                                                            '2', '0x0303', p_ns, $cipher_suite, 
                                                            <'13', $sig_algs.2>, '40', $g, p_gy>, 
                                                           '8', $exts>, 
                                                          '13', '0', $certificate_extensions>, 
                                                         '11', '0', pk(~ltkS)>, 
                                                        '15', 
                                                        sign(<'server_cv', 
                                                              h(<
                                                                 <
                                                                  <
                                                                   <
                                                                    <
                                                                     <
                                                                      <'0', '1', '0x0303', ~tid, '0', 
                                                                       $cipher_suites, '0', <'43', '0x0304'>, 
                                                                       <'10', $g1, $g>, <'13', $sig_algs>, 
                                                                       '40', $g1, $g1^~x>, 
                                                                      '6', '0x0303', '40', $g>, 
                                                                     '1', '0x0303', ~tid, '0', 
                                                                     $cipher_suites.1, '0', <'43', '0x0304'>, 
                                                                     <'10', $g1, $g>, <'13', $sig_algs.1>, 
                                                                     '40', $g, $g^~x.1>, 
                                                                    '2', '0x0303', p_ns, $cipher_suite, 
                                                                    <'13', $sig_algs.2>, '40', $g, p_gy>, 
                                                                   '8', $exts>, 
                                                                  '13', '0', $certificate_extensions>, 
                                                                 '11', '0', pk(~ltkS)>)
                                                             >,
                                                             ~ltkS)
                                                       >)
                                                    >)
                                              >)
                                           >,
                                           '32'),
                                    <'adke_wk', '0'>, '32')
                  ) ▶₀ #l )
      qed
    next
      case recv_server_auth_case_03
      solve( !Ltk( $C, ~ltkC ) ▶₂ #i )
        case Register_pk
        by solve( SecretPSK( $A,
                             Expand(Expand(Extract('0', Extract(p_gxy, Extract(~res_psk, '0'))),
                                           <'serverats', 
                                            h(<
                                               <
                                                <
                                                 <
                                                  <
                                                   <
                                                    <
                                                     <
                                                      <'0', '1', '0x0303', ~tid, '0', $cipher_suites, '0', 
                                                       <'43', '0x0304'>, <'10', $g1, $g>, 
                                                       <'40', $g1, $g1^~x>, <'45', '0', '1'>, <'42', '0'>, 
                                                       '41', <~ticket, mask(~ticket_age_add, $ticket_age)>, 
                                                       hmac(<
                                                             Expand(Expand(Extract(~res_psk, '0'),
                                                                           <'ext', 'pbk'>, '32'),
                                                                    <'0', '0'>, '32'), 
                                                             h(<'0', '1', '0x0303', ~tid, '0', 
                                                                $cipher_suites, '0', <'43', '0x0304'>, 
                                                                <'10', $g1, $g>, <'40', $g1, $g1^~x>, 
                                                                <'45', '0', '1'>, <'42', '0'>, '41', 
                                                                <~ticket, mask(~ticket_age_add, $ticket_age)
                                                                >, 
                                                                '0'>)
                                                            >)
                                                      >, 
                                                      '6', '0x0303', '40', $g>, 
                                                     '1', '0x0303', ~tid, '0', $cipher_suites.1, '0', 
                                                     <'43', '0x0304'>, <'10', $g1, $g>, <'13', $sig_algs>, 
                                                     '40', $g, $g^~x.1>, 
                                                    '2', '0x0303', p_ns, $cipher_suite, <'13', $sig_algs.1>, 
                                                    '40', $g, p_gy>, 
                                                   '8', $exts>, 
                                                  '13', '0', $certificate_extensions>, 
                                                 '11', '0', pk(~ltkS)>, 
                                                '15', 
                                                sign(<'server_cv', 
                                                      h(<
                                                         <
                                                          <
                                                           <
                                                            <
                                                             <
                                                              <'0', '1', '0x0303', ~tid, '0', $cipher_suites, 
                                                               '0', <'43', '0x0304'>, <'10', $g1, $g>, 
                                                               <'40', $g1, $g1^~x>, <'45', '0', '1'>, 
                                                               <'42', '0'>, '41', 
                                                               <~ticket, mask(~ticket_age_add, $ticket_age)>, 
                                                               hmac(<
                                                                     Expand(Expand(Extract(~res_psk, '0'),
                                                                                   <'ext', 'pbk'>, '32'),
                                                                            <'0', '0'>, '32'), 
                                                                     h(<'0', '1', '0x0303', ~tid, '0', 
                                                                        $cipher_suites, '0', 
                                                                        <'43', '0x0304'>, <'10', $g1, $g>, 
                                                                        <'40', $g1, $g1^~x>, 
                                                                        <'45', '0', '1'>, <'42', '0'>, '41', 
                                                                        <~ticket, 
                                                                         mask(~ticket_age_add, $ticket_age)>, 
                                                                        '0'>)
                                                                    >)
                                                              >, 
                                                              '6', '0x0303', '40', $g>, 
                                                             '1', '0x0303', ~tid, '0', $cipher_suites.1, '0', 
                                                             <'43', '0x0304'>, <'10', $g1, $g>, 
                                                             <'13', $sig_algs>, '40', $g, $g^~x.1>, 
                                                            '2', '0x0303', p_ns, $cipher_suite, 
                                                            <'13', $sig_algs.1>, '40', $g, p_gy>, 
                                                           '8', $exts>, 
                                                          '13', '0', $certificate_extensions>, 
                                                         '11', '0', pk(~ltkS)>)
                                                     >,
                                                     ~ltkS)
                                               >, 
                                               '20', 
                                               hmac(<
                                                     Expand(Expand(Extract(p_gxy, Extract(~res_psk, '0')),
                                                                   <'serverhts', 
                                                                    h(<
                                                                       <
                                                                        <
                                                                         <
                                                                          <
                                                                           <
                                                                            <
                                                                             <'0', '1', '0x0303', ~tid, '0', 
                                                                              $cipher_suites, '0', 
                                                                              <'43', '0x0304'>, 
                                                                              <'10', $g1, $g>, 
                                                                              <'40', $g1, $g1^~x>, 
                                                                              <'45', '0', '1'>, <'42', '0'>, 
                                                                              '41', 
                                                                              <~ticket, 
                                                                               mask(~ticket_age_add,
                                                                                    $ticket_age)
                                                                              >, 
                                                                              hmac(<
                                                                                    Expand(Expand(Extract(~res_psk,
                                                                                                          '0'),
                                                                                                  <'ext', 
                                                                                                   'pbk'>,
                                                                                                  '32'),
                                                                                           <'0', '0'>, '32'), 
                                                                                    h(<'0', '1', '0x0303', 
                                                                                       ~tid, '0', 
                                                                                       $cipher_suites, '0', 
                                                                                       <'43', '0x0304'>, 
                                                                                       <'10', $g1, $g>, 
                                                                                       <'40', $g1, $g1^~x>, 
                                                                                       <'45', '0', '1'>, 
                                                                                       <'42', '0'>, '41', 
                                                                                       <~ticket, 
                                                                                        mask(~ticket_age_add,
                                                                                             $ticket_age)
                                                                                       >, 
                                                                                       '0'>)
                                                                                   >)
                                                                             >, 
                                                                             '6', '0x0303', '40', $g>, 
                                                                            '1', '0x0303', ~tid, '0', 
                                                                            $cipher_suites.1, '0', 
                                                                            <'43', '0x0304'>, 
                                                                            <'10', $g1, $g>, 
                                                                            <'13', $sig_algs>, '40', $g, 
                                                                            $g^~x.1>, 
                                                                           '2', '0x0303', p_ns, 
                                                                           $cipher_suite, 
                                                                           <'13', $sig_algs.1>, '40', $g, p_gy
                                                                          >, 
                                                                          '8', $exts>, 
                                                                         '13', '0', $certificate_extensions>, 
                                                                        '11', '0', pk(~ltkS)>, 
                                                                       '15', 
                                                                       sign(<'server_cv', 
                                                                             h(<
                                                                                <
                                                                                 <
                                                                                  <
                                                                                   <
                                                                                    <
                                                                                     <'0', '1', '0x0303', 
                                                                                      ~tid, '0', 
                                                                                      $cipher_suites, '0', 
                                                                                      <'43', '0x0304'>, 
                                                                                      <'10', $g1, $g>, 
                                                                                      <'40', $g1, $g1^~x>, 
                                                                                      <'45', '0', '1'>, 
                                                                                      <'42', '0'>, '41', 
                                                                                      <~ticket, 
                                                                                       mask(~ticket_age_add,
                                                                                            $ticket_age)
                                                                                      >, 
                                                                                      hmac(<
                                                                                            Expand(Expand(Extract(~res_psk,
                                                                                                                  '0'),
                                                                                                          <
                                                                                                           'ext', 
                                                                                                           'pbk'
                                                                                                          >,
                                                                                                          '32'),
                                                                                                   <'0', '0'>,
                                                                                                   '32'), 
                                                                                            h(<'0', '1', 
                                                                                               '0x0303', 
                                                                                               ~tid, '0', 
                                                                                               $cipher_suites, 
                                                                                               '0', 
                                                                                               <'43', '0x0304'
                                                                                               >, 
                                                                                               <'10', $g1, $g
                                                                                               >, 
                                                                                               <'40', $g1, 
                                                                                                $g1^~x>, 
                                                                                               <'45', '0', '1'
                                                                                               >, 
                                                                                               <'42', '0'>, 
                                                                                               '41', 
                                                                                               <~ticket, 
                                                                                                mask(~ticket_age_add,
                                                                                                     $ticket_age)
                                                                                               >, 
                                                                                               '0'>)
                                                                                           >)
                                                                                     >, 
                                                                                     '6', '0x0303', '40', $g
                                                                                    >, 
                                                                                    '1', '0x0303', ~tid, '0', 
                                                                                    $cipher_suites.1, '0', 
                                                                                    <'43', '0x0304'>, 
                                                                                    <'10', $g1, $g>, 
                                                                                    <'13', $sig_algs>, '40', 
                                                                                    $g, $g^~x.1>, 
                                                                                   '2', '0x0303', p_ns, 
                                                                                   $cipher_suite, 
                                                                                   <'13', $sig_algs.1>, '40', 
                                                                                   $g, p_gy>, 
                                                                                  '8', $exts>, 
                                                                                 '13', '0', 
                                                                                 $certificate_extensions>, 
                                                                                '11', '0', pk(~ltkS)>)
                                                                            >,
                                                                            ~ltkS)
                                                                      >)
                                                                   >,
                                                                   '32'),
                                                            <'fin', '0'>, '32'), 
                                                     h(<
                                                        <
                                                         <
                                                          <
                                                           <
                                                            <
                                                             <
                                                              <'0', '1', '0x0303', ~tid, '0', $cipher_suites, 
                                                               '0', <'43', '0x0304'>, <'10', $g1, $g>, 
                                                               <'40', $g1, $g1^~x>, <'45', '0', '1'>, 
                                                               <'42', '0'>, '41', 
                                                               <~ticket, mask(~ticket_age_add, $ticket_age)>, 
                                                               hmac(<
                                                                     Expand(Expand(Extract(~res_psk, '0'),
                                                                                   <'ext', 'pbk'>, '32'),
                                                                            <'0', '0'>, '32'), 
                                                                     h(<'0', '1', '0x0303', ~tid, '0', 
                                                                        $cipher_suites, '0', 
                                                                        <'43', '0x0304'>, <'10', $g1, $g>, 
                                                                        <'40', $g1, $g1^~x>, 
                                                                        <'45', '0', '1'>, <'42', '0'>, '41', 
                                                                        <~ticket, 
                                                                         mask(~ticket_age_add, $ticket_age)>, 
                                                                        '0'>)
                                                                    >)
                                                              >, 
                                                              '6', '0x0303', '40', $g>, 
                                                             '1', '0x0303', ~tid, '0', $cipher_suites.1, '0', 
                                                             <'43', '0x0304'>, <'10', $g1, $g>, 
                                                             <'13', $sig_algs>, '40', $g, $g^~x.1>, 
                                                            '2', '0x0303', p_ns, $cipher_suite, 
                                                            <'13', $sig_algs.1>, '40', $g, p_gy>, 
                                                           '8', $exts>, 
                                                          '13', '0', $certificate_extensions>, 
                                                         '11', '0', pk(~ltkS)>, 
                                                        '15', 
                                                        sign(<'server_cv', 
                                                              h(<
                                                                 <
                                                                  <
                                                                   <
                                                                    <
                                                                     <
                                                                      <'0', '1', '0x0303', ~tid, '0', 
                                                                       $cipher_suites, '0', <'43', '0x0304'>, 
                                                                       <'10', $g1, $g>, <'40', $g1, $g1^~x>, 
                                                                       <'45', '0', '1'>, <'42', '0'>, '41', 
                                                                       <~ticket, 
                                                                        mask(~ticket_age_add, $ticket_age)>, 
                                                                       hmac(<
                                                                             Expand(Expand(Extract(~res_psk,
                                                                                                   '0'),
                                                                                           <'ext', 'pbk'>,
                                                                                           '32'),
                                                                                    <'0', '0'>, '32'), 
                                                                             h(<'0', '1', '0x0303', ~tid, 
                                                                                '0', $cipher_suites, '0', 
                                                                                <'43', '0x0304'>, 
                                                                                <'10', $g1, $g>, 
                                                                                <'40', $g1, $g1^~x>, 
                                                                                <'45', '0', '1'>, 
                                                                                <'42', '0'>, '41', 
                                                                                <~ticket, 
                                                                                 mask(~ticket_age_add,
                                                                                      $ticket_age)
                                                                                >, 
                                                                                '0'>)
                                                                            >)
                                                                      >, 
                                                                      '6', '0x0303', '40', $g>, 
                                                                     '1', '0x0303', ~tid, '0', 
                                                                     $cipher_suites.1, '0', <'43', '0x0304'>, 
                                                                     <'10', $g1, $g>, <'13', $sig_algs>, 
                                                                     '40', $g, $g^~x.1>, 
                                                                    '2', '0x0303', p_ns, $cipher_suite, 
                                                                    <'13', $sig_algs.1>, '40', $g, p_gy>, 
                                                                   '8', $exts>, 
                                                                  '13', '0', $certificate_extensions>, 
                                                                 '11', '0', pk(~ltkS)>)
                                                             >,
                                                             ~ltkS)
                                                       >)
                                                    >)
                                              >)
                                           >,
                                           '32'),
                                    <'adke_wk', '0'>, '32')
                  ) ▶₀ #l )
      qed
    next
      case recv_server_auth_case_04
      solve( !Ltk( $C, ~ltkC ) ▶₂ #i )
        case Register_pk
        by solve( SecretPSK( $A,
                             Expand(Expand(Extract('0',
                                                   Extract(p_gxy,
                                                           Extract(Expand(ms, <'rms', h(messages)>, '32'),
                                                                   '0'))),
                                           <'serverats', 
                                            h(<
                                               <
                                                <
                                                 <
                                                  <
                                                   <
                                                    <
                                                     <
                                                      <'0', '1', '0x0303', ~tid, '0', $cipher_suites, '0', 
                                                       <'43', '0x0304'>, <'10', $g1, $g>, 
                                                       <'40', $g1, $g1^~x>, <'45', '0', '1'>, <'42', '0'>, 
                                                       '41', <p_psk_id, mask(ticket_age_add, $ticket_age)>, 
                                                       hmac(<
                                                             Expand(Expand(Extract(Expand(ms,
                                                                                          <'rms', h(messages)
                                                                                          >,
                                                                                          '32'),
                                                                                   '0'),
                                                                           <'res', 'pbk'>, '32'),
                                                                    <'0', '0'>, '32'), 
                                                             h(<'0', '1', '0x0303', ~tid, '0', 
                                                                $cipher_suites, '0', <'43', '0x0304'>, 
                                                                <'10', $g1, $g>, <'40', $g1, $g1^~x>, 
                                                                <'45', '0', '1'>, <'42', '0'>, '41', 
                                                                <p_psk_id, mask(ticket_age_add, $ticket_age)
                                                                >, 
                                                                '0'>)
                                                            >)
                                                      >, 
                                                      '6', '0x0303', '40', $g>, 
                                                     '1', '0x0303', ~tid, '0', $cipher_suites.1, '0', 
                                                     <'43', '0x0304'>, <'10', $g1, $g>, <'13', $sig_algs>, 
                                                     '40', $g, $g^~x.1>, 
                                                    '2', '0x0303', p_ns, $cipher_suite, <'13', $sig_algs.1>, 
                                                    '40', $g, p_gy>, 
                                                   '8', $exts>, 
                                                  '13', '0', $certificate_extensions>, 
                                                 '11', '0', pk(~ltkS)>, 
                                                '15', 
                                                sign(<'server_cv', 
                                                      h(<
                                                         <
                                                          <
                                                           <
                                                            <
                                                             <
                                                              <'0', '1', '0x0303', ~tid, '0', $cipher_suites, 
                                                               '0', <'43', '0x0304'>, <'10', $g1, $g>, 
                                                               <'40', $g1, $g1^~x>, <'45', '0', '1'>, 
                                                               <'42', '0'>, '41', 
                                                               <p_psk_id, mask(ticket_age_add, $ticket_age)>, 
                                                               hmac(<
                                                                     Expand(Expand(Extract(Expand(ms,
                                                                                                  <'rms', 
                                                                                                   h(messages)
                                                                                                  >,
                                                                                                  '32'),
                                                                                           '0'),
                                                                                   <'res', 'pbk'>, '32'),
                                                                            <'0', '0'>, '32'), 
                                                                     h(<'0', '1', '0x0303', ~tid, '0', 
                                                                        $cipher_suites, '0', 
                                                                        <'43', '0x0304'>, <'10', $g1, $g>, 
                                                                        <'40', $g1, $g1^~x>, 
                                                                        <'45', '0', '1'>, <'42', '0'>, '41', 
                                                                        <p_psk_id, 
                                                                         mask(ticket_age_add, $ticket_age)>, 
                                                                        '0'>)
                                                                    >)
                                                              >, 
                                                              '6', '0x0303', '40', $g>, 
                                                             '1', '0x0303', ~tid, '0', $cipher_suites.1, '0', 
                                                             <'43', '0x0304'>, <'10', $g1, $g>, 
                                                             <'13', $sig_algs>, '40', $g, $g^~x.1>, 
                                                            '2', '0x0303', p_ns, $cipher_suite, 
                                                            <'13', $sig_algs.1>, '40', $g, p_gy>, 
                                                           '8', $exts>, 
                                                          '13', '0', $certificate_extensions>, 
                                                         '11', '0', pk(~ltkS)>)
                                                     >,
                                                     ~ltkS)
                                               >, 
                                               '20', 
                                               hmac(<
                                                     Expand(Expand(Extract(p_gxy,
                                                                           Extract(Expand(ms,
                                                                                          <'rms', h(messages)
                                                                                          >,
                                                                                          '32'),
                                                                                   '0')),
                                                                   <'serverhts', 
                                                                    h(<
                                                                       <
                                                                        <
                                                                         <
                                                                          <
                                                                           <
                                                                            <
                                                                             <'0', '1', '0x0303', ~tid, '0', 
                                                                              $cipher_suites, '0', 
                                                                              <'43', '0x0304'>, 
                                                                              <'10', $g1, $g>, 
                                                                              <'40', $g1, $g1^~x>, 
                                                                              <'45', '0', '1'>, <'42', '0'>, 
                                                                              '41', 
                                                                              <p_psk_id, 
                                                                               mask(ticket_age_add,
                                                                                    $ticket_age)
                                                                              >, 
                                                                              hmac(<
                                                                                    Expand(Expand(Extract(Expand(ms,
                                                                                                                 <
                                                                                                                  'rms', 
                                                                                                                  h(messages)
                                                                                                                 >,
                                                                                                                 '32'),
                                                                                                          '0'),
                                                                                                  <'res', 
                                                                                                   'pbk'>,
                                                                                                  '32'),
                                                                                           <'0', '0'>, '32'), 
                                                                                    h(<'0', '1', '0x0303', 
                                                                                       ~tid, '0', 
                                                                                       $cipher_suites, '0', 
                                                                                       <'43', '0x0304'>, 
                                                                                       <'10', $g1, $g>, 
                                                                                       <'40', $g1, $g1^~x>, 
                                                                                       <'45', '0', '1'>, 
                                                                                       <'42', '0'>, '41', 
                                                                                       <p_psk_id, 
                                                                                        mask(ticket_age_add,
                                                                                             $ticket_age)
                                                                                       >, 
                                                                                       '0'>)
                                                                                   >)
                                                                             >, 
                                                                             '6', '0x0303', '40', $g>, 
                                                                            '1', '0x0303', ~tid, '0', 
                                                                            $cipher_suites.1, '0', 
                                                                            <'43', '0x0304'>, 
                                                                            <'10', $g1, $g>, 
                                                                            <'13', $sig_algs>, '40', $g, 
                                                                            $g^~x.1>, 
                                                                           '2', '0x0303', p_ns, 
                                                                           $cipher_suite, 
                                                                           <'13', $sig_algs.1>, '40', $g, p_gy
                                                                          >, 
                                                                          '8', $exts>, 
                                                                         '13', '0', $certificate_extensions>, 
                                                                        '11', '0', pk(~ltkS)>, 
                                                                       '15', 
                                                                       sign(<'server_cv', 
                                                                             h(<
                                                                                <
                                                                                 <
                                                                                  <
                                                                                   <
                                                                                    <
                                                                                     <'0', '1', '0x0303', 
                                                                                      ~tid, '0', 
                                                                                      $cipher_suites, '0', 
                                                                                      <'43', '0x0304'>, 
                                                                                      <'10', $g1, $g>, 
                                                                                      <'40', $g1, $g1^~x>, 
                                                                                      <'45', '0', '1'>, 
                                                                                      <'42', '0'>, '41', 
                                                                                      <p_psk_id, 
                                                                                       mask(ticket_age_add,
                                                                                            $ticket_age)
                                                                                      >, 
                                                                                      hmac(<
                                                                                            Expand(Expand(Extract(Expand(ms,
                                                                                                                         <
                                                                                                                          'rms', 
                                                                                                                          h(messages)
                                                                                                                         >,
                                                                                                                         '32'),
                                                                                                                  '0'),
                                                                                                          <
                                                                                                           'res', 
                                                                                                           'pbk'
                                                                                                          >,
                                                                                                          '32'),
                                                                                                   <'0', '0'>,
                                                                                                   '32'), 
                                                                                            h(<'0', '1', 
                                                                                               '0x0303', 
                                                                                               ~tid, '0', 
                                                                                               $cipher_suites, 
                                                                                               '0', 
                                                                                               <'43', '0x0304'
                                                                                               >, 
                                                                                               <'10', $g1, $g
                                                                                               >, 
                                                                                               <'40', $g1, 
                                                                                                $g1^~x>, 
                                                                                               <'45', '0', '1'
                                                                                               >, 
                                                                                               <'42', '0'>, 
                                                                                               '41', 
                                                                                               <p_psk_id, 
                                                                                                mask(ticket_age_add,
                                                                                                     $ticket_age)
                                                                                               >, 
                                                                                               '0'>)
                                                                                           >)
                                                                                     >, 
                                                                                     '6', '0x0303', '40', $g
                                                                                    >, 
                                                                                    '1', '0x0303', ~tid, '0', 
                                                                                    $cipher_suites.1, '0', 
                                                                                    <'43', '0x0304'>, 
                                                                                    <'10', $g1, $g>, 
                                                                                    <'13', $sig_algs>, '40', 
                                                                                    $g, $g^~x.1>, 
                                                                                   '2', '0x0303', p_ns, 
                                                                                   $cipher_suite, 
                                                                                   <'13', $sig_algs.1>, '40', 
                                                                                   $g, p_gy>, 
                                                                                  '8', $exts>, 
                                                                                 '13', '0', 
                                                                                 $certificate_extensions>, 
                                                                                '11', '0', pk(~ltkS)>)
                                                                            >,
                                                                            ~ltkS)
                                                                      >)
                                                                   >,
                                                                   '32'),
                                                            <'fin', '0'>, '32'), 
                                                     h(<
                                                        <
                                                         <
                                                          <
                                                           <
                                                            <
                                                             <
                                                              <'0', '1', '0x0303', ~tid, '0', $cipher_suites, 
                                                               '0', <'43', '0x0304'>, <'10', $g1, $g>, 
                                                               <'40', $g1, $g1^~x>, <'45', '0', '1'>, 
                                                               <'42', '0'>, '41', 
                                                               <p_psk_id, mask(ticket_age_add, $ticket_age)>, 
                                                               hmac(<
                                                                     Expand(Expand(Extract(Expand(ms,
                                                                                                  <'rms', 
                                                                                                   h(messages)
                                                                                                  >,
                                                                                                  '32'),
                                                                                           '0'),
                                                                                   <'res', 'pbk'>, '32'),
                                                                            <'0', '0'>, '32'), 
                                                                     h(<'0', '1', '0x0303', ~tid, '0', 
                                                                        $cipher_suites, '0', 
                                                                        <'43', '0x0304'>, <'10', $g1, $g>, 
                                                                        <'40', $g1, $g1^~x>, 
                                                                        <'45', '0', '1'>, <'42', '0'>, '41', 
                                                                        <p_psk_id, 
                                                                         mask(ticket_age_add, $ticket_age)>, 
                                                                        '0'>)
                                                                    >)
                                                              >, 
                                                              '6', '0x0303', '40', $g>, 
                                                             '1', '0x0303', ~tid, '0', $cipher_suites.1, '0', 
                                                             <'43', '0x0304'>, <'10', $g1, $g>, 
                                                             <'13', $sig_algs>, '40', $g, $g^~x.1>, 
                                                            '2', '0x0303', p_ns, $cipher_suite, 
                                                            <'13', $sig_algs.1>, '40', $g, p_gy>, 
                                                           '8', $exts>, 
                                                          '13', '0', $certificate_extensions>, 
                                                         '11', '0', pk(~ltkS)>, 
                                                        '15', 
                                                        sign(<'server_cv', 
                                                              h(<
                                                                 <
                                                                  <
                                                                   <
                                                                    <
                                                                     <
                                                                      <'0', '1', '0x0303', ~tid, '0', 
                                                                       $cipher_suites, '0', <'43', '0x0304'>, 
                                                                       <'10', $g1, $g>, <'40', $g1, $g1^~x>, 
                                                                       <'45', '0', '1'>, <'42', '0'>, '41', 
                                                                       <p_psk_id, 
                                                                        mask(ticket_age_add, $ticket_age)>, 
                                                                       hmac(<
                                                                             Expand(Expand(Extract(Expand(ms,
                                                                                                          <
                                                                                                           'rms', 
                                                                                                           h(messages)
                                                                                                          >,
                                                                                                          '32'),
                                                                                                   '0'),
                                                                                           <'res', 'pbk'>,
                                                                                           '32'),
                                                                                    <'0', '0'>, '32'), 
                                                                             h(<'0', '1', '0x0303', ~tid, 
                                                                                '0', $cipher_suites, '0', 
                                                                                <'43', '0x0304'>, 
                                                                                <'10', $g1, $g>, 
                                                                                <'40', $g1, $g1^~x>, 
                                                                                <'45', '0', '1'>, 
                                                                                <'42', '0'>, '41', 
                                                                                <p_psk_id, 
                                                                                 mask(ticket_age_add,
                                                                                      $ticket_age)
                                                                                >, 
                                                                                '0'>)
                                                                            >)
                                                                      >, 
                                                                      '6', '0x0303', '40', $g>, 
                                                                     '1', '0x0303', ~tid, '0', 
                                                                     $cipher_suites.1, '0', <'43', '0x0304'>, 
                                                                     <'10', $g1, $g>, <'13', $sig_algs>, 
                                                                     '40', $g, $g^~x.1>, 
                                                                    '2', '0x0303', p_ns, $cipher_suite, 
                                                                    <'13', $sig_algs.1>, '40', $g, p_gy>, 
                                                                   '8', $exts>, 
                                                                  '13', '0', $certificate_extensions>, 
                                                                 '11', '0', pk(~ltkS)>)
                                                             >,
                                                             ~ltkS)
                                                       >)
                                                    >)
                                              >)
                                           >,
                                           '32'),
                                    <'adke_wk', '0'>, '32')
                  ) ▶₀ #l )
      qed
    next
      case recv_server_auth_case_05
      solve( !Ltk( $C, ~ltkC ) ▶₂ #i )
        case Register_pk
        by solve( SecretPSK( $A,
                             Expand(Expand(Extract('0', Extract(p_gxy, Extract(~res_psk, '0'))),
                                           <'serverats', 
                                            h(<
                                               <
                                                <
                                                 <
                                                  <
                                                   <
                                                    <'0', '1', '0x0303', ~tid, '0', $cipher_suites, '0', 
                                                     <'43', '0x0304'>, <'10', $g, $g2>, <'40', $g, $g^~x>, 
                                                     <'45', '0', '1'>, <'42', '0'>, '41', 
                                                     <~ticket, mask(~ticket_age_add, $ticket_age)>, 
                                                     hmac(<
                                                           Expand(Expand(Extract(~res_psk, '0'),
                                                                         <'ext', 'pbk'>, '32'),
                                                                  <'0', '0'>, '32'), 
                                                           h(<'0', '1', '0x0303', ~tid, '0', $cipher_suites, 
                                                              '0', <'43', '0x0304'>, <'10', $g, $g2>, 
                                                              <'40', $g, $g^~x>, <'45', '0', '1'>, 
                                                              <'42', '0'>, '41', 
                                                              <~ticket, mask(~ticket_age_add, $ticket_age)>, 
                                                              '0'>)
                                                          >)
                                                    >, 
                                                    '2', '0x0303', p_ns, $cipher_suite, <'13', $sig_algs>, 
                                                    '40', $g, p_gy>, 
                                                   '8', $exts>, 
                                                  '13', '0', $certificate_extensions>, 
                                                 '11', '0', pk(~ltkS)>, 
                                                '15', 
                                                sign(<'server_cv', 
                                                      h(<
                                                         <
                                                          <
                                                           <
                                                            <'0', '1', '0x0303', ~tid, '0', $cipher_suites, 
                                                             '0', <'43', '0x0304'>, <'10', $g, $g2>, 
                                                             <'40', $g, $g^~x>, <'45', '0', '1'>, 
                                                             <'42', '0'>, '41', 
                                                             <~ticket, mask(~ticket_age_add, $ticket_age)>, 
                                                             hmac(<
                                                                   Expand(Expand(Extract(~res_psk, '0'),
                                                                                 <'ext', 'pbk'>, '32'),
                                                                          <'0', '0'>, '32'), 
                                                                   h(<'0', '1', '0x0303', ~tid, '0', 
                                                                      $cipher_suites, '0', <'43', '0x0304'>, 
                                                                      <'10', $g, $g2>, <'40', $g, $g^~x>, 
                                                                      <'45', '0', '1'>, <'42', '0'>, '41', 
                                                                      <~ticket, 
                                                                       mask(~ticket_age_add, $ticket_age)>, 
                                                                      '0'>)
                                                                  >)
                                                            >, 
                                                            '2', '0x0303', p_ns, $cipher_suite, 
                                                            <'13', $sig_algs>, '40', $g, p_gy>, 
                                                           '8', $exts>, 
                                                          '13', '0', $certificate_extensions>, 
                                                         '11', '0', pk(~ltkS)>)
                                                     >,
                                                     ~ltkS)
                                               >, 
                                               '20', 
                                               hmac(<
                                                     Expand(Expand(Extract(p_gxy, Extract(~res_psk, '0')),
                                                                   <'serverhts', 
                                                                    h(<
                                                                       <
                                                                        <
                                                                         <
                                                                          <
                                                                           <'0', '1', '0x0303', ~tid, '0', 
                                                                            $cipher_suites, '0', 
                                                                            <'43', '0x0304'>, 
                                                                            <'10', $g, $g2>, 
                                                                            <'40', $g, $g^~x>, 
                                                                            <'45', '0', '1'>, <'42', '0'>, 
                                                                            '41', 
                                                                            <~ticket, 
                                                                             mask(~ticket_age_add,
                                                                                  $ticket_age)
                                                                            >, 
                                                                            hmac(<
                                                                                  Expand(Expand(Extract(~res_psk,
                                                                                                        '0'),
                                                                                                <'ext', 'pbk'
                                                                                                >,
                                                                                                '32'),
                                                                                         <'0', '0'>, '32'), 
                                                                                  h(<'0', '1', '0x0303', 
                                                                                     ~tid, '0', 
                                                                                     $cipher_suites, '0', 
                                                                                     <'43', '0x0304'>, 
                                                                                     <'10', $g, $g2>, 
                                                                                     <'40', $g, $g^~x>, 
                                                                                     <'45', '0', '1'>, 
                                                                                     <'42', '0'>, '41', 
                                                                                     <~ticket, 
                                                                                      mask(~ticket_age_add,
                                                                                           $ticket_age)
                                                                                     >, 
                                                                                     '0'>)
                                                                                 >)
                                                                           >, 
                                                                           '2', '0x0303', p_ns, 
                                                                           $cipher_suite, <'13', $sig_algs>, 
                                                                           '40', $g, p_gy>, 
                                                                          '8', $exts>, 
                                                                         '13', '0', $certificate_extensions>, 
                                                                        '11', '0', pk(~ltkS)>, 
                                                                       '15', 
                                                                       sign(<'server_cv', 
                                                                             h(<
                                                                                <
                                                                                 <
                                                                                  <
                                                                                   <'0', '1', '0x0303', ~tid, 
                                                                                    '0', $cipher_suites, '0', 
                                                                                    <'43', '0x0304'>, 
                                                                                    <'10', $g, $g2>, 
                                                                                    <'40', $g, $g^~x>, 
                                                                                    <'45', '0', '1'>, 
                                                                                    <'42', '0'>, '41', 
                                                                                    <~ticket, 
                                                                                     mask(~ticket_age_add,
                                                                                          $ticket_age)
                                                                                    >, 
                                                                                    hmac(<
                                                                                          Expand(Expand(Extract(~res_psk,
                                                                                                                '0'),
                                                                                                        <
                                                                                                         'ext', 
                                                                                                         'pbk'
                                                                                                        >,
                                                                                                        '32'),
                                                                                                 <'0', '0'>,
                                                                                                 '32'), 
                                                                                          h(<'0', '1', 
                                                                                             '0x0303', ~tid, 
                                                                                             '0', 
                                                                                             $cipher_suites, 
                                                                                             '0', 
                                                                                             <'43', '0x0304'
                                                                                             >, 
                                                                                             <'10', $g, $g2>, 
                                                                                             <'40', $g, $g^~x
                                                                                             >, 
                                                                                             <'45', '0', '1'
                                                                                             >, 
                                                                                             <'42', '0'>, 
                                                                                             '41', 
                                                                                             <~ticket, 
                                                                                              mask(~ticket_age_add,
                                                                                                   $ticket_age)
                                                                                             >, 
                                                                                             '0'>)
                                                                                         >)
                                                                                   >, 
                                                                                   '2', '0x0303', p_ns, 
                                                                                   $cipher_suite, 
                                                                                   <'13', $sig_algs>, '40', 
                                                                                   $g, p_gy>, 
                                                                                  '8', $exts>, 
                                                                                 '13', '0', 
                                                                                 $certificate_extensions>, 
                                                                                '11', '0', pk(~ltkS)>)
                                                                            >,
                                                                            ~ltkS)
                                                                      >)
                                                                   >,
                                                                   '32'),
                                                            <'fin', '0'>, '32'), 
                                                     h(<
                                                        <
                                                         <
                                                          <
                                                           <
                                                            <'0', '1', '0x0303', ~tid, '0', $cipher_suites, 
                                                             '0', <'43', '0x0304'>, <'10', $g, $g2>, 
                                                             <'40', $g, $g^~x>, <'45', '0', '1'>, 
                                                             <'42', '0'>, '41', 
                                                             <~ticket, mask(~ticket_age_add, $ticket_age)>, 
                                                             hmac(<
                                                                   Expand(Expand(Extract(~res_psk, '0'),
                                                                                 <'ext', 'pbk'>, '32'),
                                                                          <'0', '0'>, '32'), 
                                                                   h(<'0', '1', '0x0303', ~tid, '0', 
                                                                      $cipher_suites, '0', <'43', '0x0304'>, 
                                                                      <'10', $g, $g2>, <'40', $g, $g^~x>, 
                                                                      <'45', '0', '1'>, <'42', '0'>, '41', 
                                                                      <~ticket, 
                                                                       mask(~ticket_age_add, $ticket_age)>, 
                                                                      '0'>)
                                                                  >)
                                                            >, 
                                                            '2', '0x0303', p_ns, $cipher_suite, 
                                                            <'13', $sig_algs>, '40', $g, p_gy>, 
                                                           '8', $exts>, 
                                                          '13', '0', $certificate_extensions>, 
                                                         '11', '0', pk(~ltkS)>, 
                                                        '15', 
                                                        sign(<'server_cv', 
                                                              h(<
                                                                 <
                                                                  <
                                                                   <
                                                                    <'0', '1', '0x0303', ~tid, '0', 
                                                                     $cipher_suites, '0', <'43', '0x0304'>, 
                                                                     <'10', $g, $g2>, <'40', $g, $g^~x>, 
                                                                     <'45', '0', '1'>, <'42', '0'>, '41', 
                                                                     <~ticket, 
                                                                      mask(~ticket_age_add, $ticket_age)>, 
                                                                     hmac(<
                                                                           Expand(Expand(Extract(~res_psk,
                                                                                                 '0'),
                                                                                         <'ext', 'pbk'>,
                                                                                         '32'),
                                                                                  <'0', '0'>, '32'), 
                                                                           h(<'0', '1', '0x0303', ~tid, '0', 
                                                                              $cipher_suites, '0', 
                                                                              <'43', '0x0304'>, 
                                                                              <'10', $g, $g2>, 
                                                                              <'40', $g, $g^~x>, 
                                                                              <'45', '0', '1'>, <'42', '0'>, 
                                                                              '41', 
                                                                              <~ticket, 
                                                                               mask(~ticket_age_add,
                                                                                    $ticket_age)
                                                                              >, 
                                                                              '0'>)
                                                                          >)
                                                                    >, 
                                                                    '2', '0x0303', p_ns, $cipher_suite, 
                                                                    <'13', $sig_algs>, '40', $g, p_gy>, 
                                                                   '8', $exts>, 
                                                                  '13', '0', $certificate_extensions>, 
                                                                 '11', '0', pk(~ltkS)>)
                                                             >,
                                                             ~ltkS)
                                                       >)
                                                    >)
                                              >)
                                           >,
                                           '32'),
                                    <'adke_wk', '0'>, '32')
                  ) ▶₀ #l )
      qed
    next
      case recv_server_auth_case_06
      solve( !Ltk( $C, ~ltkC ) ▶₂ #i )
        case Register_pk
        by solve( SecretPSK( $A,
                             Expand(Expand(Extract('0',
                                                   Extract(p_gxy,
                                                           Extract(Expand(ms, <'rms', h(messages)>, '32'),
                                                                   '0'))),
                                           <'serverats', 
                                            h(<
                                               <
                                                <
                                                 <
                                                  <
                                                   <
                                                    <'0', '1', '0x0303', ~tid, '0', $cipher_suites, '0', 
                                                     <'43', '0x0304'>, <'10', $g, $g2>, <'40', $g, $g^~x>, 
                                                     <'45', '0', '1'>, <'42', '0'>, '41', 
                                                     <p_psk_id, mask(ticket_age_add, $ticket_age)>, 
                                                     hmac(<
                                                           Expand(Expand(Extract(Expand(ms,
                                                                                        <'rms', h(messages)>,
                                                                                        '32'),
                                                                                 '0'),
                                                                         <'res', 'pbk'>, '32'),
                                                                  <'0', '0'>, '32'), 
                                                           h(<'0', '1', '0x0303', ~tid, '0', $cipher_suites, 
                                                              '0', <'43', '0x0304'>, <'10', $g, $g2>, 
                                                              <'40', $g, $g^~x>, <'45', '0', '1'>, 
                                                              <'42', '0'>, '41', 
                                                              <p_psk_id, mask(ticket_age_add, $ticket_age)>, 
                                                              '0'>)
                                                          >)
                                                    >, 
                                                    '2', '0x0303', p_ns, $cipher_suite, <'13', $sig_algs>, 
                                                    '40', $g, p_gy>, 
                                                   '8', $exts>, 
                                                  '13', '0', $certificate_extensions>, 
                                                 '11', '0', pk(~ltkS)>, 
                                                '15', 
                                                sign(<'server_cv', 
                                                      h(<
                                                         <
                                                          <
                                                           <
                                                            <'0', '1', '0x0303', ~tid, '0', $cipher_suites, 
                                                             '0', <'43', '0x0304'>, <'10', $g, $g2>, 
                                                             <'40', $g, $g^~x>, <'45', '0', '1'>, 
                                                             <'42', '0'>, '41', 
                                                             <p_psk_id, mask(ticket_age_add, $ticket_age)>, 
                                                             hmac(<
                                                                   Expand(Expand(Extract(Expand(ms,
                                                                                                <'rms', 
                                                                                                 h(messages)>,
                                                                                                '32'),
                                                                                         '0'),
                                                                                 <'res', 'pbk'>, '32'),
                                                                          <'0', '0'>, '32'), 
                                                                   h(<'0', '1', '0x0303', ~tid, '0', 
                                                                      $cipher_suites, '0', <'43', '0x0304'>, 
                                                                      <'10', $g, $g2>, <'40', $g, $g^~x>, 
                                                                      <'45', '0', '1'>, <'42', '0'>, '41', 
                                                                      <p_psk_id, 
                                                                       mask(ticket_age_add, $ticket_age)>, 
                                                                      '0'>)
                                                                  >)
                                                            >, 
                                                            '2', '0x0303', p_ns, $cipher_suite, 
                                                            <'13', $sig_algs>, '40', $g, p_gy>, 
                                                           '8', $exts>, 
                                                          '13', '0', $certificate_extensions>, 
                                                         '11', '0', pk(~ltkS)>)
                                                     >,
                                                     ~ltkS)
                                               >, 
                                               '20', 
                                               hmac(<
                                                     Expand(Expand(Extract(p_gxy,
                                                                           Extract(Expand(ms,
                                                                                          <'rms', h(messages)
                                                                                          >,
                                                                                          '32'),
                                                                                   '0')),
                                                                   <'serverhts', 
                                                                    h(<
                                                                       <
                                                                        <
                                                                         <
                                                                          <
                                                                           <'0', '1', '0x0303', ~tid, '0', 
                                                                            $cipher_suites, '0', 
                                                                            <'43', '0x0304'>, 
                                                                            <'10', $g, $g2>, 
                                                                            <'40', $g, $g^~x>, 
                                                                            <'45', '0', '1'>, <'42', '0'>, 
                                                                            '41', 
                                                                            <p_psk_id, 
                                                                             mask(ticket_age_add, $ticket_age)
                                                                            >, 
                                                                            hmac(<
                                                                                  Expand(Expand(Extract(Expand(ms,
                                                                                                               <
                                                                                                                'rms', 
                                                                                                                h(messages)
                                                                                                               >,
                                                                                                               '32'),
                                                                                                        '0'),
                                                                                                <'res', 'pbk'
                                                                                                >,
                                                                                                '32'),
                                                                                         <'0', '0'>, '32'), 
                                                                                  h(<'0', '1', '0x0303', 
                                                                                     ~tid, '0', 
                                                                                     $cipher_suites, '0', 
                                                                                     <'43', '0x0304'>, 
                                                                                     <'10', $g, $g2>, 
                                                                                     <'40', $g, $g^~x>, 
                                                                                     <'45', '0', '1'>, 
                                                                                     <'42', '0'>, '41', 
                                                                                     <p_psk_id, 
                                                                                      mask(ticket_age_add,
                                                                                           $ticket_age)
                                                                                     >, 
                                                                                     '0'>)
                                                                                 >)
                                                                           >, 
                                                                           '2', '0x0303', p_ns, 
                                                                           $cipher_suite, <'13', $sig_algs>, 
                                                                           '40', $g, p_gy>, 
                                                                          '8', $exts>, 
                                                                         '13', '0', $certificate_extensions>, 
                                                                        '11', '0', pk(~ltkS)>, 
                                                                       '15', 
                                                                       sign(<'server_cv', 
                                                                             h(<
                                                                                <
                                                                                 <
                                                                                  <
                                                                                   <'0', '1', '0x0303', ~tid, 
                                                                                    '0', $cipher_suites, '0', 
                                                                                    <'43', '0x0304'>, 
                                                                                    <'10', $g, $g2>, 
                                                                                    <'40', $g, $g^~x>, 
                                                                                    <'45', '0', '1'>, 
                                                                                    <'42', '0'>, '41', 
                                                                                    <p_psk_id, 
                                                                                     mask(ticket_age_add,
                                                                                          $ticket_age)
                                                                                    >, 
                                                                                    hmac(<
                                                                                          Expand(Expand(Extract(Expand(ms,
                                                                                                                       <
                                                                                                                        'rms', 
                                                                                                                        h(messages)
                                                                                                                       >,
                                                                                                                       '32'),
                                                                                                                '0'),
                                                                                                        <
                                                                                                         'res', 
                                                                                                         'pbk'
                                                                                                        >,
                                                                                                        '32'),
                                                                                                 <'0', '0'>,
                                                                                                 '32'), 
                                                                                          h(<'0', '1', 
                                                                                             '0x0303', ~tid, 
                                                                                             '0', 
                                                                                             $cipher_suites, 
                                                                                             '0', 
                                                                                             <'43', '0x0304'
                                                                                             >, 
                                                                                             <'10', $g, $g2>, 
                                                                                             <'40', $g, $g^~x
                                                                                             >, 
                                                                                             <'45', '0', '1'
                                                                                             >, 
                                                                                             <'42', '0'>, 
                                                                                             '41', 
                                                                                             <p_psk_id, 
                                                                                              mask(ticket_age_add,
                                                                                                   $ticket_age)
                                                                                             >, 
                                                                                             '0'>)
                                                                                         >)
                                                                                   >, 
                                                                                   '2', '0x0303', p_ns, 
                                                                                   $cipher_suite, 
                                                                                   <'13', $sig_algs>, '40', 
                                                                                   $g, p_gy>, 
                                                                                  '8', $exts>, 
                                                                                 '13', '0', 
                                                                                 $certificate_extensions>, 
                                                                                '11', '0', pk(~ltkS)>)
                                                                            >,
                                                                            ~ltkS)
                                                                      >)
                                                                   >,
                                                                   '32'),
                                                            <'fin', '0'>, '32'), 
                                                     h(<
                                                        <
                                                         <
                                                          <
                                                           <
                                                            <'0', '1', '0x0303', ~tid, '0', $cipher_suites, 
                                                             '0', <'43', '0x0304'>, <'10', $g, $g2>, 
                                                             <'40', $g, $g^~x>, <'45', '0', '1'>, 
                                                             <'42', '0'>, '41', 
                                                             <p_psk_id, mask(ticket_age_add, $ticket_age)>, 
                                                             hmac(<
                                                                   Expand(Expand(Extract(Expand(ms,
                                                                                                <'rms', 
                                                                                                 h(messages)>,
                                                                                                '32'),
                                                                                         '0'),
                                                                                 <'res', 'pbk'>, '32'),
                                                                          <'0', '0'>, '32'), 
                                                                   h(<'0', '1', '0x0303', ~tid, '0', 
                                                                      $cipher_suites, '0', <'43', '0x0304'>, 
                                                                      <'10', $g, $g2>, <'40', $g, $g^~x>, 
                                                                      <'45', '0', '1'>, <'42', '0'>, '41', 
                                                                      <p_psk_id, 
                                                                       mask(ticket_age_add, $ticket_age)>, 
                                                                      '0'>)
                                                                  >)
                                                            >, 
                                                            '2', '0x0303', p_ns, $cipher_suite, 
                                                            <'13', $sig_algs>, '40', $g, p_gy>, 
                                                           '8', $exts>, 
                                                          '13', '0', $certificate_extensions>, 
                                                         '11', '0', pk(~ltkS)>, 
                                                        '15', 
                                                        sign(<'server_cv', 
                                                              h(<
                                                                 <
                                                                  <
                                                                   <
                                                                    <'0', '1', '0x0303', ~tid, '0', 
                                                                     $cipher_suites, '0', <'43', '0x0304'>, 
                                                                     <'10', $g, $g2>, <'40', $g, $g^~x>, 
                                                                     <'45', '0', '1'>, <'42', '0'>, '41', 
                                                                     <p_psk_id, 
                                                                      mask(ticket_age_add, $ticket_age)>, 
                                                                     hmac(<
                                                                           Expand(Expand(Extract(Expand(ms,
                                                                                                        <
                                                                                                         'rms', 
                                                                                                         h(messages)
                                                                                                        >,
                                                                                                        '32'),
                                                                                                 '0'),
                                                                                         <'res', 'pbk'>,
                                                                                         '32'),
                                                                                  <'0', '0'>, '32'), 
                                                                           h(<'0', '1', '0x0303', ~tid, '0', 
                                                                              $cipher_suites, '0', 
                                                                              <'43', '0x0304'>, 
                                                                              <'10', $g, $g2>, 
                                                                              <'40', $g, $g^~x>, 
                                                                              <'45', '0', '1'>, <'42', '0'>, 
                                                                              '41', 
                                                                              <p_psk_id, 
                                                                               mask(ticket_age_add,
                                                                                    $ticket_age)
                                                                              >, 
                                                                              '0'>)
                                                                          >)
                                                                    >, 
                                                                    '2', '0x0303', p_ns, $cipher_suite, 
                                                                    <'13', $sig_algs>, '40', $g, p_gy>, 
                                                                   '8', $exts>, 
                                                                  '13', '0', $certificate_extensions>, 
                                                                 '11', '0', pk(~ltkS)>)
                                                             >,
                                                             ~ltkS)
                                                       >)
                                                    >)
                                              >)
                                           >,
                                           '32'),
                                    <'adke_wk', '0'>, '32')
                  ) ▶₀ #l )
      qed
    next
      case recv_server_auth_case_07
      solve( !Ltk( $C, ~ltkC ) ▶₂ #i )
        case Register_pk
        by solve( SecretPSK( $A,
                             Expand(Expand(Extract('0', Extract(p_gxy, Extract(~res_psk, '0'))),
                                           <'serverats', 
                                            h(<
                                               <
                                                <
                                                 <
                                                  <
                                                   <
                                                    <
                                                     <
                                                      <'0', '1', '0x0303', ~tid, '0', $cipher_suites, '0', 
                                                       <'43', '0x0304'>, <'10', $g1, $g>, 
                                                       <'40', $g1, $g1^~x>, <'45', '0', '1'>, <'42', '0'>, 
                                                       '41', <~ticket, mask(~ticket_age_add, $ticket_age)>, 
                                                       hmac(<
                                                             Expand(Expand(Extract(~res_psk, '0'),
                                                                           <'ext', 'pbk'>, '32'),
                                                                    <'0', '0'>, '32'), 
                                                             h(<'0', '1', '0x0303', ~tid, '0', 
                                                                $cipher_suites, '0', <'43', '0x0304'>, 
                                                                <'10', $g1, $g>, <'40', $g1, $g1^~x>, 
                                                                <'45', '0', '1'>, <'42', '0'>, '41', 
                                                                <~ticket, mask(~ticket_age_add, $ticket_age)
                                                                >, 
                                                                '0'>)
                                                            >)
                                                      >, 
                                                      '6', '0x0303', '40', $g>, 
                                                     '1', '0x0303', ~new_nc, '0', $cipher_suites.1, '0', 
                                                     <'43', '0x0304'>, <'10', $g1, $g>, <'40', $g, $g^~x.1>, 
                                                     <'45', '0', '1'>, '0', '41', 
                                                     <~ticket, mask(~ticket_age_add, '1')>, 
                                                     hmac(<
                                                           Expand(Expand(Extract(~res_psk, '0'),
                                                                         <'ext', 'pbk'>, '32'),
                                                                  <'0', '0'>, '32'), 
                                                           h(<
                                                              <
                                                               <'0', '1', '0x0303', ~tid, '0', 
                                                                $cipher_suites, '0', <'43', '0x0304'>, 
                                                                <'10', $g1, $g>, <'40', $g1, $g1^~x>, 
                                                                <'45', '0', '1'>, <'42', '0'>, '41', 
                                                                <~ticket, mask(~ticket_age_add, $ticket_age)
                                                                >, 
                                                                hmac(<
                                                                      Expand(Expand(Extract(~res_psk, '0'),
                                                                                    <'ext', 'pbk'>, '32'),
                                                                             <'0', '0'>, '32'), 
                                                                      h(<'0', '1', '0x0303', ~tid, '0', 
                                                                         $cipher_suites, '0', 
                                                                         <'43', '0x0304'>, <'10', $g1, $g>, 
                                                                         <'40', $g1, $g1^~x>, 
                                                                         <'45', '0', '1'>, <'42', '0'>, '41', 
                                                                         <~ticket, 
                                                                          mask(~ticket_age_add, $ticket_age)
                                                                         >, 
                                                                         '0'>)
                                                                     >)
                                                               >, 
                                                               '6', '0x0303', '40', $g>, 
                                                              '1', '0x0303', ~new_nc, '0', $cipher_suites.1, 
                                                              '0', <'43', '0x0304'>, <'10', $g1, $g>, 
                                                              <'40', $g, $g^~x.1>, <'45', '0', '1'>, '0', 
                                                              '41', <~ticket, mask(~ticket_age_add, '1')>, '0'
                                                             >)
                                                          >)
                                                    >, 
                                                    '2', '0x0303', p_ns, $cipher_suite, <'13', $sig_algs>, 
                                                    '40', $g, p_gy>, 
                                                   '8', $exts>, 
                                                  '13', '0', $certificate_extensions>, 
                                                 '11', '0', pk(~ltkS)>, 
                                                '15', 
                                                sign(<'server_cv', 
                                                      h(<
                                                         <
                                                          <
                                                           <
                                                            <
                                                             <
                                                              <'0', '1', '0x0303', ~tid, '0', $cipher_suites, 
                                                               '0', <'43', '0x0304'>, <'10', $g1, $g>, 
                                                               <'40', $g1, $g1^~x>, <'45', '0', '1'>, 
                                                               <'42', '0'>, '41', 
                                                               <~ticket, mask(~ticket_age_add, $ticket_age)>, 
                                                               hmac(<
                                                                     Expand(Expand(Extract(~res_psk, '0'),
                                                                                   <'ext', 'pbk'>, '32'),
                                                                            <'0', '0'>, '32'), 
                                                                     h(<'0', '1', '0x0303', ~tid, '0', 
                                                                        $cipher_suites, '0', 
                                                                        <'43', '0x0304'>, <'10', $g1, $g>, 
                                                                        <'40', $g1, $g1^~x>, 
                                                                        <'45', '0', '1'>, <'42', '0'>, '41', 
                                                                        <~ticket, 
                                                                         mask(~ticket_age_add, $ticket_age)>, 
                                                                        '0'>)
                                                                    >)
                                                              >, 
                                                              '6', '0x0303', '40', $g>, 
                                                             '1', '0x0303', ~new_nc, '0', $cipher_suites.1, 
                                                             '0', <'43', '0x0304'>, <'10', $g1, $g>, 
                                                             <'40', $g, $g^~x.1>, <'45', '0', '1'>, '0', 
                                                             '41', <~ticket, mask(~ticket_age_add, '1')>, 
                                                             hmac(<
                                                                   Expand(Expand(Extract(~res_psk, '0'),
                                                                                 <'ext', 'pbk'>, '32'),
                                                                          <'0', '0'>, '32'), 
                                                                   h(<
                                                                      <
                                                                       <'0', '1', '0x0303', ~tid, '0', 
                                                                        $cipher_suites, '0', 
                                                                        <'43', '0x0304'>, <'10', $g1, $g>, 
                                                                        <'40', $g1, $g1^~x>, 
                                                                        <'45', '0', '1'>, <'42', '0'>, '41', 
                                                                        <~ticket, 
                                                                         mask(~ticket_age_add, $ticket_age)>, 
                                                                        hmac(<
                                                                              Expand(Expand(Extract(~res_psk,
                                                                                                    '0'),
                                                                                            <'ext', 'pbk'>,
                                                                                            '32'),
                                                                                     <'0', '0'>, '32'), 
                                                                              h(<'0', '1', '0x0303', ~tid, 
                                                                                 '0', $cipher_suites, '0', 
                                                                                 <'43', '0x0304'>, 
                                                                                 <'10', $g1, $g>, 
                                                                                 <'40', $g1, $g1^~x>, 
                                                                                 <'45', '0', '1'>, 
                                                                                 <'42', '0'>, '41', 
                                                                                 <~ticket, 
                                                                                  mask(~ticket_age_add,
                                                                                       $ticket_age)
                                                                                 >, 
                                                                                 '0'>)
                                                                             >)
                                                                       >, 
                                                                       '6', '0x0303', '40', $g>, 
                                                                      '1', '0x0303', ~new_nc, '0', 
                                                                      $cipher_suites.1, '0', 
                                                                      <'43', '0x0304'>, <'10', $g1, $g>, 
                                                                      <'40', $g, $g^~x.1>, <'45', '0', '1'>, 
                                                                      '0', '41', 
                                                                      <~ticket, mask(~ticket_age_add, '1')>, 
                                                                      '0'>)
                                                                  >)
                                                            >, 
                                                            '2', '0x0303', p_ns, $cipher_suite, 
                                                            <'13', $sig_algs>, '40', $g, p_gy>, 
                                                           '8', $exts>, 
                                                          '13', '0', $certificate_extensions>, 
                                                         '11', '0', pk(~ltkS)>)
                                                     >,
                                                     ~ltkS)
                                               >, 
                                               '20', 
                                               hmac(<
                                                     Expand(Expand(Extract(p_gxy, Extract(~res_psk, '0')),
                                                                   <'serverhts', 
                                                                    h(<
                                                                       <
                                                                        <
                                                                         <
                                                                          <
                                                                           <
                                                                            <
                                                                             <'0', '1', '0x0303', ~tid, '0', 
                                                                              $cipher_suites, '0', 
                                                                              <'43', '0x0304'>, 
                                                                              <'10', $g1, $g>, 
                                                                              <'40', $g1, $g1^~x>, 
                                                                              <'45', '0', '1'>, <'42', '0'>, 
                                                                              '41', 
                                                                              <~ticket, 
                                                                               mask(~ticket_age_add,
                                                                                    $ticket_age)
                                                                              >, 
                                                                              hmac(<
                                                                                    Expand(Expand(Extract(~res_psk,
                                                                                                          '0'),
                                                                                                  <'ext', 
                                                                                                   'pbk'>,
                                                                                                  '32'),
                                                                                           <'0', '0'>, '32'), 
                                                                                    h(<'0', '1', '0x0303', 
                                                                                       ~tid, '0', 
                                                                                       $cipher_suites, '0', 
                                                                                       <'43', '0x0304'>, 
                                                                                       <'10', $g1, $g>, 
                                                                                       <'40', $g1, $g1^~x>, 
                                                                                       <'45', '0', '1'>, 
                                                                                       <'42', '0'>, '41', 
                                                                                       <~ticket, 
                                                                                        mask(~ticket_age_add,
                                                                                             $ticket_age)
                                                                                       >, 
                                                                                       '0'>)
                                                                                   >)
                                                                             >, 
                                                                             '6', '0x0303', '40', $g>, 
                                                                            '1', '0x0303', ~new_nc, '0', 
                                                                            $cipher_suites.1, '0', 
                                                                            <'43', '0x0304'>, 
                                                                            <'10', $g1, $g>, 
                                                                            <'40', $g, $g^~x.1>, 
                                                                            <'45', '0', '1'>, '0', '41', 
                                                                            <~ticket, 
                                                                             mask(~ticket_age_add, '1')>, 
                                                                            hmac(<
                                                                                  Expand(Expand(Extract(~res_psk,
                                                                                                        '0'),
                                                                                                <'ext', 'pbk'
                                                                                                >,
                                                                                                '32'),
                                                                                         <'0', '0'>, '32'), 
                                                                                  h(<
                                                                                     <
                                                                                      <'0', '1', '0x0303', 
                                                                                       ~tid, '0', 
                                                                                       $cipher_suites, '0', 
                                                                                       <'43', '0x0304'>, 
                                                                                       <'10', $g1, $g>, 
                                                                                       <'40', $g1, $g1^~x>, 
                                                                                       <'45', '0', '1'>, 
                                                                                       <'42', '0'>, '41', 
                                                                                       <~ticket, 
                                                                                        mask(~ticket_age_add,
                                                                                             $ticket_age)
                                                                                       >, 
                                                                                       hmac(<
                                                                                             Expand(Expand(Extract(~res_psk,
                                                                                                                   '0'),
                                                                                                           <
                                                                                                            'ext', 
                                                                                                            'pbk'
                                                                                                           >,
                                                                                                           '32'),
                                                                                                    <'0', '0'
                                                                                                    >,
                                                                                                    '32'), 
                                                                                             h(<'0', '1', 
                                                                                                '0x0303', 
                                                                                                ~tid, '0', 
                                                                                                $cipher_suites, 
                                                                                                '0', 
                                                                                                <'43', 
                                                                                                 '0x0304'>, 
                                                                                                <'10', $g1, $g
                                                                                                >, 
                                                                                                <'40', $g1, 
                                                                                                 $g1^~x>, 
                                                                                                <'45', '0', 
                                                                                                 '1'>, 
                                                                                                <'42', '0'>, 
                                                                                                '41', 
                                                                                                <~ticket, 
                                                                                                 mask(~ticket_age_add,
                                                                                                      $ticket_age)
                                                                                                >, 
                                                                                                '0'>)
                                                                                            >)
                                                                                      >, 
                                                                                      '6', '0x0303', '40', $g
                                                                                     >, 
                                                                                     '1', '0x0303', ~new_nc, 
                                                                                     '0', $cipher_suites.1, 
                                                                                     '0', <'43', '0x0304'>, 
                                                                                     <'10', $g1, $g>, 
                                                                                     <'40', $g, $g^~x.1>, 
                                                                                     <'45', '0', '1'>, '0', 
                                                                                     '41', 
                                                                                     <~ticket, 
                                                                                      mask(~ticket_age_add,
                                                                                           '1')
                                                                                     >, 
                                                                                     '0'>)
                                                                                 >)
                                                                           >, 
                                                                           '2', '0x0303', p_ns, 
                                                                           $cipher_suite, <'13', $sig_algs>, 
                                                                           '40', $g, p_gy>, 
                                                                          '8', $exts>, 
                                                                         '13', '0', $certificate_extensions>, 
                                                                        '11', '0', pk(~ltkS)>, 
                                                                       '15', 
                                                                       sign(<'server_cv', 
                                                                             h(<
                                                                                <
                                                                                 <
                                                                                  <
                                                                                   <
                                                                                    <
                                                                                     <'0', '1', '0x0303', 
                                                                                      ~tid, '0', 
                                                                                      $cipher_suites, '0', 
                                                                                      <'43', '0x0304'>, 
                                                                                      <'10', $g1, $g>, 
                                                                                      <'40', $g1, $g1^~x>, 
                                                                                      <'45', '0', '1'>, 
                                                                                      <'42', '0'>, '41', 
                                                                                      <~ticket, 
                                                                                       mask(~ticket_age_add,
                                                                                            $ticket_age)
                                                                                      >, 
                                                                                      hmac(<
                                                                                            Expand(Expand(Extract(~res_psk,
                                                                                                                  '0'),
                                                                                                          <
                                                                                                           'ext', 
                                                                                                           'pbk'
                                                                                                          >,
                                                                                                          '32'),
                                                                                                   <'0', '0'>,
                                                                                                   '32'), 
                                                                                            h(<'0', '1', 
                                                                                               '0x0303', 
                                                                                               ~tid, '0', 
                                                                                               $cipher_suites, 
                                                                                               '0', 
                                                                                               <'43', '0x0304'
                                                                                               >, 
                                                                                               <'10', $g1, $g
                                                                                               >, 
                                                                                               <'40', $g1, 
                                                                                                $g1^~x>, 
                                                                                               <'45', '0', '1'
                                                                                               >, 
                                                                                               <'42', '0'>, 
                                                                                               '41', 
                                                                                               <~ticket, 
                                                                                                mask(~ticket_age_add,
                                                                                                     $ticket_age)
                                                                                               >, 
                                                                                               '0'>)
                                                                                           >)
                                                                                     >, 
                                                                                     '6', '0x0303', '40', $g
                                                                                    >, 
                                                                                    '1', '0x0303', ~new_nc, 
                                                                                    '0', $cipher_suites.1, 
                                                                                    '0', <'43', '0x0304'>, 
                                                                                    <'10', $g1, $g>, 
                                                                                    <'40', $g, $g^~x.1>, 
                                                                                    <'45', '0', '1'>, '0', 
                                                                                    '41', 
                                                                                    <~ticket, 
                                                                                     mask(~ticket_age_add,
                                                                                          '1')
                                                                                    >, 
                                                                                    hmac(<
                                                                                          Expand(Expand(Extract(~res_psk,
                                                                                                                '0'),
                                                                                                        <
                                                                                                         'ext', 
                                                                                                         'pbk'
                                                                                                        >,
                                                                                                        '32'),
                                                                                                 <'0', '0'>,
                                                                                                 '32'), 
                                                                                          h(<
                                                                                             <
                                                                                              <'0', '1', 
                                                                                               '0x0303', 
                                                                                               ~tid, '0', 
                                                                                               $cipher_suites, 
                                                                                               '0', 
                                                                                               <'43', '0x0304'
                                                                                               >, 
                                                                                               <'10', $g1, $g
                                                                                               >, 
                                                                                               <'40', $g1, 
                                                                                                $g1^~x>, 
                                                                                               <'45', '0', '1'
                                                                                               >, 
                                                                                               <'42', '0'>, 
                                                                                               '41', 
                                                                                               <~ticket, 
                                                                                                mask(~ticket_age_add,
                                                                                                     $ticket_age)
                                                                                               >, 
                                                                                               hmac(<
                                                                                                     Expand(Expand(Extract(~res_psk,
                                                                                                                           '0'),
                                                                                                                   <
                                                                                                                    'ext', 
                                                                                                                    'pbk'
                                                                                                                   >,
                                                                                                                   '32'),
                                                                                                            <
                                                                                                             '0', 
                                                                                                             '0'
                                                                                                            >,
                                                                                                            '32'), 
                                                                                                     h(<'0', 
                                                                                                        '1', 
                                                                                                        '0x0303', 
                                                                                                        ~tid, 
                                                                                                        '0', 
                                                                                                        $cipher_suites, 
                                                                                                        '0', 
                                                                                                        <
                                                                                                         '43', 
                                                                                                         '0x0304'
                                                                                                        >, 
                                                                                                        <
                                                                                                         '10', 
                                                                                                         $g1, 
                                                                                                         $g>, 
                                                                                                        <
                                                                                                         '40', 
                                                                                                         $g1, 
                                                                                                         $g1^~x
                                                                                                        >, 
                                                                                                        <
                                                                                                         '45', 
                                                                                                         '0', 
                                                                                                         '1'
                                                                                                        >, 
                                                                                                        <
                                                                                                         '42', 
                                                                                                         '0'
                                                                                                        >, 
                                                                                                        '41', 
                                                                                                        <
                                                                                                         ~ticket, 
                                                                                                         mask(~ticket_age_add,
                                                                                                              $ticket_age)
                                                                                                        >, 
                                                                                                        '0'>)
                                                                                                    >)
                                                                                              >, 
                                                                                              '6', '0x0303', 
                                                                                              '40', $g>, 
                                                                                             '1', '0x0303', 
                                                                                             ~new_nc, '0', 
                                                                                             $cipher_suites.1, 
                                                                                             '0', 
                                                                                             <'43', '0x0304'
                                                                                             >, 
                                                                                             <'10', $g1, $g>, 
                                                                                             <'40', $g, 
                                                                                              $g^~x.1>, 
                                                                                             <'45', '0', '1'
                                                                                             >, 
                                                                                             '0', '41', 
                                                                                             <~ticket, 
                                                                                              mask(~ticket_age_add,
                                                                                                   '1')
                                                                                             >, 
                                                                                             '0'>)
                                                                                         >)
                                                                                   >, 
                                                                                   '2', '0x0303', p_ns, 
                                                                                   $cipher_suite, 
                                                                                   <'13', $sig_algs>, '40', 
                                                                                   $g, p_gy>, 
                                                                                  '8', $exts>, 
                                                                                 '13', '0', 
                                                                                 $certificate_extensions>, 
                                                                                '11', '0', pk(~ltkS)>)
                                                                            >,
                                                                            ~ltkS)
                                                                      >)
                                                                   >,
                                                                   '32'),
                                                            <'fin', '0'>, '32'), 
                                                     h(<
                                                        <
                                                         <
                                                          <
                                                           <
                                                            <
                                                             <
                                                              <'0', '1', '0x0303', ~tid, '0', $cipher_suites, 
                                                               '0', <'43', '0x0304'>, <'10', $g1, $g>, 
                                                               <'40', $g1, $g1^~x>, <'45', '0', '1'>, 
                                                               <'42', '0'>, '41', 
                                                               <~ticket, mask(~ticket_age_add, $ticket_age)>, 
                                                               hmac(<
                                                                     Expand(Expand(Extract(~res_psk, '0'),
                                                                                   <'ext', 'pbk'>, '32'),
                                                                            <'0', '0'>, '32'), 
                                                                     h(<'0', '1', '0x0303', ~tid, '0', 
                                                                        $cipher_suites, '0', 
                                                                        <'43', '0x0304'>, <'10', $g1, $g>, 
                                                                        <'40', $g1, $g1^~x>, 
                                                                        <'45', '0', '1'>, <'42', '0'>, '41', 
                                                                        <~ticket, 
                                                                         mask(~ticket_age_add, $ticket_age)>, 
                                                                        '0'>)
                                                                    >)
                                                              >, 
                                                              '6', '0x0303', '40', $g>, 
                                                             '1', '0x0303', ~new_nc, '0', $cipher_suites.1, 
                                                             '0', <'43', '0x0304'>, <'10', $g1, $g>, 
                                                             <'40', $g, $g^~x.1>, <'45', '0', '1'>, '0', 
                                                             '41', <~ticket, mask(~ticket_age_add, '1')>, 
                                                             hmac(<
                                                                   Expand(Expand(Extract(~res_psk, '0'),
                                                                                 <'ext', 'pbk'>, '32'),
                                                                          <'0', '0'>, '32'), 
                                                                   h(<
                                                                      <
                                                                       <'0', '1', '0x0303', ~tid, '0', 
                                                                        $cipher_suites, '0', 
                                                                        <'43', '0x0304'>, <'10', $g1, $g>, 
                                                                        <'40', $g1, $g1^~x>, 
                                                                        <'45', '0', '1'>, <'42', '0'>, '41', 
                                                                        <~ticket, 
                                                                         mask(~ticket_age_add, $ticket_age)>, 
                                                                        hmac(<
                                                                              Expand(Expand(Extract(~res_psk,
                                                                                                    '0'),
                                                                                            <'ext', 'pbk'>,
                                                                                            '32'),
                                                                                     <'0', '0'>, '32'), 
                                                                              h(<'0', '1', '0x0303', ~tid, 
                                                                                 '0', $cipher_suites, '0', 
                                                                                 <'43', '0x0304'>, 
                                                                                 <'10', $g1, $g>, 
                                                                                 <'40', $g1, $g1^~x>, 
                                                                                 <'45', '0', '1'>, 
                                                                                 <'42', '0'>, '41', 
                                                                                 <~ticket, 
                                                                                  mask(~ticket_age_add,
                                                                                       $ticket_age)
                                                                                 >, 
                                                                                 '0'>)
                                                                             >)
                                                                       >, 
                                                                       '6', '0x0303', '40', $g>, 
                                                                      '1', '0x0303', ~new_nc, '0', 
                                                                      $cipher_suites.1, '0', 
                                                                      <'43', '0x0304'>, <'10', $g1, $g>, 
                                                                      <'40', $g, $g^~x.1>, <'45', '0', '1'>, 
                                                                      '0', '41', 
                                                                      <~ticket, mask(~ticket_age_add, '1')>, 
                                                                      '0'>)
                                                                  >)
                                                            >, 
                                                            '2', '0x0303', p_ns, $cipher_suite, 
                                                            <'13', $sig_algs>, '40', $g, p_gy>, 
                                                           '8', $exts>, 
                                                          '13', '0', $certificate_extensions>, 
                                                         '11', '0', pk(~ltkS)>, 
                                                        '15', 
                                                        sign(<'server_cv', 
                                                              h(<
                                                                 <
                                                                  <
                                                                   <
                                                                    <
                                                                     <
                                                                      <'0', '1', '0x0303', ~tid, '0', 
                                                                       $cipher_suites, '0', <'43', '0x0304'>, 
                                                                       <'10', $g1, $g>, <'40', $g1, $g1^~x>, 
                                                                       <'45', '0', '1'>, <'42', '0'>, '41', 
                                                                       <~ticket, 
                                                                        mask(~ticket_age_add, $ticket_age)>, 
                                                                       hmac(<
                                                                             Expand(Expand(Extract(~res_psk,
                                                                                                   '0'),
                                                                                           <'ext', 'pbk'>,
                                                                                           '32'),
                                                                                    <'0', '0'>, '32'), 
                                                                             h(<'0', '1', '0x0303', ~tid, 
                                                                                '0', $cipher_suites, '0', 
                                                                                <'43', '0x0304'>, 
                                                                                <'10', $g1, $g>, 
                                                                                <'40', $g1, $g1^~x>, 
                                                                                <'45', '0', '1'>, 
                                                                                <'42', '0'>, '41', 
                                                                                <~ticket, 
                                                                                 mask(~ticket_age_add,
                                                                                      $ticket_age)
                                                                                >, 
                                                                                '0'>)
                                                                            >)
                                                                      >, 
                                                                      '6', '0x0303', '40', $g>, 
                                                                     '1', '0x0303', ~new_nc, '0', 
                                                                     $cipher_suites.1, '0', <'43', '0x0304'>, 
                                                                     <'10', $g1, $g>, <'40', $g, $g^~x.1>, 
                                                                     <'45', '0', '1'>, '0', '41', 
                                                                     <~ticket, mask(~ticket_age_add, '1')>, 
                                                                     hmac(<
                                                                           Expand(Expand(Extract(~res_psk,
                                                                                                 '0'),
                                                                                         <'ext', 'pbk'>,
                                                                                         '32'),
                                                                                  <'0', '0'>, '32'), 
                                                                           h(<
                                                                              <
                                                                               <'0', '1', '0x0303', ~tid, 
                                                                                '0', $cipher_suites, '0', 
                                                                                <'43', '0x0304'>, 
                                                                                <'10', $g1, $g>, 
                                                                                <'40', $g1, $g1^~x>, 
                                                                                <'45', '0', '1'>, 
                                                                                <'42', '0'>, '41', 
                                                                                <~ticket, 
                                                                                 mask(~ticket_age_add,
                                                                                      $ticket_age)
                                                                                >, 
                                                                                hmac(<
                                                                                      Expand(Expand(Extract(~res_psk,
                                                                                                            '0'),
                                                                                                    <'ext', 
                                                                                                     'pbk'>,
                                                                                                    '32'),
                                                                                             <'0', '0'>,
                                                                                             '32'), 
                                                                                      h(<'0', '1', '0x0303', 
                                                                                         ~tid, '0', 
                                                                                         $cipher_suites, '0', 
                                                                                         <'43', '0x0304'>, 
                                                                                         <'10', $g1, $g>, 
                                                                                         <'40', $g1, $g1^~x>, 
                                                                                         <'45', '0', '1'>, 
                                                                                         <'42', '0'>, '41', 
                                                                                         <~ticket, 
                                                                                          mask(~ticket_age_add,
                                                                                               $ticket_age)
                                                                                         >, 
                                                                                         '0'>)
                                                                                     >)
                                                                               >, 
                                                                               '6', '0x0303', '40', $g>, 
                                                                              '1', '0x0303', ~new_nc, '0', 
                                                                              $cipher_suites.1, '0', 
                                                                              <'43', '0x0304'>, 
                                                                              <'10', $g1, $g>, 
                                                                              <'40', $g, $g^~x.1>, 
                                                                              <'45', '0', '1'>, '0', '41', 
                                                                              <~ticket, 
                                                                               mask(~ticket_age_add, '1')>, 
                                                                              '0'>)
                                                                          >)
                                                                    >, 
                                                                    '2', '0x0303', p_ns, $cipher_suite, 
                                                                    <'13', $sig_algs>, '40', $g, p_gy>, 
                                                                   '8', $exts>, 
                                                                  '13', '0', $certificate_extensions>, 
                                                                 '11', '0', pk(~ltkS)>)
                                                             >,
                                                             ~ltkS)
                                                       >)
                                                    >)
                                              >)
                                           >,
                                           '32'),
                                    <'adke_wk', '0'>, '32')
                  ) ▶₀ #l )
      qed
    next
      case recv_server_auth_case_08
      solve( !Ltk( $C, ~ltkC ) ▶₂ #i )
        case Register_pk
        by solve( SecretPSK( $A,
                             Expand(Expand(Extract('0',
                                                   Extract(p_gxy,
                                                           Extract(Expand(ms, <'rms', h(messages)>, '32'),
                                                                   '0'))),
                                           <'serverats', 
                                            h(<
                                               <
                                                <
                                                 <
                                                  <
                                                   <
                                                    <
                                                     <
                                                      <'0', '1', '0x0303', ~tid, '0', $cipher_suites, '0', 
                                                       <'43', '0x0304'>, <'10', $g1, $g>, 
                                                       <'40', $g1, $g1^~x>, <'45', '0', '1'>, <'42', '0'>, 
                                                       '41', <p_psk_id, mask(ticket_age_add, $ticket_age)>, 
                                                       hmac(<
                                                             Expand(Expand(Extract(Expand(ms,
                                                                                          <'rms', h(messages)
                                                                                          >,
                                                                                          '32'),
                                                                                   '0'),
                                                                           <'res', 'pbk'>, '32'),
                                                                    <'0', '0'>, '32'), 
                                                             h(<'0', '1', '0x0303', ~tid, '0', 
                                                                $cipher_suites, '0', <'43', '0x0304'>, 
                                                                <'10', $g1, $g>, <'40', $g1, $g1^~x>, 
                                                                <'45', '0', '1'>, <'42', '0'>, '41', 
                                                                <p_psk_id, mask(ticket_age_add, $ticket_age)
                                                                >, 
                                                                '0'>)
                                                            >)
                                                      >, 
                                                      '6', '0x0303', '40', $g>, 
                                                     '1', '0x0303', ~new_nc, '0', $cipher_suites.1, '0', 
                                                     <'43', '0x0304'>, <'10', $g1, $g>, <'40', $g, $g^~x.1>, 
                                                     <'45', '0', '1'>, '0', '41', 
                                                     <p_psk_id, mask(ticket_age_add, '1')>, 
                                                     hmac(<
                                                           Expand(Expand(Extract(Expand(ms,
                                                                                        <'rms', h(messages)>,
                                                                                        '32'),
                                                                                 '0'),
                                                                         <'res', 'pbk'>, '32'),
                                                                  <'0', '0'>, '32'), 
                                                           h(<
                                                              <
                                                               <'0', '1', '0x0303', ~tid, '0', 
                                                                $cipher_suites, '0', <'43', '0x0304'>, 
                                                                <'10', $g1, $g>, <'40', $g1, $g1^~x>, 
                                                                <'45', '0', '1'>, <'42', '0'>, '41', 
                                                                <p_psk_id, mask(ticket_age_add, $ticket_age)
                                                                >, 
                                                                hmac(<
                                                                      Expand(Expand(Extract(Expand(ms,
                                                                                                   <'rms', 
                                                                                                    h(messages)
                                                                                                   >,
                                                                                                   '32'),
                                                                                            '0'),
                                                                                    <'res', 'pbk'>, '32'),
                                                                             <'0', '0'>, '32'), 
                                                                      h(<'0', '1', '0x0303', ~tid, '0', 
                                                                         $cipher_suites, '0', 
                                                                         <'43', '0x0304'>, <'10', $g1, $g>, 
                                                                         <'40', $g1, $g1^~x>, 
                                                                         <'45', '0', '1'>, <'42', '0'>, '41', 
                                                                         <p_psk_id, 
                                                                          mask(ticket_age_add, $ticket_age)>, 
                                                                         '0'>)
                                                                     >)
                                                               >, 
                                                               '6', '0x0303', '40', $g>, 
                                                              '1', '0x0303', ~new_nc, '0', $cipher_suites.1, 
                                                              '0', <'43', '0x0304'>, <'10', $g1, $g>, 
                                                              <'40', $g, $g^~x.1>, <'45', '0', '1'>, '0', 
                                                              '41', <p_psk_id, mask(ticket_age_add, '1')>, '0'
                                                             >)
                                                          >)
                                                    >, 
                                                    '2', '0x0303', p_ns, $cipher_suite, <'13', $sig_algs>, 
                                                    '40', $g, p_gy>, 
                                                   '8', $exts>, 
                                                  '13', '0', $certificate_extensions>, 
                                                 '11', '0', pk(~ltkS)>, 
                                                '15', 
                                                sign(<'server_cv', 
                                                      h(<
                                                         <
                                                          <
                                                           <
                                                            <
                                                             <
                                                              <'0', '1', '0x0303', ~tid, '0', $cipher_suites, 
                                                               '0', <'43', '0x0304'>, <'10', $g1, $g>, 
                                                               <'40', $g1, $g1^~x>, <'45', '0', '1'>, 
                                                               <'42', '0'>, '41', 
                                                               <p_psk_id, mask(ticket_age_add, $ticket_age)>, 
                                                               hmac(<
                                                                     Expand(Expand(Extract(Expand(ms,
                                                                                                  <'rms', 
                                                                                                   h(messages)
                                                                                                  >,
                                                                                                  '32'),
                                                                                           '0'),
                                                                                   <'res', 'pbk'>, '32'),
                                                                            <'0', '0'>, '32'), 
                                                                     h(<'0', '1', '0x0303', ~tid, '0', 
                                                                        $cipher_suites, '0', 
                                                                        <'43', '0x0304'>, <'10', $g1, $g>, 
                                                                        <'40', $g1, $g1^~x>, 
                                                                        <'45', '0', '1'>, <'42', '0'>, '41', 
                                                                        <p_psk_id, 
                                                                         mask(ticket_age_add, $ticket_age)>, 
                                                                        '0'>)
                                                                    >)
                                                              >, 
                                                              '6', '0x0303', '40', $g>, 
                                                             '1', '0x0303', ~new_nc, '0', $cipher_suites.1, 
                                                             '0', <'43', '0x0304'>, <'10', $g1, $g>, 
                                                             <'40', $g, $g^~x.1>, <'45', '0', '1'>, '0', 
                                                             '41', <p_psk_id, mask(ticket_age_add, '1')>, 
                                                             hmac(<
                                                                   Expand(Expand(Extract(Expand(ms,
                                                                                                <'rms', 
                                                                                                 h(messages)>,
                                                                                                '32'),
                                                                                         '0'),
                                                                                 <'res', 'pbk'>, '32'),
                                                                          <'0', '0'>, '32'), 
                                                                   h(<
                                                                      <
                                                                       <'0', '1', '0x0303', ~tid, '0', 
                                                                        $cipher_suites, '0', 
                                                                        <'43', '0x0304'>, <'10', $g1, $g>, 
                                                                        <'40', $g1, $g1^~x>, 
                                                                        <'45', '0', '1'>, <'42', '0'>, '41', 
                                                                        <p_psk_id, 
                                                                         mask(ticket_age_add, $ticket_age)>, 
                                                                        hmac(<
                                                                              Expand(Expand(Extract(Expand(ms,
                                                                                                           <
                                                                                                            'rms', 
                                                                                                            h(messages)
                                                                                                           >,
                                                                                                           '32'),
                                                                                                    '0'),
                                                                                            <'res', 'pbk'>,
                                                                                            '32'),
                                                                                     <'0', '0'>, '32'), 
                                                                              h(<'0', '1', '0x0303', ~tid, 
                                                                                 '0', $cipher_suites, '0', 
                                                                                 <'43', '0x0304'>, 
                                                                                 <'10', $g1, $g>, 
                                                                                 <'40', $g1, $g1^~x>, 
                                                                                 <'45', '0', '1'>, 
                                                                                 <'42', '0'>, '41', 
                                                                                 <p_psk_id, 
                                                                                  mask(ticket_age_add,
                                                                                       $ticket_age)
                                                                                 >, 
                                                                                 '0'>)
                                                                             >)
                                                                       >, 
                                                                       '6', '0x0303', '40', $g>, 
                                                                      '1', '0x0303', ~new_nc, '0', 
                                                                      $cipher_suites.1, '0', 
                                                                      <'43', '0x0304'>, <'10', $g1, $g>, 
                                                                      <'40', $g, $g^~x.1>, <'45', '0', '1'>, 
                                                                      '0', '41', 
                                                                      <p_psk_id, mask(ticket_age_add, '1')>, 
                                                                      '0'>)
                                                                  >)
                                                            >, 
                                                            '2', '0x0303', p_ns, $cipher_suite, 
                                                            <'13', $sig_algs>, '40', $g, p_gy>, 
                                                           '8', $exts>, 
                                                          '13', '0', $certificate_extensions>, 
                                                         '11', '0', pk(~ltkS)>)
                                                     >,
                                                     ~ltkS)
                                               >, 
                                               '20', 
                                               hmac(<
                                                     Expand(Expand(Extract(p_gxy,
                                                                           Extract(Expand(ms,
                                                                                          <'rms', h(messages)
                                                                                          >,
                                                                                          '32'),
                                                                                   '0')),
                                                                   <'serverhts', 
                                                                    h(<
                                                                       <
                                                                        <
                                                                         <
                                                                          <
                                                                           <
                                                                            <
                                                                             <'0', '1', '0x0303', ~tid, '0', 
                                                                              $cipher_suites, '0', 
                                                                              <'43', '0x0304'>, 
                                                                              <'10', $g1, $g>, 
                                                                              <'40', $g1, $g1^~x>, 
                                                                              <'45', '0', '1'>, <'42', '0'>, 
                                                                              '41', 
                                                                              <p_psk_id, 
                                                                               mask(ticket_age_add,
                                                                                    $ticket_age)
                                                                              >, 
                                                                              hmac(<
                                                                                    Expand(Expand(Extract(Expand(ms,
                                                                                                                 <
                                                                                                                  'rms', 
                                                                                                                  h(messages)
                                                                                                                 >,
                                                                                                                 '32'),
                                                                                                          '0'),
                                                                                                  <'res', 
                                                                                                   'pbk'>,
                                                                                                  '32'),
                                                                                           <'0', '0'>, '32'), 
                                                                                    h(<'0', '1', '0x0303', 
                                                                                       ~tid, '0', 
                                                                                       $cipher_suites, '0', 
                                                                                       <'43', '0x0304'>, 
                                                                                       <'10', $g1, $g>, 
                                                                                       <'40', $g1, $g1^~x>, 
                                                                                       <'45', '0', '1'>, 
                                                                                       <'42', '0'>, '41', 
                                                                                       <p_psk_id, 
                                                                                        mask(ticket_age_add,
                                                                                             $ticket_age)
                                                                                       >, 
                                                                                       '0'>)
                                                                                   >)
                                                                             >, 
                                                                             '6', '0x0303', '40', $g>, 
                                                                            '1', '0x0303', ~new_nc, '0', 
                                                                            $cipher_suites.1, '0', 
                                                                            <'43', '0x0304'>, 
                                                                            <'10', $g1, $g>, 
                                                                            <'40', $g, $g^~x.1>, 
                                                                            <'45', '0', '1'>, '0', '41', 
                                                                            <p_psk_id, 
                                                                             mask(ticket_age_add, '1')>, 
                                                                            hmac(<
                                                                                  Expand(Expand(Extract(Expand(ms,
                                                                                                               <
                                                                                                                'rms', 
                                                                                                                h(messages)
                                                                                                               >,
                                                                                                               '32'),
                                                                                                        '0'),
                                                                                                <'res', 'pbk'
                                                                                                >,
                                                                                                '32'),
                                                                                         <'0', '0'>, '32'), 
                                                                                  h(<
                                                                                     <
                                                                                      <'0', '1', '0x0303', 
                                                                                       ~tid, '0', 
                                                                                       $cipher_suites, '0', 
                                                                                       <'43', '0x0304'>, 
                                                                                       <'10', $g1, $g>, 
                                                                                       <'40', $g1, $g1^~x>, 
                                                                                       <'45', '0', '1'>, 
                                                                                       <'42', '0'>, '41', 
                                                                                       <p_psk_id, 
                                                                                        mask(ticket_age_add,
                                                                                             $ticket_age)
                                                                                       >, 
                                                                                       hmac(<
                                                                                             Expand(Expand(Extract(Expand(ms,
                                                                                                                          <
                                                                                                                           'rms', 
                                                                                                                           h(messages)
                                                                                                                          >,
                                                                                                                          '32'),
                                                                                                                   '0'),
                                                                                                           <
                                                                                                            'res', 
                                                                                                            'pbk'
                                                                                                           >,
                                                                                                           '32'),
                                                                                                    <'0', '0'
                                                                                                    >,
                                                                                                    '32'), 
                                                                                             h(<'0', '1', 
                                                                                                '0x0303', 
                                                                                                ~tid, '0', 
                                                                                                $cipher_suites, 
                                                                                                '0', 
                                                                                                <'43', 
                                                                                                 '0x0304'>, 
                                                                                                <'10', $g1, $g
                                                                                                >, 
                                                                                                <'40', $g1, 
                                                                                                 $g1^~x>, 
                                                                                                <'45', '0', 
                                                                                                 '1'>, 
                                                                                                <'42', '0'>, 
                                                                                                '41', 
                                                                                                <p_psk_id, 
                                                                                                 mask(ticket_age_add,
                                                                                                      $ticket_age)
                                                                                                >, 
                                                                                                '0'>)
                                                                                            >)
                                                                                      >, 
                                                                                      '6', '0x0303', '40', $g
                                                                                     >, 
                                                                                     '1', '0x0303', ~new_nc, 
                                                                                     '0', $cipher_suites.1, 
                                                                                     '0', <'43', '0x0304'>, 
                                                                                     <'10', $g1, $g>, 
                                                                                     <'40', $g, $g^~x.1>, 
                                                                                     <'45', '0', '1'>, '0', 
                                                                                     '41', 
                                                                                     <p_psk_id, 
                                                                                      mask(ticket_age_add,
                                                                                           '1')
                                                                                     >, 
                                                                                     '0'>)
                                                                                 >)
                                                                           >, 
                                                                           '2', '0x0303', p_ns, 
                                                                           $cipher_suite, <'13', $sig_algs>, 
                                                                           '40', $g, p_gy>, 
                                                                          '8', $exts>, 
                                                                         '13', '0', $certificate_extensions>, 
                                                                        '11', '0', pk(~ltkS)>, 
                                                                       '15', 
                                                                       sign(<'server_cv', 
                                                                             h(<
                                                                                <
                                                                                 <
                                                                                  <
                                                                                   <
                                                                                    <
                                                                                     <'0', '1', '0x0303', 
                                                                                      ~tid, '0', 
                                                                                      $cipher_suites, '0', 
                                                                                      <'43', '0x0304'>, 
                                                                                      <'10', $g1, $g>, 
                                                                                      <'40', $g1, $g1^~x>, 
                                                                                      <'45', '0', '1'>, 
                                                                                      <'42', '0'>, '41', 
                                                                                      <p_psk_id, 
                                                                                       mask(ticket_age_add,
                                                                                            $ticket_age)
                                                                                      >, 
                                                                                      hmac(<
                                                                                            Expand(Expand(Extract(Expand(ms,
                                                                                                                         <
                                                                                                                          'rms', 
                                                                                                                          h(messages)
                                                                                                                         >,
                                                                                                                         '32'),
                                                                                                                  '0'),
                                                                                                          <
                                                                                                           'res', 
                                                                                                           'pbk'
                                                                                                          >,
                                                                                                          '32'),
                                                                                                   <'0', '0'>,
                                                                                                   '32'), 
                                                                                            h(<'0', '1', 
                                                                                               '0x0303', 
                                                                                               ~tid, '0', 
                                                                                               $cipher_suites, 
                                                                                               '0', 
                                                                                               <'43', '0x0304'
                                                                                               >, 
                                                                                               <'10', $g1, $g
                                                                                               >, 
                                                                                               <'40', $g1, 
                                                                                                $g1^~x>, 
                                                                                               <'45', '0', '1'
                                                                                               >, 
                                                                                               <'42', '0'>, 
                                                                                               '41', 
                                                                                               <p_psk_id, 
                                                                                                mask(ticket_age_add,
                                                                                                     $ticket_age)
                                                                                               >, 
                                                                                               '0'>)
                                                                                           >)
                                                                                     >, 
                                                                                     '6', '0x0303', '40', $g
                                                                                    >, 
                                                                                    '1', '0x0303', ~new_nc, 
                                                                                    '0', $cipher_suites.1, 
                                                                                    '0', <'43', '0x0304'>, 
                                                                                    <'10', $g1, $g>, 
                                                                                    <'40', $g, $g^~x.1>, 
                                                                                    <'45', '0', '1'>, '0', 
                                                                                    '41', 
                                                                                    <p_psk_id, 
                                                                                     mask(ticket_age_add, '1')
                                                                                    >, 
                                                                                    hmac(<
                                                                                          Expand(Expand(Extract(Expand(ms,
                                                                                                                       <
                                                                                                                        'rms', 
                                                                                                                        h(messages)
                                                                                                                       >,
                                                                                                                       '32'),
                                                                                                                '0'),
                                                                                                        <
                                                                                                         'res', 
                                                                                                         'pbk'
                                                                                                        >,
                                                                                                        '32'),
                                                                                                 <'0', '0'>,
                                                                                                 '32'), 
                                                                                          h(<
                                                                                             <
                                                                                              <'0', '1', 
                                                                                               '0x0303', 
                                                                                               ~tid, '0', 
                                                                                               $cipher_suites, 
                                                                                               '0', 
                                                                                               <'43', '0x0304'
                                                                                               >, 
                                                                                               <'10', $g1, $g
                                                                                               >, 
                                                                                               <'40', $g1, 
                                                                                                $g1^~x>, 
                                                                                               <'45', '0', '1'
                                                                                               >, 
                                                                                               <'42', '0'>, 
                                                                                               '41', 
                                                                                               <p_psk_id, 
                                                                                                mask(ticket_age_add,
                                                                                                     $ticket_age)
                                                                                               >, 
                                                                                               hmac(<
                                                                                                     Expand(Expand(Extract(Expand(ms,
                                                                                                                                  <
                                                                                                                                   'rms', 
                                                                                                                                   h(messages)
                                                                                                                                  >,
                                                                                                                                  '32'),
                                                                                                                           '0'),
                                                                                                                   <
                                                                                                                    'res', 
                                                                                                                    'pbk'
                                                                                                                   >,
                                                                                                                   '32'),
                                                                                                            <
                                                                                                             '0', 
                                                                                                             '0'
                                                                                                            >,
                                                                                                            '32'), 
                                                                                                     h(<'0', 
                                                                                                        '1', 
                                                                                                        '0x0303', 
                                                                                                        ~tid, 
                                                                                                        '0', 
                                                                                                        $cipher_suites, 
                                                                                                        '0', 
                                                                                                        <
                                                                                                         '43', 
                                                                                                         '0x0304'
                                                                                                        >, 
                                                                                                        <
                                                                                                         '10', 
                                                                                                         $g1, 
                                                                                                         $g>, 
                                                                                                        <
                                                                                                         '40', 
                                                                                                         $g1, 
                                                                                                         $g1^~x
                                                                                                        >, 
                                                                                                        <
                                                                                                         '45', 
                                                                                                         '0', 
                                                                                                         '1'
                                                                                                        >, 
                                                                                                        <
                                                                                                         '42', 
                                                                                                         '0'
                                                                                                        >, 
                                                                                                        '41', 
                                                                                                        <
                                                                                                         p_psk_id, 
                                                                                                         mask(ticket_age_add,
                                                                                                              $ticket_age)
                                                                                                        >, 
                                                                                                        '0'>)
                                                                                                    >)
                                                                                              >, 
                                                                                              '6', '0x0303', 
                                                                                              '40', $g>, 
                                                                                             '1', '0x0303', 
                                                                                             ~new_nc, '0', 
                                                                                             $cipher_suites.1, 
                                                                                             '0', 
                                                                                             <'43', '0x0304'
                                                                                             >, 
                                                                                             <'10', $g1, $g>, 
                                                                                             <'40', $g, 
                                                                                              $g^~x.1>, 
                                                                                             <'45', '0', '1'
                                                                                             >, 
                                                                                             '0', '41', 
                                                                                             <p_psk_id, 
                                                                                              mask(ticket_age_add,
                                                                                                   '1')
                                                                                             >, 
                                                                                             '0'>)
                                                                                         >)
                                                                                   >, 
                                                                                   '2', '0x0303', p_ns, 
                                                                                   $cipher_suite, 
                                                                                   <'13', $sig_algs>, '40', 
                                                                                   $g, p_gy>, 
                                                                                  '8', $exts>, 
                                                                                 '13', '0', 
                                                                                 $certificate_extensions>, 
                                                                                '11', '0', pk(~ltkS)>)
                                                                            >,
                                                                            ~ltkS)
                                                                      >)
                                                                   >,
                                                                   '32'),
                                                            <'fin', '0'>, '32'), 
                                                     h(<
                                                        <
                                                         <
                                                          <
                                                           <
                                                            <
                                                             <
                                                              <'0', '1', '0x0303', ~tid, '0', $cipher_suites, 
                                                               '0', <'43', '0x0304'>, <'10', $g1, $g>, 
                                                               <'40', $g1, $g1^~x>, <'45', '0', '1'>, 
                                                               <'42', '0'>, '41', 
                                                               <p_psk_id, mask(ticket_age_add, $ticket_age)>, 
                                                               hmac(<
                                                                     Expand(Expand(Extract(Expand(ms,
                                                                                                  <'rms', 
                                                                                                   h(messages)
                                                                                                  >,
                                                                                                  '32'),
                                                                                           '0'),
                                                                                   <'res', 'pbk'>, '32'),
                                                                            <'0', '0'>, '32'), 
                                                                     h(<'0', '1', '0x0303', ~tid, '0', 
                                                                        $cipher_suites, '0', 
                                                                        <'43', '0x0304'>, <'10', $g1, $g>, 
                                                                        <'40', $g1, $g1^~x>, 
                                                                        <'45', '0', '1'>, <'42', '0'>, '41', 
                                                                        <p_psk_id, 
                                                                         mask(ticket_age_add, $ticket_age)>, 
                                                                        '0'>)
                                                                    >)
                                                              >, 
                                                              '6', '0x0303', '40', $g>, 
                                                             '1', '0x0303', ~new_nc, '0', $cipher_suites.1, 
                                                             '0', <'43', '0x0304'>, <'10', $g1, $g>, 
                                                             <'40', $g, $g^~x.1>, <'45', '0', '1'>, '0', 
                                                             '41', <p_psk_id, mask(ticket_age_add, '1')>, 
                                                             hmac(<
                                                                   Expand(Expand(Extract(Expand(ms,
                                                                                                <'rms', 
                                                                                                 h(messages)>,
                                                                                                '32'),
                                                                                         '0'),
                                                                                 <'res', 'pbk'>, '32'),
                                                                          <'0', '0'>, '32'), 
                                                                   h(<
                                                                      <
                                                                       <'0', '1', '0x0303', ~tid, '0', 
                                                                        $cipher_suites, '0', 
                                                                        <'43', '0x0304'>, <'10', $g1, $g>, 
                                                                        <'40', $g1, $g1^~x>, 
                                                                        <'45', '0', '1'>, <'42', '0'>, '41', 
                                                                        <p_psk_id, 
                                                                         mask(ticket_age_add, $ticket_age)>, 
                                                                        hmac(<
                                                                              Expand(Expand(Extract(Expand(ms,
                                                                                                           <
                                                                                                            'rms', 
                                                                                                            h(messages)
                                                                                                           >,
                                                                                                           '32'),
                                                                                                    '0'),
                                                                                            <'res', 'pbk'>,
                                                                                            '32'),
                                                                                     <'0', '0'>, '32'), 
                                                                              h(<'0', '1', '0x0303', ~tid, 
                                                                                 '0', $cipher_suites, '0', 
                                                                                 <'43', '0x0304'>, 
                                                                                 <'10', $g1, $g>, 
                                                                                 <'40', $g1, $g1^~x>, 
                                                                                 <'45', '0', '1'>, 
                                                                                 <'42', '0'>, '41', 
                                                                                 <p_psk_id, 
                                                                                  mask(ticket_age_add,
                                                                                       $ticket_age)
                                                                                 >, 
                                                                                 '0'>)
                                                                             >)
                                                                       >, 
                                                                       '6', '0x0303', '40', $g>, 
                                                                      '1', '0x0303', ~new_nc, '0', 
                                                                      $cipher_suites.1, '0', 
                                                                      <'43', '0x0304'>, <'10', $g1, $g>, 
                                                                      <'40', $g, $g^~x.1>, <'45', '0', '1'>, 
                                                                      '0', '41', 
                                                                      <p_psk_id, mask(ticket_age_add, '1')>, 
                                                                      '0'>)
                                                                  >)
                                                            >, 
                                                            '2', '0x0303', p_ns, $cipher_suite, 
                                                            <'13', $sig_algs>, '40', $g, p_gy>, 
                                                           '8', $exts>, 
                                                          '13', '0', $certificate_extensions>, 
                                                         '11', '0', pk(~ltkS)>, 
                                                        '15', 
                                                        sign(<'server_cv', 
                                                              h(<
                                                                 <
                                                                  <
                                                                   <
                                                                    <
                                                                     <
                                                                      <'0', '1', '0x0303', ~tid, '0', 
                                                                       $cipher_suites, '0', <'43', '0x0304'>, 
                                                                       <'10', $g1, $g>, <'40', $g1, $g1^~x>, 
                                                                       <'45', '0', '1'>, <'42', '0'>, '41', 
                                                                       <p_psk_id, 
                                                                        mask(ticket_age_add, $ticket_age)>, 
                                                                       hmac(<
                                                                             Expand(Expand(Extract(Expand(ms,
                                                                                                          <
                                                                                                           'rms', 
                                                                                                           h(messages)
                                                                                                          >,
                                                                                                          '32'),
                                                                                                   '0'),
                                                                                           <'res', 'pbk'>,
                                                                                           '32'),
                                                                                    <'0', '0'>, '32'), 
                                                                             h(<'0', '1', '0x0303', ~tid, 
                                                                                '0', $cipher_suites, '0', 
                                                                                <'43', '0x0304'>, 
                                                                                <'10', $g1, $g>, 
                                                                                <'40', $g1, $g1^~x>, 
                                                                                <'45', '0', '1'>, 
                                                                                <'42', '0'>, '41', 
                                                                                <p_psk_id, 
                                                                                 mask(ticket_age_add,
                                                                                      $ticket_age)
                                                                                >, 
                                                                                '0'>)
                                                                            >)
                                                                      >, 
                                                                      '6', '0x0303', '40', $g>, 
                                                                     '1', '0x0303', ~new_nc, '0', 
                                                                     $cipher_suites.1, '0', <'43', '0x0304'>, 
                                                                     <'10', $g1, $g>, <'40', $g, $g^~x.1>, 
                                                                     <'45', '0', '1'>, '0', '41', 
                                                                     <p_psk_id, mask(ticket_age_add, '1')>, 
                                                                     hmac(<
                                                                           Expand(Expand(Extract(Expand(ms,
                                                                                                        <
                                                                                                         'rms', 
                                                                                                         h(messages)
                                                                                                        >,
                                                                                                        '32'),
                                                                                                 '0'),
                                                                                         <'res', 'pbk'>,
                                                                                         '32'),
                                                                                  <'0', '0'>, '32'), 
                                                                           h(<
                                                                              <
                                                                               <'0', '1', '0x0303', ~tid, 
                                                                                '0', $cipher_suites, '0', 
                                                                                <'43', '0x0304'>, 
                                                                                <'10', $g1, $g>, 
                                                                                <'40', $g1, $g1^~x>, 
                                                                                <'45', '0', '1'>, 
                                                                                <'42', '0'>, '41', 
                                                                                <p_psk_id, 
                                                                                 mask(ticket_age_add,
                                                                                      $ticket_age)
                                                                                >, 
                                                                                hmac(<
                                                                                      Expand(Expand(Extract(Expand(ms,
                                                                                                                   <
                                                                                                                    'rms', 
                                                                                                                    h(messages)
                                                                                                                   >,
                                                                                                                   '32'),
                                                                                                            '0'),
                                                                                                    <'res', 
                                                                                                     'pbk'>,
                                                                                                    '32'),
                                                                                             <'0', '0'>,
                                                                                             '32'), 
                                                                                      h(<'0', '1', '0x0303', 
                                                                                         ~tid, '0', 
                                                                                         $cipher_suites, '0', 
                                                                                         <'43', '0x0304'>, 
                                                                                         <'10', $g1, $g>, 
                                                                                         <'40', $g1, $g1^~x>, 
                                                                                         <'45', '0', '1'>, 
                                                                                         <'42', '0'>, '41', 
                                                                                         <p_psk_id, 
                                                                                          mask(ticket_age_add,
                                                                                               $ticket_age)
                                                                                         >, 
                                                                                         '0'>)
                                                                                     >)
                                                                               >, 
                                                                               '6', '0x0303', '40', $g>, 
                                                                              '1', '0x0303', ~new_nc, '0', 
                                                                              $cipher_suites.1, '0', 
                                                                              <'43', '0x0304'>, 
                                                                              <'10', $g1, $g>, 
                                                                              <'40', $g, $g^~x.1>, 
                                                                              <'45', '0', '1'>, '0', '41', 
                                                                              <p_psk_id, 
                                                                               mask(ticket_age_add, '1')>, 
                                                                              '0'>)
                                                                          >)
                                                                    >, 
                                                                    '2', '0x0303', p_ns, $cipher_suite, 
                                                                    <'13', $sig_algs>, '40', $g, p_gy>, 
                                                                   '8', $exts>, 
                                                                  '13', '0', $certificate_extensions>, 
                                                                 '11', '0', pk(~ltkS)>)
                                                             >,
                                                             ~ltkS)
                                                       >)
                                                    >)
                                              >)
                                           >,
                                           '32'),
                                    <'adke_wk', '0'>, '32')
                  ) ▶₀ #l )
      qed
    next
      case recv_server_auth_case_09
      by contradiction /* from formulas */
    next
      case recv_server_auth_case_10
      by contradiction /* from formulas */
    next
      case recv_server_auth_case_11
      by contradiction /* from formulas */
    next
      case recv_server_auth_case_12
      by contradiction /* from formulas */
    next
      case recv_server_auth_case_13
      by contradiction /* from formulas */
    next
      case recv_server_auth_case_14
      by contradiction /* from formulas */
    next
      case recv_server_auth_case_15
      by contradiction /* from formulas */
    next
      case recv_server_auth_case_16
      by contradiction /* from formulas */
    qed
  qed
next
  case recv_client_auth
  solve( (∃ #j. (!KU( p_cats ) @ #j) ∧ #j < #vk)  ∥
         ((∀ #k. (!KU( p_cats ) @ #k) ⇒ ¬(#k < #vk)) ∧
          (∃ actor #l.
            (RevealPSK( actor, Expand(p_cats, <'adke_wk', '0'>, '32') ) @ #l)
           ∧
            #l < #vk)) )
    case case_1
    solve( F_State_S3( ~tid, $S, $C, p_res_psk, p_messages, p_nc, p_ns, p_g,
                       p_sg, p_hrr, p_x, p_y, p_gx, p_gy, p_gxy, p_psk_ke_mode, p_psk_id, p_edi,
                       p_es, p_hs, Extract('0', p_hs), p_cats, p_sats, p_hs_keyc, p_hs_keys,
                       <pas, 'auth'>, p_ems, p_rms, '0'
           ) ▶₀ #i )
      case server_auth_psk_case_1
      solve( (∃ #j.2.
               (!KU( Extract('0',
                             Extract(p_gxy, Extract(Expand(ms, <'rms', h(messages)>, '32'), '0')))
                ) @ #j.2)
              ∧
               #j.2 < #j.1)  ∥
             ((∀ #k.
                (!KU( Extract('0',
                              Extract(p_gxy, Extract(Expand(ms, <'rms', h(messages)>, '32'), '0')))
                 ) @ #k)
               ⇒
                ¬(#k < #j.1)) ∧
              (∃ actor #l.
                (RevealPSK( actor,
                            Expand(Extract('0',
                                           Extract(p_gxy,
                                                   Extract(Expand(ms, <'rms', h(messages)>, '32'), '0'))),
                                   <'clientats', 
                                    h(<
                                       <
                                        <
                                         <'0', '1', '0x0303', p_nc, '0', $cipher_suites, '0', 
                                          <'43', '0x0304'>, <'10', $g1, $g2>, <'40', $g, p_gx>, 
                                          <'45', '0', '1'>, p_edi, '41', <~ticket, mask(x, x.1)>, 
                                          hmac(<
                                                Expand(Expand(Extract(Expand(ms, <'rms', h(messages)>, '32'),
                                                                      '0'),
                                                              <'res', 'pbk'>, '32'),
                                                       <'0', '0'>, '32'), 
                                                h(<'0', '1', '0x0303', p_nc, '0', $cipher_suites, '0', 
                                                   <'43', '0x0304'>, <'10', $g1, $g2>, <'40', $g, p_gx>, 
                                                   <'45', '0', '1'>, p_edi, '41', <~ticket, mask(x, x.1)>, '0'
                                                  >)
                                               >)
                                         >, 
                                         '2', '0x0303', ~ns, $cipher_suite, <'13', $sig_algs>, 
                                         <'40', $g, $g^~y>, <'41', '0'>, p_edi>, 
                                        '8', $exts>, 
                                       '20', 
                                       hmac(<
                                             Expand(Expand(Extract(p_gxy,
                                                                   Extract(Expand(ms, <'rms', h(messages)>,
                                                                                  '32'),
                                                                           '0')),
                                                           <'serverhts', 
                                                            h(<
                                                               <
                                                                <'0', '1', '0x0303', p_nc, '0', 
                                                                 $cipher_suites, '0', <'43', '0x0304'>, 
                                                                 <'10', $g1, $g2>, <'40', $g, p_gx>, 
                                                                 <'45', '0', '1'>, p_edi, '41', 
                                                                 <~ticket, mask(x, x.1)>, 
                                                                 hmac(<
                                                                       Expand(Expand(Extract(Expand(ms,
                                                                                                    <'rms', 
                                                                                                     h(messages)
                                                                                                    >,
                                                                                                    '32'),
                                                                                             '0'),
                                                                                     <'res', 'pbk'>, '32'),
                                                                              <'0', '0'>, '32'), 
                                                                       h(<'0', '1', '0x0303', p_nc, '0', 
                                                                          $cipher_suites, '0', 
                                                                          <'43', '0x0304'>, <'10', $g1, $g2>, 
                                                                          <'40', $g, p_gx>, <'45', '0', '1'>, 
                                                                          p_edi, '41', 
                                                                          <~ticket, mask(x, x.1)>, '0'>)
                                                                      >)
                                                                >, 
                                                                '2', '0x0303', ~ns, $cipher_suite, 
                                                                <'13', $sig_algs>, <'40', $g, $g^~y>, 
                                                                <'41', '0'>, p_edi>, 
                                                               '8', $exts>)
                                                           >,
                                                           '32'),
                                                    <'fin', '0'>, '32'), 
                                             h(<
                                                <
                                                 <'0', '1', '0x0303', p_nc, '0', $cipher_suites, '0', 
                                                  <'43', '0x0304'>, <'10', $g1, $g2>, <'40', $g, p_gx>, 
                                                  <'45', '0', '1'>, p_edi, '41', <~ticket, mask(x, x.1)>, 
                                                  hmac(<
                                                        Expand(Expand(Extract(Expand(ms, <'rms', h(messages)>,
                                                                                     '32'),
                                                                              '0'),
                                                                      <'res', 'pbk'>, '32'),
                                                               <'0', '0'>, '32'), 
                                                        h(<'0', '1', '0x0303', p_nc, '0', $cipher_suites, 
                                                           '0', <'43', '0x0304'>, <'10', $g1, $g2>, 
                                                           <'40', $g, p_gx>, <'45', '0', '1'>, p_edi, '41', 
                                                           <~ticket, mask(x, x.1)>, '0'>)
                                                       >)
                                                 >, 
                                                 '2', '0x0303', ~ns, $cipher_suite, <'13', $sig_algs>, 
                                                 <'40', $g, $g^~y>, <'41', '0'>, p_edi>, 
                                                '8', $exts>)
                                            >)
                                      >)
                                   >,
                                   '32')
                 ) @ #l)
               ∧
                #l < #j.1)) )
        case case_1
        solve( (∃ #r. (RevLtk( $C ) @ #r) ∧ #r < #i)  ∥
               (∃ tid3 x #r. (RevDHExp( tid3, $C, x ) @ #r) ∧ #r < #i)  ∥
               (∃ tid4 y #r. (RevDHExp( tid4, $S, y ) @ #r) ∧ #r < #i)  ∥
               (∃ rms #r. (RevealPSK( $S, rms ) @ #r) ∧ #r < #k.1)  ∥
               (∃ rms #r. (RevealPSK( $C, rms ) @ #r) ∧ #r < #k.1) )
          case case_1
          by contradiction /* from formulas */
        next
          case case_2
          by contradiction /* from formulas */
        next
          case case_3
          by contradiction /* from formulas */
        next
          case case_4
          by contradiction /* from formulas */
        next
          case case_5
          by contradiction /* from formulas */
        qed
      next
        case case_2
        by solve( SecretPSK( $A,
                             Expand(Extract('0',
                                            Extract(p_gxy,
                                                    Extract(Expand(ms, <'rms', h(messages)>, '32'), '0'))),
                                    <'clientats', 
                                     h(<
                                        <
                                         <
                                          <'0', '1', '0x0303', p_nc, '0', $cipher_suites, '0', 
                                           <'43', '0x0304'>, <'10', $g1, $g2>, <'40', $g, p_gx>, 
                                           <'45', '0', '1'>, p_edi, '41', <~ticket, mask(x, x.1)>, 
                                           hmac(<
                                                 Expand(Expand(Extract(Expand(ms, <'rms', h(messages)>, '32'),
                                                                       '0'),
                                                               <'res', 'pbk'>, '32'),
                                                        <'0', '0'>, '32'), 
                                                 h(<'0', '1', '0x0303', p_nc, '0', $cipher_suites, '0', 
                                                    <'43', '0x0304'>, <'10', $g1, $g2>, <'40', $g, p_gx>, 
                                                    <'45', '0', '1'>, p_edi, '41', <~ticket, mask(x, x.1)>, 
                                                    '0'>)
                                                >)
                                          >, 
                                          '2', '0x0303', ~ns, $cipher_suite, <'13', $sig_algs>, 
                                          <'40', $g, $g^~y>, <'41', '0'>, p_edi>, 
                                         '8', $exts>, 
                                        '20', 
                                        hmac(<
                                              Expand(Expand(Extract(p_gxy,
                                                                    Extract(Expand(ms, <'rms', h(messages)>,
                                                                                   '32'),
                                                                            '0')),
                                                            <'serverhts', 
                                                             h(<
                                                                <
                                                                 <'0', '1', '0x0303', p_nc, '0', 
                                                                  $cipher_suites, '0', <'43', '0x0304'>, 
                                                                  <'10', $g1, $g2>, <'40', $g, p_gx>, 
                                                                  <'45', '0', '1'>, p_edi, '41', 
                                                                  <~ticket, mask(x, x.1)>, 
                                                                  hmac(<
                                                                        Expand(Expand(Extract(Expand(ms,
                                                                                                     <'rms', 
                                                                                                      h(messages)
                                                                                                     >,
                                                                                                     '32'),
                                                                                              '0'),
                                                                                      <'res', 'pbk'>, '32'),
                                                                               <'0', '0'>, '32'), 
                                                                        h(<'0', '1', '0x0303', p_nc, '0', 
                                                                           $cipher_suites, '0', 
                                                                           <'43', '0x0304'>, 
                                                                           <'10', $g1, $g2>, 
                                                                           <'40', $g, p_gx>, 
                                                                           <'45', '0', '1'>, p_edi, '41', 
                                                                           <~ticket, mask(x, x.1)>, '0'>)
                                                                       >)
                                                                 >, 
                                                                 '2', '0x0303', ~ns, $cipher_suite, 
                                                                 <'13', $sig_algs>, <'40', $g, $g^~y>, 
                                                                 <'41', '0'>, p_edi>, 
                                                                '8', $exts>)
                                                            >,
                                                            '32'),
                                                     <'fin', '0'>, '32'), 
                                              h(<
                                                 <
                                                  <'0', '1', '0x0303', p_nc, '0', $cipher_suites, '0', 
                                                   <'43', '0x0304'>, <'10', $g1, $g2>, <'40', $g, p_gx>, 
                                                   <'45', '0', '1'>, p_edi, '41', <~ticket, mask(x, x.1)>, 
                                                   hmac(<
                                                         Expand(Expand(Extract(Expand(ms,
                                                                                      <'rms', h(messages)>,
                                                                                      '32'),
                                                                               '0'),
                                                                       <'res', 'pbk'>, '32'),
                                                                <'0', '0'>, '32'), 
                                                         h(<'0', '1', '0x0303', p_nc, '0', $cipher_suites, 
                                                            '0', <'43', '0x0304'>, <'10', $g1, $g2>, 
                                                            <'40', $g, p_gx>, <'45', '0', '1'>, p_edi, '41', 
                                                            <~ticket, mask(x, x.1)>, '0'>)
                                                        >)
                                                  >, 
                                                  '2', '0x0303', ~ns, $cipher_suite, <'13', $sig_algs>, 
                                                  <'40', $g, $g^~y>, <'41', '0'>, p_edi>, 
                                                 '8', $exts>)
                                             >)
                                       >)
                                    >,
                                    '32')
                  ) ▶₀ #l )
      qed
    next
      case server_auth_psk_case_2
      solve( (∃ #j.2.
               (!KU( Extract('0',
                             Extract(p_gxy, Extract(Expand(ms, <'rms', h(messages)>, '32'), '0')))
                ) @ #j.2)
              ∧
               #j.2 < #j.1)  ∥
             ((∀ #k.
                (!KU( Extract('0',
                              Extract(p_gxy, Extract(Expand(ms, <'rms', h(messages)>, '32'), '0')))
                 ) @ #k)
               ⇒
                ¬(#k < #j.1)) ∧
              (∃ actor #l.
                (RevealPSK( actor,
                            Expand(Extract('0',
                                           Extract(p_gxy,
                                                   Extract(Expand(ms, <'rms', h(messages)>, '32'), '0'))),
                                   <'clientats', 
                                    h(<
                                       <
                                        <
                                         <<p_messages, '6', '0x0303', '40', $p_sg>, '1', '0x0303', p_nc, '0', 
                                          $cipher_suites, '0', <'43', '0x0304'>, <'10', $g1, $g2>, 
                                          <'40', $g, p_gx>, <'45', '0', '1'>, p_edi, '41', 
                                          <~ticket, mask(x, x.1)>, 
                                          hmac(<
                                                Expand(Expand(Extract(Expand(ms, <'rms', h(messages)>, '32'),
                                                                      '0'),
                                                              <'res', 'pbk'>, '32'),
                                                       <'0', '0'>, '32'), 
                                                h(<<p_messages, '6', '0x0303', '40', $p_sg>, '1', '0x0303', 
                                                   p_nc, '0', $cipher_suites, '0', <'43', '0x0304'>, 
                                                   <'10', $g1, $g2>, <'40', $g, p_gx>, <'45', '0', '1'>, 
                                                   p_edi, '41', <~ticket, mask(x, x.1)>, '0'>)
                                               >)
                                         >, 
                                         '2', '0x0303', ~ns, $cipher_suite, <'13', $sig_algs>, 
                                         <'40', $g, $g^~y>, <'41', '0'>, p_edi>, 
                                        '8', $exts>, 
                                       '20', 
                                       hmac(<
                                             Expand(Expand(Extract(p_gxy,
                                                                   Extract(Expand(ms, <'rms', h(messages)>,
                                                                                  '32'),
                                                                           '0')),
                                                           <'serverhts', 
                                                            h(<
                                                               <
                                                                <<p_messages, '6', '0x0303', '40', $p_sg>, 
                                                                 '1', '0x0303', p_nc, '0', $cipher_suites, 
                                                                 '0', <'43', '0x0304'>, <'10', $g1, $g2>, 
                                                                 <'40', $g, p_gx>, <'45', '0', '1'>, p_edi, 
                                                                 '41', <~ticket, mask(x, x.1)>, 
                                                                 hmac(<
                                                                       Expand(Expand(Extract(Expand(ms,
                                                                                                    <'rms', 
                                                                                                     h(messages)
                                                                                                    >,
                                                                                                    '32'),
                                                                                             '0'),
                                                                                     <'res', 'pbk'>, '32'),
                                                                              <'0', '0'>, '32'), 
                                                                       h(<
                                                                          <p_messages, '6', '0x0303', '40', 
                                                                           $p_sg>, 
                                                                          '1', '0x0303', p_nc, '0', 
                                                                          $cipher_suites, '0', 
                                                                          <'43', '0x0304'>, <'10', $g1, $g2>, 
                                                                          <'40', $g, p_gx>, <'45', '0', '1'>, 
                                                                          p_edi, '41', 
                                                                          <~ticket, mask(x, x.1)>, '0'>)
                                                                      >)
                                                                >, 
                                                                '2', '0x0303', ~ns, $cipher_suite, 
                                                                <'13', $sig_algs>, <'40', $g, $g^~y>, 
                                                                <'41', '0'>, p_edi>, 
                                                               '8', $exts>)
                                                           >,
                                                           '32'),
                                                    <'fin', '0'>, '32'), 
                                             h(<
                                                <
                                                 <<p_messages, '6', '0x0303', '40', $p_sg>, '1', '0x0303', 
                                                  p_nc, '0', $cipher_suites, '0', <'43', '0x0304'>, 
                                                  <'10', $g1, $g2>, <'40', $g, p_gx>, <'45', '0', '1'>, 
                                                  p_edi, '41', <~ticket, mask(x, x.1)>, 
                                                  hmac(<
                                                        Expand(Expand(Extract(Expand(ms, <'rms', h(messages)>,
                                                                                     '32'),
                                                                              '0'),
                                                                      <'res', 'pbk'>, '32'),
                                                               <'0', '0'>, '32'), 
                                                        h(<<p_messages, '6', '0x0303', '40', $p_sg>, '1', 
                                                           '0x0303', p_nc, '0', $cipher_suites, '0', 
                                                           <'43', '0x0304'>, <'10', $g1, $g2>, 
                                                           <'40', $g, p_gx>, <'45', '0', '1'>, p_edi, '41', 
                                                           <~ticket, mask(x, x.1)>, '0'>)
                                                       >)
                                                 >, 
                                                 '2', '0x0303', ~ns, $cipher_suite, <'13', $sig_algs>, 
                                                 <'40', $g, $g^~y>, <'41', '0'>, p_edi>, 
                                                '8', $exts>)
                                            >)
                                      >)
                                   >,
                                   '32')
                 ) @ #l)
               ∧
                #l < #j.1)) )
        case case_1
        solve( (∃ #r. (RevLtk( $C ) @ #r) ∧ #r < #i)  ∥
               (∃ tid3 x #r. (RevDHExp( tid3, $C, x ) @ #r) ∧ #r < #i)  ∥
               (∃ tid4 y #r. (RevDHExp( tid4, $S, y ) @ #r) ∧ #r < #i)  ∥
               (∃ rms #r. (RevealPSK( $S, rms ) @ #r) ∧ #r < #k.1)  ∥
               (∃ rms #r. (RevealPSK( $C, rms ) @ #r) ∧ #r < #k.1) )
          case case_1
          by contradiction /* from formulas */
        next
          case case_2
          by contradiction /* from formulas */
        next
          case case_3
          by contradiction /* from formulas */
        next
          case case_4
          by contradiction /* from formulas */
        next
          case case_5
          by contradiction /* from formulas */
        qed
      next
        case case_2
        by solve( SecretPSK( $A,
                             Expand(Extract('0',
                                            Extract(p_gxy,
                                                    Extract(Expand(ms, <'rms', h(messages)>, '32'), '0'))),
                                    <'clientats', 
                                     h(<
                                        <
                                         <
                                          <<p_messages, '6', '0x0303', '40', $p_sg>, '1', '0x0303', p_nc, 
                                           '0', $cipher_suites, '0', <'43', '0x0304'>, <'10', $g1, $g2>, 
                                           <'40', $g, p_gx>, <'45', '0', '1'>, p_edi, '41', 
                                           <~ticket, mask(x, x.1)>, 
                                           hmac(<
                                                 Expand(Expand(Extract(Expand(ms, <'rms', h(messages)>, '32'),
                                                                       '0'),
                                                               <'res', 'pbk'>, '32'),
                                                        <'0', '0'>, '32'), 
                                                 h(<<p_messages, '6', '0x0303', '40', $p_sg>, '1', '0x0303', 
                                                    p_nc, '0', $cipher_suites, '0', <'43', '0x0304'>, 
                                                    <'10', $g1, $g2>, <'40', $g, p_gx>, <'45', '0', '1'>, 
                                                    p_edi, '41', <~ticket, mask(x, x.1)>, '0'>)
                                                >)
                                          >, 
                                          '2', '0x0303', ~ns, $cipher_suite, <'13', $sig_algs>, 
                                          <'40', $g, $g^~y>, <'41', '0'>, p_edi>, 
                                         '8', $exts>, 
                                        '20', 
                                        hmac(<
                                              Expand(Expand(Extract(p_gxy,
                                                                    Extract(Expand(ms, <'rms', h(messages)>,
                                                                                   '32'),
                                                                            '0')),
                                                            <'serverhts', 
                                                             h(<
                                                                <
                                                                 <<p_messages, '6', '0x0303', '40', $p_sg>, 
                                                                  '1', '0x0303', p_nc, '0', $cipher_suites, 
                                                                  '0', <'43', '0x0304'>, <'10', $g1, $g2>, 
                                                                  <'40', $g, p_gx>, <'45', '0', '1'>, p_edi, 
                                                                  '41', <~ticket, mask(x, x.1)>, 
                                                                  hmac(<
                                                                        Expand(Expand(Extract(Expand(ms,
                                                                                                     <'rms', 
                                                                                                      h(messages)
                                                                                                     >,
                                                                                                     '32'),
                                                                                              '0'),
                                                                                      <'res', 'pbk'>, '32'),
                                                                               <'0', '0'>, '32'), 
                                                                        h(<
                                                                           <p_messages, '6', '0x0303', '40', 
                                                                            $p_sg>, 
                                                                           '1', '0x0303', p_nc, '0', 
                                                                           $cipher_suites, '0', 
                                                                           <'43', '0x0304'>, 
                                                                           <'10', $g1, $g2>, 
                                                                           <'40', $g, p_gx>, 
                                                                           <'45', '0', '1'>, p_edi, '41', 
                                                                           <~ticket, mask(x, x.1)>, '0'>)
                                                                       >)
                                                                 >, 
                                                                 '2', '0x0303', ~ns, $cipher_suite, 
                                                                 <'13', $sig_algs>, <'40', $g, $g^~y>, 
                                                                 <'41', '0'>, p_edi>, 
                                                                '8', $exts>)
                                                            >,
                                                            '32'),
                                                     <'fin', '0'>, '32'), 
                                              h(<
                                                 <
                                                  <<p_messages, '6', '0x0303', '40', $p_sg>, '1', '0x0303', 
                                                   p_nc, '0', $cipher_suites, '0', <'43', '0x0304'>, 
                                                   <'10', $g1, $g2>, <'40', $g, p_gx>, <'45', '0', '1'>, 
                                                   p_edi, '41', <~ticket, mask(x, x.1)>, 
                                                   hmac(<
                                                         Expand(Expand(Extract(Expand(ms,
                                                                                      <'rms', h(messages)>,
                                                                                      '32'),
                                                                               '0'),
                                                                       <'res', 'pbk'>, '32'),
                                                                <'0', '0'>, '32'), 
                                                         h(<<p_messages, '6', '0x0303', '40', $p_sg>, '1', 
                                                            '0x0303', p_nc, '0', $cipher_suites, '0', 
                                                            <'43', '0x0304'>, <'10', $g1, $g2>, 
                                                            <'40', $g, p_gx>, <'45', '0', '1'>, p_edi, '41', 
                                                            <~ticket, mask(x, x.1)>, '0'>)
                                                        >)
                                                  >, 
                                                  '2', '0x0303', ~ns, $cipher_suite, <'13', $sig_algs>, 
                                                  <'40', $g, $g^~y>, <'41', '0'>, p_edi>, 
                                                 '8', $exts>)
                                             >)
                                       >)
                                    >,
                                    '32')
                  ) ▶₀ #l )
      qed
    next
      case server_auth_psk_case_3
      by contradiction /* from formulas */
    next
      case server_auth_psk_case_4
      by contradiction /* from formulas */
    next
      case server_auth_psk_case_5
      solve( (∃ #j.2.
               (!KU( Extract('0',
                             Extract('0', Extract(Expand(ms, <'rms', h(messages)>, '32'), '0')))
                ) @ #j.2)
              ∧
               #j.2 < #j.1)  ∥
             ((∀ #k.
                (!KU( Extract('0',
                              Extract('0', Extract(Expand(ms, <'rms', h(messages)>, '32'), '0')))
                 ) @ #k)
               ⇒
                ¬(#k < #j.1)) ∧
              (∃ actor #l.
                (RevealPSK( actor,
                            Expand(Extract('0',
                                           Extract('0',
                                                   Extract(Expand(ms, <'rms', h(messages)>, '32'), '0'))),
                                   <'clientats', 
                                    h(<
                                       <
                                        <
                                         <'0', '1', '0x0303', p_nc, '0', $cipher_suites, '0', 
                                          <'43', '0x0304'>, <'10', $g1, $g2>, <'40', $new_g, p_gx>, 
                                          <'45', '0', '1'>, p_edi, '41', <~ticket, mask(x, x.1)>, 
                                          hmac(<
                                                Expand(Expand(Extract(Expand(ms, <'rms', h(messages)>, '32'),
                                                                      '0'),
                                                              <'res', 'pbk'>, '32'),
                                                       <'0', '0'>, '32'), 
                                                h(<'0', '1', '0x0303', p_nc, '0', $cipher_suites, '0', 
                                                   <'43', '0x0304'>, <'10', $g1, $g2>, <'40', $new_g, p_gx>, 
                                                   <'45', '0', '1'>, p_edi, '41', <~ticket, mask(x, x.1)>, '0'
                                                  >)
                                               >)
                                         >, 
                                         '2', '0x0303', ~ns, $cipher_suite, <'13', $sig_algs>, <'41', '0'>, 
                                         p_edi>, 
                                        '8', $exts>, 
                                       '20', 
                                       hmac(<
                                             Expand(Expand(Extract('0',
                                                                   Extract(Expand(ms, <'rms', h(messages)>,
                                                                                  '32'),
                                                                           '0')),
                                                           <'serverhts', 
                                                            h(<
                                                               <
                                                                <'0', '1', '0x0303', p_nc, '0', 
                                                                 $cipher_suites, '0', <'43', '0x0304'>, 
                                                                 <'10', $g1, $g2>, <'40', $new_g, p_gx>, 
                                                                 <'45', '0', '1'>, p_edi, '41', 
                                                                 <~ticket, mask(x, x.1)>, 
                                                                 hmac(<
                                                                       Expand(Expand(Extract(Expand(ms,
                                                                                                    <'rms', 
                                                                                                     h(messages)
                                                                                                    >,
                                                                                                    '32'),
                                                                                             '0'),
                                                                                     <'res', 'pbk'>, '32'),
                                                                              <'0', '0'>, '32'), 
                                                                       h(<'0', '1', '0x0303', p_nc, '0', 
                                                                          $cipher_suites, '0', 
                                                                          <'43', '0x0304'>, <'10', $g1, $g2>, 
                                                                          <'40', $new_g, p_gx>, 
                                                                          <'45', '0', '1'>, p_edi, '41', 
                                                                          <~ticket, mask(x, x.1)>, '0'>)
                                                                      >)
                                                                >, 
                                                                '2', '0x0303', ~ns, $cipher_suite, 
                                                                <'13', $sig_algs>, <'41', '0'>, p_edi>, 
                                                               '8', $exts>)
                                                           >,
                                                           '32'),
                                                    <'fin', '0'>, '32'), 
                                             h(<
                                                <
                                                 <'0', '1', '0x0303', p_nc, '0', $cipher_suites, '0', 
                                                  <'43', '0x0304'>, <'10', $g1, $g2>, <'40', $new_g, p_gx>, 
                                                  <'45', '0', '1'>, p_edi, '41', <~ticket, mask(x, x.1)>, 
                                                  hmac(<
                                                        Expand(Expand(Extract(Expand(ms, <'rms', h(messages)>,
                                                                                     '32'),
                                                                              '0'),
                                                                      <'res', 'pbk'>, '32'),
                                                               <'0', '0'>, '32'), 
                                                        h(<'0', '1', '0x0303', p_nc, '0', $cipher_suites, 
                                                           '0', <'43', '0x0304'>, <'10', $g1, $g2>, 
                                                           <'40', $new_g, p_gx>, <'45', '0', '1'>, p_edi, 
                                                           '41', <~ticket, mask(x, x.1)>, '0'>)
                                                       >)
                                                 >, 
                                                 '2', '0x0303', ~ns, $cipher_suite, <'13', $sig_algs>, 
                                                 <'41', '0'>, p_edi>, 
                                                '8', $exts>)
                                            >)
                                      >)
                                   >,
                                   '32')
                 ) @ #l)
               ∧
                #l < #j.1)) )
        case case_1
        solve( (∃ #r. (RevLtk( $C ) @ #r) ∧ #r < #i)  ∥
               (∃ tid3 x #r. (RevDHExp( tid3, $C, x ) @ #r) ∧ #r < #i)  ∥
               (∃ tid4 y #r. (RevDHExp( tid4, $S, y ) @ #r) ∧ #r < #i)  ∥
               (∃ rms #r. (RevealPSK( $S, rms ) @ #r) ∧ #r < #k)  ∥
               (∃ rms #r. (RevealPSK( $C, rms ) @ #r) ∧ #r < #k) )
          case case_1
          by contradiction /* from formulas */
        next
          case case_2
          by contradiction /* from formulas */
        next
          case case_3
          by contradiction /* from formulas */
        next
          case case_4
          by contradiction /* from formulas */
        next
          case case_5
          by contradiction /* from formulas */
        qed
      next
        case case_2
        by solve( SecretPSK( $A,
                             Expand(Extract('0',
                                            Extract('0',
                                                    Extract(Expand(ms, <'rms', h(messages)>, '32'), '0'))),
                                    <'clientats', 
                                     h(<
                                        <
                                         <
                                          <'0', '1', '0x0303', p_nc, '0', $cipher_suites, '0', 
                                           <'43', '0x0304'>, <'10', $g1, $g2>, <'40', $new_g, p_gx>, 
                                           <'45', '0', '1'>, p_edi, '41', <~ticket, mask(x, x.1)>, 
                                           hmac(<
                                                 Expand(Expand(Extract(Expand(ms, <'rms', h(messages)>, '32'),
                                                                       '0'),
                                                               <'res', 'pbk'>, '32'),
                                                        <'0', '0'>, '32'), 
                                                 h(<'0', '1', '0x0303', p_nc, '0', $cipher_suites, '0', 
                                                    <'43', '0x0304'>, <'10', $g1, $g2>, <'40', $new_g, p_gx>, 
                                                    <'45', '0', '1'>, p_edi, '41', <~ticket, mask(x, x.1)>, 
                                                    '0'>)
                                                >)
                                          >, 
                                          '2', '0x0303', ~ns, $cipher_suite, <'13', $sig_algs>, <'41', '0'>, 
                                          p_edi>, 
                                         '8', $exts>, 
                                        '20', 
                                        hmac(<
                                              Expand(Expand(Extract('0',
                                                                    Extract(Expand(ms, <'rms', h(messages)>,
                                                                                   '32'),
                                                                            '0')),
                                                            <'serverhts', 
                                                             h(<
                                                                <
                                                                 <'0', '1', '0x0303', p_nc, '0', 
                                                                  $cipher_suites, '0', <'43', '0x0304'>, 
                                                                  <'10', $g1, $g2>, <'40', $new_g, p_gx>, 
                                                                  <'45', '0', '1'>, p_edi, '41', 
                                                                  <~ticket, mask(x, x.1)>, 
                                                                  hmac(<
                                                                        Expand(Expand(Extract(Expand(ms,
                                                                                                     <'rms', 
                                                                                                      h(messages)
                                                                                                     >,
                                                                                                     '32'),
                                                                                              '0'),
                                                                                      <'res', 'pbk'>, '32'),
                                                                               <'0', '0'>, '32'), 
                                                                        h(<'0', '1', '0x0303', p_nc, '0', 
                                                                           $cipher_suites, '0', 
                                                                           <'43', '0x0304'>, 
                                                                           <'10', $g1, $g2>, 
                                                                           <'40', $new_g, p_gx>, 
                                                                           <'45', '0', '1'>, p_edi, '41', 
                                                                           <~ticket, mask(x, x.1)>, '0'>)
                                                                       >)
                                                                 >, 
                                                                 '2', '0x0303', ~ns, $cipher_suite, 
                                                                 <'13', $sig_algs>, <'41', '0'>, p_edi>, 
                                                                '8', $exts>)
                                                            >,
                                                            '32'),
                                                     <'fin', '0'>, '32'), 
                                              h(<
                                                 <
                                                  <'0', '1', '0x0303', p_nc, '0', $cipher_suites, '0', 
                                                   <'43', '0x0304'>, <'10', $g1, $g2>, <'40', $new_g, p_gx>, 
                                                   <'45', '0', '1'>, p_edi, '41', <~ticket, mask(x, x.1)>, 
                                                   hmac(<
                                                         Expand(Expand(Extract(Expand(ms,
                                                                                      <'rms', h(messages)>,
                                                                                      '32'),
                                                                               '0'),
                                                                       <'res', 'pbk'>, '32'),
                                                                <'0', '0'>, '32'), 
                                                         h(<'0', '1', '0x0303', p_nc, '0', $cipher_suites, 
                                                            '0', <'43', '0x0304'>, <'10', $g1, $g2>, 
                                                            <'40', $new_g, p_gx>, <'45', '0', '1'>, p_edi, 
                                                            '41', <~ticket, mask(x, x.1)>, '0'>)
                                                        >)
                                                  >, 
                                                  '2', '0x0303', ~ns, $cipher_suite, <'13', $sig_algs>, 
                                                  <'41', '0'>, p_edi>, 
                                                 '8', $exts>)
                                             >)
                                       >)
                                    >,
                                    '32')
                  ) ▶₀ #l )
      qed
    next
      case server_auth_psk_case_6
      solve( (∃ #j.2.
               (!KU( Extract('0',
                             Extract(p_gxy, Extract(Expand(ms, <'rms', h(messages)>, '32'), '0')))
                ) @ #j.2)
              ∧
               #j.2 < #j.1)  ∥
             ((∀ #k.
                (!KU( Extract('0',
                              Extract(p_gxy, Extract(Expand(ms, <'rms', h(messages)>, '32'), '0')))
                 ) @ #k)
               ⇒
                ¬(#k < #j.1)) ∧
              (∃ actor #l.
                (RevealPSK( actor,
                            Expand(Extract('0',
                                           Extract(p_gxy,
                                                   Extract(Expand(ms, <'rms', h(messages)>, '32'), '0'))),
                                   <'clientats', 
                                    h(<
                                       <
                                        <
                                         <<p_messages, '6', '0x0303', '40', $p_sg>, '1', '0x0303', p_nc, '0', 
                                          $cipher_suites, '0', <'43', '0x0304'>, <'10', $g1, $g2>, 
                                          <'40', $new_g, p_gx>, <'45', '0', '1'>, p_edi, '41', 
                                          <~ticket, mask(x, x.1)>, 
                                          hmac(<
                                                Expand(Expand(Extract(Expand(ms, <'rms', h(messages)>, '32'),
                                                                      '0'),
                                                              <'res', 'pbk'>, '32'),
                                                       <'0', '0'>, '32'), 
                                                h(<<p_messages, '6', '0x0303', '40', $p_sg>, '1', '0x0303', 
                                                   p_nc, '0', $cipher_suites, '0', <'43', '0x0304'>, 
                                                   <'10', $g1, $g2>, <'40', $new_g, p_gx>, <'45', '0', '1'>, 
                                                   p_edi, '41', <~ticket, mask(x, x.1)>, '0'>)
                                               >)
                                         >, 
                                         '2', '0x0303', ~ns, $cipher_suite, <'13', $sig_algs>, <'41', '0'>, 
                                         p_edi>, 
                                        '8', $exts>, 
                                       '20', 
                                       hmac(<
                                             Expand(Expand(Extract(p_gxy,
                                                                   Extract(Expand(ms, <'rms', h(messages)>,
                                                                                  '32'),
                                                                           '0')),
                                                           <'serverhts', 
                                                            h(<
                                                               <
                                                                <<p_messages, '6', '0x0303', '40', $p_sg>, 
                                                                 '1', '0x0303', p_nc, '0', $cipher_suites, 
                                                                 '0', <'43', '0x0304'>, <'10', $g1, $g2>, 
                                                                 <'40', $new_g, p_gx>, <'45', '0', '1'>, 
                                                                 p_edi, '41', <~ticket, mask(x, x.1)>, 
                                                                 hmac(<
                                                                       Expand(Expand(Extract(Expand(ms,
                                                                                                    <'rms', 
                                                                                                     h(messages)
                                                                                                    >,
                                                                                                    '32'),
                                                                                             '0'),
                                                                                     <'res', 'pbk'>, '32'),
                                                                              <'0', '0'>, '32'), 
                                                                       h(<
                                                                          <p_messages, '6', '0x0303', '40', 
                                                                           $p_sg>, 
                                                                          '1', '0x0303', p_nc, '0', 
                                                                          $cipher_suites, '0', 
                                                                          <'43', '0x0304'>, <'10', $g1, $g2>, 
                                                                          <'40', $new_g, p_gx>, 
                                                                          <'45', '0', '1'>, p_edi, '41', 
                                                                          <~ticket, mask(x, x.1)>, '0'>)
                                                                      >)
                                                                >, 
                                                                '2', '0x0303', ~ns, $cipher_suite, 
                                                                <'13', $sig_algs>, <'41', '0'>, p_edi>, 
                                                               '8', $exts>)
                                                           >,
                                                           '32'),
                                                    <'fin', '0'>, '32'), 
                                             h(<
                                                <
                                                 <<p_messages, '6', '0x0303', '40', $p_sg>, '1', '0x0303', 
                                                  p_nc, '0', $cipher_suites, '0', <'43', '0x0304'>, 
                                                  <'10', $g1, $g2>, <'40', $new_g, p_gx>, <'45', '0', '1'>, 
                                                  p_edi, '41', <~ticket, mask(x, x.1)>, 
                                                  hmac(<
                                                        Expand(Expand(Extract(Expand(ms, <'rms', h(messages)>,
                                                                                     '32'),
                                                                              '0'),
                                                                      <'res', 'pbk'>, '32'),
                                                               <'0', '0'>, '32'), 
                                                        h(<<p_messages, '6', '0x0303', '40', $p_sg>, '1', 
                                                           '0x0303', p_nc, '0', $cipher_suites, '0', 
                                                           <'43', '0x0304'>, <'10', $g1, $g2>, 
                                                           <'40', $new_g, p_gx>, <'45', '0', '1'>, p_edi, 
                                                           '41', <~ticket, mask(x, x.1)>, '0'>)
                                                       >)
                                                 >, 
                                                 '2', '0x0303', ~ns, $cipher_suite, <'13', $sig_algs>, 
                                                 <'41', '0'>, p_edi>, 
                                                '8', $exts>)
                                            >)
                                      >)
                                   >,
                                   '32')
                 ) @ #l)
               ∧
                #l < #j.1)) )
        case case_1
        solve( (∃ #r. (RevLtk( $C ) @ #r) ∧ #r < #i)  ∥
               (∃ tid3 x #r. (RevDHExp( tid3, $C, x ) @ #r) ∧ #r < #i)  ∥
               (∃ tid4 y #r. (RevDHExp( tid4, $S, y ) @ #r) ∧ #r < #i)  ∥
               (∃ rms #r. (RevealPSK( $S, rms ) @ #r) ∧ #r < #k.1)  ∥
               (∃ rms #r. (RevealPSK( $C, rms ) @ #r) ∧ #r < #k.1) )
          case case_1
          by contradiction /* from formulas */
        next
          case case_2
          by contradiction /* from formulas */
        next
          case case_3
          by contradiction /* from formulas */
        next
          case case_4
          by contradiction /* from formulas */
        next
          case case_5
          by contradiction /* from formulas */
        qed
      next
        case case_2
        by solve( SecretPSK( $A,
                             Expand(Extract('0',
                                            Extract(p_gxy,
                                                    Extract(Expand(ms, <'rms', h(messages)>, '32'), '0'))),
                                    <'clientats', 
                                     h(<
                                        <
                                         <
                                          <<p_messages, '6', '0x0303', '40', $p_sg>, '1', '0x0303', p_nc, 
                                           '0', $cipher_suites, '0', <'43', '0x0304'>, <'10', $g1, $g2>, 
                                           <'40', $new_g, p_gx>, <'45', '0', '1'>, p_edi, '41', 
                                           <~ticket, mask(x, x.1)>, 
                                           hmac(<
                                                 Expand(Expand(Extract(Expand(ms, <'rms', h(messages)>, '32'),
                                                                       '0'),
                                                               <'res', 'pbk'>, '32'),
                                                        <'0', '0'>, '32'), 
                                                 h(<<p_messages, '6', '0x0303', '40', $p_sg>, '1', '0x0303', 
                                                    p_nc, '0', $cipher_suites, '0', <'43', '0x0304'>, 
                                                    <'10', $g1, $g2>, <'40', $new_g, p_gx>, <'45', '0', '1'>, 
                                                    p_edi, '41', <~ticket, mask(x, x.1)>, '0'>)
                                                >)
                                          >, 
                                          '2', '0x0303', ~ns, $cipher_suite, <'13', $sig_algs>, <'41', '0'>, 
                                          p_edi>, 
                                         '8', $exts>, 
                                        '20', 
                                        hmac(<
                                              Expand(Expand(Extract(p_gxy,
                                                                    Extract(Expand(ms, <'rms', h(messages)>,
                                                                                   '32'),
                                                                            '0')),
                                                            <'serverhts', 
                                                             h(<
                                                                <
                                                                 <<p_messages, '6', '0x0303', '40', $p_sg>, 
                                                                  '1', '0x0303', p_nc, '0', $cipher_suites, 
                                                                  '0', <'43', '0x0304'>, <'10', $g1, $g2>, 
                                                                  <'40', $new_g, p_gx>, <'45', '0', '1'>, 
                                                                  p_edi, '41', <~ticket, mask(x, x.1)>, 
                                                                  hmac(<
                                                                        Expand(Expand(Extract(Expand(ms,
                                                                                                     <'rms', 
                                                                                                      h(messages)
                                                                                                     >,
                                                                                                     '32'),
                                                                                              '0'),
                                                                                      <'res', 'pbk'>, '32'),
                                                                               <'0', '0'>, '32'), 
                                                                        h(<
                                                                           <p_messages, '6', '0x0303', '40', 
                                                                            $p_sg>, 
                                                                           '1', '0x0303', p_nc, '0', 
                                                                           $cipher_suites, '0', 
                                                                           <'43', '0x0304'>, 
                                                                           <'10', $g1, $g2>, 
                                                                           <'40', $new_g, p_gx>, 
                                                                           <'45', '0', '1'>, p_edi, '41', 
                                                                           <~ticket, mask(x, x.1)>, '0'>)
                                                                       >)
                                                                 >, 
                                                                 '2', '0x0303', ~ns, $cipher_suite, 
                                                                 <'13', $sig_algs>, <'41', '0'>, p_edi>, 
                                                                '8', $exts>)
                                                            >,
                                                            '32'),
                                                     <'fin', '0'>, '32'), 
                                              h(<
                                                 <
                                                  <<p_messages, '6', '0x0303', '40', $p_sg>, '1', '0x0303', 
                                                   p_nc, '0', $cipher_suites, '0', <'43', '0x0304'>, 
                                                   <'10', $g1, $g2>, <'40', $new_g, p_gx>, <'45', '0', '1'>, 
                                                   p_edi, '41', <~ticket, mask(x, x.1)>, 
                                                   hmac(<
                                                         Expand(Expand(Extract(Expand(ms,
                                                                                      <'rms', h(messages)>,
                                                                                      '32'),
                                                                               '0'),
                                                                       <'res', 'pbk'>, '32'),
                                                                <'0', '0'>, '32'), 
                                                         h(<<p_messages, '6', '0x0303', '40', $p_sg>, '1', 
                                                            '0x0303', p_nc, '0', $cipher_suites, '0', 
                                                            <'43', '0x0304'>, <'10', $g1, $g2>, 
                                                            <'40', $new_g, p_gx>, <'45', '0', '1'>, p_edi, 
                                                            '41', <~ticket, mask(x, x.1)>, '0'>)
                                                        >)
                                                  >, 
                                                  '2', '0x0303', ~ns, $cipher_suite, <'13', $sig_algs>, 
                                                  <'41', '0'>, p_edi>, 
                                                 '8', $exts>)
                                             >)
                                       >)
                                    >,
                                    '32')
                  ) ▶₀ #l )
      qed
    next
      case server_auth_psk_case_7
      by contradiction /* from formulas */
    next
      case server_auth_psk_case_8
      by contradiction /* from formulas */
    qed
  next
    case case_2
    solve( F_State_S3( ~tid, $S, $C, p_res_psk, p_messages, p_nc, p_ns, p_g,
                       p_sg, p_hrr, p_x, p_y, p_gx, p_gy, p_gxy, p_psk_ke_mode, p_psk_id, p_edi,
                       p_es, p_hs, Extract('0', p_hs), p_cats, p_sats, p_hs_keyc, p_hs_keys,
                       <pas, 'auth'>, p_ems, p_rms, '0'
           ) ▶₀ #i )
      case server_auth_psk_case_1
      by solve( SecretPSK( $A,
                           Expand(Expand(Extract('0',
                                                 Extract(p_gxy,
                                                         Extract(Expand(ms, <'rms', h(messages)>, '32'),
                                                                 '0'))),
                                         <'clientats', 
                                          h(<
                                             <
                                              <
                                               <'0', '1', '0x0303', p_nc, '0', $cipher_suites, '0', 
                                                <'43', '0x0304'>, <'10', $g1, $g2>, <'40', $g, p_gx>, 
                                                <'45', '0', '1'>, p_edi, '41', <~ticket, mask(x, x.1)>, 
                                                hmac(<
                                                      Expand(Expand(Extract(Expand(ms, <'rms', h(messages)>,
                                                                                   '32'),
                                                                            '0'),
                                                                    <'res', 'pbk'>, '32'),
                                                             <'0', '0'>, '32'), 
                                                      h(<'0', '1', '0x0303', p_nc, '0', $cipher_suites, '0', 
                                                         <'43', '0x0304'>, <'10', $g1, $g2>, 
                                                         <'40', $g, p_gx>, <'45', '0', '1'>, p_edi, '41', 
                                                         <~ticket, mask(x, x.1)>, '0'>)
                                                     >)
                                               >, 
                                               '2', '0x0303', ~ns, $cipher_suite, <'13', $sig_algs>, 
                                               <'40', $g, $g^~y>, <'41', '0'>, p_edi>, 
                                              '8', $exts>, 
                                             '20', 
                                             hmac(<
                                                   Expand(Expand(Extract(p_gxy,
                                                                         Extract(Expand(ms,
                                                                                        <'rms', h(messages)>,
                                                                                        '32'),
                                                                                 '0')),
                                                                 <'serverhts', 
                                                                  h(<
                                                                     <
                                                                      <'0', '1', '0x0303', p_nc, '0', 
                                                                       $cipher_suites, '0', <'43', '0x0304'>, 
                                                                       <'10', $g1, $g2>, <'40', $g, p_gx>, 
                                                                       <'45', '0', '1'>, p_edi, '41', 
                                                                       <~ticket, mask(x, x.1)>, 
                                                                       hmac(<
                                                                             Expand(Expand(Extract(Expand(ms,
                                                                                                          <
                                                                                                           'rms', 
                                                                                                           h(messages)
                                                                                                          >,
                                                                                                          '32'),
                                                                                                   '0'),
                                                                                           <'res', 'pbk'>,
                                                                                           '32'),
                                                                                    <'0', '0'>, '32'), 
                                                                             h(<'0', '1', '0x0303', p_nc, 
                                                                                '0', $cipher_suites, '0', 
                                                                                <'43', '0x0304'>, 
                                                                                <'10', $g1, $g2>, 
                                                                                <'40', $g, p_gx>, 
                                                                                <'45', '0', '1'>, p_edi, 
                                                                                '41', 
                                                                                <~ticket, mask(x, x.1)>, '0'>)
                                                                            >)
                                                                      >, 
                                                                      '2', '0x0303', ~ns, $cipher_suite, 
                                                                      <'13', $sig_algs>, <'40', $g, $g^~y>, 
                                                                      <'41', '0'>, p_edi>, 
                                                                     '8', $exts>)
                                                                 >,
                                                                 '32'),
                                                          <'fin', '0'>, '32'), 
                                                   h(<
                                                      <
                                                       <'0', '1', '0x0303', p_nc, '0', $cipher_suites, '0', 
                                                        <'43', '0x0304'>, <'10', $g1, $g2>, <'40', $g, p_gx>, 
                                                        <'45', '0', '1'>, p_edi, '41', 
                                                        <~ticket, mask(x, x.1)>, 
                                                        hmac(<
                                                              Expand(Expand(Extract(Expand(ms,
                                                                                           <'rms', h(messages)
                                                                                           >,
                                                                                           '32'),
                                                                                    '0'),
                                                                            <'res', 'pbk'>, '32'),
                                                                     <'0', '0'>, '32'), 
                                                              h(<'0', '1', '0x0303', p_nc, '0', 
                                                                 $cipher_suites, '0', <'43', '0x0304'>, 
                                                                 <'10', $g1, $g2>, <'40', $g, p_gx>, 
                                                                 <'45', '0', '1'>, p_edi, '41', 
                                                                 <~ticket, mask(x, x.1)>, '0'>)
                                                             >)
                                                       >, 
                                                       '2', '0x0303', ~ns, $cipher_suite, <'13', $sig_algs>, 
                                                       <'40', $g, $g^~y>, <'41', '0'>, p_edi>, 
                                                      '8', $exts>)
                                                  >)
                                            >)
                                         >,
                                         '32'),
                                  <'adke_wk', '0'>, '32')
                ) ▶₀ #l )
    next
      case server_auth_psk_case_2
      by solve( SecretPSK( $A,
                           Expand(Expand(Extract('0',
                                                 Extract(p_gxy,
                                                         Extract(Expand(ms, <'rms', h(messages)>, '32'),
                                                                 '0'))),
                                         <'clientats', 
                                          h(<
                                             <
                                              <
                                               <<p_messages, '6', '0x0303', '40', $p_sg>, '1', '0x0303', 
                                                p_nc, '0', $cipher_suites, '0', <'43', '0x0304'>, 
                                                <'10', $g1, $g2>, <'40', $g, p_gx>, <'45', '0', '1'>, p_edi, 
                                                '41', <~ticket, mask(x, x.1)>, 
                                                hmac(<
                                                      Expand(Expand(Extract(Expand(ms, <'rms', h(messages)>,
                                                                                   '32'),
                                                                            '0'),
                                                                    <'res', 'pbk'>, '32'),
                                                             <'0', '0'>, '32'), 
                                                      h(<<p_messages, '6', '0x0303', '40', $p_sg>, '1', 
                                                         '0x0303', p_nc, '0', $cipher_suites, '0', 
                                                         <'43', '0x0304'>, <'10', $g1, $g2>, 
                                                         <'40', $g, p_gx>, <'45', '0', '1'>, p_edi, '41', 
                                                         <~ticket, mask(x, x.1)>, '0'>)
                                                     >)
                                               >, 
                                               '2', '0x0303', ~ns, $cipher_suite, <'13', $sig_algs>, 
                                               <'40', $g, $g^~y>, <'41', '0'>, p_edi>, 
                                              '8', $exts>, 
                                             '20', 
                                             hmac(<
                                                   Expand(Expand(Extract(p_gxy,
                                                                         Extract(Expand(ms,
                                                                                        <'rms', h(messages)>,
                                                                                        '32'),
                                                                                 '0')),
                                                                 <'serverhts', 
                                                                  h(<
                                                                     <
                                                                      <
                                                                       <p_messages, '6', '0x0303', '40', $p_sg
                                                                       >, 
                                                                       '1', '0x0303', p_nc, '0', 
                                                                       $cipher_suites, '0', <'43', '0x0304'>, 
                                                                       <'10', $g1, $g2>, <'40', $g, p_gx>, 
                                                                       <'45', '0', '1'>, p_edi, '41', 
                                                                       <~ticket, mask(x, x.1)>, 
                                                                       hmac(<
                                                                             Expand(Expand(Extract(Expand(ms,
                                                                                                          <
                                                                                                           'rms', 
                                                                                                           h(messages)
                                                                                                          >,
                                                                                                          '32'),
                                                                                                   '0'),
                                                                                           <'res', 'pbk'>,
                                                                                           '32'),
                                                                                    <'0', '0'>, '32'), 
                                                                             h(<
                                                                                <p_messages, '6', '0x0303', 
                                                                                 '40', $p_sg>, 
                                                                                '1', '0x0303', p_nc, '0', 
                                                                                $cipher_suites, '0', 
                                                                                <'43', '0x0304'>, 
                                                                                <'10', $g1, $g2>, 
                                                                                <'40', $g, p_gx>, 
                                                                                <'45', '0', '1'>, p_edi, 
                                                                                '41', 
                                                                                <~ticket, mask(x, x.1)>, '0'>)
                                                                            >)
                                                                      >, 
                                                                      '2', '0x0303', ~ns, $cipher_suite, 
                                                                      <'13', $sig_algs>, <'40', $g, $g^~y>, 
                                                                      <'41', '0'>, p_edi>, 
                                                                     '8', $exts>)
                                                                 >,
                                                                 '32'),
                                                          <'fin', '0'>, '32'), 
                                                   h(<
                                                      <
                                                       <<p_messages, '6', '0x0303', '40', $p_sg>, '1', 
                                                        '0x0303', p_nc, '0', $cipher_suites, '0', 
                                                        <'43', '0x0304'>, <'10', $g1, $g2>, <'40', $g, p_gx>, 
                                                        <'45', '0', '1'>, p_edi, '41', 
                                                        <~ticket, mask(x, x.1)>, 
                                                        hmac(<
                                                              Expand(Expand(Extract(Expand(ms,
                                                                                           <'rms', h(messages)
                                                                                           >,
                                                                                           '32'),
                                                                                    '0'),
                                                                            <'res', 'pbk'>, '32'),
                                                                     <'0', '0'>, '32'), 
                                                              h(<<p_messages, '6', '0x0303', '40', $p_sg>, 
                                                                 '1', '0x0303', p_nc, '0', $cipher_suites, 
                                                                 '0', <'43', '0x0304'>, <'10', $g1, $g2>, 
                                                                 <'40', $g, p_gx>, <'45', '0', '1'>, p_edi, 
                                                                 '41', <~ticket, mask(x, x.1)>, '0'>)
                                                             >)
                                                       >, 
                                                       '2', '0x0303', ~ns, $cipher_suite, <'13', $sig_algs>, 
                                                       <'40', $g, $g^~y>, <'41', '0'>, p_edi>, 
                                                      '8', $exts>)
                                                  >)
                                            >)
                                         >,
                                         '32'),
                                  <'adke_wk', '0'>, '32')
                ) ▶₀ #l )
    next
      case server_auth_psk_case_3
      by contradiction /* from formulas */
    next
      case server_auth_psk_case_4
      by contradiction /* from formulas */
    next
      case server_auth_psk_case_5
      by solve( SecretPSK( $A,
                           Expand(Expand(Extract('0',
                                                 Extract('0',
                                                         Extract(Expand(ms, <'rms', h(messages)>, '32'),
                                                                 '0'))),
                                         <'clientats', 
                                          h(<
                                             <
                                              <
                                               <'0', '1', '0x0303', p_nc, '0', $cipher_suites, '0', 
                                                <'43', '0x0304'>, <'10', $g1, $g2>, <'40', $new_g, p_gx>, 
                                                <'45', '0', '1'>, p_edi, '41', <~ticket, mask(x, x.1)>, 
                                                hmac(<
                                                      Expand(Expand(Extract(Expand(ms, <'rms', h(messages)>,
                                                                                   '32'),
                                                                            '0'),
                                                                    <'res', 'pbk'>, '32'),
                                                             <'0', '0'>, '32'), 
                                                      h(<'0', '1', '0x0303', p_nc, '0', $cipher_suites, '0', 
                                                         <'43', '0x0304'>, <'10', $g1, $g2>, 
                                                         <'40', $new_g, p_gx>, <'45', '0', '1'>, p_edi, '41', 
                                                         <~ticket, mask(x, x.1)>, '0'>)
                                                     >)
                                               >, 
                                               '2', '0x0303', ~ns, $cipher_suite, <'13', $sig_algs>, 
                                               <'41', '0'>, p_edi>, 
                                              '8', $exts>, 
                                             '20', 
                                             hmac(<
                                                   Expand(Expand(Extract('0',
                                                                         Extract(Expand(ms,
                                                                                        <'rms', h(messages)>,
                                                                                        '32'),
                                                                                 '0')),
                                                                 <'serverhts', 
                                                                  h(<
                                                                     <
                                                                      <'0', '1', '0x0303', p_nc, '0', 
                                                                       $cipher_suites, '0', <'43', '0x0304'>, 
                                                                       <'10', $g1, $g2>, 
                                                                       <'40', $new_g, p_gx>, 
                                                                       <'45', '0', '1'>, p_edi, '41', 
                                                                       <~ticket, mask(x, x.1)>, 
                                                                       hmac(<
                                                                             Expand(Expand(Extract(Expand(ms,
                                                                                                          <
                                                                                                           'rms', 
                                                                                                           h(messages)
                                                                                                          >,
                                                                                                          '32'),
                                                                                                   '0'),
                                                                                           <'res', 'pbk'>,
                                                                                           '32'),
                                                                                    <'0', '0'>, '32'), 
                                                                             h(<'0', '1', '0x0303', p_nc, 
                                                                                '0', $cipher_suites, '0', 
                                                                                <'43', '0x0304'>, 
                                                                                <'10', $g1, $g2>, 
                                                                                <'40', $new_g, p_gx>, 
                                                                                <'45', '0', '1'>, p_edi, 
                                                                                '41', 
                                                                                <~ticket, mask(x, x.1)>, '0'>)
                                                                            >)
                                                                      >, 
                                                                      '2', '0x0303', ~ns, $cipher_suite, 
                                                                      <'13', $sig_algs>, <'41', '0'>, p_edi>, 
                                                                     '8', $exts>)
                                                                 >,
                                                                 '32'),
                                                          <'fin', '0'>, '32'), 
                                                   h(<
                                                      <
                                                       <'0', '1', '0x0303', p_nc, '0', $cipher_suites, '0', 
                                                        <'43', '0x0304'>, <'10', $g1, $g2>, 
                                                        <'40', $new_g, p_gx>, <'45', '0', '1'>, p_edi, '41', 
                                                        <~ticket, mask(x, x.1)>, 
                                                        hmac(<
                                                              Expand(Expand(Extract(Expand(ms,
                                                                                           <'rms', h(messages)
                                                                                           >,
                                                                                           '32'),
                                                                                    '0'),
                                                                            <'res', 'pbk'>, '32'),
                                                                     <'0', '0'>, '32'), 
                                                              h(<'0', '1', '0x0303', p_nc, '0', 
                                                                 $cipher_suites, '0', <'43', '0x0304'>, 
                                                                 <'10', $g1, $g2>, <'40', $new_g, p_gx>, 
                                                                 <'45', '0', '1'>, p_edi, '41', 
                                                                 <~ticket, mask(x, x.1)>, '0'>)
                                                             >)
                                                       >, 
                                                       '2', '0x0303', ~ns, $cipher_suite, <'13', $sig_algs>, 
                                                       <'41', '0'>, p_edi>, 
                                                      '8', $exts>)
                                                  >)
                                            >)
                                         >,
                                         '32'),
                                  <'adke_wk', '0'>, '32')
                ) ▶₀ #l )
    next
      case server_auth_psk_case_6
      by solve( SecretPSK( $A,
                           Expand(Expand(Extract('0',
                                                 Extract(p_gxy,
                                                         Extract(Expand(ms, <'rms', h(messages)>, '32'),
                                                                 '0'))),
                                         <'clientats', 
                                          h(<
                                             <
                                              <
                                               <<p_messages, '6', '0x0303', '40', $p_sg>, '1', '0x0303', 
                                                p_nc, '0', $cipher_suites, '0', <'43', '0x0304'>, 
                                                <'10', $g1, $g2>, <'40', $new_g, p_gx>, <'45', '0', '1'>, 
                                                p_edi, '41', <~ticket, mask(x, x.1)>, 
                                                hmac(<
                                                      Expand(Expand(Extract(Expand(ms, <'rms', h(messages)>,
                                                                                   '32'),
                                                                            '0'),
                                                                    <'res', 'pbk'>, '32'),
                                                             <'0', '0'>, '32'), 
                                                      h(<<p_messages, '6', '0x0303', '40', $p_sg>, '1', 
                                                         '0x0303', p_nc, '0', $cipher_suites, '0', 
                                                         <'43', '0x0304'>, <'10', $g1, $g2>, 
                                                         <'40', $new_g, p_gx>, <'45', '0', '1'>, p_edi, '41', 
                                                         <~ticket, mask(x, x.1)>, '0'>)
                                                     >)
                                               >, 
                                               '2', '0x0303', ~ns, $cipher_suite, <'13', $sig_algs>, 
                                               <'41', '0'>, p_edi>, 
                                              '8', $exts>, 
                                             '20', 
                                             hmac(<
                                                   Expand(Expand(Extract(p_gxy,
                                                                         Extract(Expand(ms,
                                                                                        <'rms', h(messages)>,
                                                                                        '32'),
                                                                                 '0')),
                                                                 <'serverhts', 
                                                                  h(<
                                                                     <
                                                                      <
                                                                       <p_messages, '6', '0x0303', '40', $p_sg
                                                                       >, 
                                                                       '1', '0x0303', p_nc, '0', 
                                                                       $cipher_suites, '0', <'43', '0x0304'>, 
                                                                       <'10', $g1, $g2>, 
                                                                       <'40', $new_g, p_gx>, 
                                                                       <'45', '0', '1'>, p_edi, '41', 
                                                                       <~ticket, mask(x, x.1)>, 
                                                                       hmac(<
                                                                             Expand(Expand(Extract(Expand(ms,
                                                                                                          <
                                                                                                           'rms', 
                                                                                                           h(messages)
                                                                                                          >,
                                                                                                          '32'),
                                                                                                   '0'),
                                                                                           <'res', 'pbk'>,
                                                                                           '32'),
                                                                                    <'0', '0'>, '32'), 
                                                                             h(<
                                                                                <p_messages, '6', '0x0303', 
                                                                                 '40', $p_sg>, 
                                                                                '1', '0x0303', p_nc, '0', 
                                                                                $cipher_suites, '0', 
                                                                                <'43', '0x0304'>, 
                                                                                <'10', $g1, $g2>, 
                                                                                <'40', $new_g, p_gx>, 
                                                                                <'45', '0', '1'>, p_edi, 
                                                                                '41', 
                                                                                <~ticket, mask(x, x.1)>, '0'>)
                                                                            >)
                                                                      >, 
                                                                      '2', '0x0303', ~ns, $cipher_suite, 
                                                                      <'13', $sig_algs>, <'41', '0'>, p_edi>, 
                                                                     '8', $exts>)
                                                                 >,
                                                                 '32'),
                                                          <'fin', '0'>, '32'), 
                                                   h(<
                                                      <
                                                       <<p_messages, '6', '0x0303', '40', $p_sg>, '1', 
                                                        '0x0303', p_nc, '0', $cipher_suites, '0', 
                                                        <'43', '0x0304'>, <'10', $g1, $g2>, 
                                                        <'40', $new_g, p_gx>, <'45', '0', '1'>, p_edi, '41', 
                                                        <~ticket, mask(x, x.1)>, 
                                                        hmac(<
                                                              Expand(Expand(Extract(Expand(ms,
                                                                                           <'rms', h(messages)
                                                                                           >,
                                                                                           '32'),
                                                                                    '0'),
                                                                            <'res', 'pbk'>, '32'),
                                                                     <'0', '0'>, '32'), 
                                                              h(<<p_messages, '6', '0x0303', '40', $p_sg>, 
                                                                 '1', '0x0303', p_nc, '0', $cipher_suites, 
                                                                 '0', <'43', '0x0304'>, <'10', $g1, $g2>, 
                                                                 <'40', $new_g, p_gx>, <'45', '0', '1'>, 
                                                                 p_edi, '41', <~ticket, mask(x, x.1)>, '0'>)
                                                             >)
                                                       >, 
                                                       '2', '0x0303', ~ns, $cipher_suite, <'13', $sig_algs>, 
                                                       <'41', '0'>, p_edi>, 
                                                      '8', $exts>)
                                                  >)
                                            >)
                                         >,
                                         '32'),
                                  <'adke_wk', '0'>, '32')
                ) ▶₀ #l )
    next
      case server_auth_psk_case_7
      by contradiction /* from formulas */
    next
      case server_auth_psk_case_8
      by contradiction /* from formulas */
    qed
  qed
next
  case recv_client_auth_cert
  solve( (∃ #j. (!KU( p_cats ) @ #j) ∧ #j < #vk)  ∥
         ((∀ #k. (!KU( p_cats ) @ #k) ⇒ ¬(#k < #vk)) ∧
          (∃ actor #l.
            (RevealPSK( actor, Expand(p_cats, <'adke_wk', '0'>, '32') ) @ #l)
           ∧
            #l < #vk)) )
    case case_1
    solve( F_State_S3( ~tid, $S, $C, p_res_psk, p_messages, p_nc, p_ns, p_g,
                       p_sg, p_hrr, p_x, p_y, p_gx, p_gy, p_gxy, p_psk_ke_mode, p_psk_id, p_edi,
                       p_es, p_hs, Extract('0', p_hs), p_cats, p_sats, p_hs_keyc, p_hs_keys,
                       p_auth_status, p_ems, p_rms, '1'
           ) ▶₀ #i )
      case server_auth_case_01
      solve( (∃ #j.2.
               (!KU( Extract('0', Extract(p_gxy, Extract('0', '0'))) ) @ #j.2)
              ∧
               #j.2 < #j.1)  ∥
             ((∀ #k.
                (!KU( Extract('0', Extract(p_gxy, Extract('0', '0'))) ) @ #k)
               ⇒
                ¬(#k < #j.1)) ∧
              (∃ actor #l.
                (RevealPSK( actor,
                            Expand(Extract('0', Extract(p_gxy, Extract('0', '0'))),
                                   <'clientats', 
                                    h(<
                                       <
                                        <
                                         <
                                          <
                                           <
                                            <'0', '1', '0x0303', p_nc, '0', $cipher_suites, '0', 
                                             <'43', '0x0304'>, <'10', $g1, $g2>, <'13', $sig_algs>, '40', 
                                             $p_g, p_gx>, 
                                            '2', '0x0303', ~new_ns, $cipher_suite, <'13', $sig_algs.1>, '40', 
                                            $p_g, $p_g^~y>, 
                                           '8', $exts>, 
                                          '13', '0', $certificate_extensions>, 
                                         '11', '0', pk(~ltkS)>, 
                                        '15', 
                                        sign(<'server_cv', 
                                              h(<
                                                 <
                                                  <
                                                   <
                                                    <'0', '1', '0x0303', p_nc, '0', $cipher_suites, '0', 
                                                     <'43', '0x0304'>, <'10', $g1, $g2>, <'13', $sig_algs>, 
                                                     '40', $p_g, p_gx>, 
                                                    '2', '0x0303', ~new_ns, $cipher_suite, 
                                                    <'13', $sig_algs.1>, '40', $p_g, $p_g^~y>, 
                                                   '8', $exts>, 
                                                  '13', '0', $certificate_extensions>, 
                                                 '11', '0', pk(~ltkS)>)
                                             >,
                                             ~ltkS)
                                       >, 
                                       '20', 
                                       hmac(<
                                             Expand(Expand(Extract(p_gxy, Extract('0', '0')),
                                                           <'serverhts', 
                                                            h(<
                                                               <
                                                                <
                                                                 <
                                                                  <
                                                                   <'0', '1', '0x0303', p_nc, '0', 
                                                                    $cipher_suites, '0', <'43', '0x0304'>, 
                                                                    <'10', $g1, $g2>, <'13', $sig_algs>, 
                                                                    '40', $p_g, p_gx>, 
                                                                   '2', '0x0303', ~new_ns, $cipher_suite, 
                                                                   <'13', $sig_algs.1>, '40', $p_g, $p_g^~y>, 
                                                                  '8', $exts>, 
                                                                 '13', '0', $certificate_extensions>, 
                                                                '11', '0', pk(~ltkS)>, 
                                                               '15', 
                                                               sign(<'server_cv', 
                                                                     h(<
                                                                        <
                                                                         <
                                                                          <
                                                                           <'0', '1', '0x0303', p_nc, '0', 
                                                                            $cipher_suites, '0', 
                                                                            <'43', '0x0304'>, 
                                                                            <'10', $g1, $g2>, 
                                                                            <'13', $sig_algs>, '40', $p_g, 
                                                                            p_gx>, 
                                                                           '2', '0x0303', ~new_ns, 
                                                                           $cipher_suite, 
                                                                           <'13', $sig_algs.1>, '40', $p_g, 
                                                                           $p_g^~y>, 
                                                                          '8', $exts>, 
                                                                         '13', '0', $certificate_extensions>, 
                                                                        '11', '0', pk(~ltkS)>)
                                                                    >,
                                                                    ~ltkS)
                                                              >)
                                                           >,
                                                           '32'),
                                                    <'fin', '0'>, '32'), 
                                             h(<
                                                <
                                                 <
                                                  <
                                                   <
                                                    <'0', '1', '0x0303', p_nc, '0', $cipher_suites, '0', 
                                                     <'43', '0x0304'>, <'10', $g1, $g2>, <'13', $sig_algs>, 
                                                     '40', $p_g, p_gx>, 
                                                    '2', '0x0303', ~new_ns, $cipher_suite, 
                                                    <'13', $sig_algs.1>, '40', $p_g, $p_g^~y>, 
                                                   '8', $exts>, 
                                                  '13', '0', $certificate_extensions>, 
                                                 '11', '0', pk(~ltkS)>, 
                                                '15', 
                                                sign(<'server_cv', 
                                                      h(<
                                                         <
                                                          <
                                                           <
                                                            <'0', '1', '0x0303', p_nc, '0', $cipher_suites, 
                                                             '0', <'43', '0x0304'>, <'10', $g1, $g2>, 
                                                             <'13', $sig_algs>, '40', $p_g, p_gx>, 
                                                            '2', '0x0303', ~new_ns, $cipher_suite, 
                                                            <'13', $sig_algs.1>, '40', $p_g, $p_g^~y>, 
                                                           '8', $exts>, 
                                                          '13', '0', $certificate_extensions>, 
                                                         '11', '0', pk(~ltkS)>)
                                                     >,
                                                     ~ltkS)
                                               >)
                                            >)
                                      >)
                                   >,
                                   '32')
                 ) @ #l)
               ∧
                #l < #j.1)) )
        case case_1
        solve( (∃ #r. (RevLtk( $C ) @ #r) ∧ #r < #i)  ∥
               (∃ tid3 x #r. (RevDHExp( tid3, $C, x ) @ #r) ∧ #r < #i)  ∥
               (∃ tid4 y #r. (RevDHExp( tid4, $S, y ) @ #r) ∧ #r < #i)  ∥
               (∃ rms #r. (RevealPSK( $S, rms ) @ #r) ∧ #r < #k.1)  ∥
               (∃ rms #r. (RevealPSK( $C, rms ) @ #r) ∧ #r < #k.1) )
          case case_1
          by contradiction /* from formulas */
        next
          case case_2
          by contradiction /* from formulas */
        next
          case case_3
          by contradiction /* from formulas */
        next
          case case_4
          by contradiction /* from formulas */
        next
          case case_5
          by contradiction /* from formulas */
        qed
      next
        case case_2
        solve( !Pk( $C, pk(~ltkC) ) ▶₁ #i )
          case Register_pk
          by solve( SecretPSK( $A,
                               Expand(Extract('0', Extract(p_gxy, Extract('0', '0'))),
                                      <'clientats', 
                                       h(<
                                          <
                                           <
                                            <
                                             <
                                              <
                                               <'0', '1', '0x0303', p_nc, '0', $cipher_suites, '0', 
                                                <'43', '0x0304'>, <'10', $g1, $g2>, <'13', $sig_algs>, '40', 
                                                $p_g, p_gx>, 
                                               '2', '0x0303', ~new_ns, $cipher_suite, <'13', $sig_algs.1>, 
                                               '40', $p_g, $p_g^~y>, 
                                              '8', $exts>, 
                                             '13', '0', $certificate_extensions>, 
                                            '11', '0', pk(~ltkS)>, 
                                           '15', 
                                           sign(<'server_cv', 
                                                 h(<
                                                    <
                                                     <
                                                      <
                                                       <'0', '1', '0x0303', p_nc, '0', $cipher_suites, '0', 
                                                        <'43', '0x0304'>, <'10', $g1, $g2>, 
                                                        <'13', $sig_algs>, '40', $p_g, p_gx>, 
                                                       '2', '0x0303', ~new_ns, $cipher_suite, 
                                                       <'13', $sig_algs.1>, '40', $p_g, $p_g^~y>, 
                                                      '8', $exts>, 
                                                     '13', '0', $certificate_extensions>, 
                                                    '11', '0', pk(~ltkS)>)
                                                >,
                                                ~ltkS)
                                          >, 
                                          '20', 
                                          hmac(<
                                                Expand(Expand(Extract(p_gxy, Extract('0', '0')),
                                                              <'serverhts', 
                                                               h(<
                                                                  <
                                                                   <
                                                                    <
                                                                     <
                                                                      <'0', '1', '0x0303', p_nc, '0', 
                                                                       $cipher_suites, '0', <'43', '0x0304'>, 
                                                                       <'10', $g1, $g2>, <'13', $sig_algs>, 
                                                                       '40', $p_g, p_gx>, 
                                                                      '2', '0x0303', ~new_ns, $cipher_suite, 
                                                                      <'13', $sig_algs.1>, '40', $p_g, $p_g^~y
                                                                     >, 
                                                                     '8', $exts>, 
                                                                    '13', '0', $certificate_extensions>, 
                                                                   '11', '0', pk(~ltkS)>, 
                                                                  '15', 
                                                                  sign(<'server_cv', 
                                                                        h(<
                                                                           <
                                                                            <
                                                                             <
                                                                              <'0', '1', '0x0303', p_nc, '0', 
                                                                               $cipher_suites, '0', 
                                                                               <'43', '0x0304'>, 
                                                                               <'10', $g1, $g2>, 
                                                                               <'13', $sig_algs>, '40', $p_g, 
                                                                               p_gx>, 
                                                                              '2', '0x0303', ~new_ns, 
                                                                              $cipher_suite, 
                                                                              <'13', $sig_algs.1>, '40', 
                                                                              $p_g, $p_g^~y>, 
                                                                             '8', $exts>, 
                                                                            '13', '0', $certificate_extensions
                                                                           >, 
                                                                           '11', '0', pk(~ltkS)>)
                                                                       >,
                                                                       ~ltkS)
                                                                 >)
                                                              >,
                                                              '32'),
                                                       <'fin', '0'>, '32'), 
                                                h(<
                                                   <
                                                    <
                                                     <
                                                      <
                                                       <'0', '1', '0x0303', p_nc, '0', $cipher_suites, '0', 
                                                        <'43', '0x0304'>, <'10', $g1, $g2>, 
                                                        <'13', $sig_algs>, '40', $p_g, p_gx>, 
                                                       '2', '0x0303', ~new_ns, $cipher_suite, 
                                                       <'13', $sig_algs.1>, '40', $p_g, $p_g^~y>, 
                                                      '8', $exts>, 
                                                     '13', '0', $certificate_extensions>, 
                                                    '11', '0', pk(~ltkS)>, 
                                                   '15', 
                                                   sign(<'server_cv', 
                                                         h(<
                                                            <
                                                             <
                                                              <
                                                               <'0', '1', '0x0303', p_nc, '0', 
                                                                $cipher_suites, '0', <'43', '0x0304'>, 
                                                                <'10', $g1, $g2>, <'13', $sig_algs>, '40', 
                                                                $p_g, p_gx>, 
                                                               '2', '0x0303', ~new_ns, $cipher_suite, 
                                                               <'13', $sig_algs.1>, '40', $p_g, $p_g^~y>, 
                                                              '8', $exts>, 
                                                             '13', '0', $certificate_extensions>, 
                                                            '11', '0', pk(~ltkS)>)
                                                        >,
                                                        ~ltkS)
                                                  >)
                                               >)
                                         >)
                                      >,
                                      '32')
                    ) ▶₀ #l )
        qed
      qed
    next
      case server_auth_case_02
      solve( (∃ #j.2.
               (!KU( Extract('0', Extract(p_gxy, Extract(p_res_psk, '0'))) ) @ #j.2)
              ∧
               #j.2 < #j.1)  ∥
             ((∀ #k.
                (!KU( Extract('0', Extract(p_gxy, Extract(p_res_psk, '0'))) ) @ #k)
               ⇒
                ¬(#k < #j.1)) ∧
              (∃ actor #l.
                (RevealPSK( actor,
                            Expand(Extract('0', Extract(p_gxy, Extract(p_res_psk, '0'))),
                                   <'clientats', 
                                    h(<
                                       <
                                        <
                                         <
                                          <
                                           <
                                            <<p_messages, '6', '0x0303', '40', $p_g>, '1', '0x0303', p_nc, 
                                             '0', $cipher_suites, '0', <'43', '0x0304'>, <'10', $g1, $g2>, 
                                             <'13', $sig_algs>, '40', $p_g, p_gx>, 
                                            '2', '0x0303', ~new_ns, $cipher_suite, <'13', $sig_algs.1>, '40', 
                                            $p_g, $p_g^~y>, 
                                           '8', $exts>, 
                                          '13', '0', $certificate_extensions>, 
                                         '11', '0', pk(~ltkS)>, 
                                        '15', 
                                        sign(<'server_cv', 
                                              h(<
                                                 <
                                                  <
                                                   <
                                                    <<p_messages, '6', '0x0303', '40', $p_g>, '1', '0x0303', 
                                                     p_nc, '0', $cipher_suites, '0', <'43', '0x0304'>, 
                                                     <'10', $g1, $g2>, <'13', $sig_algs>, '40', $p_g, p_gx>, 
                                                    '2', '0x0303', ~new_ns, $cipher_suite, 
                                                    <'13', $sig_algs.1>, '40', $p_g, $p_g^~y>, 
                                                   '8', $exts>, 
                                                  '13', '0', $certificate_extensions>, 
                                                 '11', '0', pk(~ltkS)>)
                                             >,
                                             ~ltkS)
                                       >, 
                                       '20', 
                                       hmac(<
                                             Expand(Expand(Extract(p_gxy, Extract(p_res_psk, '0')),
                                                           <'serverhts', 
                                                            h(<
                                                               <
                                                                <
                                                                 <
                                                                  <
                                                                   <<p_messages, '6', '0x0303', '40', $p_g>, 
                                                                    '1', '0x0303', p_nc, '0', $cipher_suites, 
                                                                    '0', <'43', '0x0304'>, <'10', $g1, $g2>, 
                                                                    <'13', $sig_algs>, '40', $p_g, p_gx>, 
                                                                   '2', '0x0303', ~new_ns, $cipher_suite, 
                                                                   <'13', $sig_algs.1>, '40', $p_g, $p_g^~y>, 
                                                                  '8', $exts>, 
                                                                 '13', '0', $certificate_extensions>, 
                                                                '11', '0', pk(~ltkS)>, 
                                                               '15', 
                                                               sign(<'server_cv', 
                                                                     h(<
                                                                        <
                                                                         <
                                                                          <
                                                                           <
                                                                            <p_messages, '6', '0x0303', '40', 
                                                                             $p_g>, 
                                                                            '1', '0x0303', p_nc, '0', 
                                                                            $cipher_suites, '0', 
                                                                            <'43', '0x0304'>, 
                                                                            <'10', $g1, $g2>, 
                                                                            <'13', $sig_algs>, '40', $p_g, 
                                                                            p_gx>, 
                                                                           '2', '0x0303', ~new_ns, 
                                                                           $cipher_suite, 
                                                                           <'13', $sig_algs.1>, '40', $p_g, 
                                                                           $p_g^~y>, 
                                                                          '8', $exts>, 
                                                                         '13', '0', $certificate_extensions>, 
                                                                        '11', '0', pk(~ltkS)>)
                                                                    >,
                                                                    ~ltkS)
                                                              >)
                                                           >,
                                                           '32'),
                                                    <'fin', '0'>, '32'), 
                                             h(<
                                                <
                                                 <
                                                  <
                                                   <
                                                    <<p_messages, '6', '0x0303', '40', $p_g>, '1', '0x0303', 
                                                     p_nc, '0', $cipher_suites, '0', <'43', '0x0304'>, 
                                                     <'10', $g1, $g2>, <'13', $sig_algs>, '40', $p_g, p_gx>, 
                                                    '2', '0x0303', ~new_ns, $cipher_suite, 
                                                    <'13', $sig_algs.1>, '40', $p_g, $p_g^~y>, 
                                                   '8', $exts>, 
                                                  '13', '0', $certificate_extensions>, 
                                                 '11', '0', pk(~ltkS)>, 
                                                '15', 
                                                sign(<'server_cv', 
                                                      h(<
                                                         <
                                                          <
                                                           <
                                                            <<p_messages, '6', '0x0303', '40', $p_g>, '1', 
                                                             '0x0303', p_nc, '0', $cipher_suites, '0', 
                                                             <'43', '0x0304'>, <'10', $g1, $g2>, 
                                                             <'13', $sig_algs>, '40', $p_g, p_gx>, 
                                                            '2', '0x0303', ~new_ns, $cipher_suite, 
                                                            <'13', $sig_algs.1>, '40', $p_g, $p_g^~y>, 
                                                           '8', $exts>, 
                                                          '13', '0', $certificate_extensions>, 
                                                         '11', '0', pk(~ltkS)>)
                                                     >,
                                                     ~ltkS)
                                               >)
                                            >)
                                      >)
                                   >,
                                   '32')
                 ) @ #l)
               ∧
                #l < #j.1)) )
        case case_1
        solve( (∃ #r. (RevLtk( $C ) @ #r) ∧ #r < #i)  ∥
               (∃ tid3 x #r. (RevDHExp( tid3, $C, x ) @ #r) ∧ #r < #i)  ∥
               (∃ tid4 y #r. (RevDHExp( tid4, $S, y ) @ #r) ∧ #r < #i)  ∥
               (∃ rms #r. (RevealPSK( $S, rms ) @ #r) ∧ #r < #k.1)  ∥
               (∃ rms #r. (RevealPSK( $C, rms ) @ #r) ∧ #r < #k.1) )
          case case_1
          by contradiction /* from formulas */
        next
          case case_2
          by contradiction /* from formulas */
        next
          case case_3
          by contradiction /* from formulas */
        next
          case case_4
          by contradiction /* from formulas */
        next
          case case_5
          by contradiction /* from formulas */
        qed
      next
        case case_2
        solve( !Pk( $C, pk(~ltkC) ) ▶₁ #i )
          case Register_pk
          by solve( SecretPSK( $A,
                               Expand(Extract('0', Extract(p_gxy, Extract(p_res_psk, '0'))),
                                      <'clientats', 
                                       h(<
                                          <
                                           <
                                            <
                                             <
                                              <
                                               <<p_messages, '6', '0x0303', '40', $p_g>, '1', '0x0303', p_nc, 
                                                '0', $cipher_suites, '0', <'43', '0x0304'>, <'10', $g1, $g2>, 
                                                <'13', $sig_algs>, '40', $p_g, p_gx>, 
                                               '2', '0x0303', ~new_ns, $cipher_suite, <'13', $sig_algs.1>, 
                                               '40', $p_g, $p_g^~y>, 
                                              '8', $exts>, 
                                             '13', '0', $certificate_extensions>, 
                                            '11', '0', pk(~ltkS)>, 
                                           '15', 
                                           sign(<'server_cv', 
                                                 h(<
                                                    <
                                                     <
                                                      <
                                                       <<p_messages, '6', '0x0303', '40', $p_g>, '1', 
                                                        '0x0303', p_nc, '0', $cipher_suites, '0', 
                                                        <'43', '0x0304'>, <'10', $g1, $g2>, 
                                                        <'13', $sig_algs>, '40', $p_g, p_gx>, 
                                                       '2', '0x0303', ~new_ns, $cipher_suite, 
                                                       <'13', $sig_algs.1>, '40', $p_g, $p_g^~y>, 
                                                      '8', $exts>, 
                                                     '13', '0', $certificate_extensions>, 
                                                    '11', '0', pk(~ltkS)>)
                                                >,
                                                ~ltkS)
                                          >, 
                                          '20', 
                                          hmac(<
                                                Expand(Expand(Extract(p_gxy, Extract(p_res_psk, '0')),
                                                              <'serverhts', 
                                                               h(<
                                                                  <
                                                                   <
                                                                    <
                                                                     <
                                                                      <
                                                                       <p_messages, '6', '0x0303', '40', $p_g
                                                                       >, 
                                                                       '1', '0x0303', p_nc, '0', 
                                                                       $cipher_suites, '0', <'43', '0x0304'>, 
                                                                       <'10', $g1, $g2>, <'13', $sig_algs>, 
                                                                       '40', $p_g, p_gx>, 
                                                                      '2', '0x0303', ~new_ns, $cipher_suite, 
                                                                      <'13', $sig_algs.1>, '40', $p_g, $p_g^~y
                                                                     >, 
                                                                     '8', $exts>, 
                                                                    '13', '0', $certificate_extensions>, 
                                                                   '11', '0', pk(~ltkS)>, 
                                                                  '15', 
                                                                  sign(<'server_cv', 
                                                                        h(<
                                                                           <
                                                                            <
                                                                             <
                                                                              <
                                                                               <p_messages, '6', '0x0303', 
                                                                                '40', $p_g>, 
                                                                               '1', '0x0303', p_nc, '0', 
                                                                               $cipher_suites, '0', 
                                                                               <'43', '0x0304'>, 
                                                                               <'10', $g1, $g2>, 
                                                                               <'13', $sig_algs>, '40', $p_g, 
                                                                               p_gx>, 
                                                                              '2', '0x0303', ~new_ns, 
                                                                              $cipher_suite, 
                                                                              <'13', $sig_algs.1>, '40', 
                                                                              $p_g, $p_g^~y>, 
                                                                             '8', $exts>, 
                                                                            '13', '0', $certificate_extensions
                                                                           >, 
                                                                           '11', '0', pk(~ltkS)>)
                                                                       >,
                                                                       ~ltkS)
                                                                 >)
                                                              >,
                                                              '32'),
                                                       <'fin', '0'>, '32'), 
                                                h(<
                                                   <
                                                    <
                                                     <
                                                      <
                                                       <<p_messages, '6', '0x0303', '40', $p_g>, '1', 
                                                        '0x0303', p_nc, '0', $cipher_suites, '0', 
                                                        <'43', '0x0304'>, <'10', $g1, $g2>, 
                                                        <'13', $sig_algs>, '40', $p_g, p_gx>, 
                                                       '2', '0x0303', ~new_ns, $cipher_suite, 
                                                       <'13', $sig_algs.1>, '40', $p_g, $p_g^~y>, 
                                                      '8', $exts>, 
                                                     '13', '0', $certificate_extensions>, 
                                                    '11', '0', pk(~ltkS)>, 
                                                   '15', 
                                                   sign(<'server_cv', 
                                                         h(<
                                                            <
                                                             <
                                                              <
                                                               <<p_messages, '6', '0x0303', '40', $p_g>, '1', 
                                                                '0x0303', p_nc, '0', $cipher_suites, '0', 
                                                                <'43', '0x0304'>, <'10', $g1, $g2>, 
                                                                <'13', $sig_algs>, '40', $p_g, p_gx>, 
                                                               '2', '0x0303', ~new_ns, $cipher_suite, 
                                                               <'13', $sig_algs.1>, '40', $p_g, $p_g^~y>, 
                                                              '8', $exts>, 
                                                             '13', '0', $certificate_extensions>, 
                                                            '11', '0', pk(~ltkS)>)
                                                        >,
                                                        ~ltkS)
                                                  >)
                                               >)
                                         >)
                                      >,
                                      '32')
                    ) ▶₀ #l )
        qed
      qed
    next
      case server_auth_case_03
      solve( (∃ #j.2.
               (!KU( Extract('0', Extract(p_gxy, Extract(~res_psk, '0'))) ) @ #j.2)
              ∧
               #j.2 < #j.1)  ∥
             ((∀ #k.
                (!KU( Extract('0', Extract(p_gxy, Extract(~res_psk, '0'))) ) @ #k)
               ⇒
                ¬(#k < #j.1)) ∧
              (∃ actor #l.
                (RevealPSK( actor,
                            Expand(Extract('0', Extract(p_gxy, Extract(~res_psk, '0'))),
                                   <'clientats', 
                                    h(<
                                       <
                                        <
                                         <
                                          <
                                           <
                                            <'0', '1', '0x0303', p_nc, '0', $cipher_suites, '0', 
                                             <'43', '0x0304'>, <'10', $g1, $g2>, <'40', $p_g, p_gx>, 
                                             <'45', '0', '1'>, p_edi, '41', <~ticket, mask(x, x.1)>, 
                                             hmac(<
                                                   Expand(Expand(Extract(~res_psk, '0'), <'ext', 'pbk'>,
                                                                 '32'),
                                                          <'0', '0'>, '32'), 
                                                   h(<'0', '1', '0x0303', p_nc, '0', $cipher_suites, '0', 
                                                      <'43', '0x0304'>, <'10', $g1, $g2>, <'40', $p_g, p_gx>, 
                                                      <'45', '0', '1'>, p_edi, '41', <~ticket, mask(x, x.1)>, 
                                                      '0'>)
                                                  >)
                                            >, 
                                            '2', '0x0303', ~ns, $cipher_suite, <'13', $sig_algs>, '40', $p_g, 
                                            $p_g^~y>, 
                                           '8', $exts>, 
                                          '13', '0', $certificate_extensions>, 
                                         '11', '0', pk(~ltkS)>, 
                                        '15', 
                                        sign(<'server_cv', 
                                              h(<
                                                 <
                                                  <
                                                   <
                                                    <'0', '1', '0x0303', p_nc, '0', $cipher_suites, '0', 
                                                     <'43', '0x0304'>, <'10', $g1, $g2>, <'40', $p_g, p_gx>, 
                                                     <'45', '0', '1'>, p_edi, '41', <~ticket, mask(x, x.1)>, 
                                                     hmac(<
                                                           Expand(Expand(Extract(~res_psk, '0'),
                                                                         <'ext', 'pbk'>, '32'),
                                                                  <'0', '0'>, '32'), 
                                                           h(<'0', '1', '0x0303', p_nc, '0', $cipher_suites, 
                                                              '0', <'43', '0x0304'>, <'10', $g1, $g2>, 
                                                              <'40', $p_g, p_gx>, <'45', '0', '1'>, p_edi, 
                                                              '41', <~ticket, mask(x, x.1)>, '0'>)
                                                          >)
                                                    >, 
                                                    '2', '0x0303', ~ns, $cipher_suite, <'13', $sig_algs>, 
                                                    '40', $p_g, $p_g^~y>, 
                                                   '8', $exts>, 
                                                  '13', '0', $certificate_extensions>, 
                                                 '11', '0', pk(~ltkS)>)
                                             >,
                                             ~ltkS)
                                       >, 
                                       '20', 
                                       hmac(<
                                             Expand(Expand(Extract(p_gxy, Extract(~res_psk, '0')),
                                                           <'serverhts', 
                                                            h(<
                                                               <
                                                                <
                                                                 <
                                                                  <
                                                                   <'0', '1', '0x0303', p_nc, '0', 
                                                                    $cipher_suites, '0', <'43', '0x0304'>, 
                                                                    <'10', $g1, $g2>, <'40', $p_g, p_gx>, 
                                                                    <'45', '0', '1'>, p_edi, '41', 
                                                                    <~ticket, mask(x, x.1)>, 
                                                                    hmac(<
                                                                          Expand(Expand(Extract(~res_psk,
                                                                                                '0'),
                                                                                        <'ext', 'pbk'>, '32'),
                                                                                 <'0', '0'>, '32'), 
                                                                          h(<'0', '1', '0x0303', p_nc, '0', 
                                                                             $cipher_suites, '0', 
                                                                             <'43', '0x0304'>, 
                                                                             <'10', $g1, $g2>, 
                                                                             <'40', $p_g, p_gx>, 
                                                                             <'45', '0', '1'>, p_edi, '41', 
                                                                             <~ticket, mask(x, x.1)>, '0'>)
                                                                         >)
                                                                   >, 
                                                                   '2', '0x0303', ~ns, $cipher_suite, 
                                                                   <'13', $sig_algs>, '40', $p_g, $p_g^~y>, 
                                                                  '8', $exts>, 
                                                                 '13', '0', $certificate_extensions>, 
                                                                '11', '0', pk(~ltkS)>, 
                                                               '15', 
                                                               sign(<'server_cv', 
                                                                     h(<
                                                                        <
                                                                         <
                                                                          <
                                                                           <'0', '1', '0x0303', p_nc, '0', 
                                                                            $cipher_suites, '0', 
                                                                            <'43', '0x0304'>, 
                                                                            <'10', $g1, $g2>, 
                                                                            <'40', $p_g, p_gx>, 
                                                                            <'45', '0', '1'>, p_edi, '41', 
                                                                            <~ticket, mask(x, x.1)>, 
                                                                            hmac(<
                                                                                  Expand(Expand(Extract(~res_psk,
                                                                                                        '0'),
                                                                                                <'ext', 'pbk'
                                                                                                >,
                                                                                                '32'),
                                                                                         <'0', '0'>, '32'), 
                                                                                  h(<'0', '1', '0x0303', 
                                                                                     p_nc, '0', 
                                                                                     $cipher_suites, '0', 
                                                                                     <'43', '0x0304'>, 
                                                                                     <'10', $g1, $g2>, 
                                                                                     <'40', $p_g, p_gx>, 
                                                                                     <'45', '0', '1'>, p_edi, 
                                                                                     '41', 
                                                                                     <~ticket, mask(x, x.1)>, 
                                                                                     '0'>)
                                                                                 >)
                                                                           >, 
                                                                           '2', '0x0303', ~ns, $cipher_suite, 
                                                                           <'13', $sig_algs>, '40', $p_g, 
                                                                           $p_g^~y>, 
                                                                          '8', $exts>, 
                                                                         '13', '0', $certificate_extensions>, 
                                                                        '11', '0', pk(~ltkS)>)
                                                                    >,
                                                                    ~ltkS)
                                                              >)
                                                           >,
                                                           '32'),
                                                    <'fin', '0'>, '32'), 
                                             h(<
                                                <
                                                 <
                                                  <
                                                   <
                                                    <'0', '1', '0x0303', p_nc, '0', $cipher_suites, '0', 
                                                     <'43', '0x0304'>, <'10', $g1, $g2>, <'40', $p_g, p_gx>, 
                                                     <'45', '0', '1'>, p_edi, '41', <~ticket, mask(x, x.1)>, 
                                                     hmac(<
                                                           Expand(Expand(Extract(~res_psk, '0'),
                                                                         <'ext', 'pbk'>, '32'),
                                                                  <'0', '0'>, '32'), 
                                                           h(<'0', '1', '0x0303', p_nc, '0', $cipher_suites, 
                                                              '0', <'43', '0x0304'>, <'10', $g1, $g2>, 
                                                              <'40', $p_g, p_gx>, <'45', '0', '1'>, p_edi, 
                                                              '41', <~ticket, mask(x, x.1)>, '0'>)
                                                          >)
                                                    >, 
                                                    '2', '0x0303', ~ns, $cipher_suite, <'13', $sig_algs>, 
                                                    '40', $p_g, $p_g^~y>, 
                                                   '8', $exts>, 
                                                  '13', '0', $certificate_extensions>, 
                                                 '11', '0', pk(~ltkS)>, 
                                                '15', 
                                                sign(<'server_cv', 
                                                      h(<
                                                         <
                                                          <
                                                           <
                                                            <'0', '1', '0x0303', p_nc, '0', $cipher_suites, 
                                                             '0', <'43', '0x0304'>, <'10', $g1, $g2>, 
                                                             <'40', $p_g, p_gx>, <'45', '0', '1'>, p_edi, 
                                                             '41', <~ticket, mask(x, x.1)>, 
                                                             hmac(<
                                                                   Expand(Expand(Extract(~res_psk, '0'),
                                                                                 <'ext', 'pbk'>, '32'),
                                                                          <'0', '0'>, '32'), 
                                                                   h(<'0', '1', '0x0303', p_nc, '0', 
                                                                      $cipher_suites, '0', <'43', '0x0304'>, 
                                                                      <'10', $g1, $g2>, <'40', $p_g, p_gx>, 
                                                                      <'45', '0', '1'>, p_edi, '41', 
                                                                      <~ticket, mask(x, x.1)>, '0'>)
                                                                  >)
                                                            >, 
                                                            '2', '0x0303', ~ns, $cipher_suite, 
                                                            <'13', $sig_algs>, '40', $p_g, $p_g^~y>, 
                                                           '8', $exts>, 
                                                          '13', '0', $certificate_extensions>, 
                                                         '11', '0', pk(~ltkS)>)
                                                     >,
                                                     ~ltkS)
                                               >)
                                            >)
                                      >)
                                   >,
                                   '32')
                 ) @ #l)
               ∧
                #l < #j.1)) )
        case case_1
        solve( (∃ #r. (RevLtk( $C ) @ #r) ∧ #r < #i)  ∥
               (∃ tid3 x #r. (RevDHExp( tid3, $C, x ) @ #r) ∧ #r < #i)  ∥
               (∃ tid4 y #r. (RevDHExp( tid4, $S, y ) @ #r) ∧ #r < #i)  ∥
               (∃ rms #r. (RevealPSK( $S, rms ) @ #r) ∧ #r < #k.1)  ∥
               (∃ rms #r. (RevealPSK( $C, rms ) @ #r) ∧ #r < #k.1) )
          case case_1
          by contradiction /* from formulas */
        next
          case case_2
          by contradiction /* from formulas */
        next
          case case_3
          by contradiction /* from formulas */
        next
          case case_4
          by contradiction /* from formulas */
        next
          case case_5
          by contradiction /* from formulas */
        qed
      next
        case case_2
        solve( !Pk( $C, pk(~ltkC) ) ▶₁ #i )
          case Register_pk
          by solve( SecretPSK( $A,
                               Expand(Extract('0', Extract(p_gxy, Extract(~res_psk, '0'))),
                                      <'clientats', 
                                       h(<
                                          <
                                           <
                                            <
                                             <
                                              <
                                               <'0', '1', '0x0303', p_nc, '0', $cipher_suites, '0', 
                                                <'43', '0x0304'>, <'10', $g1, $g2>, <'40', $p_g, p_gx>, 
                                                <'45', '0', '1'>, p_edi, '41', <~ticket, mask(x, x.1)>, 
                                                hmac(<
                                                      Expand(Expand(Extract(~res_psk, '0'), <'ext', 'pbk'>,
                                                                    '32'),
                                                             <'0', '0'>, '32'), 
                                                      h(<'0', '1', '0x0303', p_nc, '0', $cipher_suites, '0', 
                                                         <'43', '0x0304'>, <'10', $g1, $g2>, 
                                                         <'40', $p_g, p_gx>, <'45', '0', '1'>, p_edi, '41', 
                                                         <~ticket, mask(x, x.1)>, '0'>)
                                                     >)
                                               >, 
                                               '2', '0x0303', ~ns, $cipher_suite, <'13', $sig_algs>, '40', 
                                               $p_g, $p_g^~y>, 
                                              '8', $exts>, 
                                             '13', '0', $certificate_extensions>, 
                                            '11', '0', pk(~ltkS)>, 
                                           '15', 
                                           sign(<'server_cv', 
                                                 h(<
                                                    <
                                                     <
                                                      <
                                                       <'0', '1', '0x0303', p_nc, '0', $cipher_suites, '0', 
                                                        <'43', '0x0304'>, <'10', $g1, $g2>, 
                                                        <'40', $p_g, p_gx>, <'45', '0', '1'>, p_edi, '41', 
                                                        <~ticket, mask(x, x.1)>, 
                                                        hmac(<
                                                              Expand(Expand(Extract(~res_psk, '0'),
                                                                            <'ext', 'pbk'>, '32'),
                                                                     <'0', '0'>, '32'), 
                                                              h(<'0', '1', '0x0303', p_nc, '0', 
                                                                 $cipher_suites, '0', <'43', '0x0304'>, 
                                                                 <'10', $g1, $g2>, <'40', $p_g, p_gx>, 
                                                                 <'45', '0', '1'>, p_edi, '41', 
                                                                 <~ticket, mask(x, x.1)>, '0'>)
                                                             >)
                                                       >, 
                                                       '2', '0x0303', ~ns, $cipher_suite, <'13', $sig_algs>, 
                                                       '40', $p_g, $p_g^~y>, 
                                                      '8', $exts>, 
                                                     '13', '0', $certificate_extensions>, 
                                                    '11', '0', pk(~ltkS)>)
                                                >,
                                                ~ltkS)
                                          >, 
                                          '20', 
                                          hmac(<
                                                Expand(Expand(Extract(p_gxy, Extract(~res_psk, '0')),
                                                              <'serverhts', 
                                                               h(<
                                                                  <
                                                                   <
                                                                    <
                                                                     <
                                                                      <'0', '1', '0x0303', p_nc, '0', 
                                                                       $cipher_suites, '0', <'43', '0x0304'>, 
                                                                       <'10', $g1, $g2>, <'40', $p_g, p_gx>, 
                                                                       <'45', '0', '1'>, p_edi, '41', 
                                                                       <~ticket, mask(x, x.1)>, 
                                                                       hmac(<
                                                                             Expand(Expand(Extract(~res_psk,
                                                                                                   '0'),
                                                                                           <'ext', 'pbk'>,
                                                                                           '32'),
                                                                                    <'0', '0'>, '32'), 
                                                                             h(<'0', '1', '0x0303', p_nc, 
                                                                                '0', $cipher_suites, '0', 
                                                                                <'43', '0x0304'>, 
                                                                                <'10', $g1, $g2>, 
                                                                                <'40', $p_g, p_gx>, 
                                                                                <'45', '0', '1'>, p_edi, 
                                                                                '41', 
                                                                                <~ticket, mask(x, x.1)>, '0'>)
                                                                            >)
                                                                      >, 
                                                                      '2', '0x0303', ~ns, $cipher_suite, 
                                                                      <'13', $sig_algs>, '40', $p_g, $p_g^~y
                                                                     >, 
                                                                     '8', $exts>, 
                                                                    '13', '0', $certificate_extensions>, 
                                                                   '11', '0', pk(~ltkS)>, 
                                                                  '15', 
                                                                  sign(<'server_cv', 
                                                                        h(<
                                                                           <
                                                                            <
                                                                             <
                                                                              <'0', '1', '0x0303', p_nc, '0', 
                                                                               $cipher_suites, '0', 
                                                                               <'43', '0x0304'>, 
                                                                               <'10', $g1, $g2>, 
                                                                               <'40', $p_g, p_gx>, 
                                                                               <'45', '0', '1'>, p_edi, '41', 
                                                                               <~ticket, mask(x, x.1)>, 
                                                                               hmac(<
                                                                                     Expand(Expand(Extract(~res_psk,
                                                                                                           '0'),
                                                                                                   <'ext', 
                                                                                                    'pbk'>,
                                                                                                   '32'),
                                                                                            <'0', '0'>,
                                                                                            '32'), 
                                                                                     h(<'0', '1', '0x0303', 
                                                                                        p_nc, '0', 
                                                                                        $cipher_suites, '0', 
                                                                                        <'43', '0x0304'>, 
                                                                                        <'10', $g1, $g2>, 
                                                                                        <'40', $p_g, p_gx>, 
                                                                                        <'45', '0', '1'>, 
                                                                                        p_edi, '41', 
                                                                                        <~ticket, mask(x, x.1)
                                                                                        >, 
                                                                                        '0'>)
                                                                                    >)
                                                                              >, 
                                                                              '2', '0x0303', ~ns, 
                                                                              $cipher_suite, 
                                                                              <'13', $sig_algs>, '40', $p_g, 
                                                                              $p_g^~y>, 
                                                                             '8', $exts>, 
                                                                            '13', '0', $certificate_extensions
                                                                           >, 
                                                                           '11', '0', pk(~ltkS)>)
                                                                       >,
                                                                       ~ltkS)
                                                                 >)
                                                              >,
                                                              '32'),
                                                       <'fin', '0'>, '32'), 
                                                h(<
                                                   <
                                                    <
                                                     <
                                                      <
                                                       <'0', '1', '0x0303', p_nc, '0', $cipher_suites, '0', 
                                                        <'43', '0x0304'>, <'10', $g1, $g2>, 
                                                        <'40', $p_g, p_gx>, <'45', '0', '1'>, p_edi, '41', 
                                                        <~ticket, mask(x, x.1)>, 
                                                        hmac(<
                                                              Expand(Expand(Extract(~res_psk, '0'),
                                                                            <'ext', 'pbk'>, '32'),
                                                                     <'0', '0'>, '32'), 
                                                              h(<'0', '1', '0x0303', p_nc, '0', 
                                                                 $cipher_suites, '0', <'43', '0x0304'>, 
                                                                 <'10', $g1, $g2>, <'40', $p_g, p_gx>, 
                                                                 <'45', '0', '1'>, p_edi, '41', 
                                                                 <~ticket, mask(x, x.1)>, '0'>)
                                                             >)
                                                       >, 
                                                       '2', '0x0303', ~ns, $cipher_suite, <'13', $sig_algs>, 
                                                       '40', $p_g, $p_g^~y>, 
                                                      '8', $exts>, 
                                                     '13', '0', $certificate_extensions>, 
                                                    '11', '0', pk(~ltkS)>, 
                                                   '15', 
                                                   sign(<'server_cv', 
                                                         h(<
                                                            <
                                                             <
                                                              <
                                                               <'0', '1', '0x0303', p_nc, '0', 
                                                                $cipher_suites, '0', <'43', '0x0304'>, 
                                                                <'10', $g1, $g2>, <'40', $p_g, p_gx>, 
                                                                <'45', '0', '1'>, p_edi, '41', 
                                                                <~ticket, mask(x, x.1)>, 
                                                                hmac(<
                                                                      Expand(Expand(Extract(~res_psk, '0'),
                                                                                    <'ext', 'pbk'>, '32'),
                                                                             <'0', '0'>, '32'), 
                                                                      h(<'0', '1', '0x0303', p_nc, '0', 
                                                                         $cipher_suites, '0', 
                                                                         <'43', '0x0304'>, <'10', $g1, $g2>, 
                                                                         <'40', $p_g, p_gx>, 
                                                                         <'45', '0', '1'>, p_edi, '41', 
                                                                         <~ticket, mask(x, x.1)>, '0'>)
                                                                     >)
                                                               >, 
                                                               '2', '0x0303', ~ns, $cipher_suite, 
                                                               <'13', $sig_algs>, '40', $p_g, $p_g^~y>, 
                                                              '8', $exts>, 
                                                             '13', '0', $certificate_extensions>, 
                                                            '11', '0', pk(~ltkS)>)
                                                        >,
                                                        ~ltkS)
                                                  >)
                                               >)
                                         >)
                                      >,
                                      '32')
                    ) ▶₀ #l )
        qed
      qed
    next
      case server_auth_case_04
      solve( (∃ #j.2.
               (!KU( Extract('0',
                             Extract(p_gxy, Extract(Expand(ms, <'rms', h(messages)>, '32'), '0')))
                ) @ #j.2)
              ∧
               #j.2 < #j.1)  ∥
             ((∀ #k.
                (!KU( Extract('0',
                              Extract(p_gxy, Extract(Expand(ms, <'rms', h(messages)>, '32'), '0')))
                 ) @ #k)
               ⇒
                ¬(#k < #j.1)) ∧
              (∃ actor #l.
                (RevealPSK( actor,
                            Expand(Extract('0',
                                           Extract(p_gxy,
                                                   Extract(Expand(ms, <'rms', h(messages)>, '32'), '0'))),
                                   <'clientats', 
                                    h(<
                                       <
                                        <
                                         <
                                          <
                                           <
                                            <'0', '1', '0x0303', p_nc, '0', $cipher_suites, '0', 
                                             <'43', '0x0304'>, <'10', $g1, $g2>, <'40', $p_g, p_gx>, 
                                             <'45', '0', '1'>, p_edi, '41', <~ticket, mask(x, x.1)>, 
                                             hmac(<
                                                   Expand(Expand(Extract(Expand(ms, <'rms', h(messages)>,
                                                                                '32'),
                                                                         '0'),
                                                                 <'res', 'pbk'>, '32'),
                                                          <'0', '0'>, '32'), 
                                                   h(<'0', '1', '0x0303', p_nc, '0', $cipher_suites, '0', 
                                                      <'43', '0x0304'>, <'10', $g1, $g2>, <'40', $p_g, p_gx>, 
                                                      <'45', '0', '1'>, p_edi, '41', <~ticket, mask(x, x.1)>, 
                                                      '0'>)
                                                  >)
                                            >, 
                                            '2', '0x0303', ~ns, $cipher_suite, <'13', $sig_algs>, '40', $p_g, 
                                            $p_g^~y>, 
                                           '8', $exts>, 
                                          '13', '0', $certificate_extensions>, 
                                         '11', '0', pk(~ltkS)>, 
                                        '15', 
                                        sign(<'server_cv', 
                                              h(<
                                                 <
                                                  <
                                                   <
                                                    <'0', '1', '0x0303', p_nc, '0', $cipher_suites, '0', 
                                                     <'43', '0x0304'>, <'10', $g1, $g2>, <'40', $p_g, p_gx>, 
                                                     <'45', '0', '1'>, p_edi, '41', <~ticket, mask(x, x.1)>, 
                                                     hmac(<
                                                           Expand(Expand(Extract(Expand(ms,
                                                                                        <'rms', h(messages)>,
                                                                                        '32'),
                                                                                 '0'),
                                                                         <'res', 'pbk'>, '32'),
                                                                  <'0', '0'>, '32'), 
                                                           h(<'0', '1', '0x0303', p_nc, '0', $cipher_suites, 
                                                              '0', <'43', '0x0304'>, <'10', $g1, $g2>, 
                                                              <'40', $p_g, p_gx>, <'45', '0', '1'>, p_edi, 
                                                              '41', <~ticket, mask(x, x.1)>, '0'>)
                                                          >)
                                                    >, 
                                                    '2', '0x0303', ~ns, $cipher_suite, <'13', $sig_algs>, 
                                                    '40', $p_g, $p_g^~y>, 
                                                   '8', $exts>, 
                                                  '13', '0', $certificate_extensions>, 
                                                 '11', '0', pk(~ltkS)>)
                                             >,
                                             ~ltkS)
                                       >, 
                                       '20', 
                                       hmac(<
                                             Expand(Expand(Extract(p_gxy,
                                                                   Extract(Expand(ms, <'rms', h(messages)>,
                                                                                  '32'),
                                                                           '0')),
                                                           <'serverhts', 
                                                            h(<
                                                               <
                                                                <
                                                                 <
                                                                  <
                                                                   <'0', '1', '0x0303', p_nc, '0', 
                                                                    $cipher_suites, '0', <'43', '0x0304'>, 
                                                                    <'10', $g1, $g2>, <'40', $p_g, p_gx>, 
                                                                    <'45', '0', '1'>, p_edi, '41', 
                                                                    <~ticket, mask(x, x.1)>, 
                                                                    hmac(<
                                                                          Expand(Expand(Extract(Expand(ms,
                                                                                                       <
                                                                                                        'rms', 
                                                                                                        h(messages)
                                                                                                       >,
                                                                                                       '32'),
                                                                                                '0'),
                                                                                        <'res', 'pbk'>, '32'),
                                                                                 <'0', '0'>, '32'), 
                                                                          h(<'0', '1', '0x0303', p_nc, '0', 
                                                                             $cipher_suites, '0', 
                                                                             <'43', '0x0304'>, 
                                                                             <'10', $g1, $g2>, 
                                                                             <'40', $p_g, p_gx>, 
                                                                             <'45', '0', '1'>, p_edi, '41', 
                                                                             <~ticket, mask(x, x.1)>, '0'>)
                                                                         >)
                                                                   >, 
                                                                   '2', '0x0303', ~ns, $cipher_suite, 
                                                                   <'13', $sig_algs>, '40', $p_g, $p_g^~y>, 
                                                                  '8', $exts>, 
                                                                 '13', '0', $certificate_extensions>, 
                                                                '11', '0', pk(~ltkS)>, 
                                                               '15', 
                                                               sign(<'server_cv', 
                                                                     h(<
                                                                        <
                                                                         <
                                                                          <
                                                                           <'0', '1', '0x0303', p_nc, '0', 
                                                                            $cipher_suites, '0', 
                                                                            <'43', '0x0304'>, 
                                                                            <'10', $g1, $g2>, 
                                                                            <'40', $p_g, p_gx>, 
                                                                            <'45', '0', '1'>, p_edi, '41', 
                                                                            <~ticket, mask(x, x.1)>, 
                                                                            hmac(<
                                                                                  Expand(Expand(Extract(Expand(ms,
                                                                                                               <
                                                                                                                'rms', 
                                                                                                                h(messages)
                                                                                                               >,
                                                                                                               '32'),
                                                                                                        '0'),
                                                                                                <'res', 'pbk'
                                                                                                >,
                                                                                                '32'),
                                                                                         <'0', '0'>, '32'), 
                                                                                  h(<'0', '1', '0x0303', 
                                                                                     p_nc, '0', 
                                                                                     $cipher_suites, '0', 
                                                                                     <'43', '0x0304'>, 
                                                                                     <'10', $g1, $g2>, 
                                                                                     <'40', $p_g, p_gx>, 
                                                                                     <'45', '0', '1'>, p_edi, 
                                                                                     '41', 
                                                                                     <~ticket, mask(x, x.1)>, 
                                                                                     '0'>)
                                                                                 >)
                                                                           >, 
                                                                           '2', '0x0303', ~ns, $cipher_suite, 
                                                                           <'13', $sig_algs>, '40', $p_g, 
                                                                           $p_g^~y>, 
                                                                          '8', $exts>, 
                                                                         '13', '0', $certificate_extensions>, 
                                                                        '11', '0', pk(~ltkS)>)
                                                                    >,
                                                                    ~ltkS)
                                                              >)
                                                           >,
                                                           '32'),
                                                    <'fin', '0'>, '32'), 
                                             h(<
                                                <
                                                 <
                                                  <
                                                   <
                                                    <'0', '1', '0x0303', p_nc, '0', $cipher_suites, '0', 
                                                     <'43', '0x0304'>, <'10', $g1, $g2>, <'40', $p_g, p_gx>, 
                                                     <'45', '0', '1'>, p_edi, '41', <~ticket, mask(x, x.1)>, 
                                                     hmac(<
                                                           Expand(Expand(Extract(Expand(ms,
                                                                                        <'rms', h(messages)>,
                                                                                        '32'),
                                                                                 '0'),
                                                                         <'res', 'pbk'>, '32'),
                                                                  <'0', '0'>, '32'), 
                                                           h(<'0', '1', '0x0303', p_nc, '0', $cipher_suites, 
                                                              '0', <'43', '0x0304'>, <'10', $g1, $g2>, 
                                                              <'40', $p_g, p_gx>, <'45', '0', '1'>, p_edi, 
                                                              '41', <~ticket, mask(x, x.1)>, '0'>)
                                                          >)
                                                    >, 
                                                    '2', '0x0303', ~ns, $cipher_suite, <'13', $sig_algs>, 
                                                    '40', $p_g, $p_g^~y>, 
                                                   '8', $exts>, 
                                                  '13', '0', $certificate_extensions>, 
                                                 '11', '0', pk(~ltkS)>, 
                                                '15', 
                                                sign(<'server_cv', 
                                                      h(<
                                                         <
                                                          <
                                                           <
                                                            <'0', '1', '0x0303', p_nc, '0', $cipher_suites, 
                                                             '0', <'43', '0x0304'>, <'10', $g1, $g2>, 
                                                             <'40', $p_g, p_gx>, <'45', '0', '1'>, p_edi, 
                                                             '41', <~ticket, mask(x, x.1)>, 
                                                             hmac(<
                                                                   Expand(Expand(Extract(Expand(ms,
                                                                                                <'rms', 
                                                                                                 h(messages)>,
                                                                                                '32'),
                                                                                         '0'),
                                                                                 <'res', 'pbk'>, '32'),
                                                                          <'0', '0'>, '32'), 
                                                                   h(<'0', '1', '0x0303', p_nc, '0', 
                                                                      $cipher_suites, '0', <'43', '0x0304'>, 
                                                                      <'10', $g1, $g2>, <'40', $p_g, p_gx>, 
                                                                      <'45', '0', '1'>, p_edi, '41', 
                                                                      <~ticket, mask(x, x.1)>, '0'>)
                                                                  >)
                                                            >, 
                                                            '2', '0x0303', ~ns, $cipher_suite, 
                                                            <'13', $sig_algs>, '40', $p_g, $p_g^~y>, 
                                                           '8', $exts>, 
                                                          '13', '0', $certificate_extensions>, 
                                                         '11', '0', pk(~ltkS)>)
                                                     >,
                                                     ~ltkS)
                                               >)
                                            >)
                                      >)
                                   >,
                                   '32')
                 ) @ #l)
               ∧
                #l < #j.1)) )
        case case_1
        solve( (∃ #r. (RevLtk( $C ) @ #r) ∧ #r < #i)  ∥
               (∃ tid3 x #r. (RevDHExp( tid3, $C, x ) @ #r) ∧ #r < #i)  ∥
               (∃ tid4 y #r. (RevDHExp( tid4, $S, y ) @ #r) ∧ #r < #i)  ∥
               (∃ rms #r. (RevealPSK( $S, rms ) @ #r) ∧ #r < #k.1)  ∥
               (∃ rms #r. (RevealPSK( $C, rms ) @ #r) ∧ #r < #k.1) )
          case case_1
          by contradiction /* from formulas */
        next
          case case_2
          by contradiction /* from formulas */
        next
          case case_3
          by contradiction /* from formulas */
        next
          case case_4
          by contradiction /* from formulas */
        next
          case case_5
          by contradiction /* from formulas */
        qed
      next
        case case_2
        solve( !Pk( $C, pk(~ltkC) ) ▶₁ #i )
          case Register_pk
          by solve( SecretPSK( $A,
                               Expand(Extract('0',
                                              Extract(p_gxy,
                                                      Extract(Expand(ms, <'rms', h(messages)>, '32'), '0'))),
                                      <'clientats', 
                                       h(<
                                          <
                                           <
                                            <
                                             <
                                              <
                                               <'0', '1', '0x0303', p_nc, '0', $cipher_suites, '0', 
                                                <'43', '0x0304'>, <'10', $g1, $g2>, <'40', $p_g, p_gx>, 
                                                <'45', '0', '1'>, p_edi, '41', <~ticket, mask(x, x.1)>, 
                                                hmac(<
                                                      Expand(Expand(Extract(Expand(ms, <'rms', h(messages)>,
                                                                                   '32'),
                                                                            '0'),
                                                                    <'res', 'pbk'>, '32'),
                                                             <'0', '0'>, '32'), 
                                                      h(<'0', '1', '0x0303', p_nc, '0', $cipher_suites, '0', 
                                                         <'43', '0x0304'>, <'10', $g1, $g2>, 
                                                         <'40', $p_g, p_gx>, <'45', '0', '1'>, p_edi, '41', 
                                                         <~ticket, mask(x, x.1)>, '0'>)
                                                     >)
                                               >, 
                                               '2', '0x0303', ~ns, $cipher_suite, <'13', $sig_algs>, '40', 
                                               $p_g, $p_g^~y>, 
                                              '8', $exts>, 
                                             '13', '0', $certificate_extensions>, 
                                            '11', '0', pk(~ltkS)>, 
                                           '15', 
                                           sign(<'server_cv', 
                                                 h(<
                                                    <
                                                     <
                                                      <
                                                       <'0', '1', '0x0303', p_nc, '0', $cipher_suites, '0', 
                                                        <'43', '0x0304'>, <'10', $g1, $g2>, 
                                                        <'40', $p_g, p_gx>, <'45', '0', '1'>, p_edi, '41', 
                                                        <~ticket, mask(x, x.1)>, 
                                                        hmac(<
                                                              Expand(Expand(Extract(Expand(ms,
                                                                                           <'rms', h(messages)
                                                                                           >,
                                                                                           '32'),
                                                                                    '0'),
                                                                            <'res', 'pbk'>, '32'),
                                                                     <'0', '0'>, '32'), 
                                                              h(<'0', '1', '0x0303', p_nc, '0', 
                                                                 $cipher_suites, '0', <'43', '0x0304'>, 
                                                                 <'10', $g1, $g2>, <'40', $p_g, p_gx>, 
                                                                 <'45', '0', '1'>, p_edi, '41', 
                                                                 <~ticket, mask(x, x.1)>, '0'>)
                                                             >)
                                                       >, 
                                                       '2', '0x0303', ~ns, $cipher_suite, <'13', $sig_algs>, 
                                                       '40', $p_g, $p_g^~y>, 
                                                      '8', $exts>, 
                                                     '13', '0', $certificate_extensions>, 
                                                    '11', '0', pk(~ltkS)>)
                                                >,
                                                ~ltkS)
                                          >, 
                                          '20', 
                                          hmac(<
                                                Expand(Expand(Extract(p_gxy,
                                                                      Extract(Expand(ms, <'rms', h(messages)>,
                                                                                     '32'),
                                                                              '0')),
                                                              <'serverhts', 
                                                               h(<
                                                                  <
                                                                   <
                                                                    <
                                                                     <
                                                                      <'0', '1', '0x0303', p_nc, '0', 
                                                                       $cipher_suites, '0', <'43', '0x0304'>, 
                                                                       <'10', $g1, $g2>, <'40', $p_g, p_gx>, 
                                                                       <'45', '0', '1'>, p_edi, '41', 
                                                                       <~ticket, mask(x, x.1)>, 
                                                                       hmac(<
                                                                             Expand(Expand(Extract(Expand(ms,
                                                                                                          <
                                                                                                           'rms', 
                                                                                                           h(messages)
                                                                                                          >,
                                                                                                          '32'),
                                                                                                   '0'),
                                                                                           <'res', 'pbk'>,
                                                                                           '32'),
                                                                                    <'0', '0'>, '32'), 
                                                                             h(<'0', '1', '0x0303', p_nc, 
                                                                                '0', $cipher_suites, '0', 
                                                                                <'43', '0x0304'>, 
                                                                                <'10', $g1, $g2>, 
                                                                                <'40', $p_g, p_gx>, 
                                                                                <'45', '0', '1'>, p_edi, 
                                                                                '41', 
                                                                                <~ticket, mask(x, x.1)>, '0'>)
                                                                            >)
                                                                      >, 
                                                                      '2', '0x0303', ~ns, $cipher_suite, 
                                                                      <'13', $sig_algs>, '40', $p_g, $p_g^~y
                                                                     >, 
                                                                     '8', $exts>, 
                                                                    '13', '0', $certificate_extensions>, 
                                                                   '11', '0', pk(~ltkS)>, 
                                                                  '15', 
                                                                  sign(<'server_cv', 
                                                                        h(<
                                                                           <
                                                                            <
                                                                             <
                                                                              <'0', '1', '0x0303', p_nc, '0', 
                                                                               $cipher_suites, '0', 
                                                                               <'43', '0x0304'>, 
                                                                               <'10', $g1, $g2>, 
                                                                               <'40', $p_g, p_gx>, 
                                                                               <'45', '0', '1'>, p_edi, '41', 
                                                                               <~ticket, mask(x, x.1)>, 
                                                                               hmac(<
                                                                                     Expand(Expand(Extract(Expand(ms,
                                                                                                                  <
                                                                                                                   'rms', 
                                                                                                                   h(messages)
                                                                                                                  >,
                                                                                                                  '32'),
                                                                                                           '0'),
                                                                                                   <'res', 
                                                                                                    'pbk'>,
                                                                                                   '32'),
                                                                                            <'0', '0'>,
                                                                                            '32'), 
                                                                                     h(<'0', '1', '0x0303', 
                                                                                        p_nc, '0', 
                                                                                        $cipher_suites, '0', 
                                                                                        <'43', '0x0304'>, 
                                                                                        <'10', $g1, $g2>, 
                                                                                        <'40', $p_g, p_gx>, 
                                                                                        <'45', '0', '1'>, 
                                                                                        p_edi, '41', 
                                                                                        <~ticket, mask(x, x.1)
                                                                                        >, 
                                                                                        '0'>)
                                                                                    >)
                                                                              >, 
                                                                              '2', '0x0303', ~ns, 
                                                                              $cipher_suite, 
                                                                              <'13', $sig_algs>, '40', $p_g, 
                                                                              $p_g^~y>, 
                                                                             '8', $exts>, 
                                                                            '13', '0', $certificate_extensions
                                                                           >, 
                                                                           '11', '0', pk(~ltkS)>)
                                                                       >,
                                                                       ~ltkS)
                                                                 >)
                                                              >,
                                                              '32'),
                                                       <'fin', '0'>, '32'), 
                                                h(<
                                                   <
                                                    <
                                                     <
                                                      <
                                                       <'0', '1', '0x0303', p_nc, '0', $cipher_suites, '0', 
                                                        <'43', '0x0304'>, <'10', $g1, $g2>, 
                                                        <'40', $p_g, p_gx>, <'45', '0', '1'>, p_edi, '41', 
                                                        <~ticket, mask(x, x.1)>, 
                                                        hmac(<
                                                              Expand(Expand(Extract(Expand(ms,
                                                                                           <'rms', h(messages)
                                                                                           >,
                                                                                           '32'),
                                                                                    '0'),
                                                                            <'res', 'pbk'>, '32'),
                                                                     <'0', '0'>, '32'), 
                                                              h(<'0', '1', '0x0303', p_nc, '0', 
                                                                 $cipher_suites, '0', <'43', '0x0304'>, 
                                                                 <'10', $g1, $g2>, <'40', $p_g, p_gx>, 
                                                                 <'45', '0', '1'>, p_edi, '41', 
                                                                 <~ticket, mask(x, x.1)>, '0'>)
                                                             >)
                                                       >, 
                                                       '2', '0x0303', ~ns, $cipher_suite, <'13', $sig_algs>, 
                                                       '40', $p_g, $p_g^~y>, 
                                                      '8', $exts>, 
                                                     '13', '0', $certificate_extensions>, 
                                                    '11', '0', pk(~ltkS)>, 
                                                   '15', 
                                                   sign(<'server_cv', 
                                                         h(<
                                                            <
                                                             <
                                                              <
                                                               <'0', '1', '0x0303', p_nc, '0', 
                                                                $cipher_suites, '0', <'43', '0x0304'>, 
                                                                <'10', $g1, $g2>, <'40', $p_g, p_gx>, 
                                                                <'45', '0', '1'>, p_edi, '41', 
                                                                <~ticket, mask(x, x.1)>, 
                                                                hmac(<
                                                                      Expand(Expand(Extract(Expand(ms,
                                                                                                   <'rms', 
                                                                                                    h(messages)
                                                                                                   >,
                                                                                                   '32'),
                                                                                            '0'),
                                                                                    <'res', 'pbk'>, '32'),
                                                                             <'0', '0'>, '32'), 
                                                                      h(<'0', '1', '0x0303', p_nc, '0', 
                                                                         $cipher_suites, '0', 
                                                                         <'43', '0x0304'>, <'10', $g1, $g2>, 
                                                                         <'40', $p_g, p_gx>, 
                                                                         <'45', '0', '1'>, p_edi, '41', 
                                                                         <~ticket, mask(x, x.1)>, '0'>)
                                                                     >)
                                                               >, 
                                                               '2', '0x0303', ~ns, $cipher_suite, 
                                                               <'13', $sig_algs>, '40', $p_g, $p_g^~y>, 
                                                              '8', $exts>, 
                                                             '13', '0', $certificate_extensions>, 
                                                            '11', '0', pk(~ltkS)>)
                                                        >,
                                                        ~ltkS)
                                                  >)
                                               >)
                                         >)
                                      >,
                                      '32')
                    ) ▶₀ #l )
        qed
      qed
    next
      case server_auth_case_05
      solve( (∃ #j.2.
               (!KU( Extract('0', Extract(p_gxy, Extract(~res_psk, '0'))) ) @ #j.2)
              ∧
               #j.2 < #j.1)  ∥
             ((∀ #k.
                (!KU( Extract('0', Extract(p_gxy, Extract(~res_psk, '0'))) ) @ #k)
               ⇒
                ¬(#k < #j.1)) ∧
              (∃ actor #l.
                (RevealPSK( actor,
                            Expand(Extract('0', Extract(p_gxy, Extract(~res_psk, '0'))),
                                   <'clientats', 
                                    h(<
                                       <
                                        <
                                         <
                                          <
                                           <
                                            <<p_messages, '6', '0x0303', '40', $p_g>, '1', '0x0303', p_nc, 
                                             '0', $cipher_suites, '0', <'43', '0x0304'>, <'10', $g1, $g2>, 
                                             <'40', $p_g, p_gx>, <'45', '0', '1'>, p_edi, '41', 
                                             <~ticket, mask(x, x.1)>, 
                                             hmac(<
                                                   Expand(Expand(Extract(~res_psk, '0'), <'ext', 'pbk'>,
                                                                 '32'),
                                                          <'0', '0'>, '32'), 
                                                   h(<<p_messages, '6', '0x0303', '40', $p_g>, '1', '0x0303', 
                                                      p_nc, '0', $cipher_suites, '0', <'43', '0x0304'>, 
                                                      <'10', $g1, $g2>, <'40', $p_g, p_gx>, <'45', '0', '1'>, 
                                                      p_edi, '41', <~ticket, mask(x, x.1)>, '0'>)
                                                  >)
                                            >, 
                                            '2', '0x0303', ~ns, $cipher_suite, <'13', $sig_algs>, '40', $p_g, 
                                            $p_g^~y>, 
                                           '8', $exts>, 
                                          '13', '0', $certificate_extensions>, 
                                         '11', '0', pk(~ltkS)>, 
                                        '15', 
                                        sign(<'server_cv', 
                                              h(<
                                                 <
                                                  <
                                                   <
                                                    <<p_messages, '6', '0x0303', '40', $p_g>, '1', '0x0303', 
                                                     p_nc, '0', $cipher_suites, '0', <'43', '0x0304'>, 
                                                     <'10', $g1, $g2>, <'40', $p_g, p_gx>, <'45', '0', '1'>, 
                                                     p_edi, '41', <~ticket, mask(x, x.1)>, 
                                                     hmac(<
                                                           Expand(Expand(Extract(~res_psk, '0'),
                                                                         <'ext', 'pbk'>, '32'),
                                                                  <'0', '0'>, '32'), 
                                                           h(<<p_messages, '6', '0x0303', '40', $p_g>, '1', 
                                                              '0x0303', p_nc, '0', $cipher_suites, '0', 
                                                              <'43', '0x0304'>, <'10', $g1, $g2>, 
                                                              <'40', $p_g, p_gx>, <'45', '0', '1'>, p_edi, 
                                                              '41', <~ticket, mask(x, x.1)>, '0'>)
                                                          >)
                                                    >, 
                                                    '2', '0x0303', ~ns, $cipher_suite, <'13', $sig_algs>, 
                                                    '40', $p_g, $p_g^~y>, 
                                                   '8', $exts>, 
                                                  '13', '0', $certificate_extensions>, 
                                                 '11', '0', pk(~ltkS)>)
                                             >,
                                             ~ltkS)
                                       >, 
                                       '20', 
                                       hmac(<
                                             Expand(Expand(Extract(p_gxy, Extract(~res_psk, '0')),
                                                           <'serverhts', 
                                                            h(<
                                                               <
                                                                <
                                                                 <
                                                                  <
                                                                   <<p_messages, '6', '0x0303', '40', $p_g>, 
                                                                    '1', '0x0303', p_nc, '0', $cipher_suites, 
                                                                    '0', <'43', '0x0304'>, <'10', $g1, $g2>, 
                                                                    <'40', $p_g, p_gx>, <'45', '0', '1'>, 
                                                                    p_edi, '41', <~ticket, mask(x, x.1)>, 
                                                                    hmac(<
                                                                          Expand(Expand(Extract(~res_psk,
                                                                                                '0'),
                                                                                        <'ext', 'pbk'>, '32'),
                                                                                 <'0', '0'>, '32'), 
                                                                          h(<
                                                                             <p_messages, '6', '0x0303', 
                                                                              '40', $p_g>, 
                                                                             '1', '0x0303', p_nc, '0', 
                                                                             $cipher_suites, '0', 
                                                                             <'43', '0x0304'>, 
                                                                             <'10', $g1, $g2>, 
                                                                             <'40', $p_g, p_gx>, 
                                                                             <'45', '0', '1'>, p_edi, '41', 
                                                                             <~ticket, mask(x, x.1)>, '0'>)
                                                                         >)
                                                                   >, 
                                                                   '2', '0x0303', ~ns, $cipher_suite, 
                                                                   <'13', $sig_algs>, '40', $p_g, $p_g^~y>, 
                                                                  '8', $exts>, 
                                                                 '13', '0', $certificate_extensions>, 
                                                                '11', '0', pk(~ltkS)>, 
                                                               '15', 
                                                               sign(<'server_cv', 
                                                                     h(<
                                                                        <
                                                                         <
                                                                          <
                                                                           <
                                                                            <p_messages, '6', '0x0303', '40', 
                                                                             $p_g>, 
                                                                            '1', '0x0303', p_nc, '0', 
                                                                            $cipher_suites, '0', 
                                                                            <'43', '0x0304'>, 
                                                                            <'10', $g1, $g2>, 
                                                                            <'40', $p_g, p_gx>, 
                                                                            <'45', '0', '1'>, p_edi, '41', 
                                                                            <~ticket, mask(x, x.1)>, 
                                                                            hmac(<
                                                                                  Expand(Expand(Extract(~res_psk,
                                                                                                        '0'),
                                                                                                <'ext', 'pbk'
                                                                                                >,
                                                                                                '32'),
                                                                                         <'0', '0'>, '32'), 
                                                                                  h(<
                                                                                     <p_messages, '6', 
                                                                                      '0x0303', '40', $p_g>, 
                                                                                     '1', '0x0303', p_nc, 
                                                                                     '0', $cipher_suites, 
                                                                                     '0', <'43', '0x0304'>, 
                                                                                     <'10', $g1, $g2>, 
                                                                                     <'40', $p_g, p_gx>, 
                                                                                     <'45', '0', '1'>, p_edi, 
                                                                                     '41', 
                                                                                     <~ticket, mask(x, x.1)>, 
                                                                                     '0'>)
                                                                                 >)
                                                                           >, 
                                                                           '2', '0x0303', ~ns, $cipher_suite, 
                                                                           <'13', $sig_algs>, '40', $p_g, 
                                                                           $p_g^~y>, 
                                                                          '8', $exts>, 
                                                                         '13', '0', $certificate_extensions>, 
                                                                        '11', '0', pk(~ltkS)>)
                                                                    >,
                                                                    ~ltkS)
                                                              >)
                                                           >,
                                                           '32'),
                                                    <'fin', '0'>, '32'), 
                                             h(<
                                                <
                                                 <
                                                  <
                                                   <
                                                    <<p_messages, '6', '0x0303', '40', $p_g>, '1', '0x0303', 
                                                     p_nc, '0', $cipher_suites, '0', <'43', '0x0304'>, 
                                                     <'10', $g1, $g2>, <'40', $p_g, p_gx>, <'45', '0', '1'>, 
                                                     p_edi, '41', <~ticket, mask(x, x.1)>, 
                                                     hmac(<
                                                           Expand(Expand(Extract(~res_psk, '0'),
                                                                         <'ext', 'pbk'>, '32'),
                                                                  <'0', '0'>, '32'), 
                                                           h(<<p_messages, '6', '0x0303', '40', $p_g>, '1', 
                                                              '0x0303', p_nc, '0', $cipher_suites, '0', 
                                                              <'43', '0x0304'>, <'10', $g1, $g2>, 
                                                              <'40', $p_g, p_gx>, <'45', '0', '1'>, p_edi, 
                                                              '41', <~ticket, mask(x, x.1)>, '0'>)
                                                          >)
                                                    >, 
                                                    '2', '0x0303', ~ns, $cipher_suite, <'13', $sig_algs>, 
                                                    '40', $p_g, $p_g^~y>, 
                                                   '8', $exts>, 
                                                  '13', '0', $certificate_extensions>, 
                                                 '11', '0', pk(~ltkS)>, 
                                                '15', 
                                                sign(<'server_cv', 
                                                      h(<
                                                         <
                                                          <
                                                           <
                                                            <<p_messages, '6', '0x0303', '40', $p_g>, '1', 
                                                             '0x0303', p_nc, '0', $cipher_suites, '0', 
                                                             <'43', '0x0304'>, <'10', $g1, $g2>, 
                                                             <'40', $p_g, p_gx>, <'45', '0', '1'>, p_edi, 
                                                             '41', <~ticket, mask(x, x.1)>, 
                                                             hmac(<
                                                                   Expand(Expand(Extract(~res_psk, '0'),
                                                                                 <'ext', 'pbk'>, '32'),
                                                                          <'0', '0'>, '32'), 
                                                                   h(<
                                                                      <p_messages, '6', '0x0303', '40', $p_g
                                                                      >, 
                                                                      '1', '0x0303', p_nc, '0', 
                                                                      $cipher_suites, '0', <'43', '0x0304'>, 
                                                                      <'10', $g1, $g2>, <'40', $p_g, p_gx>, 
                                                                      <'45', '0', '1'>, p_edi, '41', 
                                                                      <~ticket, mask(x, x.1)>, '0'>)
                                                                  >)
                                                            >, 
                                                            '2', '0x0303', ~ns, $cipher_suite, 
                                                            <'13', $sig_algs>, '40', $p_g, $p_g^~y>, 
                                                           '8', $exts>, 
                                                          '13', '0', $certificate_extensions>, 
                                                         '11', '0', pk(~ltkS)>)
                                                     >,
                                                     ~ltkS)
                                               >)
                                            >)
                                      >)
                                   >,
                                   '32')
                 ) @ #l)
               ∧
                #l < #j.1)) )
        case case_1
        solve( (∃ #r. (RevLtk( $C ) @ #r) ∧ #r < #i)  ∥
               (∃ tid3 x #r. (RevDHExp( tid3, $C, x ) @ #r) ∧ #r < #i)  ∥
               (∃ tid4 y #r. (RevDHExp( tid4, $S, y ) @ #r) ∧ #r < #i)  ∥
               (∃ rms #r. (RevealPSK( $S, rms ) @ #r) ∧ #r < #k.1)  ∥
               (∃ rms #r. (RevealPSK( $C, rms ) @ #r) ∧ #r < #k.1) )
          case case_1
          by contradiction /* from formulas */
        next
          case case_2
          by contradiction /* from formulas */
        next
          case case_3
          by contradiction /* from formulas */
        next
          case case_4
          by contradiction /* from formulas */
        next
          case case_5
          by contradiction /* from formulas */
        qed
      next
        case case_2
        solve( !Pk( $C, pk(~ltkC) ) ▶₁ #i )
          case Register_pk
          by solve( SecretPSK( $A,
                               Expand(Extract('0', Extract(p_gxy, Extract(~res_psk, '0'))),
                                      <'clientats', 
                                       h(<
                                          <
                                           <
                                            <
                                             <
                                              <
                                               <<p_messages, '6', '0x0303', '40', $p_g>, '1', '0x0303', p_nc, 
                                                '0', $cipher_suites, '0', <'43', '0x0304'>, <'10', $g1, $g2>, 
                                                <'40', $p_g, p_gx>, <'45', '0', '1'>, p_edi, '41', 
                                                <~ticket, mask(x, x.1)>, 
                                                hmac(<
                                                      Expand(Expand(Extract(~res_psk, '0'), <'ext', 'pbk'>,
                                                                    '32'),
                                                             <'0', '0'>, '32'), 
                                                      h(<<p_messages, '6', '0x0303', '40', $p_g>, '1', 
                                                         '0x0303', p_nc, '0', $cipher_suites, '0', 
                                                         <'43', '0x0304'>, <'10', $g1, $g2>, 
                                                         <'40', $p_g, p_gx>, <'45', '0', '1'>, p_edi, '41', 
                                                         <~ticket, mask(x, x.1)>, '0'>)
                                                     >)
                                               >, 
                                               '2', '0x0303', ~ns, $cipher_suite, <'13', $sig_algs>, '40', 
                                               $p_g, $p_g^~y>, 
                                              '8', $exts>, 
                                             '13', '0', $certificate_extensions>, 
                                            '11', '0', pk(~ltkS)>, 
                                           '15', 
                                           sign(<'server_cv', 
                                                 h(<
                                                    <
                                                     <
                                                      <
                                                       <<p_messages, '6', '0x0303', '40', $p_g>, '1', 
                                                        '0x0303', p_nc, '0', $cipher_suites, '0', 
                                                        <'43', '0x0304'>, <'10', $g1, $g2>, 
                                                        <'40', $p_g, p_gx>, <'45', '0', '1'>, p_edi, '41', 
                                                        <~ticket, mask(x, x.1)>, 
                                                        hmac(<
                                                              Expand(Expand(Extract(~res_psk, '0'),
                                                                            <'ext', 'pbk'>, '32'),
                                                                     <'0', '0'>, '32'), 
                                                              h(<<p_messages, '6', '0x0303', '40', $p_g>, 
                                                                 '1', '0x0303', p_nc, '0', $cipher_suites, 
                                                                 '0', <'43', '0x0304'>, <'10', $g1, $g2>, 
                                                                 <'40', $p_g, p_gx>, <'45', '0', '1'>, p_edi, 
                                                                 '41', <~ticket, mask(x, x.1)>, '0'>)
                                                             >)
                                                       >, 
                                                       '2', '0x0303', ~ns, $cipher_suite, <'13', $sig_algs>, 
                                                       '40', $p_g, $p_g^~y>, 
                                                      '8', $exts>, 
                                                     '13', '0', $certificate_extensions>, 
                                                    '11', '0', pk(~ltkS)>)
                                                >,
                                                ~ltkS)
                                          >, 
                                          '20', 
                                          hmac(<
                                                Expand(Expand(Extract(p_gxy, Extract(~res_psk, '0')),
                                                              <'serverhts', 
                                                               h(<
                                                                  <
                                                                   <
                                                                    <
                                                                     <
                                                                      <
                                                                       <p_messages, '6', '0x0303', '40', $p_g
                                                                       >, 
                                                                       '1', '0x0303', p_nc, '0', 
                                                                       $cipher_suites, '0', <'43', '0x0304'>, 
                                                                       <'10', $g1, $g2>, <'40', $p_g, p_gx>, 
                                                                       <'45', '0', '1'>, p_edi, '41', 
                                                                       <~ticket, mask(x, x.1)>, 
                                                                       hmac(<
                                                                             Expand(Expand(Extract(~res_psk,
                                                                                                   '0'),
                                                                                           <'ext', 'pbk'>,
                                                                                           '32'),
                                                                                    <'0', '0'>, '32'), 
                                                                             h(<
                                                                                <p_messages, '6', '0x0303', 
                                                                                 '40', $p_g>, 
                                                                                '1', '0x0303', p_nc, '0', 
                                                                                $cipher_suites, '0', 
                                                                                <'43', '0x0304'>, 
                                                                                <'10', $g1, $g2>, 
                                                                                <'40', $p_g, p_gx>, 
                                                                                <'45', '0', '1'>, p_edi, 
                                                                                '41', 
                                                                                <~ticket, mask(x, x.1)>, '0'>)
                                                                            >)
                                                                      >, 
                                                                      '2', '0x0303', ~ns, $cipher_suite, 
                                                                      <'13', $sig_algs>, '40', $p_g, $p_g^~y
                                                                     >, 
                                                                     '8', $exts>, 
                                                                    '13', '0', $certificate_extensions>, 
                                                                   '11', '0', pk(~ltkS)>, 
                                                                  '15', 
                                                                  sign(<'server_cv', 
                                                                        h(<
                                                                           <
                                                                            <
                                                                             <
                                                                              <
                                                                               <p_messages, '6', '0x0303', 
                                                                                '40', $p_g>, 
                                                                               '1', '0x0303', p_nc, '0', 
                                                                               $cipher_suites, '0', 
                                                                               <'43', '0x0304'>, 
                                                                               <'10', $g1, $g2>, 
                                                                               <'40', $p_g, p_gx>, 
                                                                               <'45', '0', '1'>, p_edi, '41', 
                                                                               <~ticket, mask(x, x.1)>, 
                                                                               hmac(<
                                                                                     Expand(Expand(Extract(~res_psk,
                                                                                                           '0'),
                                                                                                   <'ext', 
                                                                                                    'pbk'>,
                                                                                                   '32'),
                                                                                            <'0', '0'>,
                                                                                            '32'), 
                                                                                     h(<
                                                                                        <p_messages, '6', 
                                                                                         '0x0303', '40', $p_g
                                                                                        >, 
                                                                                        '1', '0x0303', p_nc, 
                                                                                        '0', $cipher_suites, 
                                                                                        '0', 
                                                                                        <'43', '0x0304'>, 
                                                                                        <'10', $g1, $g2>, 
                                                                                        <'40', $p_g, p_gx>, 
                                                                                        <'45', '0', '1'>, 
                                                                                        p_edi, '41', 
                                                                                        <~ticket, mask(x, x.1)
                                                                                        >, 
                                                                                        '0'>)
                                                                                    >)
                                                                              >, 
                                                                              '2', '0x0303', ~ns, 
                                                                              $cipher_suite, 
                                                                              <'13', $sig_algs>, '40', $p_g, 
                                                                              $p_g^~y>, 
                                                                             '8', $exts>, 
                                                                            '13', '0', $certificate_extensions
                                                                           >, 
                                                                           '11', '0', pk(~ltkS)>)
                                                                       >,
                                                                       ~ltkS)
                                                                 >)
                                                              >,
                                                              '32'),
                                                       <'fin', '0'>, '32'), 
                                                h(<
                                                   <
                                                    <
                                                     <
                                                      <
                                                       <<p_messages, '6', '0x0303', '40', $p_g>, '1', 
                                                        '0x0303', p_nc, '0', $cipher_suites, '0', 
                                                        <'43', '0x0304'>, <'10', $g1, $g2>, 
                                                        <'40', $p_g, p_gx>, <'45', '0', '1'>, p_edi, '41', 
                                                        <~ticket, mask(x, x.1)>, 
                                                        hmac(<
                                                              Expand(Expand(Extract(~res_psk, '0'),
                                                                            <'ext', 'pbk'>, '32'),
                                                                     <'0', '0'>, '32'), 
                                                              h(<<p_messages, '6', '0x0303', '40', $p_g>, 
                                                                 '1', '0x0303', p_nc, '0', $cipher_suites, 
                                                                 '0', <'43', '0x0304'>, <'10', $g1, $g2>, 
                                                                 <'40', $p_g, p_gx>, <'45', '0', '1'>, p_edi, 
                                                                 '41', <~ticket, mask(x, x.1)>, '0'>)
                                                             >)
                                                       >, 
                                                       '2', '0x0303', ~ns, $cipher_suite, <'13', $sig_algs>, 
                                                       '40', $p_g, $p_g^~y>, 
                                                      '8', $exts>, 
                                                     '13', '0', $certificate_extensions>, 
                                                    '11', '0', pk(~ltkS)>, 
                                                   '15', 
                                                   sign(<'server_cv', 
                                                         h(<
                                                            <
                                                             <
                                                              <
                                                               <<p_messages, '6', '0x0303', '40', $p_g>, '1', 
                                                                '0x0303', p_nc, '0', $cipher_suites, '0', 
                                                                <'43', '0x0304'>, <'10', $g1, $g2>, 
                                                                <'40', $p_g, p_gx>, <'45', '0', '1'>, p_edi, 
                                                                '41', <~ticket, mask(x, x.1)>, 
                                                                hmac(<
                                                                      Expand(Expand(Extract(~res_psk, '0'),
                                                                                    <'ext', 'pbk'>, '32'),
                                                                             <'0', '0'>, '32'), 
                                                                      h(<
                                                                         <p_messages, '6', '0x0303', '40', 
                                                                          $p_g>, 
                                                                         '1', '0x0303', p_nc, '0', 
                                                                         $cipher_suites, '0', 
                                                                         <'43', '0x0304'>, <'10', $g1, $g2>, 
                                                                         <'40', $p_g, p_gx>, 
                                                                         <'45', '0', '1'>, p_edi, '41', 
                                                                         <~ticket, mask(x, x.1)>, '0'>)
                                                                     >)
                                                               >, 
                                                               '2', '0x0303', ~ns, $cipher_suite, 
                                                               <'13', $sig_algs>, '40', $p_g, $p_g^~y>, 
                                                              '8', $exts>, 
                                                             '13', '0', $certificate_extensions>, 
                                                            '11', '0', pk(~ltkS)>)
                                                        >,
                                                        ~ltkS)
                                                  >)
                                               >)
                                         >)
                                      >,
                                      '32')
                    ) ▶₀ #l )
        qed
      qed
    next
      case server_auth_case_06
      solve( (∃ #j.2.
               (!KU( Extract('0',
                             Extract(p_gxy, Extract(Expand(ms, <'rms', h(messages)>, '32'), '0')))
                ) @ #j.2)
              ∧
               #j.2 < #j.1)  ∥
             ((∀ #k.
                (!KU( Extract('0',
                              Extract(p_gxy, Extract(Expand(ms, <'rms', h(messages)>, '32'), '0')))
                 ) @ #k)
               ⇒
                ¬(#k < #j.1)) ∧
              (∃ actor #l.
                (RevealPSK( actor,
                            Expand(Extract('0',
                                           Extract(p_gxy,
                                                   Extract(Expand(ms, <'rms', h(messages)>, '32'), '0'))),
                                   <'clientats', 
                                    h(<
                                       <
                                        <
                                         <
                                          <
                                           <
                                            <<p_messages, '6', '0x0303', '40', $p_g>, '1', '0x0303', p_nc, 
                                             '0', $cipher_suites, '0', <'43', '0x0304'>, <'10', $g1, $g2>, 
                                             <'40', $p_g, p_gx>, <'45', '0', '1'>, p_edi, '41', 
                                             <~ticket, mask(x, x.1)>, 
                                             hmac(<
                                                   Expand(Expand(Extract(Expand(ms, <'rms', h(messages)>,
                                                                                '32'),
                                                                         '0'),
                                                                 <'res', 'pbk'>, '32'),
                                                          <'0', '0'>, '32'), 
                                                   h(<<p_messages, '6', '0x0303', '40', $p_g>, '1', '0x0303', 
                                                      p_nc, '0', $cipher_suites, '0', <'43', '0x0304'>, 
                                                      <'10', $g1, $g2>, <'40', $p_g, p_gx>, <'45', '0', '1'>, 
                                                      p_edi, '41', <~ticket, mask(x, x.1)>, '0'>)
                                                  >)
                                            >, 
                                            '2', '0x0303', ~ns, $cipher_suite, <'13', $sig_algs>, '40', $p_g, 
                                            $p_g^~y>, 
                                           '8', $exts>, 
                                          '13', '0', $certificate_extensions>, 
                                         '11', '0', pk(~ltkS)>, 
                                        '15', 
                                        sign(<'server_cv', 
                                              h(<
                                                 <
                                                  <
                                                   <
                                                    <<p_messages, '6', '0x0303', '40', $p_g>, '1', '0x0303', 
                                                     p_nc, '0', $cipher_suites, '0', <'43', '0x0304'>, 
                                                     <'10', $g1, $g2>, <'40', $p_g, p_gx>, <'45', '0', '1'>, 
                                                     p_edi, '41', <~ticket, mask(x, x.1)>, 
                                                     hmac(<
                                                           Expand(Expand(Extract(Expand(ms,
                                                                                        <'rms', h(messages)>,
                                                                                        '32'),
                                                                                 '0'),
                                                                         <'res', 'pbk'>, '32'),
                                                                  <'0', '0'>, '32'), 
                                                           h(<<p_messages, '6', '0x0303', '40', $p_g>, '1', 
                                                              '0x0303', p_nc, '0', $cipher_suites, '0', 
                                                              <'43', '0x0304'>, <'10', $g1, $g2>, 
                                                              <'40', $p_g, p_gx>, <'45', '0', '1'>, p_edi, 
                                                              '41', <~ticket, mask(x, x.1)>, '0'>)
                                                          >)
                                                    >, 
                                                    '2', '0x0303', ~ns, $cipher_suite, <'13', $sig_algs>, 
                                                    '40', $p_g, $p_g^~y>, 
                                                   '8', $exts>, 
                                                  '13', '0', $certificate_extensions>, 
                                                 '11', '0', pk(~ltkS)>)
                                             >,
                                             ~ltkS)
                                       >, 
                                       '20', 
                                       hmac(<
                                             Expand(Expand(Extract(p_gxy,
                                                                   Extract(Expand(ms, <'rms', h(messages)>,
                                                                                  '32'),
                                                                           '0')),
                                                           <'serverhts', 
                                                            h(<
                                                               <
                                                                <
                                                                 <
                                                                  <
                                                                   <<p_messages, '6', '0x0303', '40', $p_g>, 
                                                                    '1', '0x0303', p_nc, '0', $cipher_suites, 
                                                                    '0', <'43', '0x0304'>, <'10', $g1, $g2>, 
                                                                    <'40', $p_g, p_gx>, <'45', '0', '1'>, 
                                                                    p_edi, '41', <~ticket, mask(x, x.1)>, 
                                                                    hmac(<
                                                                          Expand(Expand(Extract(Expand(ms,
                                                                                                       <
                                                                                                        'rms', 
                                                                                                        h(messages)
                                                                                                       >,
                                                                                                       '32'),
                                                                                                '0'),
                                                                                        <'res', 'pbk'>, '32'),
                                                                                 <'0', '0'>, '32'), 
                                                                          h(<
                                                                             <p_messages, '6', '0x0303', 
                                                                              '40', $p_g>, 
                                                                             '1', '0x0303', p_nc, '0', 
                                                                             $cipher_suites, '0', 
                                                                             <'43', '0x0304'>, 
                                                                             <'10', $g1, $g2>, 
                                                                             <'40', $p_g, p_gx>, 
                                                                             <'45', '0', '1'>, p_edi, '41', 
                                                                             <~ticket, mask(x, x.1)>, '0'>)
                                                                         >)
                                                                   >, 
                                                                   '2', '0x0303', ~ns, $cipher_suite, 
                                                                   <'13', $sig_algs>, '40', $p_g, $p_g^~y>, 
                                                                  '8', $exts>, 
                                                                 '13', '0', $certificate_extensions>, 
                                                                '11', '0', pk(~ltkS)>, 
                                                               '15', 
                                                               sign(<'server_cv', 
                                                                     h(<
                                                                        <
                                                                         <
                                                                          <
                                                                           <
                                                                            <p_messages, '6', '0x0303', '40', 
                                                                             $p_g>, 
                                                                            '1', '0x0303', p_nc, '0', 
                                                                            $cipher_suites, '0', 
                                                                            <'43', '0x0304'>, 
                                                                            <'10', $g1, $g2>, 
                                                                            <'40', $p_g, p_gx>, 
                                                                            <'45', '0', '1'>, p_edi, '41', 
                                                                            <~ticket, mask(x, x.1)>, 
                                                                            hmac(<
                                                                                  Expand(Expand(Extract(Expand(ms,
                                                                                                               <
                                                                                                                'rms', 
                                                                                                                h(messages)
                                                                                                               >,
                                                                                                               '32'),
                                                                                                        '0'),
                                                                                                <'res', 'pbk'
                                                                                                >,
                                                                                                '32'),
                                                                                         <'0', '0'>, '32'), 
                                                                                  h(<
                                                                                     <p_messages, '6', 
                                                                                      '0x0303', '40', $p_g>, 
                                                                                     '1', '0x0303', p_nc, 
                                                                                     '0', $cipher_suites, 
                                                                                     '0', <'43', '0x0304'>, 
                                                                                     <'10', $g1, $g2>, 
                                                                                     <'40', $p_g, p_gx>, 
                                                                                     <'45', '0', '1'>, p_edi, 
                                                                                     '41', 
                                                                                     <~ticket, mask(x, x.1)>, 
                                                                                     '0'>)
                                                                                 >)
                                                                           >, 
                                                                           '2', '0x0303', ~ns, $cipher_suite, 
                                                                           <'13', $sig_algs>, '40', $p_g, 
                                                                           $p_g^~y>, 
                                                                          '8', $exts>, 
                                                                         '13', '0', $certificate_extensions>, 
                                                                        '11', '0', pk(~ltkS)>)
                                                                    >,
                                                                    ~ltkS)
                                                              >)
                                                           >,
                                                           '32'),
                                                    <'fin', '0'>, '32'), 
                                             h(<
                                                <
                                                 <
                                                  <
                                                   <
                                                    <<p_messages, '6', '0x0303', '40', $p_g>, '1', '0x0303', 
                                                     p_nc, '0', $cipher_suites, '0', <'43', '0x0304'>, 
                                                     <'10', $g1, $g2>, <'40', $p_g, p_gx>, <'45', '0', '1'>, 
                                                     p_edi, '41', <~ticket, mask(x, x.1)>, 
                                                     hmac(<
                                                           Expand(Expand(Extract(Expand(ms,
                                                                                        <'rms', h(messages)>,
                                                                                        '32'),
                                                                                 '0'),
                                                                         <'res', 'pbk'>, '32'),
                                                                  <'0', '0'>, '32'), 
                                                           h(<<p_messages, '6', '0x0303', '40', $p_g>, '1', 
                                                              '0x0303', p_nc, '0', $cipher_suites, '0', 
                                                              <'43', '0x0304'>, <'10', $g1, $g2>, 
                                                              <'40', $p_g, p_gx>, <'45', '0', '1'>, p_edi, 
                                                              '41', <~ticket, mask(x, x.1)>, '0'>)
                                                          >)
                                                    >, 
                                                    '2', '0x0303', ~ns, $cipher_suite, <'13', $sig_algs>, 
                                                    '40', $p_g, $p_g^~y>, 
                                                   '8', $exts>, 
                                                  '13', '0', $certificate_extensions>, 
                                                 '11', '0', pk(~ltkS)>, 
                                                '15', 
                                                sign(<'server_cv', 
                                                      h(<
                                                         <
                                                          <
                                                           <
                                                            <<p_messages, '6', '0x0303', '40', $p_g>, '1', 
                                                             '0x0303', p_nc, '0', $cipher_suites, '0', 
                                                             <'43', '0x0304'>, <'10', $g1, $g2>, 
                                                             <'40', $p_g, p_gx>, <'45', '0', '1'>, p_edi, 
                                                             '41', <~ticket, mask(x, x.1)>, 
                                                             hmac(<
                                                                   Expand(Expand(Extract(Expand(ms,
                                                                                                <'rms', 
                                                                                                 h(messages)>,
                                                                                                '32'),
                                                                                         '0'),
                                                                                 <'res', 'pbk'>, '32'),
                                                                          <'0', '0'>, '32'), 
                                                                   h(<
                                                                      <p_messages, '6', '0x0303', '40', $p_g
                                                                      >, 
                                                                      '1', '0x0303', p_nc, '0', 
                                                                      $cipher_suites, '0', <'43', '0x0304'>, 
                                                                      <'10', $g1, $g2>, <'40', $p_g, p_gx>, 
                                                                      <'45', '0', '1'>, p_edi, '41', 
                                                                      <~ticket, mask(x, x.1)>, '0'>)
                                                                  >)
                                                            >, 
                                                            '2', '0x0303', ~ns, $cipher_suite, 
                                                            <'13', $sig_algs>, '40', $p_g, $p_g^~y>, 
                                                           '8', $exts>, 
                                                          '13', '0', $certificate_extensions>, 
                                                         '11', '0', pk(~ltkS)>)
                                                     >,
                                                     ~ltkS)
                                               >)
                                            >)
                                      >)
                                   >,
                                   '32')
                 ) @ #l)
               ∧
                #l < #j.1)) )
        case case_1
        solve( (∃ #r. (RevLtk( $C ) @ #r) ∧ #r < #i)  ∥
               (∃ tid3 x #r. (RevDHExp( tid3, $C, x ) @ #r) ∧ #r < #i)  ∥
               (∃ tid4 y #r. (RevDHExp( tid4, $S, y ) @ #r) ∧ #r < #i)  ∥
               (∃ rms #r. (RevealPSK( $S, rms ) @ #r) ∧ #r < #k.1)  ∥
               (∃ rms #r. (RevealPSK( $C, rms ) @ #r) ∧ #r < #k.1) )
          case case_1
          by contradiction /* from formulas */
        next
          case case_2
          by contradiction /* from formulas */
        next
          case case_3
          by contradiction /* from formulas */
        next
          case case_4
          by contradiction /* from formulas */
        next
          case case_5
          by contradiction /* from formulas */
        qed
      next
        case case_2
        solve( !Pk( $C, pk(~ltkC) ) ▶₁ #i )
          case Register_pk
          by solve( SecretPSK( $A,
                               Expand(Extract('0',
                                              Extract(p_gxy,
                                                      Extract(Expand(ms, <'rms', h(messages)>, '32'), '0'))),
                                      <'clientats', 
                                       h(<
                                          <
                                           <
                                            <
                                             <
                                              <
                                               <<p_messages, '6', '0x0303', '40', $p_g>, '1', '0x0303', p_nc, 
                                                '0', $cipher_suites, '0', <'43', '0x0304'>, <'10', $g1, $g2>, 
                                                <'40', $p_g, p_gx>, <'45', '0', '1'>, p_edi, '41', 
                                                <~ticket, mask(x, x.1)>, 
                                                hmac(<
                                                      Expand(Expand(Extract(Expand(ms, <'rms', h(messages)>,
                                                                                   '32'),
                                                                            '0'),
                                                                    <'res', 'pbk'>, '32'),
                                                             <'0', '0'>, '32'), 
                                                      h(<<p_messages, '6', '0x0303', '40', $p_g>, '1', 
                                                         '0x0303', p_nc, '0', $cipher_suites, '0', 
                                                         <'43', '0x0304'>, <'10', $g1, $g2>, 
                                                         <'40', $p_g, p_gx>, <'45', '0', '1'>, p_edi, '41', 
                                                         <~ticket, mask(x, x.1)>, '0'>)
                                                     >)
                                               >, 
                                               '2', '0x0303', ~ns, $cipher_suite, <'13', $sig_algs>, '40', 
                                               $p_g, $p_g^~y>, 
                                              '8', $exts>, 
                                             '13', '0', $certificate_extensions>, 
                                            '11', '0', pk(~ltkS)>, 
                                           '15', 
                                           sign(<'server_cv', 
                                                 h(<
                                                    <
                                                     <
                                                      <
                                                       <<p_messages, '6', '0x0303', '40', $p_g>, '1', 
                                                        '0x0303', p_nc, '0', $cipher_suites, '0', 
                                                        <'43', '0x0304'>, <'10', $g1, $g2>, 
                                                        <'40', $p_g, p_gx>, <'45', '0', '1'>, p_edi, '41', 
                                                        <~ticket, mask(x, x.1)>, 
                                                        hmac(<
                                                              Expand(Expand(Extract(Expand(ms,
                                                                                           <'rms', h(messages)
                                                                                           >,
                                                                                           '32'),
                                                                                    '0'),
                                                                            <'res', 'pbk'>, '32'),
                                                                     <'0', '0'>, '32'), 
                                                              h(<<p_messages, '6', '0x0303', '40', $p_g>, 
                                                                 '1', '0x0303', p_nc, '0', $cipher_suites, 
                                                                 '0', <'43', '0x0304'>, <'10', $g1, $g2>, 
                                                                 <'40', $p_g, p_gx>, <'45', '0', '1'>, p_edi, 
                                                                 '41', <~ticket, mask(x, x.1)>, '0'>)
                                                             >)
                                                       >, 
                                                       '2', '0x0303', ~ns, $cipher_suite, <'13', $sig_algs>, 
                                                       '40', $p_g, $p_g^~y>, 
                                                      '8', $exts>, 
                                                     '13', '0', $certificate_extensions>, 
                                                    '11', '0', pk(~ltkS)>)
                                                >,
                                                ~ltkS)
                                          >, 
                                          '20', 
                                          hmac(<
                                                Expand(Expand(Extract(p_gxy,
                                                                      Extract(Expand(ms, <'rms', h(messages)>,
                                                                                     '32'),
                                                                              '0')),
                                                              <'serverhts', 
                                                               h(<
                                                                  <
                                                                   <
                                                                    <
                                                                     <
                                                                      <
                                                                       <p_messages, '6', '0x0303', '40', $p_g
                                                                       >, 
                                                                       '1', '0x0303', p_nc, '0', 
                                                                       $cipher_suites, '0', <'43', '0x0304'>, 
                                                                       <'10', $g1, $g2>, <'40', $p_g, p_gx>, 
                                                                       <'45', '0', '1'>, p_edi, '41', 
                                                                       <~ticket, mask(x, x.1)>, 
                                                                       hmac(<
                                                                             Expand(Expand(Extract(Expand(ms,
                                                                                                          <
                                                                                                           'rms', 
                                                                                                           h(messages)
                                                                                                          >,
                                                                                                          '32'),
                                                                                                   '0'),
                                                                                           <'res', 'pbk'>,
                                                                                           '32'),
                                                                                    <'0', '0'>, '32'), 
                                                                             h(<
                                                                                <p_messages, '6', '0x0303', 
                                                                                 '40', $p_g>, 
                                                                                '1', '0x0303', p_nc, '0', 
                                                                                $cipher_suites, '0', 
                                                                                <'43', '0x0304'>, 
                                                                                <'10', $g1, $g2>, 
                                                                                <'40', $p_g, p_gx>, 
                                                                                <'45', '0', '1'>, p_edi, 
                                                                                '41', 
                                                                                <~ticket, mask(x, x.1)>, '0'>)
                                                                            >)
                                                                      >, 
                                                                      '2', '0x0303', ~ns, $cipher_suite, 
                                                                      <'13', $sig_algs>, '40', $p_g, $p_g^~y
                                                                     >, 
                                                                     '8', $exts>, 
                                                                    '13', '0', $certificate_extensions>, 
                                                                   '11', '0', pk(~ltkS)>, 
                                                                  '15', 
                                                                  sign(<'server_cv', 
                                                                        h(<
                                                                           <
                                                                            <
                                                                             <
                                                                              <
                                                                               <p_messages, '6', '0x0303', 
                                                                                '40', $p_g>, 
                                                                               '1', '0x0303', p_nc, '0', 
                                                                               $cipher_suites, '0', 
                                                                               <'43', '0x0304'>, 
                                                                               <'10', $g1, $g2>, 
                                                                               <'40', $p_g, p_gx>, 
                                                                               <'45', '0', '1'>, p_edi, '41', 
                                                                               <~ticket, mask(x, x.1)>, 
                                                                               hmac(<
                                                                                     Expand(Expand(Extract(Expand(ms,
                                                                                                                  <
                                                                                                                   'rms', 
                                                                                                                   h(messages)
                                                                                                                  >,
                                                                                                                  '32'),
                                                                                                           '0'),
                                                                                                   <'res', 
                                                                                                    'pbk'>,
                                                                                                   '32'),
                                                                                            <'0', '0'>,
                                                                                            '32'), 
                                                                                     h(<
                                                                                        <p_messages, '6', 
                                                                                         '0x0303', '40', $p_g
                                                                                        >, 
                                                                                        '1', '0x0303', p_nc, 
                                                                                        '0', $cipher_suites, 
                                                                                        '0', 
                                                                                        <'43', '0x0304'>, 
                                                                                        <'10', $g1, $g2>, 
                                                                                        <'40', $p_g, p_gx>, 
                                                                                        <'45', '0', '1'>, 
                                                                                        p_edi, '41', 
                                                                                        <~ticket, mask(x, x.1)
                                                                                        >, 
                                                                                        '0'>)
                                                                                    >)
                                                                              >, 
                                                                              '2', '0x0303', ~ns, 
                                                                              $cipher_suite, 
                                                                              <'13', $sig_algs>, '40', $p_g, 
                                                                              $p_g^~y>, 
                                                                             '8', $exts>, 
                                                                            '13', '0', $certificate_extensions
                                                                           >, 
                                                                           '11', '0', pk(~ltkS)>)
                                                                       >,
                                                                       ~ltkS)
                                                                 >)
                                                              >,
                                                              '32'),
                                                       <'fin', '0'>, '32'), 
                                                h(<
                                                   <
                                                    <
                                                     <
                                                      <
                                                       <<p_messages, '6', '0x0303', '40', $p_g>, '1', 
                                                        '0x0303', p_nc, '0', $cipher_suites, '0', 
                                                        <'43', '0x0304'>, <'10', $g1, $g2>, 
                                                        <'40', $p_g, p_gx>, <'45', '0', '1'>, p_edi, '41', 
                                                        <~ticket, mask(x, x.1)>, 
                                                        hmac(<
                                                              Expand(Expand(Extract(Expand(ms,
                                                                                           <'rms', h(messages)
                                                                                           >,
                                                                                           '32'),
                                                                                    '0'),
                                                                            <'res', 'pbk'>, '32'),
                                                                     <'0', '0'>, '32'), 
                                                              h(<<p_messages, '6', '0x0303', '40', $p_g>, 
                                                                 '1', '0x0303', p_nc, '0', $cipher_suites, 
                                                                 '0', <'43', '0x0304'>, <'10', $g1, $g2>, 
                                                                 <'40', $p_g, p_gx>, <'45', '0', '1'>, p_edi, 
                                                                 '41', <~ticket, mask(x, x.1)>, '0'>)
                                                             >)
                                                       >, 
                                                       '2', '0x0303', ~ns, $cipher_suite, <'13', $sig_algs>, 
                                                       '40', $p_g, $p_g^~y>, 
                                                      '8', $exts>, 
                                                     '13', '0', $certificate_extensions>, 
                                                    '11', '0', pk(~ltkS)>, 
                                                   '15', 
                                                   sign(<'server_cv', 
                                                         h(<
                                                            <
                                                             <
                                                              <
                                                               <<p_messages, '6', '0x0303', '40', $p_g>, '1', 
                                                                '0x0303', p_nc, '0', $cipher_suites, '0', 
                                                                <'43', '0x0304'>, <'10', $g1, $g2>, 
                                                                <'40', $p_g, p_gx>, <'45', '0', '1'>, p_edi, 
                                                                '41', <~ticket, mask(x, x.1)>, 
                                                                hmac(<
                                                                      Expand(Expand(Extract(Expand(ms,
                                                                                                   <'rms', 
                                                                                                    h(messages)
                                                                                                   >,
                                                                                                   '32'),
                                                                                            '0'),
                                                                                    <'res', 'pbk'>, '32'),
                                                                             <'0', '0'>, '32'), 
                                                                      h(<
                                                                         <p_messages, '6', '0x0303', '40', 
                                                                          $p_g>, 
                                                                         '1', '0x0303', p_nc, '0', 
                                                                         $cipher_suites, '0', 
                                                                         <'43', '0x0304'>, <'10', $g1, $g2>, 
                                                                         <'40', $p_g, p_gx>, 
                                                                         <'45', '0', '1'>, p_edi, '41', 
                                                                         <~ticket, mask(x, x.1)>, '0'>)
                                                                     >)
                                                               >, 
                                                               '2', '0x0303', ~ns, $cipher_suite, 
                                                               <'13', $sig_algs>, '40', $p_g, $p_g^~y>, 
                                                              '8', $exts>, 
                                                             '13', '0', $certificate_extensions>, 
                                                            '11', '0', pk(~ltkS)>)
                                                        >,
                                                        ~ltkS)
                                                  >)
                                               >)
                                         >)
                                      >,
                                      '32')
                    ) ▶₀ #l )
        qed
      qed
    next
      case server_auth_case_07
      by contradiction /* from formulas */
    next
      case server_auth_case_08
      by contradiction /* from formulas */
    next
      case server_auth_case_09
      by contradiction /* from formulas */
    next
      case server_auth_case_10
      by contradiction /* from formulas */
    next
      case server_auth_case_11
      by contradiction /* from formulas */
    next
      case server_auth_case_12
      by contradiction /* from formulas */
    qed
  next
    case case_2
    solve( F_State_S3( ~tid, $S, $C, p_res_psk, p_messages, p_nc, p_ns, p_g,
                       p_sg, p_hrr, p_x, p_y, p_gx, p_gy, p_gxy, p_psk_ke_mode, p_psk_id, p_edi,
                       p_es, p_hs, Extract('0', p_hs), p_cats, p_sats, p_hs_keyc, p_hs_keys,
                       p_auth_status, p_ems, p_rms, '1'
           ) ▶₀ #i )
      case server_auth_case_01
      solve( !Pk( $C, pk(~ltkC) ) ▶₁ #i )
        case Register_pk
        by solve( SecretPSK( $A,
                             Expand(Expand(Extract('0', Extract(p_gxy, Extract('0', '0'))),
                                           <'clientats', 
                                            h(<
                                               <
                                                <
                                                 <
                                                  <
                                                   <
                                                    <'0', '1', '0x0303', p_nc, '0', $cipher_suites, '0', 
                                                     <'43', '0x0304'>, <'10', $g1, $g2>, <'13', $sig_algs>, 
                                                     '40', $p_g, p_gx>, 
                                                    '2', '0x0303', ~new_ns, $cipher_suite, 
                                                    <'13', $sig_algs.1>, '40', $p_g, $p_g^~y>, 
                                                   '8', $exts>, 
                                                  '13', '0', $certificate_extensions>, 
                                                 '11', '0', pk(~ltkS)>, 
                                                '15', 
                                                sign(<'server_cv', 
                                                      h(<
                                                         <
                                                          <
                                                           <
                                                            <'0', '1', '0x0303', p_nc, '0', $cipher_suites, 
                                                             '0', <'43', '0x0304'>, <'10', $g1, $g2>, 
                                                             <'13', $sig_algs>, '40', $p_g, p_gx>, 
                                                            '2', '0x0303', ~new_ns, $cipher_suite, 
                                                            <'13', $sig_algs.1>, '40', $p_g, $p_g^~y>, 
                                                           '8', $exts>, 
                                                          '13', '0', $certificate_extensions>, 
                                                         '11', '0', pk(~ltkS)>)
                                                     >,
                                                     ~ltkS)
                                               >, 
                                               '20', 
                                               hmac(<
                                                     Expand(Expand(Extract(p_gxy, Extract('0', '0')),
                                                                   <'serverhts', 
                                                                    h(<
                                                                       <
                                                                        <
                                                                         <
                                                                          <
                                                                           <'0', '1', '0x0303', p_nc, '0', 
                                                                            $cipher_suites, '0', 
                                                                            <'43', '0x0304'>, 
                                                                            <'10', $g1, $g2>, 
                                                                            <'13', $sig_algs>, '40', $p_g, 
                                                                            p_gx>, 
                                                                           '2', '0x0303', ~new_ns, 
                                                                           $cipher_suite, 
                                                                           <'13', $sig_algs.1>, '40', $p_g, 
                                                                           $p_g^~y>, 
                                                                          '8', $exts>, 
                                                                         '13', '0', $certificate_extensions>, 
                                                                        '11', '0', pk(~ltkS)>, 
                                                                       '15', 
                                                                       sign(<'server_cv', 
                                                                             h(<
                                                                                <
                                                                                 <
                                                                                  <
                                                                                   <'0', '1', '0x0303', p_nc, 
                                                                                    '0', $cipher_suites, '0', 
                                                                                    <'43', '0x0304'>, 
                                                                                    <'10', $g1, $g2>, 
                                                                                    <'13', $sig_algs>, '40', 
                                                                                    $p_g, p_gx>, 
                                                                                   '2', '0x0303', ~new_ns, 
                                                                                   $cipher_suite, 
                                                                                   <'13', $sig_algs.1>, '40', 
                                                                                   $p_g, $p_g^~y>, 
                                                                                  '8', $exts>, 
                                                                                 '13', '0', 
                                                                                 $certificate_extensions>, 
                                                                                '11', '0', pk(~ltkS)>)
                                                                            >,
                                                                            ~ltkS)
                                                                      >)
                                                                   >,
                                                                   '32'),
                                                            <'fin', '0'>, '32'), 
                                                     h(<
                                                        <
                                                         <
                                                          <
                                                           <
                                                            <'0', '1', '0x0303', p_nc, '0', $cipher_suites, 
                                                             '0', <'43', '0x0304'>, <'10', $g1, $g2>, 
                                                             <'13', $sig_algs>, '40', $p_g, p_gx>, 
                                                            '2', '0x0303', ~new_ns, $cipher_suite, 
                                                            <'13', $sig_algs.1>, '40', $p_g, $p_g^~y>, 
                                                           '8', $exts>, 
                                                          '13', '0', $certificate_extensions>, 
                                                         '11', '0', pk(~ltkS)>, 
                                                        '15', 
                                                        sign(<'server_cv', 
                                                              h(<
                                                                 <
                                                                  <
                                                                   <
                                                                    <'0', '1', '0x0303', p_nc, '0', 
                                                                     $cipher_suites, '0', <'43', '0x0304'>, 
                                                                     <'10', $g1, $g2>, <'13', $sig_algs>, 
                                                                     '40', $p_g, p_gx>, 
                                                                    '2', '0x0303', ~new_ns, $cipher_suite, 
                                                                    <'13', $sig_algs.1>, '40', $p_g, $p_g^~y
                                                                   >, 
                                                                   '8', $exts>, 
                                                                  '13', '0', $certificate_extensions>, 
                                                                 '11', '0', pk(~ltkS)>)
                                                             >,
                                                             ~ltkS)
                                                       >)
                                                    >)
                                              >)
                                           >,
                                           '32'),
                                    <'adke_wk', '0'>, '32')
                  ) ▶₀ #l )
      qed
    next
      case server_auth_case_02
      solve( !Pk( $C, pk(~ltkC) ) ▶₁ #i )
        case Register_pk
        by solve( SecretPSK( $A,
                             Expand(Expand(Extract('0', Extract(p_gxy, Extract(p_res_psk, '0'))),
                                           <'clientats', 
                                            h(<
                                               <
                                                <
                                                 <
                                                  <
                                                   <
                                                    <<p_messages, '6', '0x0303', '40', $p_g>, '1', '0x0303', 
                                                     p_nc, '0', $cipher_suites, '0', <'43', '0x0304'>, 
                                                     <'10', $g1, $g2>, <'13', $sig_algs>, '40', $p_g, p_gx>, 
                                                    '2', '0x0303', ~new_ns, $cipher_suite, 
                                                    <'13', $sig_algs.1>, '40', $p_g, $p_g^~y>, 
                                                   '8', $exts>, 
                                                  '13', '0', $certificate_extensions>, 
                                                 '11', '0', pk(~ltkS)>, 
                                                '15', 
                                                sign(<'server_cv', 
                                                      h(<
                                                         <
                                                          <
                                                           <
                                                            <<p_messages, '6', '0x0303', '40', $p_g>, '1', 
                                                             '0x0303', p_nc, '0', $cipher_suites, '0', 
                                                             <'43', '0x0304'>, <'10', $g1, $g2>, 
                                                             <'13', $sig_algs>, '40', $p_g, p_gx>, 
                                                            '2', '0x0303', ~new_ns, $cipher_suite, 
                                                            <'13', $sig_algs.1>, '40', $p_g, $p_g^~y>, 
                                                           '8', $exts>, 
                                                          '13', '0', $certificate_extensions>, 
                                                         '11', '0', pk(~ltkS)>)
                                                     >,
                                                     ~ltkS)
                                               >, 
                                               '20', 
                                               hmac(<
                                                     Expand(Expand(Extract(p_gxy, Extract(p_res_psk, '0')),
                                                                   <'serverhts', 
                                                                    h(<
                                                                       <
                                                                        <
                                                                         <
                                                                          <
                                                                           <
                                                                            <p_messages, '6', '0x0303', '40', 
                                                                             $p_g>, 
                                                                            '1', '0x0303', p_nc, '0', 
                                                                            $cipher_suites, '0', 
                                                                            <'43', '0x0304'>, 
                                                                            <'10', $g1, $g2>, 
                                                                            <'13', $sig_algs>, '40', $p_g, 
                                                                            p_gx>, 
                                                                           '2', '0x0303', ~new_ns, 
                                                                           $cipher_suite, 
                                                                           <'13', $sig_algs.1>, '40', $p_g, 
                                                                           $p_g^~y>, 
                                                                          '8', $exts>, 
                                                                         '13', '0', $certificate_extensions>, 
                                                                        '11', '0', pk(~ltkS)>, 
                                                                       '15', 
                                                                       sign(<'server_cv', 
                                                                             h(<
                                                                                <
                                                                                 <
                                                                                  <
                                                                                   <
                                                                                    <p_messages, '6', 
                                                                                     '0x0303', '40', $p_g>, 
                                                                                    '1', '0x0303', p_nc, '0', 
                                                                                    $cipher_suites, '0', 
                                                                                    <'43', '0x0304'>, 
                                                                                    <'10', $g1, $g2>, 
                                                                                    <'13', $sig_algs>, '40', 
                                                                                    $p_g, p_gx>, 
                                                                                   '2', '0x0303', ~new_ns, 
                                                                                   $cipher_suite, 
                                                                                   <'13', $sig_algs.1>, '40', 
                                                                                   $p_g, $p_g^~y>, 
                                                                                  '8', $exts>, 
                                                                                 '13', '0', 
                                                                                 $certificate_extensions>, 
                                                                                '11', '0', pk(~ltkS)>)
                                                                            >,
                                                                            ~ltkS)
                                                                      >)
                                                                   >,
                                                                   '32'),
                                                            <'fin', '0'>, '32'), 
                                                     h(<
                                                        <
                                                         <
                                                          <
                                                           <
                                                            <<p_messages, '6', '0x0303', '40', $p_g>, '1', 
                                                             '0x0303', p_nc, '0', $cipher_suites, '0', 
                                                             <'43', '0x0304'>, <'10', $g1, $g2>, 
                                                             <'13', $sig_algs>, '40', $p_g, p_gx>, 
                                                            '2', '0x0303', ~new_ns, $cipher_suite, 
                                                            <'13', $sig_algs.1>, '40', $p_g, $p_g^~y>, 
                                                           '8', $exts>, 
                                                          '13', '0', $certificate_extensions>, 
                                                         '11', '0', pk(~ltkS)>, 
                                                        '15', 
                                                        sign(<'server_cv', 
                                                              h(<
                                                                 <
                                                                  <
                                                                   <
                                                                    <<p_messages, '6', '0x0303', '40', $p_g>, 
                                                                     '1', '0x0303', p_nc, '0', 
                                                                     $cipher_suites, '0', <'43', '0x0304'>, 
                                                                     <'10', $g1, $g2>, <'13', $sig_algs>, 
                                                                     '40', $p_g, p_gx>, 
                                                                    '2', '0x0303', ~new_ns, $cipher_suite, 
                                                                    <'13', $sig_algs.1>, '40', $p_g, $p_g^~y
                                                                   >, 
                                                                   '8', $exts>, 
                                                                  '13', '0', $certificate_extensions>, 
                                                                 '11', '0', pk(~ltkS)>)
                                                             >,
                                                             ~ltkS)
                                                       >)
                                                    >)
                                              >)
                                           >,
                                           '32'),
                                    <'adke_wk', '0'>, '32')
                  ) ▶₀ #l )
      qed
    next
      case server_auth_case_03
      solve( !Pk( $C, pk(~ltkC) ) ▶₁ #i )
        case Register_pk
        by solve( SecretPSK( $A,
                             Expand(Expand(Extract('0', Extract(p_gxy, Extract(~res_psk, '0'))),
                                           <'clientats', 
                                            h(<
                                               <
                                                <
                                                 <
                                                  <
                                                   <
                                                    <'0', '1', '0x0303', p_nc, '0', $cipher_suites, '0', 
                                                     <'43', '0x0304'>, <'10', $g1, $g2>, <'40', $p_g, p_gx>, 
                                                     <'45', '0', '1'>, p_edi, '41', <~ticket, mask(x, x.1)>, 
                                                     hmac(<
                                                           Expand(Expand(Extract(~res_psk, '0'),
                                                                         <'ext', 'pbk'>, '32'),
                                                                  <'0', '0'>, '32'), 
                                                           h(<'0', '1', '0x0303', p_nc, '0', $cipher_suites, 
                                                              '0', <'43', '0x0304'>, <'10', $g1, $g2>, 
                                                              <'40', $p_g, p_gx>, <'45', '0', '1'>, p_edi, 
                                                              '41', <~ticket, mask(x, x.1)>, '0'>)
                                                          >)
                                                    >, 
                                                    '2', '0x0303', ~ns, $cipher_suite, <'13', $sig_algs>, 
                                                    '40', $p_g, $p_g^~y>, 
                                                   '8', $exts>, 
                                                  '13', '0', $certificate_extensions>, 
                                                 '11', '0', pk(~ltkS)>, 
                                                '15', 
                                                sign(<'server_cv', 
                                                      h(<
                                                         <
                                                          <
                                                           <
                                                            <'0', '1', '0x0303', p_nc, '0', $cipher_suites, 
                                                             '0', <'43', '0x0304'>, <'10', $g1, $g2>, 
                                                             <'40', $p_g, p_gx>, <'45', '0', '1'>, p_edi, 
                                                             '41', <~ticket, mask(x, x.1)>, 
                                                             hmac(<
                                                                   Expand(Expand(Extract(~res_psk, '0'),
                                                                                 <'ext', 'pbk'>, '32'),
                                                                          <'0', '0'>, '32'), 
                                                                   h(<'0', '1', '0x0303', p_nc, '0', 
                                                                      $cipher_suites, '0', <'43', '0x0304'>, 
                                                                      <'10', $g1, $g2>, <'40', $p_g, p_gx>, 
                                                                      <'45', '0', '1'>, p_edi, '41', 
                                                                      <~ticket, mask(x, x.1)>, '0'>)
                                                                  >)
                                                            >, 
                                                            '2', '0x0303', ~ns, $cipher_suite, 
                                                            <'13', $sig_algs>, '40', $p_g, $p_g^~y>, 
                                                           '8', $exts>, 
                                                          '13', '0', $certificate_extensions>, 
                                                         '11', '0', pk(~ltkS)>)
                                                     >,
                                                     ~ltkS)
                                               >, 
                                               '20', 
                                               hmac(<
                                                     Expand(Expand(Extract(p_gxy, Extract(~res_psk, '0')),
                                                                   <'serverhts', 
                                                                    h(<
                                                                       <
                                                                        <
                                                                         <
                                                                          <
                                                                           <'0', '1', '0x0303', p_nc, '0', 
                                                                            $cipher_suites, '0', 
                                                                            <'43', '0x0304'>, 
                                                                            <'10', $g1, $g2>, 
                                                                            <'40', $p_g, p_gx>, 
                                                                            <'45', '0', '1'>, p_edi, '41', 
                                                                            <~ticket, mask(x, x.1)>, 
                                                                            hmac(<
                                                                                  Expand(Expand(Extract(~res_psk,
                                                                                                        '0'),
                                                                                                <'ext', 'pbk'
                                                                                                >,
                                                                                                '32'),
                                                                                         <'0', '0'>, '32'), 
                                                                                  h(<'0', '1', '0x0303', 
                                                                                     p_nc, '0', 
                                                                                     $cipher_suites, '0', 
                                                                                     <'43', '0x0304'>, 
                                                                                     <'10', $g1, $g2>, 
                                                                                     <'40', $p_g, p_gx>, 
                                                                                     <'45', '0', '1'>, p_edi, 
                                                                                     '41', 
                                                                                     <~ticket, mask(x, x.1)>, 
                                                                                     '0'>)
                                                                                 >)
                                                                           >, 
                                                                           '2', '0x0303', ~ns, $cipher_suite, 
                                                                           <'13', $sig_algs>, '40', $p_g, 
                                                                           $p_g^~y>, 
                                                                          '8', $exts>, 
                                                                         '13', '0', $certificate_extensions>, 
                                                                        '11', '0', pk(~ltkS)>, 
                                                                       '15', 
                                                                       sign(<'server_cv', 
                                                                             h(<
                                                                                <
                                                                                 <
                                                                                  <
                                                                                   <'0', '1', '0x0303', p_nc, 
                                                                                    '0', $cipher_suites, '0', 
                                                                                    <'43', '0x0304'>, 
                                                                                    <'10', $g1, $g2>, 
                                                                                    <'40', $p_g, p_gx>, 
                                                                                    <'45', '0', '1'>, p_edi, 
                                                                                    '41', 
                                                                                    <~ticket, mask(x, x.1)>, 
                                                                                    hmac(<
                                                                                          Expand(Expand(Extract(~res_psk,
                                                                                                                '0'),
                                                                                                        <
                                                                                                         'ext', 
                                                                                                         'pbk'
                                                                                                        >,
                                                                                                        '32'),
                                                                                                 <'0', '0'>,
                                                                                                 '32'), 
                                                                                          h(<'0', '1', 
                                                                                             '0x0303', p_nc, 
                                                                                             '0', 
                                                                                             $cipher_suites, 
                                                                                             '0', 
                                                                                             <'43', '0x0304'
                                                                                             >, 
                                                                                             <'10', $g1, $g2
                                                                                             >, 
                                                                                             <'40', $p_g, p_gx
                                                                                             >, 
                                                                                             <'45', '0', '1'
                                                                                             >, 
                                                                                             p_edi, '41', 
                                                                                             <~ticket, 
                                                                                              mask(x, x.1)>, 
                                                                                             '0'>)
                                                                                         >)
                                                                                   >, 
                                                                                   '2', '0x0303', ~ns, 
                                                                                   $cipher_suite, 
                                                                                   <'13', $sig_algs>, '40', 
                                                                                   $p_g, $p_g^~y>, 
                                                                                  '8', $exts>, 
                                                                                 '13', '0', 
                                                                                 $certificate_extensions>, 
                                                                                '11', '0', pk(~ltkS)>)
                                                                            >,
                                                                            ~ltkS)
                                                                      >)
                                                                   >,
                                                                   '32'),
                                                            <'fin', '0'>, '32'), 
                                                     h(<
                                                        <
                                                         <
                                                          <
                                                           <
                                                            <'0', '1', '0x0303', p_nc, '0', $cipher_suites, 
                                                             '0', <'43', '0x0304'>, <'10', $g1, $g2>, 
                                                             <'40', $p_g, p_gx>, <'45', '0', '1'>, p_edi, 
                                                             '41', <~ticket, mask(x, x.1)>, 
                                                             hmac(<
                                                                   Expand(Expand(Extract(~res_psk, '0'),
                                                                                 <'ext', 'pbk'>, '32'),
                                                                          <'0', '0'>, '32'), 
                                                                   h(<'0', '1', '0x0303', p_nc, '0', 
                                                                      $cipher_suites, '0', <'43', '0x0304'>, 
                                                                      <'10', $g1, $g2>, <'40', $p_g, p_gx>, 
                                                                      <'45', '0', '1'>, p_edi, '41', 
                                                                      <~ticket, mask(x, x.1)>, '0'>)
                                                                  >)
                                                            >, 
                                                            '2', '0x0303', ~ns, $cipher_suite, 
                                                            <'13', $sig_algs>, '40', $p_g, $p_g^~y>, 
                                                           '8', $exts>, 
                                                          '13', '0', $certificate_extensions>, 
                                                         '11', '0', pk(~ltkS)>, 
                                                        '15', 
                                                        sign(<'server_cv', 
                                                              h(<
                                                                 <
                                                                  <
                                                                   <
                                                                    <'0', '1', '0x0303', p_nc, '0', 
                                                                     $cipher_suites, '0', <'43', '0x0304'>, 
                                                                     <'10', $g1, $g2>, <'40', $p_g, p_gx>, 
                                                                     <'45', '0', '1'>, p_edi, '41', 
                                                                     <~ticket, mask(x, x.1)>, 
                                                                     hmac(<
                                                                           Expand(Expand(Extract(~res_psk,
                                                                                                 '0'),
                                                                                         <'ext', 'pbk'>,
                                                                                         '32'),
                                                                                  <'0', '0'>, '32'), 
                                                                           h(<'0', '1', '0x0303', p_nc, '0', 
                                                                              $cipher_suites, '0', 
                                                                              <'43', '0x0304'>, 
                                                                              <'10', $g1, $g2>, 
                                                                              <'40', $p_g, p_gx>, 
                                                                              <'45', '0', '1'>, p_edi, '41', 
                                                                              <~ticket, mask(x, x.1)>, '0'>)
                                                                          >)
                                                                    >, 
                                                                    '2', '0x0303', ~ns, $cipher_suite, 
                                                                    <'13', $sig_algs>, '40', $p_g, $p_g^~y>, 
                                                                   '8', $exts>, 
                                                                  '13', '0', $certificate_extensions>, 
                                                                 '11', '0', pk(~ltkS)>)
                                                             >,
                                                             ~ltkS)
                                                       >)
                                                    >)
                                              >)
                                           >,
                                           '32'),
                                    <'adke_wk', '0'>, '32')
                  ) ▶₀ #l )
      qed
    next
      case server_auth_case_04
      solve( !Pk( $C, pk(~ltkC) ) ▶₁ #i )
        case Register_pk
        by solve( SecretPSK( $A,
                             Expand(Expand(Extract('0',
                                                   Extract(p_gxy,
                                                           Extract(Expand(ms, <'rms', h(messages)>, '32'),
                                                                   '0'))),
                                           <'clientats', 
                                            h(<
                                               <
                                                <
                                                 <
                                                  <
                                                   <
                                                    <'0', '1', '0x0303', p_nc, '0', $cipher_suites, '0', 
                                                     <'43', '0x0304'>, <'10', $g1, $g2>, <'40', $p_g, p_gx>, 
                                                     <'45', '0', '1'>, p_edi, '41', <~ticket, mask(x, x.1)>, 
                                                     hmac(<
                                                           Expand(Expand(Extract(Expand(ms,
                                                                                        <'rms', h(messages)>,
                                                                                        '32'),
                                                                                 '0'),
                                                                         <'res', 'pbk'>, '32'),
                                                                  <'0', '0'>, '32'), 
                                                           h(<'0', '1', '0x0303', p_nc, '0', $cipher_suites, 
                                                              '0', <'43', '0x0304'>, <'10', $g1, $g2>, 
                                                              <'40', $p_g, p_gx>, <'45', '0', '1'>, p_edi, 
                                                              '41', <~ticket, mask(x, x.1)>, '0'>)
                                                          >)
                                                    >, 
                                                    '2', '0x0303', ~ns, $cipher_suite, <'13', $sig_algs>, 
                                                    '40', $p_g, $p_g^~y>, 
                                                   '8', $exts>, 
                                                  '13', '0', $certificate_extensions>, 
                                                 '11', '0', pk(~ltkS)>, 
                                                '15', 
                                                sign(<'server_cv', 
                                                      h(<
                                                         <
                                                          <
                                                           <
                                                            <'0', '1', '0x0303', p_nc, '0', $cipher_suites, 
                                                             '0', <'43', '0x0304'>, <'10', $g1, $g2>, 
                                                             <'40', $p_g, p_gx>, <'45', '0', '1'>, p_edi, 
                                                             '41', <~ticket, mask(x, x.1)>, 
                                                             hmac(<
                                                                   Expand(Expand(Extract(Expand(ms,
                                                                                                <'rms', 
                                                                                                 h(messages)>,
                                                                                                '32'),
                                                                                         '0'),
                                                                                 <'res', 'pbk'>, '32'),
                                                                          <'0', '0'>, '32'), 
                                                                   h(<'0', '1', '0x0303', p_nc, '0', 
                                                                      $cipher_suites, '0', <'43', '0x0304'>, 
                                                                      <'10', $g1, $g2>, <'40', $p_g, p_gx>, 
                                                                      <'45', '0', '1'>, p_edi, '41', 
                                                                      <~ticket, mask(x, x.1)>, '0'>)
                                                                  >)
                                                            >, 
                                                            '2', '0x0303', ~ns, $cipher_suite, 
                                                            <'13', $sig_algs>, '40', $p_g, $p_g^~y>, 
                                                           '8', $exts>, 
                                                          '13', '0', $certificate_extensions>, 
                                                         '11', '0', pk(~ltkS)>)
                                                     >,
                                                     ~ltkS)
                                               >, 
                                               '20', 
                                               hmac(<
                                                     Expand(Expand(Extract(p_gxy,
                                                                           Extract(Expand(ms,
                                                                                          <'rms', h(messages)
                                                                                          >,
                                                                                          '32'),
                                                                                   '0')),
                                                                   <'serverhts', 
                                                                    h(<
                                                                       <
                                                                        <
                                                                         <
                                                                          <
                                                                           <'0', '1', '0x0303', p_nc, '0', 
                                                                            $cipher_suites, '0', 
                                                                            <'43', '0x0304'>, 
                                                                            <'10', $g1, $g2>, 
                                                                            <'40', $p_g, p_gx>, 
                                                                            <'45', '0', '1'>, p_edi, '41', 
                                                                            <~ticket, mask(x, x.1)>, 
                                                                            hmac(<
                                                                                  Expand(Expand(Extract(Expand(ms,
                                                                                                               <
                                                                                                                'rms', 
                                                                                                                h(messages)
                                                                                                               >,
                                                                                                               '32'),
                                                                                                        '0'),
                                                                                                <'res', 'pbk'
                                                                                                >,
                                                                                                '32'),
                                                                                         <'0', '0'>, '32'), 
                                                                                  h(<'0', '1', '0x0303', 
                                                                                     p_nc, '0', 
                                                                                     $cipher_suites, '0', 
                                                                                     <'43', '0x0304'>, 
                                                                                     <'10', $g1, $g2>, 
                                                                                     <'40', $p_g, p_gx>, 
                                                                                     <'45', '0', '1'>, p_edi, 
                                                                                     '41', 
                                                                                     <~ticket, mask(x, x.1)>, 
                                                                                     '0'>)
                                                                                 >)
                                                                           >, 
                                                                           '2', '0x0303', ~ns, $cipher_suite, 
                                                                           <'13', $sig_algs>, '40', $p_g, 
                                                                           $p_g^~y>, 
                                                                          '8', $exts>, 
                                                                         '13', '0', $certificate_extensions>, 
                                                                        '11', '0', pk(~ltkS)>, 
                                                                       '15', 
                                                                       sign(<'server_cv', 
                                                                             h(<
                                                                                <
                                                                                 <
                                                                                  <
                                                                                   <'0', '1', '0x0303', p_nc, 
                                                                                    '0', $cipher_suites, '0', 
                                                                                    <'43', '0x0304'>, 
                                                                                    <'10', $g1, $g2>, 
                                                                                    <'40', $p_g, p_gx>, 
                                                                                    <'45', '0', '1'>, p_edi, 
                                                                                    '41', 
                                                                                    <~ticket, mask(x, x.1)>, 
                                                                                    hmac(<
                                                                                          Expand(Expand(Extract(Expand(ms,
                                                                                                                       <
                                                                                                                        'rms', 
                                                                                                                        h(messages)
                                                                                                                       >,
                                                                                                                       '32'),
                                                                                                                '0'),
                                                                                                        <
                                                                                                         'res', 
                                                                                                         'pbk'
                                                                                                        >,
                                                                                                        '32'),
                                                                                                 <'0', '0'>,
                                                                                                 '32'), 
                                                                                          h(<'0', '1', 
                                                                                             '0x0303', p_nc, 
                                                                                             '0', 
                                                                                             $cipher_suites, 
                                                                                             '0', 
                                                                                             <'43', '0x0304'
                                                                                             >, 
                                                                                             <'10', $g1, $g2
                                                                                             >, 
                                                                                             <'40', $p_g, p_gx
                                                                                             >, 
                                                                                             <'45', '0', '1'
                                                                                             >, 
                                                                                             p_edi, '41', 
                                                                                             <~ticket, 
                                                                                              mask(x, x.1)>, 
                                                                                             '0'>)
                                                                                         >)
                                                                                   >, 
                                                                                   '2', '0x0303', ~ns, 
                                                                                   $cipher_suite, 
                                                                                   <'13', $sig_algs>, '40', 
                                                                                   $p_g, $p_g^~y>, 
                                                                                  '8', $exts>, 
                                                                                 '13', '0', 
                                                                                 $certificate_extensions>, 
                                                                                '11', '0', pk(~ltkS)>)
                                                                            >,
                                                                            ~ltkS)
                                                                      >)
                                                                   >,
                                                                   '32'),
                                                            <'fin', '0'>, '32'), 
                                                     h(<
                                                        <
                                                         <
                                                          <
                                                           <
                                                            <'0', '1', '0x0303', p_nc, '0', $cipher_suites, 
                                                             '0', <'43', '0x0304'>, <'10', $g1, $g2>, 
                                                             <'40', $p_g, p_gx>, <'45', '0', '1'>, p_edi, 
                                                             '41', <~ticket, mask(x, x.1)>, 
                                                             hmac(<
                                                                   Expand(Expand(Extract(Expand(ms,
                                                                                                <'rms', 
                                                                                                 h(messages)>,
                                                                                                '32'),
                                                                                         '0'),
                                                                                 <'res', 'pbk'>, '32'),
                                                                          <'0', '0'>, '32'), 
                                                                   h(<'0', '1', '0x0303', p_nc, '0', 
                                                                      $cipher_suites, '0', <'43', '0x0304'>, 
                                                                      <'10', $g1, $g2>, <'40', $p_g, p_gx>, 
                                                                      <'45', '0', '1'>, p_edi, '41', 
                                                                      <~ticket, mask(x, x.1)>, '0'>)
                                                                  >)
                                                            >, 
                                                            '2', '0x0303', ~ns, $cipher_suite, 
                                                            <'13', $sig_algs>, '40', $p_g, $p_g^~y>, 
                                                           '8', $exts>, 
                                                          '13', '0', $certificate_extensions>, 
                                                         '11', '0', pk(~ltkS)>, 
                                                        '15', 
                                                        sign(<'server_cv', 
                                                              h(<
                                                                 <
                                                                  <
                                                                   <
                                                                    <'0', '1', '0x0303', p_nc, '0', 
                                                                     $cipher_suites, '0', <'43', '0x0304'>, 
                                                                     <'10', $g1, $g2>, <'40', $p_g, p_gx>, 
                                                                     <'45', '0', '1'>, p_edi, '41', 
                                                                     <~ticket, mask(x, x.1)>, 
                                                                     hmac(<
                                                                           Expand(Expand(Extract(Expand(ms,
                                                                                                        <
                                                                                                         'rms', 
                                                                                                         h(messages)
                                                                                                        >,
                                                                                                        '32'),
                                                                                                 '0'),
                                                                                         <'res', 'pbk'>,
                                                                                         '32'),
                                                                                  <'0', '0'>, '32'), 
                                                                           h(<'0', '1', '0x0303', p_nc, '0', 
                                                                              $cipher_suites, '0', 
                                                                              <'43', '0x0304'>, 
                                                                              <'10', $g1, $g2>, 
                                                                              <'40', $p_g, p_gx>, 
                                                                              <'45', '0', '1'>, p_edi, '41', 
                                                                              <~ticket, mask(x, x.1)>, '0'>)
                                                                          >)
                                                                    >, 
                                                                    '2', '0x0303', ~ns, $cipher_suite, 
                                                                    <'13', $sig_algs>, '40', $p_g, $p_g^~y>, 
                                                                   '8', $exts>, 
                                                                  '13', '0', $certificate_extensions>, 
                                                                 '11', '0', pk(~ltkS)>)
                                                             >,
                                                             ~ltkS)
                                                       >)
                                                    >)
                                              >)
                                           >,
                                           '32'),
                                    <'adke_wk', '0'>, '32')
                  ) ▶₀ #l )
      qed
    next
      case server_auth_case_05
      solve( !Pk( $C, pk(~ltkC) ) ▶₁ #i )
        case Register_pk
        by solve( SecretPSK( $A,
                             Expand(Expand(Extract('0', Extract(p_gxy, Extract(~res_psk, '0'))),
                                           <'clientats', 
                                            h(<
                                               <
                                                <
                                                 <
                                                  <
                                                   <
                                                    <<p_messages, '6', '0x0303', '40', $p_g>, '1', '0x0303', 
                                                     p_nc, '0', $cipher_suites, '0', <'43', '0x0304'>, 
                                                     <'10', $g1, $g2>, <'40', $p_g, p_gx>, <'45', '0', '1'>, 
                                                     p_edi, '41', <~ticket, mask(x, x.1)>, 
                                                     hmac(<
                                                           Expand(Expand(Extract(~res_psk, '0'),
                                                                         <'ext', 'pbk'>, '32'),
                                                                  <'0', '0'>, '32'), 
                                                           h(<<p_messages, '6', '0x0303', '40', $p_g>, '1', 
                                                              '0x0303', p_nc, '0', $cipher_suites, '0', 
                                                              <'43', '0x0304'>, <'10', $g1, $g2>, 
                                                              <'40', $p_g, p_gx>, <'45', '0', '1'>, p_edi, 
                                                              '41', <~ticket, mask(x, x.1)>, '0'>)
                                                          >)
                                                    >, 
                                                    '2', '0x0303', ~ns, $cipher_suite, <'13', $sig_algs>, 
                                                    '40', $p_g, $p_g^~y>, 
                                                   '8', $exts>, 
                                                  '13', '0', $certificate_extensions>, 
                                                 '11', '0', pk(~ltkS)>, 
                                                '15', 
                                                sign(<'server_cv', 
                                                      h(<
                                                         <
                                                          <
                                                           <
                                                            <<p_messages, '6', '0x0303', '40', $p_g>, '1', 
                                                             '0x0303', p_nc, '0', $cipher_suites, '0', 
                                                             <'43', '0x0304'>, <'10', $g1, $g2>, 
                                                             <'40', $p_g, p_gx>, <'45', '0', '1'>, p_edi, 
                                                             '41', <~ticket, mask(x, x.1)>, 
                                                             hmac(<
                                                                   Expand(Expand(Extract(~res_psk, '0'),
                                                                                 <'ext', 'pbk'>, '32'),
                                                                          <'0', '0'>, '32'), 
                                                                   h(<
                                                                      <p_messages, '6', '0x0303', '40', $p_g
                                                                      >, 
                                                                      '1', '0x0303', p_nc, '0', 
                                                                      $cipher_suites, '0', <'43', '0x0304'>, 
                                                                      <'10', $g1, $g2>, <'40', $p_g, p_gx>, 
                                                                      <'45', '0', '1'>, p_edi, '41', 
                                                                      <~ticket, mask(x, x.1)>, '0'>)
                                                                  >)
                                                            >, 
                                                            '2', '0x0303', ~ns, $cipher_suite, 
                                                            <'13', $sig_algs>, '40', $p_g, $p_g^~y>, 
                                                           '8', $exts>, 
                                                          '13', '0', $certificate_extensions>, 
                                                         '11', '0', pk(~ltkS)>)
                                                     >,
                                                     ~ltkS)
                                               >, 
                                               '20', 
                                               hmac(<
                                                     Expand(Expand(Extract(p_gxy, Extract(~res_psk, '0')),
                                                                   <'serverhts', 
                                                                    h(<
                                                                       <
                                                                        <
                                                                         <
                                                                          <
                                                                           <
                                                                            <p_messages, '6', '0x0303', '40', 
                                                                             $p_g>, 
                                                                            '1', '0x0303', p_nc, '0', 
                                                                            $cipher_suites, '0', 
                                                                            <'43', '0x0304'>, 
                                                                            <'10', $g1, $g2>, 
                                                                            <'40', $p_g, p_gx>, 
                                                                            <'45', '0', '1'>, p_edi, '41', 
                                                                            <~ticket, mask(x, x.1)>, 
                                                                            hmac(<
                                                                                  Expand(Expand(Extract(~res_psk,
                                                                                                        '0'),
                                                                                                <'ext', 'pbk'
                                                                                                >,
                                                                                                '32'),
                                                                                         <'0', '0'>, '32'), 
                                                                                  h(<
                                                                                     <p_messages, '6', 
                                                                                      '0x0303', '40', $p_g>, 
                                                                                     '1', '0x0303', p_nc, 
                                                                                     '0', $cipher_suites, 
                                                                                     '0', <'43', '0x0304'>, 
                                                                                     <'10', $g1, $g2>, 
                                                                                     <'40', $p_g, p_gx>, 
                                                                                     <'45', '0', '1'>, p_edi, 
                                                                                     '41', 
                                                                                     <~ticket, mask(x, x.1)>, 
                                                                                     '0'>)
                                                                                 >)
                                                                           >, 
                                                                           '2', '0x0303', ~ns, $cipher_suite, 
                                                                           <'13', $sig_algs>, '40', $p_g, 
                                                                           $p_g^~y>, 
                                                                          '8', $exts>, 
                                                                         '13', '0', $certificate_extensions>, 
                                                                        '11', '0', pk(~ltkS)>, 
                                                                       '15', 
                                                                       sign(<'server_cv', 
                                                                             h(<
                                                                                <
                                                                                 <
                                                                                  <
                                                                                   <
                                                                                    <p_messages, '6', 
                                                                                     '0x0303', '40', $p_g>, 
                                                                                    '1', '0x0303', p_nc, '0', 
                                                                                    $cipher_suites, '0', 
                                                                                    <'43', '0x0304'>, 
                                                                                    <'10', $g1, $g2>, 
                                                                                    <'40', $p_g, p_gx>, 
                                                                                    <'45', '0', '1'>, p_edi, 
                                                                                    '41', 
                                                                                    <~ticket, mask(x, x.1)>, 
                                                                                    hmac(<
                                                                                          Expand(Expand(Extract(~res_psk,
                                                                                                                '0'),
                                                                                                        <
                                                                                                         'ext', 
                                                                                                         'pbk'
                                                                                                        >,
                                                                                                        '32'),
                                                                                                 <'0', '0'>,
                                                                                                 '32'), 
                                                                                          h(<
                                                                                             <p_messages, 
                                                                                              '6', '0x0303', 
                                                                                              '40', $p_g>, 
                                                                                             '1', '0x0303', 
                                                                                             p_nc, '0', 
                                                                                             $cipher_suites, 
                                                                                             '0', 
                                                                                             <'43', '0x0304'
                                                                                             >, 
                                                                                             <'10', $g1, $g2
                                                                                             >, 
                                                                                             <'40', $p_g, p_gx
                                                                                             >, 
                                                                                             <'45', '0', '1'
                                                                                             >, 
                                                                                             p_edi, '41', 
                                                                                             <~ticket, 
                                                                                              mask(x, x.1)>, 
                                                                                             '0'>)
                                                                                         >)
                                                                                   >, 
                                                                                   '2', '0x0303', ~ns, 
                                                                                   $cipher_suite, 
                                                                                   <'13', $sig_algs>, '40', 
                                                                                   $p_g, $p_g^~y>, 
                                                                                  '8', $exts>, 
                                                                                 '13', '0', 
                                                                                 $certificate_extensions>, 
                                                                                '11', '0', pk(~ltkS)>)
                                                                            >,
                                                                            ~ltkS)
                                                                      >)
                                                                   >,
                                                                   '32'),
                                                            <'fin', '0'>, '32'), 
                                                     h(<
                                                        <
                                                         <
                                                          <
                                                           <
                                                            <<p_messages, '6', '0x0303', '40', $p_g>, '1', 
                                                             '0x0303', p_nc, '0', $cipher_suites, '0', 
                                                             <'43', '0x0304'>, <'10', $g1, $g2>, 
                                                             <'40', $p_g, p_gx>, <'45', '0', '1'>, p_edi, 
                                                             '41', <~ticket, mask(x, x.1)>, 
                                                             hmac(<
                                                                   Expand(Expand(Extract(~res_psk, '0'),
                                                                                 <'ext', 'pbk'>, '32'),
                                                                          <'0', '0'>, '32'), 
                                                                   h(<
                                                                      <p_messages, '6', '0x0303', '40', $p_g
                                                                      >, 
                                                                      '1', '0x0303', p_nc, '0', 
                                                                      $cipher_suites, '0', <'43', '0x0304'>, 
                                                                      <'10', $g1, $g2>, <'40', $p_g, p_gx>, 
                                                                      <'45', '0', '1'>, p_edi, '41', 
                                                                      <~ticket, mask(x, x.1)>, '0'>)
                                                                  >)
                                                            >, 
                                                            '2', '0x0303', ~ns, $cipher_suite, 
                                                            <'13', $sig_algs>, '40', $p_g, $p_g^~y>, 
                                                           '8', $exts>, 
                                                          '13', '0', $certificate_extensions>, 
                                                         '11', '0', pk(~ltkS)>, 
                                                        '15', 
                                                        sign(<'server_cv', 
                                                              h(<
                                                                 <
                                                                  <
                                                                   <
                                                                    <<p_messages, '6', '0x0303', '40', $p_g>, 
                                                                     '1', '0x0303', p_nc, '0', 
                                                                     $cipher_suites, '0', <'43', '0x0304'>, 
                                                                     <'10', $g1, $g2>, <'40', $p_g, p_gx>, 
                                                                     <'45', '0', '1'>, p_edi, '41', 
                                                                     <~ticket, mask(x, x.1)>, 
                                                                     hmac(<
                                                                           Expand(Expand(Extract(~res_psk,
                                                                                                 '0'),
                                                                                         <'ext', 'pbk'>,
                                                                                         '32'),
                                                                                  <'0', '0'>, '32'), 
                                                                           h(<
                                                                              <p_messages, '6', '0x0303', 
                                                                               '40', $p_g>, 
                                                                              '1', '0x0303', p_nc, '0', 
                                                                              $cipher_suites, '0', 
                                                                              <'43', '0x0304'>, 
                                                                              <'10', $g1, $g2>, 
                                                                              <'40', $p_g, p_gx>, 
                                                                              <'45', '0', '1'>, p_edi, '41', 
                                                                              <~ticket, mask(x, x.1)>, '0'>)
                                                                          >)
                                                                    >, 
                                                                    '2', '0x0303', ~ns, $cipher_suite, 
                                                                    <'13', $sig_algs>, '40', $p_g, $p_g^~y>, 
                                                                   '8', $exts>, 
                                                                  '13', '0', $certificate_extensions>, 
                                                                 '11', '0', pk(~ltkS)>)
                                                             >,
                                                             ~ltkS)
                                                       >)
                                                    >)
                                              >)
                                           >,
                                           '32'),
                                    <'adke_wk', '0'>, '32')
                  ) ▶₀ #l )
      qed
    next
      case server_auth_case_06
      solve( !Pk( $C, pk(~ltkC) ) ▶₁ #i )
        case Register_pk
        by solve( SecretPSK( $A,
                             Expand(Expand(Extract('0',
                                                   Extract(p_gxy,
                                                           Extract(Expand(ms, <'rms', h(messages)>, '32'),
                                                                   '0'))),
                                           <'clientats', 
                                            h(<
                                               <
                                                <
                                                 <
                                                  <
                                                   <
                                                    <<p_messages, '6', '0x0303', '40', $p_g>, '1', '0x0303', 
                                                     p_nc, '0', $cipher_suites, '0', <'43', '0x0304'>, 
                                                     <'10', $g1, $g2>, <'40', $p_g, p_gx>, <'45', '0', '1'>, 
                                                     p_edi, '41', <~ticket, mask(x, x.1)>, 
                                                     hmac(<
                                                           Expand(Expand(Extract(Expand(ms,
                                                                                        <'rms', h(messages)>,
                                                                                        '32'),
                                                                                 '0'),
                                                                         <'res', 'pbk'>, '32'),
                                                                  <'0', '0'>, '32'), 
                                                           h(<<p_messages, '6', '0x0303', '40', $p_g>, '1', 
                                                              '0x0303', p_nc, '0', $cipher_suites, '0', 
                                                              <'43', '0x0304'>, <'10', $g1, $g2>, 
                                                              <'40', $p_g, p_gx>, <'45', '0', '1'>, p_edi, 
                                                              '41', <~ticket, mask(x, x.1)>, '0'>)
                                                          >)
                                                    >, 
                                                    '2', '0x0303', ~ns, $cipher_suite, <'13', $sig_algs>, 
                                                    '40', $p_g, $p_g^~y>, 
                                                   '8', $exts>, 
                                                  '13', '0', $certificate_extensions>, 
                                                 '11', '0', pk(~ltkS)>, 
                                                '15', 
                                                sign(<'server_cv', 
                                                      h(<
                                                         <
                                                          <
                                                           <
                                                            <<p_messages, '6', '0x0303', '40', $p_g>, '1', 
                                                             '0x0303', p_nc, '0', $cipher_suites, '0', 
                                                             <'43', '0x0304'>, <'10', $g1, $g2>, 
                                                             <'40', $p_g, p_gx>, <'45', '0', '1'>, p_edi, 
                                                             '41', <~ticket, mask(x, x.1)>, 
                                                             hmac(<
                                                                   Expand(Expand(Extract(Expand(ms,
                                                                                                <'rms', 
                                                                                                 h(messages)>,
                                                                                                '32'),
                                                                                         '0'),
                                                                                 <'res', 'pbk'>, '32'),
                                                                          <'0', '0'>, '32'), 
                                                                   h(<
                                                                      <p_messages, '6', '0x0303', '40', $p_g
                                                                      >, 
                                                                      '1', '0x0303', p_nc, '0', 
                                                                      $cipher_suites, '0', <'43', '0x0304'>, 
                                                                      <'10', $g1, $g2>, <'40', $p_g, p_gx>, 
                                                                      <'45', '0', '1'>, p_edi, '41', 
                                                                      <~ticket, mask(x, x.1)>, '0'>)
                                                                  >)
                                                            >, 
                                                            '2', '0x0303', ~ns, $cipher_suite, 
                                                            <'13', $sig_algs>, '40', $p_g, $p_g^~y>, 
                                                           '8', $exts>, 
                                                          '13', '0', $certificate_extensions>, 
                                                         '11', '0', pk(~ltkS)>)
                                                     >,
                                                     ~ltkS)
                                               >, 
                                               '20', 
                                               hmac(<
                                                     Expand(Expand(Extract(p_gxy,
                                                                           Extract(Expand(ms,
                                                                                          <'rms', h(messages)
                                                                                          >,
                                                                                          '32'),
                                                                                   '0')),
                                                                   <'serverhts', 
                                                                    h(<
                                                                       <
                                                                        <
                                                                         <
                                                                          <
                                                                           <
                                                                            <p_messages, '6', '0x0303', '40', 
                                                                             $p_g>, 
                                                                            '1', '0x0303', p_nc, '0', 
                                                                            $cipher_suites, '0', 
                                                                            <'43', '0x0304'>, 
                                                                            <'10', $g1, $g2>, 
                                                                            <'40', $p_g, p_gx>, 
                                                                            <'45', '0', '1'>, p_edi, '41', 
                                                                            <~ticket, mask(x, x.1)>, 
                                                                            hmac(<
                                                                                  Expand(Expand(Extract(Expand(ms,
                                                                                                               <
                                                                                                                'rms', 
                                                                                                                h(messages)
                                                                                                               >,
                                                                                                               '32'),
                                                                                                        '0'),
                                                                                                <'res', 'pbk'
                                                                                                >,
                                                                                                '32'),
                                                                                         <'0', '0'>, '32'), 
                                                                                  h(<
                                                                                     <p_messages, '6', 
                                                                                      '0x0303', '40', $p_g>, 
                                                                                     '1', '0x0303', p_nc, 
                                                                                     '0', $cipher_suites, 
                                                                                     '0', <'43', '0x0304'>, 
                                                                                     <'10', $g1, $g2>, 
                                                                                     <'40', $p_g, p_gx>, 
                                                                                     <'45', '0', '1'>, p_edi, 
                                                                                     '41', 
                                                                                     <~ticket, mask(x, x.1)>, 
                                                                                     '0'>)
                                                                                 >)
                                                                           >, 
                                                                           '2', '0x0303', ~ns, $cipher_suite, 
                                                                           <'13', $sig_algs>, '40', $p_g, 
                                                                           $p_g^~y>, 
                                                                          '8', $exts>, 
                                                                         '13', '0', $certificate_extensions>, 
                                                                        '11', '0', pk(~ltkS)>, 
                                                                       '15', 
                                                                       sign(<'server_cv', 
                                                                             h(<
                                                                                <
                                                                                 <
                                                                                  <
                                                                                   <
                                                                                    <p_messages, '6', 
                                                                                     '0x0303', '40', $p_g>, 
                                                                                    '1', '0x0303', p_nc, '0', 
                                                                                    $cipher_suites, '0', 
                                                                                    <'43', '0x0304'>, 
                                                                                    <'10', $g1, $g2>, 
                                                                                    <'40', $p_g, p_gx>, 
                                                                                    <'45', '0', '1'>, p_edi, 
                                                                                    '41', 
                                                                                    <~ticket, mask(x, x.1)>, 
                                                                                    hmac(<
                                                                                          Expand(Expand(Extract(Expand(ms,
                                                                                                                       <
                                                                                                                        'rms', 
                                                                                                                        h(messages)
                                                                                                                       >,
                                                                                                                       '32'),
                                                                                                                '0'),
                                                                                                        <
                                                                                                         'res', 
                                                                                                         'pbk'
                                                                                                        >,
                                                                                                        '32'),
                                                                                                 <'0', '0'>,
                                                                                                 '32'), 
                                                                                          h(<
                                                                                             <p_messages, 
                                                                                              '6', '0x0303', 
                                                                                              '40', $p_g>, 
                                                                                             '1', '0x0303', 
                                                                                             p_nc, '0', 
                                                                                             $cipher_suites, 
                                                                                             '0', 
                                                                                             <'43', '0x0304'
                                                                                             >, 
                                                                                             <'10', $g1, $g2
                                                                                             >, 
                                                                                             <'40', $p_g, p_gx
                                                                                             >, 
                                                                                             <'45', '0', '1'
                                                                                             >, 
                                                                                             p_edi, '41', 
                                                                                             <~ticket, 
                                                                                              mask(x, x.1)>, 
                                                                                             '0'>)
                                                                                         >)
                                                                                   >, 
                                                                                   '2', '0x0303', ~ns, 
                                                                                   $cipher_suite, 
                                                                                   <'13', $sig_algs>, '40', 
                                                                                   $p_g, $p_g^~y>, 
                                                                                  '8', $exts>, 
                                                                                 '13', '0', 
                                                                                 $certificate_extensions>, 
                                                                                '11', '0', pk(~ltkS)>)
                                                                            >,
                                                                            ~ltkS)
                                                                      >)
                                                                   >,
                                                                   '32'),
                                                            <'fin', '0'>, '32'), 
                                                     h(<
                                                        <
                                                         <
                                                          <
                                                           <
                                                            <<p_messages, '6', '0x0303', '40', $p_g>, '1', 
                                                             '0x0303', p_nc, '0', $cipher_suites, '0', 
                                                             <'43', '0x0304'>, <'10', $g1, $g2>, 
                                                             <'40', $p_g, p_gx>, <'45', '0', '1'>, p_edi, 
                                                             '41', <~ticket, mask(x, x.1)>, 
                                                             hmac(<
                                                                   Expand(Expand(Extract(Expand(ms,
                                                                                                <'rms', 
                                                                                                 h(messages)>,
                                                                                                '32'),
                                                                                         '0'),
                                                                                 <'res', 'pbk'>, '32'),
                                                                          <'0', '0'>, '32'), 
                                                                   h(<
                                                                      <p_messages, '6', '0x0303', '40', $p_g
                                                                      >, 
                                                                      '1', '0x0303', p_nc, '0', 
                                                                      $cipher_suites, '0', <'43', '0x0304'>, 
                                                                      <'10', $g1, $g2>, <'40', $p_g, p_gx>, 
                                                                      <'45', '0', '1'>, p_edi, '41', 
                                                                      <~ticket, mask(x, x.1)>, '0'>)
                                                                  >)
                                                            >, 
                                                            '2', '0x0303', ~ns, $cipher_suite, 
                                                            <'13', $sig_algs>, '40', $p_g, $p_g^~y>, 
                                                           '8', $exts>, 
                                                          '13', '0', $certificate_extensions>, 
                                                         '11', '0', pk(~ltkS)>, 
                                                        '15', 
                                                        sign(<'server_cv', 
                                                              h(<
                                                                 <
                                                                  <
                                                                   <
                                                                    <<p_messages, '6', '0x0303', '40', $p_g>, 
                                                                     '1', '0x0303', p_nc, '0', 
                                                                     $cipher_suites, '0', <'43', '0x0304'>, 
                                                                     <'10', $g1, $g2>, <'40', $p_g, p_gx>, 
                                                                     <'45', '0', '1'>, p_edi, '41', 
                                                                     <~ticket, mask(x, x.1)>, 
                                                                     hmac(<
                                                                           Expand(Expand(Extract(Expand(ms,
                                                                                                        <
                                                                                                         'rms', 
                                                                                                         h(messages)
                                                                                                        >,
                                                                                                        '32'),
                                                                                                 '0'),
                                                                                         <'res', 'pbk'>,
                                                                                         '32'),
                                                                                  <'0', '0'>, '32'), 
                                                                           h(<
                                                                              <p_messages, '6', '0x0303', 
                                                                               '40', $p_g>, 
                                                                              '1', '0x0303', p_nc, '0', 
                                                                              $cipher_suites, '0', 
                                                                              <'43', '0x0304'>, 
                                                                              <'10', $g1, $g2>, 
                                                                              <'40', $p_g, p_gx>, 
                                                                              <'45', '0', '1'>, p_edi, '41', 
                                                                              <~ticket, mask(x, x.1)>, '0'>)
                                                                          >)
                                                                    >, 
                                                                    '2', '0x0303', ~ns, $cipher_suite, 
                                                                    <'13', $sig_algs>, '40', $p_g, $p_g^~y>, 
                                                                   '8', $exts>, 
                                                                  '13', '0', $certificate_extensions>, 
                                                                 '11', '0', pk(~ltkS)>)
                                                             >,
                                                             ~ltkS)
                                                       >)
                                                    >)
                                              >)
                                           >,
                                           '32'),
                                    <'adke_wk', '0'>, '32')
                  ) ▶₀ #l )
      qed
    next
      case server_auth_case_07
      by contradiction /* from formulas */
    next
      case server_auth_case_08
      by contradiction /* from formulas */
    next
      case server_auth_case_09
      by contradiction /* from formulas */
    next
      case server_auth_case_10
      by contradiction /* from formulas */
    next
      case server_auth_case_11
      by contradiction /* from formulas */
    next
      case server_auth_case_12
      by contradiction /* from formulas */
    qed
  qed
qed

lemma pfs_handshake_secret [reuse, hide_lemma=posths_rms_weak]:
  all-traces
  "∀ tid actor peer role hs aas psk_ke_mode #i #k.
    (((((CHS( tid, actor, role, hs ) @ #i) ∧
        (RMode( tid, actor, role, psk_ke_mode ) @ #i)) ∧
       (CIdentity( tid, actor, role, <peer, aas, 'auth'> ) @ #i)) ∧
      (!KU( hs ) @ #k)) ∧
     (¬(psk_ke_mode = '0'))) ⇒
    (((((∃ #r. (RevLtk( peer ) @ #r) ∧ (#r < #i)) ∨
        (∃ tid3 x #r. (RevDHExp( tid3, peer, x ) @ #r) ∧ (#r < #i))) ∨
       (∃ tid4 y #r. (RevDHExp( tid4, actor, y ) @ #r) ∧ (#r < #i))) ∨
      (∃ rms #r. (RevealPSK( actor, rms ) @ #r) ∧ (#r < #i))) ∨
     (∃ rms #r. (RevealPSK( peer, rms ) @ #r) ∧ (#r < #i)))"
/*
guarded formula characterizing all counter-examples:
"∃ tid actor peer role hs aas psk_ke_mode #i #k.
  (CHS( tid, actor, role, hs ) @ #i) ∧
  (RMode( tid, actor, role, psk_ke_mode ) @ #i) ∧
  (CIdentity( tid, actor, role, <peer, aas, 'auth'> ) @ #i) ∧
  (!KU( hs ) @ #k)
 ∧
  (¬(psk_ke_mode = '0')) ∧
  (∀ #r. (RevLtk( peer ) @ #r) ⇒ ¬(#r < #i)) ∧
  (∀ tid3 x #r. (RevDHExp( tid3, peer, x ) @ #r) ⇒ ¬(#r < #i)) ∧
  (∀ tid4 y #r. (RevDHExp( tid4, actor, y ) @ #r) ⇒ ¬(#r < #i)) ∧
  (∀ rms #r. (RevealPSK( actor, rms ) @ #r) ⇒ ¬(#r < #i)) ∧
  (∀ rms #r. (RevealPSK( peer, rms ) @ #r) ⇒ ¬(#r < #i))"
*/
by sorry

lemma secret_session_keys_pfs [hide_lemma=sig_origin,
                               hide_lemma=posths_rms]:
  all-traces
  "∀ tid actor peer role kw kr pas psk_ke_mode #i.
    ((((((((SessionKey( tid, actor, peer, <pas, 'auth'>, <kw, kr> ) @ #i) ∧
           (RMode( tid, actor, role, psk_ke_mode ) @ #i)) ∧
          (¬(∃ #r. (RevLtk( peer ) @ #r) ∧ (#r < #i)))) ∧
         (¬(∃ tid3 x #r. (RevDHExp( tid3, peer, x ) @ #r) ∧ (#r < #i)))) ∧
        (¬(∃ tid4 y #r. (RevDHExp( tid4, actor, y ) @ #r) ∧ (#r < #i)))) ∧
       (¬(∃ rms #r. (RevealPSK( actor, rms ) @ #r) ∧ (#r < #i)))) ∧
      (¬(∃ rms #r. (RevealPSK( peer, rms ) @ #r) ∧ (#r < #i)))) ∧
     (¬(psk_ke_mode = '0'))) ⇒
    (¬(∃ #j. K( kr ) @ #j))"
/*
guarded formula characterizing all counter-examples:
"∃ tid actor peer role kw kr pas psk_ke_mode #i.
  (SessionKey( tid, actor, peer, <pas, 'auth'>, <kw, kr> ) @ #i) ∧
  (RMode( tid, actor, role, psk_ke_mode ) @ #i)
 ∧
  (∀ #r. (RevLtk( peer ) @ #r) ⇒ ¬(#r < #i)) ∧
  (∀ tid3 x #r. (RevDHExp( tid3, peer, x ) @ #r) ⇒ ¬(#r < #i)) ∧
  (∀ tid4 y #r. (RevDHExp( tid4, actor, y ) @ #r) ⇒ ¬(#r < #i)) ∧
  (∀ rms #r. (RevealPSK( actor, rms ) @ #r) ⇒ ¬(#r < #i)) ∧
  (∀ rms #r. (RevealPSK( peer, rms ) @ #r) ⇒ ¬(#r < #i)) ∧
  (¬(psk_ke_mode = '0')) ∧
  (∃ #j. (K( kr ) @ #j))"
*/
simplify
solve( SessionKey( tid, actor, peer, <pas, 'auth'>, <kw, kr> ) @ #i )
  case client_auth
  solve( (∃ #j. (!KU( p_sats ) @ #j) ∧ #j < #vk)  ∥
         ((∀ #k. (!KU( p_sats ) @ #k) ⇒ ¬(#k < #vk)) ∧
          (∃ actor #l.
            (RevealPSK( actor, Expand(p_sats, <'adke_wk', '0'>, '32') ) @ #l)
           ∧
            #l < #vk)) )
    case case_1
    solve( F_State_C3( ~tid, $C, $S, p_res_psk, p_messages, p_nc, p_ns, p_g,
                       p_sg, p_hrr, p_x, p_y, p_gx, p_gy, p_gxy, p_psk_ke_mode, p_psk_id, p_edi,
                       p_es, p_hs, Extract('0', p_hs), p_cats, p_sats, p_hs_keyc, p_hs_keys,
                       <pas, 'auth'>, p_ems, p_rms, '0'
           ) ▶₀ #i )
      case recv_server_auth_case_01
      solve( (∃ #j.2.
               (!KU( Extract('0', Extract(p_gxy, Extract('0', '0'))) ) @ #j.2)
              ∧
               #j.2 < #j.1)  ∥
             ((∀ #k.
                (!KU( Extract('0', Extract(p_gxy, Extract('0', '0'))) ) @ #k)
               ⇒
                ¬(#k < #j.1)) ∧
              (∃ actor #l.
                (RevealPSK( actor,
                            Expand(Extract('0', Extract(p_gxy, Extract('0', '0'))),
                                   <'serverats', 
                                    h(<
                                       <
                                        <
                                         <
                                          <
                                           <'0', '1', '0x0303', ~tid, '0', $cipher_suites, '0', 
                                            <'43', '0x0304'>, <'10', $g, $g2>, <'13', $sig_algs>, '40', $g, 
                                            $g^~x>, 
                                           '2', '0x0303', p_ns, $cipher_suite, <'13', $sig_algs.1>, '40', $g, 
                                           p_gy>, 
                                          '8', $exts>, 
                                         '11', '0', pk(~ltkS)>, 
                                        '15', 
                                        sign(<'server_cv', 
                                              h(<
                                                 <
                                                  <
                                                   <'0', '1', '0x0303', ~tid, '0', $cipher_suites, '0', 
                                                    <'43', '0x0304'>, <'10', $g, $g2>, <'13', $sig_algs>, 
                                                    '40', $g, $g^~x>, 
                                                   '2', '0x0303', p_ns, $cipher_suite, <'13', $sig_algs.1>, 
                                                   '40', $g, p_gy>, 
                                                  '8', $exts>, 
                                                 '11', '0', pk(~ltkS)>)
                                             >,
                                             ~ltkS)
                                       >, 
                                       '20', 
                                       hmac(<
                                             Expand(Expand(Extract(p_gxy, Extract('0', '0')),
                                                           <'serverhts', 
                                                            h(<
                                                               <
                                                                <
                                                                 <
                                                                  <'0', '1', '0x0303', ~tid, '0', 
                                                                   $cipher_suites, '0', <'43', '0x0304'>, 
                                                                   <'10', $g, $g2>, <'13', $sig_algs>, '40', 
                                                                   $g, $g^~x>, 
                                                                  '2', '0x0303', p_ns, $cipher_suite, 
                                                                  <'13', $sig_algs.1>, '40', $g, p_gy>, 
                                                                 '8', $exts>, 
                                                                '11', '0', pk(~ltkS)>, 
                                                               '15', 
                                                               sign(<'server_cv', 
                                                                     h(<
                                                                        <
                                                                         <
                                                                          <'0', '1', '0x0303', ~tid, '0', 
                                                                           $cipher_suites, '0', 
                                                                           <'43', '0x0304'>, <'10', $g, $g2>, 
                                                                           <'13', $sig_algs>, '40', $g, $g^~x
                                                                          >, 
                                                                          '2', '0x0303', p_ns, $cipher_suite, 
                                                                          <'13', $sig_algs.1>, '40', $g, p_gy
                                                                         >, 
                                                                         '8', $exts>, 
                                                                        '11', '0', pk(~ltkS)>)
                                                                    >,
                                                                    ~ltkS)
                                                              >)
                                                           >,
                                                           '32'),
                                                    <'fin', '0'>, '32'), 
                                             h(<
                                                <
                                                 <
                                                  <
                                                   <'0', '1', '0x0303', ~tid, '0', $cipher_suites, '0', 
                                                    <'43', '0x0304'>, <'10', $g, $g2>, <'13', $sig_algs>, 
                                                    '40', $g, $g^~x>, 
                                                   '2', '0x0303', p_ns, $cipher_suite, <'13', $sig_algs.1>, 
                                                   '40', $g, p_gy>, 
                                                  '8', $exts>, 
                                                 '11', '0', pk(~ltkS)>, 
                                                '15', 
                                                sign(<'server_cv', 
                                                      h(<
                                                         <
                                                          <
                                                           <'0', '1', '0x0303', ~tid, '0', $cipher_suites, 
                                                            '0', <'43', '0x0304'>, <'10', $g, $g2>, 
                                                            <'13', $sig_algs>, '40', $g, $g^~x>, 
                                                           '2', '0x0303', p_ns, $cipher_suite, 
                                                           <'13', $sig_algs.1>, '40', $g, p_gy>, 
                                                          '8', $exts>, 
                                                         '11', '0', pk(~ltkS)>)
                                                     >,
                                                     ~ltkS)
                                               >)
                                            >)
                                      >)
                                   >,
                                   '32')
                 ) @ #l)
               ∧
                #l < #j.1)) )
        case case_1
        solve( (∃ #r. (RevLtk( $S ) @ #r) ∧ #r < #vr)  ∥
               (∃ tid3 x #r. (RevDHExp( tid3, $S, x ) @ #r) ∧ #r < #vr)  ∥
               (∃ tid4 y #r. (RevDHExp( tid4, $C, y ) @ #r) ∧ #r < #vr)  ∥
               (∃ rms #r. (RevealPSK( $C, rms ) @ #r) ∧ #r < #k.1)  ∥
               (∃ rms #r. (RevealPSK( $S, rms ) @ #r) ∧ #r < #k.1) )
          case case_1
          by contradiction /* from formulas */
        next
          case case_2
          by contradiction /* from formulas */
        next
          case case_3
          by contradiction /* from formulas */
        next
          case case_4
          solve( (∃ #r. (RevLtk( $S ) @ #r) ∧ #r < #vr)  ∥
                 (∃ tid3 x #r. (RevDHExp( tid3, $S, x ) @ #r) ∧ #r < #vr)  ∥
                 (∃ tid4 y #r. (RevDHExp( tid4, $C, y ) @ #r) ∧ #r < #vr)  ∥
                 (∃ rms #r. (RevealPSK( $C, rms ) @ #r) ∧ #r < #vr)  ∥
                 (∃ rms #r. (RevealPSK( $S, rms ) @ #r) ∧ #r < #vr) )
            case case_1
            by contradiction /* from formulas */
          next
            case case_2
            by contradiction /* from formulas */
          next
            case case_3
            by contradiction /* from formulas */
          next
            case case_4
            by contradiction /* from formulas */
          next
            case case_5
            by contradiction /* from formulas */
          qed
        next
          case case_5
          solve( (∃ #r. (RevLtk( $S ) @ #r) ∧ #r < #vr)  ∥
                 (∃ tid3 x #r. (RevDHExp( tid3, $S, x ) @ #r) ∧ #r < #vr)  ∥
                 (∃ tid4 y #r. (RevDHExp( tid4, $C, y ) @ #r) ∧ #r < #vr)  ∥
                 (∃ rms #r. (RevealPSK( $C, rms ) @ #r) ∧ #r < #vr)  ∥
                 (∃ rms #r. (RevealPSK( $S, rms ) @ #r) ∧ #r < #vr) )
            case case_1
            by contradiction /* from formulas */
          next
            case case_2
            by contradiction /* from formulas */
          next
            case case_3
            by contradiction /* from formulas */
          next
            case case_4
            by contradiction /* from formulas */
          next
            case case_5
            by contradiction /* from formulas */
          qed
        qed
      next
        case case_2
        by solve( SecretPSK( $A,
                             Expand(Extract('0', Extract(p_gxy, Extract('0', '0'))),
                                    <'serverats', 
                                     h(<
                                        <
                                         <
                                          <
                                           <
                                            <'0', '1', '0x0303', ~tid, '0', $cipher_suites, '0', 
                                             <'43', '0x0304'>, <'10', $g, $g2>, <'13', $sig_algs>, '40', $g, 
                                             $g^~x>, 
                                            '2', '0x0303', p_ns, $cipher_suite, <'13', $sig_algs.1>, '40', 
                                            $g, p_gy>, 
                                           '8', $exts>, 
                                          '11', '0', pk(~ltkS)>, 
                                         '15', 
                                         sign(<'server_cv', 
                                               h(<
                                                  <
                                                   <
                                                    <'0', '1', '0x0303', ~tid, '0', $cipher_suites, '0', 
                                                     <'43', '0x0304'>, <'10', $g, $g2>, <'13', $sig_algs>, 
                                                     '40', $g, $g^~x>, 
                                                    '2', '0x0303', p_ns, $cipher_suite, <'13', $sig_algs.1>, 
                                                    '40', $g, p_gy>, 
                                                   '8', $exts>, 
                                                  '11', '0', pk(~ltkS)>)
                                              >,
                                              ~ltkS)
                                        >, 
                                        '20', 
                                        hmac(<
                                              Expand(Expand(Extract(p_gxy, Extract('0', '0')),
                                                            <'serverhts', 
                                                             h(<
                                                                <
                                                                 <
                                                                  <
                                                                   <'0', '1', '0x0303', ~tid, '0', 
                                                                    $cipher_suites, '0', <'43', '0x0304'>, 
                                                                    <'10', $g, $g2>, <'13', $sig_algs>, '40', 
                                                                    $g, $g^~x>, 
                                                                   '2', '0x0303', p_ns, $cipher_suite, 
                                                                   <'13', $sig_algs.1>, '40', $g, p_gy>, 
                                                                  '8', $exts>, 
                                                                 '11', '0', pk(~ltkS)>, 
                                                                '15', 
                                                                sign(<'server_cv', 
                                                                      h(<
                                                                         <
                                                                          <
                                                                           <'0', '1', '0x0303', ~tid, '0', 
                                                                            $cipher_suites, '0', 
                                                                            <'43', '0x0304'>, 
                                                                            <'10', $g, $g2>, 
                                                                            <'13', $sig_algs>, '40', $g, $g^~x
                                                                           >, 
                                                                           '2', '0x0303', p_ns, 
                                                                           $cipher_suite, 
                                                                           <'13', $sig_algs.1>, '40', $g, p_gy
                                                                          >, 
                                                                          '8', $exts>, 
                                                                         '11', '0', pk(~ltkS)>)
                                                                     >,
                                                                     ~ltkS)
                                                               >)
                                                            >,
                                                            '32'),
                                                     <'fin', '0'>, '32'), 
                                              h(<
                                                 <
                                                  <
                                                   <
                                                    <'0', '1', '0x0303', ~tid, '0', $cipher_suites, '0', 
                                                     <'43', '0x0304'>, <'10', $g, $g2>, <'13', $sig_algs>, 
                                                     '40', $g, $g^~x>, 
                                                    '2', '0x0303', p_ns, $cipher_suite, <'13', $sig_algs.1>, 
                                                    '40', $g, p_gy>, 
                                                   '8', $exts>, 
                                                  '11', '0', pk(~ltkS)>, 
                                                 '15', 
                                                 sign(<'server_cv', 
                                                       h(<
                                                          <
                                                           <
                                                            <'0', '1', '0x0303', ~tid, '0', $cipher_suites, 
                                                             '0', <'43', '0x0304'>, <'10', $g, $g2>, 
                                                             <'13', $sig_algs>, '40', $g, $g^~x>, 
                                                            '2', '0x0303', p_ns, $cipher_suite, 
                                                            <'13', $sig_algs.1>, '40', $g, p_gy>, 
                                                           '8', $exts>, 
                                                          '11', '0', pk(~ltkS)>)
                                                      >,
                                                      ~ltkS)
                                                >)
                                             >)
                                       >)
                                    >,
                                    '32')
                  ) ▶₀ #l )
      qed
    next
      case recv_server_auth_case_02
      solve( (∃ #j.2.
               (!KU( Extract('0', Extract(p_gxy, Extract('0', '0'))) ) @ #j.2)
              ∧
               #j.2 < #j.1)  ∥
             ((∀ #k.
                (!KU( Extract('0', Extract(p_gxy, Extract('0', '0'))) ) @ #k)
               ⇒
                ¬(#k < #j.1)) ∧
              (∃ actor #l.
                (RevealPSK( actor,
                            Expand(Extract('0', Extract(p_gxy, Extract('0', '0'))),
                                   <'serverats', 
                                    h(<
                                       <
                                        <
                                         <
                                          <
                                           <
                                            <
                                             <'0', '1', '0x0303', ~tid, '0', $cipher_suites, '0', 
                                              <'43', '0x0304'>, <'10', $g1, $g>, <'13', $sig_algs>, '40', 
                                              $g1, $g1^~x>, 
                                             '6', '0x0303', '40', $g>, 
                                            '1', '0x0303', ~tid, '0', $cipher_suites.1, '0', 
                                            <'43', '0x0304'>, <'10', $g1, $g>, <'13', $sig_algs.1>, '40', $g, 
                                            $g^~x.1>, 
                                           '2', '0x0303', p_ns, $cipher_suite, <'13', $sig_algs.2>, '40', $g, 
                                           p_gy>, 
                                          '8', $exts>, 
                                         '11', '0', pk(~ltkS)>, 
                                        '15', 
                                        sign(<'server_cv', 
                                              h(<
                                                 <
                                                  <
                                                   <
                                                    <
                                                     <'0', '1', '0x0303', ~tid, '0', $cipher_suites, '0', 
                                                      <'43', '0x0304'>, <'10', $g1, $g>, <'13', $sig_algs>, 
                                                      '40', $g1, $g1^~x>, 
                                                     '6', '0x0303', '40', $g>, 
                                                    '1', '0x0303', ~tid, '0', $cipher_suites.1, '0', 
                                                    <'43', '0x0304'>, <'10', $g1, $g>, <'13', $sig_algs.1>, 
                                                    '40', $g, $g^~x.1>, 
                                                   '2', '0x0303', p_ns, $cipher_suite, <'13', $sig_algs.2>, 
                                                   '40', $g, p_gy>, 
                                                  '8', $exts>, 
                                                 '11', '0', pk(~ltkS)>)
                                             >,
                                             ~ltkS)
                                       >, 
                                       '20', 
                                       hmac(<
                                             Expand(Expand(Extract(p_gxy, Extract('0', '0')),
                                                           <'serverhts', 
                                                            h(<
                                                               <
                                                                <
                                                                 <
                                                                  <
                                                                   <
                                                                    <'0', '1', '0x0303', ~tid, '0', 
                                                                     $cipher_suites, '0', <'43', '0x0304'>, 
                                                                     <'10', $g1, $g>, <'13', $sig_algs>, 
                                                                     '40', $g1, $g1^~x>, 
                                                                    '6', '0x0303', '40', $g>, 
                                                                   '1', '0x0303', ~tid, '0', 
                                                                   $cipher_suites.1, '0', <'43', '0x0304'>, 
                                                                   <'10', $g1, $g>, <'13', $sig_algs.1>, 
                                                                   '40', $g, $g^~x.1>, 
                                                                  '2', '0x0303', p_ns, $cipher_suite, 
                                                                  <'13', $sig_algs.2>, '40', $g, p_gy>, 
                                                                 '8', $exts>, 
                                                                '11', '0', pk(~ltkS)>, 
                                                               '15', 
                                                               sign(<'server_cv', 
                                                                     h(<
                                                                        <
                                                                         <
                                                                          <
                                                                           <
                                                                            <'0', '1', '0x0303', ~tid, '0', 
                                                                             $cipher_suites, '0', 
                                                                             <'43', '0x0304'>, 
                                                                             <'10', $g1, $g>, 
                                                                             <'13', $sig_algs>, '40', $g1, 
                                                                             $g1^~x>, 
                                                                            '6', '0x0303', '40', $g>, 
                                                                           '1', '0x0303', ~tid, '0', 
                                                                           $cipher_suites.1, '0', 
                                                                           <'43', '0x0304'>, <'10', $g1, $g>, 
                                                                           <'13', $sig_algs.1>, '40', $g, 
                                                                           $g^~x.1>, 
                                                                          '2', '0x0303', p_ns, $cipher_suite, 
                                                                          <'13', $sig_algs.2>, '40', $g, p_gy
                                                                         >, 
                                                                         '8', $exts>, 
                                                                        '11', '0', pk(~ltkS)>)
                                                                    >,
                                                                    ~ltkS)
                                                              >)
                                                           >,
                                                           '32'),
                                                    <'fin', '0'>, '32'), 
                                             h(<
                                                <
                                                 <
                                                  <
                                                   <
                                                    <
                                                     <'0', '1', '0x0303', ~tid, '0', $cipher_suites, '0', 
                                                      <'43', '0x0304'>, <'10', $g1, $g>, <'13', $sig_algs>, 
                                                      '40', $g1, $g1^~x>, 
                                                     '6', '0x0303', '40', $g>, 
                                                    '1', '0x0303', ~tid, '0', $cipher_suites.1, '0', 
                                                    <'43', '0x0304'>, <'10', $g1, $g>, <'13', $sig_algs.1>, 
                                                    '40', $g, $g^~x.1>, 
                                                   '2', '0x0303', p_ns, $cipher_suite, <'13', $sig_algs.2>, 
                                                   '40', $g, p_gy>, 
                                                  '8', $exts>, 
                                                 '11', '0', pk(~ltkS)>, 
                                                '15', 
                                                sign(<'server_cv', 
                                                      h(<
                                                         <
                                                          <
                                                           <
                                                            <
                                                             <'0', '1', '0x0303', ~tid, '0', $cipher_suites, 
                                                              '0', <'43', '0x0304'>, <'10', $g1, $g>, 
                                                              <'13', $sig_algs>, '40', $g1, $g1^~x>, 
                                                             '6', '0x0303', '40', $g>, 
                                                            '1', '0x0303', ~tid, '0', $cipher_suites.1, '0', 
                                                            <'43', '0x0304'>, <'10', $g1, $g>, 
                                                            <'13', $sig_algs.1>, '40', $g, $g^~x.1>, 
                                                           '2', '0x0303', p_ns, $cipher_suite, 
                                                           <'13', $sig_algs.2>, '40', $g, p_gy>, 
                                                          '8', $exts>, 
                                                         '11', '0', pk(~ltkS)>)
                                                     >,
                                                     ~ltkS)
                                               >)
                                            >)
                                      >)
                                   >,
                                   '32')
                 ) @ #l)
               ∧
                #l < #j.1)) )
        case case_1
        solve( (∃ #r. (RevLtk( $S ) @ #r) ∧ #r < #vr)  ∥
               (∃ tid3 x #r. (RevDHExp( tid3, $S, x ) @ #r) ∧ #r < #vr)  ∥
               (∃ tid4 y #r. (RevDHExp( tid4, $C, y ) @ #r) ∧ #r < #vr)  ∥
               (∃ rms #r. (RevealPSK( $C, rms ) @ #r) ∧ #r < #k.1)  ∥
               (∃ rms #r. (RevealPSK( $S, rms ) @ #r) ∧ #r < #k.1) )
          case case_1
          by contradiction /* from formulas */
        next
          case case_2
          by contradiction /* from formulas */
        next
          case case_3
          by contradiction /* from formulas */
        next
          case case_4
          solve( (∃ #r. (RevLtk( $S ) @ #r) ∧ #r < #vr)  ∥
                 (∃ tid3 x #r. (RevDHExp( tid3, $S, x ) @ #r) ∧ #r < #vr)  ∥
                 (∃ tid4 y #r. (RevDHExp( tid4, $C, y ) @ #r) ∧ #r < #vr)  ∥
                 (∃ rms #r. (RevealPSK( $C, rms ) @ #r) ∧ #r < #vr)  ∥
                 (∃ rms #r. (RevealPSK( $S, rms ) @ #r) ∧ #r < #vr) )
            case case_1
            by contradiction /* from formulas */
          next
            case case_2
            by contradiction /* from formulas */
          next
            case case_3
            by contradiction /* from formulas */
          next
            case case_4
            by contradiction /* from formulas */
          next
            case case_5
            by contradiction /* from formulas */
          qed
        next
          case case_5
          solve( (∃ #r. (RevLtk( $S ) @ #r) ∧ #r < #vr)  ∥
                 (∃ tid3 x #r. (RevDHExp( tid3, $S, x ) @ #r) ∧ #r < #vr)  ∥
                 (∃ tid4 y #r. (RevDHExp( tid4, $C, y ) @ #r) ∧ #r < #vr)  ∥
                 (∃ rms #r. (RevealPSK( $C, rms ) @ #r) ∧ #r < #vr)  ∥
                 (∃ rms #r. (RevealPSK( $S, rms ) @ #r) ∧ #r < #vr) )
            case case_1
            by contradiction /* from formulas */
          next
            case case_2
            by contradiction /* from formulas */
          next
            case case_3
            by contradiction /* from formulas */
          next
            case case_4
            by contradiction /* from formulas */
          next
            case case_5
            by contradiction /* from formulas */
          qed
        qed
      next
        case case_2
        by solve( SecretPSK( $A,
                             Expand(Extract('0', Extract(p_gxy, Extract('0', '0'))),
                                    <'serverats', 
                                     h(<
                                        <
                                         <
                                          <
                                           <
                                            <
                                             <
                                              <'0', '1', '0x0303', ~tid, '0', $cipher_suites, '0', 
                                               <'43', '0x0304'>, <'10', $g1, $g>, <'13', $sig_algs>, '40', 
                                               $g1, $g1^~x>, 
                                              '6', '0x0303', '40', $g>, 
                                             '1', '0x0303', ~tid, '0', $cipher_suites.1, '0', 
                                             <'43', '0x0304'>, <'10', $g1, $g>, <'13', $sig_algs.1>, '40', 
                                             $g, $g^~x.1>, 
                                            '2', '0x0303', p_ns, $cipher_suite, <'13', $sig_algs.2>, '40', 
                                            $g, p_gy>, 
                                           '8', $exts>, 
                                          '11', '0', pk(~ltkS)>, 
                                         '15', 
                                         sign(<'server_cv', 
                                               h(<
                                                  <
                                                   <
                                                    <
                                                     <
                                                      <'0', '1', '0x0303', ~tid, '0', $cipher_suites, '0', 
                                                       <'43', '0x0304'>, <'10', $g1, $g>, <'13', $sig_algs>, 
                                                       '40', $g1, $g1^~x>, 
                                                      '6', '0x0303', '40', $g>, 
                                                     '1', '0x0303', ~tid, '0', $cipher_suites.1, '0', 
                                                     <'43', '0x0304'>, <'10', $g1, $g>, <'13', $sig_algs.1>, 
                                                     '40', $g, $g^~x.1>, 
                                                    '2', '0x0303', p_ns, $cipher_suite, <'13', $sig_algs.2>, 
                                                    '40', $g, p_gy>, 
                                                   '8', $exts>, 
                                                  '11', '0', pk(~ltkS)>)
                                              >,
                                              ~ltkS)
                                        >, 
                                        '20', 
                                        hmac(<
                                              Expand(Expand(Extract(p_gxy, Extract('0', '0')),
                                                            <'serverhts', 
                                                             h(<
                                                                <
                                                                 <
                                                                  <
                                                                   <
                                                                    <
                                                                     <'0', '1', '0x0303', ~tid, '0', 
                                                                      $cipher_suites, '0', <'43', '0x0304'>, 
                                                                      <'10', $g1, $g>, <'13', $sig_algs>, 
                                                                      '40', $g1, $g1^~x>, 
                                                                     '6', '0x0303', '40', $g>, 
                                                                    '1', '0x0303', ~tid, '0', 
                                                                    $cipher_suites.1, '0', <'43', '0x0304'>, 
                                                                    <'10', $g1, $g>, <'13', $sig_algs.1>, 
                                                                    '40', $g, $g^~x.1>, 
                                                                   '2', '0x0303', p_ns, $cipher_suite, 
                                                                   <'13', $sig_algs.2>, '40', $g, p_gy>, 
                                                                  '8', $exts>, 
                                                                 '11', '0', pk(~ltkS)>, 
                                                                '15', 
                                                                sign(<'server_cv', 
                                                                      h(<
                                                                         <
                                                                          <
                                                                           <
                                                                            <
                                                                             <'0', '1', '0x0303', ~tid, '0', 
                                                                              $cipher_suites, '0', 
                                                                              <'43', '0x0304'>, 
                                                                              <'10', $g1, $g>, 
                                                                              <'13', $sig_algs>, '40', $g1, 
                                                                              $g1^~x>, 
                                                                             '6', '0x0303', '40', $g>, 
                                                                            '1', '0x0303', ~tid, '0', 
                                                                            $cipher_suites.1, '0', 
                                                                            <'43', '0x0304'>, 
                                                                            <'10', $g1, $g>, 
                                                                            <'13', $sig_algs.1>, '40', $g, 
                                                                            $g^~x.1>, 
                                                                           '2', '0x0303', p_ns, 
                                                                           $cipher_suite, 
                                                                           <'13', $sig_algs.2>, '40', $g, p_gy
                                                                          >, 
                                                                          '8', $exts>, 
                                                                         '11', '0', pk(~ltkS)>)
                                                                     >,
                                                                     ~ltkS)
                                                               >)
                                                            >,
                                                            '32'),
                                                     <'fin', '0'>, '32'), 
                                              h(<
                                                 <
                                                  <
                                                   <
                                                    <
                                                     <
                                                      <'0', '1', '0x0303', ~tid, '0', $cipher_suites, '0', 
                                                       <'43', '0x0304'>, <'10', $g1, $g>, <'13', $sig_algs>, 
                                                       '40', $g1, $g1^~x>, 
                                                      '6', '0x0303', '40', $g>, 
                                                     '1', '0x0303', ~tid, '0', $cipher_suites.1, '0', 
                                                     <'43', '0x0304'>, <'10', $g1, $g>, <'13', $sig_algs.1>, 
                                                     '40', $g, $g^~x.1>, 
                                                    '2', '0x0303', p_ns, $cipher_suite, <'13', $sig_algs.2>, 
                                                    '40', $g, p_gy>, 
                                                   '8', $exts>, 
                                                  '11', '0', pk(~ltkS)>, 
                                                 '15', 
                                                 sign(<'server_cv', 
                                                       h(<
                                                          <
                                                           <
                                                            <
                                                             <
                                                              <'0', '1', '0x0303', ~tid, '0', $cipher_suites, 
                                                               '0', <'43', '0x0304'>, <'10', $g1, $g>, 
                                                               <'13', $sig_algs>, '40', $g1, $g1^~x>, 
                                                              '6', '0x0303', '40', $g>, 
                                                             '1', '0x0303', ~tid, '0', $cipher_suites.1, '0', 
                                                             <'43', '0x0304'>, <'10', $g1, $g>, 
                                                             <'13', $sig_algs.1>, '40', $g, $g^~x.1>, 
                                                            '2', '0x0303', p_ns, $cipher_suite, 
                                                            <'13', $sig_algs.2>, '40', $g, p_gy>, 
                                                           '8', $exts>, 
                                                          '11', '0', pk(~ltkS)>)
                                                      >,
                                                      ~ltkS)
                                                >)
                                             >)
                                       >)
                                    >,
                                    '32')
                  ) ▶₀ #l )
      qed
    next
      case recv_server_auth_case_03
      solve( (∃ #j.2.
               (!KU( Extract('0', Extract(p_gxy, Extract(~res_psk, '0'))) ) @ #j.2)
              ∧
               #j.2 < #j.1)  ∥
             ((∀ #k.
                (!KU( Extract('0', Extract(p_gxy, Extract(~res_psk, '0'))) ) @ #k)
               ⇒
                ¬(#k < #j.1)) ∧
              (∃ actor #l.
                (RevealPSK( actor,
                            Expand(Extract('0', Extract(p_gxy, Extract(~res_psk, '0'))),
                                   <'serverats', 
                                    h(<
                                       <
                                        <
                                         <
                                          <
                                           <
                                            <
                                             <'0', '1', '0x0303', ~tid, '0', $cipher_suites, '0', 
                                              <'43', '0x0304'>, <'10', $g1, $g>, <'40', $g1, $g1^~x>, 
                                              <'45', '0', '1'>, <'42', '0'>, '41', 
                                              <~ticket, mask(~ticket_age_add, $ticket_age)>, 
                                              hmac(<
                                                    Expand(Expand(Extract(~res_psk, '0'), <'ext', 'pbk'>,
                                                                  '32'),
                                                           <'0', '0'>, '32'), 
                                                    h(<'0', '1', '0x0303', ~tid, '0', $cipher_suites, '0', 
                                                       <'43', '0x0304'>, <'10', $g1, $g>, 
                                                       <'40', $g1, $g1^~x>, <'45', '0', '1'>, <'42', '0'>, 
                                                       '41', <~ticket, mask(~ticket_age_add, $ticket_age)>, 
                                                       '0'>)
                                                   >)
                                             >, 
                                             '6', '0x0303', '40', $g>, 
                                            '1', '0x0303', ~tid, '0', $cipher_suites.1, '0', 
                                            <'43', '0x0304'>, <'10', $g1, $g>, <'13', $sig_algs>, '40', $g, 
                                            $g^~x.1>, 
                                           '2', '0x0303', p_ns, $cipher_suite, <'13', $sig_algs.1>, '40', $g, 
                                           p_gy>, 
                                          '8', $exts>, 
                                         '11', '0', pk(~ltkS)>, 
                                        '15', 
                                        sign(<'server_cv', 
                                              h(<
                                                 <
                                                  <
                                                   <
                                                    <
                                                     <'0', '1', '0x0303', ~tid, '0', $cipher_suites, '0', 
                                                      <'43', '0x0304'>, <'10', $g1, $g>, <'40', $g1, $g1^~x>, 
                                                      <'45', '0', '1'>, <'42', '0'>, '41', 
                                                      <~ticket, mask(~ticket_age_add, $ticket_age)>, 
                                                      hmac(<
                                                            Expand(Expand(Extract(~res_psk, '0'),
                                                                          <'ext', 'pbk'>, '32'),
                                                                   <'0', '0'>, '32'), 
                                                            h(<'0', '1', '0x0303', ~tid, '0', $cipher_suites, 
                                                               '0', <'43', '0x0304'>, <'10', $g1, $g>, 
                                                               <'40', $g1, $g1^~x>, <'45', '0', '1'>, 
                                                               <'42', '0'>, '41', 
                                                               <~ticket, mask(~ticket_age_add, $ticket_age)>, 
                                                               '0'>)
                                                           >)
                                                     >, 
                                                     '6', '0x0303', '40', $g>, 
                                                    '1', '0x0303', ~tid, '0', $cipher_suites.1, '0', 
                                                    <'43', '0x0304'>, <'10', $g1, $g>, <'13', $sig_algs>, 
                                                    '40', $g, $g^~x.1>, 
                                                   '2', '0x0303', p_ns, $cipher_suite, <'13', $sig_algs.1>, 
                                                   '40', $g, p_gy>, 
                                                  '8', $exts>, 
                                                 '11', '0', pk(~ltkS)>)
                                             >,
                                             ~ltkS)
                                       >, 
                                       '20', 
                                       hmac(<
                                             Expand(Expand(Extract(p_gxy, Extract(~res_psk, '0')),
                                                           <'serverhts', 
                                                            h(<
                                                               <
                                                                <
                                                                 <
                                                                  <
                                                                   <
                                                                    <'0', '1', '0x0303', ~tid, '0', 
                                                                     $cipher_suites, '0', <'43', '0x0304'>, 
                                                                     <'10', $g1, $g>, <'40', $g1, $g1^~x>, 
                                                                     <'45', '0', '1'>, <'42', '0'>, '41', 
                                                                     <~ticket, 
                                                                      mask(~ticket_age_add, $ticket_age)>, 
                                                                     hmac(<
                                                                           Expand(Expand(Extract(~res_psk,
                                                                                                 '0'),
                                                                                         <'ext', 'pbk'>,
                                                                                         '32'),
                                                                                  <'0', '0'>, '32'), 
                                                                           h(<'0', '1', '0x0303', ~tid, '0', 
                                                                              $cipher_suites, '0', 
                                                                              <'43', '0x0304'>, 
                                                                              <'10', $g1, $g>, 
                                                                              <'40', $g1, $g1^~x>, 
                                                                              <'45', '0', '1'>, <'42', '0'>, 
                                                                              '41', 
                                                                              <~ticket, 
                                                                               mask(~ticket_age_add,
                                                                                    $ticket_age)
                                                                              >, 
                                                                              '0'>)
                                                                          >)
                                                                    >, 
                                                                    '6', '0x0303', '40', $g>, 
                                                                   '1', '0x0303', ~tid, '0', 
                                                                   $cipher_suites.1, '0', <'43', '0x0304'>, 
                                                                   <'10', $g1, $g>, <'13', $sig_algs>, '40', 
                                                                   $g, $g^~x.1>, 
                                                                  '2', '0x0303', p_ns, $cipher_suite, 
                                                                  <'13', $sig_algs.1>, '40', $g, p_gy>, 
                                                                 '8', $exts>, 
                                                                '11', '0', pk(~ltkS)>, 
                                                               '15', 
                                                               sign(<'server_cv', 
                                                                     h(<
                                                                        <
                                                                         <
                                                                          <
                                                                           <
                                                                            <'0', '1', '0x0303', ~tid, '0', 
                                                                             $cipher_suites, '0', 
                                                                             <'43', '0x0304'>, 
                                                                             <'10', $g1, $g>, 
                                                                             <'40', $g1, $g1^~x>, 
                                                                             <'45', '0', '1'>, <'42', '0'>, 
                                                                             '41', 
                                                                             <~ticket, 
                                                                              mask(~ticket_age_add,
                                                                                   $ticket_age)
                                                                             >, 
                                                                             hmac(<
                                                                                   Expand(Expand(Extract(~res_psk,
                                                                                                         '0'),
                                                                                                 <'ext', 'pbk'
                                                                                                 >,
                                                                                                 '32'),
                                                                                          <'0', '0'>, '32'), 
                                                                                   h(<'0', '1', '0x0303', 
                                                                                      ~tid, '0', 
                                                                                      $cipher_suites, '0', 
                                                                                      <'43', '0x0304'>, 
                                                                                      <'10', $g1, $g>, 
                                                                                      <'40', $g1, $g1^~x>, 
                                                                                      <'45', '0', '1'>, 
                                                                                      <'42', '0'>, '41', 
                                                                                      <~ticket, 
                                                                                       mask(~ticket_age_add,
                                                                                            $ticket_age)
                                                                                      >, 
                                                                                      '0'>)
                                                                                  >)
                                                                            >, 
                                                                            '6', '0x0303', '40', $g>, 
                                                                           '1', '0x0303', ~tid, '0', 
                                                                           $cipher_suites.1, '0', 
                                                                           <'43', '0x0304'>, <'10', $g1, $g>, 
                                                                           <'13', $sig_algs>, '40', $g, 
                                                                           $g^~x.1>, 
                                                                          '2', '0x0303', p_ns, $cipher_suite, 
                                                                          <'13', $sig_algs.1>, '40', $g, p_gy
                                                                         >, 
                                                                         '8', $exts>, 
                                                                        '11', '0', pk(~ltkS)>)
                                                                    >,
                                                                    ~ltkS)
                                                              >)
                                                           >,
                                                           '32'),
                                                    <'fin', '0'>, '32'), 
                                             h(<
                                                <
                                                 <
                                                  <
                                                   <
                                                    <
                                                     <'0', '1', '0x0303', ~tid, '0', $cipher_suites, '0', 
                                                      <'43', '0x0304'>, <'10', $g1, $g>, <'40', $g1, $g1^~x>, 
                                                      <'45', '0', '1'>, <'42', '0'>, '41', 
                                                      <~ticket, mask(~ticket_age_add, $ticket_age)>, 
                                                      hmac(<
                                                            Expand(Expand(Extract(~res_psk, '0'),
                                                                          <'ext', 'pbk'>, '32'),
                                                                   <'0', '0'>, '32'), 
                                                            h(<'0', '1', '0x0303', ~tid, '0', $cipher_suites, 
                                                               '0', <'43', '0x0304'>, <'10', $g1, $g>, 
                                                               <'40', $g1, $g1^~x>, <'45', '0', '1'>, 
                                                               <'42', '0'>, '41', 
                                                               <~ticket, mask(~ticket_age_add, $ticket_age)>, 
                                                               '0'>)
                                                           >)
                                                     >, 
                                                     '6', '0x0303', '40', $g>, 
                                                    '1', '0x0303', ~tid, '0', $cipher_suites.1, '0', 
                                                    <'43', '0x0304'>, <'10', $g1, $g>, <'13', $sig_algs>, 
                                                    '40', $g, $g^~x.1>, 
                                                   '2', '0x0303', p_ns, $cipher_suite, <'13', $sig_algs.1>, 
                                                   '40', $g, p_gy>, 
                                                  '8', $exts>, 
                                                 '11', '0', pk(~ltkS)>, 
                                                '15', 
                                                sign(<'server_cv', 
                                                      h(<
                                                         <
                                                          <
                                                           <
                                                            <
                                                             <'0', '1', '0x0303', ~tid, '0', $cipher_suites, 
                                                              '0', <'43', '0x0304'>, <'10', $g1, $g>, 
                                                              <'40', $g1, $g1^~x>, <'45', '0', '1'>, 
                                                              <'42', '0'>, '41', 
                                                              <~ticket, mask(~ticket_age_add, $ticket_age)>, 
                                                              hmac(<
                                                                    Expand(Expand(Extract(~res_psk, '0'),
                                                                                  <'ext', 'pbk'>, '32'),
                                                                           <'0', '0'>, '32'), 
                                                                    h(<'0', '1', '0x0303', ~tid, '0', 
                                                                       $cipher_suites, '0', <'43', '0x0304'>, 
                                                                       <'10', $g1, $g>, <'40', $g1, $g1^~x>, 
                                                                       <'45', '0', '1'>, <'42', '0'>, '41', 
                                                                       <~ticket, 
                                                                        mask(~ticket_age_add, $ticket_age)>, 
                                                                       '0'>)
                                                                   >)
                                                             >, 
                                                             '6', '0x0303', '40', $g>, 
                                                            '1', '0x0303', ~tid, '0', $cipher_suites.1, '0', 
                                                            <'43', '0x0304'>, <'10', $g1, $g>, 
                                                            <'13', $sig_algs>, '40', $g, $g^~x.1>, 
                                                           '2', '0x0303', p_ns, $cipher_suite, 
                                                           <'13', $sig_algs.1>, '40', $g, p_gy>, 
                                                          '8', $exts>, 
                                                         '11', '0', pk(~ltkS)>)
                                                     >,
                                                     ~ltkS)
                                               >)
                                            >)
                                      >)
                                   >,
                                   '32')
                 ) @ #l)
               ∧
                #l < #j.1)) )
        case case_1
        solve( (∃ #r. (RevLtk( $S ) @ #r) ∧ #r < #vr)  ∥
               (∃ tid3 x #r. (RevDHExp( tid3, $S, x ) @ #r) ∧ #r < #vr)  ∥
               (∃ tid4 y #r. (RevDHExp( tid4, $C, y ) @ #r) ∧ #r < #vr)  ∥
               (∃ rms #r. (RevealPSK( $C, rms ) @ #r) ∧ #r < #k.1)  ∥
               (∃ rms #r. (RevealPSK( $S, rms ) @ #r) ∧ #r < #k.1) )
          case case_1
          by contradiction /* from formulas */
        next
          case case_2
          by contradiction /* from formulas */
        next
          case case_3
          by contradiction /* from formulas */
        next
          case case_4
          solve( (∃ #r. (RevLtk( $S ) @ #r) ∧ #r < #vr)  ∥
                 (∃ tid3 x #r. (RevDHExp( tid3, $S, x ) @ #r) ∧ #r < #vr)  ∥
                 (∃ tid4 y #r. (RevDHExp( tid4, $C, y ) @ #r) ∧ #r < #vr)  ∥
                 (∃ rms #r. (RevealPSK( $C, rms ) @ #r) ∧ #r < #vr)  ∥
                 (∃ rms #r. (RevealPSK( $S, rms ) @ #r) ∧ #r < #vr) )
            case case_1
            by contradiction /* from formulas */
          next
            case case_2
            by contradiction /* from formulas */
          next
            case case_3
            by contradiction /* from formulas */
          next
            case case_4
            by contradiction /* from formulas */
          next
            case case_5
            by contradiction /* from formulas */
          qed
        next
          case case_5
          solve( (∃ #r. (RevLtk( $S ) @ #r) ∧ #r < #vr)  ∥
                 (∃ tid3 x #r. (RevDHExp( tid3, $S, x ) @ #r) ∧ #r < #vr)  ∥
                 (∃ tid4 y #r. (RevDHExp( tid4, $C, y ) @ #r) ∧ #r < #vr)  ∥
                 (∃ rms #r. (RevealPSK( $C, rms ) @ #r) ∧ #r < #vr)  ∥
                 (∃ rms #r. (RevealPSK( $S, rms ) @ #r) ∧ #r < #vr) )
            case case_1
            by contradiction /* from formulas */
          next
            case case_2
            by contradiction /* from formulas */
          next
            case case_3
            by contradiction /* from formulas */
          next
            case case_4
            by contradiction /* from formulas */
          next
            case case_5
            by contradiction /* from formulas */
          qed
        qed
      next
        case case_2
        by solve( SecretPSK( $A,
                             Expand(Extract('0', Extract(p_gxy, Extract(~res_psk, '0'))),
                                    <'serverats', 
                                     h(<
                                        <
                                         <
                                          <
                                           <
                                            <
                                             <
                                              <'0', '1', '0x0303', ~tid, '0', $cipher_suites, '0', 
                                               <'43', '0x0304'>, <'10', $g1, $g>, <'40', $g1, $g1^~x>, 
                                               <'45', '0', '1'>, <'42', '0'>, '41', 
                                               <~ticket, mask(~ticket_age_add, $ticket_age)>, 
                                               hmac(<
                                                     Expand(Expand(Extract(~res_psk, '0'), <'ext', 'pbk'>,
                                                                   '32'),
                                                            <'0', '0'>, '32'), 
                                                     h(<'0', '1', '0x0303', ~tid, '0', $cipher_suites, '0', 
                                                        <'43', '0x0304'>, <'10', $g1, $g>, 
                                                        <'40', $g1, $g1^~x>, <'45', '0', '1'>, <'42', '0'>, 
                                                        '41', <~ticket, mask(~ticket_age_add, $ticket_age)>, 
                                                        '0'>)
                                                    >)
                                              >, 
                                              '6', '0x0303', '40', $g>, 
                                             '1', '0x0303', ~tid, '0', $cipher_suites.1, '0', 
                                             <'43', '0x0304'>, <'10', $g1, $g>, <'13', $sig_algs>, '40', $g, 
                                             $g^~x.1>, 
                                            '2', '0x0303', p_ns, $cipher_suite, <'13', $sig_algs.1>, '40', 
                                            $g, p_gy>, 
                                           '8', $exts>, 
                                          '11', '0', pk(~ltkS)>, 
                                         '15', 
                                         sign(<'server_cv', 
                                               h(<
                                                  <
                                                   <
                                                    <
                                                     <
                                                      <'0', '1', '0x0303', ~tid, '0', $cipher_suites, '0', 
                                                       <'43', '0x0304'>, <'10', $g1, $g>, 
                                                       <'40', $g1, $g1^~x>, <'45', '0', '1'>, <'42', '0'>, 
                                                       '41', <~ticket, mask(~ticket_age_add, $ticket_age)>, 
                                                       hmac(<
                                                             Expand(Expand(Extract(~res_psk, '0'),
                                                                           <'ext', 'pbk'>, '32'),
                                                                    <'0', '0'>, '32'), 
                                                             h(<'0', '1', '0x0303', ~tid, '0', 
                                                                $cipher_suites, '0', <'43', '0x0304'>, 
                                                                <'10', $g1, $g>, <'40', $g1, $g1^~x>, 
                                                                <'45', '0', '1'>, <'42', '0'>, '41', 
                                                                <~ticket, mask(~ticket_age_add, $ticket_age)
                                                                >, 
                                                                '0'>)
                                                            >)
                                                      >, 
                                                      '6', '0x0303', '40', $g>, 
                                                     '1', '0x0303', ~tid, '0', $cipher_suites.1, '0', 
                                                     <'43', '0x0304'>, <'10', $g1, $g>, <'13', $sig_algs>, 
                                                     '40', $g, $g^~x.1>, 
                                                    '2', '0x0303', p_ns, $cipher_suite, <'13', $sig_algs.1>, 
                                                    '40', $g, p_gy>, 
                                                   '8', $exts>, 
                                                  '11', '0', pk(~ltkS)>)
                                              >,
                                              ~ltkS)
                                        >, 
                                        '20', 
                                        hmac(<
                                              Expand(Expand(Extract(p_gxy, Extract(~res_psk, '0')),
                                                            <'serverhts', 
                                                             h(<
                                                                <
                                                                 <
                                                                  <
                                                                   <
                                                                    <
                                                                     <'0', '1', '0x0303', ~tid, '0', 
                                                                      $cipher_suites, '0', <'43', '0x0304'>, 
                                                                      <'10', $g1, $g>, <'40', $g1, $g1^~x>, 
                                                                      <'45', '0', '1'>, <'42', '0'>, '41', 
                                                                      <~ticket, 
                                                                       mask(~ticket_age_add, $ticket_age)>, 
                                                                      hmac(<
                                                                            Expand(Expand(Extract(~res_psk,
                                                                                                  '0'),
                                                                                          <'ext', 'pbk'>,
                                                                                          '32'),
                                                                                   <'0', '0'>, '32'), 
                                                                            h(<'0', '1', '0x0303', ~tid, '0', 
                                                                               $cipher_suites, '0', 
                                                                               <'43', '0x0304'>, 
                                                                               <'10', $g1, $g>, 
                                                                               <'40', $g1, $g1^~x>, 
                                                                               <'45', '0', '1'>, <'42', '0'>, 
                                                                               '41', 
                                                                               <~ticket, 
                                                                                mask(~ticket_age_add,
                                                                                     $ticket_age)
                                                                               >, 
                                                                               '0'>)
                                                                           >)
                                                                     >, 
                                                                     '6', '0x0303', '40', $g>, 
                                                                    '1', '0x0303', ~tid, '0', 
                                                                    $cipher_suites.1, '0', <'43', '0x0304'>, 
                                                                    <'10', $g1, $g>, <'13', $sig_algs>, '40', 
                                                                    $g, $g^~x.1>, 
                                                                   '2', '0x0303', p_ns, $cipher_suite, 
                                                                   <'13', $sig_algs.1>, '40', $g, p_gy>, 
                                                                  '8', $exts>, 
                                                                 '11', '0', pk(~ltkS)>, 
                                                                '15', 
                                                                sign(<'server_cv', 
                                                                      h(<
                                                                         <
                                                                          <
                                                                           <
                                                                            <
                                                                             <'0', '1', '0x0303', ~tid, '0', 
                                                                              $cipher_suites, '0', 
                                                                              <'43', '0x0304'>, 
                                                                              <'10', $g1, $g>, 
                                                                              <'40', $g1, $g1^~x>, 
                                                                              <'45', '0', '1'>, <'42', '0'>, 
                                                                              '41', 
                                                                              <~ticket, 
                                                                               mask(~ticket_age_add,
                                                                                    $ticket_age)
                                                                              >, 
                                                                              hmac(<
                                                                                    Expand(Expand(Extract(~res_psk,
                                                                                                          '0'),
                                                                                                  <'ext', 
                                                                                                   'pbk'>,
                                                                                                  '32'),
                                                                                           <'0', '0'>, '32'), 
                                                                                    h(<'0', '1', '0x0303', 
                                                                                       ~tid, '0', 
                                                                                       $cipher_suites, '0', 
                                                                                       <'43', '0x0304'>, 
                                                                                       <'10', $g1, $g>, 
                                                                                       <'40', $g1, $g1^~x>, 
                                                                                       <'45', '0', '1'>, 
                                                                                       <'42', '0'>, '41', 
                                                                                       <~ticket, 
                                                                                        mask(~ticket_age_add,
                                                                                             $ticket_age)
                                                                                       >, 
                                                                                       '0'>)
                                                                                   >)
                                                                             >, 
                                                                             '6', '0x0303', '40', $g>, 
                                                                            '1', '0x0303', ~tid, '0', 
                                                                            $cipher_suites.1, '0', 
                                                                            <'43', '0x0304'>, 
                                                                            <'10', $g1, $g>, 
                                                                            <'13', $sig_algs>, '40', $g, 
                                                                            $g^~x.1>, 
                                                                           '2', '0x0303', p_ns, 
                                                                           $cipher_suite, 
                                                                           <'13', $sig_algs.1>, '40', $g, p_gy
                                                                          >, 
                                                                          '8', $exts>, 
                                                                         '11', '0', pk(~ltkS)>)
                                                                     >,
                                                                     ~ltkS)
                                                               >)
                                                            >,
                                                            '32'),
                                                     <'fin', '0'>, '32'), 
                                              h(<
                                                 <
                                                  <
                                                   <
                                                    <
                                                     <
                                                      <'0', '1', '0x0303', ~tid, '0', $cipher_suites, '0', 
                                                       <'43', '0x0304'>, <'10', $g1, $g>, 
                                                       <'40', $g1, $g1^~x>, <'45', '0', '1'>, <'42', '0'>, 
                                                       '41', <~ticket, mask(~ticket_age_add, $ticket_age)>, 
                                                       hmac(<
                                                             Expand(Expand(Extract(~res_psk, '0'),
                                                                           <'ext', 'pbk'>, '32'),
                                                                    <'0', '0'>, '32'), 
                                                             h(<'0', '1', '0x0303', ~tid, '0', 
                                                                $cipher_suites, '0', <'43', '0x0304'>, 
                                                                <'10', $g1, $g>, <'40', $g1, $g1^~x>, 
                                                                <'45', '0', '1'>, <'42', '0'>, '41', 
                                                                <~ticket, mask(~ticket_age_add, $ticket_age)
                                                                >, 
                                                                '0'>)
                                                            >)
                                                      >, 
                                                      '6', '0x0303', '40', $g>, 
                                                     '1', '0x0303', ~tid, '0', $cipher_suites.1, '0', 
                                                     <'43', '0x0304'>, <'10', $g1, $g>, <'13', $sig_algs>, 
                                                     '40', $g, $g^~x.1>, 
                                                    '2', '0x0303', p_ns, $cipher_suite, <'13', $sig_algs.1>, 
                                                    '40', $g, p_gy>, 
                                                   '8', $exts>, 
                                                  '11', '0', pk(~ltkS)>, 
                                                 '15', 
                                                 sign(<'server_cv', 
                                                       h(<
                                                          <
                                                           <
                                                            <
                                                             <
                                                              <'0', '1', '0x0303', ~tid, '0', $cipher_suites, 
                                                               '0', <'43', '0x0304'>, <'10', $g1, $g>, 
                                                               <'40', $g1, $g1^~x>, <'45', '0', '1'>, 
                                                               <'42', '0'>, '41', 
                                                               <~ticket, mask(~ticket_age_add, $ticket_age)>, 
                                                               hmac(<
                                                                     Expand(Expand(Extract(~res_psk, '0'),
                                                                                   <'ext', 'pbk'>, '32'),
                                                                            <'0', '0'>, '32'), 
                                                                     h(<'0', '1', '0x0303', ~tid, '0', 
                                                                        $cipher_suites, '0', 
                                                                        <'43', '0x0304'>, <'10', $g1, $g>, 
                                                                        <'40', $g1, $g1^~x>, 
                                                                        <'45', '0', '1'>, <'42', '0'>, '41', 
                                                                        <~ticket, 
                                                                         mask(~ticket_age_add, $ticket_age)>, 
                                                                        '0'>)
                                                                    >)
                                                              >, 
                                                              '6', '0x0303', '40', $g>, 
                                                             '1', '0x0303', ~tid, '0', $cipher_suites.1, '0', 
                                                             <'43', '0x0304'>, <'10', $g1, $g>, 
                                                             <'13', $sig_algs>, '40', $g, $g^~x.1>, 
                                                            '2', '0x0303', p_ns, $cipher_suite, 
                                                            <'13', $sig_algs.1>, '40', $g, p_gy>, 
                                                           '8', $exts>, 
                                                          '11', '0', pk(~ltkS)>)
                                                      >,
                                                      ~ltkS)
                                                >)
                                             >)
                                       >)
                                    >,
                                    '32')
                  ) ▶₀ #l )
      qed
    next
      case recv_server_auth_case_04
      solve( (∃ #j.2.
               (!KU( Extract('0',
                             Extract(p_gxy, Extract(Expand(ms, <'rms', h(messages)>, '32'), '0')))
                ) @ #j.2)
              ∧
               #j.2 < #j.1)  ∥
             ((∀ #k.
                (!KU( Extract('0',
                              Extract(p_gxy, Extract(Expand(ms, <'rms', h(messages)>, '32'), '0')))
                 ) @ #k)
               ⇒
                ¬(#k < #j.1)) ∧
              (∃ actor #l.
                (RevealPSK( actor,
                            Expand(Extract('0',
                                           Extract(p_gxy,
                                                   Extract(Expand(ms, <'rms', h(messages)>, '32'), '0'))),
                                   <'serverats', 
                                    h(<
                                       <
                                        <
                                         <
                                          <
                                           <
                                            <
                                             <'0', '1', '0x0303', ~tid, '0', $cipher_suites, '0', 
                                              <'43', '0x0304'>, <'10', $g1, $g>, <'40', $g1, $g1^~x>, 
                                              <'45', '0', '1'>, <'42', '0'>, '41', 
                                              <p_psk_id, mask(ticket_age_add, $ticket_age)>, 
                                              hmac(<
                                                    Expand(Expand(Extract(Expand(ms, <'rms', h(messages)>,
                                                                                 '32'),
                                                                          '0'),
                                                                  <'res', 'pbk'>, '32'),
                                                           <'0', '0'>, '32'), 
                                                    h(<'0', '1', '0x0303', ~tid, '0', $cipher_suites, '0', 
                                                       <'43', '0x0304'>, <'10', $g1, $g>, 
                                                       <'40', $g1, $g1^~x>, <'45', '0', '1'>, <'42', '0'>, 
                                                       '41', <p_psk_id, mask(ticket_age_add, $ticket_age)>, 
                                                       '0'>)
                                                   >)
                                             >, 
                                             '6', '0x0303', '40', $g>, 
                                            '1', '0x0303', ~tid, '0', $cipher_suites.1, '0', 
                                            <'43', '0x0304'>, <'10', $g1, $g>, <'13', $sig_algs>, '40', $g, 
                                            $g^~x.1>, 
                                           '2', '0x0303', p_ns, $cipher_suite, <'13', $sig_algs.1>, '40', $g, 
                                           p_gy>, 
                                          '8', $exts>, 
                                         '11', '0', pk(~ltkS)>, 
                                        '15', 
                                        sign(<'server_cv', 
                                              h(<
                                                 <
                                                  <
                                                   <
                                                    <
                                                     <'0', '1', '0x0303', ~tid, '0', $cipher_suites, '0', 
                                                      <'43', '0x0304'>, <'10', $g1, $g>, <'40', $g1, $g1^~x>, 
                                                      <'45', '0', '1'>, <'42', '0'>, '41', 
                                                      <p_psk_id, mask(ticket_age_add, $ticket_age)>, 
                                                      hmac(<
                                                            Expand(Expand(Extract(Expand(ms,
                                                                                         <'rms', h(messages)>,
                                                                                         '32'),
                                                                                  '0'),
                                                                          <'res', 'pbk'>, '32'),
                                                                   <'0', '0'>, '32'), 
                                                            h(<'0', '1', '0x0303', ~tid, '0', $cipher_suites, 
                                                               '0', <'43', '0x0304'>, <'10', $g1, $g>, 
                                                               <'40', $g1, $g1^~x>, <'45', '0', '1'>, 
                                                               <'42', '0'>, '41', 
                                                               <p_psk_id, mask(ticket_age_add, $ticket_age)>, 
                                                               '0'>)
                                                           >)
                                                     >, 
                                                     '6', '0x0303', '40', $g>, 
                                                    '1', '0x0303', ~tid, '0', $cipher_suites.1, '0', 
                                                    <'43', '0x0304'>, <'10', $g1, $g>, <'13', $sig_algs>, 
                                                    '40', $g, $g^~x.1>, 
                                                   '2', '0x0303', p_ns, $cipher_suite, <'13', $sig_algs.1>, 
                                                   '40', $g, p_gy>, 
                                                  '8', $exts>, 
                                                 '11', '0', pk(~ltkS)>)
                                             >,
                                             ~ltkS)
                                       >, 
                                       '20', 
                                       hmac(<
                                             Expand(Expand(Extract(p_gxy,
                                                                   Extract(Expand(ms, <'rms', h(messages)>,
                                                                                  '32'),
                                                                           '0')),
                                                           <'serverhts', 
                                                            h(<
                                                               <
                                                                <
                                                                 <
                                                                  <
                                                                   <
                                                                    <'0', '1', '0x0303', ~tid, '0', 
                                                                     $cipher_suites, '0', <'43', '0x0304'>, 
                                                                     <'10', $g1, $g>, <'40', $g1, $g1^~x>, 
                                                                     <'45', '0', '1'>, <'42', '0'>, '41', 
                                                                     <p_psk_id, 
                                                                      mask(ticket_age_add, $ticket_age)>, 
                                                                     hmac(<
                                                                           Expand(Expand(Extract(Expand(ms,
                                                                                                        <
                                                                                                         'rms', 
                                                                                                         h(messages)
                                                                                                        >,
                                                                                                        '32'),
                                                                                                 '0'),
                                                                                         <'res', 'pbk'>,
                                                                                         '32'),
                                                                                  <'0', '0'>, '32'), 
                                                                           h(<'0', '1', '0x0303', ~tid, '0', 
                                                                              $cipher_suites, '0', 
                                                                              <'43', '0x0304'>, 
                                                                              <'10', $g1, $g>, 
                                                                              <'40', $g1, $g1^~x>, 
                                                                              <'45', '0', '1'>, <'42', '0'>, 
                                                                              '41', 
                                                                              <p_psk_id, 
                                                                               mask(ticket_age_add,
                                                                                    $ticket_age)
                                                                              >, 
                                                                              '0'>)
                                                                          >)
                                                                    >, 
                                                                    '6', '0x0303', '40', $g>, 
                                                                   '1', '0x0303', ~tid, '0', 
                                                                   $cipher_suites.1, '0', <'43', '0x0304'>, 
                                                                   <'10', $g1, $g>, <'13', $sig_algs>, '40', 
                                                                   $g, $g^~x.1>, 
                                                                  '2', '0x0303', p_ns, $cipher_suite, 
                                                                  <'13', $sig_algs.1>, '40', $g, p_gy>, 
                                                                 '8', $exts>, 
                                                                '11', '0', pk(~ltkS)>, 
                                                               '15', 
                                                               sign(<'server_cv', 
                                                                     h(<
                                                                        <
                                                                         <
                                                                          <
                                                                           <
                                                                            <'0', '1', '0x0303', ~tid, '0', 
                                                                             $cipher_suites, '0', 
                                                                             <'43', '0x0304'>, 
                                                                             <'10', $g1, $g>, 
                                                                             <'40', $g1, $g1^~x>, 
                                                                             <'45', '0', '1'>, <'42', '0'>, 
                                                                             '41', 
                                                                             <p_psk_id, 
                                                                              mask(ticket_age_add,
                                                                                   $ticket_age)
                                                                             >, 
                                                                             hmac(<
                                                                                   Expand(Expand(Extract(Expand(ms,
                                                                                                                <
                                                                                                                 'rms', 
                                                                                                                 h(messages)
                                                                                                                >,
                                                                                                                '32'),
                                                                                                         '0'),
                                                                                                 <'res', 'pbk'
                                                                                                 >,
                                                                                                 '32'),
                                                                                          <'0', '0'>, '32'), 
                                                                                   h(<'0', '1', '0x0303', 
                                                                                      ~tid, '0', 
                                                                                      $cipher_suites, '0', 
                                                                                      <'43', '0x0304'>, 
                                                                                      <'10', $g1, $g>, 
                                                                                      <'40', $g1, $g1^~x>, 
                                                                                      <'45', '0', '1'>, 
                                                                                      <'42', '0'>, '41', 
                                                                                      <p_psk_id, 
                                                                                       mask(ticket_age_add,
                                                                                            $ticket_age)
                                                                                      >, 
                                                                                      '0'>)
                                                                                  >)
                                                                            >, 
                                                                            '6', '0x0303', '40', $g>, 
                                                                           '1', '0x0303', ~tid, '0', 
                                                                           $cipher_suites.1, '0', 
                                                                           <'43', '0x0304'>, <'10', $g1, $g>, 
                                                                           <'13', $sig_algs>, '40', $g, 
                                                                           $g^~x.1>, 
                                                                          '2', '0x0303', p_ns, $cipher_suite, 
                                                                          <'13', $sig_algs.1>, '40', $g, p_gy
                                                                         >, 
                                                                         '8', $exts>, 
                                                                        '11', '0', pk(~ltkS)>)
                                                                    >,
                                                                    ~ltkS)
                                                              >)
                                                           >,
                                                           '32'),
                                                    <'fin', '0'>, '32'), 
                                             h(<
                                                <
                                                 <
                                                  <
                                                   <
                                                    <
                                                     <'0', '1', '0x0303', ~tid, '0', $cipher_suites, '0', 
                                                      <'43', '0x0304'>, <'10', $g1, $g>, <'40', $g1, $g1^~x>, 
                                                      <'45', '0', '1'>, <'42', '0'>, '41', 
                                                      <p_psk_id, mask(ticket_age_add, $ticket_age)>, 
                                                      hmac(<
                                                            Expand(Expand(Extract(Expand(ms,
                                                                                         <'rms', h(messages)>,
                                                                                         '32'),
                                                                                  '0'),
                                                                          <'res', 'pbk'>, '32'),
                                                                   <'0', '0'>, '32'), 
                                                            h(<'0', '1', '0x0303', ~tid, '0', $cipher_suites, 
                                                               '0', <'43', '0x0304'>, <'10', $g1, $g>, 
                                                               <'40', $g1, $g1^~x>, <'45', '0', '1'>, 
                                                               <'42', '0'>, '41', 
                                                               <p_psk_id, mask(ticket_age_add, $ticket_age)>, 
                                                               '0'>)
                                                           >)
                                                     >, 
                                                     '6', '0x0303', '40', $g>, 
                                                    '1', '0x0303', ~tid, '0', $cipher_suites.1, '0', 
                                                    <'43', '0x0304'>, <'10', $g1, $g>, <'13', $sig_algs>, 
                                                    '40', $g, $g^~x.1>, 
                                                   '2', '0x0303', p_ns, $cipher_suite, <'13', $sig_algs.1>, 
                                                   '40', $g, p_gy>, 
                                                  '8', $exts>, 
                                                 '11', '0', pk(~ltkS)>, 
                                                '15', 
                                                sign(<'server_cv', 
                                                      h(<
                                                         <
                                                          <
                                                           <
                                                            <
                                                             <'0', '1', '0x0303', ~tid, '0', $cipher_suites, 
                                                              '0', <'43', '0x0304'>, <'10', $g1, $g>, 
                                                              <'40', $g1, $g1^~x>, <'45', '0', '1'>, 
                                                              <'42', '0'>, '41', 
                                                              <p_psk_id, mask(ticket_age_add, $ticket_age)>, 
                                                              hmac(<
                                                                    Expand(Expand(Extract(Expand(ms,
                                                                                                 <'rms', 
                                                                                                  h(messages)
                                                                                                 >,
                                                                                                 '32'),
                                                                                          '0'),
                                                                                  <'res', 'pbk'>, '32'),
                                                                           <'0', '0'>, '32'), 
                                                                    h(<'0', '1', '0x0303', ~tid, '0', 
                                                                       $cipher_suites, '0', <'43', '0x0304'>, 
                                                                       <'10', $g1, $g>, <'40', $g1, $g1^~x>, 
                                                                       <'45', '0', '1'>, <'42', '0'>, '41', 
                                                                       <p_psk_id, 
                                                                        mask(ticket_age_add, $ticket_age)>, 
                                                                       '0'>)
                                                                   >)
                                                             >, 
                                                             '6', '0x0303', '40', $g>, 
                                                            '1', '0x0303', ~tid, '0', $cipher_suites.1, '0', 
                                                            <'43', '0x0304'>, <'10', $g1, $g>, 
                                                            <'13', $sig_algs>, '40', $g, $g^~x.1>, 
                                                           '2', '0x0303', p_ns, $cipher_suite, 
                                                           <'13', $sig_algs.1>, '40', $g, p_gy>, 
                                                          '8', $exts>, 
                                                         '11', '0', pk(~ltkS)>)
                                                     >,
                                                     ~ltkS)
                                               >)
                                            >)
                                      >)
                                   >,
                                   '32')
                 ) @ #l)
               ∧
                #l < #j.1)) )
        case case_1
        solve( (∃ #r. (RevLtk( $S ) @ #r) ∧ #r < #vr)  ∥
               (∃ tid3 x #r. (RevDHExp( tid3, $S, x ) @ #r) ∧ #r < #vr)  ∥
               (∃ tid4 y #r. (RevDHExp( tid4, $C, y ) @ #r) ∧ #r < #vr)  ∥
               (∃ rms #r. (RevealPSK( $C, rms ) @ #r) ∧ #r < #k.1)  ∥
               (∃ rms #r. (RevealPSK( $S, rms ) @ #r) ∧ #r < #k.1) )
          case case_1
          by contradiction /* from formulas */
        next
          case case_2
          by contradiction /* from formulas */
        next
          case case_3
          by contradiction /* from formulas */
        next
          case case_4
          solve( (∃ #r. (RevLtk( $S ) @ #r) ∧ #r < #vr)  ∥
                 (∃ tid3 x #r. (RevDHExp( tid3, $S, x ) @ #r) ∧ #r < #vr)  ∥
                 (∃ tid4 y #r. (RevDHExp( tid4, $C, y ) @ #r) ∧ #r < #vr)  ∥
                 (∃ rms #r. (RevealPSK( $C, rms ) @ #r) ∧ #r < #vr)  ∥
                 (∃ rms #r. (RevealPSK( $S, rms ) @ #r) ∧ #r < #vr) )
            case case_1
            by contradiction /* from formulas */
          next
            case case_2
            by contradiction /* from formulas */
          next
            case case_3
            by contradiction /* from formulas */
          next
            case case_4
            by contradiction /* from formulas */
          next
            case case_5
            by contradiction /* from formulas */
          qed
        next
          case case_5
          solve( (∃ #r. (RevLtk( $S ) @ #r) ∧ #r < #vr)  ∥
                 (∃ tid3 x #r. (RevDHExp( tid3, $S, x ) @ #r) ∧ #r < #vr)  ∥
                 (∃ tid4 y #r. (RevDHExp( tid4, $C, y ) @ #r) ∧ #r < #vr)  ∥
                 (∃ rms #r. (RevealPSK( $C, rms ) @ #r) ∧ #r < #vr)  ∥
                 (∃ rms #r. (RevealPSK( $S, rms ) @ #r) ∧ #r < #vr) )
            case case_1
            by contradiction /* from formulas */
          next
            case case_2
            by contradiction /* from formulas */
          next
            case case_3
            by contradiction /* from formulas */
          next
            case case_4
            by contradiction /* from formulas */
          next
            case case_5
            by contradiction /* from formulas */
          qed
        qed
      next
        case case_2
        by solve( SecretPSK( $A,
                             Expand(Extract('0',
                                            Extract(p_gxy,
                                                    Extract(Expand(ms, <'rms', h(messages)>, '32'), '0'))),
                                    <'serverats', 
                                     h(<
                                        <
                                         <
                                          <
                                           <
                                            <
                                             <
                                              <'0', '1', '0x0303', ~tid, '0', $cipher_suites, '0', 
                                               <'43', '0x0304'>, <'10', $g1, $g>, <'40', $g1, $g1^~x>, 
                                               <'45', '0', '1'>, <'42', '0'>, '41', 
                                               <p_psk_id, mask(ticket_age_add, $ticket_age)>, 
                                               hmac(<
                                                     Expand(Expand(Extract(Expand(ms, <'rms', h(messages)>,
                                                                                  '32'),
                                                                           '0'),
                                                                   <'res', 'pbk'>, '32'),
                                                            <'0', '0'>, '32'), 
                                                     h(<'0', '1', '0x0303', ~tid, '0', $cipher_suites, '0', 
                                                        <'43', '0x0304'>, <'10', $g1, $g>, 
                                                        <'40', $g1, $g1^~x>, <'45', '0', '1'>, <'42', '0'>, 
                                                        '41', <p_psk_id, mask(ticket_age_add, $ticket_age)>, 
                                                        '0'>)
                                                    >)
                                              >, 
                                              '6', '0x0303', '40', $g>, 
                                             '1', '0x0303', ~tid, '0', $cipher_suites.1, '0', 
                                             <'43', '0x0304'>, <'10', $g1, $g>, <'13', $sig_algs>, '40', $g, 
                                             $g^~x.1>, 
                                            '2', '0x0303', p_ns, $cipher_suite, <'13', $sig_algs.1>, '40', 
                                            $g, p_gy>, 
                                           '8', $exts>, 
                                          '11', '0', pk(~ltkS)>, 
                                         '15', 
                                         sign(<'server_cv', 
                                               h(<
                                                  <
                                                   <
                                                    <
                                                     <
                                                      <'0', '1', '0x0303', ~tid, '0', $cipher_suites, '0', 
                                                       <'43', '0x0304'>, <'10', $g1, $g>, 
                                                       <'40', $g1, $g1^~x>, <'45', '0', '1'>, <'42', '0'>, 
                                                       '41', <p_psk_id, mask(ticket_age_add, $ticket_age)>, 
                                                       hmac(<
                                                             Expand(Expand(Extract(Expand(ms,
                                                                                          <'rms', h(messages)
                                                                                          >,
                                                                                          '32'),
                                                                                   '0'),
                                                                           <'res', 'pbk'>, '32'),
                                                                    <'0', '0'>, '32'), 
                                                             h(<'0', '1', '0x0303', ~tid, '0', 
                                                                $cipher_suites, '0', <'43', '0x0304'>, 
                                                                <'10', $g1, $g>, <'40', $g1, $g1^~x>, 
                                                                <'45', '0', '1'>, <'42', '0'>, '41', 
                                                                <p_psk_id, mask(ticket_age_add, $ticket_age)
                                                                >, 
                                                                '0'>)
                                                            >)
                                                      >, 
                                                      '6', '0x0303', '40', $g>, 
                                                     '1', '0x0303', ~tid, '0', $cipher_suites.1, '0', 
                                                     <'43', '0x0304'>, <'10', $g1, $g>, <'13', $sig_algs>, 
                                                     '40', $g, $g^~x.1>, 
                                                    '2', '0x0303', p_ns, $cipher_suite, <'13', $sig_algs.1>, 
                                                    '40', $g, p_gy>, 
                                                   '8', $exts>, 
                                                  '11', '0', pk(~ltkS)>)
                                              >,
                                              ~ltkS)
                                        >, 
                                        '20', 
                                        hmac(<
                                              Expand(Expand(Extract(p_gxy,
                                                                    Extract(Expand(ms, <'rms', h(messages)>,
                                                                                   '32'),
                                                                            '0')),
                                                            <'serverhts', 
                                                             h(<
                                                                <
                                                                 <
                                                                  <
                                                                   <
                                                                    <
                                                                     <'0', '1', '0x0303', ~tid, '0', 
                                                                      $cipher_suites, '0', <'43', '0x0304'>, 
                                                                      <'10', $g1, $g>, <'40', $g1, $g1^~x>, 
                                                                      <'45', '0', '1'>, <'42', '0'>, '41', 
                                                                      <p_psk_id, 
                                                                       mask(ticket_age_add, $ticket_age)>, 
                                                                      hmac(<
                                                                            Expand(Expand(Extract(Expand(ms,
                                                                                                         <
                                                                                                          'rms', 
                                                                                                          h(messages)
                                                                                                         >,
                                                                                                         '32'),
                                                                                                  '0'),
                                                                                          <'res', 'pbk'>,
                                                                                          '32'),
                                                                                   <'0', '0'>, '32'), 
                                                                            h(<'0', '1', '0x0303', ~tid, '0', 
                                                                               $cipher_suites, '0', 
                                                                               <'43', '0x0304'>, 
                                                                               <'10', $g1, $g>, 
                                                                               <'40', $g1, $g1^~x>, 
                                                                               <'45', '0', '1'>, <'42', '0'>, 
                                                                               '41', 
                                                                               <p_psk_id, 
                                                                                mask(ticket_age_add,
                                                                                     $ticket_age)
                                                                               >, 
                                                                               '0'>)
                                                                           >)
                                                                     >, 
                                                                     '6', '0x0303', '40', $g>, 
                                                                    '1', '0x0303', ~tid, '0', 
                                                                    $cipher_suites.1, '0', <'43', '0x0304'>, 
                                                                    <'10', $g1, $g>, <'13', $sig_algs>, '40', 
                                                                    $g, $g^~x.1>, 
                                                                   '2', '0x0303', p_ns, $cipher_suite, 
                                                                   <'13', $sig_algs.1>, '40', $g, p_gy>, 
                                                                  '8', $exts>, 
                                                                 '11', '0', pk(~ltkS)>, 
                                                                '15', 
                                                                sign(<'server_cv', 
                                                                      h(<
                                                                         <
                                                                          <
                                                                           <
                                                                            <
                                                                             <'0', '1', '0x0303', ~tid, '0', 
                                                                              $cipher_suites, '0', 
                                                                              <'43', '0x0304'>, 
                                                                              <'10', $g1, $g>, 
                                                                              <'40', $g1, $g1^~x>, 
                                                                              <'45', '0', '1'>, <'42', '0'>, 
                                                                              '41', 
                                                                              <p_psk_id, 
                                                                               mask(ticket_age_add,
                                                                                    $ticket_age)
                                                                              >, 
                                                                              hmac(<
                                                                                    Expand(Expand(Extract(Expand(ms,
                                                                                                                 <
                                                                                                                  'rms', 
                                                                                                                  h(messages)
                                                                                                                 >,
                                                                                                                 '32'),
                                                                                                          '0'),
                                                                                                  <'res', 
                                                                                                   'pbk'>,
                                                                                                  '32'),
                                                                                           <'0', '0'>, '32'), 
                                                                                    h(<'0', '1', '0x0303', 
                                                                                       ~tid, '0', 
                                                                                       $cipher_suites, '0', 
                                                                                       <'43', '0x0304'>, 
                                                                                       <'10', $g1, $g>, 
                                                                                       <'40', $g1, $g1^~x>, 
                                                                                       <'45', '0', '1'>, 
                                                                                       <'42', '0'>, '41', 
                                                                                       <p_psk_id, 
                                                                                        mask(ticket_age_add,
                                                                                             $ticket_age)
                                                                                       >, 
                                                                                       '0'>)
                                                                                   >)
                                                                             >, 
                                                                             '6', '0x0303', '40', $g>, 
                                                                            '1', '0x0303', ~tid, '0', 
                                                                            $cipher_suites.1, '0', 
                                                                            <'43', '0x0304'>, 
                                                                            <'10', $g1, $g>, 
                                                                            <'13', $sig_algs>, '40', $g, 
                                                                            $g^~x.1>, 
                                                                           '2', '0x0303', p_ns, 
                                                                           $cipher_suite, 
                                                                           <'13', $sig_algs.1>, '40', $g, p_gy
                                                                          >, 
                                                                          '8', $exts>, 
                                                                         '11', '0', pk(~ltkS)>)
                                                                     >,
                                                                     ~ltkS)
                                                               >)
                                                            >,
                                                            '32'),
                                                     <'fin', '0'>, '32'), 
                                              h(<
                                                 <
                                                  <
                                                   <
                                                    <
                                                     <
                                                      <'0', '1', '0x0303', ~tid, '0', $cipher_suites, '0', 
                                                       <'43', '0x0304'>, <'10', $g1, $g>, 
                                                       <'40', $g1, $g1^~x>, <'45', '0', '1'>, <'42', '0'>, 
                                                       '41', <p_psk_id, mask(ticket_age_add, $ticket_age)>, 
                                                       hmac(<
                                                             Expand(Expand(Extract(Expand(ms,
                                                                                          <'rms', h(messages)
                                                                                          >,
                                                                                          '32'),
                                                                                   '0'),
                                                                           <'res', 'pbk'>, '32'),
                                                                    <'0', '0'>, '32'), 
                                                             h(<'0', '1', '0x0303', ~tid, '0', 
                                                                $cipher_suites, '0', <'43', '0x0304'>, 
                                                                <'10', $g1, $g>, <'40', $g1, $g1^~x>, 
                                                                <'45', '0', '1'>, <'42', '0'>, '41', 
                                                                <p_psk_id, mask(ticket_age_add, $ticket_age)
                                                                >, 
                                                                '0'>)
                                                            >)
                                                      >, 
                                                      '6', '0x0303', '40', $g>, 
                                                     '1', '0x0303', ~tid, '0', $cipher_suites.1, '0', 
                                                     <'43', '0x0304'>, <'10', $g1, $g>, <'13', $sig_algs>, 
                                                     '40', $g, $g^~x.1>, 
                                                    '2', '0x0303', p_ns, $cipher_suite, <'13', $sig_algs.1>, 
                                                    '40', $g, p_gy>, 
                                                   '8', $exts>, 
                                                  '11', '0', pk(~ltkS)>, 
                                                 '15', 
                                                 sign(<'server_cv', 
                                                       h(<
                                                          <
                                                           <
                                                            <
                                                             <
                                                              <'0', '1', '0x0303', ~tid, '0', $cipher_suites, 
                                                               '0', <'43', '0x0304'>, <'10', $g1, $g>, 
                                                               <'40', $g1, $g1^~x>, <'45', '0', '1'>, 
                                                               <'42', '0'>, '41', 
                                                               <p_psk_id, mask(ticket_age_add, $ticket_age)>, 
                                                               hmac(<
                                                                     Expand(Expand(Extract(Expand(ms,
                                                                                                  <'rms', 
                                                                                                   h(messages)
                                                                                                  >,
                                                                                                  '32'),
                                                                                           '0'),
                                                                                   <'res', 'pbk'>, '32'),
                                                                            <'0', '0'>, '32'), 
                                                                     h(<'0', '1', '0x0303', ~tid, '0', 
                                                                        $cipher_suites, '0', 
                                                                        <'43', '0x0304'>, <'10', $g1, $g>, 
                                                                        <'40', $g1, $g1^~x>, 
                                                                        <'45', '0', '1'>, <'42', '0'>, '41', 
                                                                        <p_psk_id, 
                                                                         mask(ticket_age_add, $ticket_age)>, 
                                                                        '0'>)
                                                                    >)
                                                              >, 
                                                              '6', '0x0303', '40', $g>, 
                                                             '1', '0x0303', ~tid, '0', $cipher_suites.1, '0', 
                                                             <'43', '0x0304'>, <'10', $g1, $g>, 
                                                             <'13', $sig_algs>, '40', $g, $g^~x.1>, 
                                                            '2', '0x0303', p_ns, $cipher_suite, 
                                                            <'13', $sig_algs.1>, '40', $g, p_gy>, 
                                                           '8', $exts>, 
                                                          '11', '0', pk(~ltkS)>)
                                                      >,
                                                      ~ltkS)
                                                >)
                                             >)
                                       >)
                                    >,
                                    '32')
                  ) ▶₀ #l )
      qed
    next
      case recv_server_auth_case_05
      solve( (∃ #j.2.
               (!KU( Extract('0', Extract(p_gxy, Extract(~res_psk, '0'))) ) @ #j.2)
              ∧
               #j.2 < #j.1)  ∥
             ((∀ #k.
                (!KU( Extract('0', Extract(p_gxy, Extract(~res_psk, '0'))) ) @ #k)
               ⇒
                ¬(#k < #j.1)) ∧
              (∃ actor #l.
                (RevealPSK( actor,
                            Expand(Extract('0', Extract(p_gxy, Extract(~res_psk, '0'))),
                                   <'serverats', 
                                    h(<
                                       <
                                        <
                                         <
                                          <
                                           <'0', '1', '0x0303', ~tid, '0', $cipher_suites, '0', 
                                            <'43', '0x0304'>, <'10', $g, $g2>, <'40', $g, $g^~x>, 
                                            <'45', '0', '1'>, <'42', '0'>, '41', 
                                            <~ticket, mask(~ticket_age_add, $ticket_age)>, 
                                            hmac(<
                                                  Expand(Expand(Extract(~res_psk, '0'), <'ext', 'pbk'>, '32'),
                                                         <'0', '0'>, '32'), 
                                                  h(<'0', '1', '0x0303', ~tid, '0', $cipher_suites, '0', 
                                                     <'43', '0x0304'>, <'10', $g, $g2>, <'40', $g, $g^~x>, 
                                                     <'45', '0', '1'>, <'42', '0'>, '41', 
                                                     <~ticket, mask(~ticket_age_add, $ticket_age)>, '0'>)
                                                 >)
                                           >, 
                                           '2', '0x0303', p_ns, $cipher_suite, <'13', $sig_algs>, '40', $g, 
                                           p_gy>, 
                                          '8', $exts>, 
                                         '11', '0', pk(~ltkS)>, 
                                        '15', 
                                        sign(<'server_cv', 
                                              h(<
                                                 <
                                                  <
                                                   <'0', '1', '0x0303', ~tid, '0', $cipher_suites, '0', 
                                                    <'43', '0x0304'>, <'10', $g, $g2>, <'40', $g, $g^~x>, 
                                                    <'45', '0', '1'>, <'42', '0'>, '41', 
                                                    <~ticket, mask(~ticket_age_add, $ticket_age)>, 
                                                    hmac(<
                                                          Expand(Expand(Extract(~res_psk, '0'),
                                                                        <'ext', 'pbk'>, '32'),
                                                                 <'0', '0'>, '32'), 
                                                          h(<'0', '1', '0x0303', ~tid, '0', $cipher_suites, 
                                                             '0', <'43', '0x0304'>, <'10', $g, $g2>, 
                                                             <'40', $g, $g^~x>, <'45', '0', '1'>, 
                                                             <'42', '0'>, '41', 
                                                             <~ticket, mask(~ticket_age_add, $ticket_age)>, 
                                                             '0'>)
                                                         >)
                                                   >, 
                                                   '2', '0x0303', p_ns, $cipher_suite, <'13', $sig_algs>, 
                                                   '40', $g, p_gy>, 
                                                  '8', $exts>, 
                                                 '11', '0', pk(~ltkS)>)
                                             >,
                                             ~ltkS)
                                       >, 
                                       '20', 
                                       hmac(<
                                             Expand(Expand(Extract(p_gxy, Extract(~res_psk, '0')),
                                                           <'serverhts', 
                                                            h(<
                                                               <
                                                                <
                                                                 <
                                                                  <'0', '1', '0x0303', ~tid, '0', 
                                                                   $cipher_suites, '0', <'43', '0x0304'>, 
                                                                   <'10', $g, $g2>, <'40', $g, $g^~x>, 
                                                                   <'45', '0', '1'>, <'42', '0'>, '41', 
                                                                   <~ticket, 
                                                                    mask(~ticket_age_add, $ticket_age)>, 
                                                                   hmac(<
                                                                         Expand(Expand(Extract(~res_psk, '0'),
                                                                                       <'ext', 'pbk'>, '32'),
                                                                                <'0', '0'>, '32'), 
                                                                         h(<'0', '1', '0x0303', ~tid, '0', 
                                                                            $cipher_suites, '0', 
                                                                            <'43', '0x0304'>, 
                                                                            <'10', $g, $g2>, 
                                                                            <'40', $g, $g^~x>, 
                                                                            <'45', '0', '1'>, <'42', '0'>, 
                                                                            '41', 
                                                                            <~ticket, 
                                                                             mask(~ticket_age_add,
                                                                                  $ticket_age)
                                                                            >, 
                                                                            '0'>)
                                                                        >)
                                                                  >, 
                                                                  '2', '0x0303', p_ns, $cipher_suite, 
                                                                  <'13', $sig_algs>, '40', $g, p_gy>, 
                                                                 '8', $exts>, 
                                                                '11', '0', pk(~ltkS)>, 
                                                               '15', 
                                                               sign(<'server_cv', 
                                                                     h(<
                                                                        <
                                                                         <
                                                                          <'0', '1', '0x0303', ~tid, '0', 
                                                                           $cipher_suites, '0', 
                                                                           <'43', '0x0304'>, <'10', $g, $g2>, 
                                                                           <'40', $g, $g^~x>, 
                                                                           <'45', '0', '1'>, <'42', '0'>, 
                                                                           '41', 
                                                                           <~ticket, 
                                                                            mask(~ticket_age_add, $ticket_age)
                                                                           >, 
                                                                           hmac(<
                                                                                 Expand(Expand(Extract(~res_psk,
                                                                                                       '0'),
                                                                                               <'ext', 'pbk'>,
                                                                                               '32'),
                                                                                        <'0', '0'>, '32'), 
                                                                                 h(<'0', '1', '0x0303', ~tid, 
                                                                                    '0', $cipher_suites, '0', 
                                                                                    <'43', '0x0304'>, 
                                                                                    <'10', $g, $g2>, 
                                                                                    <'40', $g, $g^~x>, 
                                                                                    <'45', '0', '1'>, 
                                                                                    <'42', '0'>, '41', 
                                                                                    <~ticket, 
                                                                                     mask(~ticket_age_add,
                                                                                          $ticket_age)
                                                                                    >, 
                                                                                    '0'>)
                                                                                >)
                                                                          >, 
                                                                          '2', '0x0303', p_ns, $cipher_suite, 
                                                                          <'13', $sig_algs>, '40', $g, p_gy>, 
                                                                         '8', $exts>, 
                                                                        '11', '0', pk(~ltkS)>)
                                                                    >,
                                                                    ~ltkS)
                                                              >)
                                                           >,
                                                           '32'),
                                                    <'fin', '0'>, '32'), 
                                             h(<
                                                <
                                                 <
                                                  <
                                                   <'0', '1', '0x0303', ~tid, '0', $cipher_suites, '0', 
                                                    <'43', '0x0304'>, <'10', $g, $g2>, <'40', $g, $g^~x>, 
                                                    <'45', '0', '1'>, <'42', '0'>, '41', 
                                                    <~ticket, mask(~ticket_age_add, $ticket_age)>, 
                                                    hmac(<
                                                          Expand(Expand(Extract(~res_psk, '0'),
                                                                        <'ext', 'pbk'>, '32'),
                                                                 <'0', '0'>, '32'), 
                                                          h(<'0', '1', '0x0303', ~tid, '0', $cipher_suites, 
                                                             '0', <'43', '0x0304'>, <'10', $g, $g2>, 
                                                             <'40', $g, $g^~x>, <'45', '0', '1'>, 
                                                             <'42', '0'>, '41', 
                                                             <~ticket, mask(~ticket_age_add, $ticket_age)>, 
                                                             '0'>)
                                                         >)
                                                   >, 
                                                   '2', '0x0303', p_ns, $cipher_suite, <'13', $sig_algs>, 
                                                   '40', $g, p_gy>, 
                                                  '8', $exts>, 
                                                 '11', '0', pk(~ltkS)>, 
                                                '15', 
                                                sign(<'server_cv', 
                                                      h(<
                                                         <
                                                          <
                                                           <'0', '1', '0x0303', ~tid, '0', $cipher_suites, 
                                                            '0', <'43', '0x0304'>, <'10', $g, $g2>, 
                                                            <'40', $g, $g^~x>, <'45', '0', '1'>, <'42', '0'>, 
                                                            '41', 
                                                            <~ticket, mask(~ticket_age_add, $ticket_age)>, 
                                                            hmac(<
                                                                  Expand(Expand(Extract(~res_psk, '0'),
                                                                                <'ext', 'pbk'>, '32'),
                                                                         <'0', '0'>, '32'), 
                                                                  h(<'0', '1', '0x0303', ~tid, '0', 
                                                                     $cipher_suites, '0', <'43', '0x0304'>, 
                                                                     <'10', $g, $g2>, <'40', $g, $g^~x>, 
                                                                     <'45', '0', '1'>, <'42', '0'>, '41', 
                                                                     <~ticket, 
                                                                      mask(~ticket_age_add, $ticket_age)>, 
                                                                     '0'>)
                                                                 >)
                                                           >, 
                                                           '2', '0x0303', p_ns, $cipher_suite, 
                                                           <'13', $sig_algs>, '40', $g, p_gy>, 
                                                          '8', $exts>, 
                                                         '11', '0', pk(~ltkS)>)
                                                     >,
                                                     ~ltkS)
                                               >)
                                            >)
                                      >)
                                   >,
                                   '32')
                 ) @ #l)
               ∧
                #l < #j.1)) )
        case case_1
        solve( (∃ #r. (RevLtk( $S ) @ #r) ∧ #r < #vr)  ∥
               (∃ tid3 x #r. (RevDHExp( tid3, $S, x ) @ #r) ∧ #r < #vr)  ∥
               (∃ tid4 y #r. (RevDHExp( tid4, $C, y ) @ #r) ∧ #r < #vr)  ∥
               (∃ rms #r. (RevealPSK( $C, rms ) @ #r) ∧ #r < #k.1)  ∥
               (∃ rms #r. (RevealPSK( $S, rms ) @ #r) ∧ #r < #k.1) )
          case case_1
          by contradiction /* from formulas */
        next
          case case_2
          by contradiction /* from formulas */
        next
          case case_3
          by contradiction /* from formulas */
        next
          case case_4
          solve( (∃ #r. (RevLtk( $S ) @ #r) ∧ #r < #vr)  ∥
                 (∃ tid3 x #r. (RevDHExp( tid3, $S, x ) @ #r) ∧ #r < #vr)  ∥
                 (∃ tid4 y #r. (RevDHExp( tid4, $C, y ) @ #r) ∧ #r < #vr)  ∥
                 (∃ rms #r. (RevealPSK( $C, rms ) @ #r) ∧ #r < #vr)  ∥
                 (∃ rms #r. (RevealPSK( $S, rms ) @ #r) ∧ #r < #vr) )
            case case_1
            by contradiction /* from formulas */
          next
            case case_2
            by contradiction /* from formulas */
          next
            case case_3
            by contradiction /* from formulas */
          next
            case case_4
            by contradiction /* from formulas */
          next
            case case_5
            by contradiction /* from formulas */
          qed
        next
          case case_5
          solve( (∃ #r. (RevLtk( $S ) @ #r) ∧ #r < #vr)  ∥
                 (∃ tid3 x #r. (RevDHExp( tid3, $S, x ) @ #r) ∧ #r < #vr)  ∥
                 (∃ tid4 y #r. (RevDHExp( tid4, $C, y ) @ #r) ∧ #r < #vr)  ∥
                 (∃ rms #r. (RevealPSK( $C, rms ) @ #r) ∧ #r < #vr)  ∥
                 (∃ rms #r. (RevealPSK( $S, rms ) @ #r) ∧ #r < #vr) )
            case case_1
            by contradiction /* from formulas */
          next
            case case_2
            by contradiction /* from formulas */
          next
            case case_3
            by contradiction /* from formulas */
          next
            case case_4
            by contradiction /* from formulas */
          next
            case case_5
            by contradiction /* from formulas */
          qed
        qed
      next
        case case_2
        by solve( SecretPSK( $A,
                             Expand(Extract('0', Extract(p_gxy, Extract(~res_psk, '0'))),
                                    <'serverats', 
                                     h(<
                                        <
                                         <
                                          <
                                           <
                                            <'0', '1', '0x0303', ~tid, '0', $cipher_suites, '0', 
                                             <'43', '0x0304'>, <'10', $g, $g2>, <'40', $g, $g^~x>, 
                                             <'45', '0', '1'>, <'42', '0'>, '41', 
                                             <~ticket, mask(~ticket_age_add, $ticket_age)>, 
                                             hmac(<
                                                   Expand(Expand(Extract(~res_psk, '0'), <'ext', 'pbk'>,
                                                                 '32'),
                                                          <'0', '0'>, '32'), 
                                                   h(<'0', '1', '0x0303', ~tid, '0', $cipher_suites, '0', 
                                                      <'43', '0x0304'>, <'10', $g, $g2>, <'40', $g, $g^~x>, 
                                                      <'45', '0', '1'>, <'42', '0'>, '41', 
                                                      <~ticket, mask(~ticket_age_add, $ticket_age)>, '0'>)
                                                  >)
                                            >, 
                                            '2', '0x0303', p_ns, $cipher_suite, <'13', $sig_algs>, '40', $g, 
                                            p_gy>, 
                                           '8', $exts>, 
                                          '11', '0', pk(~ltkS)>, 
                                         '15', 
                                         sign(<'server_cv', 
                                               h(<
                                                  <
                                                   <
                                                    <'0', '1', '0x0303', ~tid, '0', $cipher_suites, '0', 
                                                     <'43', '0x0304'>, <'10', $g, $g2>, <'40', $g, $g^~x>, 
                                                     <'45', '0', '1'>, <'42', '0'>, '41', 
                                                     <~ticket, mask(~ticket_age_add, $ticket_age)>, 
                                                     hmac(<
                                                           Expand(Expand(Extract(~res_psk, '0'),
                                                                         <'ext', 'pbk'>, '32'),
                                                                  <'0', '0'>, '32'), 
                                                           h(<'0', '1', '0x0303', ~tid, '0', $cipher_suites, 
                                                              '0', <'43', '0x0304'>, <'10', $g, $g2>, 
                                                              <'40', $g, $g^~x>, <'45', '0', '1'>, 
                                                              <'42', '0'>, '41', 
                                                              <~ticket, mask(~ticket_age_add, $ticket_age)>, 
                                                              '0'>)
                                                          >)
                                                    >, 
                                                    '2', '0x0303', p_ns, $cipher_suite, <'13', $sig_algs>, 
                                                    '40', $g, p_gy>, 
                                                   '8', $exts>, 
                                                  '11', '0', pk(~ltkS)>)
                                              >,
                                              ~ltkS)
                                        >, 
                                        '20', 
                                        hmac(<
                                              Expand(Expand(Extract(p_gxy, Extract(~res_psk, '0')),
                                                            <'serverhts', 
                                                             h(<
                                                                <
                                                                 <
                                                                  <
                                                                   <'0', '1', '0x0303', ~tid, '0', 
                                                                    $cipher_suites, '0', <'43', '0x0304'>, 
                                                                    <'10', $g, $g2>, <'40', $g, $g^~x>, 
                                                                    <'45', '0', '1'>, <'42', '0'>, '41', 
                                                                    <~ticket, 
                                                                     mask(~ticket_age_add, $ticket_age)>, 
                                                                    hmac(<
                                                                          Expand(Expand(Extract(~res_psk,
                                                                                                '0'),
                                                                                        <'ext', 'pbk'>, '32'),
                                                                                 <'0', '0'>, '32'), 
                                                                          h(<'0', '1', '0x0303', ~tid, '0', 
                                                                             $cipher_suites, '0', 
                                                                             <'43', '0x0304'>, 
                                                                             <'10', $g, $g2>, 
                                                                             <'40', $g, $g^~x>, 
                                                                             <'45', '0', '1'>, <'42', '0'>, 
                                                                             '41', 
                                                                             <~ticket, 
                                                                              mask(~ticket_age_add,
                                                                                   $ticket_age)
                                                                             >, 
                                                                             '0'>)
                                                                         >)
                                                                   >, 
                                                                   '2', '0x0303', p_ns, $cipher_suite, 
                                                                   <'13', $sig_algs>, '40', $g, p_gy>, 
                                                                  '8', $exts>, 
                                                                 '11', '0', pk(~ltkS)>, 
                                                                '15', 
                                                                sign(<'server_cv', 
                                                                      h(<
                                                                         <
                                                                          <
                                                                           <'0', '1', '0x0303', ~tid, '0', 
                                                                            $cipher_suites, '0', 
                                                                            <'43', '0x0304'>, 
                                                                            <'10', $g, $g2>, 
                                                                            <'40', $g, $g^~x>, 
                                                                            <'45', '0', '1'>, <'42', '0'>, 
                                                                            '41', 
                                                                            <~ticket, 
                                                                             mask(~ticket_age_add,
                                                                                  $ticket_age)
                                                                            >, 
                                                                            hmac(<
                                                                                  Expand(Expand(Extract(~res_psk,
                                                                                                        '0'),
                                                                                                <'ext', 'pbk'
                                                                                                >,
                                                                                                '32'),
                                                                                         <'0', '0'>, '32'), 
                                                                                  h(<'0', '1', '0x0303', 
                                                                                     ~tid, '0', 
                                                                                     $cipher_suites, '0', 
                                                                                     <'43', '0x0304'>, 
                                                                                     <'10', $g, $g2>, 
                                                                                     <'40', $g, $g^~x>, 
                                                                                     <'45', '0', '1'>, 
                                                                                     <'42', '0'>, '41', 
                                                                                     <~ticket, 
                                                                                      mask(~ticket_age_add,
                                                                                           $ticket_age)
                                                                                     >, 
                                                                                     '0'>)
                                                                                 >)
                                                                           >, 
                                                                           '2', '0x0303', p_ns, 
                                                                           $cipher_suite, <'13', $sig_algs>, 
                                                                           '40', $g, p_gy>, 
                                                                          '8', $exts>, 
                                                                         '11', '0', pk(~ltkS)>)
                                                                     >,
                                                                     ~ltkS)
                                                               >)
                                                            >,
                                                            '32'),
                                                     <'fin', '0'>, '32'), 
                                              h(<
                                                 <
                                                  <
                                                   <
                                                    <'0', '1', '0x0303', ~tid, '0', $cipher_suites, '0', 
                                                     <'43', '0x0304'>, <'10', $g, $g2>, <'40', $g, $g^~x>, 
                                                     <'45', '0', '1'>, <'42', '0'>, '41', 
                                                     <~ticket, mask(~ticket_age_add, $ticket_age)>, 
                                                     hmac(<
                                                           Expand(Expand(Extract(~res_psk, '0'),
                                                                         <'ext', 'pbk'>, '32'),
                                                                  <'0', '0'>, '32'), 
                                                           h(<'0', '1', '0x0303', ~tid, '0', $cipher_suites, 
                                                              '0', <'43', '0x0304'>, <'10', $g, $g2>, 
                                                              <'40', $g, $g^~x>, <'45', '0', '1'>, 
                                                              <'42', '0'>, '41', 
                                                              <~ticket, mask(~ticket_age_add, $ticket_age)>, 
                                                              '0'>)
                                                          >)
                                                    >, 
                                                    '2', '0x0303', p_ns, $cipher_suite, <'13', $sig_algs>, 
                                                    '40', $g, p_gy>, 
                                                   '8', $exts>, 
                                                  '11', '0', pk(~ltkS)>, 
                                                 '15', 
                                                 sign(<'server_cv', 
                                                       h(<
                                                          <
                                                           <
                                                            <'0', '1', '0x0303', ~tid, '0', $cipher_suites, 
                                                             '0', <'43', '0x0304'>, <'10', $g, $g2>, 
                                                             <'40', $g, $g^~x>, <'45', '0', '1'>, 
                                                             <'42', '0'>, '41', 
                                                             <~ticket, mask(~ticket_age_add, $ticket_age)>, 
                                                             hmac(<
                                                                   Expand(Expand(Extract(~res_psk, '0'),
                                                                                 <'ext', 'pbk'>, '32'),
                                                                          <'0', '0'>, '32'), 
                                                                   h(<'0', '1', '0x0303', ~tid, '0', 
                                                                      $cipher_suites, '0', <'43', '0x0304'>, 
                                                                      <'10', $g, $g2>, <'40', $g, $g^~x>, 
                                                                      <'45', '0', '1'>, <'42', '0'>, '41', 
                                                                      <~ticket, 
                                                                       mask(~ticket_age_add, $ticket_age)>, 
                                                                      '0'>)
                                                                  >)
                                                            >, 
                                                            '2', '0x0303', p_ns, $cipher_suite, 
                                                            <'13', $sig_algs>, '40', $g, p_gy>, 
                                                           '8', $exts>, 
                                                          '11', '0', pk(~ltkS)>)
                                                      >,
                                                      ~ltkS)
                                                >)
                                             >)
                                       >)
                                    >,
                                    '32')
                  ) ▶₀ #l )
      qed
    next
      case recv_server_auth_case_06
      solve( (∃ #j.2.
               (!KU( Extract('0',
                             Extract(p_gxy, Extract(Expand(ms, <'rms', h(messages)>, '32'), '0')))
                ) @ #j.2)
              ∧
               #j.2 < #j.1)  ∥
             ((∀ #k.
                (!KU( Extract('0',
                              Extract(p_gxy, Extract(Expand(ms, <'rms', h(messages)>, '32'), '0')))
                 ) @ #k)
               ⇒
                ¬(#k < #j.1)) ∧
              (∃ actor #l.
                (RevealPSK( actor,
                            Expand(Extract('0',
                                           Extract(p_gxy,
                                                   Extract(Expand(ms, <'rms', h(messages)>, '32'), '0'))),
                                   <'serverats', 
                                    h(<
                                       <
                                        <
                                         <
                                          <
                                           <'0', '1', '0x0303', ~tid, '0', $cipher_suites, '0', 
                                            <'43', '0x0304'>, <'10', $g, $g2>, <'40', $g, $g^~x>, 
                                            <'45', '0', '1'>, <'42', '0'>, '41', 
                                            <p_psk_id, mask(ticket_age_add, $ticket_age)>, 
                                            hmac(<
                                                  Expand(Expand(Extract(Expand(ms, <'rms', h(messages)>,
                                                                               '32'),
                                                                        '0'),
                                                                <'res', 'pbk'>, '32'),
                                                         <'0', '0'>, '32'), 
                                                  h(<'0', '1', '0x0303', ~tid, '0', $cipher_suites, '0', 
                                                     <'43', '0x0304'>, <'10', $g, $g2>, <'40', $g, $g^~x>, 
                                                     <'45', '0', '1'>, <'42', '0'>, '41', 
                                                     <p_psk_id, mask(ticket_age_add, $ticket_age)>, '0'>)
                                                 >)
                                           >, 
                                           '2', '0x0303', p_ns, $cipher_suite, <'13', $sig_algs>, '40', $g, 
                                           p_gy>, 
                                          '8', $exts>, 
                                         '11', '0', pk(~ltkS)>, 
                                        '15', 
                                        sign(<'server_cv', 
                                              h(<
                                                 <
                                                  <
                                                   <'0', '1', '0x0303', ~tid, '0', $cipher_suites, '0', 
                                                    <'43', '0x0304'>, <'10', $g, $g2>, <'40', $g, $g^~x>, 
                                                    <'45', '0', '1'>, <'42', '0'>, '41', 
                                                    <p_psk_id, mask(ticket_age_add, $ticket_age)>, 
                                                    hmac(<
                                                          Expand(Expand(Extract(Expand(ms,
                                                                                       <'rms', h(messages)>,
                                                                                       '32'),
                                                                                '0'),
                                                                        <'res', 'pbk'>, '32'),
                                                                 <'0', '0'>, '32'), 
                                                          h(<'0', '1', '0x0303', ~tid, '0', $cipher_suites, 
                                                             '0', <'43', '0x0304'>, <'10', $g, $g2>, 
                                                             <'40', $g, $g^~x>, <'45', '0', '1'>, 
                                                             <'42', '0'>, '41', 
                                                             <p_psk_id, mask(ticket_age_add, $ticket_age)>, 
                                                             '0'>)
                                                         >)
                                                   >, 
                                                   '2', '0x0303', p_ns, $cipher_suite, <'13', $sig_algs>, 
                                                   '40', $g, p_gy>, 
                                                  '8', $exts>, 
                                                 '11', '0', pk(~ltkS)>)
                                             >,
                                             ~ltkS)
                                       >, 
                                       '20', 
                                       hmac(<
                                             Expand(Expand(Extract(p_gxy,
                                                                   Extract(Expand(ms, <'rms', h(messages)>,
                                                                                  '32'),
                                                                           '0')),
                                                           <'serverhts', 
                                                            h(<
                                                               <
                                                                <
                                                                 <
                                                                  <'0', '1', '0x0303', ~tid, '0', 
                                                                   $cipher_suites, '0', <'43', '0x0304'>, 
                                                                   <'10', $g, $g2>, <'40', $g, $g^~x>, 
                                                                   <'45', '0', '1'>, <'42', '0'>, '41', 
                                                                   <p_psk_id, 
                                                                    mask(ticket_age_add, $ticket_age)>, 
                                                                   hmac(<
                                                                         Expand(Expand(Extract(Expand(ms,
                                                                                                      <'rms', 
                                                                                                       h(messages)
                                                                                                      >,
                                                                                                      '32'),
                                                                                               '0'),
                                                                                       <'res', 'pbk'>, '32'),
                                                                                <'0', '0'>, '32'), 
                                                                         h(<'0', '1', '0x0303', ~tid, '0', 
                                                                            $cipher_suites, '0', 
                                                                            <'43', '0x0304'>, 
                                                                            <'10', $g, $g2>, 
                                                                            <'40', $g, $g^~x>, 
                                                                            <'45', '0', '1'>, <'42', '0'>, 
                                                                            '41', 
                                                                            <p_psk_id, 
                                                                             mask(ticket_age_add, $ticket_age)
                                                                            >, 
                                                                            '0'>)
                                                                        >)
                                                                  >, 
                                                                  '2', '0x0303', p_ns, $cipher_suite, 
                                                                  <'13', $sig_algs>, '40', $g, p_gy>, 
                                                                 '8', $exts>, 
                                                                '11', '0', pk(~ltkS)>, 
                                                               '15', 
                                                               sign(<'server_cv', 
                                                                     h(<
                                                                        <
                                                                         <
                                                                          <'0', '1', '0x0303', ~tid, '0', 
                                                                           $cipher_suites, '0', 
                                                                           <'43', '0x0304'>, <'10', $g, $g2>, 
                                                                           <'40', $g, $g^~x>, 
                                                                           <'45', '0', '1'>, <'42', '0'>, 
                                                                           '41', 
                                                                           <p_psk_id, 
                                                                            mask(ticket_age_add, $ticket_age)
                                                                           >, 
                                                                           hmac(<
                                                                                 Expand(Expand(Extract(Expand(ms,
                                                                                                              <
                                                                                                               'rms', 
                                                                                                               h(messages)
                                                                                                              >,
                                                                                                              '32'),
                                                                                                       '0'),
                                                                                               <'res', 'pbk'>,
                                                                                               '32'),
                                                                                        <'0', '0'>, '32'), 
                                                                                 h(<'0', '1', '0x0303', ~tid, 
                                                                                    '0', $cipher_suites, '0', 
                                                                                    <'43', '0x0304'>, 
                                                                                    <'10', $g, $g2>, 
                                                                                    <'40', $g, $g^~x>, 
                                                                                    <'45', '0', '1'>, 
                                                                                    <'42', '0'>, '41', 
                                                                                    <p_psk_id, 
                                                                                     mask(ticket_age_add,
                                                                                          $ticket_age)
                                                                                    >, 
                                                                                    '0'>)
                                                                                >)
                                                                          >, 
                                                                          '2', '0x0303', p_ns, $cipher_suite, 
                                                                          <'13', $sig_algs>, '40', $g, p_gy>, 
                                                                         '8', $exts>, 
                                                                        '11', '0', pk(~ltkS)>)
                                                                    >,
                                                                    ~ltkS)
                                                              >)
                                                           >,
                                                           '32'),
                                                    <'fin', '0'>, '32'), 
                                             h(<
                                                <
                                                 <
                                                  <
                                                   <'0', '1', '0x0303', ~tid, '0', $cipher_suites, '0', 
                                                    <'43', '0x0304'>, <'10', $g, $g2>, <'40', $g, $g^~x>, 
                                                    <'45', '0', '1'>, <'42', '0'>, '41', 
                                                    <p_psk_id, mask(ticket_age_add, $ticket_age)>, 
                                                    hmac(<
                                                          Expand(Expand(Extract(Expand(ms,
                                                                                       <'rms', h(messages)>,
                                                                                       '32'),
                                                                                '0'),
                                                                        <'res', 'pbk'>, '32'),
                                                                 <'0', '0'>, '32'), 
                                                          h(<'0', '1', '0x0303', ~tid, '0', $cipher_suites, 
                                                             '0', <'43', '0x0304'>, <'10', $g, $g2>, 
                                                             <'40', $g, $g^~x>, <'45', '0', '1'>, 
                                                             <'42', '0'>, '41', 
                                                             <p_psk_id, mask(ticket_age_add, $ticket_age)>, 
                                                             '0'>)
                                                         >)
                                                   >, 
                                                   '2', '0x0303', p_ns, $cipher_suite, <'13', $sig_algs>, 
                                                   '40', $g, p_gy>, 
                                                  '8', $exts>, 
                                                 '11', '0', pk(~ltkS)>, 
                                                '15', 
                                                sign(<'server_cv', 
                                                      h(<
                                                         <
                                                          <
                                                           <'0', '1', '0x0303', ~tid, '0', $cipher_suites, 
                                                            '0', <'43', '0x0304'>, <'10', $g, $g2>, 
                                                            <'40', $g, $g^~x>, <'45', '0', '1'>, <'42', '0'>, 
                                                            '41', 
                                                            <p_psk_id, mask(ticket_age_add, $ticket_age)>, 
                                                            hmac(<
                                                                  Expand(Expand(Extract(Expand(ms,
                                                                                               <'rms', 
                                                                                                h(messages)>,
                                                                                               '32'),
                                                                                        '0'),
                                                                                <'res', 'pbk'>, '32'),
                                                                         <'0', '0'>, '32'), 
                                                                  h(<'0', '1', '0x0303', ~tid, '0', 
                                                                     $cipher_suites, '0', <'43', '0x0304'>, 
                                                                     <'10', $g, $g2>, <'40', $g, $g^~x>, 
                                                                     <'45', '0', '1'>, <'42', '0'>, '41', 
                                                                     <p_psk_id, 
                                                                      mask(ticket_age_add, $ticket_age)>, 
                                                                     '0'>)
                                                                 >)
                                                           >, 
                                                           '2', '0x0303', p_ns, $cipher_suite, 
                                                           <'13', $sig_algs>, '40', $g, p_gy>, 
                                                          '8', $exts>, 
                                                         '11', '0', pk(~ltkS)>)
                                                     >,
                                                     ~ltkS)
                                               >)
                                            >)
                                      >)
                                   >,
                                   '32')
                 ) @ #l)
               ∧
                #l < #j.1)) )
        case case_1
        solve( (∃ #r. (RevLtk( $S ) @ #r) ∧ #r < #vr)  ∥
               (∃ tid3 x #r. (RevDHExp( tid3, $S, x ) @ #r) ∧ #r < #vr)  ∥
               (∃ tid4 y #r. (RevDHExp( tid4, $C, y ) @ #r) ∧ #r < #vr)  ∥
               (∃ rms #r. (RevealPSK( $C, rms ) @ #r) ∧ #r < #k.1)  ∥
               (∃ rms #r. (RevealPSK( $S, rms ) @ #r) ∧ #r < #k.1) )
          case case_1
          by contradiction /* from formulas */
        next
          case case_2
          by contradiction /* from formulas */
        next
          case case_3
          by contradiction /* from formulas */
        next
          case case_4
          solve( (∃ #r. (RevLtk( $S ) @ #r) ∧ #r < #vr)  ∥
                 (∃ tid3 x #r. (RevDHExp( tid3, $S, x ) @ #r) ∧ #r < #vr)  ∥
                 (∃ tid4 y #r. (RevDHExp( tid4, $C, y ) @ #r) ∧ #r < #vr)  ∥
                 (∃ rms #r. (RevealPSK( $C, rms ) @ #r) ∧ #r < #vr)  ∥
                 (∃ rms #r. (RevealPSK( $S, rms ) @ #r) ∧ #r < #vr) )
            case case_1
            by contradiction /* from formulas */
          next
            case case_2
            by contradiction /* from formulas */
          next
            case case_3
            by contradiction /* from formulas */
          next
            case case_4
            by contradiction /* from formulas */
          next
            case case_5
            by contradiction /* from formulas */
          qed
        next
          case case_5
          solve( (∃ #r. (RevLtk( $S ) @ #r) ∧ #r < #vr)  ∥
                 (∃ tid3 x #r. (RevDHExp( tid3, $S, x ) @ #r) ∧ #r < #vr)  ∥
                 (∃ tid4 y #r. (RevDHExp( tid4, $C, y ) @ #r) ∧ #r < #vr)  ∥
                 (∃ rms #r. (RevealPSK( $C, rms ) @ #r) ∧ #r < #vr)  ∥
                 (∃ rms #r. (RevealPSK( $S, rms ) @ #r) ∧ #r < #vr) )
            case case_1
            by contradiction /* from formulas */
          next
            case case_2
            by contradiction /* from formulas */
          next
            case case_3
            by contradiction /* from formulas */
          next
            case case_4
            by contradiction /* from formulas */
          next
            case case_5
            by contradiction /* from formulas */
          qed
        qed
      next
        case case_2
        by solve( SecretPSK( $A,
                             Expand(Extract('0',
                                            Extract(p_gxy,
                                                    Extract(Expand(ms, <'rms', h(messages)>, '32'), '0'))),
                                    <'serverats', 
                                     h(<
                                        <
                                         <
                                          <
                                           <
                                            <'0', '1', '0x0303', ~tid, '0', $cipher_suites, '0', 
                                             <'43', '0x0304'>, <'10', $g, $g2>, <'40', $g, $g^~x>, 
                                             <'45', '0', '1'>, <'42', '0'>, '41', 
                                             <p_psk_id, mask(ticket_age_add, $ticket_age)>, 
                                             hmac(<
                                                   Expand(Expand(Extract(Expand(ms, <'rms', h(messages)>,
                                                                                '32'),
                                                                         '0'),
                                                                 <'res', 'pbk'>, '32'),
                                                          <'0', '0'>, '32'), 
                                                   h(<'0', '1', '0x0303', ~tid, '0', $cipher_suites, '0', 
                                                      <'43', '0x0304'>, <'10', $g, $g2>, <'40', $g, $g^~x>, 
                                                      <'45', '0', '1'>, <'42', '0'>, '41', 
                                                      <p_psk_id, mask(ticket_age_add, $ticket_age)>, '0'>)
                                                  >)
                                            >, 
                                            '2', '0x0303', p_ns, $cipher_suite, <'13', $sig_algs>, '40', $g, 
                                            p_gy>, 
                                           '8', $exts>, 
                                          '11', '0', pk(~ltkS)>, 
                                         '15', 
                                         sign(<'server_cv', 
                                               h(<
                                                  <
                                                   <
                                                    <'0', '1', '0x0303', ~tid, '0', $cipher_suites, '0', 
                                                     <'43', '0x0304'>, <'10', $g, $g2>, <'40', $g, $g^~x>, 
                                                     <'45', '0', '1'>, <'42', '0'>, '41', 
                                                     <p_psk_id, mask(ticket_age_add, $ticket_age)>, 
                                                     hmac(<
                                                           Expand(Expand(Extract(Expand(ms,
                                                                                        <'rms', h(messages)>,
                                                                                        '32'),
                                                                                 '0'),
                                                                         <'res', 'pbk'>, '32'),
                                                                  <'0', '0'>, '32'), 
                                                           h(<'0', '1', '0x0303', ~tid, '0', $cipher_suites, 
                                                              '0', <'43', '0x0304'>, <'10', $g, $g2>, 
                                                              <'40', $g, $g^~x>, <'45', '0', '1'>, 
                                                              <'42', '0'>, '41', 
                                                              <p_psk_id, mask(ticket_age_add, $ticket_age)>, 
                                                              '0'>)
                                                          >)
                                                    >, 
                                                    '2', '0x0303', p_ns, $cipher_suite, <'13', $sig_algs>, 
                                                    '40', $g, p_gy>, 
                                                   '8', $exts>, 
                                                  '11', '0', pk(~ltkS)>)
                                              >,
                                              ~ltkS)
                                        >, 
                                        '20', 
                                        hmac(<
                                              Expand(Expand(Extract(p_gxy,
                                                                    Extract(Expand(ms, <'rms', h(messages)>,
                                                                                   '32'),
                                                                            '0')),
                                                            <'serverhts', 
                                                             h(<
                                                                <
                                                                 <
                                                                  <
                                                                   <'0', '1', '0x0303', ~tid, '0', 
                                                                    $cipher_suites, '0', <'43', '0x0304'>, 
                                                                    <'10', $g, $g2>, <'40', $g, $g^~x>, 
                                                                    <'45', '0', '1'>, <'42', '0'>, '41', 
                                                                    <p_psk_id, 
                                                                     mask(ticket_age_add, $ticket_age)>, 
                                                                    hmac(<
                                                                          Expand(Expand(Extract(Expand(ms,
                                                                                                       <
                                                                                                        'rms', 
                                                                                                        h(messages)
                                                                                                       >,
                                                                                                       '32'),
                                                                                                '0'),
                                                                                        <'res', 'pbk'>, '32'),
                                                                                 <'0', '0'>, '32'), 
                                                                          h(<'0', '1', '0x0303', ~tid, '0', 
                                                                             $cipher_suites, '0', 
                                                                             <'43', '0x0304'>, 
                                                                             <'10', $g, $g2>, 
                                                                             <'40', $g, $g^~x>, 
                                                                             <'45', '0', '1'>, <'42', '0'>, 
                                                                             '41', 
                                                                             <p_psk_id, 
                                                                              mask(ticket_age_add,
                                                                                   $ticket_age)
                                                                             >, 
                                                                             '0'>)
                                                                         >)
                                                                   >, 
                                                                   '2', '0x0303', p_ns, $cipher_suite, 
                                                                   <'13', $sig_algs>, '40', $g, p_gy>, 
                                                                  '8', $exts>, 
                                                                 '11', '0', pk(~ltkS)>, 
                                                                '15', 
                                                                sign(<'server_cv', 
                                                                      h(<
                                                                         <
                                                                          <
                                                                           <'0', '1', '0x0303', ~tid, '0', 
                                                                            $cipher_suites, '0', 
                                                                            <'43', '0x0304'>, 
                                                                            <'10', $g, $g2>, 
                                                                            <'40', $g, $g^~x>, 
                                                                            <'45', '0', '1'>, <'42', '0'>, 
                                                                            '41', 
                                                                            <p_psk_id, 
                                                                             mask(ticket_age_add, $ticket_age)
                                                                            >, 
                                                                            hmac(<
                                                                                  Expand(Expand(Extract(Expand(ms,
                                                                                                               <
                                                                                                                'rms', 
                                                                                                                h(messages)
                                                                                                               >,
                                                                                                               '32'),
                                                                                                        '0'),
                                                                                                <'res', 'pbk'
                                                                                                >,
                                                                                                '32'),
                                                                                         <'0', '0'>, '32'), 
                                                                                  h(<'0', '1', '0x0303', 
                                                                                     ~tid, '0', 
                                                                                     $cipher_suites, '0', 
                                                                                     <'43', '0x0304'>, 
                                                                                     <'10', $g, $g2>, 
                                                                                     <'40', $g, $g^~x>, 
                                                                                     <'45', '0', '1'>, 
                                                                                     <'42', '0'>, '41', 
                                                                                     <p_psk_id, 
                                                                                      mask(ticket_age_add,
                                                                                           $ticket_age)
                                                                                     >, 
                                                                                     '0'>)
                                                                                 >)
                                                                           >, 
                                                                           '2', '0x0303', p_ns, 
                                                                           $cipher_suite, <'13', $sig_algs>, 
                                                                           '40', $g, p_gy>, 
                                                                          '8', $exts>, 
                                                                         '11', '0', pk(~ltkS)>)
                                                                     >,
                                                                     ~ltkS)
                                                               >)
                                                            >,
                                                            '32'),
                                                     <'fin', '0'>, '32'), 
                                              h(<
                                                 <
                                                  <
                                                   <
                                                    <'0', '1', '0x0303', ~tid, '0', $cipher_suites, '0', 
                                                     <'43', '0x0304'>, <'10', $g, $g2>, <'40', $g, $g^~x>, 
                                                     <'45', '0', '1'>, <'42', '0'>, '41', 
                                                     <p_psk_id, mask(ticket_age_add, $ticket_age)>, 
                                                     hmac(<
                                                           Expand(Expand(Extract(Expand(ms,
                                                                                        <'rms', h(messages)>,
                                                                                        '32'),
                                                                                 '0'),
                                                                         <'res', 'pbk'>, '32'),
                                                                  <'0', '0'>, '32'), 
                                                           h(<'0', '1', '0x0303', ~tid, '0', $cipher_suites, 
                                                              '0', <'43', '0x0304'>, <'10', $g, $g2>, 
                                                              <'40', $g, $g^~x>, <'45', '0', '1'>, 
                                                              <'42', '0'>, '41', 
                                                              <p_psk_id, mask(ticket_age_add, $ticket_age)>, 
                                                              '0'>)
                                                          >)
                                                    >, 
                                                    '2', '0x0303', p_ns, $cipher_suite, <'13', $sig_algs>, 
                                                    '40', $g, p_gy>, 
                                                   '8', $exts>, 
                                                  '11', '0', pk(~ltkS)>, 
                                                 '15', 
                                                 sign(<'server_cv', 
                                                       h(<
                                                          <
                                                           <
                                                            <'0', '1', '0x0303', ~tid, '0', $cipher_suites, 
                                                             '0', <'43', '0x0304'>, <'10', $g, $g2>, 
                                                             <'40', $g, $g^~x>, <'45', '0', '1'>, 
                                                             <'42', '0'>, '41', 
                                                             <p_psk_id, mask(ticket_age_add, $ticket_age)>, 
                                                             hmac(<
                                                                   Expand(Expand(Extract(Expand(ms,
                                                                                                <'rms', 
                                                                                                 h(messages)>,
                                                                                                '32'),
                                                                                         '0'),
                                                                                 <'res', 'pbk'>, '32'),
                                                                          <'0', '0'>, '32'), 
                                                                   h(<'0', '1', '0x0303', ~tid, '0', 
                                                                      $cipher_suites, '0', <'43', '0x0304'>, 
                                                                      <'10', $g, $g2>, <'40', $g, $g^~x>, 
                                                                      <'45', '0', '1'>, <'42', '0'>, '41', 
                                                                      <p_psk_id, 
                                                                       mask(ticket_age_add, $ticket_age)>, 
                                                                      '0'>)
                                                                  >)
                                                            >, 
                                                            '2', '0x0303', p_ns, $cipher_suite, 
                                                            <'13', $sig_algs>, '40', $g, p_gy>, 
                                                           '8', $exts>, 
                                                          '11', '0', pk(~ltkS)>)
                                                      >,
                                                      ~ltkS)
                                                >)
                                             >)
                                       >)
                                    >,
                                    '32')
                  ) ▶₀ #l )
      qed
    next
      case recv_server_auth_case_07
      solve( (∃ #j.2.
               (!KU( Extract('0', Extract(p_gxy, Extract(~res_psk, '0'))) ) @ #j.2)
              ∧
               #j.2 < #j.1)  ∥
             ((∀ #k.
                (!KU( Extract('0', Extract(p_gxy, Extract(~res_psk, '0'))) ) @ #k)
               ⇒
                ¬(#k < #j.1)) ∧
              (∃ actor #l.
                (RevealPSK( actor,
                            Expand(Extract('0', Extract(p_gxy, Extract(~res_psk, '0'))),
                                   <'serverats', 
                                    h(<
                                       <
                                        <
                                         <
                                          <
                                           <
                                            <
                                             <'0', '1', '0x0303', ~tid, '0', $cipher_suites, '0', 
                                              <'43', '0x0304'>, <'10', $g1, $g>, <'40', $g1, $g1^~x>, 
                                              <'45', '0', '1'>, <'42', '0'>, '41', 
                                              <~ticket, mask(~ticket_age_add, $ticket_age)>, 
                                              hmac(<
                                                    Expand(Expand(Extract(~res_psk, '0'), <'ext', 'pbk'>,
                                                                  '32'),
                                                           <'0', '0'>, '32'), 
                                                    h(<'0', '1', '0x0303', ~tid, '0', $cipher_suites, '0', 
                                                       <'43', '0x0304'>, <'10', $g1, $g>, 
                                                       <'40', $g1, $g1^~x>, <'45', '0', '1'>, <'42', '0'>, 
                                                       '41', <~ticket, mask(~ticket_age_add, $ticket_age)>, 
                                                       '0'>)
                                                   >)
                                             >, 
                                             '6', '0x0303', '40', $g>, 
                                            '1', '0x0303', ~new_nc, '0', $cipher_suites.1, '0', 
                                            <'43', '0x0304'>, <'10', $g1, $g>, <'40', $g, $g^~x.1>, 
                                            <'45', '0', '1'>, '0', '41', 
                                            <~ticket, mask(~ticket_age_add, '1')>, 
                                            hmac(<
                                                  Expand(Expand(Extract(~res_psk, '0'), <'ext', 'pbk'>, '32'),
                                                         <'0', '0'>, '32'), 
                                                  h(<
                                                     <
                                                      <'0', '1', '0x0303', ~tid, '0', $cipher_suites, '0', 
                                                       <'43', '0x0304'>, <'10', $g1, $g>, 
                                                       <'40', $g1, $g1^~x>, <'45', '0', '1'>, <'42', '0'>, 
                                                       '41', <~ticket, mask(~ticket_age_add, $ticket_age)>, 
                                                       hmac(<
                                                             Expand(Expand(Extract(~res_psk, '0'),
                                                                           <'ext', 'pbk'>, '32'),
                                                                    <'0', '0'>, '32'), 
                                                             h(<'0', '1', '0x0303', ~tid, '0', 
                                                                $cipher_suites, '0', <'43', '0x0304'>, 
                                                                <'10', $g1, $g>, <'40', $g1, $g1^~x>, 
                                                                <'45', '0', '1'>, <'42', '0'>, '41', 
                                                                <~ticket, mask(~ticket_age_add, $ticket_age)
                                                                >, 
                                                                '0'>)
                                                            >)
                                                      >, 
                                                      '6', '0x0303', '40', $g>, 
                                                     '1', '0x0303', ~new_nc, '0', $cipher_suites.1, '0', 
                                                     <'43', '0x0304'>, <'10', $g1, $g>, <'40', $g, $g^~x.1>, 
                                                     <'45', '0', '1'>, '0', '41', 
                                                     <~ticket, mask(~ticket_age_add, '1')>, '0'>)
                                                 >)
                                           >, 
                                           '2', '0x0303', p_ns, $cipher_suite, <'13', $sig_algs>, '40', $g, 
                                           p_gy>, 
                                          '8', $exts>, 
                                         '11', '0', pk(~ltkS)>, 
                                        '15', 
                                        sign(<'server_cv', 
                                              h(<
                                                 <
                                                  <
                                                   <
                                                    <
                                                     <'0', '1', '0x0303', ~tid, '0', $cipher_suites, '0', 
                                                      <'43', '0x0304'>, <'10', $g1, $g>, <'40', $g1, $g1^~x>, 
                                                      <'45', '0', '1'>, <'42', '0'>, '41', 
                                                      <~ticket, mask(~ticket_age_add, $ticket_age)>, 
                                                      hmac(<
                                                            Expand(Expand(Extract(~res_psk, '0'),
                                                                          <'ext', 'pbk'>, '32'),
                                                                   <'0', '0'>, '32'), 
                                                            h(<'0', '1', '0x0303', ~tid, '0', $cipher_suites, 
                                                               '0', <'43', '0x0304'>, <'10', $g1, $g>, 
                                                               <'40', $g1, $g1^~x>, <'45', '0', '1'>, 
                                                               <'42', '0'>, '41', 
                                                               <~ticket, mask(~ticket_age_add, $ticket_age)>, 
                                                               '0'>)
                                                           >)
                                                     >, 
                                                     '6', '0x0303', '40', $g>, 
                                                    '1', '0x0303', ~new_nc, '0', $cipher_suites.1, '0', 
                                                    <'43', '0x0304'>, <'10', $g1, $g>, <'40', $g, $g^~x.1>, 
                                                    <'45', '0', '1'>, '0', '41', 
                                                    <~ticket, mask(~ticket_age_add, '1')>, 
                                                    hmac(<
                                                          Expand(Expand(Extract(~res_psk, '0'),
                                                                        <'ext', 'pbk'>, '32'),
                                                                 <'0', '0'>, '32'), 
                                                          h(<
                                                             <
                                                              <'0', '1', '0x0303', ~tid, '0', $cipher_suites, 
                                                               '0', <'43', '0x0304'>, <'10', $g1, $g>, 
                                                               <'40', $g1, $g1^~x>, <'45', '0', '1'>, 
                                                               <'42', '0'>, '41', 
                                                               <~ticket, mask(~ticket_age_add, $ticket_age)>, 
                                                               hmac(<
                                                                     Expand(Expand(Extract(~res_psk, '0'),
                                                                                   <'ext', 'pbk'>, '32'),
                                                                            <'0', '0'>, '32'), 
                                                                     h(<'0', '1', '0x0303', ~tid, '0', 
                                                                        $cipher_suites, '0', 
                                                                        <'43', '0x0304'>, <'10', $g1, $g>, 
                                                                        <'40', $g1, $g1^~x>, 
                                                                        <'45', '0', '1'>, <'42', '0'>, '41', 
                                                                        <~ticket, 
                                                                         mask(~ticket_age_add, $ticket_age)>, 
                                                                        '0'>)
                                                                    >)
                                                              >, 
                                                              '6', '0x0303', '40', $g>, 
                                                             '1', '0x0303', ~new_nc, '0', $cipher_suites.1, 
                                                             '0', <'43', '0x0304'>, <'10', $g1, $g>, 
                                                             <'40', $g, $g^~x.1>, <'45', '0', '1'>, '0', 
                                                             '41', <~ticket, mask(~ticket_age_add, '1')>, '0'
                                                            >)
                                                         >)
                                                   >, 
                                                   '2', '0x0303', p_ns, $cipher_suite, <'13', $sig_algs>, 
                                                   '40', $g, p_gy>, 
                                                  '8', $exts>, 
                                                 '11', '0', pk(~ltkS)>)
                                             >,
                                             ~ltkS)
                                       >, 
                                       '20', 
                                       hmac(<
                                             Expand(Expand(Extract(p_gxy, Extract(~res_psk, '0')),
                                                           <'serverhts', 
                                                            h(<
                                                               <
                                                                <
                                                                 <
                                                                  <
                                                                   <
                                                                    <'0', '1', '0x0303', ~tid, '0', 
                                                                     $cipher_suites, '0', <'43', '0x0304'>, 
                                                                     <'10', $g1, $g>, <'40', $g1, $g1^~x>, 
                                                                     <'45', '0', '1'>, <'42', '0'>, '41', 
                                                                     <~ticket, 
                                                                      mask(~ticket_age_add, $ticket_age)>, 
                                                                     hmac(<
                                                                           Expand(Expand(Extract(~res_psk,
                                                                                                 '0'),
                                                                                         <'ext', 'pbk'>,
                                                                                         '32'),
                                                                                  <'0', '0'>, '32'), 
                                                                           h(<'0', '1', '0x0303', ~tid, '0', 
                                                                              $cipher_suites, '0', 
                                                                              <'43', '0x0304'>, 
                                                                              <'10', $g1, $g>, 
                                                                              <'40', $g1, $g1^~x>, 
                                                                              <'45', '0', '1'>, <'42', '0'>, 
                                                                              '41', 
                                                                              <~ticket, 
                                                                               mask(~ticket_age_add,
                                                                                    $ticket_age)
                                                                              >, 
                                                                              '0'>)
                                                                          >)
                                                                    >, 
                                                                    '6', '0x0303', '40', $g>, 
                                                                   '1', '0x0303', ~new_nc, '0', 
                                                                   $cipher_suites.1, '0', <'43', '0x0304'>, 
                                                                   <'10', $g1, $g>, <'40', $g, $g^~x.1>, 
                                                                   <'45', '0', '1'>, '0', '41', 
                                                                   <~ticket, mask(~ticket_age_add, '1')>, 
                                                                   hmac(<
                                                                         Expand(Expand(Extract(~res_psk, '0'),
                                                                                       <'ext', 'pbk'>, '32'),
                                                                                <'0', '0'>, '32'), 
                                                                         h(<
                                                                            <
                                                                             <'0', '1', '0x0303', ~tid, '0', 
                                                                              $cipher_suites, '0', 
                                                                              <'43', '0x0304'>, 
                                                                              <'10', $g1, $g>, 
                                                                              <'40', $g1, $g1^~x>, 
                                                                              <'45', '0', '1'>, <'42', '0'>, 
                                                                              '41', 
                                                                              <~ticket, 
                                                                               mask(~ticket_age_add,
                                                                                    $ticket_age)
                                                                              >, 
                                                                              hmac(<
                                                                                    Expand(Expand(Extract(~res_psk,
                                                                                                          '0'),
                                                                                                  <'ext', 
                                                                                                   'pbk'>,
                                                                                                  '32'),
                                                                                           <'0', '0'>, '32'), 
                                                                                    h(<'0', '1', '0x0303', 
                                                                                       ~tid, '0', 
                                                                                       $cipher_suites, '0', 
                                                                                       <'43', '0x0304'>, 
                                                                                       <'10', $g1, $g>, 
                                                                                       <'40', $g1, $g1^~x>, 
                                                                                       <'45', '0', '1'>, 
                                                                                       <'42', '0'>, '41', 
                                                                                       <~ticket, 
                                                                                        mask(~ticket_age_add,
                                                                                             $ticket_age)
                                                                                       >, 
                                                                                       '0'>)
                                                                                   >)
                                                                             >, 
                                                                             '6', '0x0303', '40', $g>, 
                                                                            '1', '0x0303', ~new_nc, '0', 
                                                                            $cipher_suites.1, '0', 
                                                                            <'43', '0x0304'>, 
                                                                            <'10', $g1, $g>, 
                                                                            <'40', $g, $g^~x.1>, 
                                                                            <'45', '0', '1'>, '0', '41', 
                                                                            <~ticket, 
                                                                             mask(~ticket_age_add, '1')>, 
                                                                            '0'>)
                                                                        >)
                                                                  >, 
                                                                  '2', '0x0303', p_ns, $cipher_suite, 
                                                                  <'13', $sig_algs>, '40', $g, p_gy>, 
                                                                 '8', $exts>, 
                                                                '11', '0', pk(~ltkS)>, 
                                                               '15', 
                                                               sign(<'server_cv', 
                                                                     h(<
                                                                        <
                                                                         <
                                                                          <
                                                                           <
                                                                            <'0', '1', '0x0303', ~tid, '0', 
                                                                             $cipher_suites, '0', 
                                                                             <'43', '0x0304'>, 
                                                                             <'10', $g1, $g>, 
                                                                             <'40', $g1, $g1^~x>, 
                                                                             <'45', '0', '1'>, <'42', '0'>, 
                                                                             '41', 
                                                                             <~ticket, 
                                                                              mask(~ticket_age_add,
                                                                                   $ticket_age)
                                                                             >, 
                                                                             hmac(<
                                                                                   Expand(Expand(Extract(~res_psk,
                                                                                                         '0'),
                                                                                                 <'ext', 'pbk'
                                                                                                 >,
                                                                                                 '32'),
                                                                                          <'0', '0'>, '32'), 
                                                                                   h(<'0', '1', '0x0303', 
                                                                                      ~tid, '0', 
                                                                                      $cipher_suites, '0', 
                                                                                      <'43', '0x0304'>, 
                                                                                      <'10', $g1, $g>, 
                                                                                      <'40', $g1, $g1^~x>, 
                                                                                      <'45', '0', '1'>, 
                                                                                      <'42', '0'>, '41', 
                                                                                      <~ticket, 
                                                                                       mask(~ticket_age_add,
                                                                                            $ticket_age)
                                                                                      >, 
                                                                                      '0'>)
                                                                                  >)
                                                                            >, 
                                                                            '6', '0x0303', '40', $g>, 
                                                                           '1', '0x0303', ~new_nc, '0', 
                                                                           $cipher_suites.1, '0', 
                                                                           <'43', '0x0304'>, <'10', $g1, $g>, 
                                                                           <'40', $g, $g^~x.1>, 
                                                                           <'45', '0', '1'>, '0', '41', 
                                                                           <~ticket, 
                                                                            mask(~ticket_age_add, '1')>, 
                                                                           hmac(<
                                                                                 Expand(Expand(Extract(~res_psk,
                                                                                                       '0'),
                                                                                               <'ext', 'pbk'>,
                                                                                               '32'),
                                                                                        <'0', '0'>, '32'), 
                                                                                 h(<
                                                                                    <
                                                                                     <'0', '1', '0x0303', 
                                                                                      ~tid, '0', 
                                                                                      $cipher_suites, '0', 
                                                                                      <'43', '0x0304'>, 
                                                                                      <'10', $g1, $g>, 
                                                                                      <'40', $g1, $g1^~x>, 
                                                                                      <'45', '0', '1'>, 
                                                                                      <'42', '0'>, '41', 
                                                                                      <~ticket, 
                                                                                       mask(~ticket_age_add,
                                                                                            $ticket_age)
                                                                                      >, 
                                                                                      hmac(<
                                                                                            Expand(Expand(Extract(~res_psk,
                                                                                                                  '0'),
                                                                                                          <
                                                                                                           'ext', 
                                                                                                           'pbk'
                                                                                                          >,
                                                                                                          '32'),
                                                                                                   <'0', '0'>,
                                                                                                   '32'), 
                                                                                            h(<'0', '1', 
                                                                                               '0x0303', 
                                                                                               ~tid, '0', 
                                                                                               $cipher_suites, 
                                                                                               '0', 
                                                                                               <'43', '0x0304'
                                                                                               >, 
                                                                                               <'10', $g1, $g
                                                                                               >, 
                                                                                               <'40', $g1, 
                                                                                                $g1^~x>, 
                                                                                               <'45', '0', '1'
                                                                                               >, 
                                                                                               <'42', '0'>, 
                                                                                               '41', 
                                                                                               <~ticket, 
                                                                                                mask(~ticket_age_add,
                                                                                                     $ticket_age)
                                                                                               >, 
                                                                                               '0'>)
                                                                                           >)
                                                                                     >, 
                                                                                     '6', '0x0303', '40', $g
                                                                                    >, 
                                                                                    '1', '0x0303', ~new_nc, 
                                                                                    '0', $cipher_suites.1, 
                                                                                    '0', <'43', '0x0304'>, 
                                                                                    <'10', $g1, $g>, 
                                                                                    <'40', $g, $g^~x.1>, 
                                                                                    <'45', '0', '1'>, '0', 
                                                                                    '41', 
                                                                                    <~ticket, 
                                                                                     mask(~ticket_age_add,
                                                                                          '1')
                                                                                    >, 
                                                                                    '0'>)
                                                                                >)
                                                                          >, 
                                                                          '2', '0x0303', p_ns, $cipher_suite, 
                                                                          <'13', $sig_algs>, '40', $g, p_gy>, 
                                                                         '8', $exts>, 
                                                                        '11', '0', pk(~ltkS)>)
                                                                    >,
                                                                    ~ltkS)
                                                              >)
                                                           >,
                                                           '32'),
                                                    <'fin', '0'>, '32'), 
                                             h(<
                                                <
                                                 <
                                                  <
                                                   <
                                                    <
                                                     <'0', '1', '0x0303', ~tid, '0', $cipher_suites, '0', 
                                                      <'43', '0x0304'>, <'10', $g1, $g>, <'40', $g1, $g1^~x>, 
                                                      <'45', '0', '1'>, <'42', '0'>, '41', 
                                                      <~ticket, mask(~ticket_age_add, $ticket_age)>, 
                                                      hmac(<
                                                            Expand(Expand(Extract(~res_psk, '0'),
                                                                          <'ext', 'pbk'>, '32'),
                                                                   <'0', '0'>, '32'), 
                                                            h(<'0', '1', '0x0303', ~tid, '0', $cipher_suites, 
                                                               '0', <'43', '0x0304'>, <'10', $g1, $g>, 
                                                               <'40', $g1, $g1^~x>, <'45', '0', '1'>, 
                                                               <'42', '0'>, '41', 
                                                               <~ticket, mask(~ticket_age_add, $ticket_age)>, 
                                                               '0'>)
                                                           >)
                                                     >, 
                                                     '6', '0x0303', '40', $g>, 
                                                    '1', '0x0303', ~new_nc, '0', $cipher_suites.1, '0', 
                                                    <'43', '0x0304'>, <'10', $g1, $g>, <'40', $g, $g^~x.1>, 
                                                    <'45', '0', '1'>, '0', '41', 
                                                    <~ticket, mask(~ticket_age_add, '1')>, 
                                                    hmac(<
                                                          Expand(Expand(Extract(~res_psk, '0'),
                                                                        <'ext', 'pbk'>, '32'),
                                                                 <'0', '0'>, '32'), 
                                                          h(<
                                                             <
                                                              <'0', '1', '0x0303', ~tid, '0', $cipher_suites, 
                                                               '0', <'43', '0x0304'>, <'10', $g1, $g>, 
                                                               <'40', $g1, $g1^~x>, <'45', '0', '1'>, 
                                                               <'42', '0'>, '41', 
                                                               <~ticket, mask(~ticket_age_add, $ticket_age)>, 
                                                               hmac(<
                                                                     Expand(Expand(Extract(~res_psk, '0'),
                                                                                   <'ext', 'pbk'>, '32'),
                                                                            <'0', '0'>, '32'), 
                                                                     h(<'0', '1', '0x0303', ~tid, '0', 
                                                                        $cipher_suites, '0', 
                                                                        <'43', '0x0304'>, <'10', $g1, $g>, 
                                                                        <'40', $g1, $g1^~x>, 
                                                                        <'45', '0', '1'>, <'42', '0'>, '41', 
                                                                        <~ticket, 
                                                                         mask(~ticket_age_add, $ticket_age)>, 
                                                                        '0'>)
                                                                    >)
                                                              >, 
                                                              '6', '0x0303', '40', $g>, 
                                                             '1', '0x0303', ~new_nc, '0', $cipher_suites.1, 
                                                             '0', <'43', '0x0304'>, <'10', $g1, $g>, 
                                                             <'40', $g, $g^~x.1>, <'45', '0', '1'>, '0', 
                                                             '41', <~ticket, mask(~ticket_age_add, '1')>, '0'
                                                            >)
                                                         >)
                                                   >, 
                                                   '2', '0x0303', p_ns, $cipher_suite, <'13', $sig_algs>, 
                                                   '40', $g, p_gy>, 
                                                  '8', $exts>, 
                                                 '11', '0', pk(~ltkS)>, 
                                                '15', 
                                                sign(<'server_cv', 
                                                      h(<
                                                         <
                                                          <
                                                           <
                                                            <
                                                             <'0', '1', '0x0303', ~tid, '0', $cipher_suites, 
                                                              '0', <'43', '0x0304'>, <'10', $g1, $g>, 
                                                              <'40', $g1, $g1^~x>, <'45', '0', '1'>, 
                                                              <'42', '0'>, '41', 
                                                              <~ticket, mask(~ticket_age_add, $ticket_age)>, 
                                                              hmac(<
                                                                    Expand(Expand(Extract(~res_psk, '0'),
                                                                                  <'ext', 'pbk'>, '32'),
                                                                           <'0', '0'>, '32'), 
                                                                    h(<'0', '1', '0x0303', ~tid, '0', 
                                                                       $cipher_suites, '0', <'43', '0x0304'>, 
                                                                       <'10', $g1, $g>, <'40', $g1, $g1^~x>, 
                                                                       <'45', '0', '1'>, <'42', '0'>, '41', 
                                                                       <~ticket, 
                                                                        mask(~ticket_age_add, $ticket_age)>, 
                                                                       '0'>)
                                                                   >)
                                                             >, 
                                                             '6', '0x0303', '40', $g>, 
                                                            '1', '0x0303', ~new_nc, '0', $cipher_suites.1, 
                                                            '0', <'43', '0x0304'>, <'10', $g1, $g>, 
                                                            <'40', $g, $g^~x.1>, <'45', '0', '1'>, '0', '41', 
                                                            <~ticket, mask(~ticket_age_add, '1')>, 
                                                            hmac(<
                                                                  Expand(Expand(Extract(~res_psk, '0'),
                                                                                <'ext', 'pbk'>, '32'),
                                                                         <'0', '0'>, '32'), 
                                                                  h(<
                                                                     <
                                                                      <'0', '1', '0x0303', ~tid, '0', 
                                                                       $cipher_suites, '0', <'43', '0x0304'>, 
                                                                       <'10', $g1, $g>, <'40', $g1, $g1^~x>, 
                                                                       <'45', '0', '1'>, <'42', '0'>, '41', 
                                                                       <~ticket, 
                                                                        mask(~ticket_age_add, $ticket_age)>, 
                                                                       hmac(<
                                                                             Expand(Expand(Extract(~res_psk,
                                                                                                   '0'),
                                                                                           <'ext', 'pbk'>,
                                                                                           '32'),
                                                                                    <'0', '0'>, '32'), 
                                                                             h(<'0', '1', '0x0303', ~tid, 
                                                                                '0', $cipher_suites, '0', 
                                                                                <'43', '0x0304'>, 
                                                                                <'10', $g1, $g>, 
                                                                                <'40', $g1, $g1^~x>, 
                                                                                <'45', '0', '1'>, 
                                                                                <'42', '0'>, '41', 
                                                                                <~ticket, 
                                                                                 mask(~ticket_age_add,
                                                                                      $ticket_age)
                                                                                >, 
                                                                                '0'>)
                                                                            >)
                                                                      >, 
                                                                      '6', '0x0303', '40', $g>, 
                                                                     '1', '0x0303', ~new_nc, '0', 
                                                                     $cipher_suites.1, '0', <'43', '0x0304'>, 
                                                                     <'10', $g1, $g>, <'40', $g, $g^~x.1>, 
                                                                     <'45', '0', '1'>, '0', '41', 
                                                                     <~ticket, mask(~ticket_age_add, '1')>, 
                                                                     '0'>)
                                                                 >)
                                                           >, 
                                                           '2', '0x0303', p_ns, $cipher_suite, 
                                                           <'13', $sig_algs>, '40', $g, p_gy>, 
                                                          '8', $exts>, 
                                                         '11', '0', pk(~ltkS)>)
                                                     >,
                                                     ~ltkS)
                                               >)
                                            >)
                                      >)
                                   >,
                                   '32')
                 ) @ #l)
               ∧
                #l < #j.1)) )
        case case_1
        solve( (∃ #r. (RevLtk( $S ) @ #r) ∧ #r < #vr)  ∥
               (∃ tid3 x #r. (RevDHExp( tid3, $S, x ) @ #r) ∧ #r < #vr)  ∥
               (∃ tid4 y #r. (RevDHExp( tid4, $C, y ) @ #r) ∧ #r < #vr)  ∥
               (∃ rms #r. (RevealPSK( $C, rms ) @ #r) ∧ #r < #k.1)  ∥
               (∃ rms #r. (RevealPSK( $S, rms ) @ #r) ∧ #r < #k.1) )
          case case_1
          by contradiction /* from formulas */
        next
          case case_2
          by contradiction /* from formulas */
        next
          case case_3
          by contradiction /* from formulas */
        next
          case case_4
          solve( (∃ #r. (RevLtk( $S ) @ #r) ∧ #r < #vr)  ∥
                 (∃ tid3 x #r. (RevDHExp( tid3, $S, x ) @ #r) ∧ #r < #vr)  ∥
                 (∃ tid4 y #r. (RevDHExp( tid4, $C, y ) @ #r) ∧ #r < #vr)  ∥
                 (∃ rms #r. (RevealPSK( $C, rms ) @ #r) ∧ #r < #vr)  ∥
                 (∃ rms #r. (RevealPSK( $S, rms ) @ #r) ∧ #r < #vr) )
            case case_1
            by contradiction /* from formulas */
          next
            case case_2
            by contradiction /* from formulas */
          next
            case case_3
            by contradiction /* from formulas */
          next
            case case_4
            by contradiction /* from formulas */
          next
            case case_5
            by contradiction /* from formulas */
          qed
        next
          case case_5
          solve( (∃ #r. (RevLtk( $S ) @ #r) ∧ #r < #vr)  ∥
                 (∃ tid3 x #r. (RevDHExp( tid3, $S, x ) @ #r) ∧ #r < #vr)  ∥
                 (∃ tid4 y #r. (RevDHExp( tid4, $C, y ) @ #r) ∧ #r < #vr)  ∥
                 (∃ rms #r. (RevealPSK( $C, rms ) @ #r) ∧ #r < #vr)  ∥
                 (∃ rms #r. (RevealPSK( $S, rms ) @ #r) ∧ #r < #vr) )
            case case_1
            by contradiction /* from formulas */
          next
            case case_2
            by contradiction /* from formulas */
          next
            case case_3
            by contradiction /* from formulas */
          next
            case case_4
            by contradiction /* from formulas */
          next
            case case_5
            by contradiction /* from formulas */
          qed
        qed
      next
        case case_2
        by solve( SecretPSK( $A,
                             Expand(Extract('0', Extract(p_gxy, Extract(~res_psk, '0'))),
                                    <'serverats', 
                                     h(<
                                        <
                                         <
                                          <
                                           <
                                            <
                                             <
                                              <'0', '1', '0x0303', ~tid, '0', $cipher_suites, '0', 
                                               <'43', '0x0304'>, <'10', $g1, $g>, <'40', $g1, $g1^~x>, 
                                               <'45', '0', '1'>, <'42', '0'>, '41', 
                                               <~ticket, mask(~ticket_age_add, $ticket_age)>, 
                                               hmac(<
                                                     Expand(Expand(Extract(~res_psk, '0'), <'ext', 'pbk'>,
                                                                   '32'),
                                                            <'0', '0'>, '32'), 
                                                     h(<'0', '1', '0x0303', ~tid, '0', $cipher_suites, '0', 
                                                        <'43', '0x0304'>, <'10', $g1, $g>, 
                                                        <'40', $g1, $g1^~x>, <'45', '0', '1'>, <'42', '0'>, 
                                                        '41', <~ticket, mask(~ticket_age_add, $ticket_age)>, 
                                                        '0'>)
                                                    >)
                                              >, 
                                              '6', '0x0303', '40', $g>, 
                                             '1', '0x0303', ~new_nc, '0', $cipher_suites.1, '0', 
                                             <'43', '0x0304'>, <'10', $g1, $g>, <'40', $g, $g^~x.1>, 
                                             <'45', '0', '1'>, '0', '41', 
                                             <~ticket, mask(~ticket_age_add, '1')>, 
                                             hmac(<
                                                   Expand(Expand(Extract(~res_psk, '0'), <'ext', 'pbk'>,
                                                                 '32'),
                                                          <'0', '0'>, '32'), 
                                                   h(<
                                                      <
                                                       <'0', '1', '0x0303', ~tid, '0', $cipher_suites, '0', 
                                                        <'43', '0x0304'>, <'10', $g1, $g>, 
                                                        <'40', $g1, $g1^~x>, <'45', '0', '1'>, <'42', '0'>, 
                                                        '41', <~ticket, mask(~ticket_age_add, $ticket_age)>, 
                                                        hmac(<
                                                              Expand(Expand(Extract(~res_psk, '0'),
                                                                            <'ext', 'pbk'>, '32'),
                                                                     <'0', '0'>, '32'), 
                                                              h(<'0', '1', '0x0303', ~tid, '0', 
                                                                 $cipher_suites, '0', <'43', '0x0304'>, 
                                                                 <'10', $g1, $g>, <'40', $g1, $g1^~x>, 
                                                                 <'45', '0', '1'>, <'42', '0'>, '41', 
                                                                 <~ticket, mask(~ticket_age_add, $ticket_age)
                                                                 >, 
                                                                 '0'>)
                                                             >)
                                                       >, 
                                                       '6', '0x0303', '40', $g>, 
                                                      '1', '0x0303', ~new_nc, '0', $cipher_suites.1, '0', 
                                                      <'43', '0x0304'>, <'10', $g1, $g>, <'40', $g, $g^~x.1>, 
                                                      <'45', '0', '1'>, '0', '41', 
                                                      <~ticket, mask(~ticket_age_add, '1')>, '0'>)
                                                  >)
                                            >, 
                                            '2', '0x0303', p_ns, $cipher_suite, <'13', $sig_algs>, '40', $g, 
                                            p_gy>, 
                                           '8', $exts>, 
                                          '11', '0', pk(~ltkS)>, 
                                         '15', 
                                         sign(<'server_cv', 
                                               h(<
                                                  <
                                                   <
                                                    <
                                                     <
                                                      <'0', '1', '0x0303', ~tid, '0', $cipher_suites, '0', 
                                                       <'43', '0x0304'>, <'10', $g1, $g>, 
                                                       <'40', $g1, $g1^~x>, <'45', '0', '1'>, <'42', '0'>, 
                                                       '41', <~ticket, mask(~ticket_age_add, $ticket_age)>, 
                                                       hmac(<
                                                             Expand(Expand(Extract(~res_psk, '0'),
                                                                           <'ext', 'pbk'>, '32'),
                                                                    <'0', '0'>, '32'), 
                                                             h(<'0', '1', '0x0303', ~tid, '0', 
                                                                $cipher_suites, '0', <'43', '0x0304'>, 
                                                                <'10', $g1, $g>, <'40', $g1, $g1^~x>, 
                                                                <'45', '0', '1'>, <'42', '0'>, '41', 
                                                                <~ticket, mask(~ticket_age_add, $ticket_age)
                                                                >, 
                                                                '0'>)
                                                            >)
                                                      >, 
                                                      '6', '0x0303', '40', $g>, 
                                                     '1', '0x0303', ~new_nc, '0', $cipher_suites.1, '0', 
                                                     <'43', '0x0304'>, <'10', $g1, $g>, <'40', $g, $g^~x.1>, 
                                                     <'45', '0', '1'>, '0', '41', 
                                                     <~ticket, mask(~ticket_age_add, '1')>, 
                                                     hmac(<
                                                           Expand(Expand(Extract(~res_psk, '0'),
                                                                         <'ext', 'pbk'>, '32'),
                                                                  <'0', '0'>, '32'), 
                                                           h(<
                                                              <
                                                               <'0', '1', '0x0303', ~tid, '0', 
                                                                $cipher_suites, '0', <'43', '0x0304'>, 
                                                                <'10', $g1, $g>, <'40', $g1, $g1^~x>, 
                                                                <'45', '0', '1'>, <'42', '0'>, '41', 
                                                                <~ticket, mask(~ticket_age_add, $ticket_age)
                                                                >, 
                                                                hmac(<
                                                                      Expand(Expand(Extract(~res_psk, '0'),
                                                                                    <'ext', 'pbk'>, '32'),
                                                                             <'0', '0'>, '32'), 
                                                                      h(<'0', '1', '0x0303', ~tid, '0', 
                                                                         $cipher_suites, '0', 
                                                                         <'43', '0x0304'>, <'10', $g1, $g>, 
                                                                         <'40', $g1, $g1^~x>, 
                                                                         <'45', '0', '1'>, <'42', '0'>, '41', 
                                                                         <~ticket, 
                                                                          mask(~ticket_age_add, $ticket_age)
                                                                         >, 
                                                                         '0'>)
                                                                     >)
                                                               >, 
                                                               '6', '0x0303', '40', $g>, 
                                                              '1', '0x0303', ~new_nc, '0', $cipher_suites.1, 
                                                              '0', <'43', '0x0304'>, <'10', $g1, $g>, 
                                                              <'40', $g, $g^~x.1>, <'45', '0', '1'>, '0', 
                                                              '41', <~ticket, mask(~ticket_age_add, '1')>, '0'
                                                             >)
                                                          >)
                                                    >, 
                                                    '2', '0x0303', p_ns, $cipher_suite, <'13', $sig_algs>, 
                                                    '40', $g, p_gy>, 
                                                   '8', $exts>, 
                                                  '11', '0', pk(~ltkS)>)
                                              >,
                                              ~ltkS)
                                        >, 
                                        '20', 
                                        hmac(<
                                              Expand(Expand(Extract(p_gxy, Extract(~res_psk, '0')),
                                                            <'serverhts', 
                                                             h(<
                                                                <
                                                                 <
                                                                  <
                                                                   <
                                                                    <
                                                                     <'0', '1', '0x0303', ~tid, '0', 
                                                                      $cipher_suites, '0', <'43', '0x0304'>, 
                                                                      <'10', $g1, $g>, <'40', $g1, $g1^~x>, 
                                                                      <'45', '0', '1'>, <'42', '0'>, '41', 
                                                                      <~ticket, 
                                                                       mask(~ticket_age_add, $ticket_age)>, 
                                                                      hmac(<
                                                                            Expand(Expand(Extract(~res_psk,
                                                                                                  '0'),
                                                                                          <'ext', 'pbk'>,
                                                                                          '32'),
                                                                                   <'0', '0'>, '32'), 
                                                                            h(<'0', '1', '0x0303', ~tid, '0', 
                                                                               $cipher_suites, '0', 
                                                                               <'43', '0x0304'>, 
                                                                               <'10', $g1, $g>, 
                                                                               <'40', $g1, $g1^~x>, 
                                                                               <'45', '0', '1'>, <'42', '0'>, 
                                                                               '41', 
                                                                               <~ticket, 
                                                                                mask(~ticket_age_add,
                                                                                     $ticket_age)
                                                                               >, 
                                                                               '0'>)
                                                                           >)
                                                                     >, 
                                                                     '6', '0x0303', '40', $g>, 
                                                                    '1', '0x0303', ~new_nc, '0', 
                                                                    $cipher_suites.1, '0', <'43', '0x0304'>, 
                                                                    <'10', $g1, $g>, <'40', $g, $g^~x.1>, 
                                                                    <'45', '0', '1'>, '0', '41', 
                                                                    <~ticket, mask(~ticket_age_add, '1')>, 
                                                                    hmac(<
                                                                          Expand(Expand(Extract(~res_psk,
                                                                                                '0'),
                                                                                        <'ext', 'pbk'>, '32'),
                                                                                 <'0', '0'>, '32'), 
                                                                          h(<
                                                                             <
                                                                              <'0', '1', '0x0303', ~tid, '0', 
                                                                               $cipher_suites, '0', 
                                                                               <'43', '0x0304'>, 
                                                                               <'10', $g1, $g>, 
                                                                               <'40', $g1, $g1^~x>, 
                                                                               <'45', '0', '1'>, <'42', '0'>, 
                                                                               '41', 
                                                                               <~ticket, 
                                                                                mask(~ticket_age_add,
                                                                                     $ticket_age)
                                                                               >, 
                                                                               hmac(<
                                                                                     Expand(Expand(Extract(~res_psk,
                                                                                                           '0'),
                                                                                                   <'ext', 
                                                                                                    'pbk'>,
                                                                                                   '32'),
                                                                                            <'0', '0'>,
                                                                                            '32'), 
                                                                                     h(<'0', '1', '0x0303', 
                                                                                        ~tid, '0', 
                                                                                        $cipher_suites, '0', 
                                                                                        <'43', '0x0304'>, 
                                                                                        <'10', $g1, $g>, 
                                                                                        <'40', $g1, $g1^~x>, 
                                                                                        <'45', '0', '1'>, 
                                                                                        <'42', '0'>, '41', 
                                                                                        <~ticket, 
                                                                                         mask(~ticket_age_add,
                                                                                              $ticket_age)
                                                                                        >, 
                                                                                        '0'>)
                                                                                    >)
                                                                              >, 
                                                                              '6', '0x0303', '40', $g>, 
                                                                             '1', '0x0303', ~new_nc, '0', 
                                                                             $cipher_suites.1, '0', 
                                                                             <'43', '0x0304'>, 
                                                                             <'10', $g1, $g>, 
                                                                             <'40', $g, $g^~x.1>, 
                                                                             <'45', '0', '1'>, '0', '41', 
                                                                             <~ticket, 
                                                                              mask(~ticket_age_add, '1')>, 
                                                                             '0'>)
                                                                         >)
                                                                   >, 
                                                                   '2', '0x0303', p_ns, $cipher_suite, 
                                                                   <'13', $sig_algs>, '40', $g, p_gy>, 
                                                                  '8', $exts>, 
                                                                 '11', '0', pk(~ltkS)>, 
                                                                '15', 
                                                                sign(<'server_cv', 
                                                                      h(<
                                                                         <
                                                                          <
                                                                           <
                                                                            <
                                                                             <'0', '1', '0x0303', ~tid, '0', 
                                                                              $cipher_suites, '0', 
                                                                              <'43', '0x0304'>, 
                                                                              <'10', $g1, $g>, 
                                                                              <'40', $g1, $g1^~x>, 
                                                                              <'45', '0', '1'>, <'42', '0'>, 
                                                                              '41', 
                                                                              <~ticket, 
                                                                               mask(~ticket_age_add,
                                                                                    $ticket_age)
                                                                              >, 
                                                                              hmac(<
                                                                                    Expand(Expand(Extract(~res_psk,
                                                                                                          '0'),
                                                                                                  <'ext', 
                                                                                                   'pbk'>,
                                                                                                  '32'),
                                                                                           <'0', '0'>, '32'), 
                                                                                    h(<'0', '1', '0x0303', 
                                                                                       ~tid, '0', 
                                                                                       $cipher_suites, '0', 
                                                                                       <'43', '0x0304'>, 
                                                                                       <'10', $g1, $g>, 
                                                                                       <'40', $g1, $g1^~x>, 
                                                                                       <'45', '0', '1'>, 
                                                                                       <'42', '0'>, '41', 
                                                                                       <~ticket, 
                                                                                        mask(~ticket_age_add,
                                                                                             $ticket_age)
                                                                                       >, 
                                                                                       '0'>)
                                                                                   >)
                                                                             >, 
                                                                             '6', '0x0303', '40', $g>, 
                                                                            '1', '0x0303', ~new_nc, '0', 
                                                                            $cipher_suites.1, '0', 
                                                                            <'43', '0x0304'>, 
                                                                            <'10', $g1, $g>, 
                                                                            <'40', $g, $g^~x.1>, 
                                                                            <'45', '0', '1'>, '0', '41', 
                                                                            <~ticket, 
                                                                             mask(~ticket_age_add, '1')>, 
                                                                            hmac(<
                                                                                  Expand(Expand(Extract(~res_psk,
                                                                                                        '0'),
                                                                                                <'ext', 'pbk'
                                                                                                >,
                                                                                                '32'),
                                                                                         <'0', '0'>, '32'), 
                                                                                  h(<
                                                                                     <
                                                                                      <'0', '1', '0x0303', 
                                                                                       ~tid, '0', 
                                                                                       $cipher_suites, '0', 
                                                                                       <'43', '0x0304'>, 
                                                                                       <'10', $g1, $g>, 
                                                                                       <'40', $g1, $g1^~x>, 
                                                                                       <'45', '0', '1'>, 
                                                                                       <'42', '0'>, '41', 
                                                                                       <~ticket, 
                                                                                        mask(~ticket_age_add,
                                                                                             $ticket_age)
                                                                                       >, 
                                                                                       hmac(<
                                                                                             Expand(Expand(Extract(~res_psk,
                                                                                                                   '0'),
                                                                                                           <
                                                                                                            'ext', 
                                                                                                            'pbk'
                                                                                                           >,
                                                                                                           '32'),
                                                                                                    <'0', '0'
                                                                                                    >,
                                                                                                    '32'), 
                                                                                             h(<'0', '1', 
                                                                                                '0x0303', 
                                                                                                ~tid, '0', 
                                                                                                $cipher_suites, 
                                                                                                '0', 
                                                                                                <'43', 
                                                                                                 '0x0304'>, 
                                                                                                <'10', $g1, $g
                                                                                                >, 
                                                                                                <'40', $g1, 
                                                                                                 $g1^~x>, 
                                                                                                <'45', '0', 
                                                                                                 '1'>, 
                                                                                                <'42', '0'>, 
                                                                                                '41', 
                                                                                                <~ticket, 
                                                                                                 mask(~ticket_age_add,
                                                                                                      $ticket_age)
                                                                                                >, 
                                                                                                '0'>)
                                                                                            >)
                                                                                      >, 
                                                                                      '6', '0x0303', '40', $g
                                                                                     >, 
                                                                                     '1', '0x0303', ~new_nc, 
                                                                                     '0', $cipher_suites.1, 
                                                                                     '0', <'43', '0x0304'>, 
                                                                                     <'10', $g1, $g>, 
                                                                                     <'40', $g, $g^~x.1>, 
                                                                                     <'45', '0', '1'>, '0', 
                                                                                     '41', 
                                                                                     <~ticket, 
                                                                                      mask(~ticket_age_add,
                                                                                           '1')
                                                                                     >, 
                                                                                     '0'>)
                                                                                 >)
                                                                           >, 
                                                                           '2', '0x0303', p_ns, 
                                                                           $cipher_suite, <'13', $sig_algs>, 
                                                                           '40', $g, p_gy>, 
                                                                          '8', $exts>, 
                                                                         '11', '0', pk(~ltkS)>)
                                                                     >,
                                                                     ~ltkS)
                                                               >)
                                                            >,
                                                            '32'),
                                                     <'fin', '0'>, '32'), 
                                              h(<
                                                 <
                                                  <
                                                   <
                                                    <
                                                     <
                                                      <'0', '1', '0x0303', ~tid, '0', $cipher_suites, '0', 
                                                       <'43', '0x0304'>, <'10', $g1, $g>, 
                                                       <'40', $g1, $g1^~x>, <'45', '0', '1'>, <'42', '0'>, 
                                                       '41', <~ticket, mask(~ticket_age_add, $ticket_age)>, 
                                                       hmac(<
                                                             Expand(Expand(Extract(~res_psk, '0'),
                                                                           <'ext', 'pbk'>, '32'),
                                                                    <'0', '0'>, '32'), 
                                                             h(<'0', '1', '0x0303', ~tid, '0', 
                                                                $cipher_suites, '0', <'43', '0x0304'>, 
                                                                <'10', $g1, $g>, <'40', $g1, $g1^~x>, 
                                                                <'45', '0', '1'>, <'42', '0'>, '41', 
                                                                <~ticket, mask(~ticket_age_add, $ticket_age)
                                                                >, 
                                                                '0'>)
                                                            >)
                                                      >, 
                                                      '6', '0x0303', '40', $g>, 
                                                     '1', '0x0303', ~new_nc, '0', $cipher_suites.1, '0', 
                                                     <'43', '0x0304'>, <'10', $g1, $g>, <'40', $g, $g^~x.1>, 
                                                     <'45', '0', '1'>, '0', '41', 
                                                     <~ticket, mask(~ticket_age_add, '1')>, 
                                                     hmac(<
                                                           Expand(Expand(Extract(~res_psk, '0'),
                                                                         <'ext', 'pbk'>, '32'),
                                                                  <'0', '0'>, '32'), 
                                                           h(<
                                                              <
                                                               <'0', '1', '0x0303', ~tid, '0', 
                                                                $cipher_suites, '0', <'43', '0x0304'>, 
                                                                <'10', $g1, $g>, <'40', $g1, $g1^~x>, 
                                                                <'45', '0', '1'>, <'42', '0'>, '41', 
                                                                <~ticket, mask(~ticket_age_add, $ticket_age)
                                                                >, 
                                                                hmac(<
                                                                      Expand(Expand(Extract(~res_psk, '0'),
                                                                                    <'ext', 'pbk'>, '32'),
                                                                             <'0', '0'>, '32'), 
                                                                      h(<'0', '1', '0x0303', ~tid, '0', 
                                                                         $cipher_suites, '0', 
                                                                         <'43', '0x0304'>, <'10', $g1, $g>, 
                                                                         <'40', $g1, $g1^~x>, 
                                                                         <'45', '0', '1'>, <'42', '0'>, '41', 
                                                                         <~ticket, 
                                                                          mask(~ticket_age_add, $ticket_age)
                                                                         >, 
                                                                         '0'>)
                                                                     >)
                                                               >, 
                                                               '6', '0x0303', '40', $g>, 
                                                              '1', '0x0303', ~new_nc, '0', $cipher_suites.1, 
                                                              '0', <'43', '0x0304'>, <'10', $g1, $g>, 
                                                              <'40', $g, $g^~x.1>, <'45', '0', '1'>, '0', 
                                                              '41', <~ticket, mask(~ticket_age_add, '1')>, '0'
                                                             >)
                                                          >)
                                                    >, 
                                                    '2', '0x0303', p_ns, $cipher_suite, <'13', $sig_algs>, 
                                                    '40', $g, p_gy>, 
                                                   '8', $exts>, 
                                                  '11', '0', pk(~ltkS)>, 
                                                 '15', 
                                                 sign(<'server_cv', 
                                                       h(<
                                                          <
                                                           <
                                                            <
                                                             <
                                                              <'0', '1', '0x0303', ~tid, '0', $cipher_suites, 
                                                               '0', <'43', '0x0304'>, <'10', $g1, $g>, 
                                                               <'40', $g1, $g1^~x>, <'45', '0', '1'>, 
                                                               <'42', '0'>, '41', 
                                                               <~ticket, mask(~ticket_age_add, $ticket_age)>, 
                                                               hmac(<
                                                                     Expand(Expand(Extract(~res_psk, '0'),
                                                                                   <'ext', 'pbk'>, '32'),
                                                                            <'0', '0'>, '32'), 
                                                                     h(<'0', '1', '0x0303', ~tid, '0', 
                                                                        $cipher_suites, '0', 
                                                                        <'43', '0x0304'>, <'10', $g1, $g>, 
                                                                        <'40', $g1, $g1^~x>, 
                                                                        <'45', '0', '1'>, <'42', '0'>, '41', 
                                                                        <~ticket, 
                                                                         mask(~ticket_age_add, $ticket_age)>, 
                                                                        '0'>)
                                                                    >)
                                                              >, 
                                                              '6', '0x0303', '40', $g>, 
                                                             '1', '0x0303', ~new_nc, '0', $cipher_suites.1, 
                                                             '0', <'43', '0x0304'>, <'10', $g1, $g>, 
                                                             <'40', $g, $g^~x.1>, <'45', '0', '1'>, '0', 
                                                             '41', <~ticket, mask(~ticket_age_add, '1')>, 
                                                             hmac(<
                                                                   Expand(Expand(Extract(~res_psk, '0'),
                                                                                 <'ext', 'pbk'>, '32'),
                                                                          <'0', '0'>, '32'), 
                                                                   h(<
                                                                      <
                                                                       <'0', '1', '0x0303', ~tid, '0', 
                                                                        $cipher_suites, '0', 
                                                                        <'43', '0x0304'>, <'10', $g1, $g>, 
                                                                        <'40', $g1, $g1^~x>, 
                                                                        <'45', '0', '1'>, <'42', '0'>, '41', 
                                                                        <~ticket, 
                                                                         mask(~ticket_age_add, $ticket_age)>, 
                                                                        hmac(<
                                                                              Expand(Expand(Extract(~res_psk,
                                                                                                    '0'),
                                                                                            <'ext', 'pbk'>,
                                                                                            '32'),
                                                                                     <'0', '0'>, '32'), 
                                                                              h(<'0', '1', '0x0303', ~tid, 
                                                                                 '0', $cipher_suites, '0', 
                                                                                 <'43', '0x0304'>, 
                                                                                 <'10', $g1, $g>, 
                                                                                 <'40', $g1, $g1^~x>, 
                                                                                 <'45', '0', '1'>, 
                                                                                 <'42', '0'>, '41', 
                                                                                 <~ticket, 
                                                                                  mask(~ticket_age_add,
                                                                                       $ticket_age)
                                                                                 >, 
                                                                                 '0'>)
                                                                             >)
                                                                       >, 
                                                                       '6', '0x0303', '40', $g>, 
                                                                      '1', '0x0303', ~new_nc, '0', 
                                                                      $cipher_suites.1, '0', 
                                                                      <'43', '0x0304'>, <'10', $g1, $g>, 
                                                                      <'40', $g, $g^~x.1>, <'45', '0', '1'>, 
                                                                      '0', '41', 
                                                                      <~ticket, mask(~ticket_age_add, '1')>, 
                                                                      '0'>)
                                                                  >)
                                                            >, 
                                                            '2', '0x0303', p_ns, $cipher_suite, 
                                                            <'13', $sig_algs>, '40', $g, p_gy>, 
                                                           '8', $exts>, 
                                                          '11', '0', pk(~ltkS)>)
                                                      >,
                                                      ~ltkS)
                                                >)
                                             >)
                                       >)
                                    >,
                                    '32')
                  ) ▶₀ #l )
      qed
    next
      case recv_server_auth_case_08
      solve( (∃ #j.2.
               (!KU( Extract('0',
                             Extract(p_gxy, Extract(Expand(ms, <'rms', h(messages)>, '32'), '0')))
                ) @ #j.2)
              ∧
               #j.2 < #j.1)  ∥
             ((∀ #k.
                (!KU( Extract('0',
                              Extract(p_gxy, Extract(Expand(ms, <'rms', h(messages)>, '32'), '0')))
                 ) @ #k)
               ⇒
                ¬(#k < #j.1)) ∧
              (∃ actor #l.
                (RevealPSK( actor,
                            Expand(Extract('0',
                                           Extract(p_gxy,
                                                   Extract(Expand(ms, <'rms', h(messages)>, '32'), '0'))),
                                   <'serverats', 
                                    h(<
                                       <
                                        <
                                         <
                                          <
                                           <
                                            <
                                             <'0', '1', '0x0303', ~tid, '0', $cipher_suites, '0', 
                                              <'43', '0x0304'>, <'10', $g1, $g>, <'40', $g1, $g1^~x>, 
                                              <'45', '0', '1'>, <'42', '0'>, '41', 
                                              <p_psk_id, mask(ticket_age_add, $ticket_age)>, 
                                              hmac(<
                                                    Expand(Expand(Extract(Expand(ms, <'rms', h(messages)>,
                                                                                 '32'),
                                                                          '0'),
                                                                  <'res', 'pbk'>, '32'),
                                                           <'0', '0'>, '32'), 
                                                    h(<'0', '1', '0x0303', ~tid, '0', $cipher_suites, '0', 
                                                       <'43', '0x0304'>, <'10', $g1, $g>, 
                                                       <'40', $g1, $g1^~x>, <'45', '0', '1'>, <'42', '0'>, 
                                                       '41', <p_psk_id, mask(ticket_age_add, $ticket_age)>, 
                                                       '0'>)
                                                   >)
                                             >, 
                                             '6', '0x0303', '40', $g>, 
                                            '1', '0x0303', ~new_nc, '0', $cipher_suites.1, '0', 
                                            <'43', '0x0304'>, <'10', $g1, $g>, <'40', $g, $g^~x.1>, 
                                            <'45', '0', '1'>, '0', '41', 
                                            <p_psk_id, mask(ticket_age_add, '1')>, 
                                            hmac(<
                                                  Expand(Expand(Extract(Expand(ms, <'rms', h(messages)>,
                                                                               '32'),
                                                                        '0'),
                                                                <'res', 'pbk'>, '32'),
                                                         <'0', '0'>, '32'), 
                                                  h(<
                                                     <
                                                      <'0', '1', '0x0303', ~tid, '0', $cipher_suites, '0', 
                                                       <'43', '0x0304'>, <'10', $g1, $g>, 
                                                       <'40', $g1, $g1^~x>, <'45', '0', '1'>, <'42', '0'>, 
                                                       '41', <p_psk_id, mask(ticket_age_add, $ticket_age)>, 
                                                       hmac(<
                                                             Expand(Expand(Extract(Expand(ms,
                                                                                          <'rms', h(messages)
                                                                                          >,
                                                                                          '32'),
                                                                                   '0'),
                                                                           <'res', 'pbk'>, '32'),
                                                                    <'0', '0'>, '32'), 
                                                             h(<'0', '1', '0x0303', ~tid, '0', 
                                                                $cipher_suites, '0', <'43', '0x0304'>, 
                                                                <'10', $g1, $g>, <'40', $g1, $g1^~x>, 
                                                                <'45', '0', '1'>, <'42', '0'>, '41', 
                                                                <p_psk_id, mask(ticket_age_add, $ticket_age)
                                                                >, 
                                                                '0'>)
                                                            >)
                                                      >, 
                                                      '6', '0x0303', '40', $g>, 
                                                     '1', '0x0303', ~new_nc, '0', $cipher_suites.1, '0', 
                                                     <'43', '0x0304'>, <'10', $g1, $g>, <'40', $g, $g^~x.1>, 
                                                     <'45', '0', '1'>, '0', '41', 
                                                     <p_psk_id, mask(ticket_age_add, '1')>, '0'>)
                                                 >)
                                           >, 
                                           '2', '0x0303', p_ns, $cipher_suite, <'13', $sig_algs>, '40', $g, 
                                           p_gy>, 
                                          '8', $exts>, 
                                         '11', '0', pk(~ltkS)>, 
                                        '15', 
                                        sign(<'server_cv', 
                                              h(<
                                                 <
                                                  <
                                                   <
                                                    <
                                                     <'0', '1', '0x0303', ~tid, '0', $cipher_suites, '0', 
                                                      <'43', '0x0304'>, <'10', $g1, $g>, <'40', $g1, $g1^~x>, 
                                                      <'45', '0', '1'>, <'42', '0'>, '41', 
                                                      <p_psk_id, mask(ticket_age_add, $ticket_age)>, 
                                                      hmac(<
                                                            Expand(Expand(Extract(Expand(ms,
                                                                                         <'rms', h(messages)>,
                                                                                         '32'),
                                                                                  '0'),
                                                                          <'res', 'pbk'>, '32'),
                                                                   <'0', '0'>, '32'), 
                                                            h(<'0', '1', '0x0303', ~tid, '0', $cipher_suites, 
                                                               '0', <'43', '0x0304'>, <'10', $g1, $g>, 
                                                               <'40', $g1, $g1^~x>, <'45', '0', '1'>, 
                                                               <'42', '0'>, '41', 
                                                               <p_psk_id, mask(ticket_age_add, $ticket_age)>, 
                                                               '0'>)
                                                           >)
                                                     >, 
                                                     '6', '0x0303', '40', $g>, 
                                                    '1', '0x0303', ~new_nc, '0', $cipher_suites.1, '0', 
                                                    <'43', '0x0304'>, <'10', $g1, $g>, <'40', $g, $g^~x.1>, 
                                                    <'45', '0', '1'>, '0', '41', 
                                                    <p_psk_id, mask(ticket_age_add, '1')>, 
                                                    hmac(<
                                                          Expand(Expand(Extract(Expand(ms,
                                                                                       <'rms', h(messages)>,
                                                                                       '32'),
                                                                                '0'),
                                                                        <'res', 'pbk'>, '32'),
                                                                 <'0', '0'>, '32'), 
                                                          h(<
                                                             <
                                                              <'0', '1', '0x0303', ~tid, '0', $cipher_suites, 
                                                               '0', <'43', '0x0304'>, <'10', $g1, $g>, 
                                                               <'40', $g1, $g1^~x>, <'45', '0', '1'>, 
                                                               <'42', '0'>, '41', 
                                                               <p_psk_id, mask(ticket_age_add, $ticket_age)>, 
                                                               hmac(<
                                                                     Expand(Expand(Extract(Expand(ms,
                                                                                                  <'rms', 
                                                                                                   h(messages)
                                                                                                  >,
                                                                                                  '32'),
                                                                                           '0'),
                                                                                   <'res', 'pbk'>, '32'),
                                                                            <'0', '0'>, '32'), 
                                                                     h(<'0', '1', '0x0303', ~tid, '0', 
                                                                        $cipher_suites, '0', 
                                                                        <'43', '0x0304'>, <'10', $g1, $g>, 
                                                                        <'40', $g1, $g1^~x>, 
                                                                        <'45', '0', '1'>, <'42', '0'>, '41', 
                                                                        <p_psk_id, 
                                                                         mask(ticket_age_add, $ticket_age)>, 
                                                                        '0'>)
                                                                    >)
                                                              >, 
                                                              '6', '0x0303', '40', $g>, 
                                                             '1', '0x0303', ~new_nc, '0', $cipher_suites.1, 
                                                             '0', <'43', '0x0304'>, <'10', $g1, $g>, 
                                                             <'40', $g, $g^~x.1>, <'45', '0', '1'>, '0', 
                                                             '41', <p_psk_id, mask(ticket_age_add, '1')>, '0'
                                                            >)
                                                         >)
                                                   >, 
                                                   '2', '0x0303', p_ns, $cipher_suite, <'13', $sig_algs>, 
                                                   '40', $g, p_gy>, 
                                                  '8', $exts>, 
                                                 '11', '0', pk(~ltkS)>)
                                             >,
                                             ~ltkS)
                                       >, 
                                       '20', 
                                       hmac(<
                                             Expand(Expand(Extract(p_gxy,
                                                                   Extract(Expand(ms, <'rms', h(messages)>,
                                                                                  '32'),
                                                                           '0')),
                                                           <'serverhts', 
                                                            h(<
                                                               <
                                                                <
                                                                 <
                                                                  <
                                                                   <
                                                                    <'0', '1', '0x0303', ~tid, '0', 
                                                                     $cipher_suites, '0', <'43', '0x0304'>, 
                                                                     <'10', $g1, $g>, <'40', $g1, $g1^~x>, 
                                                                     <'45', '0', '1'>, <'42', '0'>, '41', 
                                                                     <p_psk_id, 
                                                                      mask(ticket_age_add, $ticket_age)>, 
                                                                     hmac(<
                                                                           Expand(Expand(Extract(Expand(ms,
                                                                                                        <
                                                                                                         'rms', 
                                                                                                         h(messages)
                                                                                                        >,
                                                                                                        '32'),
                                                                                                 '0'),
                                                                                         <'res', 'pbk'>,
                                                                                         '32'),
                                                                                  <'0', '0'>, '32'), 
                                                                           h(<'0', '1', '0x0303', ~tid, '0', 
                                                                              $cipher_suites, '0', 
                                                                              <'43', '0x0304'>, 
                                                                              <'10', $g1, $g>, 
                                                                              <'40', $g1, $g1^~x>, 
                                                                              <'45', '0', '1'>, <'42', '0'>, 
                                                                              '41', 
                                                                              <p_psk_id, 
                                                                               mask(ticket_age_add,
                                                                                    $ticket_age)
                                                                              >, 
                                                                              '0'>)
                                                                          >)
                                                                    >, 
                                                                    '6', '0x0303', '40', $g>, 
                                                                   '1', '0x0303', ~new_nc, '0', 
                                                                   $cipher_suites.1, '0', <'43', '0x0304'>, 
                                                                   <'10', $g1, $g>, <'40', $g, $g^~x.1>, 
                                                                   <'45', '0', '1'>, '0', '41', 
                                                                   <p_psk_id, mask(ticket_age_add, '1')>, 
                                                                   hmac(<
                                                                         Expand(Expand(Extract(Expand(ms,
                                                                                                      <'rms', 
                                                                                                       h(messages)
                                                                                                      >,
                                                                                                      '32'),
                                                                                               '0'),
                                                                                       <'res', 'pbk'>, '32'),
                                                                                <'0', '0'>, '32'), 
                                                                         h(<
                                                                            <
                                                                             <'0', '1', '0x0303', ~tid, '0', 
                                                                              $cipher_suites, '0', 
                                                                              <'43', '0x0304'>, 
                                                                              <'10', $g1, $g>, 
                                                                              <'40', $g1, $g1^~x>, 
                                                                              <'45', '0', '1'>, <'42', '0'>, 
                                                                              '41', 
                                                                              <p_psk_id, 
                                                                               mask(ticket_age_add,
                                                                                    $ticket_age)
                                                                              >, 
                                                                              hmac(<
                                                                                    Expand(Expand(Extract(Expand(ms,
                                                                                                                 <
                                                                                                                  'rms', 
                                                                                                                  h(messages)
                                                                                                                 >,
                                                                                                                 '32'),
                                                                                                          '0'),
                                                                                                  <'res', 
                                                                                                   'pbk'>,
                                                                                                  '32'),
                                                                                           <'0', '0'>, '32'), 
                                                                                    h(<'0', '1', '0x0303', 
                                                                                       ~tid, '0', 
                                                                                       $cipher_suites, '0', 
                                                                                       <'43', '0x0304'>, 
                                                                                       <'10', $g1, $g>, 
                                                                                       <'40', $g1, $g1^~x>, 
                                                                                       <'45', '0', '1'>, 
                                                                                       <'42', '0'>, '41', 
                                                                                       <p_psk_id, 
                                                                                        mask(ticket_age_add,
                                                                                             $ticket_age)
                                                                                       >, 
                                                                                       '0'>)
                                                                                   >)
                                                                             >, 
                                                                             '6', '0x0303', '40', $g>, 
                                                                            '1', '0x0303', ~new_nc, '0', 
                                                                            $cipher_suites.1, '0', 
                                                                            <'43', '0x0304'>, 
                                                                            <'10', $g1, $g>, 
                                                                            <'40', $g, $g^~x.1>, 
                                                                            <'45', '0', '1'>, '0', '41', 
                                                                            <p_psk_id, 
                                                                             mask(ticket_age_add, '1')>, 
                                                                            '0'>)
                                                                        >)
                                                                  >, 
                                                                  '2', '0x0303', p_ns, $cipher_suite, 
                                                                  <'13', $sig_algs>, '40', $g, p_gy>, 
                                                                 '8', $exts>, 
                                                                '11', '0', pk(~ltkS)>, 
                                                               '15', 
                                                               sign(<'server_cv', 
                                                                     h(<
                                                                        <
                                                                         <
                                                                          <
                                                                           <
                                                                            <'0', '1', '0x0303', ~tid, '0', 
                                                                             $cipher_suites, '0', 
                                                                             <'43', '0x0304'>, 
                                                                             <'10', $g1, $g>, 
                                                                             <'40', $g1, $g1^~x>, 
                                                                             <'45', '0', '1'>, <'42', '0'>, 
                                                                             '41', 
                                                                             <p_psk_id, 
                                                                              mask(ticket_age_add,
                                                                                   $ticket_age)
                                                                             >, 
                                                                             hmac(<
                                                                                   Expand(Expand(Extract(Expand(ms,
                                                                                                                <
                                                                                                                 'rms', 
                                                                                                                 h(messages)
                                                                                                                >,
                                                                                                                '32'),
                                                                                                         '0'),
                                                                                                 <'res', 'pbk'
                                                                                                 >,
                                                                                                 '32'),
                                                                                          <'0', '0'>, '32'), 
                                                                                   h(<'0', '1', '0x0303', 
                                                                                      ~tid, '0', 
                                                                                      $cipher_suites, '0', 
                                                                                      <'43', '0x0304'>, 
                                                                                      <'10', $g1, $g>, 
                                                                                      <'40', $g1, $g1^~x>, 
                                                                                      <'45', '0', '1'>, 
                                                                                      <'42', '0'>, '41', 
                                                                                      <p_psk_id, 
                                                                                       mask(ticket_age_add,
                                                                                            $ticket_age)
                                                                                      >, 
                                                                                      '0'>)
                                                                                  >)
                                                                            >, 
                                                                            '6', '0x0303', '40', $g>, 
                                                                           '1', '0x0303', ~new_nc, '0', 
                                                                           $cipher_suites.1, '0', 
                                                                           <'43', '0x0304'>, <'10', $g1, $g>, 
                                                                           <'40', $g, $g^~x.1>, 
                                                                           <'45', '0', '1'>, '0', '41', 
                                                                           <p_psk_id, 
                                                                            mask(ticket_age_add, '1')>, 
                                                                           hmac(<
                                                                                 Expand(Expand(Extract(Expand(ms,
                                                                                                              <
                                                                                                               'rms', 
                                                                                                               h(messages)
                                                                                                              >,
                                                                                                              '32'),
                                                                                                       '0'),
                                                                                               <'res', 'pbk'>,
                                                                                               '32'),
                                                                                        <'0', '0'>, '32'), 
                                                                                 h(<
                                                                                    <
                                                                                     <'0', '1', '0x0303', 
                                                                                      ~tid, '0', 
                                                                                      $cipher_suites, '0', 
                                                                                      <'43', '0x0304'>, 
                                                                                      <'10', $g1, $g>, 
                                                                                      <'40', $g1, $g1^~x>, 
                                                                                      <'45', '0', '1'>, 
                                                                                      <'42', '0'>, '41', 
                                                                                      <p_psk_id, 
                                                                                       mask(ticket_age_add,
                                                                                            $ticket_age)
                                                                                      >, 
                                                                                      hmac(<
                                                                                            Expand(Expand(Extract(Expand(ms,
                                                                                                                         <
                                                                                                                          'rms', 
                                                                                                                          h(messages)
                                                                                                                         >,
                                                                                                                         '32'),
                                                                                                                  '0'),
                                                                                                          <
                                                                                                           'res', 
                                                                                                           'pbk'
                                                                                                          >,
                                                                                                          '32'),
                                                                                                   <'0', '0'>,
                                                                                                   '32'), 
                                                                                            h(<'0', '1', 
                                                                                               '0x0303', 
                                                                                               ~tid, '0', 
                                                                                               $cipher_suites, 
                                                                                               '0', 
                                                                                               <'43', '0x0304'
                                                                                               >, 
                                                                                               <'10', $g1, $g
                                                                                               >, 
                                                                                               <'40', $g1, 
                                                                                                $g1^~x>, 
                                                                                               <'45', '0', '1'
                                                                                               >, 
                                                                                               <'42', '0'>, 
                                                                                               '41', 
                                                                                               <p_psk_id, 
                                                                                                mask(ticket_age_add,
                                                                                                     $ticket_age)
                                                                                               >, 
                                                                                               '0'>)
                                                                                           >)
                                                                                     >, 
                                                                                     '6', '0x0303', '40', $g
                                                                                    >, 
                                                                                    '1', '0x0303', ~new_nc, 
                                                                                    '0', $cipher_suites.1, 
                                                                                    '0', <'43', '0x0304'>, 
                                                                                    <'10', $g1, $g>, 
                                                                                    <'40', $g, $g^~x.1>, 
                                                                                    <'45', '0', '1'>, '0', 
                                                                                    '41', 
                                                                                    <p_psk_id, 
                                                                                     mask(ticket_age_add, '1')
                                                                                    >, 
                                                                                    '0'>)
                                                                                >)
                                                                          >, 
                                                                          '2', '0x0303', p_ns, $cipher_suite, 
                                                                          <'13', $sig_algs>, '40', $g, p_gy>, 
                                                                         '8', $exts>, 
                                                                        '11', '0', pk(~ltkS)>)
                                                                    >,
                                                                    ~ltkS)
                                                              >)
                                                           >,
                                                           '32'),
                                                    <'fin', '0'>, '32'), 
                                             h(<
                                                <
                                                 <
                                                  <
                                                   <
                                                    <
                                                     <'0', '1', '0x0303', ~tid, '0', $cipher_suites, '0', 
                                                      <'43', '0x0304'>, <'10', $g1, $g>, <'40', $g1, $g1^~x>, 
                                                      <'45', '0', '1'>, <'42', '0'>, '41', 
                                                      <p_psk_id, mask(ticket_age_add, $ticket_age)>, 
                                                      hmac(<
                                                            Expand(Expand(Extract(Expand(ms,
                                                                                         <'rms', h(messages)>,
                                                                                         '32'),
                                                                                  '0'),
                                                                          <'res', 'pbk'>, '32'),
                                                                   <'0', '0'>, '32'), 
                                                            h(<'0', '1', '0x0303', ~tid, '0', $cipher_suites, 
                                                               '0', <'43', '0x0304'>, <'10', $g1, $g>, 
                                                               <'40', $g1, $g1^~x>, <'45', '0', '1'>, 
                                                               <'42', '0'>, '41', 
                                                               <p_psk_id, mask(ticket_age_add, $ticket_age)>, 
                                                               '0'>)
                                                           >)
                                                     >, 
                                                     '6', '0x0303', '40', $g>, 
                                                    '1', '0x0303', ~new_nc, '0', $cipher_suites.1, '0', 
                                                    <'43', '0x0304'>, <'10', $g1, $g>, <'40', $g, $g^~x.1>, 
                                                    <'45', '0', '1'>, '0', '41', 
                                                    <p_psk_id, mask(ticket_age_add, '1')>, 
                                                    hmac(<
                                                          Expand(Expand(Extract(Expand(ms,
                                                                                       <'rms', h(messages)>,
                                                                                       '32'),
                                                                                '0'),
                                                                        <'res', 'pbk'>, '32'),
                                                                 <'0', '0'>, '32'), 
                                                          h(<
                                                             <
                                                              <'0', '1', '0x0303', ~tid, '0', $cipher_suites, 
                                                               '0', <'43', '0x0304'>, <'10', $g1, $g>, 
                                                               <'40', $g1, $g1^~x>, <'45', '0', '1'>, 
                                                               <'42', '0'>, '41', 
                                                               <p_psk_id, mask(ticket_age_add, $ticket_age)>, 
                                                               hmac(<
                                                                     Expand(Expand(Extract(Expand(ms,
                                                                                                  <'rms', 
                                                                                                   h(messages)
                                                                                                  >,
                                                                                                  '32'),
                                                                                           '0'),
                                                                                   <'res', 'pbk'>, '32'),
                                                                            <'0', '0'>, '32'), 
                                                                     h(<'0', '1', '0x0303', ~tid, '0', 
                                                                        $cipher_suites, '0', 
                                                                        <'43', '0x0304'>, <'10', $g1, $g>, 
                                                                        <'40', $g1, $g1^~x>, 
                                                                        <'45', '0', '1'>, <'42', '0'>, '41', 
                                                                        <p_psk_id, 
                                                                         mask(ticket_age_add, $ticket_age)>, 
                                                                        '0'>)
                                                                    >)
                                                              >, 
                                                              '6', '0x0303', '40', $g>, 
                                                             '1', '0x0303', ~new_nc, '0', $cipher_suites.1, 
                                                             '0', <'43', '0x0304'>, <'10', $g1, $g>, 
                                                             <'40', $g, $g^~x.1>, <'45', '0', '1'>, '0', 
                                                             '41', <p_psk_id, mask(ticket_age_add, '1')>, '0'
                                                            >)
                                                         >)
                                                   >, 
                                                   '2', '0x0303', p_ns, $cipher_suite, <'13', $sig_algs>, 
                                                   '40', $g, p_gy>, 
                                                  '8', $exts>, 
                                                 '11', '0', pk(~ltkS)>, 
                                                '15', 
                                                sign(<'server_cv', 
                                                      h(<
                                                         <
                                                          <
                                                           <
                                                            <
                                                             <'0', '1', '0x0303', ~tid, '0', $cipher_suites, 
                                                              '0', <'43', '0x0304'>, <'10', $g1, $g>, 
                                                              <'40', $g1, $g1^~x>, <'45', '0', '1'>, 
                                                              <'42', '0'>, '41', 
                                                              <p_psk_id, mask(ticket_age_add, $ticket_age)>, 
                                                              hmac(<
                                                                    Expand(Expand(Extract(Expand(ms,
                                                                                                 <'rms', 
                                                                                                  h(messages)
                                                                                                 >,
                                                                                                 '32'),
                                                                                          '0'),
                                                                                  <'res', 'pbk'>, '32'),
                                                                           <'0', '0'>, '32'), 
                                                                    h(<'0', '1', '0x0303', ~tid, '0', 
                                                                       $cipher_suites, '0', <'43', '0x0304'>, 
                                                                       <'10', $g1, $g>, <'40', $g1, $g1^~x>, 
                                                                       <'45', '0', '1'>, <'42', '0'>, '41', 
                                                                       <p_psk_id, 
                                                                        mask(ticket_age_add, $ticket_age)>, 
                                                                       '0'>)
                                                                   >)
                                                             >, 
                                                             '6', '0x0303', '40', $g>, 
                                                            '1', '0x0303', ~new_nc, '0', $cipher_suites.1, 
                                                            '0', <'43', '0x0304'>, <'10', $g1, $g>, 
                                                            <'40', $g, $g^~x.1>, <'45', '0', '1'>, '0', '41', 
                                                            <p_psk_id, mask(ticket_age_add, '1')>, 
                                                            hmac(<
                                                                  Expand(Expand(Extract(Expand(ms,
                                                                                               <'rms', 
                                                                                                h(messages)>,
                                                                                               '32'),
                                                                                        '0'),
                                                                                <'res', 'pbk'>, '32'),
                                                                         <'0', '0'>, '32'), 
                                                                  h(<
                                                                     <
                                                                      <'0', '1', '0x0303', ~tid, '0', 
                                                                       $cipher_suites, '0', <'43', '0x0304'>, 
                                                                       <'10', $g1, $g>, <'40', $g1, $g1^~x>, 
                                                                       <'45', '0', '1'>, <'42', '0'>, '41', 
                                                                       <p_psk_id, 
                                                                        mask(ticket_age_add, $ticket_age)>, 
                                                                       hmac(<
                                                                             Expand(Expand(Extract(Expand(ms,
                                                                                                          <
                                                                                                           'rms', 
                                                                                                           h(messages)
                                                                                                          >,
                                                                                                          '32'),
                                                                                                   '0'),
                                                                                           <'res', 'pbk'>,
                                                                                           '32'),
                                                                                    <'0', '0'>, '32'), 
                                                                             h(<'0', '1', '0x0303', ~tid, 
                                                                                '0', $cipher_suites, '0', 
                                                                                <'43', '0x0304'>, 
                                                                                <'10', $g1, $g>, 
                                                                                <'40', $g1, $g1^~x>, 
                                                                                <'45', '0', '1'>, 
                                                                                <'42', '0'>, '41', 
                                                                                <p_psk_id, 
                                                                                 mask(ticket_age_add,
                                                                                      $ticket_age)
                                                                                >, 
                                                                                '0'>)
                                                                            >)
                                                                      >, 
                                                                      '6', '0x0303', '40', $g>, 
                                                                     '1', '0x0303', ~new_nc, '0', 
                                                                     $cipher_suites.1, '0', <'43', '0x0304'>, 
                                                                     <'10', $g1, $g>, <'40', $g, $g^~x.1>, 
                                                                     <'45', '0', '1'>, '0', '41', 
                                                                     <p_psk_id, mask(ticket_age_add, '1')>, 
                                                                     '0'>)
                                                                 >)
                                                           >, 
                                                           '2', '0x0303', p_ns, $cipher_suite, 
                                                           <'13', $sig_algs>, '40', $g, p_gy>, 
                                                          '8', $exts>, 
                                                         '11', '0', pk(~ltkS)>)
                                                     >,
                                                     ~ltkS)
                                               >)
                                            >)
                                      >)
                                   >,
                                   '32')
                 ) @ #l)
               ∧
                #l < #j.1)) )
        case case_1
        solve( (∃ #r. (RevLtk( $S ) @ #r) ∧ #r < #vr)  ∥
               (∃ tid3 x #r. (RevDHExp( tid3, $S, x ) @ #r) ∧ #r < #vr)  ∥
               (∃ tid4 y #r. (RevDHExp( tid4, $C, y ) @ #r) ∧ #r < #vr)  ∥
               (∃ rms #r. (RevealPSK( $C, rms ) @ #r) ∧ #r < #k.1)  ∥
               (∃ rms #r. (RevealPSK( $S, rms ) @ #r) ∧ #r < #k.1) )
          case case_1
          by contradiction /* from formulas */
        next
          case case_2
          by contradiction /* from formulas */
        next
          case case_3
          by contradiction /* from formulas */
        next
          case case_4
          solve( (∃ #r. (RevLtk( $S ) @ #r) ∧ #r < #vr)  ∥
                 (∃ tid3 x #r. (RevDHExp( tid3, $S, x ) @ #r) ∧ #r < #vr)  ∥
                 (∃ tid4 y #r. (RevDHExp( tid4, $C, y ) @ #r) ∧ #r < #vr)  ∥
                 (∃ rms #r. (RevealPSK( $C, rms ) @ #r) ∧ #r < #vr)  ∥
                 (∃ rms #r. (RevealPSK( $S, rms ) @ #r) ∧ #r < #vr) )
            case case_1
            by contradiction /* from formulas */
          next
            case case_2
            by contradiction /* from formulas */
          next
            case case_3
            by contradiction /* from formulas */
          next
            case case_4
            by contradiction /* from formulas */
          next
            case case_5
            by contradiction /* from formulas */
          qed
        next
          case case_5
          solve( (∃ #r. (RevLtk( $S ) @ #r) ∧ #r < #vr)  ∥
                 (∃ tid3 x #r. (RevDHExp( tid3, $S, x ) @ #r) ∧ #r < #vr)  ∥
                 (∃ tid4 y #r. (RevDHExp( tid4, $C, y ) @ #r) ∧ #r < #vr)  ∥
                 (∃ rms #r. (RevealPSK( $C, rms ) @ #r) ∧ #r < #vr)  ∥
                 (∃ rms #r. (RevealPSK( $S, rms ) @ #r) ∧ #r < #vr) )
            case case_1
            by contradiction /* from formulas */
          next
            case case_2
            by contradiction /* from formulas */
          next
            case case_3
            by contradiction /* from formulas */
          next
            case case_4
            by contradiction /* from formulas */
          next
            case case_5
            by contradiction /* from formulas */
          qed
        qed
      next
        case case_2
        by solve( SecretPSK( $A,
                             Expand(Extract('0',
                                            Extract(p_gxy,
                                                    Extract(Expand(ms, <'rms', h(messages)>, '32'), '0'))),
                                    <'serverats', 
                                     h(<
                                        <
                                         <
                                          <
                                           <
                                            <
                                             <
                                              <'0', '1', '0x0303', ~tid, '0', $cipher_suites, '0', 
                                               <'43', '0x0304'>, <'10', $g1, $g>, <'40', $g1, $g1^~x>, 
                                               <'45', '0', '1'>, <'42', '0'>, '41', 
                                               <p_psk_id, mask(ticket_age_add, $ticket_age)>, 
                                               hmac(<
                                                     Expand(Expand(Extract(Expand(ms, <'rms', h(messages)>,
                                                                                  '32'),
                                                                           '0'),
                                                                   <'res', 'pbk'>, '32'),
                                                            <'0', '0'>, '32'), 
                                                     h(<'0', '1', '0x0303', ~tid, '0', $cipher_suites, '0', 
                                                        <'43', '0x0304'>, <'10', $g1, $g>, 
                                                        <'40', $g1, $g1^~x>, <'45', '0', '1'>, <'42', '0'>, 
                                                        '41', <p_psk_id, mask(ticket_age_add, $ticket_age)>, 
                                                        '0'>)
                                                    >)
                                              >, 
                                              '6', '0x0303', '40', $g>, 
                                             '1', '0x0303', ~new_nc, '0', $cipher_suites.1, '0', 
                                             <'43', '0x0304'>, <'10', $g1, $g>, <'40', $g, $g^~x.1>, 
                                             <'45', '0', '1'>, '0', '41', 
                                             <p_psk_id, mask(ticket_age_add, '1')>, 
                                             hmac(<
                                                   Expand(Expand(Extract(Expand(ms, <'rms', h(messages)>,
                                                                                '32'),
                                                                         '0'),
                                                                 <'res', 'pbk'>, '32'),
                                                          <'0', '0'>, '32'), 
                                                   h(<
                                                      <
                                                       <'0', '1', '0x0303', ~tid, '0', $cipher_suites, '0', 
                                                        <'43', '0x0304'>, <'10', $g1, $g>, 
                                                        <'40', $g1, $g1^~x>, <'45', '0', '1'>, <'42', '0'>, 
                                                        '41', <p_psk_id, mask(ticket_age_add, $ticket_age)>, 
                                                        hmac(<
                                                              Expand(Expand(Extract(Expand(ms,
                                                                                           <'rms', h(messages)
                                                                                           >,
                                                                                           '32'),
                                                                                    '0'),
                                                                            <'res', 'pbk'>, '32'),
                                                                     <'0', '0'>, '32'), 
                                                              h(<'0', '1', '0x0303', ~tid, '0', 
                                                                 $cipher_suites, '0', <'43', '0x0304'>, 
                                                                 <'10', $g1, $g>, <'40', $g1, $g1^~x>, 
                                                                 <'45', '0', '1'>, <'42', '0'>, '41', 
                                                                 <p_psk_id, mask(ticket_age_add, $ticket_age)
                                                                 >, 
                                                                 '0'>)
                                                             >)
                                                       >, 
                                                       '6', '0x0303', '40', $g>, 
                                                      '1', '0x0303', ~new_nc, '0', $cipher_suites.1, '0', 
                                                      <'43', '0x0304'>, <'10', $g1, $g>, <'40', $g, $g^~x.1>, 
                                                      <'45', '0', '1'>, '0', '41', 
                                                      <p_psk_id, mask(ticket_age_add, '1')>, '0'>)
                                                  >)
                                            >, 
                                            '2', '0x0303', p_ns, $cipher_suite, <'13', $sig_algs>, '40', $g, 
                                            p_gy>, 
                                           '8', $exts>, 
                                          '11', '0', pk(~ltkS)>, 
                                         '15', 
                                         sign(<'server_cv', 
                                               h(<
                                                  <
                                                   <
                                                    <
                                                     <
                                                      <'0', '1', '0x0303', ~tid, '0', $cipher_suites, '0', 
                                                       <'43', '0x0304'>, <'10', $g1, $g>, 
                                                       <'40', $g1, $g1^~x>, <'45', '0', '1'>, <'42', '0'>, 
                                                       '41', <p_psk_id, mask(ticket_age_add, $ticket_age)>, 
                                                       hmac(<
                                                             Expand(Expand(Extract(Expand(ms,
                                                                                          <'rms', h(messages)
                                                                                          >,
                                                                                          '32'),
                                                                                   '0'),
                                                                           <'res', 'pbk'>, '32'),
                                                                    <'0', '0'>, '32'), 
                                                             h(<'0', '1', '0x0303', ~tid, '0', 
                                                                $cipher_suites, '0', <'43', '0x0304'>, 
                                                                <'10', $g1, $g>, <'40', $g1, $g1^~x>, 
                                                                <'45', '0', '1'>, <'42', '0'>, '41', 
                                                                <p_psk_id, mask(ticket_age_add, $ticket_age)
                                                                >, 
                                                                '0'>)
                                                            >)
                                                      >, 
                                                      '6', '0x0303', '40', $g>, 
                                                     '1', '0x0303', ~new_nc, '0', $cipher_suites.1, '0', 
                                                     <'43', '0x0304'>, <'10', $g1, $g>, <'40', $g, $g^~x.1>, 
                                                     <'45', '0', '1'>, '0', '41', 
                                                     <p_psk_id, mask(ticket_age_add, '1')>, 
                                                     hmac(<
                                                           Expand(Expand(Extract(Expand(ms,
                                                                                        <'rms', h(messages)>,
                                                                                        '32'),
                                                                                 '0'),
                                                                         <'res', 'pbk'>, '32'),
                                                                  <'0', '0'>, '32'), 
                                                           h(<
                                                              <
                                                               <'0', '1', '0x0303', ~tid, '0', 
                                                                $cipher_suites, '0', <'43', '0x0304'>, 
                                                                <'10', $g1, $g>, <'40', $g1, $g1^~x>, 
                                                                <'45', '0', '1'>, <'42', '0'>, '41', 
                                                                <p_psk_id, mask(ticket_age_add, $ticket_age)
                                                                >, 
                                                                hmac(<
                                                                      Expand(Expand(Extract(Expand(ms,
                                                                                                   <'rms', 
                                                                                                    h(messages)
                                                                                                   >,
                                                                                                   '32'),
                                                                                            '0'),
                                                                                    <'res', 'pbk'>, '32'),
                                                                             <'0', '0'>, '32'), 
                                                                      h(<'0', '1', '0x0303', ~tid, '0', 
                                                                         $cipher_suites, '0', 
                                                                         <'43', '0x0304'>, <'10', $g1, $g>, 
                                                                         <'40', $g1, $g1^~x>, 
                                                                         <'45', '0', '1'>, <'42', '0'>, '41', 
                                                                         <p_psk_id, 
                                                                          mask(ticket_age_add, $ticket_age)>, 
                                                                         '0'>)
                                                                     >)
                                                               >, 
                                                               '6', '0x0303', '40', $g>, 
                                                              '1', '0x0303', ~new_nc, '0', $cipher_suites.1, 
                                                              '0', <'43', '0x0304'>, <'10', $g1, $g>, 
                                                              <'40', $g, $g^~x.1>, <'45', '0', '1'>, '0', 
                                                              '41', <p_psk_id, mask(ticket_age_add, '1')>, '0'
                                                             >)
                                                          >)
                                                    >, 
                                                    '2', '0x0303', p_ns, $cipher_suite, <'13', $sig_algs>, 
                                                    '40', $g, p_gy>, 
                                                   '8', $exts>, 
                                                  '11', '0', pk(~ltkS)>)
                                              >,
                                              ~ltkS)
                                        >, 
                                        '20', 
                                        hmac(<
                                              Expand(Expand(Extract(p_gxy,
                                                                    Extract(Expand(ms, <'rms', h(messages)>,
                                                                                   '32'),
                                                                            '0')),
                                                            <'serverhts', 
                                                             h(<
                                                                <
                                                                 <
                                                                  <
                                                                   <
                                                                    <
                                                                     <'0', '1', '0x0303', ~tid, '0', 
                                                                      $cipher_suites, '0', <'43', '0x0304'>, 
                                                                      <'10', $g1, $g>, <'40', $g1, $g1^~x>, 
                                                                      <'45', '0', '1'>, <'42', '0'>, '41', 
                                                                      <p_psk_id, 
                                                                       mask(ticket_age_add, $ticket_age)>, 
                                                                      hmac(<
                                                                            Expand(Expand(Extract(Expand(ms,
                                                                                                         <
                                                                                                          'rms', 
                                                                                                          h(messages)
                                                                                                         >,
                                                                                                         '32'),
                                                                                                  '0'),
                                                                                          <'res', 'pbk'>,
                                                                                          '32'),
                                                                                   <'0', '0'>, '32'), 
                                                                            h(<'0', '1', '0x0303', ~tid, '0', 
                                                                               $cipher_suites, '0', 
                                                                               <'43', '0x0304'>, 
                                                                               <'10', $g1, $g>, 
                                                                               <'40', $g1, $g1^~x>, 
                                                                               <'45', '0', '1'>, <'42', '0'>, 
                                                                               '41', 
                                                                               <p_psk_id, 
                                                                                mask(ticket_age_add,
                                                                                     $ticket_age)
                                                                               >, 
                                                                               '0'>)
                                                                           >)
                                                                     >, 
                                                                     '6', '0x0303', '40', $g>, 
                                                                    '1', '0x0303', ~new_nc, '0', 
                                                                    $cipher_suites.1, '0', <'43', '0x0304'>, 
                                                                    <'10', $g1, $g>, <'40', $g, $g^~x.1>, 
                                                                    <'45', '0', '1'>, '0', '41', 
                                                                    <p_psk_id, mask(ticket_age_add, '1')>, 
                                                                    hmac(<
                                                                          Expand(Expand(Extract(Expand(ms,
                                                                                                       <
                                                                                                        'rms', 
                                                                                                        h(messages)
                                                                                                       >,
                                                                                                       '32'),
                                                                                                '0'),
                                                                                        <'res', 'pbk'>, '32'),
                                                                                 <'0', '0'>, '32'), 
                                                                          h(<
                                                                             <
                                                                              <'0', '1', '0x0303', ~tid, '0', 
                                                                               $cipher_suites, '0', 
                                                                               <'43', '0x0304'>, 
                                                                               <'10', $g1, $g>, 
                                                                               <'40', $g1, $g1^~x>, 
                                                                               <'45', '0', '1'>, <'42', '0'>, 
                                                                               '41', 
                                                                               <p_psk_id, 
                                                                                mask(ticket_age_add,
                                                                                     $ticket_age)
                                                                               >, 
                                                                               hmac(<
                                                                                     Expand(Expand(Extract(Expand(ms,
                                                                                                                  <
                                                                                                                   'rms', 
                                                                                                                   h(messages)
                                                                                                                  >,
                                                                                                                  '32'),
                                                                                                           '0'),
                                                                                                   <'res', 
                                                                                                    'pbk'>,
                                                                                                   '32'),
                                                                                            <'0', '0'>,
                                                                                            '32'), 
                                                                                     h(<'0', '1', '0x0303', 
                                                                                        ~tid, '0', 
                                                                                        $cipher_suites, '0', 
                                                                                        <'43', '0x0304'>, 
                                                                                        <'10', $g1, $g>, 
                                                                                        <'40', $g1, $g1^~x>, 
                                                                                        <'45', '0', '1'>, 
                                                                                        <'42', '0'>, '41', 
                                                                                        <p_psk_id, 
                                                                                         mask(ticket_age_add,
                                                                                              $ticket_age)
                                                                                        >, 
                                                                                        '0'>)
                                                                                    >)
                                                                              >, 
                                                                              '6', '0x0303', '40', $g>, 
                                                                             '1', '0x0303', ~new_nc, '0', 
                                                                             $cipher_suites.1, '0', 
                                                                             <'43', '0x0304'>, 
                                                                             <'10', $g1, $g>, 
                                                                             <'40', $g, $g^~x.1>, 
                                                                             <'45', '0', '1'>, '0', '41', 
                                                                             <p_psk_id, 
                                                                              mask(ticket_age_add, '1')>, 
                                                                             '0'>)
                                                                         >)
                                                                   >, 
                                                                   '2', '0x0303', p_ns, $cipher_suite, 
                                                                   <'13', $sig_algs>, '40', $g, p_gy>, 
                                                                  '8', $exts>, 
                                                                 '11', '0', pk(~ltkS)>, 
                                                                '15', 
                                                                sign(<'server_cv', 
                                                                      h(<
                                                                         <
                                                                          <
                                                                           <
                                                                            <
                                                                             <'0', '1', '0x0303', ~tid, '0', 
                                                                              $cipher_suites, '0', 
                                                                              <'43', '0x0304'>, 
                                                                              <'10', $g1, $g>, 
                                                                              <'40', $g1, $g1^~x>, 
                                                                              <'45', '0', '1'>, <'42', '0'>, 
                                                                              '41', 
                                                                              <p_psk_id, 
                                                                               mask(ticket_age_add,
                                                                                    $ticket_age)
                                                                              >, 
                                                                              hmac(<
                                                                                    Expand(Expand(Extract(Expand(ms,
                                                                                                                 <
                                                                                                                  'rms', 
                                                                                                                  h(messages)
                                                                                                                 >,
                                                                                                                 '32'),
                                                                                                          '0'),
                                                                                                  <'res', 
                                                                                                   'pbk'>,
                                                                                                  '32'),
                                                                                           <'0', '0'>, '32'), 
                                                                                    h(<'0', '1', '0x0303', 
                                                                                       ~tid, '0', 
                                                                                       $cipher_suites, '0', 
                                                                                       <'43', '0x0304'>, 
                                                                                       <'10', $g1, $g>, 
                                                                                       <'40', $g1, $g1^~x>, 
                                                                                       <'45', '0', '1'>, 
                                                                                       <'42', '0'>, '41', 
                                                                                       <p_psk_id, 
                                                                                        mask(ticket_age_add,
                                                                                             $ticket_age)
                                                                                       >, 
                                                                                       '0'>)
                                                                                   >)
                                                                             >, 
                                                                             '6', '0x0303', '40', $g>, 
                                                                            '1', '0x0303', ~new_nc, '0', 
                                                                            $cipher_suites.1, '0', 
                                                                            <'43', '0x0304'>, 
                                                                            <'10', $g1, $g>, 
                                                                            <'40', $g, $g^~x.1>, 
                                                                            <'45', '0', '1'>, '0', '41', 
                                                                            <p_psk_id, 
                                                                             mask(ticket_age_add, '1')>, 
                                                                            hmac(<
                                                                                  Expand(Expand(Extract(Expand(ms,
                                                                                                               <
                                                                                                                'rms', 
                                                                                                                h(messages)
                                                                                                               >,
                                                                                                               '32'),
                                                                                                        '0'),
                                                                                                <'res', 'pbk'
                                                                                                >,
                                                                                                '32'),
                                                                                         <'0', '0'>, '32'), 
                                                                                  h(<
                                                                                     <
                                                                                      <'0', '1', '0x0303', 
                                                                                       ~tid, '0', 
                                                                                       $cipher_suites, '0', 
                                                                                       <'43', '0x0304'>, 
                                                                                       <'10', $g1, $g>, 
                                                                                       <'40', $g1, $g1^~x>, 
                                                                                       <'45', '0', '1'>, 
                                                                                       <'42', '0'>, '41', 
                                                                                       <p_psk_id, 
                                                                                        mask(ticket_age_add,
                                                                                             $ticket_age)
                                                                                       >, 
                                                                                       hmac(<
                                                                                             Expand(Expand(Extract(Expand(ms,
                                                                                                                          <
                                                                                                                           'rms', 
                                                                                                                           h(messages)
                                                                                                                          >,
                                                                                                                          '32'),
                                                                                                                   '0'),
                                                                                                           <
                                                                                                            'res', 
                                                                                                            'pbk'
                                                                                                           >,
                                                                                                           '32'),
                                                                                                    <'0', '0'
                                                                                                    >,
                                                                                                    '32'), 
                                                                                             h(<'0', '1', 
                                                                                                '0x0303', 
                                                                                                ~tid, '0', 
                                                                                                $cipher_suites, 
                                                                                                '0', 
                                                                                                <'43', 
                                                                                                 '0x0304'>, 
                                                                                                <'10', $g1, $g
                                                                                                >, 
                                                                                                <'40', $g1, 
                                                                                                 $g1^~x>, 
                                                                                                <'45', '0', 
                                                                                                 '1'>, 
                                                                                                <'42', '0'>, 
                                                                                                '41', 
                                                                                                <p_psk_id, 
                                                                                                 mask(ticket_age_add,
                                                                                                      $ticket_age)
                                                                                                >, 
                                                                                                '0'>)
                                                                                            >)
                                                                                      >, 
                                                                                      '6', '0x0303', '40', $g
                                                                                     >, 
                                                                                     '1', '0x0303', ~new_nc, 
                                                                                     '0', $cipher_suites.1, 
                                                                                     '0', <'43', '0x0304'>, 
                                                                                     <'10', $g1, $g>, 
                                                                                     <'40', $g, $g^~x.1>, 
                                                                                     <'45', '0', '1'>, '0', 
                                                                                     '41', 
                                                                                     <p_psk_id, 
                                                                                      mask(ticket_age_add,
                                                                                           '1')
                                                                                     >, 
                                                                                     '0'>)
                                                                                 >)
                                                                           >, 
                                                                           '2', '0x0303', p_ns, 
                                                                           $cipher_suite, <'13', $sig_algs>, 
                                                                           '40', $g, p_gy>, 
                                                                          '8', $exts>, 
                                                                         '11', '0', pk(~ltkS)>)
                                                                     >,
                                                                     ~ltkS)
                                                               >)
                                                            >,
                                                            '32'),
                                                     <'fin', '0'>, '32'), 
                                              h(<
                                                 <
                                                  <
                                                   <
                                                    <
                                                     <
                                                      <'0', '1', '0x0303', ~tid, '0', $cipher_suites, '0', 
                                                       <'43', '0x0304'>, <'10', $g1, $g>, 
                                                       <'40', $g1, $g1^~x>, <'45', '0', '1'>, <'42', '0'>, 
                                                       '41', <p_psk_id, mask(ticket_age_add, $ticket_age)>, 
                                                       hmac(<
                                                             Expand(Expand(Extract(Expand(ms,
                                                                                          <'rms', h(messages)
                                                                                          >,
                                                                                          '32'),
                                                                                   '0'),
                                                                           <'res', 'pbk'>, '32'),
                                                                    <'0', '0'>, '32'), 
                                                             h(<'0', '1', '0x0303', ~tid, '0', 
                                                                $cipher_suites, '0', <'43', '0x0304'>, 
                                                                <'10', $g1, $g>, <'40', $g1, $g1^~x>, 
                                                                <'45', '0', '1'>, <'42', '0'>, '41', 
                                                                <p_psk_id, mask(ticket_age_add, $ticket_age)
                                                                >, 
                                                                '0'>)
                                                            >)
                                                      >, 
                                                      '6', '0x0303', '40', $g>, 
                                                     '1', '0x0303', ~new_nc, '0', $cipher_suites.1, '0', 
                                                     <'43', '0x0304'>, <'10', $g1, $g>, <'40', $g, $g^~x.1>, 
                                                     <'45', '0', '1'>, '0', '41', 
                                                     <p_psk_id, mask(ticket_age_add, '1')>, 
                                                     hmac(<
                                                           Expand(Expand(Extract(Expand(ms,
                                                                                        <'rms', h(messages)>,
                                                                                        '32'),
                                                                                 '0'),
                                                                         <'res', 'pbk'>, '32'),
                                                                  <'0', '0'>, '32'), 
                                                           h(<
                                                              <
                                                               <'0', '1', '0x0303', ~tid, '0', 
                                                                $cipher_suites, '0', <'43', '0x0304'>, 
                                                                <'10', $g1, $g>, <'40', $g1, $g1^~x>, 
                                                                <'45', '0', '1'>, <'42', '0'>, '41', 
                                                                <p_psk_id, mask(ticket_age_add, $ticket_age)
                                                                >, 
                                                                hmac(<
                                                                      Expand(Expand(Extract(Expand(ms,
                                                                                                   <'rms', 
                                                                                                    h(messages)
                                                                                                   >,
                                                                                                   '32'),
                                                                                            '0'),
                                                                                    <'res', 'pbk'>, '32'),
                                                                             <'0', '0'>, '32'), 
                                                                      h(<'0', '1', '0x0303', ~tid, '0', 
                                                                         $cipher_suites, '0', 
                                                                         <'43', '0x0304'>, <'10', $g1, $g>, 
                                                                         <'40', $g1, $g1^~x>, 
                                                                         <'45', '0', '1'>, <'42', '0'>, '41', 
                                                                         <p_psk_id, 
                                                                          mask(ticket_age_add, $ticket_age)>, 
                                                                         '0'>)
                                                                     >)
                                                               >, 
                                                               '6', '0x0303', '40', $g>, 
                                                              '1', '0x0303', ~new_nc, '0', $cipher_suites.1, 
                                                              '0', <'43', '0x0304'>, <'10', $g1, $g>, 
                                                              <'40', $g, $g^~x.1>, <'45', '0', '1'>, '0', 
                                                              '41', <p_psk_id, mask(ticket_age_add, '1')>, '0'
                                                             >)
                                                          >)
                                                    >, 
                                                    '2', '0x0303', p_ns, $cipher_suite, <'13', $sig_algs>, 
                                                    '40', $g, p_gy>, 
                                                   '8', $exts>, 
                                                  '11', '0', pk(~ltkS)>, 
                                                 '15', 
                                                 sign(<'server_cv', 
                                                       h(<
                                                          <
                                                           <
                                                            <
                                                             <
                                                              <'0', '1', '0x0303', ~tid, '0', $cipher_suites, 
                                                               '0', <'43', '0x0304'>, <'10', $g1, $g>, 
                                                               <'40', $g1, $g1^~x>, <'45', '0', '1'>, 
                                                               <'42', '0'>, '41', 
                                                               <p_psk_id, mask(ticket_age_add, $ticket_age)>, 
                                                               hmac(<
                                                                     Expand(Expand(Extract(Expand(ms,
                                                                                                  <'rms', 
                                                                                                   h(messages)
                                                                                                  >,
                                                                                                  '32'),
                                                                                           '0'),
                                                                                   <'res', 'pbk'>, '32'),
                                                                            <'0', '0'>, '32'), 
                                                                     h(<'0', '1', '0x0303', ~tid, '0', 
                                                                        $cipher_suites, '0', 
                                                                        <'43', '0x0304'>, <'10', $g1, $g>, 
                                                                        <'40', $g1, $g1^~x>, 
                                                                        <'45', '0', '1'>, <'42', '0'>, '41', 
                                                                        <p_psk_id, 
                                                                         mask(ticket_age_add, $ticket_age)>, 
                                                                        '0'>)
                                                                    >)
                                                              >, 
                                                              '6', '0x0303', '40', $g>, 
                                                             '1', '0x0303', ~new_nc, '0', $cipher_suites.1, 
                                                             '0', <'43', '0x0304'>, <'10', $g1, $g>, 
                                                             <'40', $g, $g^~x.1>, <'45', '0', '1'>, '0', 
                                                             '41', <p_psk_id, mask(ticket_age_add, '1')>, 
                                                             hmac(<
                                                                   Expand(Expand(Extract(Expand(ms,
                                                                                                <'rms', 
                                                                                                 h(messages)>,
                                                                                                '32'),
                                                                                         '0'),
                                                                                 <'res', 'pbk'>, '32'),
                                                                          <'0', '0'>, '32'), 
                                                                   h(<
                                                                      <
                                                                       <'0', '1', '0x0303', ~tid, '0', 
                                                                        $cipher_suites, '0', 
                                                                        <'43', '0x0304'>, <'10', $g1, $g>, 
                                                                        <'40', $g1, $g1^~x>, 
                                                                        <'45', '0', '1'>, <'42', '0'>, '41', 
                                                                        <p_psk_id, 
                                                                         mask(ticket_age_add, $ticket_age)>, 
                                                                        hmac(<
                                                                              Expand(Expand(Extract(Expand(ms,
                                                                                                           <
                                                                                                            'rms', 
                                                                                                            h(messages)
                                                                                                           >,
                                                                                                           '32'),
                                                                                                    '0'),
                                                                                            <'res', 'pbk'>,
                                                                                            '32'),
                                                                                     <'0', '0'>, '32'), 
                                                                              h(<'0', '1', '0x0303', ~tid, 
                                                                                 '0', $cipher_suites, '0', 
                                                                                 <'43', '0x0304'>, 
                                                                                 <'10', $g1, $g>, 
                                                                                 <'40', $g1, $g1^~x>, 
                                                                                 <'45', '0', '1'>, 
                                                                                 <'42', '0'>, '41', 
                                                                                 <p_psk_id, 
                                                                                  mask(ticket_age_add,
                                                                                       $ticket_age)
                                                                                 >, 
                                                                                 '0'>)
                                                                             >)
                                                                       >, 
                                                                       '6', '0x0303', '40', $g>, 
                                                                      '1', '0x0303', ~new_nc, '0', 
                                                                      $cipher_suites.1, '0', 
                                                                      <'43', '0x0304'>, <'10', $g1, $g>, 
                                                                      <'40', $g, $g^~x.1>, <'45', '0', '1'>, 
                                                                      '0', '41', 
                                                                      <p_psk_id, mask(ticket_age_add, '1')>, 
                                                                      '0'>)
                                                                  >)
                                                            >, 
                                                            '2', '0x0303', p_ns, $cipher_suite, 
                                                            <'13', $sig_algs>, '40', $g, p_gy>, 
                                                           '8', $exts>, 
                                                          '11', '0', pk(~ltkS)>)
                                                      >,
                                                      ~ltkS)
                                                >)
                                             >)
                                       >)
                                    >,
                                    '32')
                  ) ▶₀ #l )
      qed
    next
      case recv_server_auth_case_09
      by contradiction /* from formulas */
    next
      case recv_server_auth_case_10
      by contradiction /* from formulas */
    next
      case recv_server_auth_case_11
      by contradiction /* from formulas */
    next
      case recv_server_auth_case_12
      by contradiction /* from formulas */
    next
      case recv_server_auth_case_13
      by contradiction /* from formulas */
    next
      case recv_server_auth_case_14
      by contradiction /* from formulas */
    next
      case recv_server_auth_case_15
      by contradiction /* from formulas */
    next
      case recv_server_auth_case_16
      by contradiction /* from formulas */
    next
      case recv_server_auth_psk_case_1
      solve( (∃ #j.2.
               (!KU( Extract('0',
                             Extract(p_gxy, Extract(Expand(ms, <'rms', h(messages)>, '32'), '0')))
                ) @ #j.2)
              ∧
               #j.2 < #j.1)  ∥
             ((∀ #k.
                (!KU( Extract('0',
                              Extract(p_gxy, Extract(Expand(ms, <'rms', h(messages)>, '32'), '0')))
                 ) @ #k)
               ⇒
                ¬(#k < #j.1)) ∧
              (∃ actor #l.
                (RevealPSK( actor,
                            Expand(Extract('0',
                                           Extract(p_gxy,
                                                   Extract(Expand(ms, <'rms', h(messages)>, '32'), '0'))),
                                   <'serverats', 
                                    h(<
                                       <
                                        <
                                         <'0', '1', '0x0303', ~tid, '0', $cipher_suites, '0', 
                                          <'43', '0x0304'>, <'10', $g, $g2>, <'40', $g, $g^~x>, 
                                          <'45', '0', '1'>, <'42', '0'>, '41', 
                                          <~ticket, mask(ticket_age_add, $ticket_age)>, 
                                          hmac(<
                                                Expand(Expand(Extract(Expand(ms, <'rms', h(messages)>, '32'),
                                                                      '0'),
                                                              <'res', 'pbk'>, '32'),
                                                       <'0', '0'>, '32'), 
                                                h(<'0', '1', '0x0303', ~tid, '0', $cipher_suites, '0', 
                                                   <'43', '0x0304'>, <'10', $g, $g2>, <'40', $g, $g^~x>, 
                                                   <'45', '0', '1'>, <'42', '0'>, '41', 
                                                   <~ticket, mask(ticket_age_add, $ticket_age)>, '0'>)
                                               >)
                                         >, 
                                         '2', '0x0303', p_ns, $cipher_suite, <'13', $sig_algs>, 
                                         <'40', $g, p_gy>, <'41', '0'>, '42', '0'>, 
                                        '8', $exts>, 
                                       '20', 
                                       hmac(<
                                             Expand(Expand(Extract(p_gxy,
                                                                   Extract(Expand(ms, <'rms', h(messages)>,
                                                                                  '32'),
                                                                           '0')),
                                                           <'serverhts', 
                                                            h(<
                                                               <
                                                                <'0', '1', '0x0303', ~tid, '0', 
                                                                 $cipher_suites, '0', <'43', '0x0304'>, 
                                                                 <'10', $g, $g2>, <'40', $g, $g^~x>, 
                                                                 <'45', '0', '1'>, <'42', '0'>, '41', 
                                                                 <~ticket, mask(ticket_age_add, $ticket_age)
                                                                 >, 
                                                                 hmac(<
                                                                       Expand(Expand(Extract(Expand(ms,
                                                                                                    <'rms', 
                                                                                                     h(messages)
                                                                                                    >,
                                                                                                    '32'),
                                                                                             '0'),
                                                                                     <'res', 'pbk'>, '32'),
                                                                              <'0', '0'>, '32'), 
                                                                       h(<'0', '1', '0x0303', ~tid, '0', 
                                                                          $cipher_suites, '0', 
                                                                          <'43', '0x0304'>, <'10', $g, $g2>, 
                                                                          <'40', $g, $g^~x>, 
                                                                          <'45', '0', '1'>, <'42', '0'>, 
                                                                          '41', 
                                                                          <~ticket, 
                                                                           mask(ticket_age_add, $ticket_age)
                                                                          >, 
                                                                          '0'>)
                                                                      >)
                                                                >, 
                                                                '2', '0x0303', p_ns, $cipher_suite, 
                                                                <'13', $sig_algs>, <'40', $g, p_gy>, 
                                                                <'41', '0'>, '42', '0'>, 
                                                               '8', $exts>)
                                                           >,
                                                           '32'),
                                                    <'fin', '0'>, '32'), 
                                             h(<
                                                <
                                                 <'0', '1', '0x0303', ~tid, '0', $cipher_suites, '0', 
                                                  <'43', '0x0304'>, <'10', $g, $g2>, <'40', $g, $g^~x>, 
                                                  <'45', '0', '1'>, <'42', '0'>, '41', 
                                                  <~ticket, mask(ticket_age_add, $ticket_age)>, 
                                                  hmac(<
                                                        Expand(Expand(Extract(Expand(ms, <'rms', h(messages)>,
                                                                                     '32'),
                                                                              '0'),
                                                                      <'res', 'pbk'>, '32'),
                                                               <'0', '0'>, '32'), 
                                                        h(<'0', '1', '0x0303', ~tid, '0', $cipher_suites, 
                                                           '0', <'43', '0x0304'>, <'10', $g, $g2>, 
                                                           <'40', $g, $g^~x>, <'45', '0', '1'>, <'42', '0'>, 
                                                           '41', 
                                                           <~ticket, mask(ticket_age_add, $ticket_age)>, '0'>)
                                                       >)
                                                 >, 
                                                 '2', '0x0303', p_ns, $cipher_suite, <'13', $sig_algs>, 
                                                 <'40', $g, p_gy>, <'41', '0'>, '42', '0'>, 
                                                '8', $exts>)
                                            >)
                                      >)
                                   >,
                                   '32')
                 ) @ #l)
               ∧
                #l < #j.1)) )
        case case_1
        solve( (∃ #r. (RevLtk( $S ) @ #r) ∧ #r < #vr)  ∥
               (∃ tid3 x #r. (RevDHExp( tid3, $S, x ) @ #r) ∧ #r < #vr)  ∥
               (∃ tid4 y #r. (RevDHExp( tid4, $C, y ) @ #r) ∧ #r < #vr)  ∥
               (∃ rms #r. (RevealPSK( $C, rms ) @ #r) ∧ #r < #k.1)  ∥
               (∃ rms #r. (RevealPSK( $S, rms ) @ #r) ∧ #r < #k.1) )
          case case_1
          by contradiction /* from formulas */
        next
          case case_2
          by contradiction /* from formulas */
        next
          case case_3
          by contradiction /* from formulas */
        next
          case case_4
          solve( (∃ #r. (RevLtk( $S ) @ #r) ∧ #r < #vr)  ∥
                 (∃ tid3 x #r. (RevDHExp( tid3, $S, x ) @ #r) ∧ #r < #vr)  ∥
                 (∃ tid4 y #r. (RevDHExp( tid4, $C, y ) @ #r) ∧ #r < #vr)  ∥
                 (∃ rms #r. (RevealPSK( $C, rms ) @ #r) ∧ #r < #vr)  ∥
                 (∃ rms #r. (RevealPSK( $S, rms ) @ #r) ∧ #r < #vr) )
            case case_1
            by contradiction /* from formulas */
          next
            case case_2
            by contradiction /* from formulas */
          next
            case case_3
            by contradiction /* from formulas */
          next
            case case_4
            by contradiction /* from formulas */
          next
            case case_5
            by contradiction /* from formulas */
          qed
        next
          case case_5
          solve( (∃ #r. (RevLtk( $S ) @ #r) ∧ #r < #vr)  ∥
                 (∃ tid3 x #r. (RevDHExp( tid3, $S, x ) @ #r) ∧ #r < #vr)  ∥
                 (∃ tid4 y #r. (RevDHExp( tid4, $C, y ) @ #r) ∧ #r < #vr)  ∥
                 (∃ rms #r. (RevealPSK( $C, rms ) @ #r) ∧ #r < #vr)  ∥
                 (∃ rms #r. (RevealPSK( $S, rms ) @ #r) ∧ #r < #vr) )
            case case_1
            by contradiction /* from formulas */
          next
            case case_2
            by contradiction /* from formulas */
          next
            case case_3
            by contradiction /* from formulas */
          next
            case case_4
            by contradiction /* from formulas */
          next
            case case_5
            by contradiction /* from formulas */
          qed
        qed
      next
        case case_2
        by solve( SecretPSK( $A,
                             Expand(Extract('0',
                                            Extract(p_gxy,
                                                    Extract(Expand(ms, <'rms', h(messages)>, '32'), '0'))),
                                    <'serverats', 
                                     h(<
                                        <
                                         <
                                          <'0', '1', '0x0303', ~tid, '0', $cipher_suites, '0', 
                                           <'43', '0x0304'>, <'10', $g, $g2>, <'40', $g, $g^~x>, 
                                           <'45', '0', '1'>, <'42', '0'>, '41', 
                                           <~ticket, mask(ticket_age_add, $ticket_age)>, 
                                           hmac(<
                                                 Expand(Expand(Extract(Expand(ms, <'rms', h(messages)>, '32'),
                                                                       '0'),
                                                               <'res', 'pbk'>, '32'),
                                                        <'0', '0'>, '32'), 
                                                 h(<'0', '1', '0x0303', ~tid, '0', $cipher_suites, '0', 
                                                    <'43', '0x0304'>, <'10', $g, $g2>, <'40', $g, $g^~x>, 
                                                    <'45', '0', '1'>, <'42', '0'>, '41', 
                                                    <~ticket, mask(ticket_age_add, $ticket_age)>, '0'>)
                                                >)
                                          >, 
                                          '2', '0x0303', p_ns, $cipher_suite, <'13', $sig_algs>, 
                                          <'40', $g, p_gy>, <'41', '0'>, '42', '0'>, 
                                         '8', $exts>, 
                                        '20', 
                                        hmac(<
                                              Expand(Expand(Extract(p_gxy,
                                                                    Extract(Expand(ms, <'rms', h(messages)>,
                                                                                   '32'),
                                                                            '0')),
                                                            <'serverhts', 
                                                             h(<
                                                                <
                                                                 <'0', '1', '0x0303', ~tid, '0', 
                                                                  $cipher_suites, '0', <'43', '0x0304'>, 
                                                                  <'10', $g, $g2>, <'40', $g, $g^~x>, 
                                                                  <'45', '0', '1'>, <'42', '0'>, '41', 
                                                                  <~ticket, mask(ticket_age_add, $ticket_age)
                                                                  >, 
                                                                  hmac(<
                                                                        Expand(Expand(Extract(Expand(ms,
                                                                                                     <'rms', 
                                                                                                      h(messages)
                                                                                                     >,
                                                                                                     '32'),
                                                                                              '0'),
                                                                                      <'res', 'pbk'>, '32'),
                                                                               <'0', '0'>, '32'), 
                                                                        h(<'0', '1', '0x0303', ~tid, '0', 
                                                                           $cipher_suites, '0', 
                                                                           <'43', '0x0304'>, <'10', $g, $g2>, 
                                                                           <'40', $g, $g^~x>, 
                                                                           <'45', '0', '1'>, <'42', '0'>, 
                                                                           '41', 
                                                                           <~ticket, 
                                                                            mask(ticket_age_add, $ticket_age)
                                                                           >, 
                                                                           '0'>)
                                                                       >)
                                                                 >, 
                                                                 '2', '0x0303', p_ns, $cipher_suite, 
                                                                 <'13', $sig_algs>, <'40', $g, p_gy>, 
                                                                 <'41', '0'>, '42', '0'>, 
                                                                '8', $exts>)
                                                            >,
                                                            '32'),
                                                     <'fin', '0'>, '32'), 
                                              h(<
                                                 <
                                                  <'0', '1', '0x0303', ~tid, '0', $cipher_suites, '0', 
                                                   <'43', '0x0304'>, <'10', $g, $g2>, <'40', $g, $g^~x>, 
                                                   <'45', '0', '1'>, <'42', '0'>, '41', 
                                                   <~ticket, mask(ticket_age_add, $ticket_age)>, 
                                                   hmac(<
                                                         Expand(Expand(Extract(Expand(ms,
                                                                                      <'rms', h(messages)>,
                                                                                      '32'),
                                                                               '0'),
                                                                       <'res', 'pbk'>, '32'),
                                                                <'0', '0'>, '32'), 
                                                         h(<'0', '1', '0x0303', ~tid, '0', $cipher_suites, 
                                                            '0', <'43', '0x0304'>, <'10', $g, $g2>, 
                                                            <'40', $g, $g^~x>, <'45', '0', '1'>, <'42', '0'>, 
                                                            '41', 
                                                            <~ticket, mask(ticket_age_add, $ticket_age)>, '0'
                                                           >)
                                                        >)
                                                  >, 
                                                  '2', '0x0303', p_ns, $cipher_suite, <'13', $sig_algs>, 
                                                  <'40', $g, p_gy>, <'41', '0'>, '42', '0'>, 
                                                 '8', $exts>)
                                             >)
                                       >)
                                    >,
                                    '32')
                  ) ▶₀ #l )
      qed
    next
      case recv_server_auth_psk_case_2
      solve( (∃ #j.2.
               (!KU( Extract('0',
                             Extract(p_gxy, Extract(Expand(ms, <'rms', h(messages)>, '32'), '0')))
                ) @ #j.2)
              ∧
               #j.2 < #j.1)  ∥
             ((∀ #k.
                (!KU( Extract('0',
                              Extract(p_gxy, Extract(Expand(ms, <'rms', h(messages)>, '32'), '0')))
                 ) @ #k)
               ⇒
                ¬(#k < #j.1)) ∧
              (∃ actor #l.
                (RevealPSK( actor,
                            Expand(Extract('0',
                                           Extract(p_gxy,
                                                   Extract(Expand(ms, <'rms', h(messages)>, '32'), '0'))),
                                   <'serverats', 
                                    h(<
                                       <
                                        <
                                         <
                                          <
                                           <'0', '1', '0x0303', ~tid, '0', $cipher_suites, '0', 
                                            <'43', '0x0304'>, <'10', $g1, $g>, <'40', $g1, $g1^~x>, 
                                            <'45', '0', '1'>, <'42', '0'>, '41', 
                                            <~ticket, mask(ticket_age_add, $ticket_age)>, 
                                            hmac(<
                                                  Expand(Expand(Extract(Expand(ms, <'rms', h(messages)>,
                                                                               '32'),
                                                                        '0'),
                                                                <'res', 'pbk'>, '32'),
                                                         <'0', '0'>, '32'), 
                                                  h(<'0', '1', '0x0303', ~tid, '0', $cipher_suites, '0', 
                                                     <'43', '0x0304'>, <'10', $g1, $g>, <'40', $g1, $g1^~x>, 
                                                     <'45', '0', '1'>, <'42', '0'>, '41', 
                                                     <~ticket, mask(ticket_age_add, $ticket_age)>, '0'>)
                                                 >)
                                           >, 
                                           '6', '0x0303', '40', $g>, 
                                          '1', '0x0303', ~new_nc, '0', $cipher_suites.1, '0', 
                                          <'43', '0x0304'>, <'10', $g1, $g>, <'40', $g, $g^~x.1>, 
                                          <'45', '0', '1'>, '0', '41', <~ticket, mask(ticket_age_add, '1')>, 
                                          hmac(<
                                                Expand(Expand(Extract(Expand(ms, <'rms', h(messages)>, '32'),
                                                                      '0'),
                                                              <'res', 'pbk'>, '32'),
                                                       <'0', '0'>, '32'), 
                                                h(<
                                                   <
                                                    <'0', '1', '0x0303', ~tid, '0', $cipher_suites, '0', 
                                                     <'43', '0x0304'>, <'10', $g1, $g>, <'40', $g1, $g1^~x>, 
                                                     <'45', '0', '1'>, <'42', '0'>, '41', 
                                                     <~ticket, mask(ticket_age_add, $ticket_age)>, 
                                                     hmac(<
                                                           Expand(Expand(Extract(Expand(ms,
                                                                                        <'rms', h(messages)>,
                                                                                        '32'),
                                                                                 '0'),
                                                                         <'res', 'pbk'>, '32'),
                                                                  <'0', '0'>, '32'), 
                                                           h(<'0', '1', '0x0303', ~tid, '0', $cipher_suites, 
                                                              '0', <'43', '0x0304'>, <'10', $g1, $g>, 
                                                              <'40', $g1, $g1^~x>, <'45', '0', '1'>, 
                                                              <'42', '0'>, '41', 
                                                              <~ticket, mask(ticket_age_add, $ticket_age)>, 
                                                              '0'>)
                                                          >)
                                                    >, 
                                                    '6', '0x0303', '40', $g>, 
                                                   '1', '0x0303', ~new_nc, '0', $cipher_suites.1, '0', 
                                                   <'43', '0x0304'>, <'10', $g1, $g>, <'40', $g, $g^~x.1>, 
                                                   <'45', '0', '1'>, '0', '41', 
                                                   <~ticket, mask(ticket_age_add, '1')>, '0'>)
                                               >)
                                         >, 
                                         '2', '0x0303', p_ns, $cipher_suite, <'13', $sig_algs>, 
                                         <'40', $g, p_gy>, <'41', '0'>, '0'>, 
                                        '8', $exts>, 
                                       '20', 
                                       hmac(<
                                             Expand(Expand(Extract(p_gxy,
                                                                   Extract(Expand(ms, <'rms', h(messages)>,
                                                                                  '32'),
                                                                           '0')),
                                                           <'serverhts', 
                                                            h(<
                                                               <
                                                                <
                                                                 <
                                                                  <'0', '1', '0x0303', ~tid, '0', 
                                                                   $cipher_suites, '0', <'43', '0x0304'>, 
                                                                   <'10', $g1, $g>, <'40', $g1, $g1^~x>, 
                                                                   <'45', '0', '1'>, <'42', '0'>, '41', 
                                                                   <~ticket, mask(ticket_age_add, $ticket_age)
                                                                   >, 
                                                                   hmac(<
                                                                         Expand(Expand(Extract(Expand(ms,
                                                                                                      <'rms', 
                                                                                                       h(messages)
                                                                                                      >,
                                                                                                      '32'),
                                                                                               '0'),
                                                                                       <'res', 'pbk'>, '32'),
                                                                                <'0', '0'>, '32'), 
                                                                         h(<'0', '1', '0x0303', ~tid, '0', 
                                                                            $cipher_suites, '0', 
                                                                            <'43', '0x0304'>, 
                                                                            <'10', $g1, $g>, 
                                                                            <'40', $g1, $g1^~x>, 
                                                                            <'45', '0', '1'>, <'42', '0'>, 
                                                                            '41', 
                                                                            <~ticket, 
                                                                             mask(ticket_age_add, $ticket_age)
                                                                            >, 
                                                                            '0'>)
                                                                        >)
                                                                  >, 
                                                                  '6', '0x0303', '40', $g>, 
                                                                 '1', '0x0303', ~new_nc, '0', 
                                                                 $cipher_suites.1, '0', <'43', '0x0304'>, 
                                                                 <'10', $g1, $g>, <'40', $g, $g^~x.1>, 
                                                                 <'45', '0', '1'>, '0', '41', 
                                                                 <~ticket, mask(ticket_age_add, '1')>, 
                                                                 hmac(<
                                                                       Expand(Expand(Extract(Expand(ms,
                                                                                                    <'rms', 
                                                                                                     h(messages)
                                                                                                    >,
                                                                                                    '32'),
                                                                                             '0'),
                                                                                     <'res', 'pbk'>, '32'),
                                                                              <'0', '0'>, '32'), 
                                                                       h(<
                                                                          <
                                                                           <'0', '1', '0x0303', ~tid, '0', 
                                                                            $cipher_suites, '0', 
                                                                            <'43', '0x0304'>, 
                                                                            <'10', $g1, $g>, 
                                                                            <'40', $g1, $g1^~x>, 
                                                                            <'45', '0', '1'>, <'42', '0'>, 
                                                                            '41', 
                                                                            <~ticket, 
                                                                             mask(ticket_age_add, $ticket_age)
                                                                            >, 
                                                                            hmac(<
                                                                                  Expand(Expand(Extract(Expand(ms,
                                                                                                               <
                                                                                                                'rms', 
                                                                                                                h(messages)
                                                                                                               >,
                                                                                                               '32'),
                                                                                                        '0'),
                                                                                                <'res', 'pbk'
                                                                                                >,
                                                                                                '32'),
                                                                                         <'0', '0'>, '32'), 
                                                                                  h(<'0', '1', '0x0303', 
                                                                                     ~tid, '0', 
                                                                                     $cipher_suites, '0', 
                                                                                     <'43', '0x0304'>, 
                                                                                     <'10', $g1, $g>, 
                                                                                     <'40', $g1, $g1^~x>, 
                                                                                     <'45', '0', '1'>, 
                                                                                     <'42', '0'>, '41', 
                                                                                     <~ticket, 
                                                                                      mask(ticket_age_add,
                                                                                           $ticket_age)
                                                                                     >, 
                                                                                     '0'>)
                                                                                 >)
                                                                           >, 
                                                                           '6', '0x0303', '40', $g>, 
                                                                          '1', '0x0303', ~new_nc, '0', 
                                                                          $cipher_suites.1, '0', 
                                                                          <'43', '0x0304'>, <'10', $g1, $g>, 
                                                                          <'40', $g, $g^~x.1>, 
                                                                          <'45', '0', '1'>, '0', '41', 
                                                                          <~ticket, mask(ticket_age_add, '1')
                                                                          >, 
                                                                          '0'>)
                                                                      >)
                                                                >, 
                                                                '2', '0x0303', p_ns, $cipher_suite, 
                                                                <'13', $sig_algs>, <'40', $g, p_gy>, 
                                                                <'41', '0'>, '0'>, 
                                                               '8', $exts>)
                                                           >,
                                                           '32'),
                                                    <'fin', '0'>, '32'), 
                                             h(<
                                                <
                                                 <
                                                  <
                                                   <'0', '1', '0x0303', ~tid, '0', $cipher_suites, '0', 
                                                    <'43', '0x0304'>, <'10', $g1, $g>, <'40', $g1, $g1^~x>, 
                                                    <'45', '0', '1'>, <'42', '0'>, '41', 
                                                    <~ticket, mask(ticket_age_add, $ticket_age)>, 
                                                    hmac(<
                                                          Expand(Expand(Extract(Expand(ms,
                                                                                       <'rms', h(messages)>,
                                                                                       '32'),
                                                                                '0'),
                                                                        <'res', 'pbk'>, '32'),
                                                                 <'0', '0'>, '32'), 
                                                          h(<'0', '1', '0x0303', ~tid, '0', $cipher_suites, 
                                                             '0', <'43', '0x0304'>, <'10', $g1, $g>, 
                                                             <'40', $g1, $g1^~x>, <'45', '0', '1'>, 
                                                             <'42', '0'>, '41', 
                                                             <~ticket, mask(ticket_age_add, $ticket_age)>, '0'
                                                            >)
                                                         >)
                                                   >, 
                                                   '6', '0x0303', '40', $g>, 
                                                  '1', '0x0303', ~new_nc, '0', $cipher_suites.1, '0', 
                                                  <'43', '0x0304'>, <'10', $g1, $g>, <'40', $g, $g^~x.1>, 
                                                  <'45', '0', '1'>, '0', '41', 
                                                  <~ticket, mask(ticket_age_add, '1')>, 
                                                  hmac(<
                                                        Expand(Expand(Extract(Expand(ms, <'rms', h(messages)>,
                                                                                     '32'),
                                                                              '0'),
                                                                      <'res', 'pbk'>, '32'),
                                                               <'0', '0'>, '32'), 
                                                        h(<
                                                           <
                                                            <'0', '1', '0x0303', ~tid, '0', $cipher_suites, 
                                                             '0', <'43', '0x0304'>, <'10', $g1, $g>, 
                                                             <'40', $g1, $g1^~x>, <'45', '0', '1'>, 
                                                             <'42', '0'>, '41', 
                                                             <~ticket, mask(ticket_age_add, $ticket_age)>, 
                                                             hmac(<
                                                                   Expand(Expand(Extract(Expand(ms,
                                                                                                <'rms', 
                                                                                                 h(messages)>,
                                                                                                '32'),
                                                                                         '0'),
                                                                                 <'res', 'pbk'>, '32'),
                                                                          <'0', '0'>, '32'), 
                                                                   h(<'0', '1', '0x0303', ~tid, '0', 
                                                                      $cipher_suites, '0', <'43', '0x0304'>, 
                                                                      <'10', $g1, $g>, <'40', $g1, $g1^~x>, 
                                                                      <'45', '0', '1'>, <'42', '0'>, '41', 
                                                                      <~ticket, 
                                                                       mask(ticket_age_add, $ticket_age)>, 
                                                                      '0'>)
                                                                  >)
                                                            >, 
                                                            '6', '0x0303', '40', $g>, 
                                                           '1', '0x0303', ~new_nc, '0', $cipher_suites.1, 
                                                           '0', <'43', '0x0304'>, <'10', $g1, $g>, 
                                                           <'40', $g, $g^~x.1>, <'45', '0', '1'>, '0', '41', 
                                                           <~ticket, mask(ticket_age_add, '1')>, '0'>)
                                                       >)
                                                 >, 
                                                 '2', '0x0303', p_ns, $cipher_suite, <'13', $sig_algs>, 
                                                 <'40', $g, p_gy>, <'41', '0'>, '0'>, 
                                                '8', $exts>)
                                            >)
                                      >)
                                   >,
                                   '32')
                 ) @ #l)
               ∧
                #l < #j.1)) )
        case case_1
        solve( (∃ #r. (RevLtk( $S ) @ #r) ∧ #r < #vr)  ∥
               (∃ tid3 x #r. (RevDHExp( tid3, $S, x ) @ #r) ∧ #r < #vr)  ∥
               (∃ tid4 y #r. (RevDHExp( tid4, $C, y ) @ #r) ∧ #r < #vr)  ∥
               (∃ rms #r. (RevealPSK( $C, rms ) @ #r) ∧ #r < #k.1)  ∥
               (∃ rms #r. (RevealPSK( $S, rms ) @ #r) ∧ #r < #k.1) )
          case case_1
          by contradiction /* from formulas */
        next
          case case_2
          by contradiction /* from formulas */
        next
          case case_3
          by contradiction /* from formulas */
        next
          case case_4
          solve( (∃ #r. (RevLtk( $S ) @ #r) ∧ #r < #vr)  ∥
                 (∃ tid3 x #r. (RevDHExp( tid3, $S, x ) @ #r) ∧ #r < #vr)  ∥
                 (∃ tid4 y #r. (RevDHExp( tid4, $C, y ) @ #r) ∧ #r < #vr)  ∥
                 (∃ rms #r. (RevealPSK( $C, rms ) @ #r) ∧ #r < #vr)  ∥
                 (∃ rms #r. (RevealPSK( $S, rms ) @ #r) ∧ #r < #vr) )
            case case_1
            by contradiction /* from formulas */
          next
            case case_2
            by contradiction /* from formulas */
          next
            case case_3
            by contradiction /* from formulas */
          next
            case case_4
            by contradiction /* from formulas */
          next
            case case_5
            by contradiction /* from formulas */
          qed
        next
          case case_5
          solve( (∃ #r. (RevLtk( $S ) @ #r) ∧ #r < #vr)  ∥
                 (∃ tid3 x #r. (RevDHExp( tid3, $S, x ) @ #r) ∧ #r < #vr)  ∥
                 (∃ tid4 y #r. (RevDHExp( tid4, $C, y ) @ #r) ∧ #r < #vr)  ∥
                 (∃ rms #r. (RevealPSK( $C, rms ) @ #r) ∧ #r < #vr)  ∥
                 (∃ rms #r. (RevealPSK( $S, rms ) @ #r) ∧ #r < #vr) )
            case case_1
            by contradiction /* from formulas */
          next
            case case_2
            by contradiction /* from formulas */
          next
            case case_3
            by contradiction /* from formulas */
          next
            case case_4
            by contradiction /* from formulas */
          next
            case case_5
            by contradiction /* from formulas */
          qed
        qed
      next
        case case_2
        by solve( SecretPSK( $A,
                             Expand(Extract('0',
                                            Extract(p_gxy,
                                                    Extract(Expand(ms, <'rms', h(messages)>, '32'), '0'))),
                                    <'serverats', 
                                     h(<
                                        <
                                         <
                                          <
                                           <
                                            <'0', '1', '0x0303', ~tid, '0', $cipher_suites, '0', 
                                             <'43', '0x0304'>, <'10', $g1, $g>, <'40', $g1, $g1^~x>, 
                                             <'45', '0', '1'>, <'42', '0'>, '41', 
                                             <~ticket, mask(ticket_age_add, $ticket_age)>, 
                                             hmac(<
                                                   Expand(Expand(Extract(Expand(ms, <'rms', h(messages)>,
                                                                                '32'),
                                                                         '0'),
                                                                 <'res', 'pbk'>, '32'),
                                                          <'0', '0'>, '32'), 
                                                   h(<'0', '1', '0x0303', ~tid, '0', $cipher_suites, '0', 
                                                      <'43', '0x0304'>, <'10', $g1, $g>, <'40', $g1, $g1^~x>, 
                                                      <'45', '0', '1'>, <'42', '0'>, '41', 
                                                      <~ticket, mask(ticket_age_add, $ticket_age)>, '0'>)
                                                  >)
                                            >, 
                                            '6', '0x0303', '40', $g>, 
                                           '1', '0x0303', ~new_nc, '0', $cipher_suites.1, '0', 
                                           <'43', '0x0304'>, <'10', $g1, $g>, <'40', $g, $g^~x.1>, 
                                           <'45', '0', '1'>, '0', '41', <~ticket, mask(ticket_age_add, '1')>, 
                                           hmac(<
                                                 Expand(Expand(Extract(Expand(ms, <'rms', h(messages)>, '32'),
                                                                       '0'),
                                                               <'res', 'pbk'>, '32'),
                                                        <'0', '0'>, '32'), 
                                                 h(<
                                                    <
                                                     <'0', '1', '0x0303', ~tid, '0', $cipher_suites, '0', 
                                                      <'43', '0x0304'>, <'10', $g1, $g>, <'40', $g1, $g1^~x>, 
                                                      <'45', '0', '1'>, <'42', '0'>, '41', 
                                                      <~ticket, mask(ticket_age_add, $ticket_age)>, 
                                                      hmac(<
                                                            Expand(Expand(Extract(Expand(ms,
                                                                                         <'rms', h(messages)>,
                                                                                         '32'),
                                                                                  '0'),
                                                                          <'res', 'pbk'>, '32'),
                                                                   <'0', '0'>, '32'), 
                                                            h(<'0', '1', '0x0303', ~tid, '0', $cipher_suites, 
                                                               '0', <'43', '0x0304'>, <'10', $g1, $g>, 
                                                               <'40', $g1, $g1^~x>, <'45', '0', '1'>, 
                                                               <'42', '0'>, '41', 
                                                               <~ticket, mask(ticket_age_add, $ticket_age)>, 
                                                               '0'>)
                                                           >)
                                                     >, 
                                                     '6', '0x0303', '40', $g>, 
                                                    '1', '0x0303', ~new_nc, '0', $cipher_suites.1, '0', 
                                                    <'43', '0x0304'>, <'10', $g1, $g>, <'40', $g, $g^~x.1>, 
                                                    <'45', '0', '1'>, '0', '41', 
                                                    <~ticket, mask(ticket_age_add, '1')>, '0'>)
                                                >)
                                          >, 
                                          '2', '0x0303', p_ns, $cipher_suite, <'13', $sig_algs>, 
                                          <'40', $g, p_gy>, <'41', '0'>, '0'>, 
                                         '8', $exts>, 
                                        '20', 
                                        hmac(<
                                              Expand(Expand(Extract(p_gxy,
                                                                    Extract(Expand(ms, <'rms', h(messages)>,
                                                                                   '32'),
                                                                            '0')),
                                                            <'serverhts', 
                                                             h(<
                                                                <
                                                                 <
                                                                  <
                                                                   <'0', '1', '0x0303', ~tid, '0', 
                                                                    $cipher_suites, '0', <'43', '0x0304'>, 
                                                                    <'10', $g1, $g>, <'40', $g1, $g1^~x>, 
                                                                    <'45', '0', '1'>, <'42', '0'>, '41', 
                                                                    <~ticket, 
                                                                     mask(ticket_age_add, $ticket_age)>, 
                                                                    hmac(<
                                                                          Expand(Expand(Extract(Expand(ms,
                                                                                                       <
                                                                                                        'rms', 
                                                                                                        h(messages)
                                                                                                       >,
                                                                                                       '32'),
                                                                                                '0'),
                                                                                        <'res', 'pbk'>, '32'),
                                                                                 <'0', '0'>, '32'), 
                                                                          h(<'0', '1', '0x0303', ~tid, '0', 
                                                                             $cipher_suites, '0', 
                                                                             <'43', '0x0304'>, 
                                                                             <'10', $g1, $g>, 
                                                                             <'40', $g1, $g1^~x>, 
                                                                             <'45', '0', '1'>, <'42', '0'>, 
                                                                             '41', 
                                                                             <~ticket, 
                                                                              mask(ticket_age_add,
                                                                                   $ticket_age)
                                                                             >, 
                                                                             '0'>)
                                                                         >)
                                                                   >, 
                                                                   '6', '0x0303', '40', $g>, 
                                                                  '1', '0x0303', ~new_nc, '0', 
                                                                  $cipher_suites.1, '0', <'43', '0x0304'>, 
                                                                  <'10', $g1, $g>, <'40', $g, $g^~x.1>, 
                                                                  <'45', '0', '1'>, '0', '41', 
                                                                  <~ticket, mask(ticket_age_add, '1')>, 
                                                                  hmac(<
                                                                        Expand(Expand(Extract(Expand(ms,
                                                                                                     <'rms', 
                                                                                                      h(messages)
                                                                                                     >,
                                                                                                     '32'),
                                                                                              '0'),
                                                                                      <'res', 'pbk'>, '32'),
                                                                               <'0', '0'>, '32'), 
                                                                        h(<
                                                                           <
                                                                            <'0', '1', '0x0303', ~tid, '0', 
                                                                             $cipher_suites, '0', 
                                                                             <'43', '0x0304'>, 
                                                                             <'10', $g1, $g>, 
                                                                             <'40', $g1, $g1^~x>, 
                                                                             <'45', '0', '1'>, <'42', '0'>, 
                                                                             '41', 
                                                                             <~ticket, 
                                                                              mask(ticket_age_add,
                                                                                   $ticket_age)
                                                                             >, 
                                                                             hmac(<
                                                                                   Expand(Expand(Extract(Expand(ms,
                                                                                                                <
                                                                                                                 'rms', 
                                                                                                                 h(messages)
                                                                                                                >,
                                                                                                                '32'),
                                                                                                         '0'),
                                                                                                 <'res', 'pbk'
                                                                                                 >,
                                                                                                 '32'),
                                                                                          <'0', '0'>, '32'), 
                                                                                   h(<'0', '1', '0x0303', 
                                                                                      ~tid, '0', 
                                                                                      $cipher_suites, '0', 
                                                                                      <'43', '0x0304'>, 
                                                                                      <'10', $g1, $g>, 
                                                                                      <'40', $g1, $g1^~x>, 
                                                                                      <'45', '0', '1'>, 
                                                                                      <'42', '0'>, '41', 
                                                                                      <~ticket, 
                                                                                       mask(ticket_age_add,
                                                                                            $ticket_age)
                                                                                      >, 
                                                                                      '0'>)
                                                                                  >)
                                                                            >, 
                                                                            '6', '0x0303', '40', $g>, 
                                                                           '1', '0x0303', ~new_nc, '0', 
                                                                           $cipher_suites.1, '0', 
                                                                           <'43', '0x0304'>, <'10', $g1, $g>, 
                                                                           <'40', $g, $g^~x.1>, 
                                                                           <'45', '0', '1'>, '0', '41', 
                                                                           <~ticket, mask(ticket_age_add, '1')
                                                                           >, 
                                                                           '0'>)
                                                                       >)
                                                                 >, 
                                                                 '2', '0x0303', p_ns, $cipher_suite, 
                                                                 <'13', $sig_algs>, <'40', $g, p_gy>, 
                                                                 <'41', '0'>, '0'>, 
                                                                '8', $exts>)
                                                            >,
                                                            '32'),
                                                     <'fin', '0'>, '32'), 
                                              h(<
                                                 <
                                                  <
                                                   <
                                                    <'0', '1', '0x0303', ~tid, '0', $cipher_suites, '0', 
                                                     <'43', '0x0304'>, <'10', $g1, $g>, <'40', $g1, $g1^~x>, 
                                                     <'45', '0', '1'>, <'42', '0'>, '41', 
                                                     <~ticket, mask(ticket_age_add, $ticket_age)>, 
                                                     hmac(<
                                                           Expand(Expand(Extract(Expand(ms,
                                                                                        <'rms', h(messages)>,
                                                                                        '32'),
                                                                                 '0'),
                                                                         <'res', 'pbk'>, '32'),
                                                                  <'0', '0'>, '32'), 
                                                           h(<'0', '1', '0x0303', ~tid, '0', $cipher_suites, 
                                                              '0', <'43', '0x0304'>, <'10', $g1, $g>, 
                                                              <'40', $g1, $g1^~x>, <'45', '0', '1'>, 
                                                              <'42', '0'>, '41', 
                                                              <~ticket, mask(ticket_age_add, $ticket_age)>, 
                                                              '0'>)
                                                          >)
                                                    >, 
                                                    '6', '0x0303', '40', $g>, 
                                                   '1', '0x0303', ~new_nc, '0', $cipher_suites.1, '0', 
                                                   <'43', '0x0304'>, <'10', $g1, $g>, <'40', $g, $g^~x.1>, 
                                                   <'45', '0', '1'>, '0', '41', 
                                                   <~ticket, mask(ticket_age_add, '1')>, 
                                                   hmac(<
                                                         Expand(Expand(Extract(Expand(ms,
                                                                                      <'rms', h(messages)>,
                                                                                      '32'),
                                                                               '0'),
                                                                       <'res', 'pbk'>, '32'),
                                                                <'0', '0'>, '32'), 
                                                         h(<
                                                            <
                                                             <'0', '1', '0x0303', ~tid, '0', $cipher_suites, 
                                                              '0', <'43', '0x0304'>, <'10', $g1, $g>, 
                                                              <'40', $g1, $g1^~x>, <'45', '0', '1'>, 
                                                              <'42', '0'>, '41', 
                                                              <~ticket, mask(ticket_age_add, $ticket_age)>, 
                                                              hmac(<
                                                                    Expand(Expand(Extract(Expand(ms,
                                                                                                 <'rms', 
                                                                                                  h(messages)
                                                                                                 >,
                                                                                                 '32'),
                                                                                          '0'),
                                                                                  <'res', 'pbk'>, '32'),
                                                                           <'0', '0'>, '32'), 
                                                                    h(<'0', '1', '0x0303', ~tid, '0', 
                                                                       $cipher_suites, '0', <'43', '0x0304'>, 
                                                                       <'10', $g1, $g>, <'40', $g1, $g1^~x>, 
                                                                       <'45', '0', '1'>, <'42', '0'>, '41', 
                                                                       <~ticket, 
                                                                        mask(ticket_age_add, $ticket_age)>, 
                                                                       '0'>)
                                                                   >)
                                                             >, 
                                                             '6', '0x0303', '40', $g>, 
                                                            '1', '0x0303', ~new_nc, '0', $cipher_suites.1, 
                                                            '0', <'43', '0x0304'>, <'10', $g1, $g>, 
                                                            <'40', $g, $g^~x.1>, <'45', '0', '1'>, '0', '41', 
                                                            <~ticket, mask(ticket_age_add, '1')>, '0'>)
                                                        >)
                                                  >, 
                                                  '2', '0x0303', p_ns, $cipher_suite, <'13', $sig_algs>, 
                                                  <'40', $g, p_gy>, <'41', '0'>, '0'>, 
                                                 '8', $exts>)
                                             >)
                                       >)
                                    >,
                                    '32')
                  ) ▶₀ #l )
      qed
    next
      case recv_server_auth_psk_case_3
      by contradiction /* from formulas */
    next
      case recv_server_auth_psk_case_4
      by contradiction /* from formulas */
    next
      case recv_server_auth_psk_case_5
      solve( (∃ #j.2.
               (!KU( Extract('0',
                             Extract('0', Extract(Expand(ms, <'rms', h(messages)>, '32'), '0')))
                ) @ #j.2)
              ∧
               #j.2 < #j.1)  ∥
             ((∀ #k.
                (!KU( Extract('0',
                              Extract('0', Extract(Expand(ms, <'rms', h(messages)>, '32'), '0')))
                 ) @ #k)
               ⇒
                ¬(#k < #j.1)) ∧
              (∃ actor #l.
                (RevealPSK( actor,
                            Expand(Extract('0',
                                           Extract('0',
                                                   Extract(Expand(ms, <'rms', h(messages)>, '32'), '0'))),
                                   <'serverats', 
                                    h(<
                                       <
                                        <
                                         <'0', '1', '0x0303', ~tid, '0', $cipher_suites, '0', 
                                          <'43', '0x0304'>, <'10', $g1, $g2>, <'40', $g1, $g1^~x>, 
                                          <'45', '0', '1'>, <'42', '0'>, '41', 
                                          <p_psk_id, mask(ticket_age_add, $ticket_age)>, 
                                          hmac(<
                                                Expand(Expand(Extract(Expand(ms, <'rms', h(messages)>, '32'),
                                                                      '0'),
                                                              <'res', 'pbk'>, '32'),
                                                       <'0', '0'>, '32'), 
                                                h(<'0', '1', '0x0303', ~tid, '0', $cipher_suites, '0', 
                                                   <'43', '0x0304'>, <'10', $g1, $g2>, <'40', $g1, $g1^~x>, 
                                                   <'45', '0', '1'>, <'42', '0'>, '41', 
                                                   <p_psk_id, mask(ticket_age_add, $ticket_age)>, '0'>)
                                               >)
                                         >, 
                                         '2', '0x0303', p_ns, $cipher_suite, <'13', $sig_algs>, <'41', '0'>, 
                                         '42', '0'>, 
                                        '8', $exts>, 
                                       '20', 
                                       hmac(<
                                             Expand(Expand(Extract('0',
                                                                   Extract(Expand(ms, <'rms', h(messages)>,
                                                                                  '32'),
                                                                           '0')),
                                                           <'serverhts', 
                                                            h(<
                                                               <
                                                                <'0', '1', '0x0303', ~tid, '0', 
                                                                 $cipher_suites, '0', <'43', '0x0304'>, 
                                                                 <'10', $g1, $g2>, <'40', $g1, $g1^~x>, 
                                                                 <'45', '0', '1'>, <'42', '0'>, '41', 
                                                                 <p_psk_id, mask(ticket_age_add, $ticket_age)
                                                                 >, 
                                                                 hmac(<
                                                                       Expand(Expand(Extract(Expand(ms,
                                                                                                    <'rms', 
                                                                                                     h(messages)
                                                                                                    >,
                                                                                                    '32'),
                                                                                             '0'),
                                                                                     <'res', 'pbk'>, '32'),
                                                                              <'0', '0'>, '32'), 
                                                                       h(<'0', '1', '0x0303', ~tid, '0', 
                                                                          $cipher_suites, '0', 
                                                                          <'43', '0x0304'>, <'10', $g1, $g2>, 
                                                                          <'40', $g1, $g1^~x>, 
                                                                          <'45', '0', '1'>, <'42', '0'>, 
                                                                          '41', 
                                                                          <p_psk_id, 
                                                                           mask(ticket_age_add, $ticket_age)
                                                                          >, 
                                                                          '0'>)
                                                                      >)
                                                                >, 
                                                                '2', '0x0303', p_ns, $cipher_suite, 
                                                                <'13', $sig_algs>, <'41', '0'>, '42', '0'>, 
                                                               '8', $exts>)
                                                           >,
                                                           '32'),
                                                    <'fin', '0'>, '32'), 
                                             h(<
                                                <
                                                 <'0', '1', '0x0303', ~tid, '0', $cipher_suites, '0', 
                                                  <'43', '0x0304'>, <'10', $g1, $g2>, <'40', $g1, $g1^~x>, 
                                                  <'45', '0', '1'>, <'42', '0'>, '41', 
                                                  <p_psk_id, mask(ticket_age_add, $ticket_age)>, 
                                                  hmac(<
                                                        Expand(Expand(Extract(Expand(ms, <'rms', h(messages)>,
                                                                                     '32'),
                                                                              '0'),
                                                                      <'res', 'pbk'>, '32'),
                                                               <'0', '0'>, '32'), 
                                                        h(<'0', '1', '0x0303', ~tid, '0', $cipher_suites, 
                                                           '0', <'43', '0x0304'>, <'10', $g1, $g2>, 
                                                           <'40', $g1, $g1^~x>, <'45', '0', '1'>, 
                                                           <'42', '0'>, '41', 
                                                           <p_psk_id, mask(ticket_age_add, $ticket_age)>, '0'
                                                          >)
                                                       >)
                                                 >, 
                                                 '2', '0x0303', p_ns, $cipher_suite, <'13', $sig_algs>, 
                                                 <'41', '0'>, '42', '0'>, 
                                                '8', $exts>)
                                            >)
                                      >)
                                   >,
                                   '32')
                 ) @ #l)
               ∧
                #l < #j.1)) )
        case case_1
        solve( (∃ #r. (RevLtk( $S ) @ #r) ∧ #r < #vr)  ∥
               (∃ tid3 x #r. (RevDHExp( tid3, $S, x ) @ #r) ∧ #r < #vr)  ∥
               (∃ tid4 y #r. (RevDHExp( tid4, $C, y ) @ #r) ∧ #r < #vr)  ∥
               (∃ rms #r. (RevealPSK( $C, rms ) @ #r) ∧ #r < #k)  ∥
               (∃ rms #r. (RevealPSK( $S, rms ) @ #r) ∧ #r < #k) )
          case case_1
          by contradiction /* from formulas */
        next
          case case_2
          by contradiction /* from formulas */
        next
          case case_3
          by contradiction /* from formulas */
        next
          case case_4
          solve( (∃ #j.4. (!KU( ms ) @ #j.4) ∧ #j.4 < #j.3)  ∥
                 ((∀ #k. (!KU( ms ) @ #k) ⇒ ¬(#k < #j.3)) ∧
                  (∃ actor #l.
                    (RevealPSK( actor, Expand(ms, <'rms', h(messages)>, '32') ) @ #l)
                   ∧
                    #l < #j.3)) )
            case case_1
            solve( SecretPSK( $C, rms ) ▶₀ #r )
              case new_session_ticket
              solve( RMode( ~tid, $C, role, psk_ke_mode ) @ #i )
                case client_auth
                by contradiction /* from formulas */
              qed
            next
              case out_of_band_psk_case_1
              solve( RMode( ~tid, $C, role, psk_ke_mode ) @ #i )
                case client_auth
                by contradiction /* from formulas */
              qed
            next
              case out_of_band_psk_case_2
              solve( RMode( ~tid, $C, role, psk_ke_mode ) @ #i )
                case client_auth
                by contradiction /* from formulas */
              qed
            next
              case recv_new_session_ticket
              solve( RMode( ~tid, $C, role, psk_ke_mode ) @ #i )
                case client_auth
                by contradiction /* from formulas */
              qed
            qed
          next
            case case_2
            solve( SecretPSK( $C, rms ) ▶₀ #r )
              case new_session_ticket
              solve( SecretPSK( $A, Expand(ms, <'rms', h(messages)>, '32') ) ▶₀ #l )
                case new_session_ticket
                solve( RMode( ~tid, $C, role, psk_ke_mode ) @ #i )
                  case client_auth
                  by contradiction /* from formulas */
                qed
              next
                case recv_new_session_ticket
                solve( RMode( ~tid, $C, role, psk_ke_mode ) @ #i )
                  case client_auth
                  by contradiction /* from formulas */
                qed
              qed
            next
              case out_of_band_psk_case_1
              solve( SecretPSK( $A, Expand(ms, <'rms', h(messages)>, '32') ) ▶₀ #l )
                case new_session_ticket
                solve( RMode( ~tid, $C, role, psk_ke_mode ) @ #i )
                  case client_auth
                  by contradiction /* from formulas */
                qed
              next
                case recv_new_session_ticket
                solve( RMode( ~tid, $C, role, psk_ke_mode ) @ #i )
                  case client_auth
                  by contradiction /* from formulas */
                qed
              qed
            next
              case out_of_band_psk_case_2
              solve( SecretPSK( $A, Expand(ms, <'rms', h(messages)>, '32') ) ▶₀ #l )
                case new_session_ticket
                solve( RMode( ~tid, $C, role, psk_ke_mode ) @ #i )
                  case client_auth
                  by contradiction /* from formulas */
                qed
              next
                case recv_new_session_ticket
                solve( RMode( ~tid, $C, role, psk_ke_mode ) @ #i )
                  case client_auth
                  by contradiction /* from formulas */
                qed
              qed
            next
              case recv_new_session_ticket
              solve( SecretPSK( $A, Expand(ms, <'rms', h(messages)>, '32') ) ▶₀ #l )
                case new_session_ticket
                solve( RMode( ~tid, $C, role, psk_ke_mode ) @ #i )
                  case client_auth
                  by contradiction /* from formulas */
                qed
              next
                case recv_new_session_ticket
                solve( RMode( ~tid, $C, role, psk_ke_mode ) @ #i )
                  case client_auth
                  by contradiction /* from formulas */
                qed
              qed
            qed
          qed
        next
          case case_5
          solve( (∃ #j.4. (!KU( ms ) @ #j.4) ∧ #j.4 < #j.3)  ∥
                 ((∀ #k. (!KU( ms ) @ #k) ⇒ ¬(#k < #j.3)) ∧
                  (∃ actor #l.
                    (RevealPSK( actor, Expand(ms, <'rms', h(messages)>, '32') ) @ #l)
                   ∧
                    #l < #j.3)) )
            case case_1
            solve( SecretPSK( $S, rms ) ▶₀ #r )
              case new_session_ticket
              solve( RMode( ~tid, $C, role, psk_ke_mode ) @ #i )
                case client_auth
                by contradiction /* from formulas */
              qed
            next
              case out_of_band_psk_case_1
              solve( RMode( ~tid, $C, role, psk_ke_mode ) @ #i )
                case client_auth
                by contradiction /* from formulas */
              qed
            next
              case out_of_band_psk_case_2
              solve( RMode( ~tid, $C, role, psk_ke_mode ) @ #i )
                case client_auth
                by contradiction /* from formulas */
              qed
            next
              case recv_new_session_ticket
              solve( RMode( ~tid, $C, role, psk_ke_mode ) @ #i )
                case client_auth
                by contradiction /* from formulas */
              qed
            qed
          next
            case case_2
            solve( SecretPSK( $S, rms ) ▶₀ #r )
              case new_session_ticket
              solve( SecretPSK( $A, Expand(ms, <'rms', h(messages)>, '32') ) ▶₀ #l )
                case new_session_ticket
                solve( RMode( ~tid, $C, role, psk_ke_mode ) @ #i )
                  case client_auth
                  by contradiction /* from formulas */
                qed
              next
                case recv_new_session_ticket
                solve( RMode( ~tid, $C, role, psk_ke_mode ) @ #i )
                  case client_auth
                  by contradiction /* from formulas */
                qed
              qed
            next
              case out_of_band_psk_case_1
              solve( SecretPSK( $A, Expand(ms, <'rms', h(messages)>, '32') ) ▶₀ #l )
                case new_session_ticket
                solve( RMode( ~tid, $C, role, psk_ke_mode ) @ #i )
                  case client_auth
                  by contradiction /* from formulas */
                qed
              next
                case recv_new_session_ticket
                solve( RMode( ~tid, $C, role, psk_ke_mode ) @ #i )
                  case client_auth
                  by contradiction /* from formulas */
                qed
              qed
            next
              case out_of_band_psk_case_2
              solve( SecretPSK( $A, Expand(ms, <'rms', h(messages)>, '32') ) ▶₀ #l )
                case new_session_ticket
                solve( RMode( ~tid, $C, role, psk_ke_mode ) @ #i )
                  case client_auth
                  by contradiction /* from formulas */
                qed
              next
                case recv_new_session_ticket
                solve( RMode( ~tid, $C, role, psk_ke_mode ) @ #i )
                  case client_auth
                  by contradiction /* from formulas */
                qed
              qed
            next
              case recv_new_session_ticket
              solve( SecretPSK( $A, Expand(ms, <'rms', h(messages)>, '32') ) ▶₀ #l )
                case new_session_ticket
                solve( RMode( ~tid, $C, role, psk_ke_mode ) @ #i )
                  case client_auth
                  by contradiction /* from formulas */
                qed
              next
                case recv_new_session_ticket
                solve( RMode( ~tid, $C, role, psk_ke_mode ) @ #i )
                  case client_auth
                  by contradiction /* from formulas */
                qed
              qed
            qed
          qed
        qed
      next
        case case_2
        by solve( SecretPSK( $A,
                             Expand(Extract('0',
                                            Extract('0',
                                                    Extract(Expand(ms, <'rms', h(messages)>, '32'), '0'))),
                                    <'serverats', 
                                     h(<
                                        <
                                         <
                                          <'0', '1', '0x0303', ~tid, '0', $cipher_suites, '0', 
                                           <'43', '0x0304'>, <'10', $g1, $g2>, <'40', $g1, $g1^~x>, 
                                           <'45', '0', '1'>, <'42', '0'>, '41', 
                                           <p_psk_id, mask(ticket_age_add, $ticket_age)>, 
                                           hmac(<
                                                 Expand(Expand(Extract(Expand(ms, <'rms', h(messages)>, '32'),
                                                                       '0'),
                                                               <'res', 'pbk'>, '32'),
                                                        <'0', '0'>, '32'), 
                                                 h(<'0', '1', '0x0303', ~tid, '0', $cipher_suites, '0', 
                                                    <'43', '0x0304'>, <'10', $g1, $g2>, <'40', $g1, $g1^~x>, 
                                                    <'45', '0', '1'>, <'42', '0'>, '41', 
                                                    <p_psk_id, mask(ticket_age_add, $ticket_age)>, '0'>)
                                                >)
                                          >, 
                                          '2', '0x0303', p_ns, $cipher_suite, <'13', $sig_algs>, <'41', '0'>, 
                                          '42', '0'>, 
                                         '8', $exts>, 
                                        '20', 
                                        hmac(<
                                              Expand(Expand(Extract('0',
                                                                    Extract(Expand(ms, <'rms', h(messages)>,
                                                                                   '32'),
                                                                            '0')),
                                                            <'serverhts', 
                                                             h(<
                                                                <
                                                                 <'0', '1', '0x0303', ~tid, '0', 
                                                                  $cipher_suites, '0', <'43', '0x0304'>, 
                                                                  <'10', $g1, $g2>, <'40', $g1, $g1^~x>, 
                                                                  <'45', '0', '1'>, <'42', '0'>, '41', 
                                                                  <p_psk_id, mask(ticket_age_add, $ticket_age)
                                                                  >, 
                                                                  hmac(<
                                                                        Expand(Expand(Extract(Expand(ms,
                                                                                                     <'rms', 
                                                                                                      h(messages)
                                                                                                     >,
                                                                                                     '32'),
                                                                                              '0'),
                                                                                      <'res', 'pbk'>, '32'),
                                                                               <'0', '0'>, '32'), 
                                                                        h(<'0', '1', '0x0303', ~tid, '0', 
                                                                           $cipher_suites, '0', 
                                                                           <'43', '0x0304'>, 
                                                                           <'10', $g1, $g2>, 
                                                                           <'40', $g1, $g1^~x>, 
                                                                           <'45', '0', '1'>, <'42', '0'>, 
                                                                           '41', 
                                                                           <p_psk_id, 
                                                                            mask(ticket_age_add, $ticket_age)
                                                                           >, 
                                                                           '0'>)
                                                                       >)
                                                                 >, 
                                                                 '2', '0x0303', p_ns, $cipher_suite, 
                                                                 <'13', $sig_algs>, <'41', '0'>, '42', '0'>, 
                                                                '8', $exts>)
                                                            >,
                                                            '32'),
                                                     <'fin', '0'>, '32'), 
                                              h(<
                                                 <
                                                  <'0', '1', '0x0303', ~tid, '0', $cipher_suites, '0', 
                                                   <'43', '0x0304'>, <'10', $g1, $g2>, <'40', $g1, $g1^~x>, 
                                                   <'45', '0', '1'>, <'42', '0'>, '41', 
                                                   <p_psk_id, mask(ticket_age_add, $ticket_age)>, 
                                                   hmac(<
                                                         Expand(Expand(Extract(Expand(ms,
                                                                                      <'rms', h(messages)>,
                                                                                      '32'),
                                                                               '0'),
                                                                       <'res', 'pbk'>, '32'),
                                                                <'0', '0'>, '32'), 
                                                         h(<'0', '1', '0x0303', ~tid, '0', $cipher_suites, 
                                                            '0', <'43', '0x0304'>, <'10', $g1, $g2>, 
                                                            <'40', $g1, $g1^~x>, <'45', '0', '1'>, 
                                                            <'42', '0'>, '41', 
                                                            <p_psk_id, mask(ticket_age_add, $ticket_age)>, '0'
                                                           >)
                                                        >)
                                                  >, 
                                                  '2', '0x0303', p_ns, $cipher_suite, <'13', $sig_algs>, 
                                                  <'41', '0'>, '42', '0'>, 
                                                 '8', $exts>)
                                             >)
                                       >)
                                    >,
                                    '32')
                  ) ▶₀ #l )
      qed
    next
      case recv_server_auth_psk_case_6
      solve( (∃ #j.2.
               (!KU( Extract('0',
                             Extract('0', Extract(Expand(ms, <'rms', h(messages)>, '32'), '0')))
                ) @ #j.2)
              ∧
               #j.2 < #j.1)  ∥
             ((∀ #k.
                (!KU( Extract('0',
                              Extract('0', Extract(Expand(ms, <'rms', h(messages)>, '32'), '0')))
                 ) @ #k)
               ⇒
                ¬(#k < #j.1)) ∧
              (∃ actor #l.
                (RevealPSK( actor,
                            Expand(Extract('0',
                                           Extract('0',
                                                   Extract(Expand(ms, <'rms', h(messages)>, '32'), '0'))),
                                   <'serverats', 
                                    h(<
                                       <
                                        <
                                         <
                                          <
                                           <'0', '1', '0x0303', ~tid, '0', $cipher_suites, '0', 
                                            <'43', '0x0304'>, <'10', $g1, $g2>, <'40', $g1, $g1^~x>, 
                                            <'45', '0', '1'>, <'42', '0'>, '41', 
                                            <p_psk_id, mask(ticket_age_add, $ticket_age)>, 
                                            hmac(<
                                                  Expand(Expand(Extract(Expand(ms, <'rms', h(messages)>,
                                                                               '32'),
                                                                        '0'),
                                                                <'res', 'pbk'>, '32'),
                                                         <'0', '0'>, '32'), 
                                                  h(<'0', '1', '0x0303', ~tid, '0', $cipher_suites, '0', 
                                                     <'43', '0x0304'>, <'10', $g1, $g2>, <'40', $g1, $g1^~x>, 
                                                     <'45', '0', '1'>, <'42', '0'>, '41', 
                                                     <p_psk_id, mask(ticket_age_add, $ticket_age)>, '0'>)
                                                 >)
                                           >, 
                                           '6', '0x0303', '40', $g2>, 
                                          '1', '0x0303', ~new_nc, '0', $cipher_suites.1, '0', 
                                          <'43', '0x0304'>, <'10', $g1, $g2>, <'40', $g2, $g2^~new_x>, 
                                          <'45', '0', '1'>, '0', '41', <p_psk_id, mask(ticket_age_add, '1')>, 
                                          hmac(<
                                                Expand(Expand(Extract(Expand(ms, <'rms', h(messages)>, '32'),
                                                                      '0'),
                                                              <'res', 'pbk'>, '32'),
                                                       <'0', '0'>, '32'), 
                                                h(<
                                                   <
                                                    <'0', '1', '0x0303', ~tid, '0', $cipher_suites, '0', 
                                                     <'43', '0x0304'>, <'10', $g1, $g2>, <'40', $g1, $g1^~x>, 
                                                     <'45', '0', '1'>, <'42', '0'>, '41', 
                                                     <p_psk_id, mask(ticket_age_add, $ticket_age)>, 
                                                     hmac(<
                                                           Expand(Expand(Extract(Expand(ms,
                                                                                        <'rms', h(messages)>,
                                                                                        '32'),
                                                                                 '0'),
                                                                         <'res', 'pbk'>, '32'),
                                                                  <'0', '0'>, '32'), 
                                                           h(<'0', '1', '0x0303', ~tid, '0', $cipher_suites, 
                                                              '0', <'43', '0x0304'>, <'10', $g1, $g2>, 
                                                              <'40', $g1, $g1^~x>, <'45', '0', '1'>, 
                                                              <'42', '0'>, '41', 
                                                              <p_psk_id, mask(ticket_age_add, $ticket_age)>, 
                                                              '0'>)
                                                          >)
                                                    >, 
                                                    '6', '0x0303', '40', $g2>, 
                                                   '1', '0x0303', ~new_nc, '0', $cipher_suites.1, '0', 
                                                   <'43', '0x0304'>, <'10', $g1, $g2>, 
                                                   <'40', $g2, $g2^~new_x>, <'45', '0', '1'>, '0', '41', 
                                                   <p_psk_id, mask(ticket_age_add, '1')>, '0'>)
                                               >)
                                         >, 
                                         '2', '0x0303', p_ns, $cipher_suite, <'13', $sig_algs>, <'41', '0'>, 
                                         '0'>, 
                                        '8', $exts>, 
                                       '20', 
                                       hmac(<
                                             Expand(Expand(Extract('0',
                                                                   Extract(Expand(ms, <'rms', h(messages)>,
                                                                                  '32'),
                                                                           '0')),
                                                           <'serverhts', 
                                                            h(<
                                                               <
                                                                <
                                                                 <
                                                                  <'0', '1', '0x0303', ~tid, '0', 
                                                                   $cipher_suites, '0', <'43', '0x0304'>, 
                                                                   <'10', $g1, $g2>, <'40', $g1, $g1^~x>, 
                                                                   <'45', '0', '1'>, <'42', '0'>, '41', 
                                                                   <p_psk_id, 
                                                                    mask(ticket_age_add, $ticket_age)>, 
                                                                   hmac(<
                                                                         Expand(Expand(Extract(Expand(ms,
                                                                                                      <'rms', 
                                                                                                       h(messages)
                                                                                                      >,
                                                                                                      '32'),
                                                                                               '0'),
                                                                                       <'res', 'pbk'>, '32'),
                                                                                <'0', '0'>, '32'), 
                                                                         h(<'0', '1', '0x0303', ~tid, '0', 
                                                                            $cipher_suites, '0', 
                                                                            <'43', '0x0304'>, 
                                                                            <'10', $g1, $g2>, 
                                                                            <'40', $g1, $g1^~x>, 
                                                                            <'45', '0', '1'>, <'42', '0'>, 
                                                                            '41', 
                                                                            <p_psk_id, 
                                                                             mask(ticket_age_add, $ticket_age)
                                                                            >, 
                                                                            '0'>)
                                                                        >)
                                                                  >, 
                                                                  '6', '0x0303', '40', $g2>, 
                                                                 '1', '0x0303', ~new_nc, '0', 
                                                                 $cipher_suites.1, '0', <'43', '0x0304'>, 
                                                                 <'10', $g1, $g2>, <'40', $g2, $g2^~new_x>, 
                                                                 <'45', '0', '1'>, '0', '41', 
                                                                 <p_psk_id, mask(ticket_age_add, '1')>, 
                                                                 hmac(<
                                                                       Expand(Expand(Extract(Expand(ms,
                                                                                                    <'rms', 
                                                                                                     h(messages)
                                                                                                    >,
                                                                                                    '32'),
                                                                                             '0'),
                                                                                     <'res', 'pbk'>, '32'),
                                                                              <'0', '0'>, '32'), 
                                                                       h(<
                                                                          <
                                                                           <'0', '1', '0x0303', ~tid, '0', 
                                                                            $cipher_suites, '0', 
                                                                            <'43', '0x0304'>, 
                                                                            <'10', $g1, $g2>, 
                                                                            <'40', $g1, $g1^~x>, 
                                                                            <'45', '0', '1'>, <'42', '0'>, 
                                                                            '41', 
                                                                            <p_psk_id, 
                                                                             mask(ticket_age_add, $ticket_age)
                                                                            >, 
                                                                            hmac(<
                                                                                  Expand(Expand(Extract(Expand(ms,
                                                                                                               <
                                                                                                                'rms', 
                                                                                                                h(messages)
                                                                                                               >,
                                                                                                               '32'),
                                                                                                        '0'),
                                                                                                <'res', 'pbk'
                                                                                                >,
                                                                                                '32'),
                                                                                         <'0', '0'>, '32'), 
                                                                                  h(<'0', '1', '0x0303', 
                                                                                     ~tid, '0', 
                                                                                     $cipher_suites, '0', 
                                                                                     <'43', '0x0304'>, 
                                                                                     <'10', $g1, $g2>, 
                                                                                     <'40', $g1, $g1^~x>, 
                                                                                     <'45', '0', '1'>, 
                                                                                     <'42', '0'>, '41', 
                                                                                     <p_psk_id, 
                                                                                      mask(ticket_age_add,
                                                                                           $ticket_age)
                                                                                     >, 
                                                                                     '0'>)
                                                                                 >)
                                                                           >, 
                                                                           '6', '0x0303', '40', $g2>, 
                                                                          '1', '0x0303', ~new_nc, '0', 
                                                                          $cipher_suites.1, '0', 
                                                                          <'43', '0x0304'>, <'10', $g1, $g2>, 
                                                                          <'40', $g2, $g2^~new_x>, 
                                                                          <'45', '0', '1'>, '0', '41', 
                                                                          <p_psk_id, mask(ticket_age_add, '1')
                                                                          >, 
                                                                          '0'>)
                                                                      >)
                                                                >, 
                                                                '2', '0x0303', p_ns, $cipher_suite, 
                                                                <'13', $sig_algs>, <'41', '0'>, '0'>, 
                                                               '8', $exts>)
                                                           >,
                                                           '32'),
                                                    <'fin', '0'>, '32'), 
                                             h(<
                                                <
                                                 <
                                                  <
                                                   <'0', '1', '0x0303', ~tid, '0', $cipher_suites, '0', 
                                                    <'43', '0x0304'>, <'10', $g1, $g2>, <'40', $g1, $g1^~x>, 
                                                    <'45', '0', '1'>, <'42', '0'>, '41', 
                                                    <p_psk_id, mask(ticket_age_add, $ticket_age)>, 
                                                    hmac(<
                                                          Expand(Expand(Extract(Expand(ms,
                                                                                       <'rms', h(messages)>,
                                                                                       '32'),
                                                                                '0'),
                                                                        <'res', 'pbk'>, '32'),
                                                                 <'0', '0'>, '32'), 
                                                          h(<'0', '1', '0x0303', ~tid, '0', $cipher_suites, 
                                                             '0', <'43', '0x0304'>, <'10', $g1, $g2>, 
                                                             <'40', $g1, $g1^~x>, <'45', '0', '1'>, 
                                                             <'42', '0'>, '41', 
                                                             <p_psk_id, mask(ticket_age_add, $ticket_age)>, 
                                                             '0'>)
                                                         >)
                                                   >, 
                                                   '6', '0x0303', '40', $g2>, 
                                                  '1', '0x0303', ~new_nc, '0', $cipher_suites.1, '0', 
                                                  <'43', '0x0304'>, <'10', $g1, $g2>, 
                                                  <'40', $g2, $g2^~new_x>, <'45', '0', '1'>, '0', '41', 
                                                  <p_psk_id, mask(ticket_age_add, '1')>, 
                                                  hmac(<
                                                        Expand(Expand(Extract(Expand(ms, <'rms', h(messages)>,
                                                                                     '32'),
                                                                              '0'),
                                                                      <'res', 'pbk'>, '32'),
                                                               <'0', '0'>, '32'), 
                                                        h(<
                                                           <
                                                            <'0', '1', '0x0303', ~tid, '0', $cipher_suites, 
                                                             '0', <'43', '0x0304'>, <'10', $g1, $g2>, 
                                                             <'40', $g1, $g1^~x>, <'45', '0', '1'>, 
                                                             <'42', '0'>, '41', 
                                                             <p_psk_id, mask(ticket_age_add, $ticket_age)>, 
                                                             hmac(<
                                                                   Expand(Expand(Extract(Expand(ms,
                                                                                                <'rms', 
                                                                                                 h(messages)>,
                                                                                                '32'),
                                                                                         '0'),
                                                                                 <'res', 'pbk'>, '32'),
                                                                          <'0', '0'>, '32'), 
                                                                   h(<'0', '1', '0x0303', ~tid, '0', 
                                                                      $cipher_suites, '0', <'43', '0x0304'>, 
                                                                      <'10', $g1, $g2>, <'40', $g1, $g1^~x>, 
                                                                      <'45', '0', '1'>, <'42', '0'>, '41', 
                                                                      <p_psk_id, 
                                                                       mask(ticket_age_add, $ticket_age)>, 
                                                                      '0'>)
                                                                  >)
                                                            >, 
                                                            '6', '0x0303', '40', $g2>, 
                                                           '1', '0x0303', ~new_nc, '0', $cipher_suites.1, 
                                                           '0', <'43', '0x0304'>, <'10', $g1, $g2>, 
                                                           <'40', $g2, $g2^~new_x>, <'45', '0', '1'>, '0', 
                                                           '41', <p_psk_id, mask(ticket_age_add, '1')>, '0'>)
                                                       >)
                                                 >, 
                                                 '2', '0x0303', p_ns, $cipher_suite, <'13', $sig_algs>, 
                                                 <'41', '0'>, '0'>, 
                                                '8', $exts>)
                                            >)
                                      >)
                                   >,
                                   '32')
                 ) @ #l)
               ∧
                #l < #j.1)) )
        case case_1
        solve( (∃ #r. (RevLtk( $S ) @ #r) ∧ #r < #vr)  ∥
               (∃ tid3 x #r. (RevDHExp( tid3, $S, x ) @ #r) ∧ #r < #vr)  ∥
               (∃ tid4 y #r. (RevDHExp( tid4, $C, y ) @ #r) ∧ #r < #vr)  ∥
               (∃ rms #r. (RevealPSK( $C, rms ) @ #r) ∧ #r < #k)  ∥
               (∃ rms #r. (RevealPSK( $S, rms ) @ #r) ∧ #r < #k) )
          case case_1
          by contradiction /* from formulas */
        next
          case case_2
          by contradiction /* from formulas */
        next
          case case_3
          by contradiction /* from formulas */
        next
          case case_4
          solve( (∃ #j.4. (!KU( ms ) @ #j.4) ∧ #j.4 < #j.3)  ∥
                 ((∀ #k. (!KU( ms ) @ #k) ⇒ ¬(#k < #j.3)) ∧
                  (∃ actor #l.
                    (RevealPSK( actor, Expand(ms, <'rms', h(messages)>, '32') ) @ #l)
                   ∧
                    #l < #j.3)) )
            case case_1
            solve( SecretPSK( $C, rms ) ▶₀ #r )
              case new_session_ticket
              solve( RMode( ~tid, $C, role, psk_ke_mode ) @ #i )
                case client_auth
                by contradiction /* from formulas */
              qed
            next
              case out_of_band_psk_case_1
              solve( RMode( ~tid, $C, role, psk_ke_mode ) @ #i )
                case client_auth
                by contradiction /* from formulas */
              qed
            next
              case out_of_band_psk_case_2
              solve( RMode( ~tid, $C, role, psk_ke_mode ) @ #i )
                case client_auth
                by contradiction /* from formulas */
              qed
            next
              case recv_new_session_ticket
              solve( RMode( ~tid, $C, role, psk_ke_mode ) @ #i )
                case client_auth
                by contradiction /* from formulas */
              qed
            qed
          next
            case case_2
            solve( SecretPSK( $C, rms ) ▶₀ #r )
              case new_session_ticket
              solve( SecretPSK( $A, Expand(ms, <'rms', h(messages)>, '32') ) ▶₀ #l )
                case new_session_ticket
                solve( RMode( ~tid, $C, role, psk_ke_mode ) @ #i )
                  case client_auth
                  by contradiction /* from formulas */
                qed
              next
                case recv_new_session_ticket
                solve( RMode( ~tid, $C, role, psk_ke_mode ) @ #i )
                  case client_auth
                  by contradiction /* from formulas */
                qed
              qed
            next
              case out_of_band_psk_case_1
              solve( SecretPSK( $A, Expand(ms, <'rms', h(messages)>, '32') ) ▶₀ #l )
                case new_session_ticket
                solve( RMode( ~tid, $C, role, psk_ke_mode ) @ #i )
                  case client_auth
                  by contradiction /* from formulas */
                qed
              next
                case recv_new_session_ticket
                solve( RMode( ~tid, $C, role, psk_ke_mode ) @ #i )
                  case client_auth
                  by contradiction /* from formulas */
                qed
              qed
            next
              case out_of_band_psk_case_2
              solve( SecretPSK( $A, Expand(ms, <'rms', h(messages)>, '32') ) ▶₀ #l )
                case new_session_ticket
                solve( RMode( ~tid, $C, role, psk_ke_mode ) @ #i )
                  case client_auth
                  by contradiction /* from formulas */
                qed
              next
                case recv_new_session_ticket
                solve( RMode( ~tid, $C, role, psk_ke_mode ) @ #i )
                  case client_auth
                  by contradiction /* from formulas */
                qed
              qed
            next
              case recv_new_session_ticket
              solve( SecretPSK( $A, Expand(ms, <'rms', h(messages)>, '32') ) ▶₀ #l )
                case new_session_ticket
                solve( RMode( ~tid, $C, role, psk_ke_mode ) @ #i )
                  case client_auth
                  by contradiction /* from formulas */
                qed
              next
                case recv_new_session_ticket
                solve( RMode( ~tid, $C, role, psk_ke_mode ) @ #i )
                  case client_auth
                  by contradiction /* from formulas */
                qed
              qed
            qed
          qed
        next
          case case_5
          solve( (∃ #j.4. (!KU( ms ) @ #j.4) ∧ #j.4 < #j.3)  ∥
                 ((∀ #k. (!KU( ms ) @ #k) ⇒ ¬(#k < #j.3)) ∧
                  (∃ actor #l.
                    (RevealPSK( actor, Expand(ms, <'rms', h(messages)>, '32') ) @ #l)
                   ∧
                    #l < #j.3)) )
            case case_1
            solve( SecretPSK( $S, rms ) ▶₀ #r )
              case new_session_ticket
              solve( RMode( ~tid, $C, role, psk_ke_mode ) @ #i )
                case client_auth
                by contradiction /* from formulas */
              qed
            next
              case out_of_band_psk_case_1
              solve( RMode( ~tid, $C, role, psk_ke_mode ) @ #i )
                case client_auth
                by contradiction /* from formulas */
              qed
            next
              case out_of_band_psk_case_2
              solve( RMode( ~tid, $C, role, psk_ke_mode ) @ #i )
                case client_auth
                by contradiction /* from formulas */
              qed
            next
              case recv_new_session_ticket
              solve( RMode( ~tid, $C, role, psk_ke_mode ) @ #i )
                case client_auth
                by contradiction /* from formulas */
              qed
            qed
          next
            case case_2
            solve( SecretPSK( $S, rms ) ▶₀ #r )
              case new_session_ticket
              solve( SecretPSK( $A, Expand(ms, <'rms', h(messages)>, '32') ) ▶₀ #l )
                case new_session_ticket
                solve( RMode( ~tid, $C, role, psk_ke_mode ) @ #i )
                  case client_auth
                  by contradiction /* from formulas */
                qed
              next
                case recv_new_session_ticket
                solve( RMode( ~tid, $C, role, psk_ke_mode ) @ #i )
                  case client_auth
                  by contradiction /* from formulas */
                qed
              qed
            next
              case out_of_band_psk_case_1
              solve( SecretPSK( $A, Expand(ms, <'rms', h(messages)>, '32') ) ▶₀ #l )
                case new_session_ticket
                solve( RMode( ~tid, $C, role, psk_ke_mode ) @ #i )
                  case client_auth
                  by contradiction /* from formulas */
                qed
              next
                case recv_new_session_ticket
                solve( RMode( ~tid, $C, role, psk_ke_mode ) @ #i )
                  case client_auth
                  by contradiction /* from formulas */
                qed
              qed
            next
              case out_of_band_psk_case_2
              solve( SecretPSK( $A, Expand(ms, <'rms', h(messages)>, '32') ) ▶₀ #l )
                case new_session_ticket
                solve( RMode( ~tid, $C, role, psk_ke_mode ) @ #i )
                  case client_auth
                  by contradiction /* from formulas */
                qed
              next
                case recv_new_session_ticket
                solve( RMode( ~tid, $C, role, psk_ke_mode ) @ #i )
                  case client_auth
                  by contradiction /* from formulas */
                qed
              qed
            next
              case recv_new_session_ticket
              solve( SecretPSK( $A, Expand(ms, <'rms', h(messages)>, '32') ) ▶₀ #l )
                case new_session_ticket
                solve( RMode( ~tid, $C, role, psk_ke_mode ) @ #i )
                  case client_auth
                  by contradiction /* from formulas */
                qed
              next
                case recv_new_session_ticket
                solve( RMode( ~tid, $C, role, psk_ke_mode ) @ #i )
                  case client_auth
                  by contradiction /* from formulas */
                qed
              qed
            qed
          qed
        qed
      next
        case case_2
        by solve( SecretPSK( $A,
                             Expand(Extract('0',
                                            Extract('0',
                                                    Extract(Expand(ms, <'rms', h(messages)>, '32'), '0'))),
                                    <'serverats', 
                                     h(<
                                        <
                                         <
                                          <
                                           <
                                            <'0', '1', '0x0303', ~tid, '0', $cipher_suites, '0', 
                                             <'43', '0x0304'>, <'10', $g1, $g2>, <'40', $g1, $g1^~x>, 
                                             <'45', '0', '1'>, <'42', '0'>, '41', 
                                             <p_psk_id, mask(ticket_age_add, $ticket_age)>, 
                                             hmac(<
                                                   Expand(Expand(Extract(Expand(ms, <'rms', h(messages)>,
                                                                                '32'),
                                                                         '0'),
                                                                 <'res', 'pbk'>, '32'),
                                                          <'0', '0'>, '32'), 
                                                   h(<'0', '1', '0x0303', ~tid, '0', $cipher_suites, '0', 
                                                      <'43', '0x0304'>, <'10', $g1, $g2>, 
                                                      <'40', $g1, $g1^~x>, <'45', '0', '1'>, <'42', '0'>, 
                                                      '41', <p_psk_id, mask(ticket_age_add, $ticket_age)>, '0'
                                                     >)
                                                  >)
                                            >, 
                                            '6', '0x0303', '40', $g2>, 
                                           '1', '0x0303', ~new_nc, '0', $cipher_suites.1, '0', 
                                           <'43', '0x0304'>, <'10', $g1, $g2>, <'40', $g2, $g2^~new_x>, 
                                           <'45', '0', '1'>, '0', '41', 
                                           <p_psk_id, mask(ticket_age_add, '1')>, 
                                           hmac(<
                                                 Expand(Expand(Extract(Expand(ms, <'rms', h(messages)>, '32'),
                                                                       '0'),
                                                               <'res', 'pbk'>, '32'),
                                                        <'0', '0'>, '32'), 
                                                 h(<
                                                    <
                                                     <'0', '1', '0x0303', ~tid, '0', $cipher_suites, '0', 
                                                      <'43', '0x0304'>, <'10', $g1, $g2>, 
                                                      <'40', $g1, $g1^~x>, <'45', '0', '1'>, <'42', '0'>, 
                                                      '41', <p_psk_id, mask(ticket_age_add, $ticket_age)>, 
                                                      hmac(<
                                                            Expand(Expand(Extract(Expand(ms,
                                                                                         <'rms', h(messages)>,
                                                                                         '32'),
                                                                                  '0'),
                                                                          <'res', 'pbk'>, '32'),
                                                                   <'0', '0'>, '32'), 
                                                            h(<'0', '1', '0x0303', ~tid, '0', $cipher_suites, 
                                                               '0', <'43', '0x0304'>, <'10', $g1, $g2>, 
                                                               <'40', $g1, $g1^~x>, <'45', '0', '1'>, 
                                                               <'42', '0'>, '41', 
                                                               <p_psk_id, mask(ticket_age_add, $ticket_age)>, 
                                                               '0'>)
                                                           >)
                                                     >, 
                                                     '6', '0x0303', '40', $g2>, 
                                                    '1', '0x0303', ~new_nc, '0', $cipher_suites.1, '0', 
                                                    <'43', '0x0304'>, <'10', $g1, $g2>, 
                                                    <'40', $g2, $g2^~new_x>, <'45', '0', '1'>, '0', '41', 
                                                    <p_psk_id, mask(ticket_age_add, '1')>, '0'>)
                                                >)
                                          >, 
                                          '2', '0x0303', p_ns, $cipher_suite, <'13', $sig_algs>, <'41', '0'>, 
                                          '0'>, 
                                         '8', $exts>, 
                                        '20', 
                                        hmac(<
                                              Expand(Expand(Extract('0',
                                                                    Extract(Expand(ms, <'rms', h(messages)>,
                                                                                   '32'),
                                                                            '0')),
                                                            <'serverhts', 
                                                             h(<
                                                                <
                                                                 <
                                                                  <
                                                                   <'0', '1', '0x0303', ~tid, '0', 
                                                                    $cipher_suites, '0', <'43', '0x0304'>, 
                                                                    <'10', $g1, $g2>, <'40', $g1, $g1^~x>, 
                                                                    <'45', '0', '1'>, <'42', '0'>, '41', 
                                                                    <p_psk_id, 
                                                                     mask(ticket_age_add, $ticket_age)>, 
                                                                    hmac(<
                                                                          Expand(Expand(Extract(Expand(ms,
                                                                                                       <
                                                                                                        'rms', 
                                                                                                        h(messages)
                                                                                                       >,
                                                                                                       '32'),
                                                                                                '0'),
                                                                                        <'res', 'pbk'>, '32'),
                                                                                 <'0', '0'>, '32'), 
                                                                          h(<'0', '1', '0x0303', ~tid, '0', 
                                                                             $cipher_suites, '0', 
                                                                             <'43', '0x0304'>, 
                                                                             <'10', $g1, $g2>, 
                                                                             <'40', $g1, $g1^~x>, 
                                                                             <'45', '0', '1'>, <'42', '0'>, 
                                                                             '41', 
                                                                             <p_psk_id, 
                                                                              mask(ticket_age_add,
                                                                                   $ticket_age)
                                                                             >, 
                                                                             '0'>)
                                                                         >)
                                                                   >, 
                                                                   '6', '0x0303', '40', $g2>, 
                                                                  '1', '0x0303', ~new_nc, '0', 
                                                                  $cipher_suites.1, '0', <'43', '0x0304'>, 
                                                                  <'10', $g1, $g2>, <'40', $g2, $g2^~new_x>, 
                                                                  <'45', '0', '1'>, '0', '41', 
                                                                  <p_psk_id, mask(ticket_age_add, '1')>, 
                                                                  hmac(<
                                                                        Expand(Expand(Extract(Expand(ms,
                                                                                                     <'rms', 
                                                                                                      h(messages)
                                                                                                     >,
                                                                                                     '32'),
                                                                                              '0'),
                                                                                      <'res', 'pbk'>, '32'),
                                                                               <'0', '0'>, '32'), 
                                                                        h(<
                                                                           <
                                                                            <'0', '1', '0x0303', ~tid, '0', 
                                                                             $cipher_suites, '0', 
                                                                             <'43', '0x0304'>, 
                                                                             <'10', $g1, $g2>, 
                                                                             <'40', $g1, $g1^~x>, 
                                                                             <'45', '0', '1'>, <'42', '0'>, 
                                                                             '41', 
                                                                             <p_psk_id, 
                                                                              mask(ticket_age_add,
                                                                                   $ticket_age)
                                                                             >, 
                                                                             hmac(<
                                                                                   Expand(Expand(Extract(Expand(ms,
                                                                                                                <
                                                                                                                 'rms', 
                                                                                                                 h(messages)
                                                                                                                >,
                                                                                                                '32'),
                                                                                                         '0'),
                                                                                                 <'res', 'pbk'
                                                                                                 >,
                                                                                                 '32'),
                                                                                          <'0', '0'>, '32'), 
                                                                                   h(<'0', '1', '0x0303', 
                                                                                      ~tid, '0', 
                                                                                      $cipher_suites, '0', 
                                                                                      <'43', '0x0304'>, 
                                                                                      <'10', $g1, $g2>, 
                                                                                      <'40', $g1, $g1^~x>, 
                                                                                      <'45', '0', '1'>, 
                                                                                      <'42', '0'>, '41', 
                                                                                      <p_psk_id, 
                                                                                       mask(ticket_age_add,
                                                                                            $ticket_age)
                                                                                      >, 
                                                                                      '0'>)
                                                                                  >)
                                                                            >, 
                                                                            '6', '0x0303', '40', $g2>, 
                                                                           '1', '0x0303', ~new_nc, '0', 
                                                                           $cipher_suites.1, '0', 
                                                                           <'43', '0x0304'>, 
                                                                           <'10', $g1, $g2>, 
                                                                           <'40', $g2, $g2^~new_x>, 
                                                                           <'45', '0', '1'>, '0', '41', 
                                                                           <p_psk_id, 
                                                                            mask(ticket_age_add, '1')>, 
                                                                           '0'>)
                                                                       >)
                                                                 >, 
                                                                 '2', '0x0303', p_ns, $cipher_suite, 
                                                                 <'13', $sig_algs>, <'41', '0'>, '0'>, 
                                                                '8', $exts>)
                                                            >,
                                                            '32'),
                                                     <'fin', '0'>, '32'), 
                                              h(<
                                                 <
                                                  <
                                                   <
                                                    <'0', '1', '0x0303', ~tid, '0', $cipher_suites, '0', 
                                                     <'43', '0x0304'>, <'10', $g1, $g2>, <'40', $g1, $g1^~x>, 
                                                     <'45', '0', '1'>, <'42', '0'>, '41', 
                                                     <p_psk_id, mask(ticket_age_add, $ticket_age)>, 
                                                     hmac(<
                                                           Expand(Expand(Extract(Expand(ms,
                                                                                        <'rms', h(messages)>,
                                                                                        '32'),
                                                                                 '0'),
                                                                         <'res', 'pbk'>, '32'),
                                                                  <'0', '0'>, '32'), 
                                                           h(<'0', '1', '0x0303', ~tid, '0', $cipher_suites, 
                                                              '0', <'43', '0x0304'>, <'10', $g1, $g2>, 
                                                              <'40', $g1, $g1^~x>, <'45', '0', '1'>, 
                                                              <'42', '0'>, '41', 
                                                              <p_psk_id, mask(ticket_age_add, $ticket_age)>, 
                                                              '0'>)
                                                          >)
                                                    >, 
                                                    '6', '0x0303', '40', $g2>, 
                                                   '1', '0x0303', ~new_nc, '0', $cipher_suites.1, '0', 
                                                   <'43', '0x0304'>, <'10', $g1, $g2>, 
                                                   <'40', $g2, $g2^~new_x>, <'45', '0', '1'>, '0', '41', 
                                                   <p_psk_id, mask(ticket_age_add, '1')>, 
                                                   hmac(<
                                                         Expand(Expand(Extract(Expand(ms,
                                                                                      <'rms', h(messages)>,
                                                                                      '32'),
                                                                               '0'),
                                                                       <'res', 'pbk'>, '32'),
                                                                <'0', '0'>, '32'), 
                                                         h(<
                                                            <
                                                             <'0', '1', '0x0303', ~tid, '0', $cipher_suites, 
                                                              '0', <'43', '0x0304'>, <'10', $g1, $g2>, 
                                                              <'40', $g1, $g1^~x>, <'45', '0', '1'>, 
                                                              <'42', '0'>, '41', 
                                                              <p_psk_id, mask(ticket_age_add, $ticket_age)>, 
                                                              hmac(<
                                                                    Expand(Expand(Extract(Expand(ms,
                                                                                                 <'rms', 
                                                                                                  h(messages)
                                                                                                 >,
                                                                                                 '32'),
                                                                                          '0'),
                                                                                  <'res', 'pbk'>, '32'),
                                                                           <'0', '0'>, '32'), 
                                                                    h(<'0', '1', '0x0303', ~tid, '0', 
                                                                       $cipher_suites, '0', <'43', '0x0304'>, 
                                                                       <'10', $g1, $g2>, <'40', $g1, $g1^~x>, 
                                                                       <'45', '0', '1'>, <'42', '0'>, '41', 
                                                                       <p_psk_id, 
                                                                        mask(ticket_age_add, $ticket_age)>, 
                                                                       '0'>)
                                                                   >)
                                                             >, 
                                                             '6', '0x0303', '40', $g2>, 
                                                            '1', '0x0303', ~new_nc, '0', $cipher_suites.1, 
                                                            '0', <'43', '0x0304'>, <'10', $g1, $g2>, 
                                                            <'40', $g2, $g2^~new_x>, <'45', '0', '1'>, '0', 
                                                            '41', <p_psk_id, mask(ticket_age_add, '1')>, '0'>)
                                                        >)
                                                  >, 
                                                  '2', '0x0303', p_ns, $cipher_suite, <'13', $sig_algs>, 
                                                  <'41', '0'>, '0'>, 
                                                 '8', $exts>)
                                             >)
                                       >)
                                    >,
                                    '32')
                  ) ▶₀ #l )
      qed
    next
      case recv_server_auth_psk_case_7
      by contradiction /* from formulas */
    next
      case recv_server_auth_psk_case_8
      by contradiction /* from formulas */
    qed
  next
    case case_2
    solve( F_State_C3( ~tid, $C, $S, p_res_psk, p_messages, p_nc, p_ns, p_g,
                       p_sg, p_hrr, p_x, p_y, p_gx, p_gy, p_gxy, p_psk_ke_mode, p_psk_id, p_edi,
                       p_es, p_hs, Extract('0', p_hs), p_cats, p_sats, p_hs_keyc, p_hs_keys,
                       <pas, 'auth'>, p_ems, p_rms, '0'
           ) ▶₀ #i )
      case recv_server_auth_case_01
      by solve( SecretPSK( $A,
                           Expand(Expand(Extract('0', Extract(p_gxy, Extract('0', '0'))),
                                         <'serverats', 
                                          h(<
                                             <
                                              <
                                               <
                                                <
                                                 <'0', '1', '0x0303', ~tid, '0', $cipher_suites, '0', 
                                                  <'43', '0x0304'>, <'10', $g, $g2>, <'13', $sig_algs>, '40', 
                                                  $g, $g^~x>, 
                                                 '2', '0x0303', p_ns, $cipher_suite, <'13', $sig_algs.1>, 
                                                 '40', $g, p_gy>, 
                                                '8', $exts>, 
                                               '11', '0', pk(~ltkS)>, 
                                              '15', 
                                              sign(<'server_cv', 
                                                    h(<
                                                       <
                                                        <
                                                         <'0', '1', '0x0303', ~tid, '0', $cipher_suites, '0', 
                                                          <'43', '0x0304'>, <'10', $g, $g2>, 
                                                          <'13', $sig_algs>, '40', $g, $g^~x>, 
                                                         '2', '0x0303', p_ns, $cipher_suite, 
                                                         <'13', $sig_algs.1>, '40', $g, p_gy>, 
                                                        '8', $exts>, 
                                                       '11', '0', pk(~ltkS)>)
                                                   >,
                                                   ~ltkS)
                                             >, 
                                             '20', 
                                             hmac(<
                                                   Expand(Expand(Extract(p_gxy, Extract('0', '0')),
                                                                 <'serverhts', 
                                                                  h(<
                                                                     <
                                                                      <
                                                                       <
                                                                        <'0', '1', '0x0303', ~tid, '0', 
                                                                         $cipher_suites, '0', 
                                                                         <'43', '0x0304'>, <'10', $g, $g2>, 
                                                                         <'13', $sig_algs>, '40', $g, $g^~x>, 
                                                                        '2', '0x0303', p_ns, $cipher_suite, 
                                                                        <'13', $sig_algs.1>, '40', $g, p_gy>, 
                                                                       '8', $exts>, 
                                                                      '11', '0', pk(~ltkS)>, 
                                                                     '15', 
                                                                     sign(<'server_cv', 
                                                                           h(<
                                                                              <
                                                                               <
                                                                                <'0', '1', '0x0303', ~tid, 
                                                                                 '0', $cipher_suites, '0', 
                                                                                 <'43', '0x0304'>, 
                                                                                 <'10', $g, $g2>, 
                                                                                 <'13', $sig_algs>, '40', $g, 
                                                                                 $g^~x>, 
                                                                                '2', '0x0303', p_ns, 
                                                                                $cipher_suite, 
                                                                                <'13', $sig_algs.1>, '40', 
                                                                                $g, p_gy>, 
                                                                               '8', $exts>, 
                                                                              '11', '0', pk(~ltkS)>)
                                                                          >,
                                                                          ~ltkS)
                                                                    >)
                                                                 >,
                                                                 '32'),
                                                          <'fin', '0'>, '32'), 
                                                   h(<
                                                      <
                                                       <
                                                        <
                                                         <'0', '1', '0x0303', ~tid, '0', $cipher_suites, '0', 
                                                          <'43', '0x0304'>, <'10', $g, $g2>, 
                                                          <'13', $sig_algs>, '40', $g, $g^~x>, 
                                                         '2', '0x0303', p_ns, $cipher_suite, 
                                                         <'13', $sig_algs.1>, '40', $g, p_gy>, 
                                                        '8', $exts>, 
                                                       '11', '0', pk(~ltkS)>, 
                                                      '15', 
                                                      sign(<'server_cv', 
                                                            h(<
                                                               <
                                                                <
                                                                 <'0', '1', '0x0303', ~tid, '0', 
                                                                  $cipher_suites, '0', <'43', '0x0304'>, 
                                                                  <'10', $g, $g2>, <'13', $sig_algs>, '40', 
                                                                  $g, $g^~x>, 
                                                                 '2', '0x0303', p_ns, $cipher_suite, 
                                                                 <'13', $sig_algs.1>, '40', $g, p_gy>, 
                                                                '8', $exts>, 
                                                               '11', '0', pk(~ltkS)>)
                                                           >,
                                                           ~ltkS)
                                                     >)
                                                  >)
                                            >)
                                         >,
                                         '32'),
                                  <'adke_wk', '0'>, '32')
                ) ▶₀ #l )
    next
      case recv_server_auth_case_02
      by solve( SecretPSK( $A,
                           Expand(Expand(Extract('0', Extract(p_gxy, Extract('0', '0'))),
                                         <'serverats', 
                                          h(<
                                             <
                                              <
                                               <
                                                <
                                                 <
                                                  <
                                                   <'0', '1', '0x0303', ~tid, '0', $cipher_suites, '0', 
                                                    <'43', '0x0304'>, <'10', $g1, $g>, <'13', $sig_algs>, 
                                                    '40', $g1, $g1^~x>, 
                                                   '6', '0x0303', '40', $g>, 
                                                  '1', '0x0303', ~tid, '0', $cipher_suites.1, '0', 
                                                  <'43', '0x0304'>, <'10', $g1, $g>, <'13', $sig_algs.1>, 
                                                  '40', $g, $g^~x.1>, 
                                                 '2', '0x0303', p_ns, $cipher_suite, <'13', $sig_algs.2>, 
                                                 '40', $g, p_gy>, 
                                                '8', $exts>, 
                                               '11', '0', pk(~ltkS)>, 
                                              '15', 
                                              sign(<'server_cv', 
                                                    h(<
                                                       <
                                                        <
                                                         <
                                                          <
                                                           <'0', '1', '0x0303', ~tid, '0', $cipher_suites, 
                                                            '0', <'43', '0x0304'>, <'10', $g1, $g>, 
                                                            <'13', $sig_algs>, '40', $g1, $g1^~x>, 
                                                           '6', '0x0303', '40', $g>, 
                                                          '1', '0x0303', ~tid, '0', $cipher_suites.1, '0', 
                                                          <'43', '0x0304'>, <'10', $g1, $g>, 
                                                          <'13', $sig_algs.1>, '40', $g, $g^~x.1>, 
                                                         '2', '0x0303', p_ns, $cipher_suite, 
                                                         <'13', $sig_algs.2>, '40', $g, p_gy>, 
                                                        '8', $exts>, 
                                                       '11', '0', pk(~ltkS)>)
                                                   >,
                                                   ~ltkS)
                                             >, 
                                             '20', 
                                             hmac(<
                                                   Expand(Expand(Extract(p_gxy, Extract('0', '0')),
                                                                 <'serverhts', 
                                                                  h(<
                                                                     <
                                                                      <
                                                                       <
                                                                        <
                                                                         <
                                                                          <'0', '1', '0x0303', ~tid, '0', 
                                                                           $cipher_suites, '0', 
                                                                           <'43', '0x0304'>, <'10', $g1, $g>, 
                                                                           <'13', $sig_algs>, '40', $g1, 
                                                                           $g1^~x>, 
                                                                          '6', '0x0303', '40', $g>, 
                                                                         '1', '0x0303', ~tid, '0', 
                                                                         $cipher_suites.1, '0', 
                                                                         <'43', '0x0304'>, <'10', $g1, $g>, 
                                                                         <'13', $sig_algs.1>, '40', $g, 
                                                                         $g^~x.1>, 
                                                                        '2', '0x0303', p_ns, $cipher_suite, 
                                                                        <'13', $sig_algs.2>, '40', $g, p_gy>, 
                                                                       '8', $exts>, 
                                                                      '11', '0', pk(~ltkS)>, 
                                                                     '15', 
                                                                     sign(<'server_cv', 
                                                                           h(<
                                                                              <
                                                                               <
                                                                                <
                                                                                 <
                                                                                  <'0', '1', '0x0303', ~tid, 
                                                                                   '0', $cipher_suites, '0', 
                                                                                   <'43', '0x0304'>, 
                                                                                   <'10', $g1, $g>, 
                                                                                   <'13', $sig_algs>, '40', 
                                                                                   $g1, $g1^~x>, 
                                                                                  '6', '0x0303', '40', $g>, 
                                                                                 '1', '0x0303', ~tid, '0', 
                                                                                 $cipher_suites.1, '0', 
                                                                                 <'43', '0x0304'>, 
                                                                                 <'10', $g1, $g>, 
                                                                                 <'13', $sig_algs.1>, '40', 
                                                                                 $g, $g^~x.1>, 
                                                                                '2', '0x0303', p_ns, 
                                                                                $cipher_suite, 
                                                                                <'13', $sig_algs.2>, '40', 
                                                                                $g, p_gy>, 
                                                                               '8', $exts>, 
                                                                              '11', '0', pk(~ltkS)>)
                                                                          >,
                                                                          ~ltkS)
                                                                    >)
                                                                 >,
                                                                 '32'),
                                                          <'fin', '0'>, '32'), 
                                                   h(<
                                                      <
                                                       <
                                                        <
                                                         <
                                                          <
                                                           <'0', '1', '0x0303', ~tid, '0', $cipher_suites, 
                                                            '0', <'43', '0x0304'>, <'10', $g1, $g>, 
                                                            <'13', $sig_algs>, '40', $g1, $g1^~x>, 
                                                           '6', '0x0303', '40', $g>, 
                                                          '1', '0x0303', ~tid, '0', $cipher_suites.1, '0', 
                                                          <'43', '0x0304'>, <'10', $g1, $g>, 
                                                          <'13', $sig_algs.1>, '40', $g, $g^~x.1>, 
                                                         '2', '0x0303', p_ns, $cipher_suite, 
                                                         <'13', $sig_algs.2>, '40', $g, p_gy>, 
                                                        '8', $exts>, 
                                                       '11', '0', pk(~ltkS)>, 
                                                      '15', 
                                                      sign(<'server_cv', 
                                                            h(<
                                                               <
                                                                <
                                                                 <
                                                                  <
                                                                   <'0', '1', '0x0303', ~tid, '0', 
                                                                    $cipher_suites, '0', <'43', '0x0304'>, 
                                                                    <'10', $g1, $g>, <'13', $sig_algs>, '40', 
                                                                    $g1, $g1^~x>, 
                                                                   '6', '0x0303', '40', $g>, 
                                                                  '1', '0x0303', ~tid, '0', $cipher_suites.1, 
                                                                  '0', <'43', '0x0304'>, <'10', $g1, $g>, 
                                                                  <'13', $sig_algs.1>, '40', $g, $g^~x.1>, 
                                                                 '2', '0x0303', p_ns, $cipher_suite, 
                                                                 <'13', $sig_algs.2>, '40', $g, p_gy>, 
                                                                '8', $exts>, 
                                                               '11', '0', pk(~ltkS)>)
                                                           >,
                                                           ~ltkS)
                                                     >)
                                                  >)
                                            >)
                                         >,
                                         '32'),
                                  <'adke_wk', '0'>, '32')
                ) ▶₀ #l )
    next
      case recv_server_auth_case_03
      by solve( SecretPSK( $A,
                           Expand(Expand(Extract('0', Extract(p_gxy, Extract(~res_psk, '0'))),
                                         <'serverats', 
                                          h(<
                                             <
                                              <
                                               <
                                                <
                                                 <
                                                  <
                                                   <'0', '1', '0x0303', ~tid, '0', $cipher_suites, '0', 
                                                    <'43', '0x0304'>, <'10', $g1, $g>, <'40', $g1, $g1^~x>, 
                                                    <'45', '0', '1'>, <'42', '0'>, '41', 
                                                    <~ticket, mask(~ticket_age_add, $ticket_age)>, 
                                                    hmac(<
                                                          Expand(Expand(Extract(~res_psk, '0'),
                                                                        <'ext', 'pbk'>, '32'),
                                                                 <'0', '0'>, '32'), 
                                                          h(<'0', '1', '0x0303', ~tid, '0', $cipher_suites, 
                                                             '0', <'43', '0x0304'>, <'10', $g1, $g>, 
                                                             <'40', $g1, $g1^~x>, <'45', '0', '1'>, 
                                                             <'42', '0'>, '41', 
                                                             <~ticket, mask(~ticket_age_add, $ticket_age)>, 
                                                             '0'>)
                                                         >)
                                                   >, 
                                                   '6', '0x0303', '40', $g>, 
                                                  '1', '0x0303', ~tid, '0', $cipher_suites.1, '0', 
                                                  <'43', '0x0304'>, <'10', $g1, $g>, <'13', $sig_algs>, '40', 
                                                  $g, $g^~x.1>, 
                                                 '2', '0x0303', p_ns, $cipher_suite, <'13', $sig_algs.1>, 
                                                 '40', $g, p_gy>, 
                                                '8', $exts>, 
                                               '11', '0', pk(~ltkS)>, 
                                              '15', 
                                              sign(<'server_cv', 
                                                    h(<
                                                       <
                                                        <
                                                         <
                                                          <
                                                           <'0', '1', '0x0303', ~tid, '0', $cipher_suites, 
                                                            '0', <'43', '0x0304'>, <'10', $g1, $g>, 
                                                            <'40', $g1, $g1^~x>, <'45', '0', '1'>, 
                                                            <'42', '0'>, '41', 
                                                            <~ticket, mask(~ticket_age_add, $ticket_age)>, 
                                                            hmac(<
                                                                  Expand(Expand(Extract(~res_psk, '0'),
                                                                                <'ext', 'pbk'>, '32'),
                                                                         <'0', '0'>, '32'), 
                                                                  h(<'0', '1', '0x0303', ~tid, '0', 
                                                                     $cipher_suites, '0', <'43', '0x0304'>, 
                                                                     <'10', $g1, $g>, <'40', $g1, $g1^~x>, 
                                                                     <'45', '0', '1'>, <'42', '0'>, '41', 
                                                                     <~ticket, 
                                                                      mask(~ticket_age_add, $ticket_age)>, 
                                                                     '0'>)
                                                                 >)
                                                           >, 
                                                           '6', '0x0303', '40', $g>, 
                                                          '1', '0x0303', ~tid, '0', $cipher_suites.1, '0', 
                                                          <'43', '0x0304'>, <'10', $g1, $g>, 
                                                          <'13', $sig_algs>, '40', $g, $g^~x.1>, 
                                                         '2', '0x0303', p_ns, $cipher_suite, 
                                                         <'13', $sig_algs.1>, '40', $g, p_gy>, 
                                                        '8', $exts>, 
                                                       '11', '0', pk(~ltkS)>)
                                                   >,
                                                   ~ltkS)
                                             >, 
                                             '20', 
                                             hmac(<
                                                   Expand(Expand(Extract(p_gxy, Extract(~res_psk, '0')),
                                                                 <'serverhts', 
                                                                  h(<
                                                                     <
                                                                      <
                                                                       <
                                                                        <
                                                                         <
                                                                          <'0', '1', '0x0303', ~tid, '0', 
                                                                           $cipher_suites, '0', 
                                                                           <'43', '0x0304'>, <'10', $g1, $g>, 
                                                                           <'40', $g1, $g1^~x>, 
                                                                           <'45', '0', '1'>, <'42', '0'>, 
                                                                           '41', 
                                                                           <~ticket, 
                                                                            mask(~ticket_age_add, $ticket_age)
                                                                           >, 
                                                                           hmac(<
                                                                                 Expand(Expand(Extract(~res_psk,
                                                                                                       '0'),
                                                                                               <'ext', 'pbk'>,
                                                                                               '32'),
                                                                                        <'0', '0'>, '32'), 
                                                                                 h(<'0', '1', '0x0303', ~tid, 
                                                                                    '0', $cipher_suites, '0', 
                                                                                    <'43', '0x0304'>, 
                                                                                    <'10', $g1, $g>, 
                                                                                    <'40', $g1, $g1^~x>, 
                                                                                    <'45', '0', '1'>, 
                                                                                    <'42', '0'>, '41', 
                                                                                    <~ticket, 
                                                                                     mask(~ticket_age_add,
                                                                                          $ticket_age)
                                                                                    >, 
                                                                                    '0'>)
                                                                                >)
                                                                          >, 
                                                                          '6', '0x0303', '40', $g>, 
                                                                         '1', '0x0303', ~tid, '0', 
                                                                         $cipher_suites.1, '0', 
                                                                         <'43', '0x0304'>, <'10', $g1, $g>, 
                                                                         <'13', $sig_algs>, '40', $g, $g^~x.1
                                                                        >, 
                                                                        '2', '0x0303', p_ns, $cipher_suite, 
                                                                        <'13', $sig_algs.1>, '40', $g, p_gy>, 
                                                                       '8', $exts>, 
                                                                      '11', '0', pk(~ltkS)>, 
                                                                     '15', 
                                                                     sign(<'server_cv', 
                                                                           h(<
                                                                              <
                                                                               <
                                                                                <
                                                                                 <
                                                                                  <'0', '1', '0x0303', ~tid, 
                                                                                   '0', $cipher_suites, '0', 
                                                                                   <'43', '0x0304'>, 
                                                                                   <'10', $g1, $g>, 
                                                                                   <'40', $g1, $g1^~x>, 
                                                                                   <'45', '0', '1'>, 
                                                                                   <'42', '0'>, '41', 
                                                                                   <~ticket, 
                                                                                    mask(~ticket_age_add,
                                                                                         $ticket_age)
                                                                                   >, 
                                                                                   hmac(<
                                                                                         Expand(Expand(Extract(~res_psk,
                                                                                                               '0'),
                                                                                                       <
                                                                                                        'ext', 
                                                                                                        'pbk'
                                                                                                       >,
                                                                                                       '32'),
                                                                                                <'0', '0'>,
                                                                                                '32'), 
                                                                                         h(<'0', '1', 
                                                                                            '0x0303', ~tid, 
                                                                                            '0', 
                                                                                            $cipher_suites, 
                                                                                            '0', 
                                                                                            <'43', '0x0304'>, 
                                                                                            <'10', $g1, $g>, 
                                                                                            <'40', $g1, $g1^~x
                                                                                            >, 
                                                                                            <'45', '0', '1'>, 
                                                                                            <'42', '0'>, 
                                                                                            '41', 
                                                                                            <~ticket, 
                                                                                             mask(~ticket_age_add,
                                                                                                  $ticket_age)
                                                                                            >, 
                                                                                            '0'>)
                                                                                        >)
                                                                                  >, 
                                                                                  '6', '0x0303', '40', $g>, 
                                                                                 '1', '0x0303', ~tid, '0', 
                                                                                 $cipher_suites.1, '0', 
                                                                                 <'43', '0x0304'>, 
                                                                                 <'10', $g1, $g>, 
                                                                                 <'13', $sig_algs>, '40', $g, 
                                                                                 $g^~x.1>, 
                                                                                '2', '0x0303', p_ns, 
                                                                                $cipher_suite, 
                                                                                <'13', $sig_algs.1>, '40', 
                                                                                $g, p_gy>, 
                                                                               '8', $exts>, 
                                                                              '11', '0', pk(~ltkS)>)
                                                                          >,
                                                                          ~ltkS)
                                                                    >)
                                                                 >,
                                                                 '32'),
                                                          <'fin', '0'>, '32'), 
                                                   h(<
                                                      <
                                                       <
                                                        <
                                                         <
                                                          <
                                                           <'0', '1', '0x0303', ~tid, '0', $cipher_suites, 
                                                            '0', <'43', '0x0304'>, <'10', $g1, $g>, 
                                                            <'40', $g1, $g1^~x>, <'45', '0', '1'>, 
                                                            <'42', '0'>, '41', 
                                                            <~ticket, mask(~ticket_age_add, $ticket_age)>, 
                                                            hmac(<
                                                                  Expand(Expand(Extract(~res_psk, '0'),
                                                                                <'ext', 'pbk'>, '32'),
                                                                         <'0', '0'>, '32'), 
                                                                  h(<'0', '1', '0x0303', ~tid, '0', 
                                                                     $cipher_suites, '0', <'43', '0x0304'>, 
                                                                     <'10', $g1, $g>, <'40', $g1, $g1^~x>, 
                                                                     <'45', '0', '1'>, <'42', '0'>, '41', 
                                                                     <~ticket, 
                                                                      mask(~ticket_age_add, $ticket_age)>, 
                                                                     '0'>)
                                                                 >)
                                                           >, 
                                                           '6', '0x0303', '40', $g>, 
                                                          '1', '0x0303', ~tid, '0', $cipher_suites.1, '0', 
                                                          <'43', '0x0304'>, <'10', $g1, $g>, 
                                                          <'13', $sig_algs>, '40', $g, $g^~x.1>, 
                                                         '2', '0x0303', p_ns, $cipher_suite, 
                                                         <'13', $sig_algs.1>, '40', $g, p_gy>, 
                                                        '8', $exts>, 
                                                       '11', '0', pk(~ltkS)>, 
                                                      '15', 
                                                      sign(<'server_cv', 
                                                            h(<
                                                               <
                                                                <
                                                                 <
                                                                  <
                                                                   <'0', '1', '0x0303', ~tid, '0', 
                                                                    $cipher_suites, '0', <'43', '0x0304'>, 
                                                                    <'10', $g1, $g>, <'40', $g1, $g1^~x>, 
                                                                    <'45', '0', '1'>, <'42', '0'>, '41', 
                                                                    <~ticket, 
                                                                     mask(~ticket_age_add, $ticket_age)>, 
                                                                    hmac(<
                                                                          Expand(Expand(Extract(~res_psk,
                                                                                                '0'),
                                                                                        <'ext', 'pbk'>, '32'),
                                                                                 <'0', '0'>, '32'), 
                                                                          h(<'0', '1', '0x0303', ~tid, '0', 
                                                                             $cipher_suites, '0', 
                                                                             <'43', '0x0304'>, 
                                                                             <'10', $g1, $g>, 
                                                                             <'40', $g1, $g1^~x>, 
                                                                             <'45', '0', '1'>, <'42', '0'>, 
                                                                             '41', 
                                                                             <~ticket, 
                                                                              mask(~ticket_age_add,
                                                                                   $ticket_age)
                                                                             >, 
                                                                             '0'>)
                                                                         >)
                                                                   >, 
                                                                   '6', '0x0303', '40', $g>, 
                                                                  '1', '0x0303', ~tid, '0', $cipher_suites.1, 
                                                                  '0', <'43', '0x0304'>, <'10', $g1, $g>, 
                                                                  <'13', $sig_algs>, '40', $g, $g^~x.1>, 
                                                                 '2', '0x0303', p_ns, $cipher_suite, 
                                                                 <'13', $sig_algs.1>, '40', $g, p_gy>, 
                                                                '8', $exts>, 
                                                               '11', '0', pk(~ltkS)>)
                                                           >,
                                                           ~ltkS)
                                                     >)
                                                  >)
                                            >)
                                         >,
                                         '32'),
                                  <'adke_wk', '0'>, '32')
                ) ▶₀ #l )
    next
      case recv_server_auth_case_04
      by solve( SecretPSK( $A,
                           Expand(Expand(Extract('0',
                                                 Extract(p_gxy,
                                                         Extract(Expand(ms, <'rms', h(messages)>, '32'),
                                                                 '0'))),
                                         <'serverats', 
                                          h(<
                                             <
                                              <
                                               <
                                                <
                                                 <
                                                  <
                                                   <'0', '1', '0x0303', ~tid, '0', $cipher_suites, '0', 
                                                    <'43', '0x0304'>, <'10', $g1, $g>, <'40', $g1, $g1^~x>, 
                                                    <'45', '0', '1'>, <'42', '0'>, '41', 
                                                    <p_psk_id, mask(ticket_age_add, $ticket_age)>, 
                                                    hmac(<
                                                          Expand(Expand(Extract(Expand(ms,
                                                                                       <'rms', h(messages)>,
                                                                                       '32'),
                                                                                '0'),
                                                                        <'res', 'pbk'>, '32'),
                                                                 <'0', '0'>, '32'), 
                                                          h(<'0', '1', '0x0303', ~tid, '0', $cipher_suites, 
                                                             '0', <'43', '0x0304'>, <'10', $g1, $g>, 
                                                             <'40', $g1, $g1^~x>, <'45', '0', '1'>, 
                                                             <'42', '0'>, '41', 
                                                             <p_psk_id, mask(ticket_age_add, $ticket_age)>, 
                                                             '0'>)
                                                         >)
                                                   >, 
                                                   '6', '0x0303', '40', $g>, 
                                                  '1', '0x0303', ~tid, '0', $cipher_suites.1, '0', 
                                                  <'43', '0x0304'>, <'10', $g1, $g>, <'13', $sig_algs>, '40', 
                                                  $g, $g^~x.1>, 
                                                 '2', '0x0303', p_ns, $cipher_suite, <'13', $sig_algs.1>, 
                                                 '40', $g, p_gy>, 
                                                '8', $exts>, 
                                               '11', '0', pk(~ltkS)>, 
                                              '15', 
                                              sign(<'server_cv', 
                                                    h(<
                                                       <
                                                        <
                                                         <
                                                          <
                                                           <'0', '1', '0x0303', ~tid, '0', $cipher_suites, 
                                                            '0', <'43', '0x0304'>, <'10', $g1, $g>, 
                                                            <'40', $g1, $g1^~x>, <'45', '0', '1'>, 
                                                            <'42', '0'>, '41', 
                                                            <p_psk_id, mask(ticket_age_add, $ticket_age)>, 
                                                            hmac(<
                                                                  Expand(Expand(Extract(Expand(ms,
                                                                                               <'rms', 
                                                                                                h(messages)>,
                                                                                               '32'),
                                                                                        '0'),
                                                                                <'res', 'pbk'>, '32'),
                                                                         <'0', '0'>, '32'), 
                                                                  h(<'0', '1', '0x0303', ~tid, '0', 
                                                                     $cipher_suites, '0', <'43', '0x0304'>, 
                                                                     <'10', $g1, $g>, <'40', $g1, $g1^~x>, 
                                                                     <'45', '0', '1'>, <'42', '0'>, '41', 
                                                                     <p_psk_id, 
                                                                      mask(ticket_age_add, $ticket_age)>, 
                                                                     '0'>)
                                                                 >)
                                                           >, 
                                                           '6', '0x0303', '40', $g>, 
                                                          '1', '0x0303', ~tid, '0', $cipher_suites.1, '0', 
                                                          <'43', '0x0304'>, <'10', $g1, $g>, 
                                                          <'13', $sig_algs>, '40', $g, $g^~x.1>, 
                                                         '2', '0x0303', p_ns, $cipher_suite, 
                                                         <'13', $sig_algs.1>, '40', $g, p_gy>, 
                                                        '8', $exts>, 
                                                       '11', '0', pk(~ltkS)>)
                                                   >,
                                                   ~ltkS)
                                             >, 
                                             '20', 
                                             hmac(<
                                                   Expand(Expand(Extract(p_gxy,
                                                                         Extract(Expand(ms,
                                                                                        <'rms', h(messages)>,
                                                                                        '32'),
                                                                                 '0')),
                                                                 <'serverhts', 
                                                                  h(<
                                                                     <
                                                                      <
                                                                       <
                                                                        <
                                                                         <
                                                                          <'0', '1', '0x0303', ~tid, '0', 
                                                                           $cipher_suites, '0', 
                                                                           <'43', '0x0304'>, <'10', $g1, $g>, 
                                                                           <'40', $g1, $g1^~x>, 
                                                                           <'45', '0', '1'>, <'42', '0'>, 
                                                                           '41', 
                                                                           <p_psk_id, 
                                                                            mask(ticket_age_add, $ticket_age)
                                                                           >, 
                                                                           hmac(<
                                                                                 Expand(Expand(Extract(Expand(ms,
                                                                                                              <
                                                                                                               'rms', 
                                                                                                               h(messages)
                                                                                                              >,
                                                                                                              '32'),
                                                                                                       '0'),
                                                                                               <'res', 'pbk'>,
                                                                                               '32'),
                                                                                        <'0', '0'>, '32'), 
                                                                                 h(<'0', '1', '0x0303', ~tid, 
                                                                                    '0', $cipher_suites, '0', 
                                                                                    <'43', '0x0304'>, 
                                                                                    <'10', $g1, $g>, 
                                                                                    <'40', $g1, $g1^~x>, 
                                                                                    <'45', '0', '1'>, 
                                                                                    <'42', '0'>, '41', 
                                                                                    <p_psk_id, 
                                                                                     mask(ticket_age_add,
                                                                                          $ticket_age)
                                                                                    >, 
                                                                                    '0'>)
                                                                                >)
                                                                          >, 
                                                                          '6', '0x0303', '40', $g>, 
                                                                         '1', '0x0303', ~tid, '0', 
                                                                         $cipher_suites.1, '0', 
                                                                         <'43', '0x0304'>, <'10', $g1, $g>, 
                                                                         <'13', $sig_algs>, '40', $g, $g^~x.1
                                                                        >, 
                                                                        '2', '0x0303', p_ns, $cipher_suite, 
                                                                        <'13', $sig_algs.1>, '40', $g, p_gy>, 
                                                                       '8', $exts>, 
                                                                      '11', '0', pk(~ltkS)>, 
                                                                     '15', 
                                                                     sign(<'server_cv', 
                                                                           h(<
                                                                              <
                                                                               <
                                                                                <
                                                                                 <
                                                                                  <'0', '1', '0x0303', ~tid, 
                                                                                   '0', $cipher_suites, '0', 
                                                                                   <'43', '0x0304'>, 
                                                                                   <'10', $g1, $g>, 
                                                                                   <'40', $g1, $g1^~x>, 
                                                                                   <'45', '0', '1'>, 
                                                                                   <'42', '0'>, '41', 
                                                                                   <p_psk_id, 
                                                                                    mask(ticket_age_add,
                                                                                         $ticket_age)
                                                                                   >, 
                                                                                   hmac(<
                                                                                         Expand(Expand(Extract(Expand(ms,
                                                                                                                      <
                                                                                                                       'rms', 
                                                                                                                       h(messages)
                                                                                                                      >,
                                                                                                                      '32'),
                                                                                                               '0'),
                                                                                                       <
                                                                                                        'res', 
                                                                                                        'pbk'
                                                                                                       >,
                                                                                                       '32'),
                                                                                                <'0', '0'>,
                                                                                                '32'), 
                                                                                         h(<'0', '1', 
                                                                                            '0x0303', ~tid, 
                                                                                            '0', 
                                                                                            $cipher_suites, 
                                                                                            '0', 
                                                                                            <'43', '0x0304'>, 
                                                                                            <'10', $g1, $g>, 
                                                                                            <'40', $g1, $g1^~x
                                                                                            >, 
                                                                                            <'45', '0', '1'>, 
                                                                                            <'42', '0'>, 
                                                                                            '41', 
                                                                                            <p_psk_id, 
                                                                                             mask(ticket_age_add,
                                                                                                  $ticket_age)
                                                                                            >, 
                                                                                            '0'>)
                                                                                        >)
                                                                                  >, 
                                                                                  '6', '0x0303', '40', $g>, 
                                                                                 '1', '0x0303', ~tid, '0', 
                                                                                 $cipher_suites.1, '0', 
                                                                                 <'43', '0x0304'>, 
                                                                                 <'10', $g1, $g>, 
                                                                                 <'13', $sig_algs>, '40', $g, 
                                                                                 $g^~x.1>, 
                                                                                '2', '0x0303', p_ns, 
                                                                                $cipher_suite, 
                                                                                <'13', $sig_algs.1>, '40', 
                                                                                $g, p_gy>, 
                                                                               '8', $exts>, 
                                                                              '11', '0', pk(~ltkS)>)
                                                                          >,
                                                                          ~ltkS)
                                                                    >)
                                                                 >,
                                                                 '32'),
                                                          <'fin', '0'>, '32'), 
                                                   h(<
                                                      <
                                                       <
                                                        <
                                                         <
                                                          <
                                                           <'0', '1', '0x0303', ~tid, '0', $cipher_suites, 
                                                            '0', <'43', '0x0304'>, <'10', $g1, $g>, 
                                                            <'40', $g1, $g1^~x>, <'45', '0', '1'>, 
                                                            <'42', '0'>, '41', 
                                                            <p_psk_id, mask(ticket_age_add, $ticket_age)>, 
                                                            hmac(<
                                                                  Expand(Expand(Extract(Expand(ms,
                                                                                               <'rms', 
                                                                                                h(messages)>,
                                                                                               '32'),
                                                                                        '0'),
                                                                                <'res', 'pbk'>, '32'),
                                                                         <'0', '0'>, '32'), 
                                                                  h(<'0', '1', '0x0303', ~tid, '0', 
                                                                     $cipher_suites, '0', <'43', '0x0304'>, 
                                                                     <'10', $g1, $g>, <'40', $g1, $g1^~x>, 
                                                                     <'45', '0', '1'>, <'42', '0'>, '41', 
                                                                     <p_psk_id, 
                                                                      mask(ticket_age_add, $ticket_age)>, 
                                                                     '0'>)
                                                                 >)
                                                           >, 
                                                           '6', '0x0303', '40', $g>, 
                                                          '1', '0x0303', ~tid, '0', $cipher_suites.1, '0', 
                                                          <'43', '0x0304'>, <'10', $g1, $g>, 
                                                          <'13', $sig_algs>, '40', $g, $g^~x.1>, 
                                                         '2', '0x0303', p_ns, $cipher_suite, 
                                                         <'13', $sig_algs.1>, '40', $g, p_gy>, 
                                                        '8', $exts>, 
                                                       '11', '0', pk(~ltkS)>, 
                                                      '15', 
                                                      sign(<'server_cv', 
                                                            h(<
                                                               <
                                                                <
                                                                 <
                                                                  <
                                                                   <'0', '1', '0x0303', ~tid, '0', 
                                                                    $cipher_suites, '0', <'43', '0x0304'>, 
                                                                    <'10', $g1, $g>, <'40', $g1, $g1^~x>, 
                                                                    <'45', '0', '1'>, <'42', '0'>, '41', 
                                                                    <p_psk_id, 
                                                                     mask(ticket_age_add, $ticket_age)>, 
                                                                    hmac(<
                                                                          Expand(Expand(Extract(Expand(ms,
                                                                                                       <
                                                                                                        'rms', 
                                                                                                        h(messages)
                                                                                                       >,
                                                                                                       '32'),
                                                                                                '0'),
                                                                                        <'res', 'pbk'>, '32'),
                                                                                 <'0', '0'>, '32'), 
                                                                          h(<'0', '1', '0x0303', ~tid, '0', 
                                                                             $cipher_suites, '0', 
                                                                             <'43', '0x0304'>, 
                                                                             <'10', $g1, $g>, 
                                                                             <'40', $g1, $g1^~x>, 
                                                                             <'45', '0', '1'>, <'42', '0'>, 
                                                                             '41', 
                                                                             <p_psk_id, 
                                                                              mask(ticket_age_add,
                                                                                   $ticket_age)
                                                                             >, 
                                                                             '0'>)
                                                                         >)
                                                                   >, 
                                                                   '6', '0x0303', '40', $g>, 
                                                                  '1', '0x0303', ~tid, '0', $cipher_suites.1, 
                                                                  '0', <'43', '0x0304'>, <'10', $g1, $g>, 
                                                                  <'13', $sig_algs>, '40', $g, $g^~x.1>, 
                                                                 '2', '0x0303', p_ns, $cipher_suite, 
                                                                 <'13', $sig_algs.1>, '40', $g, p_gy>, 
                                                                '8', $exts>, 
                                                               '11', '0', pk(~ltkS)>)
                                                           >,
                                                           ~ltkS)
                                                     >)
                                                  >)
                                            >)
                                         >,
                                         '32'),
                                  <'adke_wk', '0'>, '32')
                ) ▶₀ #l )
    next
      case recv_server_auth_case_05
      by solve( SecretPSK( $A,
                           Expand(Expand(Extract('0', Extract(p_gxy, Extract(~res_psk, '0'))),
                                         <'serverats', 
                                          h(<
                                             <
                                              <
                                               <
                                                <
                                                 <'0', '1', '0x0303', ~tid, '0', $cipher_suites, '0', 
                                                  <'43', '0x0304'>, <'10', $g, $g2>, <'40', $g, $g^~x>, 
                                                  <'45', '0', '1'>, <'42', '0'>, '41', 
                                                  <~ticket, mask(~ticket_age_add, $ticket_age)>, 
                                                  hmac(<
                                                        Expand(Expand(Extract(~res_psk, '0'), <'ext', 'pbk'>,
                                                                      '32'),
                                                               <'0', '0'>, '32'), 
                                                        h(<'0', '1', '0x0303', ~tid, '0', $cipher_suites, 
                                                           '0', <'43', '0x0304'>, <'10', $g, $g2>, 
                                                           <'40', $g, $g^~x>, <'45', '0', '1'>, <'42', '0'>, 
                                                           '41', 
                                                           <~ticket, mask(~ticket_age_add, $ticket_age)>, '0'
                                                          >)
                                                       >)
                                                 >, 
                                                 '2', '0x0303', p_ns, $cipher_suite, <'13', $sig_algs>, '40', 
                                                 $g, p_gy>, 
                                                '8', $exts>, 
                                               '11', '0', pk(~ltkS)>, 
                                              '15', 
                                              sign(<'server_cv', 
                                                    h(<
                                                       <
                                                        <
                                                         <'0', '1', '0x0303', ~tid, '0', $cipher_suites, '0', 
                                                          <'43', '0x0304'>, <'10', $g, $g2>, 
                                                          <'40', $g, $g^~x>, <'45', '0', '1'>, <'42', '0'>, 
                                                          '41', 
                                                          <~ticket, mask(~ticket_age_add, $ticket_age)>, 
                                                          hmac(<
                                                                Expand(Expand(Extract(~res_psk, '0'),
                                                                              <'ext', 'pbk'>, '32'),
                                                                       <'0', '0'>, '32'), 
                                                                h(<'0', '1', '0x0303', ~tid, '0', 
                                                                   $cipher_suites, '0', <'43', '0x0304'>, 
                                                                   <'10', $g, $g2>, <'40', $g, $g^~x>, 
                                                                   <'45', '0', '1'>, <'42', '0'>, '41', 
                                                                   <~ticket, 
                                                                    mask(~ticket_age_add, $ticket_age)>, 
                                                                   '0'>)
                                                               >)
                                                         >, 
                                                         '2', '0x0303', p_ns, $cipher_suite, 
                                                         <'13', $sig_algs>, '40', $g, p_gy>, 
                                                        '8', $exts>, 
                                                       '11', '0', pk(~ltkS)>)
                                                   >,
                                                   ~ltkS)
                                             >, 
                                             '20', 
                                             hmac(<
                                                   Expand(Expand(Extract(p_gxy, Extract(~res_psk, '0')),
                                                                 <'serverhts', 
                                                                  h(<
                                                                     <
                                                                      <
                                                                       <
                                                                        <'0', '1', '0x0303', ~tid, '0', 
                                                                         $cipher_suites, '0', 
                                                                         <'43', '0x0304'>, <'10', $g, $g2>, 
                                                                         <'40', $g, $g^~x>, <'45', '0', '1'>, 
                                                                         <'42', '0'>, '41', 
                                                                         <~ticket, 
                                                                          mask(~ticket_age_add, $ticket_age)
                                                                         >, 
                                                                         hmac(<
                                                                               Expand(Expand(Extract(~res_psk,
                                                                                                     '0'),
                                                                                             <'ext', 'pbk'>,
                                                                                             '32'),
                                                                                      <'0', '0'>, '32'), 
                                                                               h(<'0', '1', '0x0303', ~tid, 
                                                                                  '0', $cipher_suites, '0', 
                                                                                  <'43', '0x0304'>, 
                                                                                  <'10', $g, $g2>, 
                                                                                  <'40', $g, $g^~x>, 
                                                                                  <'45', '0', '1'>, 
                                                                                  <'42', '0'>, '41', 
                                                                                  <~ticket, 
                                                                                   mask(~ticket_age_add,
                                                                                        $ticket_age)
                                                                                  >, 
                                                                                  '0'>)
                                                                              >)
                                                                        >, 
                                                                        '2', '0x0303', p_ns, $cipher_suite, 
                                                                        <'13', $sig_algs>, '40', $g, p_gy>, 
                                                                       '8', $exts>, 
                                                                      '11', '0', pk(~ltkS)>, 
                                                                     '15', 
                                                                     sign(<'server_cv', 
                                                                           h(<
                                                                              <
                                                                               <
                                                                                <'0', '1', '0x0303', ~tid, 
                                                                                 '0', $cipher_suites, '0', 
                                                                                 <'43', '0x0304'>, 
                                                                                 <'10', $g, $g2>, 
                                                                                 <'40', $g, $g^~x>, 
                                                                                 <'45', '0', '1'>, 
                                                                                 <'42', '0'>, '41', 
                                                                                 <~ticket, 
                                                                                  mask(~ticket_age_add,
                                                                                       $ticket_age)
                                                                                 >, 
                                                                                 hmac(<
                                                                                       Expand(Expand(Extract(~res_psk,
                                                                                                             '0'),
                                                                                                     <'ext', 
                                                                                                      'pbk'>,
                                                                                                     '32'),
                                                                                              <'0', '0'>,
                                                                                              '32'), 
                                                                                       h(<'0', '1', '0x0303', 
                                                                                          ~tid, '0', 
                                                                                          $cipher_suites, 
                                                                                          '0', 
                                                                                          <'43', '0x0304'>, 
                                                                                          <'10', $g, $g2>, 
                                                                                          <'40', $g, $g^~x>, 
                                                                                          <'45', '0', '1'>, 
                                                                                          <'42', '0'>, '41', 
                                                                                          <~ticket, 
                                                                                           mask(~ticket_age_add,
                                                                                                $ticket_age)
                                                                                          >, 
                                                                                          '0'>)
                                                                                      >)
                                                                                >, 
                                                                                '2', '0x0303', p_ns, 
                                                                                $cipher_suite, 
                                                                                <'13', $sig_algs>, '40', $g, 
                                                                                p_gy>, 
                                                                               '8', $exts>, 
                                                                              '11', '0', pk(~ltkS)>)
                                                                          >,
                                                                          ~ltkS)
                                                                    >)
                                                                 >,
                                                                 '32'),
                                                          <'fin', '0'>, '32'), 
                                                   h(<
                                                      <
                                                       <
                                                        <
                                                         <'0', '1', '0x0303', ~tid, '0', $cipher_suites, '0', 
                                                          <'43', '0x0304'>, <'10', $g, $g2>, 
                                                          <'40', $g, $g^~x>, <'45', '0', '1'>, <'42', '0'>, 
                                                          '41', 
                                                          <~ticket, mask(~ticket_age_add, $ticket_age)>, 
                                                          hmac(<
                                                                Expand(Expand(Extract(~res_psk, '0'),
                                                                              <'ext', 'pbk'>, '32'),
                                                                       <'0', '0'>, '32'), 
                                                                h(<'0', '1', '0x0303', ~tid, '0', 
                                                                   $cipher_suites, '0', <'43', '0x0304'>, 
                                                                   <'10', $g, $g2>, <'40', $g, $g^~x>, 
                                                                   <'45', '0', '1'>, <'42', '0'>, '41', 
                                                                   <~ticket, 
                                                                    mask(~ticket_age_add, $ticket_age)>, 
                                                                   '0'>)
                                                               >)
                                                         >, 
                                                         '2', '0x0303', p_ns, $cipher_suite, 
                                                         <'13', $sig_algs>, '40', $g, p_gy>, 
                                                        '8', $exts>, 
                                                       '11', '0', pk(~ltkS)>, 
                                                      '15', 
                                                      sign(<'server_cv', 
                                                            h(<
                                                               <
                                                                <
                                                                 <'0', '1', '0x0303', ~tid, '0', 
                                                                  $cipher_suites, '0', <'43', '0x0304'>, 
                                                                  <'10', $g, $g2>, <'40', $g, $g^~x>, 
                                                                  <'45', '0', '1'>, <'42', '0'>, '41', 
                                                                  <~ticket, mask(~ticket_age_add, $ticket_age)
                                                                  >, 
                                                                  hmac(<
                                                                        Expand(Expand(Extract(~res_psk, '0'),
                                                                                      <'ext', 'pbk'>, '32'),
                                                                               <'0', '0'>, '32'), 
                                                                        h(<'0', '1', '0x0303', ~tid, '0', 
                                                                           $cipher_suites, '0', 
                                                                           <'43', '0x0304'>, <'10', $g, $g2>, 
                                                                           <'40', $g, $g^~x>, 
                                                                           <'45', '0', '1'>, <'42', '0'>, 
                                                                           '41', 
                                                                           <~ticket, 
                                                                            mask(~ticket_age_add, $ticket_age)
                                                                           >, 
                                                                           '0'>)
                                                                       >)
                                                                 >, 
                                                                 '2', '0x0303', p_ns, $cipher_suite, 
                                                                 <'13', $sig_algs>, '40', $g, p_gy>, 
                                                                '8', $exts>, 
                                                               '11', '0', pk(~ltkS)>)
                                                           >,
                                                           ~ltkS)
                                                     >)
                                                  >)
                                            >)
                                         >,
                                         '32'),
                                  <'adke_wk', '0'>, '32')
                ) ▶₀ #l )
    next
      case recv_server_auth_case_06
      by solve( SecretPSK( $A,
                           Expand(Expand(Extract('0',
                                                 Extract(p_gxy,
                                                         Extract(Expand(ms, <'rms', h(messages)>, '32'),
                                                                 '0'))),
                                         <'serverats', 
                                          h(<
                                             <
                                              <
                                               <
                                                <
                                                 <'0', '1', '0x0303', ~tid, '0', $cipher_suites, '0', 
                                                  <'43', '0x0304'>, <'10', $g, $g2>, <'40', $g, $g^~x>, 
                                                  <'45', '0', '1'>, <'42', '0'>, '41', 
                                                  <p_psk_id, mask(ticket_age_add, $ticket_age)>, 
                                                  hmac(<
                                                        Expand(Expand(Extract(Expand(ms, <'rms', h(messages)>,
                                                                                     '32'),
                                                                              '0'),
                                                                      <'res', 'pbk'>, '32'),
                                                               <'0', '0'>, '32'), 
                                                        h(<'0', '1', '0x0303', ~tid, '0', $cipher_suites, 
                                                           '0', <'43', '0x0304'>, <'10', $g, $g2>, 
                                                           <'40', $g, $g^~x>, <'45', '0', '1'>, <'42', '0'>, 
                                                           '41', 
                                                           <p_psk_id, mask(ticket_age_add, $ticket_age)>, '0'
                                                          >)
                                                       >)
                                                 >, 
                                                 '2', '0x0303', p_ns, $cipher_suite, <'13', $sig_algs>, '40', 
                                                 $g, p_gy>, 
                                                '8', $exts>, 
                                               '11', '0', pk(~ltkS)>, 
                                              '15', 
                                              sign(<'server_cv', 
                                                    h(<
                                                       <
                                                        <
                                                         <'0', '1', '0x0303', ~tid, '0', $cipher_suites, '0', 
                                                          <'43', '0x0304'>, <'10', $g, $g2>, 
                                                          <'40', $g, $g^~x>, <'45', '0', '1'>, <'42', '0'>, 
                                                          '41', 
                                                          <p_psk_id, mask(ticket_age_add, $ticket_age)>, 
                                                          hmac(<
                                                                Expand(Expand(Extract(Expand(ms,
                                                                                             <'rms', 
                                                                                              h(messages)>,
                                                                                             '32'),
                                                                                      '0'),
                                                                              <'res', 'pbk'>, '32'),
                                                                       <'0', '0'>, '32'), 
                                                                h(<'0', '1', '0x0303', ~tid, '0', 
                                                                   $cipher_suites, '0', <'43', '0x0304'>, 
                                                                   <'10', $g, $g2>, <'40', $g, $g^~x>, 
                                                                   <'45', '0', '1'>, <'42', '0'>, '41', 
                                                                   <p_psk_id, 
                                                                    mask(ticket_age_add, $ticket_age)>, 
                                                                   '0'>)
                                                               >)
                                                         >, 
                                                         '2', '0x0303', p_ns, $cipher_suite, 
                                                         <'13', $sig_algs>, '40', $g, p_gy>, 
                                                        '8', $exts>, 
                                                       '11', '0', pk(~ltkS)>)
                                                   >,
                                                   ~ltkS)
                                             >, 
                                             '20', 
                                             hmac(<
                                                   Expand(Expand(Extract(p_gxy,
                                                                         Extract(Expand(ms,
                                                                                        <'rms', h(messages)>,
                                                                                        '32'),
                                                                                 '0')),
                                                                 <'serverhts', 
                                                                  h(<
                                                                     <
                                                                      <
                                                                       <
                                                                        <'0', '1', '0x0303', ~tid, '0', 
                                                                         $cipher_suites, '0', 
                                                                         <'43', '0x0304'>, <'10', $g, $g2>, 
                                                                         <'40', $g, $g^~x>, <'45', '0', '1'>, 
                                                                         <'42', '0'>, '41', 
                                                                         <p_psk_id, 
                                                                          mask(ticket_age_add, $ticket_age)>, 
                                                                         hmac(<
                                                                               Expand(Expand(Extract(Expand(ms,
                                                                                                            <
                                                                                                             'rms', 
                                                                                                             h(messages)
                                                                                                            >,
                                                                                                            '32'),
                                                                                                     '0'),
                                                                                             <'res', 'pbk'>,
                                                                                             '32'),
                                                                                      <'0', '0'>, '32'), 
                                                                               h(<'0', '1', '0x0303', ~tid, 
                                                                                  '0', $cipher_suites, '0', 
                                                                                  <'43', '0x0304'>, 
                                                                                  <'10', $g, $g2>, 
                                                                                  <'40', $g, $g^~x>, 
                                                                                  <'45', '0', '1'>, 
                                                                                  <'42', '0'>, '41', 
                                                                                  <p_psk_id, 
                                                                                   mask(ticket_age_add,
                                                                                        $ticket_age)
                                                                                  >, 
                                                                                  '0'>)
                                                                              >)
                                                                        >, 
                                                                        '2', '0x0303', p_ns, $cipher_suite, 
                                                                        <'13', $sig_algs>, '40', $g, p_gy>, 
                                                                       '8', $exts>, 
                                                                      '11', '0', pk(~ltkS)>, 
                                                                     '15', 
                                                                     sign(<'server_cv', 
                                                                           h(<
                                                                              <
                                                                               <
                                                                                <'0', '1', '0x0303', ~tid, 
                                                                                 '0', $cipher_suites, '0', 
                                                                                 <'43', '0x0304'>, 
                                                                                 <'10', $g, $g2>, 
                                                                                 <'40', $g, $g^~x>, 
                                                                                 <'45', '0', '1'>, 
                                                                                 <'42', '0'>, '41', 
                                                                                 <p_psk_id, 
                                                                                  mask(ticket_age_add,
                                                                                       $ticket_age)
                                                                                 >, 
                                                                                 hmac(<
                                                                                       Expand(Expand(Extract(Expand(ms,
                                                                                                                    <
                                                                                                                     'rms', 
                                                                                                                     h(messages)
                                                                                                                    >,
                                                                                                                    '32'),
                                                                                                             '0'),
                                                                                                     <'res', 
                                                                                                      'pbk'>,
                                                                                                     '32'),
                                                                                              <'0', '0'>,
                                                                                              '32'), 
                                                                                       h(<'0', '1', '0x0303', 
                                                                                          ~tid, '0', 
                                                                                          $cipher_suites, 
                                                                                          '0', 
                                                                                          <'43', '0x0304'>, 
                                                                                          <'10', $g, $g2>, 
                                                                                          <'40', $g, $g^~x>, 
                                                                                          <'45', '0', '1'>, 
                                                                                          <'42', '0'>, '41', 
                                                                                          <p_psk_id, 
                                                                                           mask(ticket_age_add,
                                                                                                $ticket_age)
                                                                                          >, 
                                                                                          '0'>)
                                                                                      >)
                                                                                >, 
                                                                                '2', '0x0303', p_ns, 
                                                                                $cipher_suite, 
                                                                                <'13', $sig_algs>, '40', $g, 
                                                                                p_gy>, 
                                                                               '8', $exts>, 
                                                                              '11', '0', pk(~ltkS)>)
                                                                          >,
                                                                          ~ltkS)
                                                                    >)
                                                                 >,
                                                                 '32'),
                                                          <'fin', '0'>, '32'), 
                                                   h(<
                                                      <
                                                       <
                                                        <
                                                         <'0', '1', '0x0303', ~tid, '0', $cipher_suites, '0', 
                                                          <'43', '0x0304'>, <'10', $g, $g2>, 
                                                          <'40', $g, $g^~x>, <'45', '0', '1'>, <'42', '0'>, 
                                                          '41', 
                                                          <p_psk_id, mask(ticket_age_add, $ticket_age)>, 
                                                          hmac(<
                                                                Expand(Expand(Extract(Expand(ms,
                                                                                             <'rms', 
                                                                                              h(messages)>,
                                                                                             '32'),
                                                                                      '0'),
                                                                              <'res', 'pbk'>, '32'),
                                                                       <'0', '0'>, '32'), 
                                                                h(<'0', '1', '0x0303', ~tid, '0', 
                                                                   $cipher_suites, '0', <'43', '0x0304'>, 
                                                                   <'10', $g, $g2>, <'40', $g, $g^~x>, 
                                                                   <'45', '0', '1'>, <'42', '0'>, '41', 
                                                                   <p_psk_id, 
                                                                    mask(ticket_age_add, $ticket_age)>, 
                                                                   '0'>)
                                                               >)
                                                         >, 
                                                         '2', '0x0303', p_ns, $cipher_suite, 
                                                         <'13', $sig_algs>, '40', $g, p_gy>, 
                                                        '8', $exts>, 
                                                       '11', '0', pk(~ltkS)>, 
                                                      '15', 
                                                      sign(<'server_cv', 
                                                            h(<
                                                               <
                                                                <
                                                                 <'0', '1', '0x0303', ~tid, '0', 
                                                                  $cipher_suites, '0', <'43', '0x0304'>, 
                                                                  <'10', $g, $g2>, <'40', $g, $g^~x>, 
                                                                  <'45', '0', '1'>, <'42', '0'>, '41', 
                                                                  <p_psk_id, mask(ticket_age_add, $ticket_age)
                                                                  >, 
                                                                  hmac(<
                                                                        Expand(Expand(Extract(Expand(ms,
                                                                                                     <'rms', 
                                                                                                      h(messages)
                                                                                                     >,
                                                                                                     '32'),
                                                                                              '0'),
                                                                                      <'res', 'pbk'>, '32'),
                                                                               <'0', '0'>, '32'), 
                                                                        h(<'0', '1', '0x0303', ~tid, '0', 
                                                                           $cipher_suites, '0', 
                                                                           <'43', '0x0304'>, <'10', $g, $g2>, 
                                                                           <'40', $g, $g^~x>, 
                                                                           <'45', '0', '1'>, <'42', '0'>, 
                                                                           '41', 
                                                                           <p_psk_id, 
                                                                            mask(ticket_age_add, $ticket_age)
                                                                           >, 
                                                                           '0'>)
                                                                       >)
                                                                 >, 
                                                                 '2', '0x0303', p_ns, $cipher_suite, 
                                                                 <'13', $sig_algs>, '40', $g, p_gy>, 
                                                                '8', $exts>, 
                                                               '11', '0', pk(~ltkS)>)
                                                           >,
                                                           ~ltkS)
                                                     >)
                                                  >)
                                            >)
                                         >,
                                         '32'),
                                  <'adke_wk', '0'>, '32')
                ) ▶₀ #l )
    next
      case recv_server_auth_case_07
      by solve( SecretPSK( $A,
                           Expand(Expand(Extract('0', Extract(p_gxy, Extract(~res_psk, '0'))),
                                         <'serverats', 
                                          h(<
                                             <
                                              <
                                               <
                                                <
                                                 <
                                                  <
                                                   <'0', '1', '0x0303', ~tid, '0', $cipher_suites, '0', 
                                                    <'43', '0x0304'>, <'10', $g1, $g>, <'40', $g1, $g1^~x>, 
                                                    <'45', '0', '1'>, <'42', '0'>, '41', 
                                                    <~ticket, mask(~ticket_age_add, $ticket_age)>, 
                                                    hmac(<
                                                          Expand(Expand(Extract(~res_psk, '0'),
                                                                        <'ext', 'pbk'>, '32'),
                                                                 <'0', '0'>, '32'), 
                                                          h(<'0', '1', '0x0303', ~tid, '0', $cipher_suites, 
                                                             '0', <'43', '0x0304'>, <'10', $g1, $g>, 
                                                             <'40', $g1, $g1^~x>, <'45', '0', '1'>, 
                                                             <'42', '0'>, '41', 
                                                             <~ticket, mask(~ticket_age_add, $ticket_age)>, 
                                                             '0'>)
                                                         >)
                                                   >, 
                                                   '6', '0x0303', '40', $g>, 
                                                  '1', '0x0303', ~new_nc, '0', $cipher_suites.1, '0', 
                                                  <'43', '0x0304'>, <'10', $g1, $g>, <'40', $g, $g^~x.1>, 
                                                  <'45', '0', '1'>, '0', '41', 
                                                  <~ticket, mask(~ticket_age_add, '1')>, 
                                                  hmac(<
                                                        Expand(Expand(Extract(~res_psk, '0'), <'ext', 'pbk'>,
                                                                      '32'),
                                                               <'0', '0'>, '32'), 
                                                        h(<
                                                           <
                                                            <'0', '1', '0x0303', ~tid, '0', $cipher_suites, 
                                                             '0', <'43', '0x0304'>, <'10', $g1, $g>, 
                                                             <'40', $g1, $g1^~x>, <'45', '0', '1'>, 
                                                             <'42', '0'>, '41', 
                                                             <~ticket, mask(~ticket_age_add, $ticket_age)>, 
                                                             hmac(<
                                                                   Expand(Expand(Extract(~res_psk, '0'),
                                                                                 <'ext', 'pbk'>, '32'),
                                                                          <'0', '0'>, '32'), 
                                                                   h(<'0', '1', '0x0303', ~tid, '0', 
                                                                      $cipher_suites, '0', <'43', '0x0304'>, 
                                                                      <'10', $g1, $g>, <'40', $g1, $g1^~x>, 
                                                                      <'45', '0', '1'>, <'42', '0'>, '41', 
                                                                      <~ticket, 
                                                                       mask(~ticket_age_add, $ticket_age)>, 
                                                                      '0'>)
                                                                  >)
                                                            >, 
                                                            '6', '0x0303', '40', $g>, 
                                                           '1', '0x0303', ~new_nc, '0', $cipher_suites.1, 
                                                           '0', <'43', '0x0304'>, <'10', $g1, $g>, 
                                                           <'40', $g, $g^~x.1>, <'45', '0', '1'>, '0', '41', 
                                                           <~ticket, mask(~ticket_age_add, '1')>, '0'>)
                                                       >)
                                                 >, 
                                                 '2', '0x0303', p_ns, $cipher_suite, <'13', $sig_algs>, '40', 
                                                 $g, p_gy>, 
                                                '8', $exts>, 
                                               '11', '0', pk(~ltkS)>, 
                                              '15', 
                                              sign(<'server_cv', 
                                                    h(<
                                                       <
                                                        <
                                                         <
                                                          <
                                                           <'0', '1', '0x0303', ~tid, '0', $cipher_suites, 
                                                            '0', <'43', '0x0304'>, <'10', $g1, $g>, 
                                                            <'40', $g1, $g1^~x>, <'45', '0', '1'>, 
                                                            <'42', '0'>, '41', 
                                                            <~ticket, mask(~ticket_age_add, $ticket_age)>, 
                                                            hmac(<
                                                                  Expand(Expand(Extract(~res_psk, '0'),
                                                                                <'ext', 'pbk'>, '32'),
                                                                         <'0', '0'>, '32'), 
                                                                  h(<'0', '1', '0x0303', ~tid, '0', 
                                                                     $cipher_suites, '0', <'43', '0x0304'>, 
                                                                     <'10', $g1, $g>, <'40', $g1, $g1^~x>, 
                                                                     <'45', '0', '1'>, <'42', '0'>, '41', 
                                                                     <~ticket, 
                                                                      mask(~ticket_age_add, $ticket_age)>, 
                                                                     '0'>)
                                                                 >)
                                                           >, 
                                                           '6', '0x0303', '40', $g>, 
                                                          '1', '0x0303', ~new_nc, '0', $cipher_suites.1, '0', 
                                                          <'43', '0x0304'>, <'10', $g1, $g>, 
                                                          <'40', $g, $g^~x.1>, <'45', '0', '1'>, '0', '41', 
                                                          <~ticket, mask(~ticket_age_add, '1')>, 
                                                          hmac(<
                                                                Expand(Expand(Extract(~res_psk, '0'),
                                                                              <'ext', 'pbk'>, '32'),
                                                                       <'0', '0'>, '32'), 
                                                                h(<
                                                                   <
                                                                    <'0', '1', '0x0303', ~tid, '0', 
                                                                     $cipher_suites, '0', <'43', '0x0304'>, 
                                                                     <'10', $g1, $g>, <'40', $g1, $g1^~x>, 
                                                                     <'45', '0', '1'>, <'42', '0'>, '41', 
                                                                     <~ticket, 
                                                                      mask(~ticket_age_add, $ticket_age)>, 
                                                                     hmac(<
                                                                           Expand(Expand(Extract(~res_psk,
                                                                                                 '0'),
                                                                                         <'ext', 'pbk'>,
                                                                                         '32'),
                                                                                  <'0', '0'>, '32'), 
                                                                           h(<'0', '1', '0x0303', ~tid, '0', 
                                                                              $cipher_suites, '0', 
                                                                              <'43', '0x0304'>, 
                                                                              <'10', $g1, $g>, 
                                                                              <'40', $g1, $g1^~x>, 
                                                                              <'45', '0', '1'>, <'42', '0'>, 
                                                                              '41', 
                                                                              <~ticket, 
                                                                               mask(~ticket_age_add,
                                                                                    $ticket_age)
                                                                              >, 
                                                                              '0'>)
                                                                          >)
                                                                    >, 
                                                                    '6', '0x0303', '40', $g>, 
                                                                   '1', '0x0303', ~new_nc, '0', 
                                                                   $cipher_suites.1, '0', <'43', '0x0304'>, 
                                                                   <'10', $g1, $g>, <'40', $g, $g^~x.1>, 
                                                                   <'45', '0', '1'>, '0', '41', 
                                                                   <~ticket, mask(~ticket_age_add, '1')>, '0'
                                                                  >)
                                                               >)
                                                         >, 
                                                         '2', '0x0303', p_ns, $cipher_suite, 
                                                         <'13', $sig_algs>, '40', $g, p_gy>, 
                                                        '8', $exts>, 
                                                       '11', '0', pk(~ltkS)>)
                                                   >,
                                                   ~ltkS)
                                             >, 
                                             '20', 
                                             hmac(<
                                                   Expand(Expand(Extract(p_gxy, Extract(~res_psk, '0')),
                                                                 <'serverhts', 
                                                                  h(<
                                                                     <
                                                                      <
                                                                       <
                                                                        <
                                                                         <
                                                                          <'0', '1', '0x0303', ~tid, '0', 
                                                                           $cipher_suites, '0', 
                                                                           <'43', '0x0304'>, <'10', $g1, $g>, 
                                                                           <'40', $g1, $g1^~x>, 
                                                                           <'45', '0', '1'>, <'42', '0'>, 
                                                                           '41', 
                                                                           <~ticket, 
                                                                            mask(~ticket_age_add, $ticket_age)
                                                                           >, 
                                                                           hmac(<
                                                                                 Expand(Expand(Extract(~res_psk,
                                                                                                       '0'),
                                                                                               <'ext', 'pbk'>,
                                                                                               '32'),
                                                                                        <'0', '0'>, '32'), 
                                                                                 h(<'0', '1', '0x0303', ~tid, 
                                                                                    '0', $cipher_suites, '0', 
                                                                                    <'43', '0x0304'>, 
                                                                                    <'10', $g1, $g>, 
                                                                                    <'40', $g1, $g1^~x>, 
                                                                                    <'45', '0', '1'>, 
                                                                                    <'42', '0'>, '41', 
                                                                                    <~ticket, 
                                                                                     mask(~ticket_age_add,
                                                                                          $ticket_age)
                                                                                    >, 
                                                                                    '0'>)
                                                                                >)
                                                                          >, 
                                                                          '6', '0x0303', '40', $g>, 
                                                                         '1', '0x0303', ~new_nc, '0', 
                                                                         $cipher_suites.1, '0', 
                                                                         <'43', '0x0304'>, <'10', $g1, $g>, 
                                                                         <'40', $g, $g^~x.1>, 
                                                                         <'45', '0', '1'>, '0', '41', 
                                                                         <~ticket, mask(~ticket_age_add, '1')
                                                                         >, 
                                                                         hmac(<
                                                                               Expand(Expand(Extract(~res_psk,
                                                                                                     '0'),
                                                                                             <'ext', 'pbk'>,
                                                                                             '32'),
                                                                                      <'0', '0'>, '32'), 
                                                                               h(<
                                                                                  <
                                                                                   <'0', '1', '0x0303', ~tid, 
                                                                                    '0', $cipher_suites, '0', 
                                                                                    <'43', '0x0304'>, 
                                                                                    <'10', $g1, $g>, 
                                                                                    <'40', $g1, $g1^~x>, 
                                                                                    <'45', '0', '1'>, 
                                                                                    <'42', '0'>, '41', 
                                                                                    <~ticket, 
                                                                                     mask(~ticket_age_add,
                                                                                          $ticket_age)
                                                                                    >, 
                                                                                    hmac(<
                                                                                          Expand(Expand(Extract(~res_psk,
                                                                                                                '0'),
                                                                                                        <
                                                                                                         'ext', 
                                                                                                         'pbk'
                                                                                                        >,
                                                                                                        '32'),
                                                                                                 <'0', '0'>,
                                                                                                 '32'), 
                                                                                          h(<'0', '1', 
                                                                                             '0x0303', ~tid, 
                                                                                             '0', 
                                                                                             $cipher_suites, 
                                                                                             '0', 
                                                                                             <'43', '0x0304'
                                                                                             >, 
                                                                                             <'10', $g1, $g>, 
                                                                                             <'40', $g1, 
                                                                                              $g1^~x>, 
                                                                                             <'45', '0', '1'
                                                                                             >, 
                                                                                             <'42', '0'>, 
                                                                                             '41', 
                                                                                             <~ticket, 
                                                                                              mask(~ticket_age_add,
                                                                                                   $ticket_age)
                                                                                             >, 
                                                                                             '0'>)
                                                                                         >)
                                                                                   >, 
                                                                                   '6', '0x0303', '40', $g>, 
                                                                                  '1', '0x0303', ~new_nc, 
                                                                                  '0', $cipher_suites.1, '0', 
                                                                                  <'43', '0x0304'>, 
                                                                                  <'10', $g1, $g>, 
                                                                                  <'40', $g, $g^~x.1>, 
                                                                                  <'45', '0', '1'>, '0', 
                                                                                  '41', 
                                                                                  <~ticket, 
                                                                                   mask(~ticket_age_add, '1')
                                                                                  >, 
                                                                                  '0'>)
                                                                              >)
                                                                        >, 
                                                                        '2', '0x0303', p_ns, $cipher_suite, 
                                                                        <'13', $sig_algs>, '40', $g, p_gy>, 
                                                                       '8', $exts>, 
                                                                      '11', '0', pk(~ltkS)>, 
                                                                     '15', 
                                                                     sign(<'server_cv', 
                                                                           h(<
                                                                              <
                                                                               <
                                                                                <
                                                                                 <
                                                                                  <'0', '1', '0x0303', ~tid, 
                                                                                   '0', $cipher_suites, '0', 
                                                                                   <'43', '0x0304'>, 
                                                                                   <'10', $g1, $g>, 
                                                                                   <'40', $g1, $g1^~x>, 
                                                                                   <'45', '0', '1'>, 
                                                                                   <'42', '0'>, '41', 
                                                                                   <~ticket, 
                                                                                    mask(~ticket_age_add,
                                                                                         $ticket_age)
                                                                                   >, 
                                                                                   hmac(<
                                                                                         Expand(Expand(Extract(~res_psk,
                                                                                                               '0'),
                                                                                                       <
                                                                                                        'ext', 
                                                                                                        'pbk'
                                                                                                       >,
                                                                                                       '32'),
                                                                                                <'0', '0'>,
                                                                                                '32'), 
                                                                                         h(<'0', '1', 
                                                                                            '0x0303', ~tid, 
                                                                                            '0', 
                                                                                            $cipher_suites, 
                                                                                            '0', 
                                                                                            <'43', '0x0304'>, 
                                                                                            <'10', $g1, $g>, 
                                                                                            <'40', $g1, $g1^~x
                                                                                            >, 
                                                                                            <'45', '0', '1'>, 
                                                                                            <'42', '0'>, 
                                                                                            '41', 
                                                                                            <~ticket, 
                                                                                             mask(~ticket_age_add,
                                                                                                  $ticket_age)
                                                                                            >, 
                                                                                            '0'>)
                                                                                        >)
                                                                                  >, 
                                                                                  '6', '0x0303', '40', $g>, 
                                                                                 '1', '0x0303', ~new_nc, '0', 
                                                                                 $cipher_suites.1, '0', 
                                                                                 <'43', '0x0304'>, 
                                                                                 <'10', $g1, $g>, 
                                                                                 <'40', $g, $g^~x.1>, 
                                                                                 <'45', '0', '1'>, '0', '41', 
                                                                                 <~ticket, 
                                                                                  mask(~ticket_age_add, '1')
                                                                                 >, 
                                                                                 hmac(<
                                                                                       Expand(Expand(Extract(~res_psk,
                                                                                                             '0'),
                                                                                                     <'ext', 
                                                                                                      'pbk'>,
                                                                                                     '32'),
                                                                                              <'0', '0'>,
                                                                                              '32'), 
                                                                                       h(<
                                                                                          <
                                                                                           <'0', '1', 
                                                                                            '0x0303', ~tid, 
                                                                                            '0', 
                                                                                            $cipher_suites, 
                                                                                            '0', 
                                                                                            <'43', '0x0304'>, 
                                                                                            <'10', $g1, $g>, 
                                                                                            <'40', $g1, $g1^~x
                                                                                            >, 
                                                                                            <'45', '0', '1'>, 
                                                                                            <'42', '0'>, 
                                                                                            '41', 
                                                                                            <~ticket, 
                                                                                             mask(~ticket_age_add,
                                                                                                  $ticket_age)
                                                                                            >, 
                                                                                            hmac(<
                                                                                                  Expand(Expand(Extract(~res_psk,
                                                                                                                        '0'),
                                                                                                                <
                                                                                                                 'ext', 
                                                                                                                 'pbk'
                                                                                                                >,
                                                                                                                '32'),
                                                                                                         <
                                                                                                          '0', 
                                                                                                          '0'
                                                                                                         >,
                                                                                                         '32'), 
                                                                                                  h(<'0', 
                                                                                                     '1', 
                                                                                                     '0x0303', 
                                                                                                     ~tid, 
                                                                                                     '0', 
                                                                                                     $cipher_suites, 
                                                                                                     '0', 
                                                                                                     <'43', 
                                                                                                      '0x0304'
                                                                                                     >, 
                                                                                                     <'10', 
                                                                                                      $g1, $g
                                                                                                     >, 
                                                                                                     <'40', 
                                                                                                      $g1, 
                                                                                                      $g1^~x
                                                                                                     >, 
                                                                                                     <'45', 
                                                                                                      '0', '1'
                                                                                                     >, 
                                                                                                     <'42', 
                                                                                                      '0'>, 
                                                                                                     '41', 
                                                                                                     <
                                                                                                      ~ticket, 
                                                                                                      mask(~ticket_age_add,
                                                                                                           $ticket_age)
                                                                                                     >, 
                                                                                                     '0'>)
                                                                                                 >)
                                                                                           >, 
                                                                                           '6', '0x0303', 
                                                                                           '40', $g>, 
                                                                                          '1', '0x0303', 
                                                                                          ~new_nc, '0', 
                                                                                          $cipher_suites.1, 
                                                                                          '0', 
                                                                                          <'43', '0x0304'>, 
                                                                                          <'10', $g1, $g>, 
                                                                                          <'40', $g, $g^~x.1
                                                                                          >, 
                                                                                          <'45', '0', '1'>, 
                                                                                          '0', '41', 
                                                                                          <~ticket, 
                                                                                           mask(~ticket_age_add,
                                                                                                '1')
                                                                                          >, 
                                                                                          '0'>)
                                                                                      >)
                                                                                >, 
                                                                                '2', '0x0303', p_ns, 
                                                                                $cipher_suite, 
                                                                                <'13', $sig_algs>, '40', $g, 
                                                                                p_gy>, 
                                                                               '8', $exts>, 
                                                                              '11', '0', pk(~ltkS)>)
                                                                          >,
                                                                          ~ltkS)
                                                                    >)
                                                                 >,
                                                                 '32'),
                                                          <'fin', '0'>, '32'), 
                                                   h(<
                                                      <
                                                       <
                                                        <
                                                         <
                                                          <
                                                           <'0', '1', '0x0303', ~tid, '0', $cipher_suites, 
                                                            '0', <'43', '0x0304'>, <'10', $g1, $g>, 
                                                            <'40', $g1, $g1^~x>, <'45', '0', '1'>, 
                                                            <'42', '0'>, '41', 
                                                            <~ticket, mask(~ticket_age_add, $ticket_age)>, 
                                                            hmac(<
                                                                  Expand(Expand(Extract(~res_psk, '0'),
                                                                                <'ext', 'pbk'>, '32'),
                                                                         <'0', '0'>, '32'), 
                                                                  h(<'0', '1', '0x0303', ~tid, '0', 
                                                                     $cipher_suites, '0', <'43', '0x0304'>, 
                                                                     <'10', $g1, $g>, <'40', $g1, $g1^~x>, 
                                                                     <'45', '0', '1'>, <'42', '0'>, '41', 
                                                                     <~ticket, 
                                                                      mask(~ticket_age_add, $ticket_age)>, 
                                                                     '0'>)
                                                                 >)
                                                           >, 
                                                           '6', '0x0303', '40', $g>, 
                                                          '1', '0x0303', ~new_nc, '0', $cipher_suites.1, '0', 
                                                          <'43', '0x0304'>, <'10', $g1, $g>, 
                                                          <'40', $g, $g^~x.1>, <'45', '0', '1'>, '0', '41', 
                                                          <~ticket, mask(~ticket_age_add, '1')>, 
                                                          hmac(<
                                                                Expand(Expand(Extract(~res_psk, '0'),
                                                                              <'ext', 'pbk'>, '32'),
                                                                       <'0', '0'>, '32'), 
                                                                h(<
                                                                   <
                                                                    <'0', '1', '0x0303', ~tid, '0', 
                                                                     $cipher_suites, '0', <'43', '0x0304'>, 
                                                                     <'10', $g1, $g>, <'40', $g1, $g1^~x>, 
                                                                     <'45', '0', '1'>, <'42', '0'>, '41', 
                                                                     <~ticket, 
                                                                      mask(~ticket_age_add, $ticket_age)>, 
                                                                     hmac(<
                                                                           Expand(Expand(Extract(~res_psk,
                                                                                                 '0'),
                                                                                         <'ext', 'pbk'>,
                                                                                         '32'),
                                                                                  <'0', '0'>, '32'), 
                                                                           h(<'0', '1', '0x0303', ~tid, '0', 
                                                                              $cipher_suites, '0', 
                                                                              <'43', '0x0304'>, 
                                                                              <'10', $g1, $g>, 
                                                                              <'40', $g1, $g1^~x>, 
                                                                              <'45', '0', '1'>, <'42', '0'>, 
                                                                              '41', 
                                                                              <~ticket, 
                                                                               mask(~ticket_age_add,
                                                                                    $ticket_age)
                                                                              >, 
                                                                              '0'>)
                                                                          >)
                                                                    >, 
                                                                    '6', '0x0303', '40', $g>, 
                                                                   '1', '0x0303', ~new_nc, '0', 
                                                                   $cipher_suites.1, '0', <'43', '0x0304'>, 
                                                                   <'10', $g1, $g>, <'40', $g, $g^~x.1>, 
                                                                   <'45', '0', '1'>, '0', '41', 
                                                                   <~ticket, mask(~ticket_age_add, '1')>, '0'
                                                                  >)
                                                               >)
                                                         >, 
                                                         '2', '0x0303', p_ns, $cipher_suite, 
                                                         <'13', $sig_algs>, '40', $g, p_gy>, 
                                                        '8', $exts>, 
                                                       '11', '0', pk(~ltkS)>, 
                                                      '15', 
                                                      sign(<'server_cv', 
                                                            h(<
                                                               <
                                                                <
                                                                 <
                                                                  <
                                                                   <'0', '1', '0x0303', ~tid, '0', 
                                                                    $cipher_suites, '0', <'43', '0x0304'>, 
                                                                    <'10', $g1, $g>, <'40', $g1, $g1^~x>, 
                                                                    <'45', '0', '1'>, <'42', '0'>, '41', 
                                                                    <~ticket, 
                                                                     mask(~ticket_age_add, $ticket_age)>, 
                                                                    hmac(<
                                                                          Expand(Expand(Extract(~res_psk,
                                                                                                '0'),
                                                                                        <'ext', 'pbk'>, '32'),
                                                                                 <'0', '0'>, '32'), 
                                                                          h(<'0', '1', '0x0303', ~tid, '0', 
                                                                             $cipher_suites, '0', 
                                                                             <'43', '0x0304'>, 
                                                                             <'10', $g1, $g>, 
                                                                             <'40', $g1, $g1^~x>, 
                                                                             <'45', '0', '1'>, <'42', '0'>, 
                                                                             '41', 
                                                                             <~ticket, 
                                                                              mask(~ticket_age_add,
                                                                                   $ticket_age)
                                                                             >, 
                                                                             '0'>)
                                                                         >)
                                                                   >, 
                                                                   '6', '0x0303', '40', $g>, 
                                                                  '1', '0x0303', ~new_nc, '0', 
                                                                  $cipher_suites.1, '0', <'43', '0x0304'>, 
                                                                  <'10', $g1, $g>, <'40', $g, $g^~x.1>, 
                                                                  <'45', '0', '1'>, '0', '41', 
                                                                  <~ticket, mask(~ticket_age_add, '1')>, 
                                                                  hmac(<
                                                                        Expand(Expand(Extract(~res_psk, '0'),
                                                                                      <'ext', 'pbk'>, '32'),
                                                                               <'0', '0'>, '32'), 
                                                                        h(<
                                                                           <
                                                                            <'0', '1', '0x0303', ~tid, '0', 
                                                                             $cipher_suites, '0', 
                                                                             <'43', '0x0304'>, 
                                                                             <'10', $g1, $g>, 
                                                                             <'40', $g1, $g1^~x>, 
                                                                             <'45', '0', '1'>, <'42', '0'>, 
                                                                             '41', 
                                                                             <~ticket, 
                                                                              mask(~ticket_age_add,
                                                                                   $ticket_age)
                                                                             >, 
                                                                             hmac(<
                                                                                   Expand(Expand(Extract(~res_psk,
                                                                                                         '0'),
                                                                                                 <'ext', 'pbk'
                                                                                                 >,
                                                                                                 '32'),
                                                                                          <'0', '0'>, '32'), 
                                                                                   h(<'0', '1', '0x0303', 
                                                                                      ~tid, '0', 
                                                                                      $cipher_suites, '0', 
                                                                                      <'43', '0x0304'>, 
                                                                                      <'10', $g1, $g>, 
                                                                                      <'40', $g1, $g1^~x>, 
                                                                                      <'45', '0', '1'>, 
                                                                                      <'42', '0'>, '41', 
                                                                                      <~ticket, 
                                                                                       mask(~ticket_age_add,
                                                                                            $ticket_age)
                                                                                      >, 
                                                                                      '0'>)
                                                                                  >)
                                                                            >, 
                                                                            '6', '0x0303', '40', $g>, 
                                                                           '1', '0x0303', ~new_nc, '0', 
                                                                           $cipher_suites.1, '0', 
                                                                           <'43', '0x0304'>, <'10', $g1, $g>, 
                                                                           <'40', $g, $g^~x.1>, 
                                                                           <'45', '0', '1'>, '0', '41', 
                                                                           <~ticket, 
                                                                            mask(~ticket_age_add, '1')>, 
                                                                           '0'>)
                                                                       >)
                                                                 >, 
                                                                 '2', '0x0303', p_ns, $cipher_suite, 
                                                                 <'13', $sig_algs>, '40', $g, p_gy>, 
                                                                '8', $exts>, 
                                                               '11', '0', pk(~ltkS)>)
                                                           >,
                                                           ~ltkS)
                                                     >)
                                                  >)
                                            >)
                                         >,
                                         '32'),
                                  <'adke_wk', '0'>, '32')
                ) ▶₀ #l )
    next
      case recv_server_auth_case_08
      by solve( SecretPSK( $A,
                           Expand(Expand(Extract('0',
                                                 Extract(p_gxy,
                                                         Extract(Expand(ms, <'rms', h(messages)>, '32'),
                                                                 '0'))),
                                         <'serverats', 
                                          h(<
                                             <
                                              <
                                               <
                                                <
                                                 <
                                                  <
                                                   <'0', '1', '0x0303', ~tid, '0', $cipher_suites, '0', 
                                                    <'43', '0x0304'>, <'10', $g1, $g>, <'40', $g1, $g1^~x>, 
                                                    <'45', '0', '1'>, <'42', '0'>, '41', 
                                                    <p_psk_id, mask(ticket_age_add, $ticket_age)>, 
                                                    hmac(<
                                                          Expand(Expand(Extract(Expand(ms,
                                                                                       <'rms', h(messages)>,
                                                                                       '32'),
                                                                                '0'),
                                                                        <'res', 'pbk'>, '32'),
                                                                 <'0', '0'>, '32'), 
                                                          h(<'0', '1', '0x0303', ~tid, '0', $cipher_suites, 
                                                             '0', <'43', '0x0304'>, <'10', $g1, $g>, 
                                                             <'40', $g1, $g1^~x>, <'45', '0', '1'>, 
                                                             <'42', '0'>, '41', 
                                                             <p_psk_id, mask(ticket_age_add, $ticket_age)>, 
                                                             '0'>)
                                                         >)
                                                   >, 
                                                   '6', '0x0303', '40', $g>, 
                                                  '1', '0x0303', ~new_nc, '0', $cipher_suites.1, '0', 
                                                  <'43', '0x0304'>, <'10', $g1, $g>, <'40', $g, $g^~x.1>, 
                                                  <'45', '0', '1'>, '0', '41', 
                                                  <p_psk_id, mask(ticket_age_add, '1')>, 
                                                  hmac(<
                                                        Expand(Expand(Extract(Expand(ms, <'rms', h(messages)>,
                                                                                     '32'),
                                                                              '0'),
                                                                      <'res', 'pbk'>, '32'),
                                                               <'0', '0'>, '32'), 
                                                        h(<
                                                           <
                                                            <'0', '1', '0x0303', ~tid, '0', $cipher_suites, 
                                                             '0', <'43', '0x0304'>, <'10', $g1, $g>, 
                                                             <'40', $g1, $g1^~x>, <'45', '0', '1'>, 
                                                             <'42', '0'>, '41', 
                                                             <p_psk_id, mask(ticket_age_add, $ticket_age)>, 
                                                             hmac(<
                                                                   Expand(Expand(Extract(Expand(ms,
                                                                                                <'rms', 
                                                                                                 h(messages)>,
                                                                                                '32'),
                                                                                         '0'),
                                                                                 <'res', 'pbk'>, '32'),
                                                                          <'0', '0'>, '32'), 
                                                                   h(<'0', '1', '0x0303', ~tid, '0', 
                                                                      $cipher_suites, '0', <'43', '0x0304'>, 
                                                                      <'10', $g1, $g>, <'40', $g1, $g1^~x>, 
                                                                      <'45', '0', '1'>, <'42', '0'>, '41', 
                                                                      <p_psk_id, 
                                                                       mask(ticket_age_add, $ticket_age)>, 
                                                                      '0'>)
                                                                  >)
                                                            >, 
                                                            '6', '0x0303', '40', $g>, 
                                                           '1', '0x0303', ~new_nc, '0', $cipher_suites.1, 
                                                           '0', <'43', '0x0304'>, <'10', $g1, $g>, 
                                                           <'40', $g, $g^~x.1>, <'45', '0', '1'>, '0', '41', 
                                                           <p_psk_id, mask(ticket_age_add, '1')>, '0'>)
                                                       >)
                                                 >, 
                                                 '2', '0x0303', p_ns, $cipher_suite, <'13', $sig_algs>, '40', 
                                                 $g, p_gy>, 
                                                '8', $exts>, 
                                               '11', '0', pk(~ltkS)>, 
                                              '15', 
                                              sign(<'server_cv', 
                                                    h(<
                                                       <
                                                        <
                                                         <
                                                          <
                                                           <'0', '1', '0x0303', ~tid, '0', $cipher_suites, 
                                                            '0', <'43', '0x0304'>, <'10', $g1, $g>, 
                                                            <'40', $g1, $g1^~x>, <'45', '0', '1'>, 
                                                            <'42', '0'>, '41', 
                                                            <p_psk_id, mask(ticket_age_add, $ticket_age)>, 
                                                            hmac(<
                                                                  Expand(Expand(Extract(Expand(ms,
                                                                                               <'rms', 
                                                                                                h(messages)>,
                                                                                               '32'),
                                                                                        '0'),
                                                                                <'res', 'pbk'>, '32'),
                                                                         <'0', '0'>, '32'), 
                                                                  h(<'0', '1', '0x0303', ~tid, '0', 
                                                                     $cipher_suites, '0', <'43', '0x0304'>, 
                                                                     <'10', $g1, $g>, <'40', $g1, $g1^~x>, 
                                                                     <'45', '0', '1'>, <'42', '0'>, '41', 
                                                                     <p_psk_id, 
                                                                      mask(ticket_age_add, $ticket_age)>, 
                                                                     '0'>)
                                                                 >)
                                                           >, 
                                                           '6', '0x0303', '40', $g>, 
                                                          '1', '0x0303', ~new_nc, '0', $cipher_suites.1, '0', 
                                                          <'43', '0x0304'>, <'10', $g1, $g>, 
                                                          <'40', $g, $g^~x.1>, <'45', '0', '1'>, '0', '41', 
                                                          <p_psk_id, mask(ticket_age_add, '1')>, 
                                                          hmac(<
                                                                Expand(Expand(Extract(Expand(ms,
                                                                                             <'rms', 
                                                                                              h(messages)>,
                                                                                             '32'),
                                                                                      '0'),
                                                                              <'res', 'pbk'>, '32'),
                                                                       <'0', '0'>, '32'), 
                                                                h(<
                                                                   <
                                                                    <'0', '1', '0x0303', ~tid, '0', 
                                                                     $cipher_suites, '0', <'43', '0x0304'>, 
                                                                     <'10', $g1, $g>, <'40', $g1, $g1^~x>, 
                                                                     <'45', '0', '1'>, <'42', '0'>, '41', 
                                                                     <p_psk_id, 
                                                                      mask(ticket_age_add, $ticket_age)>, 
                                                                     hmac(<
                                                                           Expand(Expand(Extract(Expand(ms,
                                                                                                        <
                                                                                                         'rms', 
                                                                                                         h(messages)
                                                                                                        >,
                                                                                                        '32'),
                                                                                                 '0'),
                                                                                         <'res', 'pbk'>,
                                                                                         '32'),
                                                                                  <'0', '0'>, '32'), 
                                                                           h(<'0', '1', '0x0303', ~tid, '0', 
                                                                              $cipher_suites, '0', 
                                                                              <'43', '0x0304'>, 
                                                                              <'10', $g1, $g>, 
                                                                              <'40', $g1, $g1^~x>, 
                                                                              <'45', '0', '1'>, <'42', '0'>, 
                                                                              '41', 
                                                                              <p_psk_id, 
                                                                               mask(ticket_age_add,
                                                                                    $ticket_age)
                                                                              >, 
                                                                              '0'>)
                                                                          >)
                                                                    >, 
                                                                    '6', '0x0303', '40', $g>, 
                                                                   '1', '0x0303', ~new_nc, '0', 
                                                                   $cipher_suites.1, '0', <'43', '0x0304'>, 
                                                                   <'10', $g1, $g>, <'40', $g, $g^~x.1>, 
                                                                   <'45', '0', '1'>, '0', '41', 
                                                                   <p_psk_id, mask(ticket_age_add, '1')>, '0'
                                                                  >)
                                                               >)
                                                         >, 
                                                         '2', '0x0303', p_ns, $cipher_suite, 
                                                         <'13', $sig_algs>, '40', $g, p_gy>, 
                                                        '8', $exts>, 
                                                       '11', '0', pk(~ltkS)>)
                                                   >,
                                                   ~ltkS)
                                             >, 
                                             '20', 
                                             hmac(<
                                                   Expand(Expand(Extract(p_gxy,
                                                                         Extract(Expand(ms,
                                                                                        <'rms', h(messages)>,
                                                                                        '32'),
                                                                                 '0')),
                                                                 <'serverhts', 
                                                                  h(<
                                                                     <
                                                                      <
                                                                       <
                                                                        <
                                                                         <
                                                                          <'0', '1', '0x0303', ~tid, '0', 
                                                                           $cipher_suites, '0', 
                                                                           <'43', '0x0304'>, <'10', $g1, $g>, 
                                                                           <'40', $g1, $g1^~x>, 
                                                                           <'45', '0', '1'>, <'42', '0'>, 
                                                                           '41', 
                                                                           <p_psk_id, 
                                                                            mask(ticket_age_add, $ticket_age)
                                                                           >, 
                                                                           hmac(<
                                                                                 Expand(Expand(Extract(Expand(ms,
                                                                                                              <
                                                                                                               'rms', 
                                                                                                               h(messages)
                                                                                                              >,
                                                                                                              '32'),
                                                                                                       '0'),
                                                                                               <'res', 'pbk'>,
                                                                                               '32'),
                                                                                        <'0', '0'>, '32'), 
                                                                                 h(<'0', '1', '0x0303', ~tid, 
                                                                                    '0', $cipher_suites, '0', 
                                                                                    <'43', '0x0304'>, 
                                                                                    <'10', $g1, $g>, 
                                                                                    <'40', $g1, $g1^~x>, 
                                                                                    <'45', '0', '1'>, 
                                                                                    <'42', '0'>, '41', 
                                                                                    <p_psk_id, 
                                                                                     mask(ticket_age_add,
                                                                                          $ticket_age)
                                                                                    >, 
                                                                                    '0'>)
                                                                                >)
                                                                          >, 
                                                                          '6', '0x0303', '40', $g>, 
                                                                         '1', '0x0303', ~new_nc, '0', 
                                                                         $cipher_suites.1, '0', 
                                                                         <'43', '0x0304'>, <'10', $g1, $g>, 
                                                                         <'40', $g, $g^~x.1>, 
                                                                         <'45', '0', '1'>, '0', '41', 
                                                                         <p_psk_id, mask(ticket_age_add, '1')
                                                                         >, 
                                                                         hmac(<
                                                                               Expand(Expand(Extract(Expand(ms,
                                                                                                            <
                                                                                                             'rms', 
                                                                                                             h(messages)
                                                                                                            >,
                                                                                                            '32'),
                                                                                                     '0'),
                                                                                             <'res', 'pbk'>,
                                                                                             '32'),
                                                                                      <'0', '0'>, '32'), 
                                                                               h(<
                                                                                  <
                                                                                   <'0', '1', '0x0303', ~tid, 
                                                                                    '0', $cipher_suites, '0', 
                                                                                    <'43', '0x0304'>, 
                                                                                    <'10', $g1, $g>, 
                                                                                    <'40', $g1, $g1^~x>, 
                                                                                    <'45', '0', '1'>, 
                                                                                    <'42', '0'>, '41', 
                                                                                    <p_psk_id, 
                                                                                     mask(ticket_age_add,
                                                                                          $ticket_age)
                                                                                    >, 
                                                                                    hmac(<
                                                                                          Expand(Expand(Extract(Expand(ms,
                                                                                                                       <
                                                                                                                        'rms', 
                                                                                                                        h(messages)
                                                                                                                       >,
                                                                                                                       '32'),
                                                                                                                '0'),
                                                                                                        <
                                                                                                         'res', 
                                                                                                         'pbk'
                                                                                                        >,
                                                                                                        '32'),
                                                                                                 <'0', '0'>,
                                                                                                 '32'), 
                                                                                          h(<'0', '1', 
                                                                                             '0x0303', ~tid, 
                                                                                             '0', 
                                                                                             $cipher_suites, 
                                                                                             '0', 
                                                                                             <'43', '0x0304'
                                                                                             >, 
                                                                                             <'10', $g1, $g>, 
                                                                                             <'40', $g1, 
                                                                                              $g1^~x>, 
                                                                                             <'45', '0', '1'
                                                                                             >, 
                                                                                             <'42', '0'>, 
                                                                                             '41', 
                                                                                             <p_psk_id, 
                                                                                              mask(ticket_age_add,
                                                                                                   $ticket_age)
                                                                                             >, 
                                                                                             '0'>)
                                                                                         >)
                                                                                   >, 
                                                                                   '6', '0x0303', '40', $g>, 
                                                                                  '1', '0x0303', ~new_nc, 
                                                                                  '0', $cipher_suites.1, '0', 
                                                                                  <'43', '0x0304'>, 
                                                                                  <'10', $g1, $g>, 
                                                                                  <'40', $g, $g^~x.1>, 
                                                                                  <'45', '0', '1'>, '0', 
                                                                                  '41', 
                                                                                  <p_psk_id, 
                                                                                   mask(ticket_age_add, '1')
                                                                                  >, 
                                                                                  '0'>)
                                                                              >)
                                                                        >, 
                                                                        '2', '0x0303', p_ns, $cipher_suite, 
                                                                        <'13', $sig_algs>, '40', $g, p_gy>, 
                                                                       '8', $exts>, 
                                                                      '11', '0', pk(~ltkS)>, 
                                                                     '15', 
                                                                     sign(<'server_cv', 
                                                                           h(<
                                                                              <
                                                                               <
                                                                                <
                                                                                 <
                                                                                  <'0', '1', '0x0303', ~tid, 
                                                                                   '0', $cipher_suites, '0', 
                                                                                   <'43', '0x0304'>, 
                                                                                   <'10', $g1, $g>, 
                                                                                   <'40', $g1, $g1^~x>, 
                                                                                   <'45', '0', '1'>, 
                                                                                   <'42', '0'>, '41', 
                                                                                   <p_psk_id, 
                                                                                    mask(ticket_age_add,
                                                                                         $ticket_age)
                                                                                   >, 
                                                                                   hmac(<
                                                                                         Expand(Expand(Extract(Expand(ms,
                                                                                                                      <
                                                                                                                       'rms', 
                                                                                                                       h(messages)
                                                                                                                      >,
                                                                                                                      '32'),
                                                                                                               '0'),
                                                                                                       <
                                                                                                        'res', 
                                                                                                        'pbk'
                                                                                                       >,
                                                                                                       '32'),
                                                                                                <'0', '0'>,
                                                                                                '32'), 
                                                                                         h(<'0', '1', 
                                                                                            '0x0303', ~tid, 
                                                                                            '0', 
                                                                                            $cipher_suites, 
                                                                                            '0', 
                                                                                            <'43', '0x0304'>, 
                                                                                            <'10', $g1, $g>, 
                                                                                            <'40', $g1, $g1^~x
                                                                                            >, 
                                                                                            <'45', '0', '1'>, 
                                                                                            <'42', '0'>, 
                                                                                            '41', 
                                                                                            <p_psk_id, 
                                                                                             mask(ticket_age_add,
                                                                                                  $ticket_age)
                                                                                            >, 
                                                                                            '0'>)
                                                                                        >)
                                                                                  >, 
                                                                                  '6', '0x0303', '40', $g>, 
                                                                                 '1', '0x0303', ~new_nc, '0', 
                                                                                 $cipher_suites.1, '0', 
                                                                                 <'43', '0x0304'>, 
                                                                                 <'10', $g1, $g>, 
                                                                                 <'40', $g, $g^~x.1>, 
                                                                                 <'45', '0', '1'>, '0', '41', 
                                                                                 <p_psk_id, 
                                                                                  mask(ticket_age_add, '1')>, 
                                                                                 hmac(<
                                                                                       Expand(Expand(Extract(Expand(ms,
                                                                                                                    <
                                                                                                                     'rms', 
                                                                                                                     h(messages)
                                                                                                                    >,
                                                                                                                    '32'),
                                                                                                             '0'),
                                                                                                     <'res', 
                                                                                                      'pbk'>,
                                                                                                     '32'),
                                                                                              <'0', '0'>,
                                                                                              '32'), 
                                                                                       h(<
                                                                                          <
                                                                                           <'0', '1', 
                                                                                            '0x0303', ~tid, 
                                                                                            '0', 
                                                                                            $cipher_suites, 
                                                                                            '0', 
                                                                                            <'43', '0x0304'>, 
                                                                                            <'10', $g1, $g>, 
                                                                                            <'40', $g1, $g1^~x
                                                                                            >, 
                                                                                            <'45', '0', '1'>, 
                                                                                            <'42', '0'>, 
                                                                                            '41', 
                                                                                            <p_psk_id, 
                                                                                             mask(ticket_age_add,
                                                                                                  $ticket_age)
                                                                                            >, 
                                                                                            hmac(<
                                                                                                  Expand(Expand(Extract(Expand(ms,
                                                                                                                               <
                                                                                                                                'rms', 
                                                                                                                                h(messages)
                                                                                                                               >,
                                                                                                                               '32'),
                                                                                                                        '0'),
                                                                                                                <
                                                                                                                 'res', 
                                                                                                                 'pbk'
                                                                                                                >,
                                                                                                                '32'),
                                                                                                         <
                                                                                                          '0', 
                                                                                                          '0'
                                                                                                         >,
                                                                                                         '32'), 
                                                                                                  h(<'0', 
                                                                                                     '1', 
                                                                                                     '0x0303', 
                                                                                                     ~tid, 
                                                                                                     '0', 
                                                                                                     $cipher_suites, 
                                                                                                     '0', 
                                                                                                     <'43', 
                                                                                                      '0x0304'
                                                                                                     >, 
                                                                                                     <'10', 
                                                                                                      $g1, $g
                                                                                                     >, 
                                                                                                     <'40', 
                                                                                                      $g1, 
                                                                                                      $g1^~x
                                                                                                     >, 
                                                                                                     <'45', 
                                                                                                      '0', '1'
                                                                                                     >, 
                                                                                                     <'42', 
                                                                                                      '0'>, 
                                                                                                     '41', 
                                                                                                     <
                                                                                                      p_psk_id, 
                                                                                                      mask(ticket_age_add,
                                                                                                           $ticket_age)
                                                                                                     >, 
                                                                                                     '0'>)
                                                                                                 >)
                                                                                           >, 
                                                                                           '6', '0x0303', 
                                                                                           '40', $g>, 
                                                                                          '1', '0x0303', 
                                                                                          ~new_nc, '0', 
                                                                                          $cipher_suites.1, 
                                                                                          '0', 
                                                                                          <'43', '0x0304'>, 
                                                                                          <'10', $g1, $g>, 
                                                                                          <'40', $g, $g^~x.1
                                                                                          >, 
                                                                                          <'45', '0', '1'>, 
                                                                                          '0', '41', 
                                                                                          <p_psk_id, 
                                                                                           mask(ticket_age_add,
                                                                                                '1')
                                                                                          >, 
                                                                                          '0'>)
                                                                                      >)
                                                                                >, 
                                                                                '2', '0x0303', p_ns, 
                                                                                $cipher_suite, 
                                                                                <'13', $sig_algs>, '40', $g, 
                                                                                p_gy>, 
                                                                               '8', $exts>, 
                                                                              '11', '0', pk(~ltkS)>)
                                                                          >,
                                                                          ~ltkS)
                                                                    >)
                                                                 >,
                                                                 '32'),
                                                          <'fin', '0'>, '32'), 
                                                   h(<
                                                      <
                                                       <
                                                        <
                                                         <
                                                          <
                                                           <'0', '1', '0x0303', ~tid, '0', $cipher_suites, 
                                                            '0', <'43', '0x0304'>, <'10', $g1, $g>, 
                                                            <'40', $g1, $g1^~x>, <'45', '0', '1'>, 
                                                            <'42', '0'>, '41', 
                                                            <p_psk_id, mask(ticket_age_add, $ticket_age)>, 
                                                            hmac(<
                                                                  Expand(Expand(Extract(Expand(ms,
                                                                                               <'rms', 
                                                                                                h(messages)>,
                                                                                               '32'),
                                                                                        '0'),
                                                                                <'res', 'pbk'>, '32'),
                                                                         <'0', '0'>, '32'), 
                                                                  h(<'0', '1', '0x0303', ~tid, '0', 
                                                                     $cipher_suites, '0', <'43', '0x0304'>, 
                                                                     <'10', $g1, $g>, <'40', $g1, $g1^~x>, 
                                                                     <'45', '0', '1'>, <'42', '0'>, '41', 
                                                                     <p_psk_id, 
                                                                      mask(ticket_age_add, $ticket_age)>, 
                                                                     '0'>)
                                                                 >)
                                                           >, 
                                                           '6', '0x0303', '40', $g>, 
                                                          '1', '0x0303', ~new_nc, '0', $cipher_suites.1, '0', 
                                                          <'43', '0x0304'>, <'10', $g1, $g>, 
                                                          <'40', $g, $g^~x.1>, <'45', '0', '1'>, '0', '41', 
                                                          <p_psk_id, mask(ticket_age_add, '1')>, 
                                                          hmac(<
                                                                Expand(Expand(Extract(Expand(ms,
                                                                                             <'rms', 
                                                                                              h(messages)>,
                                                                                             '32'),
                                                                                      '0'),
                                                                              <'res', 'pbk'>, '32'),
                                                                       <'0', '0'>, '32'), 
                                                                h(<
                                                                   <
                                                                    <'0', '1', '0x0303', ~tid, '0', 
                                                                     $cipher_suites, '0', <'43', '0x0304'>, 
                                                                     <'10', $g1, $g>, <'40', $g1, $g1^~x>, 
                                                                     <'45', '0', '1'>, <'42', '0'>, '41', 
                                                                     <p_psk_id, 
                                                                      mask(ticket_age_add, $ticket_age)>, 
                                                                     hmac(<
                                                                           Expand(Expand(Extract(Expand(ms,
                                                                                                        <
                                                                                                         'rms', 
                                                                                                         h(messages)
                                                                                                        >,
                                                                                                        '32'),
                                                                                                 '0'),
                                                                                         <'res', 'pbk'>,
                                                                                         '32'),
                                                                                  <'0', '0'>, '32'), 
                                                                           h(<'0', '1', '0x0303', ~tid, '0', 
                                                                              $cipher_suites, '0', 
                                                                              <'43', '0x0304'>, 
                                                                              <'10', $g1, $g>, 
                                                                              <'40', $g1, $g1^~x>, 
                                                                              <'45', '0', '1'>, <'42', '0'>, 
                                                                              '41', 
                                                                              <p_psk_id, 
                                                                               mask(ticket_age_add,
                                                                                    $ticket_age)
                                                                              >, 
                                                                              '0'>)
                                                                          >)
                                                                    >, 
                                                                    '6', '0x0303', '40', $g>, 
                                                                   '1', '0x0303', ~new_nc, '0', 
                                                                   $cipher_suites.1, '0', <'43', '0x0304'>, 
                                                                   <'10', $g1, $g>, <'40', $g, $g^~x.1>, 
                                                                   <'45', '0', '1'>, '0', '41', 
                                                                   <p_psk_id, mask(ticket_age_add, '1')>, '0'
                                                                  >)
                                                               >)
                                                         >, 
                                                         '2', '0x0303', p_ns, $cipher_suite, 
                                                         <'13', $sig_algs>, '40', $g, p_gy>, 
                                                        '8', $exts>, 
                                                       '11', '0', pk(~ltkS)>, 
                                                      '15', 
                                                      sign(<'server_cv', 
                                                            h(<
                                                               <
                                                                <
                                                                 <
                                                                  <
                                                                   <'0', '1', '0x0303', ~tid, '0', 
                                                                    $cipher_suites, '0', <'43', '0x0304'>, 
                                                                    <'10', $g1, $g>, <'40', $g1, $g1^~x>, 
                                                                    <'45', '0', '1'>, <'42', '0'>, '41', 
                                                                    <p_psk_id, 
                                                                     mask(ticket_age_add, $ticket_age)>, 
                                                                    hmac(<
                                                                          Expand(Expand(Extract(Expand(ms,
                                                                                                       <
                                                                                                        'rms', 
                                                                                                        h(messages)
                                                                                                       >,
                                                                                                       '32'),
                                                                                                '0'),
                                                                                        <'res', 'pbk'>, '32'),
                                                                                 <'0', '0'>, '32'), 
                                                                          h(<'0', '1', '0x0303', ~tid, '0', 
                                                                             $cipher_suites, '0', 
                                                                             <'43', '0x0304'>, 
                                                                             <'10', $g1, $g>, 
                                                                             <'40', $g1, $g1^~x>, 
                                                                             <'45', '0', '1'>, <'42', '0'>, 
                                                                             '41', 
                                                                             <p_psk_id, 
                                                                              mask(ticket_age_add,
                                                                                   $ticket_age)
                                                                             >, 
                                                                             '0'>)
                                                                         >)
                                                                   >, 
                                                                   '6', '0x0303', '40', $g>, 
                                                                  '1', '0x0303', ~new_nc, '0', 
                                                                  $cipher_suites.1, '0', <'43', '0x0304'>, 
                                                                  <'10', $g1, $g>, <'40', $g, $g^~x.1>, 
                                                                  <'45', '0', '1'>, '0', '41', 
                                                                  <p_psk_id, mask(ticket_age_add, '1')>, 
                                                                  hmac(<
                                                                        Expand(Expand(Extract(Expand(ms,
                                                                                                     <'rms', 
                                                                                                      h(messages)
                                                                                                     >,
                                                                                                     '32'),
                                                                                              '0'),
                                                                                      <'res', 'pbk'>, '32'),
                                                                               <'0', '0'>, '32'), 
                                                                        h(<
                                                                           <
                                                                            <'0', '1', '0x0303', ~tid, '0', 
                                                                             $cipher_suites, '0', 
                                                                             <'43', '0x0304'>, 
                                                                             <'10', $g1, $g>, 
                                                                             <'40', $g1, $g1^~x>, 
                                                                             <'45', '0', '1'>, <'42', '0'>, 
                                                                             '41', 
                                                                             <p_psk_id, 
                                                                              mask(ticket_age_add,
                                                                                   $ticket_age)
                                                                             >, 
                                                                             hmac(<
                                                                                   Expand(Expand(Extract(Expand(ms,
                                                                                                                <
                                                                                                                 'rms', 
                                                                                                                 h(messages)
                                                                                                                >,
                                                                                                                '32'),
                                                                                                         '0'),
                                                                                                 <'res', 'pbk'
                                                                                                 >,
                                                                                                 '32'),
                                                                                          <'0', '0'>, '32'), 
                                                                                   h(<'0', '1', '0x0303', 
                                                                                      ~tid, '0', 
                                                                                      $cipher_suites, '0', 
                                                                                      <'43', '0x0304'>, 
                                                                                      <'10', $g1, $g>, 
                                                                                      <'40', $g1, $g1^~x>, 
                                                                                      <'45', '0', '1'>, 
                                                                                      <'42', '0'>, '41', 
                                                                                      <p_psk_id, 
                                                                                       mask(ticket_age_add,
                                                                                            $ticket_age)
                                                                                      >, 
                                                                                      '0'>)
                                                                                  >)
                                                                            >, 
                                                                            '6', '0x0303', '40', $g>, 
                                                                           '1', '0x0303', ~new_nc, '0', 
                                                                           $cipher_suites.1, '0', 
                                                                           <'43', '0x0304'>, <'10', $g1, $g>, 
                                                                           <'40', $g, $g^~x.1>, 
                                                                           <'45', '0', '1'>, '0', '41', 
                                                                           <p_psk_id, 
                                                                            mask(ticket_age_add, '1')>, 
                                                                           '0'>)
                                                                       >)
                                                                 >, 
                                                                 '2', '0x0303', p_ns, $cipher_suite, 
                                                                 <'13', $sig_algs>, '40', $g, p_gy>, 
                                                                '8', $exts>, 
                                                               '11', '0', pk(~ltkS)>)
                                                           >,
                                                           ~ltkS)
                                                     >)
                                                  >)
                                            >)
                                         >,
                                         '32'),
                                  <'adke_wk', '0'>, '32')
                ) ▶₀ #l )
    next
      case recv_server_auth_case_09
      by contradiction /* from formulas */
    next
      case recv_server_auth_case_10
      by contradiction /* from formulas */
    next
      case recv_server_auth_case_11
      by contradiction /* from formulas */
    next
      case recv_server_auth_case_12
      by contradiction /* from formulas */
    next
      case recv_server_auth_case_13
      by contradiction /* from formulas */
    next
      case recv_server_auth_case_14
      by contradiction /* from formulas */
    next
      case recv_server_auth_case_15
      by contradiction /* from formulas */
    next
      case recv_server_auth_case_16
      by contradiction /* from formulas */
    next
      case recv_server_auth_psk_case_1
      by solve( SecretPSK( $A,
                           Expand(Expand(Extract('0',
                                                 Extract(p_gxy,
                                                         Extract(Expand(ms, <'rms', h(messages)>, '32'),
                                                                 '0'))),
                                         <'serverats', 
                                          h(<
                                             <
                                              <
                                               <'0', '1', '0x0303', ~tid, '0', $cipher_suites, '0', 
                                                <'43', '0x0304'>, <'10', $g, $g2>, <'40', $g, $g^~x>, 
                                                <'45', '0', '1'>, <'42', '0'>, '41', 
                                                <~ticket, mask(ticket_age_add, $ticket_age)>, 
                                                hmac(<
                                                      Expand(Expand(Extract(Expand(ms, <'rms', h(messages)>,
                                                                                   '32'),
                                                                            '0'),
                                                                    <'res', 'pbk'>, '32'),
                                                             <'0', '0'>, '32'), 
                                                      h(<'0', '1', '0x0303', ~tid, '0', $cipher_suites, '0', 
                                                         <'43', '0x0304'>, <'10', $g, $g2>, 
                                                         <'40', $g, $g^~x>, <'45', '0', '1'>, <'42', '0'>, 
                                                         '41', <~ticket, mask(ticket_age_add, $ticket_age)>, 
                                                         '0'>)
                                                     >)
                                               >, 
                                               '2', '0x0303', p_ns, $cipher_suite, <'13', $sig_algs>, 
                                               <'40', $g, p_gy>, <'41', '0'>, '42', '0'>, 
                                              '8', $exts>, 
                                             '20', 
                                             hmac(<
                                                   Expand(Expand(Extract(p_gxy,
                                                                         Extract(Expand(ms,
                                                                                        <'rms', h(messages)>,
                                                                                        '32'),
                                                                                 '0')),
                                                                 <'serverhts', 
                                                                  h(<
                                                                     <
                                                                      <'0', '1', '0x0303', ~tid, '0', 
                                                                       $cipher_suites, '0', <'43', '0x0304'>, 
                                                                       <'10', $g, $g2>, <'40', $g, $g^~x>, 
                                                                       <'45', '0', '1'>, <'42', '0'>, '41', 
                                                                       <~ticket, 
                                                                        mask(ticket_age_add, $ticket_age)>, 
                                                                       hmac(<
                                                                             Expand(Expand(Extract(Expand(ms,
                                                                                                          <
                                                                                                           'rms', 
                                                                                                           h(messages)
                                                                                                          >,
                                                                                                          '32'),
                                                                                                   '0'),
                                                                                           <'res', 'pbk'>,
                                                                                           '32'),
                                                                                    <'0', '0'>, '32'), 
                                                                             h(<'0', '1', '0x0303', ~tid, 
                                                                                '0', $cipher_suites, '0', 
                                                                                <'43', '0x0304'>, 
                                                                                <'10', $g, $g2>, 
                                                                                <'40', $g, $g^~x>, 
                                                                                <'45', '0', '1'>, 
                                                                                <'42', '0'>, '41', 
                                                                                <~ticket, 
                                                                                 mask(ticket_age_add,
                                                                                      $ticket_age)
                                                                                >, 
                                                                                '0'>)
                                                                            >)
                                                                      >, 
                                                                      '2', '0x0303', p_ns, $cipher_suite, 
                                                                      <'13', $sig_algs>, <'40', $g, p_gy>, 
                                                                      <'41', '0'>, '42', '0'>, 
                                                                     '8', $exts>)
                                                                 >,
                                                                 '32'),
                                                          <'fin', '0'>, '32'), 
                                                   h(<
                                                      <
                                                       <'0', '1', '0x0303', ~tid, '0', $cipher_suites, '0', 
                                                        <'43', '0x0304'>, <'10', $g, $g2>, <'40', $g, $g^~x>, 
                                                        <'45', '0', '1'>, <'42', '0'>, '41', 
                                                        <~ticket, mask(ticket_age_add, $ticket_age)>, 
                                                        hmac(<
                                                              Expand(Expand(Extract(Expand(ms,
                                                                                           <'rms', h(messages)
                                                                                           >,
                                                                                           '32'),
                                                                                    '0'),
                                                                            <'res', 'pbk'>, '32'),
                                                                     <'0', '0'>, '32'), 
                                                              h(<'0', '1', '0x0303', ~tid, '0', 
                                                                 $cipher_suites, '0', <'43', '0x0304'>, 
                                                                 <'10', $g, $g2>, <'40', $g, $g^~x>, 
                                                                 <'45', '0', '1'>, <'42', '0'>, '41', 
                                                                 <~ticket, mask(ticket_age_add, $ticket_age)
                                                                 >, 
                                                                 '0'>)
                                                             >)
                                                       >, 
                                                       '2', '0x0303', p_ns, $cipher_suite, <'13', $sig_algs>, 
                                                       <'40', $g, p_gy>, <'41', '0'>, '42', '0'>, 
                                                      '8', $exts>)
                                                  >)
                                            >)
                                         >,
                                         '32'),
                                  <'adke_wk', '0'>, '32')
                ) ▶₀ #l )
    next
      case recv_server_auth_psk_case_2
      by solve( SecretPSK( $A,
                           Expand(Expand(Extract('0',
                                                 Extract(p_gxy,
                                                         Extract(Expand(ms, <'rms', h(messages)>, '32'),
                                                                 '0'))),
                                         <'serverats', 
                                          h(<
                                             <
                                              <
                                               <
                                                <
                                                 <'0', '1', '0x0303', ~tid, '0', $cipher_suites, '0', 
                                                  <'43', '0x0304'>, <'10', $g1, $g>, <'40', $g1, $g1^~x>, 
                                                  <'45', '0', '1'>, <'42', '0'>, '41', 
                                                  <~ticket, mask(ticket_age_add, $ticket_age)>, 
                                                  hmac(<
                                                        Expand(Expand(Extract(Expand(ms, <'rms', h(messages)>,
                                                                                     '32'),
                                                                              '0'),
                                                                      <'res', 'pbk'>, '32'),
                                                               <'0', '0'>, '32'), 
                                                        h(<'0', '1', '0x0303', ~tid, '0', $cipher_suites, 
                                                           '0', <'43', '0x0304'>, <'10', $g1, $g>, 
                                                           <'40', $g1, $g1^~x>, <'45', '0', '1'>, 
                                                           <'42', '0'>, '41', 
                                                           <~ticket, mask(ticket_age_add, $ticket_age)>, '0'>)
                                                       >)
                                                 >, 
                                                 '6', '0x0303', '40', $g>, 
                                                '1', '0x0303', ~new_nc, '0', $cipher_suites.1, '0', 
                                                <'43', '0x0304'>, <'10', $g1, $g>, <'40', $g, $g^~x.1>, 
                                                <'45', '0', '1'>, '0', '41', 
                                                <~ticket, mask(ticket_age_add, '1')>, 
                                                hmac(<
                                                      Expand(Expand(Extract(Expand(ms, <'rms', h(messages)>,
                                                                                   '32'),
                                                                            '0'),
                                                                    <'res', 'pbk'>, '32'),
                                                             <'0', '0'>, '32'), 
                                                      h(<
                                                         <
                                                          <'0', '1', '0x0303', ~tid, '0', $cipher_suites, 
                                                           '0', <'43', '0x0304'>, <'10', $g1, $g>, 
                                                           <'40', $g1, $g1^~x>, <'45', '0', '1'>, 
                                                           <'42', '0'>, '41', 
                                                           <~ticket, mask(ticket_age_add, $ticket_age)>, 
                                                           hmac(<
                                                                 Expand(Expand(Extract(Expand(ms,
                                                                                              <'rms', 
                                                                                               h(messages)>,
                                                                                              '32'),
                                                                                       '0'),
                                                                               <'res', 'pbk'>, '32'),
                                                                        <'0', '0'>, '32'), 
                                                                 h(<'0', '1', '0x0303', ~tid, '0', 
                                                                    $cipher_suites, '0', <'43', '0x0304'>, 
                                                                    <'10', $g1, $g>, <'40', $g1, $g1^~x>, 
                                                                    <'45', '0', '1'>, <'42', '0'>, '41', 
                                                                    <~ticket, 
                                                                     mask(ticket_age_add, $ticket_age)>, 
                                                                    '0'>)
                                                                >)
                                                          >, 
                                                          '6', '0x0303', '40', $g>, 
                                                         '1', '0x0303', ~new_nc, '0', $cipher_suites.1, '0', 
                                                         <'43', '0x0304'>, <'10', $g1, $g>, 
                                                         <'40', $g, $g^~x.1>, <'45', '0', '1'>, '0', '41', 
                                                         <~ticket, mask(ticket_age_add, '1')>, '0'>)
                                                     >)
                                               >, 
                                               '2', '0x0303', p_ns, $cipher_suite, <'13', $sig_algs>, 
                                               <'40', $g, p_gy>, <'41', '0'>, '0'>, 
                                              '8', $exts>, 
                                             '20', 
                                             hmac(<
                                                   Expand(Expand(Extract(p_gxy,
                                                                         Extract(Expand(ms,
                                                                                        <'rms', h(messages)>,
                                                                                        '32'),
                                                                                 '0')),
                                                                 <'serverhts', 
                                                                  h(<
                                                                     <
                                                                      <
                                                                       <
                                                                        <'0', '1', '0x0303', ~tid, '0', 
                                                                         $cipher_suites, '0', 
                                                                         <'43', '0x0304'>, <'10', $g1, $g>, 
                                                                         <'40', $g1, $g1^~x>, 
                                                                         <'45', '0', '1'>, <'42', '0'>, '41', 
                                                                         <~ticket, 
                                                                          mask(ticket_age_add, $ticket_age)>, 
                                                                         hmac(<
                                                                               Expand(Expand(Extract(Expand(ms,
                                                                                                            <
                                                                                                             'rms', 
                                                                                                             h(messages)
                                                                                                            >,
                                                                                                            '32'),
                                                                                                     '0'),
                                                                                             <'res', 'pbk'>,
                                                                                             '32'),
                                                                                      <'0', '0'>, '32'), 
                                                                               h(<'0', '1', '0x0303', ~tid, 
                                                                                  '0', $cipher_suites, '0', 
                                                                                  <'43', '0x0304'>, 
                                                                                  <'10', $g1, $g>, 
                                                                                  <'40', $g1, $g1^~x>, 
                                                                                  <'45', '0', '1'>, 
                                                                                  <'42', '0'>, '41', 
                                                                                  <~ticket, 
                                                                                   mask(ticket_age_add,
                                                                                        $ticket_age)
                                                                                  >, 
                                                                                  '0'>)
                                                                              >)
                                                                        >, 
                                                                        '6', '0x0303', '40', $g>, 
                                                                       '1', '0x0303', ~new_nc, '0', 
                                                                       $cipher_suites.1, '0', 
                                                                       <'43', '0x0304'>, <'10', $g1, $g>, 
                                                                       <'40', $g, $g^~x.1>, <'45', '0', '1'>, 
                                                                       '0', '41', 
                                                                       <~ticket, mask(ticket_age_add, '1')>, 
                                                                       hmac(<
                                                                             Expand(Expand(Extract(Expand(ms,
                                                                                                          <
                                                                                                           'rms', 
                                                                                                           h(messages)
                                                                                                          >,
                                                                                                          '32'),
                                                                                                   '0'),
                                                                                           <'res', 'pbk'>,
                                                                                           '32'),
                                                                                    <'0', '0'>, '32'), 
                                                                             h(<
                                                                                <
                                                                                 <'0', '1', '0x0303', ~tid, 
                                                                                  '0', $cipher_suites, '0', 
                                                                                  <'43', '0x0304'>, 
                                                                                  <'10', $g1, $g>, 
                                                                                  <'40', $g1, $g1^~x>, 
                                                                                  <'45', '0', '1'>, 
                                                                                  <'42', '0'>, '41', 
                                                                                  <~ticket, 
                                                                                   mask(ticket_age_add,
                                                                                        $ticket_age)
                                                                                  >, 
                                                                                  hmac(<
                                                                                        Expand(Expand(Extract(Expand(ms,
                                                                                                                     <
                                                                                                                      'rms', 
                                                                                                                      h(messages)
                                                                                                                     >,
                                                                                                                     '32'),
                                                                                                              '0'),
                                                                                                      <'res', 
                                                                                                       'pbk'>,
                                                                                                      '32'),
                                                                                               <'0', '0'>,
                                                                                               '32'), 
                                                                                        h(<'0', '1', 
                                                                                           '0x0303', ~tid, 
                                                                                           '0', 
                                                                                           $cipher_suites, 
                                                                                           '0', 
                                                                                           <'43', '0x0304'>, 
                                                                                           <'10', $g1, $g>, 
                                                                                           <'40', $g1, $g1^~x
                                                                                           >, 
                                                                                           <'45', '0', '1'>, 
                                                                                           <'42', '0'>, '41', 
                                                                                           <~ticket, 
                                                                                            mask(ticket_age_add,
                                                                                                 $ticket_age)
                                                                                           >, 
                                                                                           '0'>)
                                                                                       >)
                                                                                 >, 
                                                                                 '6', '0x0303', '40', $g>, 
                                                                                '1', '0x0303', ~new_nc, '0', 
                                                                                $cipher_suites.1, '0', 
                                                                                <'43', '0x0304'>, 
                                                                                <'10', $g1, $g>, 
                                                                                <'40', $g, $g^~x.1>, 
                                                                                <'45', '0', '1'>, '0', '41', 
                                                                                <~ticket, 
                                                                                 mask(ticket_age_add, '1')>, 
                                                                                '0'>)
                                                                            >)
                                                                      >, 
                                                                      '2', '0x0303', p_ns, $cipher_suite, 
                                                                      <'13', $sig_algs>, <'40', $g, p_gy>, 
                                                                      <'41', '0'>, '0'>, 
                                                                     '8', $exts>)
                                                                 >,
                                                                 '32'),
                                                          <'fin', '0'>, '32'), 
                                                   h(<
                                                      <
                                                       <
                                                        <
                                                         <'0', '1', '0x0303', ~tid, '0', $cipher_suites, '0', 
                                                          <'43', '0x0304'>, <'10', $g1, $g>, 
                                                          <'40', $g1, $g1^~x>, <'45', '0', '1'>, <'42', '0'>, 
                                                          '41', <~ticket, mask(ticket_age_add, $ticket_age)>, 
                                                          hmac(<
                                                                Expand(Expand(Extract(Expand(ms,
                                                                                             <'rms', 
                                                                                              h(messages)>,
                                                                                             '32'),
                                                                                      '0'),
                                                                              <'res', 'pbk'>, '32'),
                                                                       <'0', '0'>, '32'), 
                                                                h(<'0', '1', '0x0303', ~tid, '0', 
                                                                   $cipher_suites, '0', <'43', '0x0304'>, 
                                                                   <'10', $g1, $g>, <'40', $g1, $g1^~x>, 
                                                                   <'45', '0', '1'>, <'42', '0'>, '41', 
                                                                   <~ticket, mask(ticket_age_add, $ticket_age)
                                                                   >, 
                                                                   '0'>)
                                                               >)
                                                         >, 
                                                         '6', '0x0303', '40', $g>, 
                                                        '1', '0x0303', ~new_nc, '0', $cipher_suites.1, '0', 
                                                        <'43', '0x0304'>, <'10', $g1, $g>, 
                                                        <'40', $g, $g^~x.1>, <'45', '0', '1'>, '0', '41', 
                                                        <~ticket, mask(ticket_age_add, '1')>, 
                                                        hmac(<
                                                              Expand(Expand(Extract(Expand(ms,
                                                                                           <'rms', h(messages)
                                                                                           >,
                                                                                           '32'),
                                                                                    '0'),
                                                                            <'res', 'pbk'>, '32'),
                                                                     <'0', '0'>, '32'), 
                                                              h(<
                                                                 <
                                                                  <'0', '1', '0x0303', ~tid, '0', 
                                                                   $cipher_suites, '0', <'43', '0x0304'>, 
                                                                   <'10', $g1, $g>, <'40', $g1, $g1^~x>, 
                                                                   <'45', '0', '1'>, <'42', '0'>, '41', 
                                                                   <~ticket, mask(ticket_age_add, $ticket_age)
                                                                   >, 
                                                                   hmac(<
                                                                         Expand(Expand(Extract(Expand(ms,
                                                                                                      <'rms', 
                                                                                                       h(messages)
                                                                                                      >,
                                                                                                      '32'),
                                                                                               '0'),
                                                                                       <'res', 'pbk'>, '32'),
                                                                                <'0', '0'>, '32'), 
                                                                         h(<'0', '1', '0x0303', ~tid, '0', 
                                                                            $cipher_suites, '0', 
                                                                            <'43', '0x0304'>, 
                                                                            <'10', $g1, $g>, 
                                                                            <'40', $g1, $g1^~x>, 
                                                                            <'45', '0', '1'>, <'42', '0'>, 
                                                                            '41', 
                                                                            <~ticket, 
                                                                             mask(ticket_age_add, $ticket_age)
                                                                            >, 
                                                                            '0'>)
                                                                        >)
                                                                  >, 
                                                                  '6', '0x0303', '40', $g>, 
                                                                 '1', '0x0303', ~new_nc, '0', 
                                                                 $cipher_suites.1, '0', <'43', '0x0304'>, 
                                                                 <'10', $g1, $g>, <'40', $g, $g^~x.1>, 
                                                                 <'45', '0', '1'>, '0', '41', 
                                                                 <~ticket, mask(ticket_age_add, '1')>, '0'>)
                                                             >)
                                                       >, 
                                                       '2', '0x0303', p_ns, $cipher_suite, <'13', $sig_algs>, 
                                                       <'40', $g, p_gy>, <'41', '0'>, '0'>, 
                                                      '8', $exts>)
                                                  >)
                                            >)
                                         >,
                                         '32'),
                                  <'adke_wk', '0'>, '32')
                ) ▶₀ #l )
    next
      case recv_server_auth_psk_case_3
      by contradiction /* from formulas */
    next
      case recv_server_auth_psk_case_4
      by contradiction /* from formulas */
    next
      case recv_server_auth_psk_case_5
      by solve( SecretPSK( $A,
                           Expand(Expand(Extract('0',
                                                 Extract('0',
                                                         Extract(Expand(ms, <'rms', h(messages)>, '32'),
                                                                 '0'))),
                                         <'serverats', 
                                          h(<
                                             <
                                              <
                                               <'0', '1', '0x0303', ~tid, '0', $cipher_suites, '0', 
                                                <'43', '0x0304'>, <'10', $g1, $g2>, <'40', $g1, $g1^~x>, 
                                                <'45', '0', '1'>, <'42', '0'>, '41', 
                                                <p_psk_id, mask(ticket_age_add, $ticket_age)>, 
                                                hmac(<
                                                      Expand(Expand(Extract(Expand(ms, <'rms', h(messages)>,
                                                                                   '32'),
                                                                            '0'),
                                                                    <'res', 'pbk'>, '32'),
                                                             <'0', '0'>, '32'), 
                                                      h(<'0', '1', '0x0303', ~tid, '0', $cipher_suites, '0', 
                                                         <'43', '0x0304'>, <'10', $g1, $g2>, 
                                                         <'40', $g1, $g1^~x>, <'45', '0', '1'>, <'42', '0'>, 
                                                         '41', <p_psk_id, mask(ticket_age_add, $ticket_age)>, 
                                                         '0'>)
                                                     >)
                                               >, 
                                               '2', '0x0303', p_ns, $cipher_suite, <'13', $sig_algs>, 
                                               <'41', '0'>, '42', '0'>, 
                                              '8', $exts>, 
                                             '20', 
                                             hmac(<
                                                   Expand(Expand(Extract('0',
                                                                         Extract(Expand(ms,
                                                                                        <'rms', h(messages)>,
                                                                                        '32'),
                                                                                 '0')),
                                                                 <'serverhts', 
                                                                  h(<
                                                                     <
                                                                      <'0', '1', '0x0303', ~tid, '0', 
                                                                       $cipher_suites, '0', <'43', '0x0304'>, 
                                                                       <'10', $g1, $g2>, <'40', $g1, $g1^~x>, 
                                                                       <'45', '0', '1'>, <'42', '0'>, '41', 
                                                                       <p_psk_id, 
                                                                        mask(ticket_age_add, $ticket_age)>, 
                                                                       hmac(<
                                                                             Expand(Expand(Extract(Expand(ms,
                                                                                                          <
                                                                                                           'rms', 
                                                                                                           h(messages)
                                                                                                          >,
                                                                                                          '32'),
                                                                                                   '0'),
                                                                                           <'res', 'pbk'>,
                                                                                           '32'),
                                                                                    <'0', '0'>, '32'), 
                                                                             h(<'0', '1', '0x0303', ~tid, 
                                                                                '0', $cipher_suites, '0', 
                                                                                <'43', '0x0304'>, 
                                                                                <'10', $g1, $g2>, 
                                                                                <'40', $g1, $g1^~x>, 
                                                                                <'45', '0', '1'>, 
                                                                                <'42', '0'>, '41', 
                                                                                <p_psk_id, 
                                                                                 mask(ticket_age_add,
                                                                                      $ticket_age)
                                                                                >, 
                                                                                '0'>)
                                                                            >)
                                                                      >, 
                                                                      '2', '0x0303', p_ns, $cipher_suite, 
                                                                      <'13', $sig_algs>, <'41', '0'>, '42', 
                                                                      '0'>, 
                                                                     '8', $exts>)
                                                                 >,
                                                                 '32'),
                                                          <'fin', '0'>, '32'), 
                                                   h(<
                                                      <
                                                       <'0', '1', '0x0303', ~tid, '0', $cipher_suites, '0', 
                                                        <'43', '0x0304'>, <'10', $g1, $g2>, 
                                                        <'40', $g1, $g1^~x>, <'45', '0', '1'>, <'42', '0'>, 
                                                        '41', <p_psk_id, mask(ticket_age_add, $ticket_age)>, 
                                                        hmac(<
                                                              Expand(Expand(Extract(Expand(ms,
                                                                                           <'rms', h(messages)
                                                                                           >,
                                                                                           '32'),
                                                                                    '0'),
                                                                            <'res', 'pbk'>, '32'),
                                                                     <'0', '0'>, '32'), 
                                                              h(<'0', '1', '0x0303', ~tid, '0', 
                                                                 $cipher_suites, '0', <'43', '0x0304'>, 
                                                                 <'10', $g1, $g2>, <'40', $g1, $g1^~x>, 
                                                                 <'45', '0', '1'>, <'42', '0'>, '41', 
                                                                 <p_psk_id, mask(ticket_age_add, $ticket_age)
                                                                 >, 
                                                                 '0'>)
                                                             >)
                                                       >, 
                                                       '2', '0x0303', p_ns, $cipher_suite, <'13', $sig_algs>, 
                                                       <'41', '0'>, '42', '0'>, 
                                                      '8', $exts>)
                                                  >)
                                            >)
                                         >,
                                         '32'),
                                  <'adke_wk', '0'>, '32')
                ) ▶₀ #l )
    next
      case recv_server_auth_psk_case_6
      by solve( SecretPSK( $A,
                           Expand(Expand(Extract('0',
                                                 Extract('0',
                                                         Extract(Expand(ms, <'rms', h(messages)>, '32'),
                                                                 '0'))),
                                         <'serverats', 
                                          h(<
                                             <
                                              <
                                               <
                                                <
                                                 <'0', '1', '0x0303', ~tid, '0', $cipher_suites, '0', 
                                                  <'43', '0x0304'>, <'10', $g1, $g2>, <'40', $g1, $g1^~x>, 
                                                  <'45', '0', '1'>, <'42', '0'>, '41', 
                                                  <p_psk_id, mask(ticket_age_add, $ticket_age)>, 
                                                  hmac(<
                                                        Expand(Expand(Extract(Expand(ms, <'rms', h(messages)>,
                                                                                     '32'),
                                                                              '0'),
                                                                      <'res', 'pbk'>, '32'),
                                                               <'0', '0'>, '32'), 
                                                        h(<'0', '1', '0x0303', ~tid, '0', $cipher_suites, 
                                                           '0', <'43', '0x0304'>, <'10', $g1, $g2>, 
                                                           <'40', $g1, $g1^~x>, <'45', '0', '1'>, 
                                                           <'42', '0'>, '41', 
                                                           <p_psk_id, mask(ticket_age_add, $ticket_age)>, '0'
                                                          >)
                                                       >)
                                                 >, 
                                                 '6', '0x0303', '40', $g2>, 
                                                '1', '0x0303', ~new_nc, '0', $cipher_suites.1, '0', 
                                                <'43', '0x0304'>, <'10', $g1, $g2>, <'40', $g2, $g2^~new_x>, 
                                                <'45', '0', '1'>, '0', '41', 
                                                <p_psk_id, mask(ticket_age_add, '1')>, 
                                                hmac(<
                                                      Expand(Expand(Extract(Expand(ms, <'rms', h(messages)>,
                                                                                   '32'),
                                                                            '0'),
                                                                    <'res', 'pbk'>, '32'),
                                                             <'0', '0'>, '32'), 
                                                      h(<
                                                         <
                                                          <'0', '1', '0x0303', ~tid, '0', $cipher_suites, 
                                                           '0', <'43', '0x0304'>, <'10', $g1, $g2>, 
                                                           <'40', $g1, $g1^~x>, <'45', '0', '1'>, 
                                                           <'42', '0'>, '41', 
                                                           <p_psk_id, mask(ticket_age_add, $ticket_age)>, 
                                                           hmac(<
                                                                 Expand(Expand(Extract(Expand(ms,
                                                                                              <'rms', 
                                                                                               h(messages)>,
                                                                                              '32'),
                                                                                       '0'),
                                                                               <'res', 'pbk'>, '32'),
                                                                        <'0', '0'>, '32'), 
                                                                 h(<'0', '1', '0x0303', ~tid, '0', 
                                                                    $cipher_suites, '0', <'43', '0x0304'>, 
                                                                    <'10', $g1, $g2>, <'40', $g1, $g1^~x>, 
                                                                    <'45', '0', '1'>, <'42', '0'>, '41', 
                                                                    <p_psk_id, 
                                                                     mask(ticket_age_add, $ticket_age)>, 
                                                                    '0'>)
                                                                >)
                                                          >, 
                                                          '6', '0x0303', '40', $g2>, 
                                                         '1', '0x0303', ~new_nc, '0', $cipher_suites.1, '0', 
                                                         <'43', '0x0304'>, <'10', $g1, $g2>, 
                                                         <'40', $g2, $g2^~new_x>, <'45', '0', '1'>, '0', 
                                                         '41', <p_psk_id, mask(ticket_age_add, '1')>, '0'>)
                                                     >)
                                               >, 
                                               '2', '0x0303', p_ns, $cipher_suite, <'13', $sig_algs>, 
                                               <'41', '0'>, '0'>, 
                                              '8', $exts>, 
                                             '20', 
                                             hmac(<
                                                   Expand(Expand(Extract('0',
                                                                         Extract(Expand(ms,
                                                                                        <'rms', h(messages)>,
                                                                                        '32'),
                                                                                 '0')),
                                                                 <'serverhts', 
                                                                  h(<
                                                                     <
                                                                      <
                                                                       <
                                                                        <'0', '1', '0x0303', ~tid, '0', 
                                                                         $cipher_suites, '0', 
                                                                         <'43', '0x0304'>, <'10', $g1, $g2>, 
                                                                         <'40', $g1, $g1^~x>, 
                                                                         <'45', '0', '1'>, <'42', '0'>, '41', 
                                                                         <p_psk_id, 
                                                                          mask(ticket_age_add, $ticket_age)>, 
                                                                         hmac(<
                                                                               Expand(Expand(Extract(Expand(ms,
                                                                                                            <
                                                                                                             'rms', 
                                                                                                             h(messages)
                                                                                                            >,
                                                                                                            '32'),
                                                                                                     '0'),
                                                                                             <'res', 'pbk'>,
                                                                                             '32'),
                                                                                      <'0', '0'>, '32'), 
                                                                               h(<'0', '1', '0x0303', ~tid, 
                                                                                  '0', $cipher_suites, '0', 
                                                                                  <'43', '0x0304'>, 
                                                                                  <'10', $g1, $g2>, 
                                                                                  <'40', $g1, $g1^~x>, 
                                                                                  <'45', '0', '1'>, 
                                                                                  <'42', '0'>, '41', 
                                                                                  <p_psk_id, 
                                                                                   mask(ticket_age_add,
                                                                                        $ticket_age)
                                                                                  >, 
                                                                                  '0'>)
                                                                              >)
                                                                        >, 
                                                                        '6', '0x0303', '40', $g2>, 
                                                                       '1', '0x0303', ~new_nc, '0', 
                                                                       $cipher_suites.1, '0', 
                                                                       <'43', '0x0304'>, <'10', $g1, $g2>, 
                                                                       <'40', $g2, $g2^~new_x>, 
                                                                       <'45', '0', '1'>, '0', '41', 
                                                                       <p_psk_id, mask(ticket_age_add, '1')>, 
                                                                       hmac(<
                                                                             Expand(Expand(Extract(Expand(ms,
                                                                                                          <
                                                                                                           'rms', 
                                                                                                           h(messages)
                                                                                                          >,
                                                                                                          '32'),
                                                                                                   '0'),
                                                                                           <'res', 'pbk'>,
                                                                                           '32'),
                                                                                    <'0', '0'>, '32'), 
                                                                             h(<
                                                                                <
                                                                                 <'0', '1', '0x0303', ~tid, 
                                                                                  '0', $cipher_suites, '0', 
                                                                                  <'43', '0x0304'>, 
                                                                                  <'10', $g1, $g2>, 
                                                                                  <'40', $g1, $g1^~x>, 
                                                                                  <'45', '0', '1'>, 
                                                                                  <'42', '0'>, '41', 
                                                                                  <p_psk_id, 
                                                                                   mask(ticket_age_add,
                                                                                        $ticket_age)
                                                                                  >, 
                                                                                  hmac(<
                                                                                        Expand(Expand(Extract(Expand(ms,
                                                                                                                     <
                                                                                                                      'rms', 
                                                                                                                      h(messages)
                                                                                                                     >,
                                                                                                                     '32'),
                                                                                                              '0'),
                                                                                                      <'res', 
                                                                                                       'pbk'>,
                                                                                                      '32'),
                                                                                               <'0', '0'>,
                                                                                               '32'), 
                                                                                        h(<'0', '1', 
                                                                                           '0x0303', ~tid, 
                                                                                           '0', 
                                                                                           $cipher_suites, 
                                                                                           '0', 
                                                                                           <'43', '0x0304'>, 
                                                                                           <'10', $g1, $g2>, 
                                                                                           <'40', $g1, $g1^~x
                                                                                           >, 
                                                                                           <'45', '0', '1'>, 
                                                                                           <'42', '0'>, '41', 
                                                                                           <p_psk_id, 
                                                                                            mask(ticket_age_add,
                                                                                                 $ticket_age)
                                                                                           >, 
                                                                                           '0'>)
                                                                                       >)
                                                                                 >, 
                                                                                 '6', '0x0303', '40', $g2>, 
                                                                                '1', '0x0303', ~new_nc, '0', 
                                                                                $cipher_suites.1, '0', 
                                                                                <'43', '0x0304'>, 
                                                                                <'10', $g1, $g2>, 
                                                                                <'40', $g2, $g2^~new_x>, 
                                                                                <'45', '0', '1'>, '0', '41', 
                                                                                <p_psk_id, 
                                                                                 mask(ticket_age_add, '1')>, 
                                                                                '0'>)
                                                                            >)
                                                                      >, 
                                                                      '2', '0x0303', p_ns, $cipher_suite, 
                                                                      <'13', $sig_algs>, <'41', '0'>, '0'>, 
                                                                     '8', $exts>)
                                                                 >,
                                                                 '32'),
                                                          <'fin', '0'>, '32'), 
                                                   h(<
                                                      <
                                                       <
                                                        <
                                                         <'0', '1', '0x0303', ~tid, '0', $cipher_suites, '0', 
                                                          <'43', '0x0304'>, <'10', $g1, $g2>, 
                                                          <'40', $g1, $g1^~x>, <'45', '0', '1'>, <'42', '0'>, 
                                                          '41', 
                                                          <p_psk_id, mask(ticket_age_add, $ticket_age)>, 
                                                          hmac(<
                                                                Expand(Expand(Extract(Expand(ms,
                                                                                             <'rms', 
                                                                                              h(messages)>,
                                                                                             '32'),
                                                                                      '0'),
                                                                              <'res', 'pbk'>, '32'),
                                                                       <'0', '0'>, '32'), 
                                                                h(<'0', '1', '0x0303', ~tid, '0', 
                                                                   $cipher_suites, '0', <'43', '0x0304'>, 
                                                                   <'10', $g1, $g2>, <'40', $g1, $g1^~x>, 
                                                                   <'45', '0', '1'>, <'42', '0'>, '41', 
                                                                   <p_psk_id, 
                                                                    mask(ticket_age_add, $ticket_age)>, 
                                                                   '0'>)
                                                               >)
                                                         >, 
                                                         '6', '0x0303', '40', $g2>, 
                                                        '1', '0x0303', ~new_nc, '0', $cipher_suites.1, '0', 
                                                        <'43', '0x0304'>, <'10', $g1, $g2>, 
                                                        <'40', $g2, $g2^~new_x>, <'45', '0', '1'>, '0', '41', 
                                                        <p_psk_id, mask(ticket_age_add, '1')>, 
                                                        hmac(<
                                                              Expand(Expand(Extract(Expand(ms,
                                                                                           <'rms', h(messages)
                                                                                           >,
                                                                                           '32'),
                                                                                    '0'),
                                                                            <'res', 'pbk'>, '32'),
                                                                     <'0', '0'>, '32'), 
                                                              h(<
                                                                 <
                                                                  <'0', '1', '0x0303', ~tid, '0', 
                                                                   $cipher_suites, '0', <'43', '0x0304'>, 
                                                                   <'10', $g1, $g2>, <'40', $g1, $g1^~x>, 
                                                                   <'45', '0', '1'>, <'42', '0'>, '41', 
                                                                   <p_psk_id, 
                                                                    mask(ticket_age_add, $ticket_age)>, 
                                                                   hmac(<
                                                                         Expand(Expand(Extract(Expand(ms,
                                                                                                      <'rms', 
                                                                                                       h(messages)
                                                                                                      >,
                                                                                                      '32'),
                                                                                               '0'),
                                                                                       <'res', 'pbk'>, '32'),
                                                                                <'0', '0'>, '32'), 
                                                                         h(<'0', '1', '0x0303', ~tid, '0', 
                                                                            $cipher_suites, '0', 
                                                                            <'43', '0x0304'>, 
                                                                            <'10', $g1, $g2>, 
                                                                            <'40', $g1, $g1^~x>, 
                                                                            <'45', '0', '1'>, <'42', '0'>, 
                                                                            '41', 
                                                                            <p_psk_id, 
                                                                             mask(ticket_age_add, $ticket_age)
                                                                            >, 
                                                                            '0'>)
                                                                        >)
                                                                  >, 
                                                                  '6', '0x0303', '40', $g2>, 
                                                                 '1', '0x0303', ~new_nc, '0', 
                                                                 $cipher_suites.1, '0', <'43', '0x0304'>, 
                                                                 <'10', $g1, $g2>, <'40', $g2, $g2^~new_x>, 
                                                                 <'45', '0', '1'>, '0', '41', 
                                                                 <p_psk_id, mask(ticket_age_add, '1')>, '0'>)
                                                             >)
                                                       >, 
                                                       '2', '0x0303', p_ns, $cipher_suite, <'13', $sig_algs>, 
                                                       <'41', '0'>, '0'>, 
                                                      '8', $exts>)
                                                  >)
                                            >)
                                         >,
                                         '32'),
                                  <'adke_wk', '0'>, '32')
                ) ▶₀ #l )
    next
      case recv_server_auth_psk_case_7
      by contradiction /* from formulas */
    next
      case recv_server_auth_psk_case_8
      by contradiction /* from formulas */
    qed
  qed
next
  case client_auth_cert
  solve( (∃ #j. (!KU( p_sats ) @ #j) ∧ #j < #vk)  ∥
         ((∀ #k. (!KU( p_sats ) @ #k) ⇒ ¬(#k < #vk)) ∧
          (∃ actor #l.
            (RevealPSK( actor, Expand(p_sats, <'adke_wk', '0'>, '32') ) @ #l)
           ∧
            #l < #vk)) )
    case case_1
    solve( F_State_C3( ~tid, $C, $S, p_res_psk, p_messages, p_nc, p_ns, p_g,
                       p_sg, p_hrr, p_x, p_y, p_gx, p_gy, p_gxy, 'na', p_psk_id, p_edi, p_es,
                       p_hs, Extract('0', p_hs), p_cats, p_sats, p_hs_keyc, p_hs_keys,
                       p_auth_status, p_ems, p_rms, '1'
           ) ▶₀ #i )
      case recv_server_auth_case_01
      solve( (∃ #j.2.
               (!KU( Extract('0', Extract(p_gxy, Extract('0', '0'))) ) @ #j.2)
              ∧
               #j.2 < #j.1)  ∥
             ((∀ #k.
                (!KU( Extract('0', Extract(p_gxy, Extract('0', '0'))) ) @ #k)
               ⇒
                ¬(#k < #j.1)) ∧
              (∃ actor #l.
                (RevealPSK( actor,
                            Expand(Extract('0', Extract(p_gxy, Extract('0', '0'))),
                                   <'serverats', 
                                    h(<
                                       <
                                        <
                                         <
                                          <
                                           <
                                            <'0', '1', '0x0303', ~tid, '0', $cipher_suites, '0', 
                                             <'43', '0x0304'>, <'10', $g, $g2>, <'13', $sig_algs>, '40', $g, 
                                             $g^~x>, 
                                            '2', '0x0303', p_ns, $cipher_suite, <'13', $sig_algs.1>, '40', 
                                            $g, p_gy>, 
                                           '8', $exts>, 
                                          '13', '0', $certificate_extensions>, 
                                         '11', '0', pk(~ltkS)>, 
                                        '15', 
                                        sign(<'server_cv', 
                                              h(<
                                                 <
                                                  <
                                                   <
                                                    <'0', '1', '0x0303', ~tid, '0', $cipher_suites, '0', 
                                                     <'43', '0x0304'>, <'10', $g, $g2>, <'13', $sig_algs>, 
                                                     '40', $g, $g^~x>, 
                                                    '2', '0x0303', p_ns, $cipher_suite, <'13', $sig_algs.1>, 
                                                    '40', $g, p_gy>, 
                                                   '8', $exts>, 
                                                  '13', '0', $certificate_extensions>, 
                                                 '11', '0', pk(~ltkS)>)
                                             >,
                                             ~ltkS)
                                       >, 
                                       '20', 
                                       hmac(<
                                             Expand(Expand(Extract(p_gxy, Extract('0', '0')),
                                                           <'serverhts', 
                                                            h(<
                                                               <
                                                                <
                                                                 <
                                                                  <
                                                                   <'0', '1', '0x0303', ~tid, '0', 
                                                                    $cipher_suites, '0', <'43', '0x0304'>, 
                                                                    <'10', $g, $g2>, <'13', $sig_algs>, '40', 
                                                                    $g, $g^~x>, 
                                                                   '2', '0x0303', p_ns, $cipher_suite, 
                                                                   <'13', $sig_algs.1>, '40', $g, p_gy>, 
                                                                  '8', $exts>, 
                                                                 '13', '0', $certificate_extensions>, 
                                                                '11', '0', pk(~ltkS)>, 
                                                               '15', 
                                                               sign(<'server_cv', 
                                                                     h(<
                                                                        <
                                                                         <
                                                                          <
                                                                           <'0', '1', '0x0303', ~tid, '0', 
                                                                            $cipher_suites, '0', 
                                                                            <'43', '0x0304'>, 
                                                                            <'10', $g, $g2>, 
                                                                            <'13', $sig_algs>, '40', $g, $g^~x
                                                                           >, 
                                                                           '2', '0x0303', p_ns, 
                                                                           $cipher_suite, 
                                                                           <'13', $sig_algs.1>, '40', $g, p_gy
                                                                          >, 
                                                                          '8', $exts>, 
                                                                         '13', '0', $certificate_extensions>, 
                                                                        '11', '0', pk(~ltkS)>)
                                                                    >,
                                                                    ~ltkS)
                                                              >)
                                                           >,
                                                           '32'),
                                                    <'fin', '0'>, '32'), 
                                             h(<
                                                <
                                                 <
                                                  <
                                                   <
                                                    <'0', '1', '0x0303', ~tid, '0', $cipher_suites, '0', 
                                                     <'43', '0x0304'>, <'10', $g, $g2>, <'13', $sig_algs>, 
                                                     '40', $g, $g^~x>, 
                                                    '2', '0x0303', p_ns, $cipher_suite, <'13', $sig_algs.1>, 
                                                    '40', $g, p_gy>, 
                                                   '8', $exts>, 
                                                  '13', '0', $certificate_extensions>, 
                                                 '11', '0', pk(~ltkS)>, 
                                                '15', 
                                                sign(<'server_cv', 
                                                      h(<
                                                         <
                                                          <
                                                           <
                                                            <'0', '1', '0x0303', ~tid, '0', $cipher_suites, 
                                                             '0', <'43', '0x0304'>, <'10', $g, $g2>, 
                                                             <'13', $sig_algs>, '40', $g, $g^~x>, 
                                                            '2', '0x0303', p_ns, $cipher_suite, 
                                                            <'13', $sig_algs.1>, '40', $g, p_gy>, 
                                                           '8', $exts>, 
                                                          '13', '0', $certificate_extensions>, 
                                                         '11', '0', pk(~ltkS)>)
                                                     >,
                                                     ~ltkS)
                                               >)
                                            >)
                                      >)
                                   >,
                                   '32')
                 ) @ #l)
               ∧
                #l < #j.1)) )
        case case_1
        solve( (∃ #r. (RevLtk( $S ) @ #r) ∧ #r < #vr)  ∥
               (∃ tid3 x #r. (RevDHExp( tid3, $S, x ) @ #r) ∧ #r < #vr)  ∥
               (∃ tid4 y #r. (RevDHExp( tid4, $C, y ) @ #r) ∧ #r < #vr)  ∥
               (∃ rms #r. (RevealPSK( $C, rms ) @ #r) ∧ #r < #k.1)  ∥
               (∃ rms #r. (RevealPSK( $S, rms ) @ #r) ∧ #r < #k.1) )
          case case_1
          by contradiction /* from formulas */
        next
          case case_2
          by contradiction /* from formulas */
        next
          case case_3
          by contradiction /* from formulas */
        next
          case case_4
          solve( (∃ #r. (RevLtk( $S ) @ #r) ∧ #r < #vr)  ∥
                 (∃ tid3 x #r. (RevDHExp( tid3, $S, x ) @ #r) ∧ #r < #vr)  ∥
                 (∃ tid4 y #r. (RevDHExp( tid4, $C, y ) @ #r) ∧ #r < #vr)  ∥
                 (∃ rms #r. (RevealPSK( $C, rms ) @ #r) ∧ #r < #vr)  ∥
                 (∃ rms #r. (RevealPSK( $S, rms ) @ #r) ∧ #r < #vr) )
            case case_1
            by contradiction /* from formulas */
          next
            case case_2
            by contradiction /* from formulas */
          next
            case case_3
            by contradiction /* from formulas */
          next
            case case_4
            by contradiction /* from formulas */
          next
            case case_5
            by contradiction /* from formulas */
          qed
        next
          case case_5
          solve( (∃ #r. (RevLtk( $S ) @ #r) ∧ #r < #vr)  ∥
                 (∃ tid3 x #r. (RevDHExp( tid3, $S, x ) @ #r) ∧ #r < #vr)  ∥
                 (∃ tid4 y #r. (RevDHExp( tid4, $C, y ) @ #r) ∧ #r < #vr)  ∥
                 (∃ rms #r. (RevealPSK( $C, rms ) @ #r) ∧ #r < #vr)  ∥
                 (∃ rms #r. (RevealPSK( $S, rms ) @ #r) ∧ #r < #vr) )
            case case_1
            by contradiction /* from formulas */
          next
            case case_2
            by contradiction /* from formulas */
          next
            case case_3
            by contradiction /* from formulas */
          next
            case case_4
            by contradiction /* from formulas */
          next
            case case_5
            by contradiction /* from formulas */
          qed
        qed
      next
        case case_2
        solve( !Ltk( $C, ~ltkC ) ▶₂ #i )
          case Register_pk
          by solve( SecretPSK( $A,
                               Expand(Extract('0', Extract(p_gxy, Extract('0', '0'))),
                                      <'serverats', 
                                       h(<
                                          <
                                           <
                                            <
                                             <
                                              <
                                               <'0', '1', '0x0303', ~tid, '0', $cipher_suites, '0', 
                                                <'43', '0x0304'>, <'10', $g, $g2>, <'13', $sig_algs>, '40', 
                                                $g, $g^~x>, 
                                               '2', '0x0303', p_ns, $cipher_suite, <'13', $sig_algs.1>, '40', 
                                               $g, p_gy>, 
                                              '8', $exts>, 
                                             '13', '0', $certificate_extensions>, 
                                            '11', '0', pk(~ltkS)>, 
                                           '15', 
                                           sign(<'server_cv', 
                                                 h(<
                                                    <
                                                     <
                                                      <
                                                       <'0', '1', '0x0303', ~tid, '0', $cipher_suites, '0', 
                                                        <'43', '0x0304'>, <'10', $g, $g2>, <'13', $sig_algs>, 
                                                        '40', $g, $g^~x>, 
                                                       '2', '0x0303', p_ns, $cipher_suite, 
                                                       <'13', $sig_algs.1>, '40', $g, p_gy>, 
                                                      '8', $exts>, 
                                                     '13', '0', $certificate_extensions>, 
                                                    '11', '0', pk(~ltkS)>)
                                                >,
                                                ~ltkS)
                                          >, 
                                          '20', 
                                          hmac(<
                                                Expand(Expand(Extract(p_gxy, Extract('0', '0')),
                                                              <'serverhts', 
                                                               h(<
                                                                  <
                                                                   <
                                                                    <
                                                                     <
                                                                      <'0', '1', '0x0303', ~tid, '0', 
                                                                       $cipher_suites, '0', <'43', '0x0304'>, 
                                                                       <'10', $g, $g2>, <'13', $sig_algs>, 
                                                                       '40', $g, $g^~x>, 
                                                                      '2', '0x0303', p_ns, $cipher_suite, 
                                                                      <'13', $sig_algs.1>, '40', $g, p_gy>, 
                                                                     '8', $exts>, 
                                                                    '13', '0', $certificate_extensions>, 
                                                                   '11', '0', pk(~ltkS)>, 
                                                                  '15', 
                                                                  sign(<'server_cv', 
                                                                        h(<
                                                                           <
                                                                            <
                                                                             <
                                                                              <'0', '1', '0x0303', ~tid, '0', 
                                                                               $cipher_suites, '0', 
                                                                               <'43', '0x0304'>, 
                                                                               <'10', $g, $g2>, 
                                                                               <'13', $sig_algs>, '40', $g, 
                                                                               $g^~x>, 
                                                                              '2', '0x0303', p_ns, 
                                                                              $cipher_suite, 
                                                                              <'13', $sig_algs.1>, '40', $g, 
                                                                              p_gy>, 
                                                                             '8', $exts>, 
                                                                            '13', '0', $certificate_extensions
                                                                           >, 
                                                                           '11', '0', pk(~ltkS)>)
                                                                       >,
                                                                       ~ltkS)
                                                                 >)
                                                              >,
                                                              '32'),
                                                       <'fin', '0'>, '32'), 
                                                h(<
                                                   <
                                                    <
                                                     <
                                                      <
                                                       <'0', '1', '0x0303', ~tid, '0', $cipher_suites, '0', 
                                                        <'43', '0x0304'>, <'10', $g, $g2>, <'13', $sig_algs>, 
                                                        '40', $g, $g^~x>, 
                                                       '2', '0x0303', p_ns, $cipher_suite, 
                                                       <'13', $sig_algs.1>, '40', $g, p_gy>, 
                                                      '8', $exts>, 
                                                     '13', '0', $certificate_extensions>, 
                                                    '11', '0', pk(~ltkS)>, 
                                                   '15', 
                                                   sign(<'server_cv', 
                                                         h(<
                                                            <
                                                             <
                                                              <
                                                               <'0', '1', '0x0303', ~tid, '0', 
                                                                $cipher_suites, '0', <'43', '0x0304'>, 
                                                                <'10', $g, $g2>, <'13', $sig_algs>, '40', $g, 
                                                                $g^~x>, 
                                                               '2', '0x0303', p_ns, $cipher_suite, 
                                                               <'13', $sig_algs.1>, '40', $g, p_gy>, 
                                                              '8', $exts>, 
                                                             '13', '0', $certificate_extensions>, 
                                                            '11', '0', pk(~ltkS)>)
                                                        >,
                                                        ~ltkS)
                                                  >)
                                               >)
                                         >)
                                      >,
                                      '32')
                    ) ▶₀ #l )
        qed
      qed
    next
      case recv_server_auth_case_02
      solve( (∃ #j.2.
               (!KU( Extract('0', Extract(p_gxy, Extract('0', '0'))) ) @ #j.2)
              ∧
               #j.2 < #j.1)  ∥
             ((∀ #k.
                (!KU( Extract('0', Extract(p_gxy, Extract('0', '0'))) ) @ #k)
               ⇒
                ¬(#k < #j.1)) ∧
              (∃ actor #l.
                (RevealPSK( actor,
                            Expand(Extract('0', Extract(p_gxy, Extract('0', '0'))),
                                   <'serverats', 
                                    h(<
                                       <
                                        <
                                         <
                                          <
                                           <
                                            <
                                             <
                                              <'0', '1', '0x0303', ~tid, '0', $cipher_suites, '0', 
                                               <'43', '0x0304'>, <'10', $g1, $g>, <'13', $sig_algs>, '40', 
                                               $g1, $g1^~x>, 
                                              '6', '0x0303', '40', $g>, 
                                             '1', '0x0303', ~tid, '0', $cipher_suites.1, '0', 
                                             <'43', '0x0304'>, <'10', $g1, $g>, <'13', $sig_algs.1>, '40', 
                                             $g, $g^~x.1>, 
                                            '2', '0x0303', p_ns, $cipher_suite, <'13', $sig_algs.2>, '40', 
                                            $g, p_gy>, 
                                           '8', $exts>, 
                                          '13', '0', $certificate_extensions>, 
                                         '11', '0', pk(~ltkS)>, 
                                        '15', 
                                        sign(<'server_cv', 
                                              h(<
                                                 <
                                                  <
                                                   <
                                                    <
                                                     <
                                                      <'0', '1', '0x0303', ~tid, '0', $cipher_suites, '0', 
                                                       <'43', '0x0304'>, <'10', $g1, $g>, <'13', $sig_algs>, 
                                                       '40', $g1, $g1^~x>, 
                                                      '6', '0x0303', '40', $g>, 
                                                     '1', '0x0303', ~tid, '0', $cipher_suites.1, '0', 
                                                     <'43', '0x0304'>, <'10', $g1, $g>, <'13', $sig_algs.1>, 
                                                     '40', $g, $g^~x.1>, 
                                                    '2', '0x0303', p_ns, $cipher_suite, <'13', $sig_algs.2>, 
                                                    '40', $g, p_gy>, 
                                                   '8', $exts>, 
                                                  '13', '0', $certificate_extensions>, 
                                                 '11', '0', pk(~ltkS)>)
                                             >,
                                             ~ltkS)
                                       >, 
                                       '20', 
                                       hmac(<
                                             Expand(Expand(Extract(p_gxy, Extract('0', '0')),
                                                           <'serverhts', 
                                                            h(<
                                                               <
                                                                <
                                                                 <
                                                                  <
                                                                   <
                                                                    <
                                                                     <'0', '1', '0x0303', ~tid, '0', 
                                                                      $cipher_suites, '0', <'43', '0x0304'>, 
                                                                      <'10', $g1, $g>, <'13', $sig_algs>, 
                                                                      '40', $g1, $g1^~x>, 
                                                                     '6', '0x0303', '40', $g>, 
                                                                    '1', '0x0303', ~tid, '0', 
                                                                    $cipher_suites.1, '0', <'43', '0x0304'>, 
                                                                    <'10', $g1, $g>, <'13', $sig_algs.1>, 
                                                                    '40', $g, $g^~x.1>, 
                                                                   '2', '0x0303', p_ns, $cipher_suite, 
                                                                   <'13', $sig_algs.2>, '40', $g, p_gy>, 
                                                                  '8', $exts>, 
                                                                 '13', '0', $certificate_extensions>, 
                                                                '11', '0', pk(~ltkS)>, 
                                                               '15', 
                                                               sign(<'server_cv', 
                                                                     h(<
                                                                        <
                                                                         <
                                                                          <
                                                                           <
                                                                            <
                                                                             <'0', '1', '0x0303', ~tid, '0', 
                                                                              $cipher_suites, '0', 
                                                                              <'43', '0x0304'>, 
                                                                              <'10', $g1, $g>, 
                                                                              <'13', $sig_algs>, '40', $g1, 
                                                                              $g1^~x>, 
                                                                             '6', '0x0303', '40', $g>, 
                                                                            '1', '0x0303', ~tid, '0', 
                                                                            $cipher_suites.1, '0', 
                                                                            <'43', '0x0304'>, 
                                                                            <'10', $g1, $g>, 
                                                                            <'13', $sig_algs.1>, '40', $g, 
                                                                            $g^~x.1>, 
                                                                           '2', '0x0303', p_ns, 
                                                                           $cipher_suite, 
                                                                           <'13', $sig_algs.2>, '40', $g, p_gy
                                                                          >, 
                                                                          '8', $exts>, 
                                                                         '13', '0', $certificate_extensions>, 
                                                                        '11', '0', pk(~ltkS)>)
                                                                    >,
                                                                    ~ltkS)
                                                              >)
                                                           >,
                                                           '32'),
                                                    <'fin', '0'>, '32'), 
                                             h(<
                                                <
                                                 <
                                                  <
                                                   <
                                                    <
                                                     <
                                                      <'0', '1', '0x0303', ~tid, '0', $cipher_suites, '0', 
                                                       <'43', '0x0304'>, <'10', $g1, $g>, <'13', $sig_algs>, 
                                                       '40', $g1, $g1^~x>, 
                                                      '6', '0x0303', '40', $g>, 
                                                     '1', '0x0303', ~tid, '0', $cipher_suites.1, '0', 
                                                     <'43', '0x0304'>, <'10', $g1, $g>, <'13', $sig_algs.1>, 
                                                     '40', $g, $g^~x.1>, 
                                                    '2', '0x0303', p_ns, $cipher_suite, <'13', $sig_algs.2>, 
                                                    '40', $g, p_gy>, 
                                                   '8', $exts>, 
                                                  '13', '0', $certificate_extensions>, 
                                                 '11', '0', pk(~ltkS)>, 
                                                '15', 
                                                sign(<'server_cv', 
                                                      h(<
                                                         <
                                                          <
                                                           <
                                                            <
                                                             <
                                                              <'0', '1', '0x0303', ~tid, '0', $cipher_suites, 
                                                               '0', <'43', '0x0304'>, <'10', $g1, $g>, 
                                                               <'13', $sig_algs>, '40', $g1, $g1^~x>, 
                                                              '6', '0x0303', '40', $g>, 
                                                             '1', '0x0303', ~tid, '0', $cipher_suites.1, '0', 
                                                             <'43', '0x0304'>, <'10', $g1, $g>, 
                                                             <'13', $sig_algs.1>, '40', $g, $g^~x.1>, 
                                                            '2', '0x0303', p_ns, $cipher_suite, 
                                                            <'13', $sig_algs.2>, '40', $g, p_gy>, 
                                                           '8', $exts>, 
                                                          '13', '0', $certificate_extensions>, 
                                                         '11', '0', pk(~ltkS)>)
                                                     >,
                                                     ~ltkS)
                                               >)
                                            >)
                                      >)
                                   >,
                                   '32')
                 ) @ #l)
               ∧
                #l < #j.1)) )
        case case_1
        solve( (∃ #r. (RevLtk( $S ) @ #r) ∧ #r < #vr)  ∥
               (∃ tid3 x #r. (RevDHExp( tid3, $S, x ) @ #r) ∧ #r < #vr)  ∥
               (∃ tid4 y #r. (RevDHExp( tid4, $C, y ) @ #r) ∧ #r < #vr)  ∥
               (∃ rms #r. (RevealPSK( $C, rms ) @ #r) ∧ #r < #k.1)  ∥
               (∃ rms #r. (RevealPSK( $S, rms ) @ #r) ∧ #r < #k.1) )
          case case_1
          by contradiction /* from formulas */
        next
          case case_2
          by contradiction /* from formulas */
        next
          case case_3
          by contradiction /* from formulas */
        next
          case case_4
          solve( (∃ #r. (RevLtk( $S ) @ #r) ∧ #r < #vr)  ∥
                 (∃ tid3 x #r. (RevDHExp( tid3, $S, x ) @ #r) ∧ #r < #vr)  ∥
                 (∃ tid4 y #r. (RevDHExp( tid4, $C, y ) @ #r) ∧ #r < #vr)  ∥
                 (∃ rms #r. (RevealPSK( $C, rms ) @ #r) ∧ #r < #vr)  ∥
                 (∃ rms #r. (RevealPSK( $S, rms ) @ #r) ∧ #r < #vr) )
            case case_1
            by contradiction /* from formulas */
          next
            case case_2
            by contradiction /* from formulas */
          next
            case case_3
            by contradiction /* from formulas */
          next
            case case_4
            by contradiction /* from formulas */
          next
            case case_5
            by contradiction /* from formulas */
          qed
        next
          case case_5
          solve( (∃ #r. (RevLtk( $S ) @ #r) ∧ #r < #vr)  ∥
                 (∃ tid3 x #r. (RevDHExp( tid3, $S, x ) @ #r) ∧ #r < #vr)  ∥
                 (∃ tid4 y #r. (RevDHExp( tid4, $C, y ) @ #r) ∧ #r < #vr)  ∥
                 (∃ rms #r. (RevealPSK( $C, rms ) @ #r) ∧ #r < #vr)  ∥
                 (∃ rms #r. (RevealPSK( $S, rms ) @ #r) ∧ #r < #vr) )
            case case_1
            by contradiction /* from formulas */
          next
            case case_2
            by contradiction /* from formulas */
          next
            case case_3
            by contradiction /* from formulas */
          next
            case case_4
            by contradiction /* from formulas */
          next
            case case_5
            by contradiction /* from formulas */
          qed
        qed
      next
        case case_2
        solve( !Ltk( $C, ~ltkC ) ▶₂ #i )
          case Register_pk
          by solve( SecretPSK( $A,
                               Expand(Extract('0', Extract(p_gxy, Extract('0', '0'))),
                                      <'serverats', 
                                       h(<
                                          <
                                           <
                                            <
                                             <
                                              <
                                               <
                                                <
                                                 <'0', '1', '0x0303', ~tid, '0', $cipher_suites, '0', 
                                                  <'43', '0x0304'>, <'10', $g1, $g>, <'13', $sig_algs>, '40', 
                                                  $g1, $g1^~x>, 
                                                 '6', '0x0303', '40', $g>, 
                                                '1', '0x0303', ~tid, '0', $cipher_suites.1, '0', 
                                                <'43', '0x0304'>, <'10', $g1, $g>, <'13', $sig_algs.1>, '40', 
                                                $g, $g^~x.1>, 
                                               '2', '0x0303', p_ns, $cipher_suite, <'13', $sig_algs.2>, '40', 
                                               $g, p_gy>, 
                                              '8', $exts>, 
                                             '13', '0', $certificate_extensions>, 
                                            '11', '0', pk(~ltkS)>, 
                                           '15', 
                                           sign(<'server_cv', 
                                                 h(<
                                                    <
                                                     <
                                                      <
                                                       <
                                                        <
                                                         <'0', '1', '0x0303', ~tid, '0', $cipher_suites, '0', 
                                                          <'43', '0x0304'>, <'10', $g1, $g>, 
                                                          <'13', $sig_algs>, '40', $g1, $g1^~x>, 
                                                         '6', '0x0303', '40', $g>, 
                                                        '1', '0x0303', ~tid, '0', $cipher_suites.1, '0', 
                                                        <'43', '0x0304'>, <'10', $g1, $g>, 
                                                        <'13', $sig_algs.1>, '40', $g, $g^~x.1>, 
                                                       '2', '0x0303', p_ns, $cipher_suite, 
                                                       <'13', $sig_algs.2>, '40', $g, p_gy>, 
                                                      '8', $exts>, 
                                                     '13', '0', $certificate_extensions>, 
                                                    '11', '0', pk(~ltkS)>)
                                                >,
                                                ~ltkS)
                                          >, 
                                          '20', 
                                          hmac(<
                                                Expand(Expand(Extract(p_gxy, Extract('0', '0')),
                                                              <'serverhts', 
                                                               h(<
                                                                  <
                                                                   <
                                                                    <
                                                                     <
                                                                      <
                                                                       <
                                                                        <'0', '1', '0x0303', ~tid, '0', 
                                                                         $cipher_suites, '0', 
                                                                         <'43', '0x0304'>, <'10', $g1, $g>, 
                                                                         <'13', $sig_algs>, '40', $g1, $g1^~x
                                                                        >, 
                                                                        '6', '0x0303', '40', $g>, 
                                                                       '1', '0x0303', ~tid, '0', 
                                                                       $cipher_suites.1, '0', 
                                                                       <'43', '0x0304'>, <'10', $g1, $g>, 
                                                                       <'13', $sig_algs.1>, '40', $g, $g^~x.1
                                                                      >, 
                                                                      '2', '0x0303', p_ns, $cipher_suite, 
                                                                      <'13', $sig_algs.2>, '40', $g, p_gy>, 
                                                                     '8', $exts>, 
                                                                    '13', '0', $certificate_extensions>, 
                                                                   '11', '0', pk(~ltkS)>, 
                                                                  '15', 
                                                                  sign(<'server_cv', 
                                                                        h(<
                                                                           <
                                                                            <
                                                                             <
                                                                              <
                                                                               <
                                                                                <'0', '1', '0x0303', ~tid, 
                                                                                 '0', $cipher_suites, '0', 
                                                                                 <'43', '0x0304'>, 
                                                                                 <'10', $g1, $g>, 
                                                                                 <'13', $sig_algs>, '40', 
                                                                                 $g1, $g1^~x>, 
                                                                                '6', '0x0303', '40', $g>, 
                                                                               '1', '0x0303', ~tid, '0', 
                                                                               $cipher_suites.1, '0', 
                                                                               <'43', '0x0304'>, 
                                                                               <'10', $g1, $g>, 
                                                                               <'13', $sig_algs.1>, '40', $g, 
                                                                               $g^~x.1>, 
                                                                              '2', '0x0303', p_ns, 
                                                                              $cipher_suite, 
                                                                              <'13', $sig_algs.2>, '40', $g, 
                                                                              p_gy>, 
                                                                             '8', $exts>, 
                                                                            '13', '0', $certificate_extensions
                                                                           >, 
                                                                           '11', '0', pk(~ltkS)>)
                                                                       >,
                                                                       ~ltkS)
                                                                 >)
                                                              >,
                                                              '32'),
                                                       <'fin', '0'>, '32'), 
                                                h(<
                                                   <
                                                    <
                                                     <
                                                      <
                                                       <
                                                        <
                                                         <'0', '1', '0x0303', ~tid, '0', $cipher_suites, '0', 
                                                          <'43', '0x0304'>, <'10', $g1, $g>, 
                                                          <'13', $sig_algs>, '40', $g1, $g1^~x>, 
                                                         '6', '0x0303', '40', $g>, 
                                                        '1', '0x0303', ~tid, '0', $cipher_suites.1, '0', 
                                                        <'43', '0x0304'>, <'10', $g1, $g>, 
                                                        <'13', $sig_algs.1>, '40', $g, $g^~x.1>, 
                                                       '2', '0x0303', p_ns, $cipher_suite, 
                                                       <'13', $sig_algs.2>, '40', $g, p_gy>, 
                                                      '8', $exts>, 
                                                     '13', '0', $certificate_extensions>, 
                                                    '11', '0', pk(~ltkS)>, 
                                                   '15', 
                                                   sign(<'server_cv', 
                                                         h(<
                                                            <
                                                             <
                                                              <
                                                               <
                                                                <
                                                                 <'0', '1', '0x0303', ~tid, '0', 
                                                                  $cipher_suites, '0', <'43', '0x0304'>, 
                                                                  <'10', $g1, $g>, <'13', $sig_algs>, '40', 
                                                                  $g1, $g1^~x>, 
                                                                 '6', '0x0303', '40', $g>, 
                                                                '1', '0x0303', ~tid, '0', $cipher_suites.1, 
                                                                '0', <'43', '0x0304'>, <'10', $g1, $g>, 
                                                                <'13', $sig_algs.1>, '40', $g, $g^~x.1>, 
                                                               '2', '0x0303', p_ns, $cipher_suite, 
                                                               <'13', $sig_algs.2>, '40', $g, p_gy>, 
                                                              '8', $exts>, 
                                                             '13', '0', $certificate_extensions>, 
                                                            '11', '0', pk(~ltkS)>)
                                                        >,
                                                        ~ltkS)
                                                  >)
                                               >)
                                         >)
                                      >,
                                      '32')
                    ) ▶₀ #l )
        qed
      qed
    next
      case recv_server_auth_case_03
      solve( (∃ #j.2.
               (!KU( Extract('0', Extract(p_gxy, Extract(~res_psk, '0'))) ) @ #j.2)
              ∧
               #j.2 < #j.1)  ∥
             ((∀ #k.
                (!KU( Extract('0', Extract(p_gxy, Extract(~res_psk, '0'))) ) @ #k)
               ⇒
                ¬(#k < #j.1)) ∧
              (∃ actor #l.
                (RevealPSK( actor,
                            Expand(Extract('0', Extract(p_gxy, Extract(~res_psk, '0'))),
                                   <'serverats', 
                                    h(<
                                       <
                                        <
                                         <
                                          <
                                           <
                                            <
                                             <
                                              <'0', '1', '0x0303', ~tid, '0', $cipher_suites, '0', 
                                               <'43', '0x0304'>, <'10', $g1, $g>, <'40', $g1, $g1^~x>, 
                                               <'45', '0', '1'>, <'42', '0'>, '41', 
                                               <~ticket, mask(~ticket_age_add, $ticket_age)>, 
                                               hmac(<
                                                     Expand(Expand(Extract(~res_psk, '0'), <'ext', 'pbk'>,
                                                                   '32'),
                                                            <'0', '0'>, '32'), 
                                                     h(<'0', '1', '0x0303', ~tid, '0', $cipher_suites, '0', 
                                                        <'43', '0x0304'>, <'10', $g1, $g>, 
                                                        <'40', $g1, $g1^~x>, <'45', '0', '1'>, <'42', '0'>, 
                                                        '41', <~ticket, mask(~ticket_age_add, $ticket_age)>, 
                                                        '0'>)
                                                    >)
                                              >, 
                                              '6', '0x0303', '40', $g>, 
                                             '1', '0x0303', ~tid, '0', $cipher_suites.1, '0', 
                                             <'43', '0x0304'>, <'10', $g1, $g>, <'13', $sig_algs>, '40', $g, 
                                             $g^~x.1>, 
                                            '2', '0x0303', p_ns, $cipher_suite, <'13', $sig_algs.1>, '40', 
                                            $g, p_gy>, 
                                           '8', $exts>, 
                                          '13', '0', $certificate_extensions>, 
                                         '11', '0', pk(~ltkS)>, 
                                        '15', 
                                        sign(<'server_cv', 
                                              h(<
                                                 <
                                                  <
                                                   <
                                                    <
                                                     <
                                                      <'0', '1', '0x0303', ~tid, '0', $cipher_suites, '0', 
                                                       <'43', '0x0304'>, <'10', $g1, $g>, 
                                                       <'40', $g1, $g1^~x>, <'45', '0', '1'>, <'42', '0'>, 
                                                       '41', <~ticket, mask(~ticket_age_add, $ticket_age)>, 
                                                       hmac(<
                                                             Expand(Expand(Extract(~res_psk, '0'),
                                                                           <'ext', 'pbk'>, '32'),
                                                                    <'0', '0'>, '32'), 
                                                             h(<'0', '1', '0x0303', ~tid, '0', 
                                                                $cipher_suites, '0', <'43', '0x0304'>, 
                                                                <'10', $g1, $g>, <'40', $g1, $g1^~x>, 
                                                                <'45', '0', '1'>, <'42', '0'>, '41', 
                                                                <~ticket, mask(~ticket_age_add, $ticket_age)
                                                                >, 
                                                                '0'>)
                                                            >)
                                                      >, 
                                                      '6', '0x0303', '40', $g>, 
                                                     '1', '0x0303', ~tid, '0', $cipher_suites.1, '0', 
                                                     <'43', '0x0304'>, <'10', $g1, $g>, <'13', $sig_algs>, 
                                                     '40', $g, $g^~x.1>, 
                                                    '2', '0x0303', p_ns, $cipher_suite, <'13', $sig_algs.1>, 
                                                    '40', $g, p_gy>, 
                                                   '8', $exts>, 
                                                  '13', '0', $certificate_extensions>, 
                                                 '11', '0', pk(~ltkS)>)
                                             >,
                                             ~ltkS)
                                       >, 
                                       '20', 
                                       hmac(<
                                             Expand(Expand(Extract(p_gxy, Extract(~res_psk, '0')),
                                                           <'serverhts', 
                                                            h(<
                                                               <
                                                                <
                                                                 <
                                                                  <
                                                                   <
                                                                    <
                                                                     <'0', '1', '0x0303', ~tid, '0', 
                                                                      $cipher_suites, '0', <'43', '0x0304'>, 
                                                                      <'10', $g1, $g>, <'40', $g1, $g1^~x>, 
                                                                      <'45', '0', '1'>, <'42', '0'>, '41', 
                                                                      <~ticket, 
                                                                       mask(~ticket_age_add, $ticket_age)>, 
                                                                      hmac(<
                                                                            Expand(Expand(Extract(~res_psk,
                                                                                                  '0'),
                                                                                          <'ext', 'pbk'>,
                                                                                          '32'),
                                                                                   <'0', '0'>, '32'), 
                                                                            h(<'0', '1', '0x0303', ~tid, '0', 
                                                                               $cipher_suites, '0', 
                                                                               <'43', '0x0304'>, 
                                                                               <'10', $g1, $g>, 
                                                                               <'40', $g1, $g1^~x>, 
                                                                               <'45', '0', '1'>, <'42', '0'>, 
                                                                               '41', 
                                                                               <~ticket, 
                                                                                mask(~ticket_age_add,
                                                                                     $ticket_age)
                                                                               >, 
                                                                               '0'>)
                                                                           >)
                                                                     >, 
                                                                     '6', '0x0303', '40', $g>, 
                                                                    '1', '0x0303', ~tid, '0', 
                                                                    $cipher_suites.1, '0', <'43', '0x0304'>, 
                                                                    <'10', $g1, $g>, <'13', $sig_algs>, '40', 
                                                                    $g, $g^~x.1>, 
                                                                   '2', '0x0303', p_ns, $cipher_suite, 
                                                                   <'13', $sig_algs.1>, '40', $g, p_gy>, 
                                                                  '8', $exts>, 
                                                                 '13', '0', $certificate_extensions>, 
                                                                '11', '0', pk(~ltkS)>, 
                                                               '15', 
                                                               sign(<'server_cv', 
                                                                     h(<
                                                                        <
                                                                         <
                                                                          <
                                                                           <
                                                                            <
                                                                             <'0', '1', '0x0303', ~tid, '0', 
                                                                              $cipher_suites, '0', 
                                                                              <'43', '0x0304'>, 
                                                                              <'10', $g1, $g>, 
                                                                              <'40', $g1, $g1^~x>, 
                                                                              <'45', '0', '1'>, <'42', '0'>, 
                                                                              '41', 
                                                                              <~ticket, 
                                                                               mask(~ticket_age_add,
                                                                                    $ticket_age)
                                                                              >, 
                                                                              hmac(<
                                                                                    Expand(Expand(Extract(~res_psk,
                                                                                                          '0'),
                                                                                                  <'ext', 
                                                                                                   'pbk'>,
                                                                                                  '32'),
                                                                                           <'0', '0'>, '32'), 
                                                                                    h(<'0', '1', '0x0303', 
                                                                                       ~tid, '0', 
                                                                                       $cipher_suites, '0', 
                                                                                       <'43', '0x0304'>, 
                                                                                       <'10', $g1, $g>, 
                                                                                       <'40', $g1, $g1^~x>, 
                                                                                       <'45', '0', '1'>, 
                                                                                       <'42', '0'>, '41', 
                                                                                       <~ticket, 
                                                                                        mask(~ticket_age_add,
                                                                                             $ticket_age)
                                                                                       >, 
                                                                                       '0'>)
                                                                                   >)
                                                                             >, 
                                                                             '6', '0x0303', '40', $g>, 
                                                                            '1', '0x0303', ~tid, '0', 
                                                                            $cipher_suites.1, '0', 
                                                                            <'43', '0x0304'>, 
                                                                            <'10', $g1, $g>, 
                                                                            <'13', $sig_algs>, '40', $g, 
                                                                            $g^~x.1>, 
                                                                           '2', '0x0303', p_ns, 
                                                                           $cipher_suite, 
                                                                           <'13', $sig_algs.1>, '40', $g, p_gy
                                                                          >, 
                                                                          '8', $exts>, 
                                                                         '13', '0', $certificate_extensions>, 
                                                                        '11', '0', pk(~ltkS)>)
                                                                    >,
                                                                    ~ltkS)
                                                              >)
                                                           >,
                                                           '32'),
                                                    <'fin', '0'>, '32'), 
                                             h(<
                                                <
                                                 <
                                                  <
                                                   <
                                                    <
                                                     <
                                                      <'0', '1', '0x0303', ~tid, '0', $cipher_suites, '0', 
                                                       <'43', '0x0304'>, <'10', $g1, $g>, 
                                                       <'40', $g1, $g1^~x>, <'45', '0', '1'>, <'42', '0'>, 
                                                       '41', <~ticket, mask(~ticket_age_add, $ticket_age)>, 
                                                       hmac(<
                                                             Expand(Expand(Extract(~res_psk, '0'),
                                                                           <'ext', 'pbk'>, '32'),
                                                                    <'0', '0'>, '32'), 
                                                             h(<'0', '1', '0x0303', ~tid, '0', 
                                                                $cipher_suites, '0', <'43', '0x0304'>, 
                                                                <'10', $g1, $g>, <'40', $g1, $g1^~x>, 
                                                                <'45', '0', '1'>, <'42', '0'>, '41', 
                                                                <~ticket, mask(~ticket_age_add, $ticket_age)
                                                                >, 
                                                                '0'>)
                                                            >)
                                                      >, 
                                                      '6', '0x0303', '40', $g>, 
                                                     '1', '0x0303', ~tid, '0', $cipher_suites.1, '0', 
                                                     <'43', '0x0304'>, <'10', $g1, $g>, <'13', $sig_algs>, 
                                                     '40', $g, $g^~x.1>, 
                                                    '2', '0x0303', p_ns, $cipher_suite, <'13', $sig_algs.1>, 
                                                    '40', $g, p_gy>, 
                                                   '8', $exts>, 
                                                  '13', '0', $certificate_extensions>, 
                                                 '11', '0', pk(~ltkS)>, 
                                                '15', 
                                                sign(<'server_cv', 
                                                      h(<
                                                         <
                                                          <
                                                           <
                                                            <
                                                             <
                                                              <'0', '1', '0x0303', ~tid, '0', $cipher_suites, 
                                                               '0', <'43', '0x0304'>, <'10', $g1, $g>, 
                                                               <'40', $g1, $g1^~x>, <'45', '0', '1'>, 
                                                               <'42', '0'>, '41', 
                                                               <~ticket, mask(~ticket_age_add, $ticket_age)>, 
                                                               hmac(<
                                                                     Expand(Expand(Extract(~res_psk, '0'),
                                                                                   <'ext', 'pbk'>, '32'),
                                                                            <'0', '0'>, '32'), 
                                                                     h(<'0', '1', '0x0303', ~tid, '0', 
                                                                        $cipher_suites, '0', 
                                                                        <'43', '0x0304'>, <'10', $g1, $g>, 
                                                                        <'40', $g1, $g1^~x>, 
                                                                        <'45', '0', '1'>, <'42', '0'>, '41', 
                                                                        <~ticket, 
                                                                         mask(~ticket_age_add, $ticket_age)>, 
                                                                        '0'>)
                                                                    >)
                                                              >, 
                                                              '6', '0x0303', '40', $g>, 
                                                             '1', '0x0303', ~tid, '0', $cipher_suites.1, '0', 
                                                             <'43', '0x0304'>, <'10', $g1, $g>, 
                                                             <'13', $sig_algs>, '40', $g, $g^~x.1>, 
                                                            '2', '0x0303', p_ns, $cipher_suite, 
                                                            <'13', $sig_algs.1>, '40', $g, p_gy>, 
                                                           '8', $exts>, 
                                                          '13', '0', $certificate_extensions>, 
                                                         '11', '0', pk(~ltkS)>)
                                                     >,
                                                     ~ltkS)
                                               >)
                                            >)
                                      >)
                                   >,
                                   '32')
                 ) @ #l)
               ∧
                #l < #j.1)) )
        case case_1
        solve( (∃ #r. (RevLtk( $S ) @ #r) ∧ #r < #vr)  ∥
               (∃ tid3 x #r. (RevDHExp( tid3, $S, x ) @ #r) ∧ #r < #vr)  ∥
               (∃ tid4 y #r. (RevDHExp( tid4, $C, y ) @ #r) ∧ #r < #vr)  ∥
               (∃ rms #r. (RevealPSK( $C, rms ) @ #r) ∧ #r < #k.1)  ∥
               (∃ rms #r. (RevealPSK( $S, rms ) @ #r) ∧ #r < #k.1) )
          case case_1
          by contradiction /* from formulas */
        next
          case case_2
          by contradiction /* from formulas */
        next
          case case_3
          by contradiction /* from formulas */
        next
          case case_4
          solve( (∃ #r. (RevLtk( $S ) @ #r) ∧ #r < #vr)  ∥
                 (∃ tid3 x #r. (RevDHExp( tid3, $S, x ) @ #r) ∧ #r < #vr)  ∥
                 (∃ tid4 y #r. (RevDHExp( tid4, $C, y ) @ #r) ∧ #r < #vr)  ∥
                 (∃ rms #r. (RevealPSK( $C, rms ) @ #r) ∧ #r < #vr)  ∥
                 (∃ rms #r. (RevealPSK( $S, rms ) @ #r) ∧ #r < #vr) )
            case case_1
            by contradiction /* from formulas */
          next
            case case_2
            by contradiction /* from formulas */
          next
            case case_3
            by contradiction /* from formulas */
          next
            case case_4
            by contradiction /* from formulas */
          next
            case case_5
            by contradiction /* from formulas */
          qed
        next
          case case_5
          solve( (∃ #r. (RevLtk( $S ) @ #r) ∧ #r < #vr)  ∥
                 (∃ tid3 x #r. (RevDHExp( tid3, $S, x ) @ #r) ∧ #r < #vr)  ∥
                 (∃ tid4 y #r. (RevDHExp( tid4, $C, y ) @ #r) ∧ #r < #vr)  ∥
                 (∃ rms #r. (RevealPSK( $C, rms ) @ #r) ∧ #r < #vr)  ∥
                 (∃ rms #r. (RevealPSK( $S, rms ) @ #r) ∧ #r < #vr) )
            case case_1
            by contradiction /* from formulas */
          next
            case case_2
            by contradiction /* from formulas */
          next
            case case_3
            by contradiction /* from formulas */
          next
            case case_4
            by contradiction /* from formulas */
          next
            case case_5
            by contradiction /* from formulas */
          qed
        qed
      next
        case case_2
        solve( !Ltk( $C, ~ltkC ) ▶₂ #i )
          case Register_pk
          by solve( SecretPSK( $A,
                               Expand(Extract('0', Extract(p_gxy, Extract(~res_psk, '0'))),
                                      <'serverats', 
                                       h(<
                                          <
                                           <
                                            <
                                             <
                                              <
                                               <
                                                <
                                                 <'0', '1', '0x0303', ~tid, '0', $cipher_suites, '0', 
                                                  <'43', '0x0304'>, <'10', $g1, $g>, <'40', $g1, $g1^~x>, 
                                                  <'45', '0', '1'>, <'42', '0'>, '41', 
                                                  <~ticket, mask(~ticket_age_add, $ticket_age)>, 
                                                  hmac(<
                                                        Expand(Expand(Extract(~res_psk, '0'), <'ext', 'pbk'>,
                                                                      '32'),
                                                               <'0', '0'>, '32'), 
                                                        h(<'0', '1', '0x0303', ~tid, '0', $cipher_suites, 
                                                           '0', <'43', '0x0304'>, <'10', $g1, $g>, 
                                                           <'40', $g1, $g1^~x>, <'45', '0', '1'>, 
                                                           <'42', '0'>, '41', 
                                                           <~ticket, mask(~ticket_age_add, $ticket_age)>, '0'
                                                          >)
                                                       >)
                                                 >, 
                                                 '6', '0x0303', '40', $g>, 
                                                '1', '0x0303', ~tid, '0', $cipher_suites.1, '0', 
                                                <'43', '0x0304'>, <'10', $g1, $g>, <'13', $sig_algs>, '40', 
                                                $g, $g^~x.1>, 
                                               '2', '0x0303', p_ns, $cipher_suite, <'13', $sig_algs.1>, '40', 
                                               $g, p_gy>, 
                                              '8', $exts>, 
                                             '13', '0', $certificate_extensions>, 
                                            '11', '0', pk(~ltkS)>, 
                                           '15', 
                                           sign(<'server_cv', 
                                                 h(<
                                                    <
                                                     <
                                                      <
                                                       <
                                                        <
                                                         <'0', '1', '0x0303', ~tid, '0', $cipher_suites, '0', 
                                                          <'43', '0x0304'>, <'10', $g1, $g>, 
                                                          <'40', $g1, $g1^~x>, <'45', '0', '1'>, <'42', '0'>, 
                                                          '41', 
                                                          <~ticket, mask(~ticket_age_add, $ticket_age)>, 
                                                          hmac(<
                                                                Expand(Expand(Extract(~res_psk, '0'),
                                                                              <'ext', 'pbk'>, '32'),
                                                                       <'0', '0'>, '32'), 
                                                                h(<'0', '1', '0x0303', ~tid, '0', 
                                                                   $cipher_suites, '0', <'43', '0x0304'>, 
                                                                   <'10', $g1, $g>, <'40', $g1, $g1^~x>, 
                                                                   <'45', '0', '1'>, <'42', '0'>, '41', 
                                                                   <~ticket, 
                                                                    mask(~ticket_age_add, $ticket_age)>, 
                                                                   '0'>)
                                                               >)
                                                         >, 
                                                         '6', '0x0303', '40', $g>, 
                                                        '1', '0x0303', ~tid, '0', $cipher_suites.1, '0', 
                                                        <'43', '0x0304'>, <'10', $g1, $g>, <'13', $sig_algs>, 
                                                        '40', $g, $g^~x.1>, 
                                                       '2', '0x0303', p_ns, $cipher_suite, 
                                                       <'13', $sig_algs.1>, '40', $g, p_gy>, 
                                                      '8', $exts>, 
                                                     '13', '0', $certificate_extensions>, 
                                                    '11', '0', pk(~ltkS)>)
                                                >,
                                                ~ltkS)
                                          >, 
                                          '20', 
                                          hmac(<
                                                Expand(Expand(Extract(p_gxy, Extract(~res_psk, '0')),
                                                              <'serverhts', 
                                                               h(<
                                                                  <
                                                                   <
                                                                    <
                                                                     <
                                                                      <
                                                                       <
                                                                        <'0', '1', '0x0303', ~tid, '0', 
                                                                         $cipher_suites, '0', 
                                                                         <'43', '0x0304'>, <'10', $g1, $g>, 
                                                                         <'40', $g1, $g1^~x>, 
                                                                         <'45', '0', '1'>, <'42', '0'>, '41', 
                                                                         <~ticket, 
                                                                          mask(~ticket_age_add, $ticket_age)
                                                                         >, 
                                                                         hmac(<
                                                                               Expand(Expand(Extract(~res_psk,
                                                                                                     '0'),
                                                                                             <'ext', 'pbk'>,
                                                                                             '32'),
                                                                                      <'0', '0'>, '32'), 
                                                                               h(<'0', '1', '0x0303', ~tid, 
                                                                                  '0', $cipher_suites, '0', 
                                                                                  <'43', '0x0304'>, 
                                                                                  <'10', $g1, $g>, 
                                                                                  <'40', $g1, $g1^~x>, 
                                                                                  <'45', '0', '1'>, 
                                                                                  <'42', '0'>, '41', 
                                                                                  <~ticket, 
                                                                                   mask(~ticket_age_add,
                                                                                        $ticket_age)
                                                                                  >, 
                                                                                  '0'>)
                                                                              >)
                                                                        >, 
                                                                        '6', '0x0303', '40', $g>, 
                                                                       '1', '0x0303', ~tid, '0', 
                                                                       $cipher_suites.1, '0', 
                                                                       <'43', '0x0304'>, <'10', $g1, $g>, 
                                                                       <'13', $sig_algs>, '40', $g, $g^~x.1>, 
                                                                      '2', '0x0303', p_ns, $cipher_suite, 
                                                                      <'13', $sig_algs.1>, '40', $g, p_gy>, 
                                                                     '8', $exts>, 
                                                                    '13', '0', $certificate_extensions>, 
                                                                   '11', '0', pk(~ltkS)>, 
                                                                  '15', 
                                                                  sign(<'server_cv', 
                                                                        h(<
                                                                           <
                                                                            <
                                                                             <
                                                                              <
                                                                               <
                                                                                <'0', '1', '0x0303', ~tid, 
                                                                                 '0', $cipher_suites, '0', 
                                                                                 <'43', '0x0304'>, 
                                                                                 <'10', $g1, $g>, 
                                                                                 <'40', $g1, $g1^~x>, 
                                                                                 <'45', '0', '1'>, 
                                                                                 <'42', '0'>, '41', 
                                                                                 <~ticket, 
                                                                                  mask(~ticket_age_add,
                                                                                       $ticket_age)
                                                                                 >, 
                                                                                 hmac(<
                                                                                       Expand(Expand(Extract(~res_psk,
                                                                                                             '0'),
                                                                                                     <'ext', 
                                                                                                      'pbk'>,
                                                                                                     '32'),
                                                                                              <'0', '0'>,
                                                                                              '32'), 
                                                                                       h(<'0', '1', '0x0303', 
                                                                                          ~tid, '0', 
                                                                                          $cipher_suites, 
                                                                                          '0', 
                                                                                          <'43', '0x0304'>, 
                                                                                          <'10', $g1, $g>, 
                                                                                          <'40', $g1, $g1^~x
                                                                                          >, 
                                                                                          <'45', '0', '1'>, 
                                                                                          <'42', '0'>, '41', 
                                                                                          <~ticket, 
                                                                                           mask(~ticket_age_add,
                                                                                                $ticket_age)
                                                                                          >, 
                                                                                          '0'>)
                                                                                      >)
                                                                                >, 
                                                                                '6', '0x0303', '40', $g>, 
                                                                               '1', '0x0303', ~tid, '0', 
                                                                               $cipher_suites.1, '0', 
                                                                               <'43', '0x0304'>, 
                                                                               <'10', $g1, $g>, 
                                                                               <'13', $sig_algs>, '40', $g, 
                                                                               $g^~x.1>, 
                                                                              '2', '0x0303', p_ns, 
                                                                              $cipher_suite, 
                                                                              <'13', $sig_algs.1>, '40', $g, 
                                                                              p_gy>, 
                                                                             '8', $exts>, 
                                                                            '13', '0', $certificate_extensions
                                                                           >, 
                                                                           '11', '0', pk(~ltkS)>)
                                                                       >,
                                                                       ~ltkS)
                                                                 >)
                                                              >,
                                                              '32'),
                                                       <'fin', '0'>, '32'), 
                                                h(<
                                                   <
                                                    <
                                                     <
                                                      <
                                                       <
                                                        <
                                                         <'0', '1', '0x0303', ~tid, '0', $cipher_suites, '0', 
                                                          <'43', '0x0304'>, <'10', $g1, $g>, 
                                                          <'40', $g1, $g1^~x>, <'45', '0', '1'>, <'42', '0'>, 
                                                          '41', 
                                                          <~ticket, mask(~ticket_age_add, $ticket_age)>, 
                                                          hmac(<
                                                                Expand(Expand(Extract(~res_psk, '0'),
                                                                              <'ext', 'pbk'>, '32'),
                                                                       <'0', '0'>, '32'), 
                                                                h(<'0', '1', '0x0303', ~tid, '0', 
                                                                   $cipher_suites, '0', <'43', '0x0304'>, 
                                                                   <'10', $g1, $g>, <'40', $g1, $g1^~x>, 
                                                                   <'45', '0', '1'>, <'42', '0'>, '41', 
                                                                   <~ticket, 
                                                                    mask(~ticket_age_add, $ticket_age)>, 
                                                                   '0'>)
                                                               >)
                                                         >, 
                                                         '6', '0x0303', '40', $g>, 
                                                        '1', '0x0303', ~tid, '0', $cipher_suites.1, '0', 
                                                        <'43', '0x0304'>, <'10', $g1, $g>, <'13', $sig_algs>, 
                                                        '40', $g, $g^~x.1>, 
                                                       '2', '0x0303', p_ns, $cipher_suite, 
                                                       <'13', $sig_algs.1>, '40', $g, p_gy>, 
                                                      '8', $exts>, 
                                                     '13', '0', $certificate_extensions>, 
                                                    '11', '0', pk(~ltkS)>, 
                                                   '15', 
                                                   sign(<'server_cv', 
                                                         h(<
                                                            <
                                                             <
                                                              <
                                                               <
                                                                <
                                                                 <'0', '1', '0x0303', ~tid, '0', 
                                                                  $cipher_suites, '0', <'43', '0x0304'>, 
                                                                  <'10', $g1, $g>, <'40', $g1, $g1^~x>, 
                                                                  <'45', '0', '1'>, <'42', '0'>, '41', 
                                                                  <~ticket, mask(~ticket_age_add, $ticket_age)
                                                                  >, 
                                                                  hmac(<
                                                                        Expand(Expand(Extract(~res_psk, '0'),
                                                                                      <'ext', 'pbk'>, '32'),
                                                                               <'0', '0'>, '32'), 
                                                                        h(<'0', '1', '0x0303', ~tid, '0', 
                                                                           $cipher_suites, '0', 
                                                                           <'43', '0x0304'>, <'10', $g1, $g>, 
                                                                           <'40', $g1, $g1^~x>, 
                                                                           <'45', '0', '1'>, <'42', '0'>, 
                                                                           '41', 
                                                                           <~ticket, 
                                                                            mask(~ticket_age_add, $ticket_age)
                                                                           >, 
                                                                           '0'>)
                                                                       >)
                                                                 >, 
                                                                 '6', '0x0303', '40', $g>, 
                                                                '1', '0x0303', ~tid, '0', $cipher_suites.1, 
                                                                '0', <'43', '0x0304'>, <'10', $g1, $g>, 
                                                                <'13', $sig_algs>, '40', $g, $g^~x.1>, 
                                                               '2', '0x0303', p_ns, $cipher_suite, 
                                                               <'13', $sig_algs.1>, '40', $g, p_gy>, 
                                                              '8', $exts>, 
                                                             '13', '0', $certificate_extensions>, 
                                                            '11', '0', pk(~ltkS)>)
                                                        >,
                                                        ~ltkS)
                                                  >)
                                               >)
                                         >)
                                      >,
                                      '32')
                    ) ▶₀ #l )
        qed
      qed
    next
      case recv_server_auth_case_04
      solve( (∃ #j.2.
               (!KU( Extract('0',
                             Extract(p_gxy, Extract(Expand(ms, <'rms', h(messages)>, '32'), '0')))
                ) @ #j.2)
              ∧
               #j.2 < #j.1)  ∥
             ((∀ #k.
                (!KU( Extract('0',
                              Extract(p_gxy, Extract(Expand(ms, <'rms', h(messages)>, '32'), '0')))
                 ) @ #k)
               ⇒
                ¬(#k < #j.1)) ∧
              (∃ actor #l.
                (RevealPSK( actor,
                            Expand(Extract('0',
                                           Extract(p_gxy,
                                                   Extract(Expand(ms, <'rms', h(messages)>, '32'), '0'))),
                                   <'serverats', 
                                    h(<
                                       <
                                        <
                                         <
                                          <
                                           <
                                            <
                                             <
                                              <'0', '1', '0x0303', ~tid, '0', $cipher_suites, '0', 
                                               <'43', '0x0304'>, <'10', $g1, $g>, <'40', $g1, $g1^~x>, 
                                               <'45', '0', '1'>, <'42', '0'>, '41', 
                                               <p_psk_id, mask(ticket_age_add, $ticket_age)>, 
                                               hmac(<
                                                     Expand(Expand(Extract(Expand(ms, <'rms', h(messages)>,
                                                                                  '32'),
                                                                           '0'),
                                                                   <'res', 'pbk'>, '32'),
                                                            <'0', '0'>, '32'), 
                                                     h(<'0', '1', '0x0303', ~tid, '0', $cipher_suites, '0', 
                                                        <'43', '0x0304'>, <'10', $g1, $g>, 
                                                        <'40', $g1, $g1^~x>, <'45', '0', '1'>, <'42', '0'>, 
                                                        '41', <p_psk_id, mask(ticket_age_add, $ticket_age)>, 
                                                        '0'>)
                                                    >)
                                              >, 
                                              '6', '0x0303', '40', $g>, 
                                             '1', '0x0303', ~tid, '0', $cipher_suites.1, '0', 
                                             <'43', '0x0304'>, <'10', $g1, $g>, <'13', $sig_algs>, '40', $g, 
                                             $g^~x.1>, 
                                            '2', '0x0303', p_ns, $cipher_suite, <'13', $sig_algs.1>, '40', 
                                            $g, p_gy>, 
                                           '8', $exts>, 
                                          '13', '0', $certificate_extensions>, 
                                         '11', '0', pk(~ltkS)>, 
                                        '15', 
                                        sign(<'server_cv', 
                                              h(<
                                                 <
                                                  <
                                                   <
                                                    <
                                                     <
                                                      <'0', '1', '0x0303', ~tid, '0', $cipher_suites, '0', 
                                                       <'43', '0x0304'>, <'10', $g1, $g>, 
                                                       <'40', $g1, $g1^~x>, <'45', '0', '1'>, <'42', '0'>, 
                                                       '41', <p_psk_id, mask(ticket_age_add, $ticket_age)>, 
                                                       hmac(<
                                                             Expand(Expand(Extract(Expand(ms,
                                                                                          <'rms', h(messages)
                                                                                          >,
                                                                                          '32'),
                                                                                   '0'),
                                                                           <'res', 'pbk'>, '32'),
                                                                    <'0', '0'>, '32'), 
                                                             h(<'0', '1', '0x0303', ~tid, '0', 
                                                                $cipher_suites, '0', <'43', '0x0304'>, 
                                                                <'10', $g1, $g>, <'40', $g1, $g1^~x>, 
                                                                <'45', '0', '1'>, <'42', '0'>, '41', 
                                                                <p_psk_id, mask(ticket_age_add, $ticket_age)
                                                                >, 
                                                                '0'>)
                                                            >)
                                                      >, 
                                                      '6', '0x0303', '40', $g>, 
                                                     '1', '0x0303', ~tid, '0', $cipher_suites.1, '0', 
                                                     <'43', '0x0304'>, <'10', $g1, $g>, <'13', $sig_algs>, 
                                                     '40', $g, $g^~x.1>, 
                                                    '2', '0x0303', p_ns, $cipher_suite, <'13', $sig_algs.1>, 
                                                    '40', $g, p_gy>, 
                                                   '8', $exts>, 
                                                  '13', '0', $certificate_extensions>, 
                                                 '11', '0', pk(~ltkS)>)
                                             >,
                                             ~ltkS)
                                       >, 
                                       '20', 
                                       hmac(<
                                             Expand(Expand(Extract(p_gxy,
                                                                   Extract(Expand(ms, <'rms', h(messages)>,
                                                                                  '32'),
                                                                           '0')),
                                                           <'serverhts', 
                                                            h(<
                                                               <
                                                                <
                                                                 <
                                                                  <
                                                                   <
                                                                    <
                                                                     <'0', '1', '0x0303', ~tid, '0', 
                                                                      $cipher_suites, '0', <'43', '0x0304'>, 
                                                                      <'10', $g1, $g>, <'40', $g1, $g1^~x>, 
                                                                      <'45', '0', '1'>, <'42', '0'>, '41', 
                                                                      <p_psk_id, 
                                                                       mask(ticket_age_add, $ticket_age)>, 
                                                                      hmac(<
                                                                            Expand(Expand(Extract(Expand(ms,
                                                                                                         <
                                                                                                          'rms', 
                                                                                                          h(messages)
                                                                                                         >,
                                                                                                         '32'),
                                                                                                  '0'),
                                                                                          <'res', 'pbk'>,
                                                                                          '32'),
                                                                                   <'0', '0'>, '32'), 
                                                                            h(<'0', '1', '0x0303', ~tid, '0', 
                                                                               $cipher_suites, '0', 
                                                                               <'43', '0x0304'>, 
                                                                               <'10', $g1, $g>, 
                                                                               <'40', $g1, $g1^~x>, 
                                                                               <'45', '0', '1'>, <'42', '0'>, 
                                                                               '41', 
                                                                               <p_psk_id, 
                                                                                mask(ticket_age_add,
                                                                                     $ticket_age)
                                                                               >, 
                                                                               '0'>)
                                                                           >)
                                                                     >, 
                                                                     '6', '0x0303', '40', $g>, 
                                                                    '1', '0x0303', ~tid, '0', 
                                                                    $cipher_suites.1, '0', <'43', '0x0304'>, 
                                                                    <'10', $g1, $g>, <'13', $sig_algs>, '40', 
                                                                    $g, $g^~x.1>, 
                                                                   '2', '0x0303', p_ns, $cipher_suite, 
                                                                   <'13', $sig_algs.1>, '40', $g, p_gy>, 
                                                                  '8', $exts>, 
                                                                 '13', '0', $certificate_extensions>, 
                                                                '11', '0', pk(~ltkS)>, 
                                                               '15', 
                                                               sign(<'server_cv', 
                                                                     h(<
                                                                        <
                                                                         <
                                                                          <
                                                                           <
                                                                            <
                                                                             <'0', '1', '0x0303', ~tid, '0', 
                                                                              $cipher_suites, '0', 
                                                                              <'43', '0x0304'>, 
                                                                              <'10', $g1, $g>, 
                                                                              <'40', $g1, $g1^~x>, 
                                                                              <'45', '0', '1'>, <'42', '0'>, 
                                                                              '41', 
                                                                              <p_psk_id, 
                                                                               mask(ticket_age_add,
                                                                                    $ticket_age)
                                                                              >, 
                                                                              hmac(<
                                                                                    Expand(Expand(Extract(Expand(ms,
                                                                                                                 <
                                                                                                                  'rms', 
                                                                                                                  h(messages)
                                                                                                                 >,
                                                                                                                 '32'),
                                                                                                          '0'),
                                                                                                  <'res', 
                                                                                                   'pbk'>,
                                                                                                  '32'),
                                                                                           <'0', '0'>, '32'), 
                                                                                    h(<'0', '1', '0x0303', 
                                                                                       ~tid, '0', 
                                                                                       $cipher_suites, '0', 
                                                                                       <'43', '0x0304'>, 
                                                                                       <'10', $g1, $g>, 
                                                                                       <'40', $g1, $g1^~x>, 
                                                                                       <'45', '0', '1'>, 
                                                                                       <'42', '0'>, '41', 
                                                                                       <p_psk_id, 
                                                                                        mask(ticket_age_add,
                                                                                             $ticket_age)
                                                                                       >, 
                                                                                       '0'>)
                                                                                   >)
                                                                             >, 
                                                                             '6', '0x0303', '40', $g>, 
                                                                            '1', '0x0303', ~tid, '0', 
                                                                            $cipher_suites.1, '0', 
                                                                            <'43', '0x0304'>, 
                                                                            <'10', $g1, $g>, 
                                                                            <'13', $sig_algs>, '40', $g, 
                                                                            $g^~x.1>, 
                                                                           '2', '0x0303', p_ns, 
                                                                           $cipher_suite, 
                                                                           <'13', $sig_algs.1>, '40', $g, p_gy
                                                                          >, 
                                                                          '8', $exts>, 
                                                                         '13', '0', $certificate_extensions>, 
                                                                        '11', '0', pk(~ltkS)>)
                                                                    >,
                                                                    ~ltkS)
                                                              >)
                                                           >,
                                                           '32'),
                                                    <'fin', '0'>, '32'), 
                                             h(<
                                                <
                                                 <
                                                  <
                                                   <
                                                    <
                                                     <
                                                      <'0', '1', '0x0303', ~tid, '0', $cipher_suites, '0', 
                                                       <'43', '0x0304'>, <'10', $g1, $g>, 
                                                       <'40', $g1, $g1^~x>, <'45', '0', '1'>, <'42', '0'>, 
                                                       '41', <p_psk_id, mask(ticket_age_add, $ticket_age)>, 
                                                       hmac(<
                                                             Expand(Expand(Extract(Expand(ms,
                                                                                          <'rms', h(messages)
                                                                                          >,
                                                                                          '32'),
                                                                                   '0'),
                                                                           <'res', 'pbk'>, '32'),
                                                                    <'0', '0'>, '32'), 
                                                             h(<'0', '1', '0x0303', ~tid, '0', 
                                                                $cipher_suites, '0', <'43', '0x0304'>, 
                                                                <'10', $g1, $g>, <'40', $g1, $g1^~x>, 
                                                                <'45', '0', '1'>, <'42', '0'>, '41', 
                                                                <p_psk_id, mask(ticket_age_add, $ticket_age)
                                                                >, 
                                                                '0'>)
                                                            >)
                                                      >, 
                                                      '6', '0x0303', '40', $g>, 
                                                     '1', '0x0303', ~tid, '0', $cipher_suites.1, '0', 
                                                     <'43', '0x0304'>, <'10', $g1, $g>, <'13', $sig_algs>, 
                                                     '40', $g, $g^~x.1>, 
                                                    '2', '0x0303', p_ns, $cipher_suite, <'13', $sig_algs.1>, 
                                                    '40', $g, p_gy>, 
                                                   '8', $exts>, 
                                                  '13', '0', $certificate_extensions>, 
                                                 '11', '0', pk(~ltkS)>, 
                                                '15', 
                                                sign(<'server_cv', 
                                                      h(<
                                                         <
                                                          <
                                                           <
                                                            <
                                                             <
                                                              <'0', '1', '0x0303', ~tid, '0', $cipher_suites, 
                                                               '0', <'43', '0x0304'>, <'10', $g1, $g>, 
                                                               <'40', $g1, $g1^~x>, <'45', '0', '1'>, 
                                                               <'42', '0'>, '41', 
                                                               <p_psk_id, mask(ticket_age_add, $ticket_age)>, 
                                                               hmac(<
                                                                     Expand(Expand(Extract(Expand(ms,
                                                                                                  <'rms', 
                                                                                                   h(messages)
                                                                                                  >,
                                                                                                  '32'),
                                                                                           '0'),
                                                                                   <'res', 'pbk'>, '32'),
                                                                            <'0', '0'>, '32'), 
                                                                     h(<'0', '1', '0x0303', ~tid, '0', 
                                                                        $cipher_suites, '0', 
                                                                        <'43', '0x0304'>, <'10', $g1, $g>, 
                                                                        <'40', $g1, $g1^~x>, 
                                                                        <'45', '0', '1'>, <'42', '0'>, '41', 
                                                                        <p_psk_id, 
                                                                         mask(ticket_age_add, $ticket_age)>, 
                                                                        '0'>)
                                                                    >)
                                                              >, 
                                                              '6', '0x0303', '40', $g>, 
                                                             '1', '0x0303', ~tid, '0', $cipher_suites.1, '0', 
                                                             <'43', '0x0304'>, <'10', $g1, $g>, 
                                                             <'13', $sig_algs>, '40', $g, $g^~x.1>, 
                                                            '2', '0x0303', p_ns, $cipher_suite, 
                                                            <'13', $sig_algs.1>, '40', $g, p_gy>, 
                                                           '8', $exts>, 
                                                          '13', '0', $certificate_extensions>, 
                                                         '11', '0', pk(~ltkS)>)
                                                     >,
                                                     ~ltkS)
                                               >)
                                            >)
                                      >)
                                   >,
                                   '32')
                 ) @ #l)
               ∧
                #l < #j.1)) )
        case case_1
        solve( (∃ #r. (RevLtk( $S ) @ #r) ∧ #r < #vr)  ∥
               (∃ tid3 x #r. (RevDHExp( tid3, $S, x ) @ #r) ∧ #r < #vr)  ∥
               (∃ tid4 y #r. (RevDHExp( tid4, $C, y ) @ #r) ∧ #r < #vr)  ∥
               (∃ rms #r. (RevealPSK( $C, rms ) @ #r) ∧ #r < #k.1)  ∥
               (∃ rms #r. (RevealPSK( $S, rms ) @ #r) ∧ #r < #k.1) )
          case case_1
          by contradiction /* from formulas */
        next
          case case_2
          by contradiction /* from formulas */
        next
          case case_3
          by contradiction /* from formulas */
        next
          case case_4
          solve( (∃ #r. (RevLtk( $S ) @ #r) ∧ #r < #vr)  ∥
                 (∃ tid3 x #r. (RevDHExp( tid3, $S, x ) @ #r) ∧ #r < #vr)  ∥
                 (∃ tid4 y #r. (RevDHExp( tid4, $C, y ) @ #r) ∧ #r < #vr)  ∥
                 (∃ rms #r. (RevealPSK( $C, rms ) @ #r) ∧ #r < #vr)  ∥
                 (∃ rms #r. (RevealPSK( $S, rms ) @ #r) ∧ #r < #vr) )
            case case_1
            by contradiction /* from formulas */
          next
            case case_2
            by contradiction /* from formulas */
          next
            case case_3
            by contradiction /* from formulas */
          next
            case case_4
            by contradiction /* from formulas */
          next
            case case_5
            by contradiction /* from formulas */
          qed
        next
          case case_5
          solve( (∃ #r. (RevLtk( $S ) @ #r) ∧ #r < #vr)  ∥
                 (∃ tid3 x #r. (RevDHExp( tid3, $S, x ) @ #r) ∧ #r < #vr)  ∥
                 (∃ tid4 y #r. (RevDHExp( tid4, $C, y ) @ #r) ∧ #r < #vr)  ∥
                 (∃ rms #r. (RevealPSK( $C, rms ) @ #r) ∧ #r < #vr)  ∥
                 (∃ rms #r. (RevealPSK( $S, rms ) @ #r) ∧ #r < #vr) )
            case case_1
            by contradiction /* from formulas */
          next
            case case_2
            by contradiction /* from formulas */
          next
            case case_3
            by contradiction /* from formulas */
          next
            case case_4
            by contradiction /* from formulas */
          next
            case case_5
            by contradiction /* from formulas */
          qed
        qed
      next
        case case_2
        solve( !Ltk( $C, ~ltkC ) ▶₂ #i )
          case Register_pk
          by solve( SecretPSK( $A,
                               Expand(Extract('0',
                                              Extract(p_gxy,
                                                      Extract(Expand(ms, <'rms', h(messages)>, '32'), '0'))),
                                      <'serverats', 
                                       h(<
                                          <
                                           <
                                            <
                                             <
                                              <
                                               <
                                                <
                                                 <'0', '1', '0x0303', ~tid, '0', $cipher_suites, '0', 
                                                  <'43', '0x0304'>, <'10', $g1, $g>, <'40', $g1, $g1^~x>, 
                                                  <'45', '0', '1'>, <'42', '0'>, '41', 
                                                  <p_psk_id, mask(ticket_age_add, $ticket_age)>, 
                                                  hmac(<
                                                        Expand(Expand(Extract(Expand(ms, <'rms', h(messages)>,
                                                                                     '32'),
                                                                              '0'),
                                                                      <'res', 'pbk'>, '32'),
                                                               <'0', '0'>, '32'), 
                                                        h(<'0', '1', '0x0303', ~tid, '0', $cipher_suites, 
                                                           '0', <'43', '0x0304'>, <'10', $g1, $g>, 
                                                           <'40', $g1, $g1^~x>, <'45', '0', '1'>, 
                                                           <'42', '0'>, '41', 
                                                           <p_psk_id, mask(ticket_age_add, $ticket_age)>, '0'
                                                          >)
                                                       >)
                                                 >, 
                                                 '6', '0x0303', '40', $g>, 
                                                '1', '0x0303', ~tid, '0', $cipher_suites.1, '0', 
                                                <'43', '0x0304'>, <'10', $g1, $g>, <'13', $sig_algs>, '40', 
                                                $g, $g^~x.1>, 
                                               '2', '0x0303', p_ns, $cipher_suite, <'13', $sig_algs.1>, '40', 
                                               $g, p_gy>, 
                                              '8', $exts>, 
                                             '13', '0', $certificate_extensions>, 
                                            '11', '0', pk(~ltkS)>, 
                                           '15', 
                                           sign(<'server_cv', 
                                                 h(<
                                                    <
                                                     <
                                                      <
                                                       <
                                                        <
                                                         <'0', '1', '0x0303', ~tid, '0', $cipher_suites, '0', 
                                                          <'43', '0x0304'>, <'10', $g1, $g>, 
                                                          <'40', $g1, $g1^~x>, <'45', '0', '1'>, <'42', '0'>, 
                                                          '41', 
                                                          <p_psk_id, mask(ticket_age_add, $ticket_age)>, 
                                                          hmac(<
                                                                Expand(Expand(Extract(Expand(ms,
                                                                                             <'rms', 
                                                                                              h(messages)>,
                                                                                             '32'),
                                                                                      '0'),
                                                                              <'res', 'pbk'>, '32'),
                                                                       <'0', '0'>, '32'), 
                                                                h(<'0', '1', '0x0303', ~tid, '0', 
                                                                   $cipher_suites, '0', <'43', '0x0304'>, 
                                                                   <'10', $g1, $g>, <'40', $g1, $g1^~x>, 
                                                                   <'45', '0', '1'>, <'42', '0'>, '41', 
                                                                   <p_psk_id, 
                                                                    mask(ticket_age_add, $ticket_age)>, 
                                                                   '0'>)
                                                               >)
                                                         >, 
                                                         '6', '0x0303', '40', $g>, 
                                                        '1', '0x0303', ~tid, '0', $cipher_suites.1, '0', 
                                                        <'43', '0x0304'>, <'10', $g1, $g>, <'13', $sig_algs>, 
                                                        '40', $g, $g^~x.1>, 
                                                       '2', '0x0303', p_ns, $cipher_suite, 
                                                       <'13', $sig_algs.1>, '40', $g, p_gy>, 
                                                      '8', $exts>, 
                                                     '13', '0', $certificate_extensions>, 
                                                    '11', '0', pk(~ltkS)>)
                                                >,
                                                ~ltkS)
                                          >, 
                                          '20', 
                                          hmac(<
                                                Expand(Expand(Extract(p_gxy,
                                                                      Extract(Expand(ms, <'rms', h(messages)>,
                                                                                     '32'),
                                                                              '0')),
                                                              <'serverhts', 
                                                               h(<
                                                                  <
                                                                   <
                                                                    <
                                                                     <
                                                                      <
                                                                       <
                                                                        <'0', '1', '0x0303', ~tid, '0', 
                                                                         $cipher_suites, '0', 
                                                                         <'43', '0x0304'>, <'10', $g1, $g>, 
                                                                         <'40', $g1, $g1^~x>, 
                                                                         <'45', '0', '1'>, <'42', '0'>, '41', 
                                                                         <p_psk_id, 
                                                                          mask(ticket_age_add, $ticket_age)>, 
                                                                         hmac(<
                                                                               Expand(Expand(Extract(Expand(ms,
                                                                                                            <
                                                                                                             'rms', 
                                                                                                             h(messages)
                                                                                                            >,
                                                                                                            '32'),
                                                                                                     '0'),
                                                                                             <'res', 'pbk'>,
                                                                                             '32'),
                                                                                      <'0', '0'>, '32'), 
                                                                               h(<'0', '1', '0x0303', ~tid, 
                                                                                  '0', $cipher_suites, '0', 
                                                                                  <'43', '0x0304'>, 
                                                                                  <'10', $g1, $g>, 
                                                                                  <'40', $g1, $g1^~x>, 
                                                                                  <'45', '0', '1'>, 
                                                                                  <'42', '0'>, '41', 
                                                                                  <p_psk_id, 
                                                                                   mask(ticket_age_add,
                                                                                        $ticket_age)
                                                                                  >, 
                                                                                  '0'>)
                                                                              >)
                                                                        >, 
                                                                        '6', '0x0303', '40', $g>, 
                                                                       '1', '0x0303', ~tid, '0', 
                                                                       $cipher_suites.1, '0', 
                                                                       <'43', '0x0304'>, <'10', $g1, $g>, 
                                                                       <'13', $sig_algs>, '40', $g, $g^~x.1>, 
                                                                      '2', '0x0303', p_ns, $cipher_suite, 
                                                                      <'13', $sig_algs.1>, '40', $g, p_gy>, 
                                                                     '8', $exts>, 
                                                                    '13', '0', $certificate_extensions>, 
                                                                   '11', '0', pk(~ltkS)>, 
                                                                  '15', 
                                                                  sign(<'server_cv', 
                                                                        h(<
                                                                           <
                                                                            <
                                                                             <
                                                                              <
                                                                               <
                                                                                <'0', '1', '0x0303', ~tid, 
                                                                                 '0', $cipher_suites, '0', 
                                                                                 <'43', '0x0304'>, 
                                                                                 <'10', $g1, $g>, 
                                                                                 <'40', $g1, $g1^~x>, 
                                                                                 <'45', '0', '1'>, 
                                                                                 <'42', '0'>, '41', 
                                                                                 <p_psk_id, 
                                                                                  mask(ticket_age_add,
                                                                                       $ticket_age)
                                                                                 >, 
                                                                                 hmac(<
                                                                                       Expand(Expand(Extract(Expand(ms,
                                                                                                                    <
                                                                                                                     'rms', 
                                                                                                                     h(messages)
                                                                                                                    >,
                                                                                                                    '32'),
                                                                                                             '0'),
                                                                                                     <'res', 
                                                                                                      'pbk'>,
                                                                                                     '32'),
                                                                                              <'0', '0'>,
                                                                                              '32'), 
                                                                                       h(<'0', '1', '0x0303', 
                                                                                          ~tid, '0', 
                                                                                          $cipher_suites, 
                                                                                          '0', 
                                                                                          <'43', '0x0304'>, 
                                                                                          <'10', $g1, $g>, 
                                                                                          <'40', $g1, $g1^~x
                                                                                          >, 
                                                                                          <'45', '0', '1'>, 
                                                                                          <'42', '0'>, '41', 
                                                                                          <p_psk_id, 
                                                                                           mask(ticket_age_add,
                                                                                                $ticket_age)
                                                                                          >, 
                                                                                          '0'>)
                                                                                      >)
                                                                                >, 
                                                                                '6', '0x0303', '40', $g>, 
                                                                               '1', '0x0303', ~tid, '0', 
                                                                               $cipher_suites.1, '0', 
                                                                               <'43', '0x0304'>, 
                                                                               <'10', $g1, $g>, 
                                                                               <'13', $sig_algs>, '40', $g, 
                                                                               $g^~x.1>, 
                                                                              '2', '0x0303', p_ns, 
                                                                              $cipher_suite, 
                                                                              <'13', $sig_algs.1>, '40', $g, 
                                                                              p_gy>, 
                                                                             '8', $exts>, 
                                                                            '13', '0', $certificate_extensions
                                                                           >, 
                                                                           '11', '0', pk(~ltkS)>)
                                                                       >,
                                                                       ~ltkS)
                                                                 >)
                                                              >,
                                                              '32'),
                                                       <'fin', '0'>, '32'), 
                                                h(<
                                                   <
                                                    <
                                                     <
                                                      <
                                                       <
                                                        <
                                                         <'0', '1', '0x0303', ~tid, '0', $cipher_suites, '0', 
                                                          <'43', '0x0304'>, <'10', $g1, $g>, 
                                                          <'40', $g1, $g1^~x>, <'45', '0', '1'>, <'42', '0'>, 
                                                          '41', 
                                                          <p_psk_id, mask(ticket_age_add, $ticket_age)>, 
                                                          hmac(<
                                                                Expand(Expand(Extract(Expand(ms,
                                                                                             <'rms', 
                                                                                              h(messages)>,
                                                                                             '32'),
                                                                                      '0'),
                                                                              <'res', 'pbk'>, '32'),
                                                                       <'0', '0'>, '32'), 
                                                                h(<'0', '1', '0x0303', ~tid, '0', 
                                                                   $cipher_suites, '0', <'43', '0x0304'>, 
                                                                   <'10', $g1, $g>, <'40', $g1, $g1^~x>, 
                                                                   <'45', '0', '1'>, <'42', '0'>, '41', 
                                                                   <p_psk_id, 
                                                                    mask(ticket_age_add, $ticket_age)>, 
                                                                   '0'>)
                                                               >)
                                                         >, 
                                                         '6', '0x0303', '40', $g>, 
                                                        '1', '0x0303', ~tid, '0', $cipher_suites.1, '0', 
                                                        <'43', '0x0304'>, <'10', $g1, $g>, <'13', $sig_algs>, 
                                                        '40', $g, $g^~x.1>, 
                                                       '2', '0x0303', p_ns, $cipher_suite, 
                                                       <'13', $sig_algs.1>, '40', $g, p_gy>, 
                                                      '8', $exts>, 
                                                     '13', '0', $certificate_extensions>, 
                                                    '11', '0', pk(~ltkS)>, 
                                                   '15', 
                                                   sign(<'server_cv', 
                                                         h(<
                                                            <
                                                             <
                                                              <
                                                               <
                                                                <
                                                                 <'0', '1', '0x0303', ~tid, '0', 
                                                                  $cipher_suites, '0', <'43', '0x0304'>, 
                                                                  <'10', $g1, $g>, <'40', $g1, $g1^~x>, 
                                                                  <'45', '0', '1'>, <'42', '0'>, '41', 
                                                                  <p_psk_id, mask(ticket_age_add, $ticket_age)
                                                                  >, 
                                                                  hmac(<
                                                                        Expand(Expand(Extract(Expand(ms,
                                                                                                     <'rms', 
                                                                                                      h(messages)
                                                                                                     >,
                                                                                                     '32'),
                                                                                              '0'),
                                                                                      <'res', 'pbk'>, '32'),
                                                                               <'0', '0'>, '32'), 
                                                                        h(<'0', '1', '0x0303', ~tid, '0', 
                                                                           $cipher_suites, '0', 
                                                                           <'43', '0x0304'>, <'10', $g1, $g>, 
                                                                           <'40', $g1, $g1^~x>, 
                                                                           <'45', '0', '1'>, <'42', '0'>, 
                                                                           '41', 
                                                                           <p_psk_id, 
                                                                            mask(ticket_age_add, $ticket_age)
                                                                           >, 
                                                                           '0'>)
                                                                       >)
                                                                 >, 
                                                                 '6', '0x0303', '40', $g>, 
                                                                '1', '0x0303', ~tid, '0', $cipher_suites.1, 
                                                                '0', <'43', '0x0304'>, <'10', $g1, $g>, 
                                                                <'13', $sig_algs>, '40', $g, $g^~x.1>, 
                                                               '2', '0x0303', p_ns, $cipher_suite, 
                                                               <'13', $sig_algs.1>, '40', $g, p_gy>, 
                                                              '8', $exts>, 
                                                             '13', '0', $certificate_extensions>, 
                                                            '11', '0', pk(~ltkS)>)
                                                        >,
                                                        ~ltkS)
                                                  >)
                                               >)
                                         >)
                                      >,
                                      '32')
                    ) ▶₀ #l )
        qed
      qed
    next
      case recv_server_auth_case_05
      solve( (∃ #j.2.
               (!KU( Extract('0', Extract(p_gxy, Extract(~res_psk, '0'))) ) @ #j.2)
              ∧
               #j.2 < #j.1)  ∥
             ((∀ #k.
                (!KU( Extract('0', Extract(p_gxy, Extract(~res_psk, '0'))) ) @ #k)
               ⇒
                ¬(#k < #j.1)) ∧
              (∃ actor #l.
                (RevealPSK( actor,
                            Expand(Extract('0', Extract(p_gxy, Extract(~res_psk, '0'))),
                                   <'serverats', 
                                    h(<
                                       <
                                        <
                                         <
                                          <
                                           <
                                            <'0', '1', '0x0303', ~tid, '0', $cipher_suites, '0', 
                                             <'43', '0x0304'>, <'10', $g, $g2>, <'40', $g, $g^~x>, 
                                             <'45', '0', '1'>, <'42', '0'>, '41', 
                                             <~ticket, mask(~ticket_age_add, $ticket_age)>, 
                                             hmac(<
                                                   Expand(Expand(Extract(~res_psk, '0'), <'ext', 'pbk'>,
                                                                 '32'),
                                                          <'0', '0'>, '32'), 
                                                   h(<'0', '1', '0x0303', ~tid, '0', $cipher_suites, '0', 
                                                      <'43', '0x0304'>, <'10', $g, $g2>, <'40', $g, $g^~x>, 
                                                      <'45', '0', '1'>, <'42', '0'>, '41', 
                                                      <~ticket, mask(~ticket_age_add, $ticket_age)>, '0'>)
                                                  >)
                                            >, 
                                            '2', '0x0303', p_ns, $cipher_suite, <'13', $sig_algs>, '40', $g, 
                                            p_gy>, 
                                           '8', $exts>, 
                                          '13', '0', $certificate_extensions>, 
                                         '11', '0', pk(~ltkS)>, 
                                        '15', 
                                        sign(<'server_cv', 
                                              h(<
                                                 <
                                                  <
                                                   <
                                                    <'0', '1', '0x0303', ~tid, '0', $cipher_suites, '0', 
                                                     <'43', '0x0304'>, <'10', $g, $g2>, <'40', $g, $g^~x>, 
                                                     <'45', '0', '1'>, <'42', '0'>, '41', 
                                                     <~ticket, mask(~ticket_age_add, $ticket_age)>, 
                                                     hmac(<
                                                           Expand(Expand(Extract(~res_psk, '0'),
                                                                         <'ext', 'pbk'>, '32'),
                                                                  <'0', '0'>, '32'), 
                                                           h(<'0', '1', '0x0303', ~tid, '0', $cipher_suites, 
                                                              '0', <'43', '0x0304'>, <'10', $g, $g2>, 
                                                              <'40', $g, $g^~x>, <'45', '0', '1'>, 
                                                              <'42', '0'>, '41', 
                                                              <~ticket, mask(~ticket_age_add, $ticket_age)>, 
                                                              '0'>)
                                                          >)
                                                    >, 
                                                    '2', '0x0303', p_ns, $cipher_suite, <'13', $sig_algs>, 
                                                    '40', $g, p_gy>, 
                                                   '8', $exts>, 
                                                  '13', '0', $certificate_extensions>, 
                                                 '11', '0', pk(~ltkS)>)
                                             >,
                                             ~ltkS)
                                       >, 
                                       '20', 
                                       hmac(<
                                             Expand(Expand(Extract(p_gxy, Extract(~res_psk, '0')),
                                                           <'serverhts', 
                                                            h(<
                                                               <
                                                                <
                                                                 <
                                                                  <
                                                                   <'0', '1', '0x0303', ~tid, '0', 
                                                                    $cipher_suites, '0', <'43', '0x0304'>, 
                                                                    <'10', $g, $g2>, <'40', $g, $g^~x>, 
                                                                    <'45', '0', '1'>, <'42', '0'>, '41', 
                                                                    <~ticket, 
                                                                     mask(~ticket_age_add, $ticket_age)>, 
                                                                    hmac(<
                                                                          Expand(Expand(Extract(~res_psk,
                                                                                                '0'),
                                                                                        <'ext', 'pbk'>, '32'),
                                                                                 <'0', '0'>, '32'), 
                                                                          h(<'0', '1', '0x0303', ~tid, '0', 
                                                                             $cipher_suites, '0', 
                                                                             <'43', '0x0304'>, 
                                                                             <'10', $g, $g2>, 
                                                                             <'40', $g, $g^~x>, 
                                                                             <'45', '0', '1'>, <'42', '0'>, 
                                                                             '41', 
                                                                             <~ticket, 
                                                                              mask(~ticket_age_add,
                                                                                   $ticket_age)
                                                                             >, 
                                                                             '0'>)
                                                                         >)
                                                                   >, 
                                                                   '2', '0x0303', p_ns, $cipher_suite, 
                                                                   <'13', $sig_algs>, '40', $g, p_gy>, 
                                                                  '8', $exts>, 
                                                                 '13', '0', $certificate_extensions>, 
                                                                '11', '0', pk(~ltkS)>, 
                                                               '15', 
                                                               sign(<'server_cv', 
                                                                     h(<
                                                                        <
                                                                         <
                                                                          <
                                                                           <'0', '1', '0x0303', ~tid, '0', 
                                                                            $cipher_suites, '0', 
                                                                            <'43', '0x0304'>, 
                                                                            <'10', $g, $g2>, 
                                                                            <'40', $g, $g^~x>, 
                                                                            <'45', '0', '1'>, <'42', '0'>, 
                                                                            '41', 
                                                                            <~ticket, 
                                                                             mask(~ticket_age_add,
                                                                                  $ticket_age)
                                                                            >, 
                                                                            hmac(<
                                                                                  Expand(Expand(Extract(~res_psk,
                                                                                                        '0'),
                                                                                                <'ext', 'pbk'
                                                                                                >,
                                                                                                '32'),
                                                                                         <'0', '0'>, '32'), 
                                                                                  h(<'0', '1', '0x0303', 
                                                                                     ~tid, '0', 
                                                                                     $cipher_suites, '0', 
                                                                                     <'43', '0x0304'>, 
                                                                                     <'10', $g, $g2>, 
                                                                                     <'40', $g, $g^~x>, 
                                                                                     <'45', '0', '1'>, 
                                                                                     <'42', '0'>, '41', 
                                                                                     <~ticket, 
                                                                                      mask(~ticket_age_add,
                                                                                           $ticket_age)
                                                                                     >, 
                                                                                     '0'>)
                                                                                 >)
                                                                           >, 
                                                                           '2', '0x0303', p_ns, 
                                                                           $cipher_suite, <'13', $sig_algs>, 
                                                                           '40', $g, p_gy>, 
                                                                          '8', $exts>, 
                                                                         '13', '0', $certificate_extensions>, 
                                                                        '11', '0', pk(~ltkS)>)
                                                                    >,
                                                                    ~ltkS)
                                                              >)
                                                           >,
                                                           '32'),
                                                    <'fin', '0'>, '32'), 
                                             h(<
                                                <
                                                 <
                                                  <
                                                   <
                                                    <'0', '1', '0x0303', ~tid, '0', $cipher_suites, '0', 
                                                     <'43', '0x0304'>, <'10', $g, $g2>, <'40', $g, $g^~x>, 
                                                     <'45', '0', '1'>, <'42', '0'>, '41', 
                                                     <~ticket, mask(~ticket_age_add, $ticket_age)>, 
                                                     hmac(<
                                                           Expand(Expand(Extract(~res_psk, '0'),
                                                                         <'ext', 'pbk'>, '32'),
                                                                  <'0', '0'>, '32'), 
                                                           h(<'0', '1', '0x0303', ~tid, '0', $cipher_suites, 
                                                              '0', <'43', '0x0304'>, <'10', $g, $g2>, 
                                                              <'40', $g, $g^~x>, <'45', '0', '1'>, 
                                                              <'42', '0'>, '41', 
                                                              <~ticket, mask(~ticket_age_add, $ticket_age)>, 
                                                              '0'>)
                                                          >)
                                                    >, 
                                                    '2', '0x0303', p_ns, $cipher_suite, <'13', $sig_algs>, 
                                                    '40', $g, p_gy>, 
                                                   '8', $exts>, 
                                                  '13', '0', $certificate_extensions>, 
                                                 '11', '0', pk(~ltkS)>, 
                                                '15', 
                                                sign(<'server_cv', 
                                                      h(<
                                                         <
                                                          <
                                                           <
                                                            <'0', '1', '0x0303', ~tid, '0', $cipher_suites, 
                                                             '0', <'43', '0x0304'>, <'10', $g, $g2>, 
                                                             <'40', $g, $g^~x>, <'45', '0', '1'>, 
                                                             <'42', '0'>, '41', 
                                                             <~ticket, mask(~ticket_age_add, $ticket_age)>, 
                                                             hmac(<
                                                                   Expand(Expand(Extract(~res_psk, '0'),
                                                                                 <'ext', 'pbk'>, '32'),
                                                                          <'0', '0'>, '32'), 
                                                                   h(<'0', '1', '0x0303', ~tid, '0', 
                                                                      $cipher_suites, '0', <'43', '0x0304'>, 
                                                                      <'10', $g, $g2>, <'40', $g, $g^~x>, 
                                                                      <'45', '0', '1'>, <'42', '0'>, '41', 
                                                                      <~ticket, 
                                                                       mask(~ticket_age_add, $ticket_age)>, 
                                                                      '0'>)
                                                                  >)
                                                            >, 
                                                            '2', '0x0303', p_ns, $cipher_suite, 
                                                            <'13', $sig_algs>, '40', $g, p_gy>, 
                                                           '8', $exts>, 
                                                          '13', '0', $certificate_extensions>, 
                                                         '11', '0', pk(~ltkS)>)
                                                     >,
                                                     ~ltkS)
                                               >)
                                            >)
                                      >)
                                   >,
                                   '32')
                 ) @ #l)
               ∧
                #l < #j.1)) )
        case case_1
        solve( (∃ #r. (RevLtk( $S ) @ #r) ∧ #r < #vr)  ∥
               (∃ tid3 x #r. (RevDHExp( tid3, $S, x ) @ #r) ∧ #r < #vr)  ∥
               (∃ tid4 y #r. (RevDHExp( tid4, $C, y ) @ #r) ∧ #r < #vr)  ∥
               (∃ rms #r. (RevealPSK( $C, rms ) @ #r) ∧ #r < #k.1)  ∥
               (∃ rms #r. (RevealPSK( $S, rms ) @ #r) ∧ #r < #k.1) )
          case case_1
          by contradiction /* from formulas */
        next
          case case_2
          by contradiction /* from formulas */
        next
          case case_3
          by contradiction /* from formulas */
        next
          case case_4
          solve( (∃ #r. (RevLtk( $S ) @ #r) ∧ #r < #vr)  ∥
                 (∃ tid3 x #r. (RevDHExp( tid3, $S, x ) @ #r) ∧ #r < #vr)  ∥
                 (∃ tid4 y #r. (RevDHExp( tid4, $C, y ) @ #r) ∧ #r < #vr)  ∥
                 (∃ rms #r. (RevealPSK( $C, rms ) @ #r) ∧ #r < #vr)  ∥
                 (∃ rms #r. (RevealPSK( $S, rms ) @ #r) ∧ #r < #vr) )
            case case_1
            by contradiction /* from formulas */
          next
            case case_2
            by contradiction /* from formulas */
          next
            case case_3
            by contradiction /* from formulas */
          next
            case case_4
            by contradiction /* from formulas */
          next
            case case_5
            by contradiction /* from formulas */
          qed
        next
          case case_5
          solve( (∃ #r. (RevLtk( $S ) @ #r) ∧ #r < #vr)  ∥
                 (∃ tid3 x #r. (RevDHExp( tid3, $S, x ) @ #r) ∧ #r < #vr)  ∥
                 (∃ tid4 y #r. (RevDHExp( tid4, $C, y ) @ #r) ∧ #r < #vr)  ∥
                 (∃ rms #r. (RevealPSK( $C, rms ) @ #r) ∧ #r < #vr)  ∥
                 (∃ rms #r. (RevealPSK( $S, rms ) @ #r) ∧ #r < #vr) )
            case case_1
            by contradiction /* from formulas */
          next
            case case_2
            by contradiction /* from formulas */
          next
            case case_3
            by contradiction /* from formulas */
          next
            case case_4
            by contradiction /* from formulas */
          next
            case case_5
            by contradiction /* from formulas */
          qed
        qed
      next
        case case_2
        solve( !Ltk( $C, ~ltkC ) ▶₂ #i )
          case Register_pk
          by solve( SecretPSK( $A,
                               Expand(Extract('0', Extract(p_gxy, Extract(~res_psk, '0'))),
                                      <'serverats', 
                                       h(<
                                          <
                                           <
                                            <
                                             <
                                              <
                                               <'0', '1', '0x0303', ~tid, '0', $cipher_suites, '0', 
                                                <'43', '0x0304'>, <'10', $g, $g2>, <'40', $g, $g^~x>, 
                                                <'45', '0', '1'>, <'42', '0'>, '41', 
                                                <~ticket, mask(~ticket_age_add, $ticket_age)>, 
                                                hmac(<
                                                      Expand(Expand(Extract(~res_psk, '0'), <'ext', 'pbk'>,
                                                                    '32'),
                                                             <'0', '0'>, '32'), 
                                                      h(<'0', '1', '0x0303', ~tid, '0', $cipher_suites, '0', 
                                                         <'43', '0x0304'>, <'10', $g, $g2>, 
                                                         <'40', $g, $g^~x>, <'45', '0', '1'>, <'42', '0'>, 
                                                         '41', <~ticket, mask(~ticket_age_add, $ticket_age)>, 
                                                         '0'>)
                                                     >)
                                               >, 
                                               '2', '0x0303', p_ns, $cipher_suite, <'13', $sig_algs>, '40', 
                                               $g, p_gy>, 
                                              '8', $exts>, 
                                             '13', '0', $certificate_extensions>, 
                                            '11', '0', pk(~ltkS)>, 
                                           '15', 
                                           sign(<'server_cv', 
                                                 h(<
                                                    <
                                                     <
                                                      <
                                                       <'0', '1', '0x0303', ~tid, '0', $cipher_suites, '0', 
                                                        <'43', '0x0304'>, <'10', $g, $g2>, <'40', $g, $g^~x>, 
                                                        <'45', '0', '1'>, <'42', '0'>, '41', 
                                                        <~ticket, mask(~ticket_age_add, $ticket_age)>, 
                                                        hmac(<
                                                              Expand(Expand(Extract(~res_psk, '0'),
                                                                            <'ext', 'pbk'>, '32'),
                                                                     <'0', '0'>, '32'), 
                                                              h(<'0', '1', '0x0303', ~tid, '0', 
                                                                 $cipher_suites, '0', <'43', '0x0304'>, 
                                                                 <'10', $g, $g2>, <'40', $g, $g^~x>, 
                                                                 <'45', '0', '1'>, <'42', '0'>, '41', 
                                                                 <~ticket, mask(~ticket_age_add, $ticket_age)
                                                                 >, 
                                                                 '0'>)
                                                             >)
                                                       >, 
                                                       '2', '0x0303', p_ns, $cipher_suite, <'13', $sig_algs>, 
                                                       '40', $g, p_gy>, 
                                                      '8', $exts>, 
                                                     '13', '0', $certificate_extensions>, 
                                                    '11', '0', pk(~ltkS)>)
                                                >,
                                                ~ltkS)
                                          >, 
                                          '20', 
                                          hmac(<
                                                Expand(Expand(Extract(p_gxy, Extract(~res_psk, '0')),
                                                              <'serverhts', 
                                                               h(<
                                                                  <
                                                                   <
                                                                    <
                                                                     <
                                                                      <'0', '1', '0x0303', ~tid, '0', 
                                                                       $cipher_suites, '0', <'43', '0x0304'>, 
                                                                       <'10', $g, $g2>, <'40', $g, $g^~x>, 
                                                                       <'45', '0', '1'>, <'42', '0'>, '41', 
                                                                       <~ticket, 
                                                                        mask(~ticket_age_add, $ticket_age)>, 
                                                                       hmac(<
                                                                             Expand(Expand(Extract(~res_psk,
                                                                                                   '0'),
                                                                                           <'ext', 'pbk'>,
                                                                                           '32'),
                                                                                    <'0', '0'>, '32'), 
                                                                             h(<'0', '1', '0x0303', ~tid, 
                                                                                '0', $cipher_suites, '0', 
                                                                                <'43', '0x0304'>, 
                                                                                <'10', $g, $g2>, 
                                                                                <'40', $g, $g^~x>, 
                                                                                <'45', '0', '1'>, 
                                                                                <'42', '0'>, '41', 
                                                                                <~ticket, 
                                                                                 mask(~ticket_age_add,
                                                                                      $ticket_age)
                                                                                >, 
                                                                                '0'>)
                                                                            >)
                                                                      >, 
                                                                      '2', '0x0303', p_ns, $cipher_suite, 
                                                                      <'13', $sig_algs>, '40', $g, p_gy>, 
                                                                     '8', $exts>, 
                                                                    '13', '0', $certificate_extensions>, 
                                                                   '11', '0', pk(~ltkS)>, 
                                                                  '15', 
                                                                  sign(<'server_cv', 
                                                                        h(<
                                                                           <
                                                                            <
                                                                             <
                                                                              <'0', '1', '0x0303', ~tid, '0', 
                                                                               $cipher_suites, '0', 
                                                                               <'43', '0x0304'>, 
                                                                               <'10', $g, $g2>, 
                                                                               <'40', $g, $g^~x>, 
                                                                               <'45', '0', '1'>, <'42', '0'>, 
                                                                               '41', 
                                                                               <~ticket, 
                                                                                mask(~ticket_age_add,
                                                                                     $ticket_age)
                                                                               >, 
                                                                               hmac(<
                                                                                     Expand(Expand(Extract(~res_psk,
                                                                                                           '0'),
                                                                                                   <'ext', 
                                                                                                    'pbk'>,
                                                                                                   '32'),
                                                                                            <'0', '0'>,
                                                                                            '32'), 
                                                                                     h(<'0', '1', '0x0303', 
                                                                                        ~tid, '0', 
                                                                                        $cipher_suites, '0', 
                                                                                        <'43', '0x0304'>, 
                                                                                        <'10', $g, $g2>, 
                                                                                        <'40', $g, $g^~x>, 
                                                                                        <'45', '0', '1'>, 
                                                                                        <'42', '0'>, '41', 
                                                                                        <~ticket, 
                                                                                         mask(~ticket_age_add,
                                                                                              $ticket_age)
                                                                                        >, 
                                                                                        '0'>)
                                                                                    >)
                                                                              >, 
                                                                              '2', '0x0303', p_ns, 
                                                                              $cipher_suite, 
                                                                              <'13', $sig_algs>, '40', $g, 
                                                                              p_gy>, 
                                                                             '8', $exts>, 
                                                                            '13', '0', $certificate_extensions
                                                                           >, 
                                                                           '11', '0', pk(~ltkS)>)
                                                                       >,
                                                                       ~ltkS)
                                                                 >)
                                                              >,
                                                              '32'),
                                                       <'fin', '0'>, '32'), 
                                                h(<
                                                   <
                                                    <
                                                     <
                                                      <
                                                       <'0', '1', '0x0303', ~tid, '0', $cipher_suites, '0', 
                                                        <'43', '0x0304'>, <'10', $g, $g2>, <'40', $g, $g^~x>, 
                                                        <'45', '0', '1'>, <'42', '0'>, '41', 
                                                        <~ticket, mask(~ticket_age_add, $ticket_age)>, 
                                                        hmac(<
                                                              Expand(Expand(Extract(~res_psk, '0'),
                                                                            <'ext', 'pbk'>, '32'),
                                                                     <'0', '0'>, '32'), 
                                                              h(<'0', '1', '0x0303', ~tid, '0', 
                                                                 $cipher_suites, '0', <'43', '0x0304'>, 
                                                                 <'10', $g, $g2>, <'40', $g, $g^~x>, 
                                                                 <'45', '0', '1'>, <'42', '0'>, '41', 
                                                                 <~ticket, mask(~ticket_age_add, $ticket_age)
                                                                 >, 
                                                                 '0'>)
                                                             >)
                                                       >, 
                                                       '2', '0x0303', p_ns, $cipher_suite, <'13', $sig_algs>, 
                                                       '40', $g, p_gy>, 
                                                      '8', $exts>, 
                                                     '13', '0', $certificate_extensions>, 
                                                    '11', '0', pk(~ltkS)>, 
                                                   '15', 
                                                   sign(<'server_cv', 
                                                         h(<
                                                            <
                                                             <
                                                              <
                                                               <'0', '1', '0x0303', ~tid, '0', 
                                                                $cipher_suites, '0', <'43', '0x0304'>, 
                                                                <'10', $g, $g2>, <'40', $g, $g^~x>, 
                                                                <'45', '0', '1'>, <'42', '0'>, '41', 
                                                                <~ticket, mask(~ticket_age_add, $ticket_age)
                                                                >, 
                                                                hmac(<
                                                                      Expand(Expand(Extract(~res_psk, '0'),
                                                                                    <'ext', 'pbk'>, '32'),
                                                                             <'0', '0'>, '32'), 
                                                                      h(<'0', '1', '0x0303', ~tid, '0', 
                                                                         $cipher_suites, '0', 
                                                                         <'43', '0x0304'>, <'10', $g, $g2>, 
                                                                         <'40', $g, $g^~x>, <'45', '0', '1'>, 
                                                                         <'42', '0'>, '41', 
                                                                         <~ticket, 
                                                                          mask(~ticket_age_add, $ticket_age)
                                                                         >, 
                                                                         '0'>)
                                                                     >)
                                                               >, 
                                                               '2', '0x0303', p_ns, $cipher_suite, 
                                                               <'13', $sig_algs>, '40', $g, p_gy>, 
                                                              '8', $exts>, 
                                                             '13', '0', $certificate_extensions>, 
                                                            '11', '0', pk(~ltkS)>)
                                                        >,
                                                        ~ltkS)
                                                  >)
                                               >)
                                         >)
                                      >,
                                      '32')
                    ) ▶₀ #l )
        qed
      qed
    next
      case recv_server_auth_case_06
      solve( (∃ #j.2.
               (!KU( Extract('0',
                             Extract(p_gxy, Extract(Expand(ms, <'rms', h(messages)>, '32'), '0')))
                ) @ #j.2)
              ∧
               #j.2 < #j.1)  ∥
             ((∀ #k.
                (!KU( Extract('0',
                              Extract(p_gxy, Extract(Expand(ms, <'rms', h(messages)>, '32'), '0')))
                 ) @ #k)
               ⇒
                ¬(#k < #j.1)) ∧
              (∃ actor #l.
                (RevealPSK( actor,
                            Expand(Extract('0',
                                           Extract(p_gxy,
                                                   Extract(Expand(ms, <'rms', h(messages)>, '32'), '0'))),
                                   <'serverats', 
                                    h(<
                                       <
                                        <
                                         <
                                          <
                                           <
                                            <'0', '1', '0x0303', ~tid, '0', $cipher_suites, '0', 
                                             <'43', '0x0304'>, <'10', $g, $g2>, <'40', $g, $g^~x>, 
                                             <'45', '0', '1'>, <'42', '0'>, '41', 
                                             <p_psk_id, mask(ticket_age_add, $ticket_age)>, 
                                             hmac(<
                                                   Expand(Expand(Extract(Expand(ms, <'rms', h(messages)>,
                                                                                '32'),
                                                                         '0'),
                                                                 <'res', 'pbk'>, '32'),
                                                          <'0', '0'>, '32'), 
                                                   h(<'0', '1', '0x0303', ~tid, '0', $cipher_suites, '0', 
                                                      <'43', '0x0304'>, <'10', $g, $g2>, <'40', $g, $g^~x>, 
                                                      <'45', '0', '1'>, <'42', '0'>, '41', 
                                                      <p_psk_id, mask(ticket_age_add, $ticket_age)>, '0'>)
                                                  >)
                                            >, 
                                            '2', '0x0303', p_ns, $cipher_suite, <'13', $sig_algs>, '40', $g, 
                                            p_gy>, 
                                           '8', $exts>, 
                                          '13', '0', $certificate_extensions>, 
                                         '11', '0', pk(~ltkS)>, 
                                        '15', 
                                        sign(<'server_cv', 
                                              h(<
                                                 <
                                                  <
                                                   <
                                                    <'0', '1', '0x0303', ~tid, '0', $cipher_suites, '0', 
                                                     <'43', '0x0304'>, <'10', $g, $g2>, <'40', $g, $g^~x>, 
                                                     <'45', '0', '1'>, <'42', '0'>, '41', 
                                                     <p_psk_id, mask(ticket_age_add, $ticket_age)>, 
                                                     hmac(<
                                                           Expand(Expand(Extract(Expand(ms,
                                                                                        <'rms', h(messages)>,
                                                                                        '32'),
                                                                                 '0'),
                                                                         <'res', 'pbk'>, '32'),
                                                                  <'0', '0'>, '32'), 
                                                           h(<'0', '1', '0x0303', ~tid, '0', $cipher_suites, 
                                                              '0', <'43', '0x0304'>, <'10', $g, $g2>, 
                                                              <'40', $g, $g^~x>, <'45', '0', '1'>, 
                                                              <'42', '0'>, '41', 
                                                              <p_psk_id, mask(ticket_age_add, $ticket_age)>, 
                                                              '0'>)
                                                          >)
                                                    >, 
                                                    '2', '0x0303', p_ns, $cipher_suite, <'13', $sig_algs>, 
                                                    '40', $g, p_gy>, 
                                                   '8', $exts>, 
                                                  '13', '0', $certificate_extensions>, 
                                                 '11', '0', pk(~ltkS)>)
                                             >,
                                             ~ltkS)
                                       >, 
                                       '20', 
                                       hmac(<
                                             Expand(Expand(Extract(p_gxy,
                                                                   Extract(Expand(ms, <'rms', h(messages)>,
                                                                                  '32'),
                                                                           '0')),
                                                           <'serverhts', 
                                                            h(<
                                                               <
                                                                <
                                                                 <
                                                                  <
                                                                   <'0', '1', '0x0303', ~tid, '0', 
                                                                    $cipher_suites, '0', <'43', '0x0304'>, 
                                                                    <'10', $g, $g2>, <'40', $g, $g^~x>, 
                                                                    <'45', '0', '1'>, <'42', '0'>, '41', 
                                                                    <p_psk_id, 
                                                                     mask(ticket_age_add, $ticket_age)>, 
                                                                    hmac(<
                                                                          Expand(Expand(Extract(Expand(ms,
                                                                                                       <
                                                                                                        'rms', 
                                                                                                        h(messages)
                                                                                                       >,
                                                                                                       '32'),
                                                                                                '0'),
                                                                                        <'res', 'pbk'>, '32'),
                                                                                 <'0', '0'>, '32'), 
                                                                          h(<'0', '1', '0x0303', ~tid, '0', 
                                                                             $cipher_suites, '0', 
                                                                             <'43', '0x0304'>, 
                                                                             <'10', $g, $g2>, 
                                                                             <'40', $g, $g^~x>, 
                                                                             <'45', '0', '1'>, <'42', '0'>, 
                                                                             '41', 
                                                                             <p_psk_id, 
                                                                              mask(ticket_age_add,
                                                                                   $ticket_age)
                                                                             >, 
                                                                             '0'>)
                                                                         >)
                                                                   >, 
                                                                   '2', '0x0303', p_ns, $cipher_suite, 
                                                                   <'13', $sig_algs>, '40', $g, p_gy>, 
                                                                  '8', $exts>, 
                                                                 '13', '0', $certificate_extensions>, 
                                                                '11', '0', pk(~ltkS)>, 
                                                               '15', 
                                                               sign(<'server_cv', 
                                                                     h(<
                                                                        <
                                                                         <
                                                                          <
                                                                           <'0', '1', '0x0303', ~tid, '0', 
                                                                            $cipher_suites, '0', 
                                                                            <'43', '0x0304'>, 
                                                                            <'10', $g, $g2>, 
                                                                            <'40', $g, $g^~x>, 
                                                                            <'45', '0', '1'>, <'42', '0'>, 
                                                                            '41', 
                                                                            <p_psk_id, 
                                                                             mask(ticket_age_add, $ticket_age)
                                                                            >, 
                                                                            hmac(<
                                                                                  Expand(Expand(Extract(Expand(ms,
                                                                                                               <
                                                                                                                'rms', 
                                                                                                                h(messages)
                                                                                                               >,
                                                                                                               '32'),
                                                                                                        '0'),
                                                                                                <'res', 'pbk'
                                                                                                >,
                                                                                                '32'),
                                                                                         <'0', '0'>, '32'), 
                                                                                  h(<'0', '1', '0x0303', 
                                                                                     ~tid, '0', 
                                                                                     $cipher_suites, '0', 
                                                                                     <'43', '0x0304'>, 
                                                                                     <'10', $g, $g2>, 
                                                                                     <'40', $g, $g^~x>, 
                                                                                     <'45', '0', '1'>, 
                                                                                     <'42', '0'>, '41', 
                                                                                     <p_psk_id, 
                                                                                      mask(ticket_age_add,
                                                                                           $ticket_age)
                                                                                     >, 
                                                                                     '0'>)
                                                                                 >)
                                                                           >, 
                                                                           '2', '0x0303', p_ns, 
                                                                           $cipher_suite, <'13', $sig_algs>, 
                                                                           '40', $g, p_gy>, 
                                                                          '8', $exts>, 
                                                                         '13', '0', $certificate_extensions>, 
                                                                        '11', '0', pk(~ltkS)>)
                                                                    >,
                                                                    ~ltkS)
                                                              >)
                                                           >,
                                                           '32'),
                                                    <'fin', '0'>, '32'), 
                                             h(<
                                                <
                                                 <
                                                  <
                                                   <
                                                    <'0', '1', '0x0303', ~tid, '0', $cipher_suites, '0', 
                                                     <'43', '0x0304'>, <'10', $g, $g2>, <'40', $g, $g^~x>, 
                                                     <'45', '0', '1'>, <'42', '0'>, '41', 
                                                     <p_psk_id, mask(ticket_age_add, $ticket_age)>, 
                                                     hmac(<
                                                           Expand(Expand(Extract(Expand(ms,
                                                                                        <'rms', h(messages)>,
                                                                                        '32'),
                                                                                 '0'),
                                                                         <'res', 'pbk'>, '32'),
                                                                  <'0', '0'>, '32'), 
                                                           h(<'0', '1', '0x0303', ~tid, '0', $cipher_suites, 
                                                              '0', <'43', '0x0304'>, <'10', $g, $g2>, 
                                                              <'40', $g, $g^~x>, <'45', '0', '1'>, 
                                                              <'42', '0'>, '41', 
                                                              <p_psk_id, mask(ticket_age_add, $ticket_age)>, 
                                                              '0'>)
                                                          >)
                                                    >, 
                                                    '2', '0x0303', p_ns, $cipher_suite, <'13', $sig_algs>, 
                                                    '40', $g, p_gy>, 
                                                   '8', $exts>, 
                                                  '13', '0', $certificate_extensions>, 
                                                 '11', '0', pk(~ltkS)>, 
                                                '15', 
                                                sign(<'server_cv', 
                                                      h(<
                                                         <
                                                          <
                                                           <
                                                            <'0', '1', '0x0303', ~tid, '0', $cipher_suites, 
                                                             '0', <'43', '0x0304'>, <'10', $g, $g2>, 
                                                             <'40', $g, $g^~x>, <'45', '0', '1'>, 
                                                             <'42', '0'>, '41', 
                                                             <p_psk_id, mask(ticket_age_add, $ticket_age)>, 
                                                             hmac(<
                                                                   Expand(Expand(Extract(Expand(ms,
                                                                                                <'rms', 
                                                                                                 h(messages)>,
                                                                                                '32'),
                                                                                         '0'),
                                                                                 <'res', 'pbk'>, '32'),
                                                                          <'0', '0'>, '32'), 
                                                                   h(<'0', '1', '0x0303', ~tid, '0', 
                                                                      $cipher_suites, '0', <'43', '0x0304'>, 
                                                                      <'10', $g, $g2>, <'40', $g, $g^~x>, 
                                                                      <'45', '0', '1'>, <'42', '0'>, '41', 
                                                                      <p_psk_id, 
                                                                       mask(ticket_age_add, $ticket_age)>, 
                                                                      '0'>)
                                                                  >)
                                                            >, 
                                                            '2', '0x0303', p_ns, $cipher_suite, 
                                                            <'13', $sig_algs>, '40', $g, p_gy>, 
                                                           '8', $exts>, 
                                                          '13', '0', $certificate_extensions>, 
                                                         '11', '0', pk(~ltkS)>)
                                                     >,
                                                     ~ltkS)
                                               >)
                                            >)
                                      >)
                                   >,
                                   '32')
                 ) @ #l)
               ∧
                #l < #j.1)) )
        case case_1
        solve( (∃ #r. (RevLtk( $S ) @ #r) ∧ #r < #vr)  ∥
               (∃ tid3 x #r. (RevDHExp( tid3, $S, x ) @ #r) ∧ #r < #vr)  ∥
               (∃ tid4 y #r. (RevDHExp( tid4, $C, y ) @ #r) ∧ #r < #vr)  ∥
               (∃ rms #r. (RevealPSK( $C, rms ) @ #r) ∧ #r < #k.1)  ∥
               (∃ rms #r. (RevealPSK( $S, rms ) @ #r) ∧ #r < #k.1) )
          case case_1
          by contradiction /* from formulas */
        next
          case case_2
          by contradiction /* from formulas */
        next
          case case_3
          by contradiction /* from formulas */
        next
          case case_4
          solve( (∃ #r. (RevLtk( $S ) @ #r) ∧ #r < #vr)  ∥
                 (∃ tid3 x #r. (RevDHExp( tid3, $S, x ) @ #r) ∧ #r < #vr)  ∥
                 (∃ tid4 y #r. (RevDHExp( tid4, $C, y ) @ #r) ∧ #r < #vr)  ∥
                 (∃ rms #r. (RevealPSK( $C, rms ) @ #r) ∧ #r < #vr)  ∥
                 (∃ rms #r. (RevealPSK( $S, rms ) @ #r) ∧ #r < #vr) )
            case case_1
            by contradiction /* from formulas */
          next
            case case_2
            by contradiction /* from formulas */
          next
            case case_3
            by contradiction /* from formulas */
          next
            case case_4
            by contradiction /* from formulas */
          next
            case case_5
            by contradiction /* from formulas */
          qed
        next
          case case_5
          solve( (∃ #r. (RevLtk( $S ) @ #r) ∧ #r < #vr)  ∥
                 (∃ tid3 x #r. (RevDHExp( tid3, $S, x ) @ #r) ∧ #r < #vr)  ∥
                 (∃ tid4 y #r. (RevDHExp( tid4, $C, y ) @ #r) ∧ #r < #vr)  ∥
                 (∃ rms #r. (RevealPSK( $C, rms ) @ #r) ∧ #r < #vr)  ∥
                 (∃ rms #r. (RevealPSK( $S, rms ) @ #r) ∧ #r < #vr) )
            case case_1
            by contradiction /* from formulas */
          next
            case case_2
            by contradiction /* from formulas */
          next
            case case_3
            by contradiction /* from formulas */
          next
            case case_4
            by contradiction /* from formulas */
          next
            case case_5
            by contradiction /* from formulas */
          qed
        qed
      next
        case case_2
        solve( !Ltk( $C, ~ltkC ) ▶₂ #i )
          case Register_pk
          by solve( SecretPSK( $A,
                               Expand(Extract('0',
                                              Extract(p_gxy,
                                                      Extract(Expand(ms, <'rms', h(messages)>, '32'), '0'))),
                                      <'serverats', 
                                       h(<
                                          <
                                           <
                                            <
                                             <
                                              <
                                               <'0', '1', '0x0303', ~tid, '0', $cipher_suites, '0', 
                                                <'43', '0x0304'>, <'10', $g, $g2>, <'40', $g, $g^~x>, 
                                                <'45', '0', '1'>, <'42', '0'>, '41', 
                                                <p_psk_id, mask(ticket_age_add, $ticket_age)>, 
                                                hmac(<
                                                      Expand(Expand(Extract(Expand(ms, <'rms', h(messages)>,
                                                                                   '32'),
                                                                            '0'),
                                                                    <'res', 'pbk'>, '32'),
                                                             <'0', '0'>, '32'), 
                                                      h(<'0', '1', '0x0303', ~tid, '0', $cipher_suites, '0', 
                                                         <'43', '0x0304'>, <'10', $g, $g2>, 
                                                         <'40', $g, $g^~x>, <'45', '0', '1'>, <'42', '0'>, 
                                                         '41', <p_psk_id, mask(ticket_age_add, $ticket_age)>, 
                                                         '0'>)
                                                     >)
                                               >, 
                                               '2', '0x0303', p_ns, $cipher_suite, <'13', $sig_algs>, '40', 
                                               $g, p_gy>, 
                                              '8', $exts>, 
                                             '13', '0', $certificate_extensions>, 
                                            '11', '0', pk(~ltkS)>, 
                                           '15', 
                                           sign(<'server_cv', 
                                                 h(<
                                                    <
                                                     <
                                                      <
                                                       <'0', '1', '0x0303', ~tid, '0', $cipher_suites, '0', 
                                                        <'43', '0x0304'>, <'10', $g, $g2>, <'40', $g, $g^~x>, 
                                                        <'45', '0', '1'>, <'42', '0'>, '41', 
                                                        <p_psk_id, mask(ticket_age_add, $ticket_age)>, 
                                                        hmac(<
                                                              Expand(Expand(Extract(Expand(ms,
                                                                                           <'rms', h(messages)
                                                                                           >,
                                                                                           '32'),
                                                                                    '0'),
                                                                            <'res', 'pbk'>, '32'),
                                                                     <'0', '0'>, '32'), 
                                                              h(<'0', '1', '0x0303', ~tid, '0', 
                                                                 $cipher_suites, '0', <'43', '0x0304'>, 
                                                                 <'10', $g, $g2>, <'40', $g, $g^~x>, 
                                                                 <'45', '0', '1'>, <'42', '0'>, '41', 
                                                                 <p_psk_id, mask(ticket_age_add, $ticket_age)
                                                                 >, 
                                                                 '0'>)
                                                             >)
                                                       >, 
                                                       '2', '0x0303', p_ns, $cipher_suite, <'13', $sig_algs>, 
                                                       '40', $g, p_gy>, 
                                                      '8', $exts>, 
                                                     '13', '0', $certificate_extensions>, 
                                                    '11', '0', pk(~ltkS)>)
                                                >,
                                                ~ltkS)
                                          >, 
                                          '20', 
                                          hmac(<
                                                Expand(Expand(Extract(p_gxy,
                                                                      Extract(Expand(ms, <'rms', h(messages)>,
                                                                                     '32'),
                                                                              '0')),
                                                              <'serverhts', 
                                                               h(<
                                                                  <
                                                                   <
                                                                    <
                                                                     <
                                                                      <'0', '1', '0x0303', ~tid, '0', 
                                                                       $cipher_suites, '0', <'43', '0x0304'>, 
                                                                       <'10', $g, $g2>, <'40', $g, $g^~x>, 
                                                                       <'45', '0', '1'>, <'42', '0'>, '41', 
                                                                       <p_psk_id, 
                                                                        mask(ticket_age_add, $ticket_age)>, 
                                                                       hmac(<
                                                                             Expand(Expand(Extract(Expand(ms,
                                                                                                          <
                                                                                                           'rms', 
                                                                                                           h(messages)
                                                                                                          >,
                                                                                                          '32'),
                                                                                                   '0'),
                                                                                           <'res', 'pbk'>,
                                                                                           '32'),
                                                                                    <'0', '0'>, '32'), 
                                                                             h(<'0', '1', '0x0303', ~tid, 
                                                                                '0', $cipher_suites, '0', 
                                                                                <'43', '0x0304'>, 
                                                                                <'10', $g, $g2>, 
                                                                                <'40', $g, $g^~x>, 
                                                                                <'45', '0', '1'>, 
                                                                                <'42', '0'>, '41', 
                                                                                <p_psk_id, 
                                                                                 mask(ticket_age_add,
                                                                                      $ticket_age)
                                                                                >, 
                                                                                '0'>)
                                                                            >)
                                                                      >, 
                                                                      '2', '0x0303', p_ns, $cipher_suite, 
                                                                      <'13', $sig_algs>, '40', $g, p_gy>, 
                                                                     '8', $exts>, 
                                                                    '13', '0', $certificate_extensions>, 
                                                                   '11', '0', pk(~ltkS)>, 
                                                                  '15', 
                                                                  sign(<'server_cv', 
                                                                        h(<
                                                                           <
                                                                            <
                                                                             <
                                                                              <'0', '1', '0x0303', ~tid, '0', 
                                                                               $cipher_suites, '0', 
                                                                               <'43', '0x0304'>, 
                                                                               <'10', $g, $g2>, 
                                                                               <'40', $g, $g^~x>, 
                                                                               <'45', '0', '1'>, <'42', '0'>, 
                                                                               '41', 
                                                                               <p_psk_id, 
                                                                                mask(ticket_age_add,
                                                                                     $ticket_age)
                                                                               >, 
                                                                               hmac(<
                                                                                     Expand(Expand(Extract(Expand(ms,
                                                                                                                  <
                                                                                                                   'rms', 
                                                                                                                   h(messages)
                                                                                                                  >,
                                                                                                                  '32'),
                                                                                                           '0'),
                                                                                                   <'res', 
                                                                                                    'pbk'>,
                                                                                                   '32'),
                                                                                            <'0', '0'>,
                                                                                            '32'), 
                                                                                     h(<'0', '1', '0x0303', 
                                                                                        ~tid, '0', 
                                                                                        $cipher_suites, '0', 
                                                                                        <'43', '0x0304'>, 
                                                                                        <'10', $g, $g2>, 
                                                                                        <'40', $g, $g^~x>, 
                                                                                        <'45', '0', '1'>, 
                                                                                        <'42', '0'>, '41', 
                                                                                        <p_psk_id, 
                                                                                         mask(ticket_age_add,
                                                                                              $ticket_age)
                                                                                        >, 
                                                                                        '0'>)
                                                                                    >)
                                                                              >, 
                                                                              '2', '0x0303', p_ns, 
                                                                              $cipher_suite, 
                                                                              <'13', $sig_algs>, '40', $g, 
                                                                              p_gy>, 
                                                                             '8', $exts>, 
                                                                            '13', '0', $certificate_extensions
                                                                           >, 
                                                                           '11', '0', pk(~ltkS)>)
                                                                       >,
                                                                       ~ltkS)
                                                                 >)
                                                              >,
                                                              '32'),
                                                       <'fin', '0'>, '32'), 
                                                h(<
                                                   <
                                                    <
                                                     <
                                                      <
                                                       <'0', '1', '0x0303', ~tid, '0', $cipher_suites, '0', 
                                                        <'43', '0x0304'>, <'10', $g, $g2>, <'40', $g, $g^~x>, 
                                                        <'45', '0', '1'>, <'42', '0'>, '41', 
                                                        <p_psk_id, mask(ticket_age_add, $ticket_age)>, 
                                                        hmac(<
                                                              Expand(Expand(Extract(Expand(ms,
                                                                                           <'rms', h(messages)
                                                                                           >,
                                                                                           '32'),
                                                                                    '0'),
                                                                            <'res', 'pbk'>, '32'),
                                                                     <'0', '0'>, '32'), 
                                                              h(<'0', '1', '0x0303', ~tid, '0', 
                                                                 $cipher_suites, '0', <'43', '0x0304'>, 
                                                                 <'10', $g, $g2>, <'40', $g, $g^~x>, 
                                                                 <'45', '0', '1'>, <'42', '0'>, '41', 
                                                                 <p_psk_id, mask(ticket_age_add, $ticket_age)
                                                                 >, 
                                                                 '0'>)
                                                             >)
                                                       >, 
                                                       '2', '0x0303', p_ns, $cipher_suite, <'13', $sig_algs>, 
                                                       '40', $g, p_gy>, 
                                                      '8', $exts>, 
                                                     '13', '0', $certificate_extensions>, 
                                                    '11', '0', pk(~ltkS)>, 
                                                   '15', 
                                                   sign(<'server_cv', 
                                                         h(<
                                                            <
                                                             <
                                                              <
                                                               <'0', '1', '0x0303', ~tid, '0', 
                                                                $cipher_suites, '0', <'43', '0x0304'>, 
                                                                <'10', $g, $g2>, <'40', $g, $g^~x>, 
                                                                <'45', '0', '1'>, <'42', '0'>, '41', 
                                                                <p_psk_id, mask(ticket_age_add, $ticket_age)
                                                                >, 
                                                                hmac(<
                                                                      Expand(Expand(Extract(Expand(ms,
                                                                                                   <'rms', 
                                                                                                    h(messages)
                                                                                                   >,
                                                                                                   '32'),
                                                                                            '0'),
                                                                                    <'res', 'pbk'>, '32'),
                                                                             <'0', '0'>, '32'), 
                                                                      h(<'0', '1', '0x0303', ~tid, '0', 
                                                                         $cipher_suites, '0', 
                                                                         <'43', '0x0304'>, <'10', $g, $g2>, 
                                                                         <'40', $g, $g^~x>, <'45', '0', '1'>, 
                                                                         <'42', '0'>, '41', 
                                                                         <p_psk_id, 
                                                                          mask(ticket_age_add, $ticket_age)>, 
                                                                         '0'>)
                                                                     >)
                                                               >, 
                                                               '2', '0x0303', p_ns, $cipher_suite, 
                                                               <'13', $sig_algs>, '40', $g, p_gy>, 
                                                              '8', $exts>, 
                                                             '13', '0', $certificate_extensions>, 
                                                            '11', '0', pk(~ltkS)>)
                                                        >,
                                                        ~ltkS)
                                                  >)
                                               >)
                                         >)
                                      >,
                                      '32')
                    ) ▶₀ #l )
        qed
      qed
    next
      case recv_server_auth_case_07
      solve( (∃ #j.2.
               (!KU( Extract('0', Extract(p_gxy, Extract(~res_psk, '0'))) ) @ #j.2)
              ∧
               #j.2 < #j.1)  ∥
             ((∀ #k.
                (!KU( Extract('0', Extract(p_gxy, Extract(~res_psk, '0'))) ) @ #k)
               ⇒
                ¬(#k < #j.1)) ∧
              (∃ actor #l.
                (RevealPSK( actor,
                            Expand(Extract('0', Extract(p_gxy, Extract(~res_psk, '0'))),
                                   <'serverats', 
                                    h(<
                                       <
                                        <
                                         <
                                          <
                                           <
                                            <
                                             <
                                              <'0', '1', '0x0303', ~tid, '0', $cipher_suites, '0', 
                                               <'43', '0x0304'>, <'10', $g1, $g>, <'40', $g1, $g1^~x>, 
                                               <'45', '0', '1'>, <'42', '0'>, '41', 
                                               <~ticket, mask(~ticket_age_add, $ticket_age)>, 
                                               hmac(<
                                                     Expand(Expand(Extract(~res_psk, '0'), <'ext', 'pbk'>,
                                                                   '32'),
                                                            <'0', '0'>, '32'), 
                                                     h(<'0', '1', '0x0303', ~tid, '0', $cipher_suites, '0', 
                                                        <'43', '0x0304'>, <'10', $g1, $g>, 
                                                        <'40', $g1, $g1^~x>, <'45', '0', '1'>, <'42', '0'>, 
                                                        '41', <~ticket, mask(~ticket_age_add, $ticket_age)>, 
                                                        '0'>)
                                                    >)
                                              >, 
                                              '6', '0x0303', '40', $g>, 
                                             '1', '0x0303', ~new_nc, '0', $cipher_suites.1, '0', 
                                             <'43', '0x0304'>, <'10', $g1, $g>, <'40', $g, $g^~x.1>, 
                                             <'45', '0', '1'>, '0', '41', 
                                             <~ticket, mask(~ticket_age_add, '1')>, 
                                             hmac(<
                                                   Expand(Expand(Extract(~res_psk, '0'), <'ext', 'pbk'>,
                                                                 '32'),
                                                          <'0', '0'>, '32'), 
                                                   h(<
                                                      <
                                                       <'0', '1', '0x0303', ~tid, '0', $cipher_suites, '0', 
                                                        <'43', '0x0304'>, <'10', $g1, $g>, 
                                                        <'40', $g1, $g1^~x>, <'45', '0', '1'>, <'42', '0'>, 
                                                        '41', <~ticket, mask(~ticket_age_add, $ticket_age)>, 
                                                        hmac(<
                                                              Expand(Expand(Extract(~res_psk, '0'),
                                                                            <'ext', 'pbk'>, '32'),
                                                                     <'0', '0'>, '32'), 
                                                              h(<'0', '1', '0x0303', ~tid, '0', 
                                                                 $cipher_suites, '0', <'43', '0x0304'>, 
                                                                 <'10', $g1, $g>, <'40', $g1, $g1^~x>, 
                                                                 <'45', '0', '1'>, <'42', '0'>, '41', 
                                                                 <~ticket, mask(~ticket_age_add, $ticket_age)
                                                                 >, 
                                                                 '0'>)
                                                             >)
                                                       >, 
                                                       '6', '0x0303', '40', $g>, 
                                                      '1', '0x0303', ~new_nc, '0', $cipher_suites.1, '0', 
                                                      <'43', '0x0304'>, <'10', $g1, $g>, <'40', $g, $g^~x.1>, 
                                                      <'45', '0', '1'>, '0', '41', 
                                                      <~ticket, mask(~ticket_age_add, '1')>, '0'>)
                                                  >)
                                            >, 
                                            '2', '0x0303', p_ns, $cipher_suite, <'13', $sig_algs>, '40', $g, 
                                            p_gy>, 
                                           '8', $exts>, 
                                          '13', '0', $certificate_extensions>, 
                                         '11', '0', pk(~ltkS)>, 
                                        '15', 
                                        sign(<'server_cv', 
                                              h(<
                                                 <
                                                  <
                                                   <
                                                    <
                                                     <
                                                      <'0', '1', '0x0303', ~tid, '0', $cipher_suites, '0', 
                                                       <'43', '0x0304'>, <'10', $g1, $g>, 
                                                       <'40', $g1, $g1^~x>, <'45', '0', '1'>, <'42', '0'>, 
                                                       '41', <~ticket, mask(~ticket_age_add, $ticket_age)>, 
                                                       hmac(<
                                                             Expand(Expand(Extract(~res_psk, '0'),
                                                                           <'ext', 'pbk'>, '32'),
                                                                    <'0', '0'>, '32'), 
                                                             h(<'0', '1', '0x0303', ~tid, '0', 
                                                                $cipher_suites, '0', <'43', '0x0304'>, 
                                                                <'10', $g1, $g>, <'40', $g1, $g1^~x>, 
                                                                <'45', '0', '1'>, <'42', '0'>, '41', 
                                                                <~ticket, mask(~ticket_age_add, $ticket_age)
                                                                >, 
                                                                '0'>)
                                                            >)
                                                      >, 
                                                      '6', '0x0303', '40', $g>, 
                                                     '1', '0x0303', ~new_nc, '0', $cipher_suites.1, '0', 
                                                     <'43', '0x0304'>, <'10', $g1, $g>, <'40', $g, $g^~x.1>, 
                                                     <'45', '0', '1'>, '0', '41', 
                                                     <~ticket, mask(~ticket_age_add, '1')>, 
                                                     hmac(<
                                                           Expand(Expand(Extract(~res_psk, '0'),
                                                                         <'ext', 'pbk'>, '32'),
                                                                  <'0', '0'>, '32'), 
                                                           h(<
                                                              <
                                                               <'0', '1', '0x0303', ~tid, '0', 
                                                                $cipher_suites, '0', <'43', '0x0304'>, 
                                                                <'10', $g1, $g>, <'40', $g1, $g1^~x>, 
                                                                <'45', '0', '1'>, <'42', '0'>, '41', 
                                                                <~ticket, mask(~ticket_age_add, $ticket_age)
                                                                >, 
                                                                hmac(<
                                                                      Expand(Expand(Extract(~res_psk, '0'),
                                                                                    <'ext', 'pbk'>, '32'),
                                                                             <'0', '0'>, '32'), 
                                                                      h(<'0', '1', '0x0303', ~tid, '0', 
                                                                         $cipher_suites, '0', 
                                                                         <'43', '0x0304'>, <'10', $g1, $g>, 
                                                                         <'40', $g1, $g1^~x>, 
                                                                         <'45', '0', '1'>, <'42', '0'>, '41', 
                                                                         <~ticket, 
                                                                          mask(~ticket_age_add, $ticket_age)
                                                                         >, 
                                                                         '0'>)
                                                                     >)
                                                               >, 
                                                               '6', '0x0303', '40', $g>, 
                                                              '1', '0x0303', ~new_nc, '0', $cipher_suites.1, 
                                                              '0', <'43', '0x0304'>, <'10', $g1, $g>, 
                                                              <'40', $g, $g^~x.1>, <'45', '0', '1'>, '0', 
                                                              '41', <~ticket, mask(~ticket_age_add, '1')>, '0'
                                                             >)
                                                          >)
                                                    >, 
                                                    '2', '0x0303', p_ns, $cipher_suite, <'13', $sig_algs>, 
                                                    '40', $g, p_gy>, 
                                                   '8', $exts>, 
                                                  '13', '0', $certificate_extensions>, 
                                                 '11', '0', pk(~ltkS)>)
                                             >,
                                             ~ltkS)
                                       >, 
                                       '20', 
                                       hmac(<
                                             Expand(Expand(Extract(p_gxy, Extract(~res_psk, '0')),
                                                           <'serverhts', 
                                                            h(<
                                                               <
                                                                <
                                                                 <
                                                                  <
                                                                   <
                                                                    <
                                                                     <'0', '1', '0x0303', ~tid, '0', 
                                                                      $cipher_suites, '0', <'43', '0x0304'>, 
                                                                      <'10', $g1, $g>, <'40', $g1, $g1^~x>, 
                                                                      <'45', '0', '1'>, <'42', '0'>, '41', 
                                                                      <~ticket, 
                                                                       mask(~ticket_age_add, $ticket_age)>, 
                                                                      hmac(<
                                                                            Expand(Expand(Extract(~res_psk,
                                                                                                  '0'),
                                                                                          <'ext', 'pbk'>,
                                                                                          '32'),
                                                                                   <'0', '0'>, '32'), 
                                                                            h(<'0', '1', '0x0303', ~tid, '0', 
                                                                               $cipher_suites, '0', 
                                                                               <'43', '0x0304'>, 
                                                                               <'10', $g1, $g>, 
                                                                               <'40', $g1, $g1^~x>, 
                                                                               <'45', '0', '1'>, <'42', '0'>, 
                                                                               '41', 
                                                                               <~ticket, 
                                                                                mask(~ticket_age_add,
                                                                                     $ticket_age)
                                                                               >, 
                                                                               '0'>)
                                                                           >)
                                                                     >, 
                                                                     '6', '0x0303', '40', $g>, 
                                                                    '1', '0x0303', ~new_nc, '0', 
                                                                    $cipher_suites.1, '0', <'43', '0x0304'>, 
                                                                    <'10', $g1, $g>, <'40', $g, $g^~x.1>, 
                                                                    <'45', '0', '1'>, '0', '41', 
                                                                    <~ticket, mask(~ticket_age_add, '1')>, 
                                                                    hmac(<
                                                                          Expand(Expand(Extract(~res_psk,
                                                                                                '0'),
                                                                                        <'ext', 'pbk'>, '32'),
                                                                                 <'0', '0'>, '32'), 
                                                                          h(<
                                                                             <
                                                                              <'0', '1', '0x0303', ~tid, '0', 
                                                                               $cipher_suites, '0', 
                                                                               <'43', '0x0304'>, 
                                                                               <'10', $g1, $g>, 
                                                                               <'40', $g1, $g1^~x>, 
                                                                               <'45', '0', '1'>, <'42', '0'>, 
                                                                               '41', 
                                                                               <~ticket, 
                                                                                mask(~ticket_age_add,
                                                                                     $ticket_age)
                                                                               >, 
                                                                               hmac(<
                                                                                     Expand(Expand(Extract(~res_psk,
                                                                                                           '0'),
                                                                                                   <'ext', 
                                                                                                    'pbk'>,
                                                                                                   '32'),
                                                                                            <'0', '0'>,
                                                                                            '32'), 
                                                                                     h(<'0', '1', '0x0303', 
                                                                                        ~tid, '0', 
                                                                                        $cipher_suites, '0', 
                                                                                        <'43', '0x0304'>, 
                                                                                        <'10', $g1, $g>, 
                                                                                        <'40', $g1, $g1^~x>, 
                                                                                        <'45', '0', '1'>, 
                                                                                        <'42', '0'>, '41', 
                                                                                        <~ticket, 
                                                                                         mask(~ticket_age_add,
                                                                                              $ticket_age)
                                                                                        >, 
                                                                                        '0'>)
                                                                                    >)
                                                                              >, 
                                                                              '6', '0x0303', '40', $g>, 
                                                                             '1', '0x0303', ~new_nc, '0', 
                                                                             $cipher_suites.1, '0', 
                                                                             <'43', '0x0304'>, 
                                                                             <'10', $g1, $g>, 
                                                                             <'40', $g, $g^~x.1>, 
                                                                             <'45', '0', '1'>, '0', '41', 
                                                                             <~ticket, 
                                                                              mask(~ticket_age_add, '1')>, 
                                                                             '0'>)
                                                                         >)
                                                                   >, 
                                                                   '2', '0x0303', p_ns, $cipher_suite, 
                                                                   <'13', $sig_algs>, '40', $g, p_gy>, 
                                                                  '8', $exts>, 
                                                                 '13', '0', $certificate_extensions>, 
                                                                '11', '0', pk(~ltkS)>, 
                                                               '15', 
                                                               sign(<'server_cv', 
                                                                     h(<
                                                                        <
                                                                         <
                                                                          <
                                                                           <
                                                                            <
                                                                             <'0', '1', '0x0303', ~tid, '0', 
                                                                              $cipher_suites, '0', 
                                                                              <'43', '0x0304'>, 
                                                                              <'10', $g1, $g>, 
                                                                              <'40', $g1, $g1^~x>, 
                                                                              <'45', '0', '1'>, <'42', '0'>, 
                                                                              '41', 
                                                                              <~ticket, 
                                                                               mask(~ticket_age_add,
                                                                                    $ticket_age)
                                                                              >, 
                                                                              hmac(<
                                                                                    Expand(Expand(Extract(~res_psk,
                                                                                                          '0'),
                                                                                                  <'ext', 
                                                                                                   'pbk'>,
                                                                                                  '32'),
                                                                                           <'0', '0'>, '32'), 
                                                                                    h(<'0', '1', '0x0303', 
                                                                                       ~tid, '0', 
                                                                                       $cipher_suites, '0', 
                                                                                       <'43', '0x0304'>, 
                                                                                       <'10', $g1, $g>, 
                                                                                       <'40', $g1, $g1^~x>, 
                                                                                       <'45', '0', '1'>, 
                                                                                       <'42', '0'>, '41', 
                                                                                       <~ticket, 
                                                                                        mask(~ticket_age_add,
                                                                                             $ticket_age)
                                                                                       >, 
                                                                                       '0'>)
                                                                                   >)
                                                                             >, 
                                                                             '6', '0x0303', '40', $g>, 
                                                                            '1', '0x0303', ~new_nc, '0', 
                                                                            $cipher_suites.1, '0', 
                                                                            <'43', '0x0304'>, 
                                                                            <'10', $g1, $g>, 
                                                                            <'40', $g, $g^~x.1>, 
                                                                            <'45', '0', '1'>, '0', '41', 
                                                                            <~ticket, 
                                                                             mask(~ticket_age_add, '1')>, 
                                                                            hmac(<
                                                                                  Expand(Expand(Extract(~res_psk,
                                                                                                        '0'),
                                                                                                <'ext', 'pbk'
                                                                                                >,
                                                                                                '32'),
                                                                                         <'0', '0'>, '32'), 
                                                                                  h(<
                                                                                     <
                                                                                      <'0', '1', '0x0303', 
                                                                                       ~tid, '0', 
                                                                                       $cipher_suites, '0', 
                                                                                       <'43', '0x0304'>, 
                                                                                       <'10', $g1, $g>, 
                                                                                       <'40', $g1, $g1^~x>, 
                                                                                       <'45', '0', '1'>, 
                                                                                       <'42', '0'>, '41', 
                                                                                       <~ticket, 
                                                                                        mask(~ticket_age_add,
                                                                                             $ticket_age)
                                                                                       >, 
                                                                                       hmac(<
                                                                                             Expand(Expand(Extract(~res_psk,
                                                                                                                   '0'),
                                                                                                           <
                                                                                                            'ext', 
                                                                                                            'pbk'
                                                                                                           >,
                                                                                                           '32'),
                                                                                                    <'0', '0'
                                                                                                    >,
                                                                                                    '32'), 
                                                                                             h(<'0', '1', 
                                                                                                '0x0303', 
                                                                                                ~tid, '0', 
                                                                                                $cipher_suites, 
                                                                                                '0', 
                                                                                                <'43', 
                                                                                                 '0x0304'>, 
                                                                                                <'10', $g1, $g
                                                                                                >, 
                                                                                                <'40', $g1, 
                                                                                                 $g1^~x>, 
                                                                                                <'45', '0', 
                                                                                                 '1'>, 
                                                                                                <'42', '0'>, 
                                                                                                '41', 
                                                                                                <~ticket, 
                                                                                                 mask(~ticket_age_add,
                                                                                                      $ticket_age)
                                                                                                >, 
                                                                                                '0'>)
                                                                                            >)
                                                                                      >, 
                                                                                      '6', '0x0303', '40', $g
                                                                                     >, 
                                                                                     '1', '0x0303', ~new_nc, 
                                                                                     '0', $cipher_suites.1, 
                                                                                     '0', <'43', '0x0304'>, 
                                                                                     <'10', $g1, $g>, 
                                                                                     <'40', $g, $g^~x.1>, 
                                                                                     <'45', '0', '1'>, '0', 
                                                                                     '41', 
                                                                                     <~ticket, 
                                                                                      mask(~ticket_age_add,
                                                                                           '1')
                                                                                     >, 
                                                                                     '0'>)
                                                                                 >)
                                                                           >, 
                                                                           '2', '0x0303', p_ns, 
                                                                           $cipher_suite, <'13', $sig_algs>, 
                                                                           '40', $g, p_gy>, 
                                                                          '8', $exts>, 
                                                                         '13', '0', $certificate_extensions>, 
                                                                        '11', '0', pk(~ltkS)>)
                                                                    >,
                                                                    ~ltkS)
                                                              >)
                                                           >,
                                                           '32'),
                                                    <'fin', '0'>, '32'), 
                                             h(<
                                                <
                                                 <
                                                  <
                                                   <
                                                    <
                                                     <
                                                      <'0', '1', '0x0303', ~tid, '0', $cipher_suites, '0', 
                                                       <'43', '0x0304'>, <'10', $g1, $g>, 
                                                       <'40', $g1, $g1^~x>, <'45', '0', '1'>, <'42', '0'>, 
                                                       '41', <~ticket, mask(~ticket_age_add, $ticket_age)>, 
                                                       hmac(<
                                                             Expand(Expand(Extract(~res_psk, '0'),
                                                                           <'ext', 'pbk'>, '32'),
                                                                    <'0', '0'>, '32'), 
                                                             h(<'0', '1', '0x0303', ~tid, '0', 
                                                                $cipher_suites, '0', <'43', '0x0304'>, 
                                                                <'10', $g1, $g>, <'40', $g1, $g1^~x>, 
                                                                <'45', '0', '1'>, <'42', '0'>, '41', 
                                                                <~ticket, mask(~ticket_age_add, $ticket_age)
                                                                >, 
                                                                '0'>)
                                                            >)
                                                      >, 
                                                      '6', '0x0303', '40', $g>, 
                                                     '1', '0x0303', ~new_nc, '0', $cipher_suites.1, '0', 
                                                     <'43', '0x0304'>, <'10', $g1, $g>, <'40', $g, $g^~x.1>, 
                                                     <'45', '0', '1'>, '0', '41', 
                                                     <~ticket, mask(~ticket_age_add, '1')>, 
                                                     hmac(<
                                                           Expand(Expand(Extract(~res_psk, '0'),
                                                                         <'ext', 'pbk'>, '32'),
                                                                  <'0', '0'>, '32'), 
                                                           h(<
                                                              <
                                                               <'0', '1', '0x0303', ~tid, '0', 
                                                                $cipher_suites, '0', <'43', '0x0304'>, 
                                                                <'10', $g1, $g>, <'40', $g1, $g1^~x>, 
                                                                <'45', '0', '1'>, <'42', '0'>, '41', 
                                                                <~ticket, mask(~ticket_age_add, $ticket_age)
                                                                >, 
                                                                hmac(<
                                                                      Expand(Expand(Extract(~res_psk, '0'),
                                                                                    <'ext', 'pbk'>, '32'),
                                                                             <'0', '0'>, '32'), 
                                                                      h(<'0', '1', '0x0303', ~tid, '0', 
                                                                         $cipher_suites, '0', 
                                                                         <'43', '0x0304'>, <'10', $g1, $g>, 
                                                                         <'40', $g1, $g1^~x>, 
                                                                         <'45', '0', '1'>, <'42', '0'>, '41', 
                                                                         <~ticket, 
                                                                          mask(~ticket_age_add, $ticket_age)
                                                                         >, 
                                                                         '0'>)
                                                                     >)
                                                               >, 
                                                               '6', '0x0303', '40', $g>, 
                                                              '1', '0x0303', ~new_nc, '0', $cipher_suites.1, 
                                                              '0', <'43', '0x0304'>, <'10', $g1, $g>, 
                                                              <'40', $g, $g^~x.1>, <'45', '0', '1'>, '0', 
                                                              '41', <~ticket, mask(~ticket_age_add, '1')>, '0'
                                                             >)
                                                          >)
                                                    >, 
                                                    '2', '0x0303', p_ns, $cipher_suite, <'13', $sig_algs>, 
                                                    '40', $g, p_gy>, 
                                                   '8', $exts>, 
                                                  '13', '0', $certificate_extensions>, 
                                                 '11', '0', pk(~ltkS)>, 
                                                '15', 
                                                sign(<'server_cv', 
                                                      h(<
                                                         <
                                                          <
                                                           <
                                                            <
                                                             <
                                                              <'0', '1', '0x0303', ~tid, '0', $cipher_suites, 
                                                               '0', <'43', '0x0304'>, <'10', $g1, $g>, 
                                                               <'40', $g1, $g1^~x>, <'45', '0', '1'>, 
                                                               <'42', '0'>, '41', 
                                                               <~ticket, mask(~ticket_age_add, $ticket_age)>, 
                                                               hmac(<
                                                                     Expand(Expand(Extract(~res_psk, '0'),
                                                                                   <'ext', 'pbk'>, '32'),
                                                                            <'0', '0'>, '32'), 
                                                                     h(<'0', '1', '0x0303', ~tid, '0', 
                                                                        $cipher_suites, '0', 
                                                                        <'43', '0x0304'>, <'10', $g1, $g>, 
                                                                        <'40', $g1, $g1^~x>, 
                                                                        <'45', '0', '1'>, <'42', '0'>, '41', 
                                                                        <~ticket, 
                                                                         mask(~ticket_age_add, $ticket_age)>, 
                                                                        '0'>)
                                                                    >)
                                                              >, 
                                                              '6', '0x0303', '40', $g>, 
                                                             '1', '0x0303', ~new_nc, '0', $cipher_suites.1, 
                                                             '0', <'43', '0x0304'>, <'10', $g1, $g>, 
                                                             <'40', $g, $g^~x.1>, <'45', '0', '1'>, '0', 
                                                             '41', <~ticket, mask(~ticket_age_add, '1')>, 
                                                             hmac(<
                                                                   Expand(Expand(Extract(~res_psk, '0'),
                                                                                 <'ext', 'pbk'>, '32'),
                                                                          <'0', '0'>, '32'), 
                                                                   h(<
                                                                      <
                                                                       <'0', '1', '0x0303', ~tid, '0', 
                                                                        $cipher_suites, '0', 
                                                                        <'43', '0x0304'>, <'10', $g1, $g>, 
                                                                        <'40', $g1, $g1^~x>, 
                                                                        <'45', '0', '1'>, <'42', '0'>, '41', 
                                                                        <~ticket, 
                                                                         mask(~ticket_age_add, $ticket_age)>, 
                                                                        hmac(<
                                                                              Expand(Expand(Extract(~res_psk,
                                                                                                    '0'),
                                                                                            <'ext', 'pbk'>,
                                                                                            '32'),
                                                                                     <'0', '0'>, '32'), 
                                                                              h(<'0', '1', '0x0303', ~tid, 
                                                                                 '0', $cipher_suites, '0', 
                                                                                 <'43', '0x0304'>, 
                                                                                 <'10', $g1, $g>, 
                                                                                 <'40', $g1, $g1^~x>, 
                                                                                 <'45', '0', '1'>, 
                                                                                 <'42', '0'>, '41', 
                                                                                 <~ticket, 
                                                                                  mask(~ticket_age_add,
                                                                                       $ticket_age)
                                                                                 >, 
                                                                                 '0'>)
                                                                             >)
                                                                       >, 
                                                                       '6', '0x0303', '40', $g>, 
                                                                      '1', '0x0303', ~new_nc, '0', 
                                                                      $cipher_suites.1, '0', 
                                                                      <'43', '0x0304'>, <'10', $g1, $g>, 
                                                                      <'40', $g, $g^~x.1>, <'45', '0', '1'>, 
                                                                      '0', '41', 
                                                                      <~ticket, mask(~ticket_age_add, '1')>, 
                                                                      '0'>)
                                                                  >)
                                                            >, 
                                                            '2', '0x0303', p_ns, $cipher_suite, 
                                                            <'13', $sig_algs>, '40', $g, p_gy>, 
                                                           '8', $exts>, 
                                                          '13', '0', $certificate_extensions>, 
                                                         '11', '0', pk(~ltkS)>)
                                                     >,
                                                     ~ltkS)
                                               >)
                                            >)
                                      >)
                                   >,
                                   '32')
                 ) @ #l)
               ∧
                #l < #j.1)) )
        case case_1
        solve( (∃ #r. (RevLtk( $S ) @ #r) ∧ #r < #vr)  ∥
               (∃ tid3 x #r. (RevDHExp( tid3, $S, x ) @ #r) ∧ #r < #vr)  ∥
               (∃ tid4 y #r. (RevDHExp( tid4, $C, y ) @ #r) ∧ #r < #vr)  ∥
               (∃ rms #r. (RevealPSK( $C, rms ) @ #r) ∧ #r < #k.1)  ∥
               (∃ rms #r. (RevealPSK( $S, rms ) @ #r) ∧ #r < #k.1) )
          case case_1
          by contradiction /* from formulas */
        next
          case case_2
          by contradiction /* from formulas */
        next
          case case_3
          by contradiction /* from formulas */
        next
          case case_4
          solve( (∃ #r. (RevLtk( $S ) @ #r) ∧ #r < #vr)  ∥
                 (∃ tid3 x #r. (RevDHExp( tid3, $S, x ) @ #r) ∧ #r < #vr)  ∥
                 (∃ tid4 y #r. (RevDHExp( tid4, $C, y ) @ #r) ∧ #r < #vr)  ∥
                 (∃ rms #r. (RevealPSK( $C, rms ) @ #r) ∧ #r < #vr)  ∥
                 (∃ rms #r. (RevealPSK( $S, rms ) @ #r) ∧ #r < #vr) )
            case case_1
            by contradiction /* from formulas */
          next
            case case_2
            by contradiction /* from formulas */
          next
            case case_3
            by contradiction /* from formulas */
          next
            case case_4
            by contradiction /* from formulas */
          next
            case case_5
            by contradiction /* from formulas */
          qed
        next
          case case_5
          solve( (∃ #r. (RevLtk( $S ) @ #r) ∧ #r < #vr)  ∥
                 (∃ tid3 x #r. (RevDHExp( tid3, $S, x ) @ #r) ∧ #r < #vr)  ∥
                 (∃ tid4 y #r. (RevDHExp( tid4, $C, y ) @ #r) ∧ #r < #vr)  ∥
                 (∃ rms #r. (RevealPSK( $C, rms ) @ #r) ∧ #r < #vr)  ∥
                 (∃ rms #r. (RevealPSK( $S, rms ) @ #r) ∧ #r < #vr) )
            case case_1
            by contradiction /* from formulas */
          next
            case case_2
            by contradiction /* from formulas */
          next
            case case_3
            by contradiction /* from formulas */
          next
            case case_4
            by contradiction /* from formulas */
          next
            case case_5
            by contradiction /* from formulas */
          qed
        qed
      next
        case case_2
        solve( !Ltk( $C, ~ltkC ) ▶₂ #i )
          case Register_pk
          by solve( SecretPSK( $A,
                               Expand(Extract('0', Extract(p_gxy, Extract(~res_psk, '0'))),
                                      <'serverats', 
                                       h(<
                                          <
                                           <
                                            <
                                             <
                                              <
                                               <
                                                <
                                                 <'0', '1', '0x0303', ~tid, '0', $cipher_suites, '0', 
                                                  <'43', '0x0304'>, <'10', $g1, $g>, <'40', $g1, $g1^~x>, 
                                                  <'45', '0', '1'>, <'42', '0'>, '41', 
                                                  <~ticket, mask(~ticket_age_add, $ticket_age)>, 
                                                  hmac(<
                                                        Expand(Expand(Extract(~res_psk, '0'), <'ext', 'pbk'>,
                                                                      '32'),
                                                               <'0', '0'>, '32'), 
                                                        h(<'0', '1', '0x0303', ~tid, '0', $cipher_suites, 
                                                           '0', <'43', '0x0304'>, <'10', $g1, $g>, 
                                                           <'40', $g1, $g1^~x>, <'45', '0', '1'>, 
                                                           <'42', '0'>, '41', 
                                                           <~ticket, mask(~ticket_age_add, $ticket_age)>, '0'
                                                          >)
                                                       >)
                                                 >, 
                                                 '6', '0x0303', '40', $g>, 
                                                '1', '0x0303', ~new_nc, '0', $cipher_suites.1, '0', 
                                                <'43', '0x0304'>, <'10', $g1, $g>, <'40', $g, $g^~x.1>, 
                                                <'45', '0', '1'>, '0', '41', 
                                                <~ticket, mask(~ticket_age_add, '1')>, 
                                                hmac(<
                                                      Expand(Expand(Extract(~res_psk, '0'), <'ext', 'pbk'>,
                                                                    '32'),
                                                             <'0', '0'>, '32'), 
                                                      h(<
                                                         <
                                                          <'0', '1', '0x0303', ~tid, '0', $cipher_suites, 
                                                           '0', <'43', '0x0304'>, <'10', $g1, $g>, 
                                                           <'40', $g1, $g1^~x>, <'45', '0', '1'>, 
                                                           <'42', '0'>, '41', 
                                                           <~ticket, mask(~ticket_age_add, $ticket_age)>, 
                                                           hmac(<
                                                                 Expand(Expand(Extract(~res_psk, '0'),
                                                                               <'ext', 'pbk'>, '32'),
                                                                        <'0', '0'>, '32'), 
                                                                 h(<'0', '1', '0x0303', ~tid, '0', 
                                                                    $cipher_suites, '0', <'43', '0x0304'>, 
                                                                    <'10', $g1, $g>, <'40', $g1, $g1^~x>, 
                                                                    <'45', '0', '1'>, <'42', '0'>, '41', 
                                                                    <~ticket, 
                                                                     mask(~ticket_age_add, $ticket_age)>, 
                                                                    '0'>)
                                                                >)
                                                          >, 
                                                          '6', '0x0303', '40', $g>, 
                                                         '1', '0x0303', ~new_nc, '0', $cipher_suites.1, '0', 
                                                         <'43', '0x0304'>, <'10', $g1, $g>, 
                                                         <'40', $g, $g^~x.1>, <'45', '0', '1'>, '0', '41', 
                                                         <~ticket, mask(~ticket_age_add, '1')>, '0'>)
                                                     >)
                                               >, 
                                               '2', '0x0303', p_ns, $cipher_suite, <'13', $sig_algs>, '40', 
                                               $g, p_gy>, 
                                              '8', $exts>, 
                                             '13', '0', $certificate_extensions>, 
                                            '11', '0', pk(~ltkS)>, 
                                           '15', 
                                           sign(<'server_cv', 
                                                 h(<
                                                    <
                                                     <
                                                      <
                                                       <
                                                        <
                                                         <'0', '1', '0x0303', ~tid, '0', $cipher_suites, '0', 
                                                          <'43', '0x0304'>, <'10', $g1, $g>, 
                                                          <'40', $g1, $g1^~x>, <'45', '0', '1'>, <'42', '0'>, 
                                                          '41', 
                                                          <~ticket, mask(~ticket_age_add, $ticket_age)>, 
                                                          hmac(<
                                                                Expand(Expand(Extract(~res_psk, '0'),
                                                                              <'ext', 'pbk'>, '32'),
                                                                       <'0', '0'>, '32'), 
                                                                h(<'0', '1', '0x0303', ~tid, '0', 
                                                                   $cipher_suites, '0', <'43', '0x0304'>, 
                                                                   <'10', $g1, $g>, <'40', $g1, $g1^~x>, 
                                                                   <'45', '0', '1'>, <'42', '0'>, '41', 
                                                                   <~ticket, 
                                                                    mask(~ticket_age_add, $ticket_age)>, 
                                                                   '0'>)
                                                               >)
                                                         >, 
                                                         '6', '0x0303', '40', $g>, 
                                                        '1', '0x0303', ~new_nc, '0', $cipher_suites.1, '0', 
                                                        <'43', '0x0304'>, <'10', $g1, $g>, 
                                                        <'40', $g, $g^~x.1>, <'45', '0', '1'>, '0', '41', 
                                                        <~ticket, mask(~ticket_age_add, '1')>, 
                                                        hmac(<
                                                              Expand(Expand(Extract(~res_psk, '0'),
                                                                            <'ext', 'pbk'>, '32'),
                                                                     <'0', '0'>, '32'), 
                                                              h(<
                                                                 <
                                                                  <'0', '1', '0x0303', ~tid, '0', 
                                                                   $cipher_suites, '0', <'43', '0x0304'>, 
                                                                   <'10', $g1, $g>, <'40', $g1, $g1^~x>, 
                                                                   <'45', '0', '1'>, <'42', '0'>, '41', 
                                                                   <~ticket, 
                                                                    mask(~ticket_age_add, $ticket_age)>, 
                                                                   hmac(<
                                                                         Expand(Expand(Extract(~res_psk, '0'),
                                                                                       <'ext', 'pbk'>, '32'),
                                                                                <'0', '0'>, '32'), 
                                                                         h(<'0', '1', '0x0303', ~tid, '0', 
                                                                            $cipher_suites, '0', 
                                                                            <'43', '0x0304'>, 
                                                                            <'10', $g1, $g>, 
                                                                            <'40', $g1, $g1^~x>, 
                                                                            <'45', '0', '1'>, <'42', '0'>, 
                                                                            '41', 
                                                                            <~ticket, 
                                                                             mask(~ticket_age_add,
                                                                                  $ticket_age)
                                                                            >, 
                                                                            '0'>)
                                                                        >)
                                                                  >, 
                                                                  '6', '0x0303', '40', $g>, 
                                                                 '1', '0x0303', ~new_nc, '0', 
                                                                 $cipher_suites.1, '0', <'43', '0x0304'>, 
                                                                 <'10', $g1, $g>, <'40', $g, $g^~x.1>, 
                                                                 <'45', '0', '1'>, '0', '41', 
                                                                 <~ticket, mask(~ticket_age_add, '1')>, '0'>)
                                                             >)
                                                       >, 
                                                       '2', '0x0303', p_ns, $cipher_suite, <'13', $sig_algs>, 
                                                       '40', $g, p_gy>, 
                                                      '8', $exts>, 
                                                     '13', '0', $certificate_extensions>, 
                                                    '11', '0', pk(~ltkS)>)
                                                >,
                                                ~ltkS)
                                          >, 
                                          '20', 
                                          hmac(<
                                                Expand(Expand(Extract(p_gxy, Extract(~res_psk, '0')),
                                                              <'serverhts', 
                                                               h(<
                                                                  <
                                                                   <
                                                                    <
                                                                     <
                                                                      <
                                                                       <
                                                                        <'0', '1', '0x0303', ~tid, '0', 
                                                                         $cipher_suites, '0', 
                                                                         <'43', '0x0304'>, <'10', $g1, $g>, 
                                                                         <'40', $g1, $g1^~x>, 
                                                                         <'45', '0', '1'>, <'42', '0'>, '41', 
                                                                         <~ticket, 
                                                                          mask(~ticket_age_add, $ticket_age)
                                                                         >, 
                                                                         hmac(<
                                                                               Expand(Expand(Extract(~res_psk,
                                                                                                     '0'),
                                                                                             <'ext', 'pbk'>,
                                                                                             '32'),
                                                                                      <'0', '0'>, '32'), 
                                                                               h(<'0', '1', '0x0303', ~tid, 
                                                                                  '0', $cipher_suites, '0', 
                                                                                  <'43', '0x0304'>, 
                                                                                  <'10', $g1, $g>, 
                                                                                  <'40', $g1, $g1^~x>, 
                                                                                  <'45', '0', '1'>, 
                                                                                  <'42', '0'>, '41', 
                                                                                  <~ticket, 
                                                                                   mask(~ticket_age_add,
                                                                                        $ticket_age)
                                                                                  >, 
                                                                                  '0'>)
                                                                              >)
                                                                        >, 
                                                                        '6', '0x0303', '40', $g>, 
                                                                       '1', '0x0303', ~new_nc, '0', 
                                                                       $cipher_suites.1, '0', 
                                                                       <'43', '0x0304'>, <'10', $g1, $g>, 
                                                                       <'40', $g, $g^~x.1>, <'45', '0', '1'>, 
                                                                       '0', '41', 
                                                                       <~ticket, mask(~ticket_age_add, '1')>, 
                                                                       hmac(<
                                                                             Expand(Expand(Extract(~res_psk,
                                                                                                   '0'),
                                                                                           <'ext', 'pbk'>,
                                                                                           '32'),
                                                                                    <'0', '0'>, '32'), 
                                                                             h(<
                                                                                <
                                                                                 <'0', '1', '0x0303', ~tid, 
                                                                                  '0', $cipher_suites, '0', 
                                                                                  <'43', '0x0304'>, 
                                                                                  <'10', $g1, $g>, 
                                                                                  <'40', $g1, $g1^~x>, 
                                                                                  <'45', '0', '1'>, 
                                                                                  <'42', '0'>, '41', 
                                                                                  <~ticket, 
                                                                                   mask(~ticket_age_add,
                                                                                        $ticket_age)
                                                                                  >, 
                                                                                  hmac(<
                                                                                        Expand(Expand(Extract(~res_psk,
                                                                                                              '0'),
                                                                                                      <'ext', 
                                                                                                       'pbk'>,
                                                                                                      '32'),
                                                                                               <'0', '0'>,
                                                                                               '32'), 
                                                                                        h(<'0', '1', 
                                                                                           '0x0303', ~tid, 
                                                                                           '0', 
                                                                                           $cipher_suites, 
                                                                                           '0', 
                                                                                           <'43', '0x0304'>, 
                                                                                           <'10', $g1, $g>, 
                                                                                           <'40', $g1, $g1^~x
                                                                                           >, 
                                                                                           <'45', '0', '1'>, 
                                                                                           <'42', '0'>, '41', 
                                                                                           <~ticket, 
                                                                                            mask(~ticket_age_add,
                                                                                                 $ticket_age)
                                                                                           >, 
                                                                                           '0'>)
                                                                                       >)
                                                                                 >, 
                                                                                 '6', '0x0303', '40', $g>, 
                                                                                '1', '0x0303', ~new_nc, '0', 
                                                                                $cipher_suites.1, '0', 
                                                                                <'43', '0x0304'>, 
                                                                                <'10', $g1, $g>, 
                                                                                <'40', $g, $g^~x.1>, 
                                                                                <'45', '0', '1'>, '0', '41', 
                                                                                <~ticket, 
                                                                                 mask(~ticket_age_add, '1')>, 
                                                                                '0'>)
                                                                            >)
                                                                      >, 
                                                                      '2', '0x0303', p_ns, $cipher_suite, 
                                                                      <'13', $sig_algs>, '40', $g, p_gy>, 
                                                                     '8', $exts>, 
                                                                    '13', '0', $certificate_extensions>, 
                                                                   '11', '0', pk(~ltkS)>, 
                                                                  '15', 
                                                                  sign(<'server_cv', 
                                                                        h(<
                                                                           <
                                                                            <
                                                                             <
                                                                              <
                                                                               <
                                                                                <'0', '1', '0x0303', ~tid, 
                                                                                 '0', $cipher_suites, '0', 
                                                                                 <'43', '0x0304'>, 
                                                                                 <'10', $g1, $g>, 
                                                                                 <'40', $g1, $g1^~x>, 
                                                                                 <'45', '0', '1'>, 
                                                                                 <'42', '0'>, '41', 
                                                                                 <~ticket, 
                                                                                  mask(~ticket_age_add,
                                                                                       $ticket_age)
                                                                                 >, 
                                                                                 hmac(<
                                                                                       Expand(Expand(Extract(~res_psk,
                                                                                                             '0'),
                                                                                                     <'ext', 
                                                                                                      'pbk'>,
                                                                                                     '32'),
                                                                                              <'0', '0'>,
                                                                                              '32'), 
                                                                                       h(<'0', '1', '0x0303', 
                                                                                          ~tid, '0', 
                                                                                          $cipher_suites, 
                                                                                          '0', 
                                                                                          <'43', '0x0304'>, 
                                                                                          <'10', $g1, $g>, 
                                                                                          <'40', $g1, $g1^~x
                                                                                          >, 
                                                                                          <'45', '0', '1'>, 
                                                                                          <'42', '0'>, '41', 
                                                                                          <~ticket, 
                                                                                           mask(~ticket_age_add,
                                                                                                $ticket_age)
                                                                                          >, 
                                                                                          '0'>)
                                                                                      >)
                                                                                >, 
                                                                                '6', '0x0303', '40', $g>, 
                                                                               '1', '0x0303', ~new_nc, '0', 
                                                                               $cipher_suites.1, '0', 
                                                                               <'43', '0x0304'>, 
                                                                               <'10', $g1, $g>, 
                                                                               <'40', $g, $g^~x.1>, 
                                                                               <'45', '0', '1'>, '0', '41', 
                                                                               <~ticket, 
                                                                                mask(~ticket_age_add, '1')>, 
                                                                               hmac(<
                                                                                     Expand(Expand(Extract(~res_psk,
                                                                                                           '0'),
                                                                                                   <'ext', 
                                                                                                    'pbk'>,
                                                                                                   '32'),
                                                                                            <'0', '0'>,
                                                                                            '32'), 
                                                                                     h(<
                                                                                        <
                                                                                         <'0', '1', '0x0303', 
                                                                                          ~tid, '0', 
                                                                                          $cipher_suites, 
                                                                                          '0', 
                                                                                          <'43', '0x0304'>, 
                                                                                          <'10', $g1, $g>, 
                                                                                          <'40', $g1, $g1^~x
                                                                                          >, 
                                                                                          <'45', '0', '1'>, 
                                                                                          <'42', '0'>, '41', 
                                                                                          <~ticket, 
                                                                                           mask(~ticket_age_add,
                                                                                                $ticket_age)
                                                                                          >, 
                                                                                          hmac(<
                                                                                                Expand(Expand(Extract(~res_psk,
                                                                                                                      '0'),
                                                                                                              <
                                                                                                               'ext', 
                                                                                                               'pbk'
                                                                                                              >,
                                                                                                              '32'),
                                                                                                       <'0', 
                                                                                                        '0'>,
                                                                                                       '32'), 
                                                                                                h(<'0', '1', 
                                                                                                   '0x0303', 
                                                                                                   ~tid, '0', 
                                                                                                   $cipher_suites, 
                                                                                                   '0', 
                                                                                                   <'43', 
                                                                                                    '0x0304'
                                                                                                   >, 
                                                                                                   <'10', 
                                                                                                    $g1, $g>, 
                                                                                                   <'40', 
                                                                                                    $g1, 
                                                                                                    $g1^~x>, 
                                                                                                   <'45', 
                                                                                                    '0', '1'
                                                                                                   >, 
                                                                                                   <'42', '0'
                                                                                                   >, 
                                                                                                   '41', 
                                                                                                   <~ticket, 
                                                                                                    mask(~ticket_age_add,
                                                                                                         $ticket_age)
                                                                                                   >, 
                                                                                                   '0'>)
                                                                                               >)
                                                                                         >, 
                                                                                         '6', '0x0303', '40', 
                                                                                         $g>, 
                                                                                        '1', '0x0303', 
                                                                                        ~new_nc, '0', 
                                                                                        $cipher_suites.1, 
                                                                                        '0', 
                                                                                        <'43', '0x0304'>, 
                                                                                        <'10', $g1, $g>, 
                                                                                        <'40', $g, $g^~x.1>, 
                                                                                        <'45', '0', '1'>, 
                                                                                        '0', '41', 
                                                                                        <~ticket, 
                                                                                         mask(~ticket_age_add,
                                                                                              '1')
                                                                                        >, 
                                                                                        '0'>)
                                                                                    >)
                                                                              >, 
                                                                              '2', '0x0303', p_ns, 
                                                                              $cipher_suite, 
                                                                              <'13', $sig_algs>, '40', $g, 
                                                                              p_gy>, 
                                                                             '8', $exts>, 
                                                                            '13', '0', $certificate_extensions
                                                                           >, 
                                                                           '11', '0', pk(~ltkS)>)
                                                                       >,
                                                                       ~ltkS)
                                                                 >)
                                                              >,
                                                              '32'),
                                                       <'fin', '0'>, '32'), 
                                                h(<
                                                   <
                                                    <
                                                     <
                                                      <
                                                       <
                                                        <
                                                         <'0', '1', '0x0303', ~tid, '0', $cipher_suites, '0', 
                                                          <'43', '0x0304'>, <'10', $g1, $g>, 
                                                          <'40', $g1, $g1^~x>, <'45', '0', '1'>, <'42', '0'>, 
                                                          '41', 
                                                          <~ticket, mask(~ticket_age_add, $ticket_age)>, 
                                                          hmac(<
                                                                Expand(Expand(Extract(~res_psk, '0'),
                                                                              <'ext', 'pbk'>, '32'),
                                                                       <'0', '0'>, '32'), 
                                                                h(<'0', '1', '0x0303', ~tid, '0', 
                                                                   $cipher_suites, '0', <'43', '0x0304'>, 
                                                                   <'10', $g1, $g>, <'40', $g1, $g1^~x>, 
                                                                   <'45', '0', '1'>, <'42', '0'>, '41', 
                                                                   <~ticket, 
                                                                    mask(~ticket_age_add, $ticket_age)>, 
                                                                   '0'>)
                                                               >)
                                                         >, 
                                                         '6', '0x0303', '40', $g>, 
                                                        '1', '0x0303', ~new_nc, '0', $cipher_suites.1, '0', 
                                                        <'43', '0x0304'>, <'10', $g1, $g>, 
                                                        <'40', $g, $g^~x.1>, <'45', '0', '1'>, '0', '41', 
                                                        <~ticket, mask(~ticket_age_add, '1')>, 
                                                        hmac(<
                                                              Expand(Expand(Extract(~res_psk, '0'),
                                                                            <'ext', 'pbk'>, '32'),
                                                                     <'0', '0'>, '32'), 
                                                              h(<
                                                                 <
                                                                  <'0', '1', '0x0303', ~tid, '0', 
                                                                   $cipher_suites, '0', <'43', '0x0304'>, 
                                                                   <'10', $g1, $g>, <'40', $g1, $g1^~x>, 
                                                                   <'45', '0', '1'>, <'42', '0'>, '41', 
                                                                   <~ticket, 
                                                                    mask(~ticket_age_add, $ticket_age)>, 
                                                                   hmac(<
                                                                         Expand(Expand(Extract(~res_psk, '0'),
                                                                                       <'ext', 'pbk'>, '32'),
                                                                                <'0', '0'>, '32'), 
                                                                         h(<'0', '1', '0x0303', ~tid, '0', 
                                                                            $cipher_suites, '0', 
                                                                            <'43', '0x0304'>, 
                                                                            <'10', $g1, $g>, 
                                                                            <'40', $g1, $g1^~x>, 
                                                                            <'45', '0', '1'>, <'42', '0'>, 
                                                                            '41', 
                                                                            <~ticket, 
                                                                             mask(~ticket_age_add,
                                                                                  $ticket_age)
                                                                            >, 
                                                                            '0'>)
                                                                        >)
                                                                  >, 
                                                                  '6', '0x0303', '40', $g>, 
                                                                 '1', '0x0303', ~new_nc, '0', 
                                                                 $cipher_suites.1, '0', <'43', '0x0304'>, 
                                                                 <'10', $g1, $g>, <'40', $g, $g^~x.1>, 
                                                                 <'45', '0', '1'>, '0', '41', 
                                                                 <~ticket, mask(~ticket_age_add, '1')>, '0'>)
                                                             >)
                                                       >, 
                                                       '2', '0x0303', p_ns, $cipher_suite, <'13', $sig_algs>, 
                                                       '40', $g, p_gy>, 
                                                      '8', $exts>, 
                                                     '13', '0', $certificate_extensions>, 
                                                    '11', '0', pk(~ltkS)>, 
                                                   '15', 
                                                   sign(<'server_cv', 
                                                         h(<
                                                            <
                                                             <
                                                              <
                                                               <
                                                                <
                                                                 <'0', '1', '0x0303', ~tid, '0', 
                                                                  $cipher_suites, '0', <'43', '0x0304'>, 
                                                                  <'10', $g1, $g>, <'40', $g1, $g1^~x>, 
                                                                  <'45', '0', '1'>, <'42', '0'>, '41', 
                                                                  <~ticket, mask(~ticket_age_add, $ticket_age)
                                                                  >, 
                                                                  hmac(<
                                                                        Expand(Expand(Extract(~res_psk, '0'),
                                                                                      <'ext', 'pbk'>, '32'),
                                                                               <'0', '0'>, '32'), 
                                                                        h(<'0', '1', '0x0303', ~tid, '0', 
                                                                           $cipher_suites, '0', 
                                                                           <'43', '0x0304'>, <'10', $g1, $g>, 
                                                                           <'40', $g1, $g1^~x>, 
                                                                           <'45', '0', '1'>, <'42', '0'>, 
                                                                           '41', 
                                                                           <~ticket, 
                                                                            mask(~ticket_age_add, $ticket_age)
                                                                           >, 
                                                                           '0'>)
                                                                       >)
                                                                 >, 
                                                                 '6', '0x0303', '40', $g>, 
                                                                '1', '0x0303', ~new_nc, '0', 
                                                                $cipher_suites.1, '0', <'43', '0x0304'>, 
                                                                <'10', $g1, $g>, <'40', $g, $g^~x.1>, 
                                                                <'45', '0', '1'>, '0', '41', 
                                                                <~ticket, mask(~ticket_age_add, '1')>, 
                                                                hmac(<
                                                                      Expand(Expand(Extract(~res_psk, '0'),
                                                                                    <'ext', 'pbk'>, '32'),
                                                                             <'0', '0'>, '32'), 
                                                                      h(<
                                                                         <
                                                                          <'0', '1', '0x0303', ~tid, '0', 
                                                                           $cipher_suites, '0', 
                                                                           <'43', '0x0304'>, <'10', $g1, $g>, 
                                                                           <'40', $g1, $g1^~x>, 
                                                                           <'45', '0', '1'>, <'42', '0'>, 
                                                                           '41', 
                                                                           <~ticket, 
                                                                            mask(~ticket_age_add, $ticket_age)
                                                                           >, 
                                                                           hmac(<
                                                                                 Expand(Expand(Extract(~res_psk,
                                                                                                       '0'),
                                                                                               <'ext', 'pbk'>,
                                                                                               '32'),
                                                                                        <'0', '0'>, '32'), 
                                                                                 h(<'0', '1', '0x0303', ~tid, 
                                                                                    '0', $cipher_suites, '0', 
                                                                                    <'43', '0x0304'>, 
                                                                                    <'10', $g1, $g>, 
                                                                                    <'40', $g1, $g1^~x>, 
                                                                                    <'45', '0', '1'>, 
                                                                                    <'42', '0'>, '41', 
                                                                                    <~ticket, 
                                                                                     mask(~ticket_age_add,
                                                                                          $ticket_age)
                                                                                    >, 
                                                                                    '0'>)
                                                                                >)
                                                                          >, 
                                                                          '6', '0x0303', '40', $g>, 
                                                                         '1', '0x0303', ~new_nc, '0', 
                                                                         $cipher_suites.1, '0', 
                                                                         <'43', '0x0304'>, <'10', $g1, $g>, 
                                                                         <'40', $g, $g^~x.1>, 
                                                                         <'45', '0', '1'>, '0', '41', 
                                                                         <~ticket, mask(~ticket_age_add, '1')
                                                                         >, 
                                                                         '0'>)
                                                                     >)
                                                               >, 
                                                               '2', '0x0303', p_ns, $cipher_suite, 
                                                               <'13', $sig_algs>, '40', $g, p_gy>, 
                                                              '8', $exts>, 
                                                             '13', '0', $certificate_extensions>, 
                                                            '11', '0', pk(~ltkS)>)
                                                        >,
                                                        ~ltkS)
                                                  >)
                                               >)
                                         >)
                                      >,
                                      '32')
                    ) ▶₀ #l )
        qed
      qed
    next
      case recv_server_auth_case_08
      solve( (∃ #j.2.
               (!KU( Extract('0',
                             Extract(p_gxy, Extract(Expand(ms, <'rms', h(messages)>, '32'), '0')))
                ) @ #j.2)
              ∧
               #j.2 < #j.1)  ∥
             ((∀ #k.
                (!KU( Extract('0',
                              Extract(p_gxy, Extract(Expand(ms, <'rms', h(messages)>, '32'), '0')))
                 ) @ #k)
               ⇒
                ¬(#k < #j.1)) ∧
              (∃ actor #l.
                (RevealPSK( actor,
                            Expand(Extract('0',
                                           Extract(p_gxy,
                                                   Extract(Expand(ms, <'rms', h(messages)>, '32'), '0'))),
                                   <'serverats', 
                                    h(<
                                       <
                                        <
                                         <
                                          <
                                           <
                                            <
                                             <
                                              <'0', '1', '0x0303', ~tid, '0', $cipher_suites, '0', 
                                               <'43', '0x0304'>, <'10', $g1, $g>, <'40', $g1, $g1^~x>, 
                                               <'45', '0', '1'>, <'42', '0'>, '41', 
                                               <p_psk_id, mask(ticket_age_add, $ticket_age)>, 
                                               hmac(<
                                                     Expand(Expand(Extract(Expand(ms, <'rms', h(messages)>,
                                                                                  '32'),
                                                                           '0'),
                                                                   <'res', 'pbk'>, '32'),
                                                            <'0', '0'>, '32'), 
                                                     h(<'0', '1', '0x0303', ~tid, '0', $cipher_suites, '0', 
                                                        <'43', '0x0304'>, <'10', $g1, $g>, 
                                                        <'40', $g1, $g1^~x>, <'45', '0', '1'>, <'42', '0'>, 
                                                        '41', <p_psk_id, mask(ticket_age_add, $ticket_age)>, 
                                                        '0'>)
                                                    >)
                                              >, 
                                              '6', '0x0303', '40', $g>, 
                                             '1', '0x0303', ~new_nc, '0', $cipher_suites.1, '0', 
                                             <'43', '0x0304'>, <'10', $g1, $g>, <'40', $g, $g^~x.1>, 
                                             <'45', '0', '1'>, '0', '41', 
                                             <p_psk_id, mask(ticket_age_add, '1')>, 
                                             hmac(<
                                                   Expand(Expand(Extract(Expand(ms, <'rms', h(messages)>,
                                                                                '32'),
                                                                         '0'),
                                                                 <'res', 'pbk'>, '32'),
                                                          <'0', '0'>, '32'), 
                                                   h(<
                                                      <
                                                       <'0', '1', '0x0303', ~tid, '0', $cipher_suites, '0', 
                                                        <'43', '0x0304'>, <'10', $g1, $g>, 
                                                        <'40', $g1, $g1^~x>, <'45', '0', '1'>, <'42', '0'>, 
                                                        '41', <p_psk_id, mask(ticket_age_add, $ticket_age)>, 
                                                        hmac(<
                                                              Expand(Expand(Extract(Expand(ms,
                                                                                           <'rms', h(messages)
                                                                                           >,
                                                                                           '32'),
                                                                                    '0'),
                                                                            <'res', 'pbk'>, '32'),
                                                                     <'0', '0'>, '32'), 
                                                              h(<'0', '1', '0x0303', ~tid, '0', 
                                                                 $cipher_suites, '0', <'43', '0x0304'>, 
                                                                 <'10', $g1, $g>, <'40', $g1, $g1^~x>, 
                                                                 <'45', '0', '1'>, <'42', '0'>, '41', 
                                                                 <p_psk_id, mask(ticket_age_add, $ticket_age)
                                                                 >, 
                                                                 '0'>)
                                                             >)
                                                       >, 
                                                       '6', '0x0303', '40', $g>, 
                                                      '1', '0x0303', ~new_nc, '0', $cipher_suites.1, '0', 
                                                      <'43', '0x0304'>, <'10', $g1, $g>, <'40', $g, $g^~x.1>, 
                                                      <'45', '0', '1'>, '0', '41', 
                                                      <p_psk_id, mask(ticket_age_add, '1')>, '0'>)
                                                  >)
                                            >, 
                                            '2', '0x0303', p_ns, $cipher_suite, <'13', $sig_algs>, '40', $g, 
                                            p_gy>, 
                                           '8', $exts>, 
                                          '13', '0', $certificate_extensions>, 
                                         '11', '0', pk(~ltkS)>, 
                                        '15', 
                                        sign(<'server_cv', 
                                              h(<
                                                 <
                                                  <
                                                   <
                                                    <
                                                     <
                                                      <'0', '1', '0x0303', ~tid, '0', $cipher_suites, '0', 
                                                       <'43', '0x0304'>, <'10', $g1, $g>, 
                                                       <'40', $g1, $g1^~x>, <'45', '0', '1'>, <'42', '0'>, 
                                                       '41', <p_psk_id, mask(ticket_age_add, $ticket_age)>, 
                                                       hmac(<
                                                             Expand(Expand(Extract(Expand(ms,
                                                                                          <'rms', h(messages)
                                                                                          >,
                                                                                          '32'),
                                                                                   '0'),
                                                                           <'res', 'pbk'>, '32'),
                                                                    <'0', '0'>, '32'), 
                                                             h(<'0', '1', '0x0303', ~tid, '0', 
                                                                $cipher_suites, '0', <'43', '0x0304'>, 
                                                                <'10', $g1, $g>, <'40', $g1, $g1^~x>, 
                                                                <'45', '0', '1'>, <'42', '0'>, '41', 
                                                                <p_psk_id, mask(ticket_age_add, $ticket_age)
                                                                >, 
                                                                '0'>)
                                                            >)
                                                      >, 
                                                      '6', '0x0303', '40', $g>, 
                                                     '1', '0x0303', ~new_nc, '0', $cipher_suites.1, '0', 
                                                     <'43', '0x0304'>, <'10', $g1, $g>, <'40', $g, $g^~x.1>, 
                                                     <'45', '0', '1'>, '0', '41', 
                                                     <p_psk_id, mask(ticket_age_add, '1')>, 
                                                     hmac(<
                                                           Expand(Expand(Extract(Expand(ms,
                                                                                        <'rms', h(messages)>,
                                                                                        '32'),
                                                                                 '0'),
                                                                         <'res', 'pbk'>, '32'),
                                                                  <'0', '0'>, '32'), 
                                                           h(<
                                                              <
                                                               <'0', '1', '0x0303', ~tid, '0', 
                                                                $cipher_suites, '0', <'43', '0x0304'>, 
                                                                <'10', $g1, $g>, <'40', $g1, $g1^~x>, 
                                                                <'45', '0', '1'>, <'42', '0'>, '41', 
                                                                <p_psk_id, mask(ticket_age_add, $ticket_age)
                                                                >, 
                                                                hmac(<
                                                                      Expand(Expand(Extract(Expand(ms,
                                                                                                   <'rms', 
                                                                                                    h(messages)
                                                                                                   >,
                                                                                                   '32'),
                                                                                            '0'),
                                                                                    <'res', 'pbk'>, '32'),
                                                                             <'0', '0'>, '32'), 
                                                                      h(<'0', '1', '0x0303', ~tid, '0', 
                                                                         $cipher_suites, '0', 
                                                                         <'43', '0x0304'>, <'10', $g1, $g>, 
                                                                         <'40', $g1, $g1^~x>, 
                                                                         <'45', '0', '1'>, <'42', '0'>, '41', 
                                                                         <p_psk_id, 
                                                                          mask(ticket_age_add, $ticket_age)>, 
                                                                         '0'>)
                                                                     >)
                                                               >, 
                                                               '6', '0x0303', '40', $g>, 
                                                              '1', '0x0303', ~new_nc, '0', $cipher_suites.1, 
                                                              '0', <'43', '0x0304'>, <'10', $g1, $g>, 
                                                              <'40', $g, $g^~x.1>, <'45', '0', '1'>, '0', 
                                                              '41', <p_psk_id, mask(ticket_age_add, '1')>, '0'
                                                             >)
                                                          >)
                                                    >, 
                                                    '2', '0x0303', p_ns, $cipher_suite, <'13', $sig_algs>, 
                                                    '40', $g, p_gy>, 
                                                   '8', $exts>, 
                                                  '13', '0', $certificate_extensions>, 
                                                 '11', '0', pk(~ltkS)>)
                                             >,
                                             ~ltkS)
                                       >, 
                                       '20', 
                                       hmac(<
                                             Expand(Expand(Extract(p_gxy,
                                                                   Extract(Expand(ms, <'rms', h(messages)>,
                                                                                  '32'),
                                                                           '0')),
                                                           <'serverhts', 
                                                            h(<
                                                               <
                                                                <
                                                                 <
                                                                  <
                                                                   <
                                                                    <
                                                                     <'0', '1', '0x0303', ~tid, '0', 
                                                                      $cipher_suites, '0', <'43', '0x0304'>, 
                                                                      <'10', $g1, $g>, <'40', $g1, $g1^~x>, 
                                                                      <'45', '0', '1'>, <'42', '0'>, '41', 
                                                                      <p_psk_id, 
                                                                       mask(ticket_age_add, $ticket_age)>, 
                                                                      hmac(<
                                                                            Expand(Expand(Extract(Expand(ms,
                                                                                                         <
                                                                                                          'rms', 
                                                                                                          h(messages)
                                                                                                         >,
                                                                                                         '32'),
                                                                                                  '0'),
                                                                                          <'res', 'pbk'>,
                                                                                          '32'),
                                                                                   <'0', '0'>, '32'), 
                                                                            h(<'0', '1', '0x0303', ~tid, '0', 
                                                                               $cipher_suites, '0', 
                                                                               <'43', '0x0304'>, 
                                                                               <'10', $g1, $g>, 
                                                                               <'40', $g1, $g1^~x>, 
                                                                               <'45', '0', '1'>, <'42', '0'>, 
                                                                               '41', 
                                                                               <p_psk_id, 
                                                                                mask(ticket_age_add,
                                                                                     $ticket_age)
                                                                               >, 
                                                                               '0'>)
                                                                           >)
                                                                     >, 
                                                                     '6', '0x0303', '40', $g>, 
                                                                    '1', '0x0303', ~new_nc, '0', 
                                                                    $cipher_suites.1, '0', <'43', '0x0304'>, 
                                                                    <'10', $g1, $g>, <'40', $g, $g^~x.1>, 
                                                                    <'45', '0', '1'>, '0', '41', 
                                                                    <p_psk_id, mask(ticket_age_add, '1')>, 
                                                                    hmac(<
                                                                          Expand(Expand(Extract(Expand(ms,
                                                                                                       <
                                                                                                        'rms', 
                                                                                                        h(messages)
                                                                                                       >,
                                                                                                       '32'),
                                                                                                '0'),
                                                                                        <'res', 'pbk'>, '32'),
                                                                                 <'0', '0'>, '32'), 
                                                                          h(<
                                                                             <
                                                                              <'0', '1', '0x0303', ~tid, '0', 
                                                                               $cipher_suites, '0', 
                                                                               <'43', '0x0304'>, 
                                                                               <'10', $g1, $g>, 
                                                                               <'40', $g1, $g1^~x>, 
                                                                               <'45', '0', '1'>, <'42', '0'>, 
                                                                               '41', 
                                                                               <p_psk_id, 
                                                                                mask(ticket_age_add,
                                                                                     $ticket_age)
                                                                               >, 
                                                                               hmac(<
                                                                                     Expand(Expand(Extract(Expand(ms,
                                                                                                                  <
                                                                                                                   'rms', 
                                                                                                                   h(messages)
                                                                                                                  >,
                                                                                                                  '32'),
                                                                                                           '0'),
                                                                                                   <'res', 
                                                                                                    'pbk'>,
                                                                                                   '32'),
                                                                                            <'0', '0'>,
                                                                                            '32'), 
                                                                                     h(<'0', '1', '0x0303', 
                                                                                        ~tid, '0', 
                                                                                        $cipher_suites, '0', 
                                                                                        <'43', '0x0304'>, 
                                                                                        <'10', $g1, $g>, 
                                                                                        <'40', $g1, $g1^~x>, 
                                                                                        <'45', '0', '1'>, 
                                                                                        <'42', '0'>, '41', 
                                                                                        <p_psk_id, 
                                                                                         mask(ticket_age_add,
                                                                                              $ticket_age)
                                                                                        >, 
                                                                                        '0'>)
                                                                                    >)
                                                                              >, 
                                                                              '6', '0x0303', '40', $g>, 
                                                                             '1', '0x0303', ~new_nc, '0', 
                                                                             $cipher_suites.1, '0', 
                                                                             <'43', '0x0304'>, 
                                                                             <'10', $g1, $g>, 
                                                                             <'40', $g, $g^~x.1>, 
                                                                             <'45', '0', '1'>, '0', '41', 
                                                                             <p_psk_id, 
                                                                              mask(ticket_age_add, '1')>, 
                                                                             '0'>)
                                                                         >)
                                                                   >, 
                                                                   '2', '0x0303', p_ns, $cipher_suite, 
                                                                   <'13', $sig_algs>, '40', $g, p_gy>, 
                                                                  '8', $exts>, 
                                                                 '13', '0', $certificate_extensions>, 
                                                                '11', '0', pk(~ltkS)>, 
                                                               '15', 
                                                               sign(<'server_cv', 
                                                                     h(<
                                                                        <
                                                                         <
                                                                          <
                                                                           <
                                                                            <
                                                                             <'0', '1', '0x0303', ~tid, '0', 
                                                                              $cipher_suites, '0', 
                                                                              <'43', '0x0304'>, 
                                                                              <'10', $g1, $g>, 
                                                                              <'40', $g1, $g1^~x>, 
                                                                              <'45', '0', '1'>, <'42', '0'>, 
                                                                              '41', 
                                                                              <p_psk_id, 
                                                                               mask(ticket_age_add,
                                                                                    $ticket_age)
                                                                              >, 
                                                                              hmac(<
                                                                                    Expand(Expand(Extract(Expand(ms,
                                                                                                                 <
                                                                                                                  'rms', 
                                                                                                                  h(messages)
                                                                                                                 >,
                                                                                                                 '32'),
                                                                                                          '0'),
                                                                                                  <'res', 
                                                                                                   'pbk'>,
                                                                                                  '32'),
                                                                                           <'0', '0'>, '32'), 
                                                                                    h(<'0', '1', '0x0303', 
                                                                                       ~tid, '0', 
                                                                                       $cipher_suites, '0', 
                                                                                       <'43', '0x0304'>, 
                                                                                       <'10', $g1, $g>, 
                                                                                       <'40', $g1, $g1^~x>, 
                                                                                       <'45', '0', '1'>, 
                                                                                       <'42', '0'>, '41', 
                                                                                       <p_psk_id, 
                                                                                        mask(ticket_age_add,
                                                                                             $ticket_age)
                                                                                       >, 
                                                                                       '0'>)
                                                                                   >)
                                                                             >, 
                                                                             '6', '0x0303', '40', $g>, 
                                                                            '1', '0x0303', ~new_nc, '0', 
                                                                            $cipher_suites.1, '0', 
                                                                            <'43', '0x0304'>, 
                                                                            <'10', $g1, $g>, 
                                                                            <'40', $g, $g^~x.1>, 
                                                                            <'45', '0', '1'>, '0', '41', 
                                                                            <p_psk_id, 
                                                                             mask(ticket_age_add, '1')>, 
                                                                            hmac(<
                                                                                  Expand(Expand(Extract(Expand(ms,
                                                                                                               <
                                                                                                                'rms', 
                                                                                                                h(messages)
                                                                                                               >,
                                                                                                               '32'),
                                                                                                        '0'),
                                                                                                <'res', 'pbk'
                                                                                                >,
                                                                                                '32'),
                                                                                         <'0', '0'>, '32'), 
                                                                                  h(<
                                                                                     <
                                                                                      <'0', '1', '0x0303', 
                                                                                       ~tid, '0', 
                                                                                       $cipher_suites, '0', 
                                                                                       <'43', '0x0304'>, 
                                                                                       <'10', $g1, $g>, 
                                                                                       <'40', $g1, $g1^~x>, 
                                                                                       <'45', '0', '1'>, 
                                                                                       <'42', '0'>, '41', 
                                                                                       <p_psk_id, 
                                                                                        mask(ticket_age_add,
                                                                                             $ticket_age)
                                                                                       >, 
                                                                                       hmac(<
                                                                                             Expand(Expand(Extract(Expand(ms,
                                                                                                                          <
                                                                                                                           'rms', 
                                                                                                                           h(messages)
                                                                                                                          >,
                                                                                                                          '32'),
                                                                                                                   '0'),
                                                                                                           <
                                                                                                            'res', 
                                                                                                            'pbk'
                                                                                                           >,
                                                                                                           '32'),
                                                                                                    <'0', '0'
                                                                                                    >,
                                                                                                    '32'), 
                                                                                             h(<'0', '1', 
                                                                                                '0x0303', 
                                                                                                ~tid, '0', 
                                                                                                $cipher_suites, 
                                                                                                '0', 
                                                                                                <'43', 
                                                                                                 '0x0304'>, 
                                                                                                <'10', $g1, $g
                                                                                                >, 
                                                                                                <'40', $g1, 
                                                                                                 $g1^~x>, 
                                                                                                <'45', '0', 
                                                                                                 '1'>, 
                                                                                                <'42', '0'>, 
                                                                                                '41', 
                                                                                                <p_psk_id, 
                                                                                                 mask(ticket_age_add,
                                                                                                      $ticket_age)
                                                                                                >, 
                                                                                                '0'>)
                                                                                            >)
                                                                                      >, 
                                                                                      '6', '0x0303', '40', $g
                                                                                     >, 
                                                                                     '1', '0x0303', ~new_nc, 
                                                                                     '0', $cipher_suites.1, 
                                                                                     '0', <'43', '0x0304'>, 
                                                                                     <'10', $g1, $g>, 
                                                                                     <'40', $g, $g^~x.1>, 
                                                                                     <'45', '0', '1'>, '0', 
                                                                                     '41', 
                                                                                     <p_psk_id, 
                                                                                      mask(ticket_age_add,
                                                                                           '1')
                                                                                     >, 
                                                                                     '0'>)
                                                                                 >)
                                                                           >, 
                                                                           '2', '0x0303', p_ns, 
                                                                           $cipher_suite, <'13', $sig_algs>, 
                                                                           '40', $g, p_gy>, 
                                                                          '8', $exts>, 
                                                                         '13', '0', $certificate_extensions>, 
                                                                        '11', '0', pk(~ltkS)>)
                                                                    >,
                                                                    ~ltkS)
                                                              >)
                                                           >,
                                                           '32'),
                                                    <'fin', '0'>, '32'), 
                                             h(<
                                                <
                                                 <
                                                  <
                                                   <
                                                    <
                                                     <
                                                      <'0', '1', '0x0303', ~tid, '0', $cipher_suites, '0', 
                                                       <'43', '0x0304'>, <'10', $g1, $g>, 
                                                       <'40', $g1, $g1^~x>, <'45', '0', '1'>, <'42', '0'>, 
                                                       '41', <p_psk_id, mask(ticket_age_add, $ticket_age)>, 
                                                       hmac(<
                                                             Expand(Expand(Extract(Expand(ms,
                                                                                          <'rms', h(messages)
                                                                                          >,
                                                                                          '32'),
                                                                                   '0'),
                                                                           <'res', 'pbk'>, '32'),
                                                                    <'0', '0'>, '32'), 
                                                             h(<'0', '1', '0x0303', ~tid, '0', 
                                                                $cipher_suites, '0', <'43', '0x0304'>, 
                                                                <'10', $g1, $g>, <'40', $g1, $g1^~x>, 
                                                                <'45', '0', '1'>, <'42', '0'>, '41', 
                                                                <p_psk_id, mask(ticket_age_add, $ticket_age)
                                                                >, 
                                                                '0'>)
                                                            >)
                                                      >, 
                                                      '6', '0x0303', '40', $g>, 
                                                     '1', '0x0303', ~new_nc, '0', $cipher_suites.1, '0', 
                                                     <'43', '0x0304'>, <'10', $g1, $g>, <'40', $g, $g^~x.1>, 
                                                     <'45', '0', '1'>, '0', '41', 
                                                     <p_psk_id, mask(ticket_age_add, '1')>, 
                                                     hmac(<
                                                           Expand(Expand(Extract(Expand(ms,
                                                                                        <'rms', h(messages)>,
                                                                                        '32'),
                                                                                 '0'),
                                                                         <'res', 'pbk'>, '32'),
                                                                  <'0', '0'>, '32'), 
                                                           h(<
                                                              <
                                                               <'0', '1', '0x0303', ~tid, '0', 
                                                                $cipher_suites, '0', <'43', '0x0304'>, 
                                                                <'10', $g1, $g>, <'40', $g1, $g1^~x>, 
                                                                <'45', '0', '1'>, <'42', '0'>, '41', 
                                                                <p_psk_id, mask(ticket_age_add, $ticket_age)
                                                                >, 
                                                                hmac(<
                                                                      Expand(Expand(Extract(Expand(ms,
                                                                                                   <'rms', 
                                                                                                    h(messages)
                                                                                                   >,
                                                                                                   '32'),
                                                                                            '0'),
                                                                                    <'res', 'pbk'>, '32'),
                                                                             <'0', '0'>, '32'), 
                                                                      h(<'0', '1', '0x0303', ~tid, '0', 
                                                                         $cipher_suites, '0', 
                                                                         <'43', '0x0304'>, <'10', $g1, $g>, 
                                                                         <'40', $g1, $g1^~x>, 
                                                                         <'45', '0', '1'>, <'42', '0'>, '41', 
                                                                         <p_psk_id, 
                                                                          mask(ticket_age_add, $ticket_age)>, 
                                                                         '0'>)
                                                                     >)
                                                               >, 
                                                               '6', '0x0303', '40', $g>, 
                                                              '1', '0x0303', ~new_nc, '0', $cipher_suites.1, 
                                                              '0', <'43', '0x0304'>, <'10', $g1, $g>, 
                                                              <'40', $g, $g^~x.1>, <'45', '0', '1'>, '0', 
                                                              '41', <p_psk_id, mask(ticket_age_add, '1')>, '0'
                                                             >)
                                                          >)
                                                    >, 
                                                    '2', '0x0303', p_ns, $cipher_suite, <'13', $sig_algs>, 
                                                    '40', $g, p_gy>, 
                                                   '8', $exts>, 
                                                  '13', '0', $certificate_extensions>, 
                                                 '11', '0', pk(~ltkS)>, 
                                                '15', 
                                                sign(<'server_cv', 
                                                      h(<
                                                         <
                                                          <
                                                           <
                                                            <
                                                             <
                                                              <'0', '1', '0x0303', ~tid, '0', $cipher_suites, 
                                                               '0', <'43', '0x0304'>, <'10', $g1, $g>, 
                                                               <'40', $g1, $g1^~x>, <'45', '0', '1'>, 
                                                               <'42', '0'>, '41', 
                                                               <p_psk_id, mask(ticket_age_add, $ticket_age)>, 
                                                               hmac(<
                                                                     Expand(Expand(Extract(Expand(ms,
                                                                                                  <'rms', 
                                                                                                   h(messages)
                                                                                                  >,
                                                                                                  '32'),
                                                                                           '0'),
                                                                                   <'res', 'pbk'>, '32'),
                                                                            <'0', '0'>, '32'), 
                                                                     h(<'0', '1', '0x0303', ~tid, '0', 
                                                                        $cipher_suites, '0', 
                                                                        <'43', '0x0304'>, <'10', $g1, $g>, 
                                                                        <'40', $g1, $g1^~x>, 
                                                                        <'45', '0', '1'>, <'42', '0'>, '41', 
                                                                        <p_psk_id, 
                                                                         mask(ticket_age_add, $ticket_age)>, 
                                                                        '0'>)
                                                                    >)
                                                              >, 
                                                              '6', '0x0303', '40', $g>, 
                                                             '1', '0x0303', ~new_nc, '0', $cipher_suites.1, 
                                                             '0', <'43', '0x0304'>, <'10', $g1, $g>, 
                                                             <'40', $g, $g^~x.1>, <'45', '0', '1'>, '0', 
                                                             '41', <p_psk_id, mask(ticket_age_add, '1')>, 
                                                             hmac(<
                                                                   Expand(Expand(Extract(Expand(ms,
                                                                                                <'rms', 
                                                                                                 h(messages)>,
                                                                                                '32'),
                                                                                         '0'),
                                                                                 <'res', 'pbk'>, '32'),
                                                                          <'0', '0'>, '32'), 
                                                                   h(<
                                                                      <
                                                                       <'0', '1', '0x0303', ~tid, '0', 
                                                                        $cipher_suites, '0', 
                                                                        <'43', '0x0304'>, <'10', $g1, $g>, 
                                                                        <'40', $g1, $g1^~x>, 
                                                                        <'45', '0', '1'>, <'42', '0'>, '41', 
                                                                        <p_psk_id, 
                                                                         mask(ticket_age_add, $ticket_age)>, 
                                                                        hmac(<
                                                                              Expand(Expand(Extract(Expand(ms,
                                                                                                           <
                                                                                                            'rms', 
                                                                                                            h(messages)
                                                                                                           >,
                                                                                                           '32'),
                                                                                                    '0'),
                                                                                            <'res', 'pbk'>,
                                                                                            '32'),
                                                                                     <'0', '0'>, '32'), 
                                                                              h(<'0', '1', '0x0303', ~tid, 
                                                                                 '0', $cipher_suites, '0', 
                                                                                 <'43', '0x0304'>, 
                                                                                 <'10', $g1, $g>, 
                                                                                 <'40', $g1, $g1^~x>, 
                                                                                 <'45', '0', '1'>, 
                                                                                 <'42', '0'>, '41', 
                                                                                 <p_psk_id, 
                                                                                  mask(ticket_age_add,
                                                                                       $ticket_age)
                                                                                 >, 
                                                                                 '0'>)
                                                                             >)
                                                                       >, 
                                                                       '6', '0x0303', '40', $g>, 
                                                                      '1', '0x0303', ~new_nc, '0', 
                                                                      $cipher_suites.1, '0', 
                                                                      <'43', '0x0304'>, <'10', $g1, $g>, 
                                                                      <'40', $g, $g^~x.1>, <'45', '0', '1'>, 
                                                                      '0', '41', 
                                                                      <p_psk_id, mask(ticket_age_add, '1')>, 
                                                                      '0'>)
                                                                  >)
                                                            >, 
                                                            '2', '0x0303', p_ns, $cipher_suite, 
                                                            <'13', $sig_algs>, '40', $g, p_gy>, 
                                                           '8', $exts>, 
                                                          '13', '0', $certificate_extensions>, 
                                                         '11', '0', pk(~ltkS)>)
                                                     >,
                                                     ~ltkS)
                                               >)
                                            >)
                                      >)
                                   >,
                                   '32')
                 ) @ #l)
               ∧
                #l < #j.1)) )
        case case_1
        solve( (∃ #r. (RevLtk( $S ) @ #r) ∧ #r < #vr)  ∥
               (∃ tid3 x #r. (RevDHExp( tid3, $S, x ) @ #r) ∧ #r < #vr)  ∥
               (∃ tid4 y #r. (RevDHExp( tid4, $C, y ) @ #r) ∧ #r < #vr)  ∥
               (∃ rms #r. (RevealPSK( $C, rms ) @ #r) ∧ #r < #k.1)  ∥
               (∃ rms #r. (RevealPSK( $S, rms ) @ #r) ∧ #r < #k.1) )
          case case_1
          by contradiction /* from formulas */
        next
          case case_2
          by contradiction /* from formulas */
        next
          case case_3
          by contradiction /* from formulas */
        next
          case case_4
          solve( (∃ #r. (RevLtk( $S ) @ #r) ∧ #r < #vr)  ∥
                 (∃ tid3 x #r. (RevDHExp( tid3, $S, x ) @ #r) ∧ #r < #vr)  ∥
                 (∃ tid4 y #r. (RevDHExp( tid4, $C, y ) @ #r) ∧ #r < #vr)  ∥
                 (∃ rms #r. (RevealPSK( $C, rms ) @ #r) ∧ #r < #vr)  ∥
                 (∃ rms #r. (RevealPSK( $S, rms ) @ #r) ∧ #r < #vr) )
            case case_1
            by contradiction /* from formulas */
          next
            case case_2
            by contradiction /* from formulas */
          next
            case case_3
            by contradiction /* from formulas */
          next
            case case_4
            by contradiction /* from formulas */
          next
            case case_5
            by contradiction /* from formulas */
          qed
        next
          case case_5
          solve( (∃ #r. (RevLtk( $S ) @ #r) ∧ #r < #vr)  ∥
                 (∃ tid3 x #r. (RevDHExp( tid3, $S, x ) @ #r) ∧ #r < #vr)  ∥
                 (∃ tid4 y #r. (RevDHExp( tid4, $C, y ) @ #r) ∧ #r < #vr)  ∥
                 (∃ rms #r. (RevealPSK( $C, rms ) @ #r) ∧ #r < #vr)  ∥
                 (∃ rms #r. (RevealPSK( $S, rms ) @ #r) ∧ #r < #vr) )
            case case_1
            by contradiction /* from formulas */
          next
            case case_2
            by contradiction /* from formulas */
          next
            case case_3
            by contradiction /* from formulas */
          next
            case case_4
            by contradiction /* from formulas */
          next
            case case_5
            by contradiction /* from formulas */
          qed
        qed
      next
        case case_2
        solve( !Ltk( $C, ~ltkC ) ▶₂ #i )
          case Register_pk
          by solve( SecretPSK( $A,
                               Expand(Extract('0',
                                              Extract(p_gxy,
                                                      Extract(Expand(ms, <'rms', h(messages)>, '32'), '0'))),
                                      <'serverats', 
                                       h(<
                                          <
                                           <
                                            <
                                             <
                                              <
                                               <
                                                <
                                                 <'0', '1', '0x0303', ~tid, '0', $cipher_suites, '0', 
                                                  <'43', '0x0304'>, <'10', $g1, $g>, <'40', $g1, $g1^~x>, 
                                                  <'45', '0', '1'>, <'42', '0'>, '41', 
                                                  <p_psk_id, mask(ticket_age_add, $ticket_age)>, 
                                                  hmac(<
                                                        Expand(Expand(Extract(Expand(ms, <'rms', h(messages)>,
                                                                                     '32'),
                                                                              '0'),
                                                                      <'res', 'pbk'>, '32'),
                                                               <'0', '0'>, '32'), 
                                                        h(<'0', '1', '0x0303', ~tid, '0', $cipher_suites, 
                                                           '0', <'43', '0x0304'>, <'10', $g1, $g>, 
                                                           <'40', $g1, $g1^~x>, <'45', '0', '1'>, 
                                                           <'42', '0'>, '41', 
                                                           <p_psk_id, mask(ticket_age_add, $ticket_age)>, '0'
                                                          >)
                                                       >)
                                                 >, 
                                                 '6', '0x0303', '40', $g>, 
                                                '1', '0x0303', ~new_nc, '0', $cipher_suites.1, '0', 
                                                <'43', '0x0304'>, <'10', $g1, $g>, <'40', $g, $g^~x.1>, 
                                                <'45', '0', '1'>, '0', '41', 
                                                <p_psk_id, mask(ticket_age_add, '1')>, 
                                                hmac(<
                                                      Expand(Expand(Extract(Expand(ms, <'rms', h(messages)>,
                                                                                   '32'),
                                                                            '0'),
                                                                    <'res', 'pbk'>, '32'),
                                                             <'0', '0'>, '32'), 
                                                      h(<
                                                         <
                                                          <'0', '1', '0x0303', ~tid, '0', $cipher_suites, 
                                                           '0', <'43', '0x0304'>, <'10', $g1, $g>, 
                                                           <'40', $g1, $g1^~x>, <'45', '0', '1'>, 
                                                           <'42', '0'>, '41', 
                                                           <p_psk_id, mask(ticket_age_add, $ticket_age)>, 
                                                           hmac(<
                                                                 Expand(Expand(Extract(Expand(ms,
                                                                                              <'rms', 
                                                                                               h(messages)>,
                                                                                              '32'),
                                                                                       '0'),
                                                                               <'res', 'pbk'>, '32'),
                                                                        <'0', '0'>, '32'), 
                                                                 h(<'0', '1', '0x0303', ~tid, '0', 
                                                                    $cipher_suites, '0', <'43', '0x0304'>, 
                                                                    <'10', $g1, $g>, <'40', $g1, $g1^~x>, 
                                                                    <'45', '0', '1'>, <'42', '0'>, '41', 
                                                                    <p_psk_id, 
                                                                     mask(ticket_age_add, $ticket_age)>, 
                                                                    '0'>)
                                                                >)
                                                          >, 
                                                          '6', '0x0303', '40', $g>, 
                                                         '1', '0x0303', ~new_nc, '0', $cipher_suites.1, '0', 
                                                         <'43', '0x0304'>, <'10', $g1, $g>, 
                                                         <'40', $g, $g^~x.1>, <'45', '0', '1'>, '0', '41', 
                                                         <p_psk_id, mask(ticket_age_add, '1')>, '0'>)
                                                     >)
                                               >, 
                                               '2', '0x0303', p_ns, $cipher_suite, <'13', $sig_algs>, '40', 
                                               $g, p_gy>, 
                                              '8', $exts>, 
                                             '13', '0', $certificate_extensions>, 
                                            '11', '0', pk(~ltkS)>, 
                                           '15', 
                                           sign(<'server_cv', 
                                                 h(<
                                                    <
                                                     <
                                                      <
                                                       <
                                                        <
                                                         <'0', '1', '0x0303', ~tid, '0', $cipher_suites, '0', 
                                                          <'43', '0x0304'>, <'10', $g1, $g>, 
                                                          <'40', $g1, $g1^~x>, <'45', '0', '1'>, <'42', '0'>, 
                                                          '41', 
                                                          <p_psk_id, mask(ticket_age_add, $ticket_age)>, 
                                                          hmac(<
                                                                Expand(Expand(Extract(Expand(ms,
                                                                                             <'rms', 
                                                                                              h(messages)>,
                                                                                             '32'),
                                                                                      '0'),
                                                                              <'res', 'pbk'>, '32'),
                                                                       <'0', '0'>, '32'), 
                                                                h(<'0', '1', '0x0303', ~tid, '0', 
                                                                   $cipher_suites, '0', <'43', '0x0304'>, 
                                                                   <'10', $g1, $g>, <'40', $g1, $g1^~x>, 
                                                                   <'45', '0', '1'>, <'42', '0'>, '41', 
                                                                   <p_psk_id, 
                                                                    mask(ticket_age_add, $ticket_age)>, 
                                                                   '0'>)
                                                               >)
                                                         >, 
                                                         '6', '0x0303', '40', $g>, 
                                                        '1', '0x0303', ~new_nc, '0', $cipher_suites.1, '0', 
                                                        <'43', '0x0304'>, <'10', $g1, $g>, 
                                                        <'40', $g, $g^~x.1>, <'45', '0', '1'>, '0', '41', 
                                                        <p_psk_id, mask(ticket_age_add, '1')>, 
                                                        hmac(<
                                                              Expand(Expand(Extract(Expand(ms,
                                                                                           <'rms', h(messages)
                                                                                           >,
                                                                                           '32'),
                                                                                    '0'),
                                                                            <'res', 'pbk'>, '32'),
                                                                     <'0', '0'>, '32'), 
                                                              h(<
                                                                 <
                                                                  <'0', '1', '0x0303', ~tid, '0', 
                                                                   $cipher_suites, '0', <'43', '0x0304'>, 
                                                                   <'10', $g1, $g>, <'40', $g1, $g1^~x>, 
                                                                   <'45', '0', '1'>, <'42', '0'>, '41', 
                                                                   <p_psk_id, 
                                                                    mask(ticket_age_add, $ticket_age)>, 
                                                                   hmac(<
                                                                         Expand(Expand(Extract(Expand(ms,
                                                                                                      <'rms', 
                                                                                                       h(messages)
                                                                                                      >,
                                                                                                      '32'),
                                                                                               '0'),
                                                                                       <'res', 'pbk'>, '32'),
                                                                                <'0', '0'>, '32'), 
                                                                         h(<'0', '1', '0x0303', ~tid, '0', 
                                                                            $cipher_suites, '0', 
                                                                            <'43', '0x0304'>, 
                                                                            <'10', $g1, $g>, 
                                                                            <'40', $g1, $g1^~x>, 
                                                                            <'45', '0', '1'>, <'42', '0'>, 
                                                                            '41', 
                                                                            <p_psk_id, 
                                                                             mask(ticket_age_add, $ticket_age)
                                                                            >, 
                                                                            '0'>)
                                                                        >)
                                                                  >, 
                                                                  '6', '0x0303', '40', $g>, 
                                                                 '1', '0x0303', ~new_nc, '0', 
                                                                 $cipher_suites.1, '0', <'43', '0x0304'>, 
                                                                 <'10', $g1, $g>, <'40', $g, $g^~x.1>, 
                                                                 <'45', '0', '1'>, '0', '41', 
                                                                 <p_psk_id, mask(ticket_age_add, '1')>, '0'>)
                                                             >)
                                                       >, 
                                                       '2', '0x0303', p_ns, $cipher_suite, <'13', $sig_algs>, 
                                                       '40', $g, p_gy>, 
                                                      '8', $exts>, 
                                                     '13', '0', $certificate_extensions>, 
                                                    '11', '0', pk(~ltkS)>)
                                                >,
                                                ~ltkS)
                                          >, 
                                          '20', 
                                          hmac(<
                                                Expand(Expand(Extract(p_gxy,
                                                                      Extract(Expand(ms, <'rms', h(messages)>,
                                                                                     '32'),
                                                                              '0')),
                                                              <'serverhts', 
                                                               h(<
                                                                  <
                                                                   <
                                                                    <
                                                                     <
                                                                      <
                                                                       <
                                                                        <'0', '1', '0x0303', ~tid, '0', 
                                                                         $cipher_suites, '0', 
                                                                         <'43', '0x0304'>, <'10', $g1, $g>, 
                                                                         <'40', $g1, $g1^~x>, 
                                                                         <'45', '0', '1'>, <'42', '0'>, '41', 
                                                                         <p_psk_id, 
                                                                          mask(ticket_age_add, $ticket_age)>, 
                                                                         hmac(<
                                                                               Expand(Expand(Extract(Expand(ms,
                                                                                                            <
                                                                                                             'rms', 
                                                                                                             h(messages)
                                                                                                            >,
                                                                                                            '32'),
                                                                                                     '0'),
                                                                                             <'res', 'pbk'>,
                                                                                             '32'),
                                                                                      <'0', '0'>, '32'), 
                                                                               h(<'0', '1', '0x0303', ~tid, 
                                                                                  '0', $cipher_suites, '0', 
                                                                                  <'43', '0x0304'>, 
                                                                                  <'10', $g1, $g>, 
                                                                                  <'40', $g1, $g1^~x>, 
                                                                                  <'45', '0', '1'>, 
                                                                                  <'42', '0'>, '41', 
                                                                                  <p_psk_id, 
                                                                                   mask(ticket_age_add,
                                                                                        $ticket_age)
                                                                                  >, 
                                                                                  '0'>)
                                                                              >)
                                                                        >, 
                                                                        '6', '0x0303', '40', $g>, 
                                                                       '1', '0x0303', ~new_nc, '0', 
                                                                       $cipher_suites.1, '0', 
                                                                       <'43', '0x0304'>, <'10', $g1, $g>, 
                                                                       <'40', $g, $g^~x.1>, <'45', '0', '1'>, 
                                                                       '0', '41', 
                                                                       <p_psk_id, mask(ticket_age_add, '1')>, 
                                                                       hmac(<
                                                                             Expand(Expand(Extract(Expand(ms,
                                                                                                          <
                                                                                                           'rms', 
                                                                                                           h(messages)
                                                                                                          >,
                                                                                                          '32'),
                                                                                                   '0'),
                                                                                           <'res', 'pbk'>,
                                                                                           '32'),
                                                                                    <'0', '0'>, '32'), 
                                                                             h(<
                                                                                <
                                                                                 <'0', '1', '0x0303', ~tid, 
                                                                                  '0', $cipher_suites, '0', 
                                                                                  <'43', '0x0304'>, 
                                                                                  <'10', $g1, $g>, 
                                                                                  <'40', $g1, $g1^~x>, 
                                                                                  <'45', '0', '1'>, 
                                                                                  <'42', '0'>, '41', 
                                                                                  <p_psk_id, 
                                                                                   mask(ticket_age_add,
                                                                                        $ticket_age)
                                                                                  >, 
                                                                                  hmac(<
                                                                                        Expand(Expand(Extract(Expand(ms,
                                                                                                                     <
                                                                                                                      'rms', 
                                                                                                                      h(messages)
                                                                                                                     >,
                                                                                                                     '32'),
                                                                                                              '0'),
                                                                                                      <'res', 
                                                                                                       'pbk'>,
                                                                                                      '32'),
                                                                                               <'0', '0'>,
                                                                                               '32'), 
                                                                                        h(<'0', '1', 
                                                                                           '0x0303', ~tid, 
                                                                                           '0', 
                                                                                           $cipher_suites, 
                                                                                           '0', 
                                                                                           <'43', '0x0304'>, 
                                                                                           <'10', $g1, $g>, 
                                                                                           <'40', $g1, $g1^~x
                                                                                           >, 
                                                                                           <'45', '0', '1'>, 
                                                                                           <'42', '0'>, '41', 
                                                                                           <p_psk_id, 
                                                                                            mask(ticket_age_add,
                                                                                                 $ticket_age)
                                                                                           >, 
                                                                                           '0'>)
                                                                                       >)
                                                                                 >, 
                                                                                 '6', '0x0303', '40', $g>, 
                                                                                '1', '0x0303', ~new_nc, '0', 
                                                                                $cipher_suites.1, '0', 
                                                                                <'43', '0x0304'>, 
                                                                                <'10', $g1, $g>, 
                                                                                <'40', $g, $g^~x.1>, 
                                                                                <'45', '0', '1'>, '0', '41', 
                                                                                <p_psk_id, 
                                                                                 mask(ticket_age_add, '1')>, 
                                                                                '0'>)
                                                                            >)
                                                                      >, 
                                                                      '2', '0x0303', p_ns, $cipher_suite, 
                                                                      <'13', $sig_algs>, '40', $g, p_gy>, 
                                                                     '8', $exts>, 
                                                                    '13', '0', $certificate_extensions>, 
                                                                   '11', '0', pk(~ltkS)>, 
                                                                  '15', 
                                                                  sign(<'server_cv', 
                                                                        h(<
                                                                           <
                                                                            <
                                                                             <
                                                                              <
                                                                               <
                                                                                <'0', '1', '0x0303', ~tid, 
                                                                                 '0', $cipher_suites, '0', 
                                                                                 <'43', '0x0304'>, 
                                                                                 <'10', $g1, $g>, 
                                                                                 <'40', $g1, $g1^~x>, 
                                                                                 <'45', '0', '1'>, 
                                                                                 <'42', '0'>, '41', 
                                                                                 <p_psk_id, 
                                                                                  mask(ticket_age_add,
                                                                                       $ticket_age)
                                                                                 >, 
                                                                                 hmac(<
                                                                                       Expand(Expand(Extract(Expand(ms,
                                                                                                                    <
                                                                                                                     'rms', 
                                                                                                                     h(messages)
                                                                                                                    >,
                                                                                                                    '32'),
                                                                                                             '0'),
                                                                                                     <'res', 
                                                                                                      'pbk'>,
                                                                                                     '32'),
                                                                                              <'0', '0'>,
                                                                                              '32'), 
                                                                                       h(<'0', '1', '0x0303', 
                                                                                          ~tid, '0', 
                                                                                          $cipher_suites, 
                                                                                          '0', 
                                                                                          <'43', '0x0304'>, 
                                                                                          <'10', $g1, $g>, 
                                                                                          <'40', $g1, $g1^~x
                                                                                          >, 
                                                                                          <'45', '0', '1'>, 
                                                                                          <'42', '0'>, '41', 
                                                                                          <p_psk_id, 
                                                                                           mask(ticket_age_add,
                                                                                                $ticket_age)
                                                                                          >, 
                                                                                          '0'>)
                                                                                      >)
                                                                                >, 
                                                                                '6', '0x0303', '40', $g>, 
                                                                               '1', '0x0303', ~new_nc, '0', 
                                                                               $cipher_suites.1, '0', 
                                                                               <'43', '0x0304'>, 
                                                                               <'10', $g1, $g>, 
                                                                               <'40', $g, $g^~x.1>, 
                                                                               <'45', '0', '1'>, '0', '41', 
                                                                               <p_psk_id, 
                                                                                mask(ticket_age_add, '1')>, 
                                                                               hmac(<
                                                                                     Expand(Expand(Extract(Expand(ms,
                                                                                                                  <
                                                                                                                   'rms', 
                                                                                                                   h(messages)
                                                                                                                  >,
                                                                                                                  '32'),
                                                                                                           '0'),
                                                                                                   <'res', 
                                                                                                    'pbk'>,
                                                                                                   '32'),
                                                                                            <'0', '0'>,
                                                                                            '32'), 
                                                                                     h(<
                                                                                        <
                                                                                         <'0', '1', '0x0303', 
                                                                                          ~tid, '0', 
                                                                                          $cipher_suites, 
                                                                                          '0', 
                                                                                          <'43', '0x0304'>, 
                                                                                          <'10', $g1, $g>, 
                                                                                          <'40', $g1, $g1^~x
                                                                                          >, 
                                                                                          <'45', '0', '1'>, 
                                                                                          <'42', '0'>, '41', 
                                                                                          <p_psk_id, 
                                                                                           mask(ticket_age_add,
                                                                                                $ticket_age)
                                                                                          >, 
                                                                                          hmac(<
                                                                                                Expand(Expand(Extract(Expand(ms,
                                                                                                                             <
                                                                                                                              'rms', 
                                                                                                                              h(messages)
                                                                                                                             >,
                                                                                                                             '32'),
                                                                                                                      '0'),
                                                                                                              <
                                                                                                               'res', 
                                                                                                               'pbk'
                                                                                                              >,
                                                                                                              '32'),
                                                                                                       <'0', 
                                                                                                        '0'>,
                                                                                                       '32'), 
                                                                                                h(<'0', '1', 
                                                                                                   '0x0303', 
                                                                                                   ~tid, '0', 
                                                                                                   $cipher_suites, 
                                                                                                   '0', 
                                                                                                   <'43', 
                                                                                                    '0x0304'
                                                                                                   >, 
                                                                                                   <'10', 
                                                                                                    $g1, $g>, 
                                                                                                   <'40', 
                                                                                                    $g1, 
                                                                                                    $g1^~x>, 
                                                                                                   <'45', 
                                                                                                    '0', '1'
                                                                                                   >, 
                                                                                                   <'42', '0'
                                                                                                   >, 
                                                                                                   '41', 
                                                                                                   <p_psk_id, 
                                                                                                    mask(ticket_age_add,
                                                                                                         $ticket_age)
                                                                                                   >, 
                                                                                                   '0'>)
                                                                                               >)
                                                                                         >, 
                                                                                         '6', '0x0303', '40', 
                                                                                         $g>, 
                                                                                        '1', '0x0303', 
                                                                                        ~new_nc, '0', 
                                                                                        $cipher_suites.1, 
                                                                                        '0', 
                                                                                        <'43', '0x0304'>, 
                                                                                        <'10', $g1, $g>, 
                                                                                        <'40', $g, $g^~x.1>, 
                                                                                        <'45', '0', '1'>, 
                                                                                        '0', '41', 
                                                                                        <p_psk_id, 
                                                                                         mask(ticket_age_add,
                                                                                              '1')
                                                                                        >, 
                                                                                        '0'>)
                                                                                    >)
                                                                              >, 
                                                                              '2', '0x0303', p_ns, 
                                                                              $cipher_suite, 
                                                                              <'13', $sig_algs>, '40', $g, 
                                                                              p_gy>, 
                                                                             '8', $exts>, 
                                                                            '13', '0', $certificate_extensions
                                                                           >, 
                                                                           '11', '0', pk(~ltkS)>)
                                                                       >,
                                                                       ~ltkS)
                                                                 >)
                                                              >,
                                                              '32'),
                                                       <'fin', '0'>, '32'), 
                                                h(<
                                                   <
                                                    <
                                                     <
                                                      <
                                                       <
                                                        <
                                                         <'0', '1', '0x0303', ~tid, '0', $cipher_suites, '0', 
                                                          <'43', '0x0304'>, <'10', $g1, $g>, 
                                                          <'40', $g1, $g1^~x>, <'45', '0', '1'>, <'42', '0'>, 
                                                          '41', 
                                                          <p_psk_id, mask(ticket_age_add, $ticket_age)>, 
                                                          hmac(<
                                                                Expand(Expand(Extract(Expand(ms,
                                                                                             <'rms', 
                                                                                              h(messages)>,
                                                                                             '32'),
                                                                                      '0'),
                                                                              <'res', 'pbk'>, '32'),
                                                                       <'0', '0'>, '32'), 
                                                                h(<'0', '1', '0x0303', ~tid, '0', 
                                                                   $cipher_suites, '0', <'43', '0x0304'>, 
                                                                   <'10', $g1, $g>, <'40', $g1, $g1^~x>, 
                                                                   <'45', '0', '1'>, <'42', '0'>, '41', 
                                                                   <p_psk_id, 
                                                                    mask(ticket_age_add, $ticket_age)>, 
                                                                   '0'>)
                                                               >)
                                                         >, 
                                                         '6', '0x0303', '40', $g>, 
                                                        '1', '0x0303', ~new_nc, '0', $cipher_suites.1, '0', 
                                                        <'43', '0x0304'>, <'10', $g1, $g>, 
                                                        <'40', $g, $g^~x.1>, <'45', '0', '1'>, '0', '41', 
                                                        <p_psk_id, mask(ticket_age_add, '1')>, 
                                                        hmac(<
                                                              Expand(Expand(Extract(Expand(ms,
                                                                                           <'rms', h(messages)
                                                                                           >,
                                                                                           '32'),
                                                                                    '0'),
                                                                            <'res', 'pbk'>, '32'),
                                                                     <'0', '0'>, '32'), 
                                                              h(<
                                                                 <
                                                                  <'0', '1', '0x0303', ~tid, '0', 
                                                                   $cipher_suites, '0', <'43', '0x0304'>, 
                                                                   <'10', $g1, $g>, <'40', $g1, $g1^~x>, 
                                                                   <'45', '0', '1'>, <'42', '0'>, '41', 
                                                                   <p_psk_id, 
                                                                    mask(ticket_age_add, $ticket_age)>, 
                                                                   hmac(<
                                                                         Expand(Expand(Extract(Expand(ms,
                                                                                                      <'rms', 
                                                                                                       h(messages)
                                                                                                      >,
                                                                                                      '32'),
                                                                                               '0'),
                                                                                       <'res', 'pbk'>, '32'),
                                                                                <'0', '0'>, '32'), 
                                                                         h(<'0', '1', '0x0303', ~tid, '0', 
                                                                            $cipher_suites, '0', 
                                                                            <'43', '0x0304'>, 
                                                                            <'10', $g1, $g>, 
                                                                            <'40', $g1, $g1^~x>, 
                                                                            <'45', '0', '1'>, <'42', '0'>, 
                                                                            '41', 
                                                                            <p_psk_id, 
                                                                             mask(ticket_age_add, $ticket_age)
                                                                            >, 
                                                                            '0'>)
                                                                        >)
                                                                  >, 
                                                                  '6', '0x0303', '40', $g>, 
                                                                 '1', '0x0303', ~new_nc, '0', 
                                                                 $cipher_suites.1, '0', <'43', '0x0304'>, 
                                                                 <'10', $g1, $g>, <'40', $g, $g^~x.1>, 
                                                                 <'45', '0', '1'>, '0', '41', 
                                                                 <p_psk_id, mask(ticket_age_add, '1')>, '0'>)
                                                             >)
                                                       >, 
                                                       '2', '0x0303', p_ns, $cipher_suite, <'13', $sig_algs>, 
                                                       '40', $g, p_gy>, 
                                                      '8', $exts>, 
                                                     '13', '0', $certificate_extensions>, 
                                                    '11', '0', pk(~ltkS)>, 
                                                   '15', 
                                                   sign(<'server_cv', 
                                                         h(<
                                                            <
                                                             <
                                                              <
                                                               <
                                                                <
                                                                 <'0', '1', '0x0303', ~tid, '0', 
                                                                  $cipher_suites, '0', <'43', '0x0304'>, 
                                                                  <'10', $g1, $g>, <'40', $g1, $g1^~x>, 
                                                                  <'45', '0', '1'>, <'42', '0'>, '41', 
                                                                  <p_psk_id, mask(ticket_age_add, $ticket_age)
                                                                  >, 
                                                                  hmac(<
                                                                        Expand(Expand(Extract(Expand(ms,
                                                                                                     <'rms', 
                                                                                                      h(messages)
                                                                                                     >,
                                                                                                     '32'),
                                                                                              '0'),
                                                                                      <'res', 'pbk'>, '32'),
                                                                               <'0', '0'>, '32'), 
                                                                        h(<'0', '1', '0x0303', ~tid, '0', 
                                                                           $cipher_suites, '0', 
                                                                           <'43', '0x0304'>, <'10', $g1, $g>, 
                                                                           <'40', $g1, $g1^~x>, 
                                                                           <'45', '0', '1'>, <'42', '0'>, 
                                                                           '41', 
                                                                           <p_psk_id, 
                                                                            mask(ticket_age_add, $ticket_age)
                                                                           >, 
                                                                           '0'>)
                                                                       >)
                                                                 >, 
                                                                 '6', '0x0303', '40', $g>, 
                                                                '1', '0x0303', ~new_nc, '0', 
                                                                $cipher_suites.1, '0', <'43', '0x0304'>, 
                                                                <'10', $g1, $g>, <'40', $g, $g^~x.1>, 
                                                                <'45', '0', '1'>, '0', '41', 
                                                                <p_psk_id, mask(ticket_age_add, '1')>, 
                                                                hmac(<
                                                                      Expand(Expand(Extract(Expand(ms,
                                                                                                   <'rms', 
                                                                                                    h(messages)
                                                                                                   >,
                                                                                                   '32'),
                                                                                            '0'),
                                                                                    <'res', 'pbk'>, '32'),
                                                                             <'0', '0'>, '32'), 
                                                                      h(<
                                                                         <
                                                                          <'0', '1', '0x0303', ~tid, '0', 
                                                                           $cipher_suites, '0', 
                                                                           <'43', '0x0304'>, <'10', $g1, $g>, 
                                                                           <'40', $g1, $g1^~x>, 
                                                                           <'45', '0', '1'>, <'42', '0'>, 
                                                                           '41', 
                                                                           <p_psk_id, 
                                                                            mask(ticket_age_add, $ticket_age)
                                                                           >, 
                                                                           hmac(<
                                                                                 Expand(Expand(Extract(Expand(ms,
                                                                                                              <
                                                                                                               'rms', 
                                                                                                               h(messages)
                                                                                                              >,
                                                                                                              '32'),
                                                                                                       '0'),
                                                                                               <'res', 'pbk'>,
                                                                                               '32'),
                                                                                        <'0', '0'>, '32'), 
                                                                                 h(<'0', '1', '0x0303', ~tid, 
                                                                                    '0', $cipher_suites, '0', 
                                                                                    <'43', '0x0304'>, 
                                                                                    <'10', $g1, $g>, 
                                                                                    <'40', $g1, $g1^~x>, 
                                                                                    <'45', '0', '1'>, 
                                                                                    <'42', '0'>, '41', 
                                                                                    <p_psk_id, 
                                                                                     mask(ticket_age_add,
                                                                                          $ticket_age)
                                                                                    >, 
                                                                                    '0'>)
                                                                                >)
                                                                          >, 
                                                                          '6', '0x0303', '40', $g>, 
                                                                         '1', '0x0303', ~new_nc, '0', 
                                                                         $cipher_suites.1, '0', 
                                                                         <'43', '0x0304'>, <'10', $g1, $g>, 
                                                                         <'40', $g, $g^~x.1>, 
                                                                         <'45', '0', '1'>, '0', '41', 
                                                                         <p_psk_id, mask(ticket_age_add, '1')
                                                                         >, 
                                                                         '0'>)
                                                                     >)
                                                               >, 
                                                               '2', '0x0303', p_ns, $cipher_suite, 
                                                               <'13', $sig_algs>, '40', $g, p_gy>, 
                                                              '8', $exts>, 
                                                             '13', '0', $certificate_extensions>, 
                                                            '11', '0', pk(~ltkS)>)
                                                        >,
                                                        ~ltkS)
                                                  >)
                                               >)
                                         >)
                                      >,
                                      '32')
                    ) ▶₀ #l )
        qed
      qed
    next
      case recv_server_auth_case_09
      by contradiction /* from formulas */
    next
      case recv_server_auth_case_10
      by contradiction /* from formulas */
    next
      case recv_server_auth_case_11
      by contradiction /* from formulas */
    next
      case recv_server_auth_case_12
      by contradiction /* from formulas */
    next
      case recv_server_auth_case_13
      by contradiction /* from formulas */
    next
      case recv_server_auth_case_14
      by contradiction /* from formulas */
    next
      case recv_server_auth_case_15
      by contradiction /* from formulas */
    next
      case recv_server_auth_case_16
      by contradiction /* from formulas */
    qed
  next
    case case_2
    solve( F_State_C3( ~tid, $C, $S, p_res_psk, p_messages, p_nc, p_ns, p_g,
                       p_sg, p_hrr, p_x, p_y, p_gx, p_gy, p_gxy, 'na', p_psk_id, p_edi, p_es,
                       p_hs, Extract('0', p_hs), p_cats, p_sats, p_hs_keyc, p_hs_keys,
                       p_auth_status, p_ems, p_rms, '1'
           ) ▶₀ #i )
      case recv_server_auth_case_01
      solve( !Ltk( $C, ~ltkC ) ▶₂ #i )
        case Register_pk
        by solve( SecretPSK( $A,
                             Expand(Expand(Extract('0', Extract(p_gxy, Extract('0', '0'))),
                                           <'serverats', 
                                            h(<
                                               <
                                                <
                                                 <
                                                  <
                                                   <
                                                    <'0', '1', '0x0303', ~tid, '0', $cipher_suites, '0', 
                                                     <'43', '0x0304'>, <'10', $g, $g2>, <'13', $sig_algs>, 
                                                     '40', $g, $g^~x>, 
                                                    '2', '0x0303', p_ns, $cipher_suite, <'13', $sig_algs.1>, 
                                                    '40', $g, p_gy>, 
                                                   '8', $exts>, 
                                                  '13', '0', $certificate_extensions>, 
                                                 '11', '0', pk(~ltkS)>, 
                                                '15', 
                                                sign(<'server_cv', 
                                                      h(<
                                                         <
                                                          <
                                                           <
                                                            <'0', '1', '0x0303', ~tid, '0', $cipher_suites, 
                                                             '0', <'43', '0x0304'>, <'10', $g, $g2>, 
                                                             <'13', $sig_algs>, '40', $g, $g^~x>, 
                                                            '2', '0x0303', p_ns, $cipher_suite, 
                                                            <'13', $sig_algs.1>, '40', $g, p_gy>, 
                                                           '8', $exts>, 
                                                          '13', '0', $certificate_extensions>, 
                                                         '11', '0', pk(~ltkS)>)
                                                     >,
                                                     ~ltkS)
                                               >, 
                                               '20', 
                                               hmac(<
                                                     Expand(Expand(Extract(p_gxy, Extract('0', '0')),
                                                                   <'serverhts', 
                                                                    h(<
                                                                       <
                                                                        <
                                                                         <
                                                                          <
                                                                           <'0', '1', '0x0303', ~tid, '0', 
                                                                            $cipher_suites, '0', 
                                                                            <'43', '0x0304'>, 
                                                                            <'10', $g, $g2>, 
                                                                            <'13', $sig_algs>, '40', $g, $g^~x
                                                                           >, 
                                                                           '2', '0x0303', p_ns, 
                                                                           $cipher_suite, 
                                                                           <'13', $sig_algs.1>, '40', $g, p_gy
                                                                          >, 
                                                                          '8', $exts>, 
                                                                         '13', '0', $certificate_extensions>, 
                                                                        '11', '0', pk(~ltkS)>, 
                                                                       '15', 
                                                                       sign(<'server_cv', 
                                                                             h(<
                                                                                <
                                                                                 <
                                                                                  <
                                                                                   <'0', '1', '0x0303', ~tid, 
                                                                                    '0', $cipher_suites, '0', 
                                                                                    <'43', '0x0304'>, 
                                                                                    <'10', $g, $g2>, 
                                                                                    <'13', $sig_algs>, '40', 
                                                                                    $g, $g^~x>, 
                                                                                   '2', '0x0303', p_ns, 
                                                                                   $cipher_suite, 
                                                                                   <'13', $sig_algs.1>, '40', 
                                                                                   $g, p_gy>, 
                                                                                  '8', $exts>, 
                                                                                 '13', '0', 
                                                                                 $certificate_extensions>, 
                                                                                '11', '0', pk(~ltkS)>)
                                                                            >,
                                                                            ~ltkS)
                                                                      >)
                                                                   >,
                                                                   '32'),
                                                            <'fin', '0'>, '32'), 
                                                     h(<
                                                        <
                                                         <
                                                          <
                                                           <
                                                            <'0', '1', '0x0303', ~tid, '0', $cipher_suites, 
                                                             '0', <'43', '0x0304'>, <'10', $g, $g2>, 
                                                             <'13', $sig_algs>, '40', $g, $g^~x>, 
                                                            '2', '0x0303', p_ns, $cipher_suite, 
                                                            <'13', $sig_algs.1>, '40', $g, p_gy>, 
                                                           '8', $exts>, 
                                                          '13', '0', $certificate_extensions>, 
                                                         '11', '0', pk(~ltkS)>, 
                                                        '15', 
                                                        sign(<'server_cv', 
                                                              h(<
                                                                 <
                                                                  <
                                                                   <
                                                                    <'0', '1', '0x0303', ~tid, '0', 
                                                                     $cipher_suites, '0', <'43', '0x0304'>, 
                                                                     <'10', $g, $g2>, <'13', $sig_algs>, 
                                                                     '40', $g, $g^~x>, 
                                                                    '2', '0x0303', p_ns, $cipher_suite, 
                                                                    <'13', $sig_algs.1>, '40', $g, p_gy>, 
                                                                   '8', $exts>, 
                                                                  '13', '0', $certificate_extensions>, 
                                                                 '11', '0', pk(~ltkS)>)
                                                             >,
                                                             ~ltkS)
                                                       >)
                                                    >)
                                              >)
                                           >,
                                           '32'),
                                    <'adke_wk', '0'>, '32')
                  ) ▶₀ #l )
      qed
    next
      case recv_server_auth_case_02
      solve( !Ltk( $C, ~ltkC ) ▶₂ #i )
        case Register_pk
        by solve( SecretPSK( $A,
                             Expand(Expand(Extract('0', Extract(p_gxy, Extract('0', '0'))),
                                           <'serverats', 
                                            h(<
                                               <
                                                <
                                                 <
                                                  <
                                                   <
                                                    <
                                                     <
                                                      <'0', '1', '0x0303', ~tid, '0', $cipher_suites, '0', 
                                                       <'43', '0x0304'>, <'10', $g1, $g>, <'13', $sig_algs>, 
                                                       '40', $g1, $g1^~x>, 
                                                      '6', '0x0303', '40', $g>, 
                                                     '1', '0x0303', ~tid, '0', $cipher_suites.1, '0', 
                                                     <'43', '0x0304'>, <'10', $g1, $g>, <'13', $sig_algs.1>, 
                                                     '40', $g, $g^~x.1>, 
                                                    '2', '0x0303', p_ns, $cipher_suite, <'13', $sig_algs.2>, 
                                                    '40', $g, p_gy>, 
                                                   '8', $exts>, 
                                                  '13', '0', $certificate_extensions>, 
                                                 '11', '0', pk(~ltkS)>, 
                                                '15', 
                                                sign(<'server_cv', 
                                                      h(<
                                                         <
                                                          <
                                                           <
                                                            <
                                                             <
                                                              <'0', '1', '0x0303', ~tid, '0', $cipher_suites, 
                                                               '0', <'43', '0x0304'>, <'10', $g1, $g>, 
                                                               <'13', $sig_algs>, '40', $g1, $g1^~x>, 
                                                              '6', '0x0303', '40', $g>, 
                                                             '1', '0x0303', ~tid, '0', $cipher_suites.1, '0', 
                                                             <'43', '0x0304'>, <'10', $g1, $g>, 
                                                             <'13', $sig_algs.1>, '40', $g, $g^~x.1>, 
                                                            '2', '0x0303', p_ns, $cipher_suite, 
                                                            <'13', $sig_algs.2>, '40', $g, p_gy>, 
                                                           '8', $exts>, 
                                                          '13', '0', $certificate_extensions>, 
                                                         '11', '0', pk(~ltkS)>)
                                                     >,
                                                     ~ltkS)
                                               >, 
                                               '20', 
                                               hmac(<
                                                     Expand(Expand(Extract(p_gxy, Extract('0', '0')),
                                                                   <'serverhts', 
                                                                    h(<
                                                                       <
                                                                        <
                                                                         <
                                                                          <
                                                                           <
                                                                            <
                                                                             <'0', '1', '0x0303', ~tid, '0', 
                                                                              $cipher_suites, '0', 
                                                                              <'43', '0x0304'>, 
                                                                              <'10', $g1, $g>, 
                                                                              <'13', $sig_algs>, '40', $g1, 
                                                                              $g1^~x>, 
                                                                             '6', '0x0303', '40', $g>, 
                                                                            '1', '0x0303', ~tid, '0', 
                                                                            $cipher_suites.1, '0', 
                                                                            <'43', '0x0304'>, 
                                                                            <'10', $g1, $g>, 
                                                                            <'13', $sig_algs.1>, '40', $g, 
                                                                            $g^~x.1>, 
                                                                           '2', '0x0303', p_ns, 
                                                                           $cipher_suite, 
                                                                           <'13', $sig_algs.2>, '40', $g, p_gy
                                                                          >, 
                                                                          '8', $exts>, 
                                                                         '13', '0', $certificate_extensions>, 
                                                                        '11', '0', pk(~ltkS)>, 
                                                                       '15', 
                                                                       sign(<'server_cv', 
                                                                             h(<
                                                                                <
                                                                                 <
                                                                                  <
                                                                                   <
                                                                                    <
                                                                                     <'0', '1', '0x0303', 
                                                                                      ~tid, '0', 
                                                                                      $cipher_suites, '0', 
                                                                                      <'43', '0x0304'>, 
                                                                                      <'10', $g1, $g>, 
                                                                                      <'13', $sig_algs>, 
                                                                                      '40', $g1, $g1^~x>, 
                                                                                     '6', '0x0303', '40', $g
                                                                                    >, 
                                                                                    '1', '0x0303', ~tid, '0', 
                                                                                    $cipher_suites.1, '0', 
                                                                                    <'43', '0x0304'>, 
                                                                                    <'10', $g1, $g>, 
                                                                                    <'13', $sig_algs.1>, 
                                                                                    '40', $g, $g^~x.1>, 
                                                                                   '2', '0x0303', p_ns, 
                                                                                   $cipher_suite, 
                                                                                   <'13', $sig_algs.2>, '40', 
                                                                                   $g, p_gy>, 
                                                                                  '8', $exts>, 
                                                                                 '13', '0', 
                                                                                 $certificate_extensions>, 
                                                                                '11', '0', pk(~ltkS)>)
                                                                            >,
                                                                            ~ltkS)
                                                                      >)
                                                                   >,
                                                                   '32'),
                                                            <'fin', '0'>, '32'), 
                                                     h(<
                                                        <
                                                         <
                                                          <
                                                           <
                                                            <
                                                             <
                                                              <'0', '1', '0x0303', ~tid, '0', $cipher_suites, 
                                                               '0', <'43', '0x0304'>, <'10', $g1, $g>, 
                                                               <'13', $sig_algs>, '40', $g1, $g1^~x>, 
                                                              '6', '0x0303', '40', $g>, 
                                                             '1', '0x0303', ~tid, '0', $cipher_suites.1, '0', 
                                                             <'43', '0x0304'>, <'10', $g1, $g>, 
                                                             <'13', $sig_algs.1>, '40', $g, $g^~x.1>, 
                                                            '2', '0x0303', p_ns, $cipher_suite, 
                                                            <'13', $sig_algs.2>, '40', $g, p_gy>, 
                                                           '8', $exts>, 
                                                          '13', '0', $certificate_extensions>, 
                                                         '11', '0', pk(~ltkS)>, 
                                                        '15', 
                                                        sign(<'server_cv', 
                                                              h(<
                                                                 <
                                                                  <
                                                                   <
                                                                    <
                                                                     <
                                                                      <'0', '1', '0x0303', ~tid, '0', 
                                                                       $cipher_suites, '0', <'43', '0x0304'>, 
                                                                       <'10', $g1, $g>, <'13', $sig_algs>, 
                                                                       '40', $g1, $g1^~x>, 
                                                                      '6', '0x0303', '40', $g>, 
                                                                     '1', '0x0303', ~tid, '0', 
                                                                     $cipher_suites.1, '0', <'43', '0x0304'>, 
                                                                     <'10', $g1, $g>, <'13', $sig_algs.1>, 
                                                                     '40', $g, $g^~x.1>, 
                                                                    '2', '0x0303', p_ns, $cipher_suite, 
                                                                    <'13', $sig_algs.2>, '40', $g, p_gy>, 
                                                                   '8', $exts>, 
                                                                  '13', '0', $certificate_extensions>, 
                                                                 '11', '0', pk(~ltkS)>)
                                                             >,
                                                             ~ltkS)
                                                       >)
                                                    >)
                                              >)
                                           >,
                                           '32'),
                                    <'adke_wk', '0'>, '32')
                  ) ▶₀ #l )
      qed
    next
      case recv_server_auth_case_03
      solve( !Ltk( $C, ~ltkC ) ▶₂ #i )
        case Register_pk
        by solve( SecretPSK( $A,
                             Expand(Expand(Extract('0', Extract(p_gxy, Extract(~res_psk, '0'))),
                                           <'serverats', 
                                            h(<
                                               <
                                                <
                                                 <
                                                  <
                                                   <
                                                    <
                                                     <
                                                      <'0', '1', '0x0303', ~tid, '0', $cipher_suites, '0', 
                                                       <'43', '0x0304'>, <'10', $g1, $g>, 
                                                       <'40', $g1, $g1^~x>, <'45', '0', '1'>, <'42', '0'>, 
                                                       '41', <~ticket, mask(~ticket_age_add, $ticket_age)>, 
                                                       hmac(<
                                                             Expand(Expand(Extract(~res_psk, '0'),
                                                                           <'ext', 'pbk'>, '32'),
                                                                    <'0', '0'>, '32'), 
                                                             h(<'0', '1', '0x0303', ~tid, '0', 
                                                                $cipher_suites, '0', <'43', '0x0304'>, 
                                                                <'10', $g1, $g>, <'40', $g1, $g1^~x>, 
                                                                <'45', '0', '1'>, <'42', '0'>, '41', 
                                                                <~ticket, mask(~ticket_age_add, $ticket_age)
                                                                >, 
                                                                '0'>)
                                                            >)
                                                      >, 
                                                      '6', '0x0303', '40', $g>, 
                                                     '1', '0x0303', ~tid, '0', $cipher_suites.1, '0', 
                                                     <'43', '0x0304'>, <'10', $g1, $g>, <'13', $sig_algs>, 
                                                     '40', $g, $g^~x.1>, 
                                                    '2', '0x0303', p_ns, $cipher_suite, <'13', $sig_algs.1>, 
                                                    '40', $g, p_gy>, 
                                                   '8', $exts>, 
                                                  '13', '0', $certificate_extensions>, 
                                                 '11', '0', pk(~ltkS)>, 
                                                '15', 
                                                sign(<'server_cv', 
                                                      h(<
                                                         <
                                                          <
                                                           <
                                                            <
                                                             <
                                                              <'0', '1', '0x0303', ~tid, '0', $cipher_suites, 
                                                               '0', <'43', '0x0304'>, <'10', $g1, $g>, 
                                                               <'40', $g1, $g1^~x>, <'45', '0', '1'>, 
                                                               <'42', '0'>, '41', 
                                                               <~ticket, mask(~ticket_age_add, $ticket_age)>, 
                                                               hmac(<
                                                                     Expand(Expand(Extract(~res_psk, '0'),
                                                                                   <'ext', 'pbk'>, '32'),
                                                                            <'0', '0'>, '32'), 
                                                                     h(<'0', '1', '0x0303', ~tid, '0', 
                                                                        $cipher_suites, '0', 
                                                                        <'43', '0x0304'>, <'10', $g1, $g>, 
                                                                        <'40', $g1, $g1^~x>, 
                                                                        <'45', '0', '1'>, <'42', '0'>, '41', 
                                                                        <~ticket, 
                                                                         mask(~ticket_age_add, $ticket_age)>, 
                                                                        '0'>)
                                                                    >)
                                                              >, 
                                                              '6', '0x0303', '40', $g>, 
                                                             '1', '0x0303', ~tid, '0', $cipher_suites.1, '0', 
                                                             <'43', '0x0304'>, <'10', $g1, $g>, 
                                                             <'13', $sig_algs>, '40', $g, $g^~x.1>, 
                                                            '2', '0x0303', p_ns, $cipher_suite, 
                                                            <'13', $sig_algs.1>, '40', $g, p_gy>, 
                                                           '8', $exts>, 
                                                          '13', '0', $certificate_extensions>, 
                                                         '11', '0', pk(~ltkS)>)
                                                     >,
                                                     ~ltkS)
                                               >, 
                                               '20', 
                                               hmac(<
                                                     Expand(Expand(Extract(p_gxy, Extract(~res_psk, '0')),
                                                                   <'serverhts', 
                                                                    h(<
                                                                       <
                                                                        <
                                                                         <
                                                                          <
                                                                           <
                                                                            <
                                                                             <'0', '1', '0x0303', ~tid, '0', 
                                                                              $cipher_suites, '0', 
                                                                              <'43', '0x0304'>, 
                                                                              <'10', $g1, $g>, 
                                                                              <'40', $g1, $g1^~x>, 
                                                                              <'45', '0', '1'>, <'42', '0'>, 
                                                                              '41', 
                                                                              <~ticket, 
                                                                               mask(~ticket_age_add,
                                                                                    $ticket_age)
                                                                              >, 
                                                                              hmac(<
                                                                                    Expand(Expand(Extract(~res_psk,
                                                                                                          '0'),
                                                                                                  <'ext', 
                                                                                                   'pbk'>,
                                                                                                  '32'),
                                                                                           <'0', '0'>, '32'), 
                                                                                    h(<'0', '1', '0x0303', 
                                                                                       ~tid, '0', 
                                                                                       $cipher_suites, '0', 
                                                                                       <'43', '0x0304'>, 
                                                                                       <'10', $g1, $g>, 
                                                                                       <'40', $g1, $g1^~x>, 
                                                                                       <'45', '0', '1'>, 
                                                                                       <'42', '0'>, '41', 
                                                                                       <~ticket, 
                                                                                        mask(~ticket_age_add,
                                                                                             $ticket_age)
                                                                                       >, 
                                                                                       '0'>)
                                                                                   >)
                                                                             >, 
                                                                             '6', '0x0303', '40', $g>, 
                                                                            '1', '0x0303', ~tid, '0', 
                                                                            $cipher_suites.1, '0', 
                                                                            <'43', '0x0304'>, 
                                                                            <'10', $g1, $g>, 
                                                                            <'13', $sig_algs>, '40', $g, 
                                                                            $g^~x.1>, 
                                                                           '2', '0x0303', p_ns, 
                                                                           $cipher_suite, 
                                                                           <'13', $sig_algs.1>, '40', $g, p_gy
                                                                          >, 
                                                                          '8', $exts>, 
                                                                         '13', '0', $certificate_extensions>, 
                                                                        '11', '0', pk(~ltkS)>, 
                                                                       '15', 
                                                                       sign(<'server_cv', 
                                                                             h(<
                                                                                <
                                                                                 <
                                                                                  <
                                                                                   <
                                                                                    <
                                                                                     <'0', '1', '0x0303', 
                                                                                      ~tid, '0', 
                                                                                      $cipher_suites, '0', 
                                                                                      <'43', '0x0304'>, 
                                                                                      <'10', $g1, $g>, 
                                                                                      <'40', $g1, $g1^~x>, 
                                                                                      <'45', '0', '1'>, 
                                                                                      <'42', '0'>, '41', 
                                                                                      <~ticket, 
                                                                                       mask(~ticket_age_add,
                                                                                            $ticket_age)
                                                                                      >, 
                                                                                      hmac(<
                                                                                            Expand(Expand(Extract(~res_psk,
                                                                                                                  '0'),
                                                                                                          <
                                                                                                           'ext', 
                                                                                                           'pbk'
                                                                                                          >,
                                                                                                          '32'),
                                                                                                   <'0', '0'>,
                                                                                                   '32'), 
                                                                                            h(<'0', '1', 
                                                                                               '0x0303', 
                                                                                               ~tid, '0', 
                                                                                               $cipher_suites, 
                                                                                               '0', 
                                                                                               <'43', '0x0304'
                                                                                               >, 
                                                                                               <'10', $g1, $g
                                                                                               >, 
                                                                                               <'40', $g1, 
                                                                                                $g1^~x>, 
                                                                                               <'45', '0', '1'
                                                                                               >, 
                                                                                               <'42', '0'>, 
                                                                                               '41', 
                                                                                               <~ticket, 
                                                                                                mask(~ticket_age_add,
                                                                                                     $ticket_age)
                                                                                               >, 
                                                                                               '0'>)
                                                                                           >)
                                                                                     >, 
                                                                                     '6', '0x0303', '40', $g
                                                                                    >, 
                                                                                    '1', '0x0303', ~tid, '0', 
                                                                                    $cipher_suites.1, '0', 
                                                                                    <'43', '0x0304'>, 
                                                                                    <'10', $g1, $g>, 
                                                                                    <'13', $sig_algs>, '40', 
                                                                                    $g, $g^~x.1>, 
                                                                                   '2', '0x0303', p_ns, 
                                                                                   $cipher_suite, 
                                                                                   <'13', $sig_algs.1>, '40', 
                                                                                   $g, p_gy>, 
                                                                                  '8', $exts>, 
                                                                                 '13', '0', 
                                                                                 $certificate_extensions>, 
                                                                                '11', '0', pk(~ltkS)>)
                                                                            >,
                                                                            ~ltkS)
                                                                      >)
                                                                   >,
                                                                   '32'),
                                                            <'fin', '0'>, '32'), 
                                                     h(<
                                                        <
                                                         <
                                                          <
                                                           <
                                                            <
                                                             <
                                                              <'0', '1', '0x0303', ~tid, '0', $cipher_suites, 
                                                               '0', <'43', '0x0304'>, <'10', $g1, $g>, 
                                                               <'40', $g1, $g1^~x>, <'45', '0', '1'>, 
                                                               <'42', '0'>, '41', 
                                                               <~ticket, mask(~ticket_age_add, $ticket_age)>, 
                                                               hmac(<
                                                                     Expand(Expand(Extract(~res_psk, '0'),
                                                                                   <'ext', 'pbk'>, '32'),
                                                                            <'0', '0'>, '32'), 
                                                                     h(<'0', '1', '0x0303', ~tid, '0', 
                                                                        $cipher_suites, '0', 
                                                                        <'43', '0x0304'>, <'10', $g1, $g>, 
                                                                        <'40', $g1, $g1^~x>, 
                                                                        <'45', '0', '1'>, <'42', '0'>, '41', 
                                                                        <~ticket, 
                                                                         mask(~ticket_age_add, $ticket_age)>, 
                                                                        '0'>)
                                                                    >)
                                                              >, 
                                                              '6', '0x0303', '40', $g>, 
                                                             '1', '0x0303', ~tid, '0', $cipher_suites.1, '0', 
                                                             <'43', '0x0304'>, <'10', $g1, $g>, 
                                                             <'13', $sig_algs>, '40', $g, $g^~x.1>, 
                                                            '2', '0x0303', p_ns, $cipher_suite, 
                                                            <'13', $sig_algs.1>, '40', $g, p_gy>, 
                                                           '8', $exts>, 
                                                          '13', '0', $certificate_extensions>, 
                                                         '11', '0', pk(~ltkS)>, 
                                                        '15', 
                                                        sign(<'server_cv', 
                                                              h(<
                                                                 <
                                                                  <
                                                                   <
                                                                    <
                                                                     <
                                                                      <'0', '1', '0x0303', ~tid, '0', 
                                                                       $cipher_suites, '0', <'43', '0x0304'>, 
                                                                       <'10', $g1, $g>, <'40', $g1, $g1^~x>, 
                                                                       <'45', '0', '1'>, <'42', '0'>, '41', 
                                                                       <~ticket, 
                                                                        mask(~ticket_age_add, $ticket_age)>, 
                                                                       hmac(<
                                                                             Expand(Expand(Extract(~res_psk,
                                                                                                   '0'),
                                                                                           <'ext', 'pbk'>,
                                                                                           '32'),
                                                                                    <'0', '0'>, '32'), 
                                                                             h(<'0', '1', '0x0303', ~tid, 
                                                                                '0', $cipher_suites, '0', 
                                                                                <'43', '0x0304'>, 
                                                                                <'10', $g1, $g>, 
                                                                                <'40', $g1, $g1^~x>, 
                                                                                <'45', '0', '1'>, 
                                                                                <'42', '0'>, '41', 
                                                                                <~ticket, 
                                                                                 mask(~ticket_age_add,
                                                                                      $ticket_age)
                                                                                >, 
                                                                                '0'>)
                                                                            >)
                                                                      >, 
                                                                      '6', '0x0303', '40', $g>, 
                                                                     '1', '0x0303', ~tid, '0', 
                                                                     $cipher_suites.1, '0', <'43', '0x0304'>, 
                                                                     <'10', $g1, $g>, <'13', $sig_algs>, 
                                                                     '40', $g, $g^~x.1>, 
                                                                    '2', '0x0303', p_ns, $cipher_suite, 
                                                                    <'13', $sig_algs.1>, '40', $g, p_gy>, 
                                                                   '8', $exts>, 
                                                                  '13', '0', $certificate_extensions>, 
                                                                 '11', '0', pk(~ltkS)>)
                                                             >,
                                                             ~ltkS)
                                                       >)
                                                    >)
                                              >)
                                           >,
                                           '32'),
                                    <'adke_wk', '0'>, '32')
                  ) ▶₀ #l )
      qed
    next
      case recv_server_auth_case_04
      solve( !Ltk( $C, ~ltkC ) ▶₂ #i )
        case Register_pk
        by solve( SecretPSK( $A,
                             Expand(Expand(Extract('0',
                                                   Extract(p_gxy,
                                                           Extract(Expand(ms, <'rms', h(messages)>, '32'),
                                                                   '0'))),
                                           <'serverats', 
                                            h(<
                                               <
                                                <
                                                 <
                                                  <
                                                   <
                                                    <
                                                     <
                                                      <'0', '1', '0x0303', ~tid, '0', $cipher_suites, '0', 
                                                       <'43', '0x0304'>, <'10', $g1, $g>, 
                                                       <'40', $g1, $g1^~x>, <'45', '0', '1'>, <'42', '0'>, 
                                                       '41', <p_psk_id, mask(ticket_age_add, $ticket_age)>, 
                                                       hmac(<
                                                             Expand(Expand(Extract(Expand(ms,
                                                                                          <'rms', h(messages)
                                                                                          >,
                                                                                          '32'),
                                                                                   '0'),
                                                                           <'res', 'pbk'>, '32'),
                                                                    <'0', '0'>, '32'), 
                                                             h(<'0', '1', '0x0303', ~tid, '0', 
                                                                $cipher_suites, '0', <'43', '0x0304'>, 
                                                                <'10', $g1, $g>, <'40', $g1, $g1^~x>, 
                                                                <'45', '0', '1'>, <'42', '0'>, '41', 
                                                                <p_psk_id, mask(ticket_age_add, $ticket_age)
                                                                >, 
                                                                '0'>)
                                                            >)
                                                      >, 
                                                      '6', '0x0303', '40', $g>, 
                                                     '1', '0x0303', ~tid, '0', $cipher_suites.1, '0', 
                                                     <'43', '0x0304'>, <'10', $g1, $g>, <'13', $sig_algs>, 
                                                     '40', $g, $g^~x.1>, 
                                                    '2', '0x0303', p_ns, $cipher_suite, <'13', $sig_algs.1>, 
                                                    '40', $g, p_gy>, 
                                                   '8', $exts>, 
                                                  '13', '0', $certificate_extensions>, 
                                                 '11', '0', pk(~ltkS)>, 
                                                '15', 
                                                sign(<'server_cv', 
                                                      h(<
                                                         <
                                                          <
                                                           <
                                                            <
                                                             <
                                                              <'0', '1', '0x0303', ~tid, '0', $cipher_suites, 
                                                               '0', <'43', '0x0304'>, <'10', $g1, $g>, 
                                                               <'40', $g1, $g1^~x>, <'45', '0', '1'>, 
                                                               <'42', '0'>, '41', 
                                                               <p_psk_id, mask(ticket_age_add, $ticket_age)>, 
                                                               hmac(<
                                                                     Expand(Expand(Extract(Expand(ms,
                                                                                                  <'rms', 
                                                                                                   h(messages)
                                                                                                  >,
                                                                                                  '32'),
                                                                                           '0'),
                                                                                   <'res', 'pbk'>, '32'),
                                                                            <'0', '0'>, '32'), 
                                                                     h(<'0', '1', '0x0303', ~tid, '0', 
                                                                        $cipher_suites, '0', 
                                                                        <'43', '0x0304'>, <'10', $g1, $g>, 
                                                                        <'40', $g1, $g1^~x>, 
                                                                        <'45', '0', '1'>, <'42', '0'>, '41', 
                                                                        <p_psk_id, 
                                                                         mask(ticket_age_add, $ticket_age)>, 
                                                                        '0'>)
                                                                    >)
                                                              >, 
                                                              '6', '0x0303', '40', $g>, 
                                                             '1', '0x0303', ~tid, '0', $cipher_suites.1, '0', 
                                                             <'43', '0x0304'>, <'10', $g1, $g>, 
                                                             <'13', $sig_algs>, '40', $g, $g^~x.1>, 
                                                            '2', '0x0303', p_ns, $cipher_suite, 
                                                            <'13', $sig_algs.1>, '40', $g, p_gy>, 
                                                           '8', $exts>, 
                                                          '13', '0', $certificate_extensions>, 
                                                         '11', '0', pk(~ltkS)>)
                                                     >,
                                                     ~ltkS)
                                               >, 
                                               '20', 
                                               hmac(<
                                                     Expand(Expand(Extract(p_gxy,
                                                                           Extract(Expand(ms,
                                                                                          <'rms', h(messages)
                                                                                          >,
                                                                                          '32'),
                                                                                   '0')),
                                                                   <'serverhts', 
                                                                    h(<
                                                                       <
                                                                        <
                                                                         <
                                                                          <
                                                                           <
                                                                            <
                                                                             <'0', '1', '0x0303', ~tid, '0', 
                                                                              $cipher_suites, '0', 
                                                                              <'43', '0x0304'>, 
                                                                              <'10', $g1, $g>, 
                                                                              <'40', $g1, $g1^~x>, 
                                                                              <'45', '0', '1'>, <'42', '0'>, 
                                                                              '41', 
                                                                              <p_psk_id, 
                                                                               mask(ticket_age_add,
                                                                                    $ticket_age)
                                                                              >, 
                                                                              hmac(<
                                                                                    Expand(Expand(Extract(Expand(ms,
                                                                                                                 <
                                                                                                                  'rms', 
                                                                                                                  h(messages)
                                                                                                                 >,
                                                                                                                 '32'),
                                                                                                          '0'),
                                                                                                  <'res', 
                                                                                                   'pbk'>,
                                                                                                  '32'),
                                                                                           <'0', '0'>, '32'), 
                                                                                    h(<'0', '1', '0x0303', 
                                                                                       ~tid, '0', 
                                                                                       $cipher_suites, '0', 
                                                                                       <'43', '0x0304'>, 
                                                                                       <'10', $g1, $g>, 
                                                                                       <'40', $g1, $g1^~x>, 
                                                                                       <'45', '0', '1'>, 
                                                                                       <'42', '0'>, '41', 
                                                                                       <p_psk_id, 
                                                                                        mask(ticket_age_add,
                                                                                             $ticket_age)
                                                                                       >, 
                                                                                       '0'>)
                                                                                   >)
                                                                             >, 
                                                                             '6', '0x0303', '40', $g>, 
                                                                            '1', '0x0303', ~tid, '0', 
                                                                            $cipher_suites.1, '0', 
                                                                            <'43', '0x0304'>, 
                                                                            <'10', $g1, $g>, 
                                                                            <'13', $sig_algs>, '40', $g, 
                                                                            $g^~x.1>, 
                                                                           '2', '0x0303', p_ns, 
                                                                           $cipher_suite, 
                                                                           <'13', $sig_algs.1>, '40', $g, p_gy
                                                                          >, 
                                                                          '8', $exts>, 
                                                                         '13', '0', $certificate_extensions>, 
                                                                        '11', '0', pk(~ltkS)>, 
                                                                       '15', 
                                                                       sign(<'server_cv', 
                                                                             h(<
                                                                                <
                                                                                 <
                                                                                  <
                                                                                   <
                                                                                    <
                                                                                     <'0', '1', '0x0303', 
                                                                                      ~tid, '0', 
                                                                                      $cipher_suites, '0', 
                                                                                      <'43', '0x0304'>, 
                                                                                      <'10', $g1, $g>, 
                                                                                      <'40', $g1, $g1^~x>, 
                                                                                      <'45', '0', '1'>, 
                                                                                      <'42', '0'>, '41', 
                                                                                      <p_psk_id, 
                                                                                       mask(ticket_age_add,
                                                                                            $ticket_age)
                                                                                      >, 
                                                                                      hmac(<
                                                                                            Expand(Expand(Extract(Expand(ms,
                                                                                                                         <
                                                                                                                          'rms', 
                                                                                                                          h(messages)
                                                                                                                         >,
                                                                                                                         '32'),
                                                                                                                  '0'),
                                                                                                          <
                                                                                                           'res', 
                                                                                                           'pbk'
                                                                                                          >,
                                                                                                          '32'),
                                                                                                   <'0', '0'>,
                                                                                                   '32'), 
                                                                                            h(<'0', '1', 
                                                                                               '0x0303', 
                                                                                               ~tid, '0', 
                                                                                               $cipher_suites, 
                                                                                               '0', 
                                                                                               <'43', '0x0304'
                                                                                               >, 
                                                                                               <'10', $g1, $g
                                                                                               >, 
                                                                                               <'40', $g1, 
                                                                                                $g1^~x>, 
                                                                                               <'45', '0', '1'
                                                                                               >, 
                                                                                               <'42', '0'>, 
                                                                                               '41', 
                                                                                               <p_psk_id, 
                                                                                                mask(ticket_age_add,
                                                                                                     $ticket_age)
                                                                                               >, 
                                                                                               '0'>)
                                                                                           >)
                                                                                     >, 
                                                                                     '6', '0x0303', '40', $g
                                                                                    >, 
                                                                                    '1', '0x0303', ~tid, '0', 
                                                                                    $cipher_suites.1, '0', 
                                                                                    <'43', '0x0304'>, 
                                                                                    <'10', $g1, $g>, 
                                                                                    <'13', $sig_algs>, '40', 
                                                                                    $g, $g^~x.1>, 
                                                                                   '2', '0x0303', p_ns, 
                                                                                   $cipher_suite, 
                                                                                   <'13', $sig_algs.1>, '40', 
                                                                                   $g, p_gy>, 
                                                                                  '8', $exts>, 
                                                                                 '13', '0', 
                                                                                 $certificate_extensions>, 
                                                                                '11', '0', pk(~ltkS)>)
                                                                            >,
                                                                            ~ltkS)
                                                                      >)
                                                                   >,
                                                                   '32'),
                                                            <'fin', '0'>, '32'), 
                                                     h(<
                                                        <
                                                         <
                                                          <
                                                           <
                                                            <
                                                             <
                                                              <'0', '1', '0x0303', ~tid, '0', $cipher_suites, 
                                                               '0', <'43', '0x0304'>, <'10', $g1, $g>, 
                                                               <'40', $g1, $g1^~x>, <'45', '0', '1'>, 
                                                               <'42', '0'>, '41', 
                                                               <p_psk_id, mask(ticket_age_add, $ticket_age)>, 
                                                               hmac(<
                                                                     Expand(Expand(Extract(Expand(ms,
                                                                                                  <'rms', 
                                                                                                   h(messages)
                                                                                                  >,
                                                                                                  '32'),
                                                                                           '0'),
                                                                                   <'res', 'pbk'>, '32'),
                                                                            <'0', '0'>, '32'), 
                                                                     h(<'0', '1', '0x0303', ~tid, '0', 
                                                                        $cipher_suites, '0', 
                                                                        <'43', '0x0304'>, <'10', $g1, $g>, 
                                                                        <'40', $g1, $g1^~x>, 
                                                                        <'45', '0', '1'>, <'42', '0'>, '41', 
                                                                        <p_psk_id, 
                                                                         mask(ticket_age_add, $ticket_age)>, 
                                                                        '0'>)
                                                                    >)
                                                              >, 
                                                              '6', '0x0303', '40', $g>, 
                                                             '1', '0x0303', ~tid, '0', $cipher_suites.1, '0', 
                                                             <'43', '0x0304'>, <'10', $g1, $g>, 
                                                             <'13', $sig_algs>, '40', $g, $g^~x.1>, 
                                                            '2', '0x0303', p_ns, $cipher_suite, 
                                                            <'13', $sig_algs.1>, '40', $g, p_gy>, 
                                                           '8', $exts>, 
                                                          '13', '0', $certificate_extensions>, 
                                                         '11', '0', pk(~ltkS)>, 
                                                        '15', 
                                                        sign(<'server_cv', 
                                                              h(<
                                                                 <
                                                                  <
                                                                   <
                                                                    <
                                                                     <
                                                                      <'0', '1', '0x0303', ~tid, '0', 
                                                                       $cipher_suites, '0', <'43', '0x0304'>, 
                                                                       <'10', $g1, $g>, <'40', $g1, $g1^~x>, 
                                                                       <'45', '0', '1'>, <'42', '0'>, '41', 
                                                                       <p_psk_id, 
                                                                        mask(ticket_age_add, $ticket_age)>, 
                                                                       hmac(<
                                                                             Expand(Expand(Extract(Expand(ms,
                                                                                                          <
                                                                                                           'rms', 
                                                                                                           h(messages)
                                                                                                          >,
                                                                                                          '32'),
                                                                                                   '0'),
                                                                                           <'res', 'pbk'>,
                                                                                           '32'),
                                                                                    <'0', '0'>, '32'), 
                                                                             h(<'0', '1', '0x0303', ~tid, 
                                                                                '0', $cipher_suites, '0', 
                                                                                <'43', '0x0304'>, 
                                                                                <'10', $g1, $g>, 
                                                                                <'40', $g1, $g1^~x>, 
                                                                                <'45', '0', '1'>, 
                                                                                <'42', '0'>, '41', 
                                                                                <p_psk_id, 
                                                                                 mask(ticket_age_add,
                                                                                      $ticket_age)
                                                                                >, 
                                                                                '0'>)
                                                                            >)
                                                                      >, 
                                                                      '6', '0x0303', '40', $g>, 
                                                                     '1', '0x0303', ~tid, '0', 
                                                                     $cipher_suites.1, '0', <'43', '0x0304'>, 
                                                                     <'10', $g1, $g>, <'13', $sig_algs>, 
                                                                     '40', $g, $g^~x.1>, 
                                                                    '2', '0x0303', p_ns, $cipher_suite, 
                                                                    <'13', $sig_algs.1>, '40', $g, p_gy>, 
                                                                   '8', $exts>, 
                                                                  '13', '0', $certificate_extensions>, 
                                                                 '11', '0', pk(~ltkS)>)
                                                             >,
                                                             ~ltkS)
                                                       >)
                                                    >)
                                              >)
                                           >,
                                           '32'),
                                    <'adke_wk', '0'>, '32')
                  ) ▶₀ #l )
      qed
    next
      case recv_server_auth_case_05
      solve( !Ltk( $C, ~ltkC ) ▶₂ #i )
        case Register_pk
        by solve( SecretPSK( $A,
                             Expand(Expand(Extract('0', Extract(p_gxy, Extract(~res_psk, '0'))),
                                           <'serverats', 
                                            h(<
                                               <
                                                <
                                                 <
                                                  <
                                                   <
                                                    <'0', '1', '0x0303', ~tid, '0', $cipher_suites, '0', 
                                                     <'43', '0x0304'>, <'10', $g, $g2>, <'40', $g, $g^~x>, 
                                                     <'45', '0', '1'>, <'42', '0'>, '41', 
                                                     <~ticket, mask(~ticket_age_add, $ticket_age)>, 
                                                     hmac(<
                                                           Expand(Expand(Extract(~res_psk, '0'),
                                                                         <'ext', 'pbk'>, '32'),
                                                                  <'0', '0'>, '32'), 
                                                           h(<'0', '1', '0x0303', ~tid, '0', $cipher_suites, 
                                                              '0', <'43', '0x0304'>, <'10', $g, $g2>, 
                                                              <'40', $g, $g^~x>, <'45', '0', '1'>, 
                                                              <'42', '0'>, '41', 
                                                              <~ticket, mask(~ticket_age_add, $ticket_age)>, 
                                                              '0'>)
                                                          >)
                                                    >, 
                                                    '2', '0x0303', p_ns, $cipher_suite, <'13', $sig_algs>, 
                                                    '40', $g, p_gy>, 
                                                   '8', $exts>, 
                                                  '13', '0', $certificate_extensions>, 
                                                 '11', '0', pk(~ltkS)>, 
                                                '15', 
                                                sign(<'server_cv', 
                                                      h(<
                                                         <
                                                          <
                                                           <
                                                            <'0', '1', '0x0303', ~tid, '0', $cipher_suites, 
                                                             '0', <'43', '0x0304'>, <'10', $g, $g2>, 
                                                             <'40', $g, $g^~x>, <'45', '0', '1'>, 
                                                             <'42', '0'>, '41', 
                                                             <~ticket, mask(~ticket_age_add, $ticket_age)>, 
                                                             hmac(<
                                                                   Expand(Expand(Extract(~res_psk, '0'),
                                                                                 <'ext', 'pbk'>, '32'),
                                                                          <'0', '0'>, '32'), 
                                                                   h(<'0', '1', '0x0303', ~tid, '0', 
                                                                      $cipher_suites, '0', <'43', '0x0304'>, 
                                                                      <'10', $g, $g2>, <'40', $g, $g^~x>, 
                                                                      <'45', '0', '1'>, <'42', '0'>, '41', 
                                                                      <~ticket, 
                                                                       mask(~ticket_age_add, $ticket_age)>, 
                                                                      '0'>)
                                                                  >)
                                                            >, 
                                                            '2', '0x0303', p_ns, $cipher_suite, 
                                                            <'13', $sig_algs>, '40', $g, p_gy>, 
                                                           '8', $exts>, 
                                                          '13', '0', $certificate_extensions>, 
                                                         '11', '0', pk(~ltkS)>)
                                                     >,
                                                     ~ltkS)
                                               >, 
                                               '20', 
                                               hmac(<
                                                     Expand(Expand(Extract(p_gxy, Extract(~res_psk, '0')),
                                                                   <'serverhts', 
                                                                    h(<
                                                                       <
                                                                        <
                                                                         <
                                                                          <
                                                                           <'0', '1', '0x0303', ~tid, '0', 
                                                                            $cipher_suites, '0', 
                                                                            <'43', '0x0304'>, 
                                                                            <'10', $g, $g2>, 
                                                                            <'40', $g, $g^~x>, 
                                                                            <'45', '0', '1'>, <'42', '0'>, 
                                                                            '41', 
                                                                            <~ticket, 
                                                                             mask(~ticket_age_add,
                                                                                  $ticket_age)
                                                                            >, 
                                                                            hmac(<
                                                                                  Expand(Expand(Extract(~res_psk,
                                                                                                        '0'),
                                                                                                <'ext', 'pbk'
                                                                                                >,
                                                                                                '32'),
                                                                                         <'0', '0'>, '32'), 
                                                                                  h(<'0', '1', '0x0303', 
                                                                                     ~tid, '0', 
                                                                                     $cipher_suites, '0', 
                                                                                     <'43', '0x0304'>, 
                                                                                     <'10', $g, $g2>, 
                                                                                     <'40', $g, $g^~x>, 
                                                                                     <'45', '0', '1'>, 
                                                                                     <'42', '0'>, '41', 
                                                                                     <~ticket, 
                                                                                      mask(~ticket_age_add,
                                                                                           $ticket_age)
                                                                                     >, 
                                                                                     '0'>)
                                                                                 >)
                                                                           >, 
                                                                           '2', '0x0303', p_ns, 
                                                                           $cipher_suite, <'13', $sig_algs>, 
                                                                           '40', $g, p_gy>, 
                                                                          '8', $exts>, 
                                                                         '13', '0', $certificate_extensions>, 
                                                                        '11', '0', pk(~ltkS)>, 
                                                                       '15', 
                                                                       sign(<'server_cv', 
                                                                             h(<
                                                                                <
                                                                                 <
                                                                                  <
                                                                                   <'0', '1', '0x0303', ~tid, 
                                                                                    '0', $cipher_suites, '0', 
                                                                                    <'43', '0x0304'>, 
                                                                                    <'10', $g, $g2>, 
                                                                                    <'40', $g, $g^~x>, 
                                                                                    <'45', '0', '1'>, 
                                                                                    <'42', '0'>, '41', 
                                                                                    <~ticket, 
                                                                                     mask(~ticket_age_add,
                                                                                          $ticket_age)
                                                                                    >, 
                                                                                    hmac(<
                                                                                          Expand(Expand(Extract(~res_psk,
                                                                                                                '0'),
                                                                                                        <
                                                                                                         'ext', 
                                                                                                         'pbk'
                                                                                                        >,
                                                                                                        '32'),
                                                                                                 <'0', '0'>,
                                                                                                 '32'), 
                                                                                          h(<'0', '1', 
                                                                                             '0x0303', ~tid, 
                                                                                             '0', 
                                                                                             $cipher_suites, 
                                                                                             '0', 
                                                                                             <'43', '0x0304'
                                                                                             >, 
                                                                                             <'10', $g, $g2>, 
                                                                                             <'40', $g, $g^~x
                                                                                             >, 
                                                                                             <'45', '0', '1'
                                                                                             >, 
                                                                                             <'42', '0'>, 
                                                                                             '41', 
                                                                                             <~ticket, 
                                                                                              mask(~ticket_age_add,
                                                                                                   $ticket_age)
                                                                                             >, 
                                                                                             '0'>)
                                                                                         >)
                                                                                   >, 
                                                                                   '2', '0x0303', p_ns, 
                                                                                   $cipher_suite, 
                                                                                   <'13', $sig_algs>, '40', 
                                                                                   $g, p_gy>, 
                                                                                  '8', $exts>, 
                                                                                 '13', '0', 
                                                                                 $certificate_extensions>, 
                                                                                '11', '0', pk(~ltkS)>)
                                                                            >,
                                                                            ~ltkS)
                                                                      >)
                                                                   >,
                                                                   '32'),
                                                            <'fin', '0'>, '32'), 
                                                     h(<
                                                        <
                                                         <
                                                          <
                                                           <
                                                            <'0', '1', '0x0303', ~tid, '0', $cipher_suites, 
                                                             '0', <'43', '0x0304'>, <'10', $g, $g2>, 
                                                             <'40', $g, $g^~x>, <'45', '0', '1'>, 
                                                             <'42', '0'>, '41', 
                                                             <~ticket, mask(~ticket_age_add, $ticket_age)>, 
                                                             hmac(<
                                                                   Expand(Expand(Extract(~res_psk, '0'),
                                                                                 <'ext', 'pbk'>, '32'),
                                                                          <'0', '0'>, '32'), 
                                                                   h(<'0', '1', '0x0303', ~tid, '0', 
                                                                      $cipher_suites, '0', <'43', '0x0304'>, 
                                                                      <'10', $g, $g2>, <'40', $g, $g^~x>, 
                                                                      <'45', '0', '1'>, <'42', '0'>, '41', 
                                                                      <~ticket, 
                                                                       mask(~ticket_age_add, $ticket_age)>, 
                                                                      '0'>)
                                                                  >)
                                                            >, 
                                                            '2', '0x0303', p_ns, $cipher_suite, 
                                                            <'13', $sig_algs>, '40', $g, p_gy>, 
                                                           '8', $exts>, 
                                                          '13', '0', $certificate_extensions>, 
                                                         '11', '0', pk(~ltkS)>, 
                                                        '15', 
                                                        sign(<'server_cv', 
                                                              h(<
                                                                 <
                                                                  <
                                                                   <
                                                                    <'0', '1', '0x0303', ~tid, '0', 
                                                                     $cipher_suites, '0', <'43', '0x0304'>, 
                                                                     <'10', $g, $g2>, <'40', $g, $g^~x>, 
                                                                     <'45', '0', '1'>, <'42', '0'>, '41', 
                                                                     <~ticket, 
                                                                      mask(~ticket_age_add, $ticket_age)>, 
                                                                     hmac(<
                                                                           Expand(Expand(Extract(~res_psk,
                                                                                                 '0'),
                                                                                         <'ext', 'pbk'>,
                                                                                         '32'),
                                                                                  <'0', '0'>, '32'), 
                                                                           h(<'0', '1', '0x0303', ~tid, '0', 
                                                                              $cipher_suites, '0', 
                                                                              <'43', '0x0304'>, 
                                                                              <'10', $g, $g2>, 
                                                                              <'40', $g, $g^~x>, 
                                                                              <'45', '0', '1'>, <'42', '0'>, 
                                                                              '41', 
                                                                              <~ticket, 
                                                                               mask(~ticket_age_add,
                                                                                    $ticket_age)
                                                                              >, 
                                                                              '0'>)
                                                                          >)
                                                                    >, 
                                                                    '2', '0x0303', p_ns, $cipher_suite, 
                                                                    <'13', $sig_algs>, '40', $g, p_gy>, 
                                                                   '8', $exts>, 
                                                                  '13', '0', $certificate_extensions>, 
                                                                 '11', '0', pk(~ltkS)>)
                                                             >,
                                                             ~ltkS)
                                                       >)
                                                    >)
                                              >)
                                           >,
                                           '32'),
                                    <'adke_wk', '0'>, '32')
                  ) ▶₀ #l )
      qed
    next
      case recv_server_auth_case_06
      solve( !Ltk( $C, ~ltkC ) ▶₂ #i )
        case Register_pk
        by solve( SecretPSK( $A,
                             Expand(Expand(Extract('0',
                                                   Extract(p_gxy,
                                                           Extract(Expand(ms, <'rms', h(messages)>, '32'),
                                                                   '0'))),
                                           <'serverats', 
                                            h(<
                                               <
                                                <
                                                 <
                                                  <
                                                   <
                                                    <'0', '1', '0x0303', ~tid, '0', $cipher_suites, '0', 
                                                     <'43', '0x0304'>, <'10', $g, $g2>, <'40', $g, $g^~x>, 
                                                     <'45', '0', '1'>, <'42', '0'>, '41', 
                                                     <p_psk_id, mask(ticket_age_add, $ticket_age)>, 
                                                     hmac(<
                                                           Expand(Expand(Extract(Expand(ms,
                                                                                        <'rms', h(messages)>,
                                                                                        '32'),
                                                                                 '0'),
                                                                         <'res', 'pbk'>, '32'),
                                                                  <'0', '0'>, '32'), 
                                                           h(<'0', '1', '0x0303', ~tid, '0', $cipher_suites, 
                                                              '0', <'43', '0x0304'>, <'10', $g, $g2>, 
                                                              <'40', $g, $g^~x>, <'45', '0', '1'>, 
                                                              <'42', '0'>, '41', 
                                                              <p_psk_id, mask(ticket_age_add, $ticket_age)>, 
                                                              '0'>)
                                                          >)
                                                    >, 
                                                    '2', '0x0303', p_ns, $cipher_suite, <'13', $sig_algs>, 
                                                    '40', $g, p_gy>, 
                                                   '8', $exts>, 
                                                  '13', '0', $certificate_extensions>, 
                                                 '11', '0', pk(~ltkS)>, 
                                                '15', 
                                                sign(<'server_cv', 
                                                      h(<
                                                         <
                                                          <
                                                           <
                                                            <'0', '1', '0x0303', ~tid, '0', $cipher_suites, 
                                                             '0', <'43', '0x0304'>, <'10', $g, $g2>, 
                                                             <'40', $g, $g^~x>, <'45', '0', '1'>, 
                                                             <'42', '0'>, '41', 
                                                             <p_psk_id, mask(ticket_age_add, $ticket_age)>, 
                                                             hmac(<
                                                                   Expand(Expand(Extract(Expand(ms,
                                                                                                <'rms', 
                                                                                                 h(messages)>,
                                                                                                '32'),
                                                                                         '0'),
                                                                                 <'res', 'pbk'>, '32'),
                                                                          <'0', '0'>, '32'), 
                                                                   h(<'0', '1', '0x0303', ~tid, '0', 
                                                                      $cipher_suites, '0', <'43', '0x0304'>, 
                                                                      <'10', $g, $g2>, <'40', $g, $g^~x>, 
                                                                      <'45', '0', '1'>, <'42', '0'>, '41', 
                                                                      <p_psk_id, 
                                                                       mask(ticket_age_add, $ticket_age)>, 
                                                                      '0'>)
                                                                  >)
                                                            >, 
                                                            '2', '0x0303', p_ns, $cipher_suite, 
                                                            <'13', $sig_algs>, '40', $g, p_gy>, 
                                                           '8', $exts>, 
                                                          '13', '0', $certificate_extensions>, 
                                                         '11', '0', pk(~ltkS)>)
                                                     >,
                                                     ~ltkS)
                                               >, 
                                               '20', 
                                               hmac(<
                                                     Expand(Expand(Extract(p_gxy,
                                                                           Extract(Expand(ms,
                                                                                          <'rms', h(messages)
                                                                                          >,
                                                                                          '32'),
                                                                                   '0')),
                                                                   <'serverhts', 
                                                                    h(<
                                                                       <
                                                                        <
                                                                         <
                                                                          <
                                                                           <'0', '1', '0x0303', ~tid, '0', 
                                                                            $cipher_suites, '0', 
                                                                            <'43', '0x0304'>, 
                                                                            <'10', $g, $g2>, 
                                                                            <'40', $g, $g^~x>, 
                                                                            <'45', '0', '1'>, <'42', '0'>, 
                                                                            '41', 
                                                                            <p_psk_id, 
                                                                             mask(ticket_age_add, $ticket_age)
                                                                            >, 
                                                                            hmac(<
                                                                                  Expand(Expand(Extract(Expand(ms,
                                                                                                               <
                                                                                                                'rms', 
                                                                                                                h(messages)
                                                                                                               >,
                                                                                                               '32'),
                                                                                                        '0'),
                                                                                                <'res', 'pbk'
                                                                                                >,
                                                                                                '32'),
                                                                                         <'0', '0'>, '32'), 
                                                                                  h(<'0', '1', '0x0303', 
                                                                                     ~tid, '0', 
                                                                                     $cipher_suites, '0', 
                                                                                     <'43', '0x0304'>, 
                                                                                     <'10', $g, $g2>, 
                                                                                     <'40', $g, $g^~x>, 
                                                                                     <'45', '0', '1'>, 
                                                                                     <'42', '0'>, '41', 
                                                                                     <p_psk_id, 
                                                                                      mask(ticket_age_add,
                                                                                           $ticket_age)
                                                                                     >, 
                                                                                     '0'>)
                                                                                 >)
                                                                           >, 
                                                                           '2', '0x0303', p_ns, 
                                                                           $cipher_suite, <'13', $sig_algs>, 
                                                                           '40', $g, p_gy>, 
                                                                          '8', $exts>, 
                                                                         '13', '0', $certificate_extensions>, 
                                                                        '11', '0', pk(~ltkS)>, 
                                                                       '15', 
                                                                       sign(<'server_cv', 
                                                                             h(<
                                                                                <
                                                                                 <
                                                                                  <
                                                                                   <'0', '1', '0x0303', ~tid, 
                                                                                    '0', $cipher_suites, '0', 
                                                                                    <'43', '0x0304'>, 
                                                                                    <'10', $g, $g2>, 
                                                                                    <'40', $g, $g^~x>, 
                                                                                    <'45', '0', '1'>, 
                                                                                    <'42', '0'>, '41', 
                                                                                    <p_psk_id, 
                                                                                     mask(ticket_age_add,
                                                                                          $ticket_age)
                                                                                    >, 
                                                                                    hmac(<
                                                                                          Expand(Expand(Extract(Expand(ms,
                                                                                                                       <
                                                                                                                        'rms', 
                                                                                                                        h(messages)
                                                                                                                       >,
                                                                                                                       '32'),
                                                                                                                '0'),
                                                                                                        <
                                                                                                         'res', 
                                                                                                         'pbk'
                                                                                                        >,
                                                                                                        '32'),
                                                                                                 <'0', '0'>,
                                                                                                 '32'), 
                                                                                          h(<'0', '1', 
                                                                                             '0x0303', ~tid, 
                                                                                             '0', 
                                                                                             $cipher_suites, 
                                                                                             '0', 
                                                                                             <'43', '0x0304'
                                                                                             >, 
                                                                                             <'10', $g, $g2>, 
                                                                                             <'40', $g, $g^~x
                                                                                             >, 
                                                                                             <'45', '0', '1'
                                                                                             >, 
                                                                                             <'42', '0'>, 
                                                                                             '41', 
                                                                                             <p_psk_id, 
                                                                                              mask(ticket_age_add,
                                                                                                   $ticket_age)
                                                                                             >, 
                                                                                             '0'>)
                                                                                         >)
                                                                                   >, 
                                                                                   '2', '0x0303', p_ns, 
                                                                                   $cipher_suite, 
                                                                                   <'13', $sig_algs>, '40', 
                                                                                   $g, p_gy>, 
                                                                                  '8', $exts>, 
                                                                                 '13', '0', 
                                                                                 $certificate_extensions>, 
                                                                                '11', '0', pk(~ltkS)>)
                                                                            >,
                                                                            ~ltkS)
                                                                      >)
                                                                   >,
                                                                   '32'),
                                                            <'fin', '0'>, '32'), 
                                                     h(<
                                                        <
                                                         <
                                                          <
                                                           <
                                                            <'0', '1', '0x0303', ~tid, '0', $cipher_suites, 
                                                             '0', <'43', '0x0304'>, <'10', $g, $g2>, 
                                                             <'40', $g, $g^~x>, <'45', '0', '1'>, 
                                                             <'42', '0'>, '41', 
                                                             <p_psk_id, mask(ticket_age_add, $ticket_age)>, 
                                                             hmac(<
                                                                   Expand(Expand(Extract(Expand(ms,
                                                                                                <'rms', 
                                                                                                 h(messages)>,
                                                                                                '32'),
                                                                                         '0'),
                                                                                 <'res', 'pbk'>, '32'),
                                                                          <'0', '0'>, '32'), 
                                                                   h(<'0', '1', '0x0303', ~tid, '0', 
                                                                      $cipher_suites, '0', <'43', '0x0304'>, 
                                                                      <'10', $g, $g2>, <'40', $g, $g^~x>, 
                                                                      <'45', '0', '1'>, <'42', '0'>, '41', 
                                                                      <p_psk_id, 
                                                                       mask(ticket_age_add, $ticket_age)>, 
                                                                      '0'>)
                                                                  >)
                                                            >, 
                                                            '2', '0x0303', p_ns, $cipher_suite, 
                                                            <'13', $sig_algs>, '40', $g, p_gy>, 
                                                           '8', $exts>, 
                                                          '13', '0', $certificate_extensions>, 
                                                         '11', '0', pk(~ltkS)>, 
                                                        '15', 
                                                        sign(<'server_cv', 
                                                              h(<
                                                                 <
                                                                  <
                                                                   <
                                                                    <'0', '1', '0x0303', ~tid, '0', 
                                                                     $cipher_suites, '0', <'43', '0x0304'>, 
                                                                     <'10', $g, $g2>, <'40', $g, $g^~x>, 
                                                                     <'45', '0', '1'>, <'42', '0'>, '41', 
                                                                     <p_psk_id, 
                                                                      mask(ticket_age_add, $ticket_age)>, 
                                                                     hmac(<
                                                                           Expand(Expand(Extract(Expand(ms,
                                                                                                        <
                                                                                                         'rms', 
                                                                                                         h(messages)
                                                                                                        >,
                                                                                                        '32'),
                                                                                                 '0'),
                                                                                         <'res', 'pbk'>,
                                                                                         '32'),
                                                                                  <'0', '0'>, '32'), 
                                                                           h(<'0', '1', '0x0303', ~tid, '0', 
                                                                              $cipher_suites, '0', 
                                                                              <'43', '0x0304'>, 
                                                                              <'10', $g, $g2>, 
                                                                              <'40', $g, $g^~x>, 
                                                                              <'45', '0', '1'>, <'42', '0'>, 
                                                                              '41', 
                                                                              <p_psk_id, 
                                                                               mask(ticket_age_add,
                                                                                    $ticket_age)
                                                                              >, 
                                                                              '0'>)
                                                                          >)
                                                                    >, 
                                                                    '2', '0x0303', p_ns, $cipher_suite, 
                                                                    <'13', $sig_algs>, '40', $g, p_gy>, 
                                                                   '8', $exts>, 
                                                                  '13', '0', $certificate_extensions>, 
                                                                 '11', '0', pk(~ltkS)>)
                                                             >,
                                                             ~ltkS)
                                                       >)
                                                    >)
                                              >)
                                           >,
                                           '32'),
                                    <'adke_wk', '0'>, '32')
                  ) ▶₀ #l )
      qed
    next
      case recv_server_auth_case_07
      solve( !Ltk( $C, ~ltkC ) ▶₂ #i )
        case Register_pk
        by solve( SecretPSK( $A,
                             Expand(Expand(Extract('0', Extract(p_gxy, Extract(~res_psk, '0'))),
                                           <'serverats', 
                                            h(<
                                               <
                                                <
                                                 <
                                                  <
                                                   <
                                                    <
                                                     <
                                                      <'0', '1', '0x0303', ~tid, '0', $cipher_suites, '0', 
                                                       <'43', '0x0304'>, <'10', $g1, $g>, 
                                                       <'40', $g1, $g1^~x>, <'45', '0', '1'>, <'42', '0'>, 
                                                       '41', <~ticket, mask(~ticket_age_add, $ticket_age)>, 
                                                       hmac(<
                                                             Expand(Expand(Extract(~res_psk, '0'),
                                                                           <'ext', 'pbk'>, '32'),
                                                                    <'0', '0'>, '32'), 
                                                             h(<'0', '1', '0x0303', ~tid, '0', 
                                                                $cipher_suites, '0', <'43', '0x0304'>, 
                                                                <'10', $g1, $g>, <'40', $g1, $g1^~x>, 
                                                                <'45', '0', '1'>, <'42', '0'>, '41', 
                                                                <~ticket, mask(~ticket_age_add, $ticket_age)
                                                                >, 
                                                                '0'>)
                                                            >)
                                                      >, 
                                                      '6', '0x0303', '40', $g>, 
                                                     '1', '0x0303', ~new_nc, '0', $cipher_suites.1, '0', 
                                                     <'43', '0x0304'>, <'10', $g1, $g>, <'40', $g, $g^~x.1>, 
                                                     <'45', '0', '1'>, '0', '41', 
                                                     <~ticket, mask(~ticket_age_add, '1')>, 
                                                     hmac(<
                                                           Expand(Expand(Extract(~res_psk, '0'),
                                                                         <'ext', 'pbk'>, '32'),
                                                                  <'0', '0'>, '32'), 
                                                           h(<
                                                              <
                                                               <'0', '1', '0x0303', ~tid, '0', 
                                                                $cipher_suites, '0', <'43', '0x0304'>, 
                                                                <'10', $g1, $g>, <'40', $g1, $g1^~x>, 
                                                                <'45', '0', '1'>, <'42', '0'>, '41', 
                                                                <~ticket, mask(~ticket_age_add, $ticket_age)
                                                                >, 
                                                                hmac(<
                                                                      Expand(Expand(Extract(~res_psk, '0'),
                                                                                    <'ext', 'pbk'>, '32'),
                                                                             <'0', '0'>, '32'), 
                                                                      h(<'0', '1', '0x0303', ~tid, '0', 
                                                                         $cipher_suites, '0', 
                                                                         <'43', '0x0304'>, <'10', $g1, $g>, 
                                                                         <'40', $g1, $g1^~x>, 
                                                                         <'45', '0', '1'>, <'42', '0'>, '41', 
                                                                         <~ticket, 
                                                                          mask(~ticket_age_add, $ticket_age)
                                                                         >, 
                                                                         '0'>)
                                                                     >)
                                                               >, 
                                                               '6', '0x0303', '40', $g>, 
                                                              '1', '0x0303', ~new_nc, '0', $cipher_suites.1, 
                                                              '0', <'43', '0x0304'>, <'10', $g1, $g>, 
                                                              <'40', $g, $g^~x.1>, <'45', '0', '1'>, '0', 
                                                              '41', <~ticket, mask(~ticket_age_add, '1')>, '0'
                                                             >)
                                                          >)
                                                    >, 
                                                    '2', '0x0303', p_ns, $cipher_suite, <'13', $sig_algs>, 
                                                    '40', $g, p_gy>, 
                                                   '8', $exts>, 
                                                  '13', '0', $certificate_extensions>, 
                                                 '11', '0', pk(~ltkS)>, 
                                                '15', 
                                                sign(<'server_cv', 
                                                      h(<
                                                         <
                                                          <
                                                           <
                                                            <
                                                             <
                                                              <'0', '1', '0x0303', ~tid, '0', $cipher_suites, 
                                                               '0', <'43', '0x0304'>, <'10', $g1, $g>, 
                                                               <'40', $g1, $g1^~x>, <'45', '0', '1'>, 
                                                               <'42', '0'>, '41', 
                                                               <~ticket, mask(~ticket_age_add, $ticket_age)>, 
                                                               hmac(<
                                                                     Expand(Expand(Extract(~res_psk, '0'),
                                                                                   <'ext', 'pbk'>, '32'),
                                                                            <'0', '0'>, '32'), 
                                                                     h(<'0', '1', '0x0303', ~tid, '0', 
                                                                        $cipher_suites, '0', 
                                                                        <'43', '0x0304'>, <'10', $g1, $g>, 
                                                                        <'40', $g1, $g1^~x>, 
                                                                        <'45', '0', '1'>, <'42', '0'>, '41', 
                                                                        <~ticket, 
                                                                         mask(~ticket_age_add, $ticket_age)>, 
                                                                        '0'>)
                                                                    >)
                                                              >, 
                                                              '6', '0x0303', '40', $g>, 
                                                             '1', '0x0303', ~new_nc, '0', $cipher_suites.1, 
                                                             '0', <'43', '0x0304'>, <'10', $g1, $g>, 
                                                             <'40', $g, $g^~x.1>, <'45', '0', '1'>, '0', 
                                                             '41', <~ticket, mask(~ticket_age_add, '1')>, 
                                                             hmac(<
                                                                   Expand(Expand(Extract(~res_psk, '0'),
                                                                                 <'ext', 'pbk'>, '32'),
                                                                          <'0', '0'>, '32'), 
                                                                   h(<
                                                                      <
                                                                       <'0', '1', '0x0303', ~tid, '0', 
                                                                        $cipher_suites, '0', 
                                                                        <'43', '0x0304'>, <'10', $g1, $g>, 
                                                                        <'40', $g1, $g1^~x>, 
                                                                        <'45', '0', '1'>, <'42', '0'>, '41', 
                                                                        <~ticket, 
                                                                         mask(~ticket_age_add, $ticket_age)>, 
                                                                        hmac(<
                                                                              Expand(Expand(Extract(~res_psk,
                                                                                                    '0'),
                                                                                            <'ext', 'pbk'>,
                                                                                            '32'),
                                                                                     <'0', '0'>, '32'), 
                                                                              h(<'0', '1', '0x0303', ~tid, 
                                                                                 '0', $cipher_suites, '0', 
                                                                                 <'43', '0x0304'>, 
                                                                                 <'10', $g1, $g>, 
                                                                                 <'40', $g1, $g1^~x>, 
                                                                                 <'45', '0', '1'>, 
                                                                                 <'42', '0'>, '41', 
                                                                                 <~ticket, 
                                                                                  mask(~ticket_age_add,
                                                                                       $ticket_age)
                                                                                 >, 
                                                                                 '0'>)
                                                                             >)
                                                                       >, 
                                                                       '6', '0x0303', '40', $g>, 
                                                                      '1', '0x0303', ~new_nc, '0', 
                                                                      $cipher_suites.1, '0', 
                                                                      <'43', '0x0304'>, <'10', $g1, $g>, 
                                                                      <'40', $g, $g^~x.1>, <'45', '0', '1'>, 
                                                                      '0', '41', 
                                                                      <~ticket, mask(~ticket_age_add, '1')>, 
                                                                      '0'>)
                                                                  >)
                                                            >, 
                                                            '2', '0x0303', p_ns, $cipher_suite, 
                                                            <'13', $sig_algs>, '40', $g, p_gy>, 
                                                           '8', $exts>, 
                                                          '13', '0', $certificate_extensions>, 
                                                         '11', '0', pk(~ltkS)>)
                                                     >,
                                                     ~ltkS)
                                               >, 
                                               '20', 
                                               hmac(<
                                                     Expand(Expand(Extract(p_gxy, Extract(~res_psk, '0')),
                                                                   <'serverhts', 
                                                                    h(<
                                                                       <
                                                                        <
                                                                         <
                                                                          <
                                                                           <
                                                                            <
                                                                             <'0', '1', '0x0303', ~tid, '0', 
                                                                              $cipher_suites, '0', 
                                                                              <'43', '0x0304'>, 
                                                                              <'10', $g1, $g>, 
                                                                              <'40', $g1, $g1^~x>, 
                                                                              <'45', '0', '1'>, <'42', '0'>, 
                                                                              '41', 
                                                                              <~ticket, 
                                                                               mask(~ticket_age_add,
                                                                                    $ticket_age)
                                                                              >, 
                                                                              hmac(<
                                                                                    Expand(Expand(Extract(~res_psk,
                                                                                                          '0'),
                                                                                                  <'ext', 
                                                                                                   'pbk'>,
                                                                                                  '32'),
                                                                                           <'0', '0'>, '32'), 
                                                                                    h(<'0', '1', '0x0303', 
                                                                                       ~tid, '0', 
                                                                                       $cipher_suites, '0', 
                                                                                       <'43', '0x0304'>, 
                                                                                       <'10', $g1, $g>, 
                                                                                       <'40', $g1, $g1^~x>, 
                                                                                       <'45', '0', '1'>, 
                                                                                       <'42', '0'>, '41', 
                                                                                       <~ticket, 
                                                                                        mask(~ticket_age_add,
                                                                                             $ticket_age)
                                                                                       >, 
                                                                                       '0'>)
                                                                                   >)
                                                                             >, 
                                                                             '6', '0x0303', '40', $g>, 
                                                                            '1', '0x0303', ~new_nc, '0', 
                                                                            $cipher_suites.1, '0', 
                                                                            <'43', '0x0304'>, 
                                                                            <'10', $g1, $g>, 
                                                                            <'40', $g, $g^~x.1>, 
                                                                            <'45', '0', '1'>, '0', '41', 
                                                                            <~ticket, 
                                                                             mask(~ticket_age_add, '1')>, 
                                                                            hmac(<
                                                                                  Expand(Expand(Extract(~res_psk,
                                                                                                        '0'),
                                                                                                <'ext', 'pbk'
                                                                                                >,
                                                                                                '32'),
                                                                                         <'0', '0'>, '32'), 
                                                                                  h(<
                                                                                     <
                                                                                      <'0', '1', '0x0303', 
                                                                                       ~tid, '0', 
                                                                                       $cipher_suites, '0', 
                                                                                       <'43', '0x0304'>, 
                                                                                       <'10', $g1, $g>, 
                                                                                       <'40', $g1, $g1^~x>, 
                                                                                       <'45', '0', '1'>, 
                                                                                       <'42', '0'>, '41', 
                                                                                       <~ticket, 
                                                                                        mask(~ticket_age_add,
                                                                                             $ticket_age)
                                                                                       >, 
                                                                                       hmac(<
                                                                                             Expand(Expand(Extract(~res_psk,
                                                                                                                   '0'),
                                                                                                           <
                                                                                                            'ext', 
                                                                                                            'pbk'
                                                                                                           >,
                                                                                                           '32'),
                                                                                                    <'0', '0'
                                                                                                    >,
                                                                                                    '32'), 
                                                                                             h(<'0', '1', 
                                                                                                '0x0303', 
                                                                                                ~tid, '0', 
                                                                                                $cipher_suites, 
                                                                                                '0', 
                                                                                                <'43', 
                                                                                                 '0x0304'>, 
                                                                                                <'10', $g1, $g
                                                                                                >, 
                                                                                                <'40', $g1, 
                                                                                                 $g1^~x>, 
                                                                                                <'45', '0', 
                                                                                                 '1'>, 
                                                                                                <'42', '0'>, 
                                                                                                '41', 
                                                                                                <~ticket, 
                                                                                                 mask(~ticket_age_add,
                                                                                                      $ticket_age)
                                                                                                >, 
                                                                                                '0'>)
                                                                                            >)
                                                                                      >, 
                                                                                      '6', '0x0303', '40', $g
                                                                                     >, 
                                                                                     '1', '0x0303', ~new_nc, 
                                                                                     '0', $cipher_suites.1, 
                                                                                     '0', <'43', '0x0304'>, 
                                                                                     <'10', $g1, $g>, 
                                                                                     <'40', $g, $g^~x.1>, 
                                                                                     <'45', '0', '1'>, '0', 
                                                                                     '41', 
                                                                                     <~ticket, 
                                                                                      mask(~ticket_age_add,
                                                                                           '1')
                                                                                     >, 
                                                                                     '0'>)
                                                                                 >)
                                                                           >, 
                                                                           '2', '0x0303', p_ns, 
                                                                           $cipher_suite, <'13', $sig_algs>, 
                                                                           '40', $g, p_gy>, 
                                                                          '8', $exts>, 
                                                                         '13', '0', $certificate_extensions>, 
                                                                        '11', '0', pk(~ltkS)>, 
                                                                       '15', 
                                                                       sign(<'server_cv', 
                                                                             h(<
                                                                                <
                                                                                 <
                                                                                  <
                                                                                   <
                                                                                    <
                                                                                     <'0', '1', '0x0303', 
                                                                                      ~tid, '0', 
                                                                                      $cipher_suites, '0', 
                                                                                      <'43', '0x0304'>, 
                                                                                      <'10', $g1, $g>, 
                                                                                      <'40', $g1, $g1^~x>, 
                                                                                      <'45', '0', '1'>, 
                                                                                      <'42', '0'>, '41', 
                                                                                      <~ticket, 
                                                                                       mask(~ticket_age_add,
                                                                                            $ticket_age)
                                                                                      >, 
                                                                                      hmac(<
                                                                                            Expand(Expand(Extract(~res_psk,
                                                                                                                  '0'),
                                                                                                          <
                                                                                                           'ext', 
                                                                                                           'pbk'
                                                                                                          >,
                                                                                                          '32'),
                                                                                                   <'0', '0'>,
                                                                                                   '32'), 
                                                                                            h(<'0', '1', 
                                                                                               '0x0303', 
                                                                                               ~tid, '0', 
                                                                                               $cipher_suites, 
                                                                                               '0', 
                                                                                               <'43', '0x0304'
                                                                                               >, 
                                                                                               <'10', $g1, $g
                                                                                               >, 
                                                                                               <'40', $g1, 
                                                                                                $g1^~x>, 
                                                                                               <'45', '0', '1'
                                                                                               >, 
                                                                                               <'42', '0'>, 
                                                                                               '41', 
                                                                                               <~ticket, 
                                                                                                mask(~ticket_age_add,
                                                                                                     $ticket_age)
                                                                                               >, 
                                                                                               '0'>)
                                                                                           >)
                                                                                     >, 
                                                                                     '6', '0x0303', '40', $g
                                                                                    >, 
                                                                                    '1', '0x0303', ~new_nc, 
                                                                                    '0', $cipher_suites.1, 
                                                                                    '0', <'43', '0x0304'>, 
                                                                                    <'10', $g1, $g>, 
                                                                                    <'40', $g, $g^~x.1>, 
                                                                                    <'45', '0', '1'>, '0', 
                                                                                    '41', 
                                                                                    <~ticket, 
                                                                                     mask(~ticket_age_add,
                                                                                          '1')
                                                                                    >, 
                                                                                    hmac(<
                                                                                          Expand(Expand(Extract(~res_psk,
                                                                                                                '0'),
                                                                                                        <
                                                                                                         'ext', 
                                                                                                         'pbk'
                                                                                                        >,
                                                                                                        '32'),
                                                                                                 <'0', '0'>,
                                                                                                 '32'), 
                                                                                          h(<
                                                                                             <
                                                                                              <'0', '1', 
                                                                                               '0x0303', 
                                                                                               ~tid, '0', 
                                                                                               $cipher_suites, 
                                                                                               '0', 
                                                                                               <'43', '0x0304'
                                                                                               >, 
                                                                                               <'10', $g1, $g
                                                                                               >, 
                                                                                               <'40', $g1, 
                                                                                                $g1^~x>, 
                                                                                               <'45', '0', '1'
                                                                                               >, 
                                                                                               <'42', '0'>, 
                                                                                               '41', 
                                                                                               <~ticket, 
                                                                                                mask(~ticket_age_add,
                                                                                                     $ticket_age)
                                                                                               >, 
                                                                                               hmac(<
                                                                                                     Expand(Expand(Extract(~res_psk,
                                                                                                                           '0'),
                                                                                                                   <
                                                                                                                    'ext', 
                                                                                                                    'pbk'
                                                                                                                   >,
                                                                                                                   '32'),
                                                                                                            <
                                                                                                             '0', 
                                                                                                             '0'
                                                                                                            >,
                                                                                                            '32'), 
                                                                                                     h(<'0', 
                                                                                                        '1', 
                                                                                                        '0x0303', 
                                                                                                        ~tid, 
                                                                                                        '0', 
                                                                                                        $cipher_suites, 
                                                                                                        '0', 
                                                                                                        <
                                                                                                         '43', 
                                                                                                         '0x0304'
                                                                                                        >, 
                                                                                                        <
                                                                                                         '10', 
                                                                                                         $g1, 
                                                                                                         $g>, 
                                                                                                        <
                                                                                                         '40', 
                                                                                                         $g1, 
                                                                                                         $g1^~x
                                                                                                        >, 
                                                                                                        <
                                                                                                         '45', 
                                                                                                         '0', 
                                                                                                         '1'
                                                                                                        >, 
                                                                                                        <
                                                                                                         '42', 
                                                                                                         '0'
                                                                                                        >, 
                                                                                                        '41', 
                                                                                                        <
                                                                                                         ~ticket, 
                                                                                                         mask(~ticket_age_add,
                                                                                                              $ticket_age)
                                                                                                        >, 
                                                                                                        '0'>)
                                                                                                    >)
                                                                                              >, 
                                                                                              '6', '0x0303', 
                                                                                              '40', $g>, 
                                                                                             '1', '0x0303', 
                                                                                             ~new_nc, '0', 
                                                                                             $cipher_suites.1, 
                                                                                             '0', 
                                                                                             <'43', '0x0304'
                                                                                             >, 
                                                                                             <'10', $g1, $g>, 
                                                                                             <'40', $g, 
                                                                                              $g^~x.1>, 
                                                                                             <'45', '0', '1'
                                                                                             >, 
                                                                                             '0', '41', 
                                                                                             <~ticket, 
                                                                                              mask(~ticket_age_add,
                                                                                                   '1')
                                                                                             >, 
                                                                                             '0'>)
                                                                                         >)
                                                                                   >, 
                                                                                   '2', '0x0303', p_ns, 
                                                                                   $cipher_suite, 
                                                                                   <'13', $sig_algs>, '40', 
                                                                                   $g, p_gy>, 
                                                                                  '8', $exts>, 
                                                                                 '13', '0', 
                                                                                 $certificate_extensions>, 
                                                                                '11', '0', pk(~ltkS)>)
                                                                            >,
                                                                            ~ltkS)
                                                                      >)
                                                                   >,
                                                                   '32'),
                                                            <'fin', '0'>, '32'), 
                                                     h(<
                                                        <
                                                         <
                                                          <
                                                           <
                                                            <
                                                             <
                                                              <'0', '1', '0x0303', ~tid, '0', $cipher_suites, 
                                                               '0', <'43', '0x0304'>, <'10', $g1, $g>, 
                                                               <'40', $g1, $g1^~x>, <'45', '0', '1'>, 
                                                               <'42', '0'>, '41', 
                                                               <~ticket, mask(~ticket_age_add, $ticket_age)>, 
                                                               hmac(<
                                                                     Expand(Expand(Extract(~res_psk, '0'),
                                                                                   <'ext', 'pbk'>, '32'),
                                                                            <'0', '0'>, '32'), 
                                                                     h(<'0', '1', '0x0303', ~tid, '0', 
                                                                        $cipher_suites, '0', 
                                                                        <'43', '0x0304'>, <'10', $g1, $g>, 
                                                                        <'40', $g1, $g1^~x>, 
                                                                        <'45', '0', '1'>, <'42', '0'>, '41', 
                                                                        <~ticket, 
                                                                         mask(~ticket_age_add, $ticket_age)>, 
                                                                        '0'>)
                                                                    >)
                                                              >, 
                                                              '6', '0x0303', '40', $g>, 
                                                             '1', '0x0303', ~new_nc, '0', $cipher_suites.1, 
                                                             '0', <'43', '0x0304'>, <'10', $g1, $g>, 
                                                             <'40', $g, $g^~x.1>, <'45', '0', '1'>, '0', 
                                                             '41', <~ticket, mask(~ticket_age_add, '1')>, 
                                                             hmac(<
                                                                   Expand(Expand(Extract(~res_psk, '0'),
                                                                                 <'ext', 'pbk'>, '32'),
                                                                          <'0', '0'>, '32'), 
                                                                   h(<
                                                                      <
                                                                       <'0', '1', '0x0303', ~tid, '0', 
                                                                        $cipher_suites, '0', 
                                                                        <'43', '0x0304'>, <'10', $g1, $g>, 
                                                                        <'40', $g1, $g1^~x>, 
                                                                        <'45', '0', '1'>, <'42', '0'>, '41', 
                                                                        <~ticket, 
                                                                         mask(~ticket_age_add, $ticket_age)>, 
                                                                        hmac(<
                                                                              Expand(Expand(Extract(~res_psk,
                                                                                                    '0'),
                                                                                            <'ext', 'pbk'>,
                                                                                            '32'),
                                                                                     <'0', '0'>, '32'), 
                                                                              h(<'0', '1', '0x0303', ~tid, 
                                                                                 '0', $cipher_suites, '0', 
                                                                                 <'43', '0x0304'>, 
                                                                                 <'10', $g1, $g>, 
                                                                                 <'40', $g1, $g1^~x>, 
                                                                                 <'45', '0', '1'>, 
                                                                                 <'42', '0'>, '41', 
                                                                                 <~ticket, 
                                                                                  mask(~ticket_age_add,
                                                                                       $ticket_age)
                                                                                 >, 
                                                                                 '0'>)
                                                                             >)
                                                                       >, 
                                                                       '6', '0x0303', '40', $g>, 
                                                                      '1', '0x0303', ~new_nc, '0', 
                                                                      $cipher_suites.1, '0', 
                                                                      <'43', '0x0304'>, <'10', $g1, $g>, 
                                                                      <'40', $g, $g^~x.1>, <'45', '0', '1'>, 
                                                                      '0', '41', 
                                                                      <~ticket, mask(~ticket_age_add, '1')>, 
                                                                      '0'>)
                                                                  >)
                                                            >, 
                                                            '2', '0x0303', p_ns, $cipher_suite, 
                                                            <'13', $sig_algs>, '40', $g, p_gy>, 
                                                           '8', $exts>, 
                                                          '13', '0', $certificate_extensions>, 
                                                         '11', '0', pk(~ltkS)>, 
                                                        '15', 
                                                        sign(<'server_cv', 
                                                              h(<
                                                                 <
                                                                  <
                                                                   <
                                                                    <
                                                                     <
                                                                      <'0', '1', '0x0303', ~tid, '0', 
                                                                       $cipher_suites, '0', <'43', '0x0304'>, 
                                                                       <'10', $g1, $g>, <'40', $g1, $g1^~x>, 
                                                                       <'45', '0', '1'>, <'42', '0'>, '41', 
                                                                       <~ticket, 
                                                                        mask(~ticket_age_add, $ticket_age)>, 
                                                                       hmac(<
                                                                             Expand(Expand(Extract(~res_psk,
                                                                                                   '0'),
                                                                                           <'ext', 'pbk'>,
                                                                                           '32'),
                                                                                    <'0', '0'>, '32'), 
                                                                             h(<'0', '1', '0x0303', ~tid, 
                                                                                '0', $cipher_suites, '0', 
                                                                                <'43', '0x0304'>, 
                                                                                <'10', $g1, $g>, 
                                                                                <'40', $g1, $g1^~x>, 
                                                                                <'45', '0', '1'>, 
                                                                                <'42', '0'>, '41', 
                                                                                <~ticket, 
                                                                                 mask(~ticket_age_add,
                                                                                      $ticket_age)
                                                                                >, 
                                                                                '0'>)
                                                                            >)
                                                                      >, 
                                                                      '6', '0x0303', '40', $g>, 
                                                                     '1', '0x0303', ~new_nc, '0', 
                                                                     $cipher_suites.1, '0', <'43', '0x0304'>, 
                                                                     <'10', $g1, $g>, <'40', $g, $g^~x.1>, 
                                                                     <'45', '0', '1'>, '0', '41', 
                                                                     <~ticket, mask(~ticket_age_add, '1')>, 
                                                                     hmac(<
                                                                           Expand(Expand(Extract(~res_psk,
                                                                                                 '0'),
                                                                                         <'ext', 'pbk'>,
                                                                                         '32'),
                                                                                  <'0', '0'>, '32'), 
                                                                           h(<
                                                                              <
                                                                               <'0', '1', '0x0303', ~tid, 
                                                                                '0', $cipher_suites, '0', 
                                                                                <'43', '0x0304'>, 
                                                                                <'10', $g1, $g>, 
                                                                                <'40', $g1, $g1^~x>, 
                                                                                <'45', '0', '1'>, 
                                                                                <'42', '0'>, '41', 
                                                                                <~ticket, 
                                                                                 mask(~ticket_age_add,
                                                                                      $ticket_age)
                                                                                >, 
                                                                                hmac(<
                                                                                      Expand(Expand(Extract(~res_psk,
                                                                                                            '0'),
                                                                                                    <'ext', 
                                                                                                     'pbk'>,
                                                                                                    '32'),
                                                                                             <'0', '0'>,
                                                                                             '32'), 
                                                                                      h(<'0', '1', '0x0303', 
                                                                                         ~tid, '0', 
                                                                                         $cipher_suites, '0', 
                                                                                         <'43', '0x0304'>, 
                                                                                         <'10', $g1, $g>, 
                                                                                         <'40', $g1, $g1^~x>, 
                                                                                         <'45', '0', '1'>, 
                                                                                         <'42', '0'>, '41', 
                                                                                         <~ticket, 
                                                                                          mask(~ticket_age_add,
                                                                                               $ticket_age)
                                                                                         >, 
                                                                                         '0'>)
                                                                                     >)
                                                                               >, 
                                                                               '6', '0x0303', '40', $g>, 
                                                                              '1', '0x0303', ~new_nc, '0', 
                                                                              $cipher_suites.1, '0', 
                                                                              <'43', '0x0304'>, 
                                                                              <'10', $g1, $g>, 
                                                                              <'40', $g, $g^~x.1>, 
                                                                              <'45', '0', '1'>, '0', '41', 
                                                                              <~ticket, 
                                                                               mask(~ticket_age_add, '1')>, 
                                                                              '0'>)
                                                                          >)
                                                                    >, 
                                                                    '2', '0x0303', p_ns, $cipher_suite, 
                                                                    <'13', $sig_algs>, '40', $g, p_gy>, 
                                                                   '8', $exts>, 
                                                                  '13', '0', $certificate_extensions>, 
                                                                 '11', '0', pk(~ltkS)>)
                                                             >,
                                                             ~ltkS)
                                                       >)
                                                    >)
                                              >)
                                           >,
                                           '32'),
                                    <'adke_wk', '0'>, '32')
                  ) ▶₀ #l )
      qed
    next
      case recv_server_auth_case_08
      solve( !Ltk( $C, ~ltkC ) ▶₂ #i )
        case Register_pk
        by solve( SecretPSK( $A,
                             Expand(Expand(Extract('0',
                                                   Extract(p_gxy,
                                                           Extract(Expand(ms, <'rms', h(messages)>, '32'),
                                                                   '0'))),
                                           <'serverats', 
                                            h(<
                                               <
                                                <
                                                 <
                                                  <
                                                   <
                                                    <
                                                     <
                                                      <'0', '1', '0x0303', ~tid, '0', $cipher_suites, '0', 
                                                       <'43', '0x0304'>, <'10', $g1, $g>, 
                                                       <'40', $g1, $g1^~x>, <'45', '0', '1'>, <'42', '0'>, 
                                                       '41', <p_psk_id, mask(ticket_age_add, $ticket_age)>, 
                                                       hmac(<
                                                             Expand(Expand(Extract(Expand(ms,
                                                                                          <'rms', h(messages)
                                                                                          >,
                                                                                          '32'),
                                                                                   '0'),
                                                                           <'res', 'pbk'>, '32'),
                                                                    <'0', '0'>, '32'), 
                                                             h(<'0', '1', '0x0303', ~tid, '0', 
                                                                $cipher_suites, '0', <'43', '0x0304'>, 
                                                                <'10', $g1, $g>, <'40', $g1, $g1^~x>, 
                                                                <'45', '0', '1'>, <'42', '0'>, '41', 
                                                                <p_psk_id, mask(ticket_age_add, $ticket_age)
                                                                >, 
                                                                '0'>)
                                                            >)
                                                      >, 
                                                      '6', '0x0303', '40', $g>, 
                                                     '1', '0x0303', ~new_nc, '0', $cipher_suites.1, '0', 
                                                     <'43', '0x0304'>, <'10', $g1, $g>, <'40', $g, $g^~x.1>, 
                                                     <'45', '0', '1'>, '0', '41', 
                                                     <p_psk_id, mask(ticket_age_add, '1')>, 
                                                     hmac(<
                                                           Expand(Expand(Extract(Expand(ms,
                                                                                        <'rms', h(messages)>,
                                                                                        '32'),
                                                                                 '0'),
                                                                         <'res', 'pbk'>, '32'),
                                                                  <'0', '0'>, '32'), 
                                                           h(<
                                                              <
                                                               <'0', '1', '0x0303', ~tid, '0', 
                                                                $cipher_suites, '0', <'43', '0x0304'>, 
                                                                <'10', $g1, $g>, <'40', $g1, $g1^~x>, 
                                                                <'45', '0', '1'>, <'42', '0'>, '41', 
                                                                <p_psk_id, mask(ticket_age_add, $ticket_age)
                                                                >, 
                                                                hmac(<
                                                                      Expand(Expand(Extract(Expand(ms,
                                                                                                   <'rms', 
                                                                                                    h(messages)
                                                                                                   >,
                                                                                                   '32'),
                                                                                            '0'),
                                                                                    <'res', 'pbk'>, '32'),
                                                                             <'0', '0'>, '32'), 
                                                                      h(<'0', '1', '0x0303', ~tid, '0', 
                                                                         $cipher_suites, '0', 
                                                                         <'43', '0x0304'>, <'10', $g1, $g>, 
                                                                         <'40', $g1, $g1^~x>, 
                                                                         <'45', '0', '1'>, <'42', '0'>, '41', 
                                                                         <p_psk_id, 
                                                                          mask(ticket_age_add, $ticket_age)>, 
                                                                         '0'>)
                                                                     >)
                                                               >, 
                                                               '6', '0x0303', '40', $g>, 
                                                              '1', '0x0303', ~new_nc, '0', $cipher_suites.1, 
                                                              '0', <'43', '0x0304'>, <'10', $g1, $g>, 
                                                              <'40', $g, $g^~x.1>, <'45', '0', '1'>, '0', 
                                                              '41', <p_psk_id, mask(ticket_age_add, '1')>, '0'
                                                             >)
                                                          >)
                                                    >, 
                                                    '2', '0x0303', p_ns, $cipher_suite, <'13', $sig_algs>, 
                                                    '40', $g, p_gy>, 
                                                   '8', $exts>, 
                                                  '13', '0', $certificate_extensions>, 
                                                 '11', '0', pk(~ltkS)>, 
                                                '15', 
                                                sign(<'server_cv', 
                                                      h(<
                                                         <
                                                          <
                                                           <
                                                            <
                                                             <
                                                              <'0', '1', '0x0303', ~tid, '0', $cipher_suites, 
                                                               '0', <'43', '0x0304'>, <'10', $g1, $g>, 
                                                               <'40', $g1, $g1^~x>, <'45', '0', '1'>, 
                                                               <'42', '0'>, '41', 
                                                               <p_psk_id, mask(ticket_age_add, $ticket_age)>, 
                                                               hmac(<
                                                                     Expand(Expand(Extract(Expand(ms,
                                                                                                  <'rms', 
                                                                                                   h(messages)
                                                                                                  >,
                                                                                                  '32'),
                                                                                           '0'),
                                                                                   <'res', 'pbk'>, '32'),
                                                                            <'0', '0'>, '32'), 
                                                                     h(<'0', '1', '0x0303', ~tid, '0', 
                                                                        $cipher_suites, '0', 
                                                                        <'43', '0x0304'>, <'10', $g1, $g>, 
                                                                        <'40', $g1, $g1^~x>, 
                                                                        <'45', '0', '1'>, <'42', '0'>, '41', 
                                                                        <p_psk_id, 
                                                                         mask(ticket_age_add, $ticket_age)>, 
                                                                        '0'>)
                                                                    >)
                                                              >, 
                                                              '6', '0x0303', '40', $g>, 
                                                             '1', '0x0303', ~new_nc, '0', $cipher_suites.1, 
                                                             '0', <'43', '0x0304'>, <'10', $g1, $g>, 
                                                             <'40', $g, $g^~x.1>, <'45', '0', '1'>, '0', 
                                                             '41', <p_psk_id, mask(ticket_age_add, '1')>, 
                                                             hmac(<
                                                                   Expand(Expand(Extract(Expand(ms,
                                                                                                <'rms', 
                                                                                                 h(messages)>,
                                                                                                '32'),
                                                                                         '0'),
                                                                                 <'res', 'pbk'>, '32'),
                                                                          <'0', '0'>, '32'), 
                                                                   h(<
                                                                      <
                                                                       <'0', '1', '0x0303', ~tid, '0', 
                                                                        $cipher_suites, '0', 
                                                                        <'43', '0x0304'>, <'10', $g1, $g>, 
                                                                        <'40', $g1, $g1^~x>, 
                                                                        <'45', '0', '1'>, <'42', '0'>, '41', 
                                                                        <p_psk_id, 
                                                                         mask(ticket_age_add, $ticket_age)>, 
                                                                        hmac(<
                                                                              Expand(Expand(Extract(Expand(ms,
                                                                                                           <
                                                                                                            'rms', 
                                                                                                            h(messages)
                                                                                                           >,
                                                                                                           '32'),
                                                                                                    '0'),
                                                                                            <'res', 'pbk'>,
                                                                                            '32'),
                                                                                     <'0', '0'>, '32'), 
                                                                              h(<'0', '1', '0x0303', ~tid, 
                                                                                 '0', $cipher_suites, '0', 
                                                                                 <'43', '0x0304'>, 
                                                                                 <'10', $g1, $g>, 
                                                                                 <'40', $g1, $g1^~x>, 
                                                                                 <'45', '0', '1'>, 
                                                                                 <'42', '0'>, '41', 
                                                                                 <p_psk_id, 
                                                                                  mask(ticket_age_add,
                                                                                       $ticket_age)
                                                                                 >, 
                                                                                 '0'>)
                                                                             >)
                                                                       >, 
                                                                       '6', '0x0303', '40', $g>, 
                                                                      '1', '0x0303', ~new_nc, '0', 
                                                                      $cipher_suites.1, '0', 
                                                                      <'43', '0x0304'>, <'10', $g1, $g>, 
                                                                      <'40', $g, $g^~x.1>, <'45', '0', '1'>, 
                                                                      '0', '41', 
                                                                      <p_psk_id, mask(ticket_age_add, '1')>, 
                                                                      '0'>)
                                                                  >)
                                                            >, 
                                                            '2', '0x0303', p_ns, $cipher_suite, 
                                                            <'13', $sig_algs>, '40', $g, p_gy>, 
                                                           '8', $exts>, 
                                                          '13', '0', $certificate_extensions>, 
                                                         '11', '0', pk(~ltkS)>)
                                                     >,
                                                     ~ltkS)
                                               >, 
                                               '20', 
                                               hmac(<
                                                     Expand(Expand(Extract(p_gxy,
                                                                           Extract(Expand(ms,
                                                                                          <'rms', h(messages)
                                                                                          >,
                                                                                          '32'),
                                                                                   '0')),
                                                                   <'serverhts', 
                                                                    h(<
                                                                       <
                                                                        <
                                                                         <
                                                                          <
                                                                           <
                                                                            <
                                                                             <'0', '1', '0x0303', ~tid, '0', 
                                                                              $cipher_suites, '0', 
                                                                              <'43', '0x0304'>, 
                                                                              <'10', $g1, $g>, 
                                                                              <'40', $g1, $g1^~x>, 
                                                                              <'45', '0', '1'>, <'42', '0'>, 
                                                                              '41', 
                                                                              <p_psk_id, 
                                                                               mask(ticket_age_add,
                                                                                    $ticket_age)
                                                                              >, 
                                                                              hmac(<
                                                                                    Expand(Expand(Extract(Expand(ms,
                                                                                                                 <
                                                                                                                  'rms', 
                                                                                                                  h(messages)
                                                                                                                 >,
                                                                                                                 '32'),
                                                                                                          '0'),
                                                                                                  <'res', 
                                                                                                   'pbk'>,
                                                                                                  '32'),
                                                                                           <'0', '0'>, '32'), 
                                                                                    h(<'0', '1', '0x0303', 
                                                                                       ~tid, '0', 
                                                                                       $cipher_suites, '0', 
                                                                                       <'43', '0x0304'>, 
                                                                                       <'10', $g1, $g>, 
                                                                                       <'40', $g1, $g1^~x>, 
                                                                                       <'45', '0', '1'>, 
                                                                                       <'42', '0'>, '41', 
                                                                                       <p_psk_id, 
                                                                                        mask(ticket_age_add,
                                                                                             $ticket_age)
                                                                                       >, 
                                                                                       '0'>)
                                                                                   >)
                                                                             >, 
                                                                             '6', '0x0303', '40', $g>, 
                                                                            '1', '0x0303', ~new_nc, '0', 
                                                                            $cipher_suites.1, '0', 
                                                                            <'43', '0x0304'>, 
                                                                            <'10', $g1, $g>, 
                                                                            <'40', $g, $g^~x.1>, 
                                                                            <'45', '0', '1'>, '0', '41', 
                                                                            <p_psk_id, 
                                                                             mask(ticket_age_add, '1')>, 
                                                                            hmac(<
                                                                                  Expand(Expand(Extract(Expand(ms,
                                                                                                               <
                                                                                                                'rms', 
                                                                                                                h(messages)
                                                                                                               >,
                                                                                                               '32'),
                                                                                                        '0'),
                                                                                                <'res', 'pbk'
                                                                                                >,
                                                                                                '32'),
                                                                                         <'0', '0'>, '32'), 
                                                                                  h(<
                                                                                     <
                                                                                      <'0', '1', '0x0303', 
                                                                                       ~tid, '0', 
                                                                                       $cipher_suites, '0', 
                                                                                       <'43', '0x0304'>, 
                                                                                       <'10', $g1, $g>, 
                                                                                       <'40', $g1, $g1^~x>, 
                                                                                       <'45', '0', '1'>, 
                                                                                       <'42', '0'>, '41', 
                                                                                       <p_psk_id, 
                                                                                        mask(ticket_age_add,
                                                                                             $ticket_age)
                                                                                       >, 
                                                                                       hmac(<
                                                                                             Expand(Expand(Extract(Expand(ms,
                                                                                                                          <
                                                                                                                           'rms', 
                                                                                                                           h(messages)
                                                                                                                          >,
                                                                                                                          '32'),
                                                                                                                   '0'),
                                                                                                           <
                                                                                                            'res', 
                                                                                                            'pbk'
                                                                                                           >,
                                                                                                           '32'),
                                                                                                    <'0', '0'
                                                                                                    >,
                                                                                                    '32'), 
                                                                                             h(<'0', '1', 
                                                                                                '0x0303', 
                                                                                                ~tid, '0', 
                                                                                                $cipher_suites, 
                                                                                                '0', 
                                                                                                <'43', 
                                                                                                 '0x0304'>, 
                                                                                                <'10', $g1, $g
                                                                                                >, 
                                                                                                <'40', $g1, 
                                                                                                 $g1^~x>, 
                                                                                                <'45', '0', 
                                                                                                 '1'>, 
                                                                                                <'42', '0'>, 
                                                                                                '41', 
                                                                                                <p_psk_id, 
                                                                                                 mask(ticket_age_add,
                                                                                                      $ticket_age)
                                                                                                >, 
                                                                                                '0'>)
                                                                                            >)
                                                                                      >, 
                                                                                      '6', '0x0303', '40', $g
                                                                                     >, 
                                                                                     '1', '0x0303', ~new_nc, 
                                                                                     '0', $cipher_suites.1, 
                                                                                     '0', <'43', '0x0304'>, 
                                                                                     <'10', $g1, $g>, 
                                                                                     <'40', $g, $g^~x.1>, 
                                                                                     <'45', '0', '1'>, '0', 
                                                                                     '41', 
                                                                                     <p_psk_id, 
                                                                                      mask(ticket_age_add,
                                                                                           '1')
                                                                                     >, 
                                                                                     '0'>)
                                                                                 >)
                                                                           >, 
                                                                           '2', '0x0303', p_ns, 
                                                                           $cipher_suite, <'13', $sig_algs>, 
                                                                           '40', $g, p_gy>, 
                                                                          '8', $exts>, 
                                                                         '13', '0', $certificate_extensions>, 
                                                                        '11', '0', pk(~ltkS)>, 
                                                                       '15', 
                                                                       sign(<'server_cv', 
                                                                             h(<
                                                                                <
                                                                                 <
                                                                                  <
                                                                                   <
                                                                                    <
                                                                                     <'0', '1', '0x0303', 
                                                                                      ~tid, '0', 
                                                                                      $cipher_suites, '0', 
                                                                                      <'43', '0x0304'>, 
                                                                                      <'10', $g1, $g>, 
                                                                                      <'40', $g1, $g1^~x>, 
                                                                                      <'45', '0', '1'>, 
                                                                                      <'42', '0'>, '41', 
                                                                                      <p_psk_id, 
                                                                                       mask(ticket_age_add,
                                                                                            $ticket_age)
                                                                                      >, 
                                                                                      hmac(<
                                                                                            Expand(Expand(Extract(Expand(ms,
                                                                                                                         <
                                                                                                                          'rms', 
                                                                                                                          h(messages)
                                                                                                                         >,
                                                                                                                         '32'),
                                                                                                                  '0'),
                                                                                                          <
                                                                                                           'res', 
                                                                                                           'pbk'
                                                                                                          >,
                                                                                                          '32'),
                                                                                                   <'0', '0'>,
                                                                                                   '32'), 
                                                                                            h(<'0', '1', 
                                                                                               '0x0303', 
                                                                                               ~tid, '0', 
                                                                                               $cipher_suites, 
                                                                                               '0', 
                                                                                               <'43', '0x0304'
                                                                                               >, 
                                                                                               <'10', $g1, $g
                                                                                               >, 
                                                                                               <'40', $g1, 
                                                                                                $g1^~x>, 
                                                                                               <'45', '0', '1'
                                                                                               >, 
                                                                                               <'42', '0'>, 
                                                                                               '41', 
                                                                                               <p_psk_id, 
                                                                                                mask(ticket_age_add,
                                                                                                     $ticket_age)
                                                                                               >, 
                                                                                               '0'>)
                                                                                           >)
                                                                                     >, 
                                                                                     '6', '0x0303', '40', $g
                                                                                    >, 
                                                                                    '1', '0x0303', ~new_nc, 
                                                                                    '0', $cipher_suites.1, 
                                                                                    '0', <'43', '0x0304'>, 
                                                                                    <'10', $g1, $g>, 
                                                                                    <'40', $g, $g^~x.1>, 
                                                                                    <'45', '0', '1'>, '0', 
                                                                                    '41', 
                                                                                    <p_psk_id, 
                                                                                     mask(ticket_age_add, '1')
                                                                                    >, 
                                                                                    hmac(<
                                                                                          Expand(Expand(Extract(Expand(ms,
                                                                                                                       <
                                                                                                                        'rms', 
                                                                                                                        h(messages)
                                                                                                                       >,
                                                                                                                       '32'),
                                                                                                                '0'),
                                                                                                        <
                                                                                                         'res', 
                                                                                                         'pbk'
                                                                                                        >,
                                                                                                        '32'),
                                                                                                 <'0', '0'>,
                                                                                                 '32'), 
                                                                                          h(<
                                                                                             <
                                                                                              <'0', '1', 
                                                                                               '0x0303', 
                                                                                               ~tid, '0', 
                                                                                               $cipher_suites, 
                                                                                               '0', 
                                                                                               <'43', '0x0304'
                                                                                               >, 
                                                                                               <'10', $g1, $g
                                                                                               >, 
                                                                                               <'40', $g1, 
                                                                                                $g1^~x>, 
                                                                                               <'45', '0', '1'
                                                                                               >, 
                                                                                               <'42', '0'>, 
                                                                                               '41', 
                                                                                               <p_psk_id, 
                                                                                                mask(ticket_age_add,
                                                                                                     $ticket_age)
                                                                                               >, 
                                                                                               hmac(<
                                                                                                     Expand(Expand(Extract(Expand(ms,
                                                                                                                                  <
                                                                                                                                   'rms', 
                                                                                                                                   h(messages)
                                                                                                                                  >,
                                                                                                                                  '32'),
                                                                                                                           '0'),
                                                                                                                   <
                                                                                                                    'res', 
                                                                                                                    'pbk'
                                                                                                                   >,
                                                                                                                   '32'),
                                                                                                            <
                                                                                                             '0', 
                                                                                                             '0'
                                                                                                            >,
                                                                                                            '32'), 
                                                                                                     h(<'0', 
                                                                                                        '1', 
                                                                                                        '0x0303', 
                                                                                                        ~tid, 
                                                                                                        '0', 
                                                                                                        $cipher_suites, 
                                                                                                        '0', 
                                                                                                        <
                                                                                                         '43', 
                                                                                                         '0x0304'
                                                                                                        >, 
                                                                                                        <
                                                                                                         '10', 
                                                                                                         $g1, 
                                                                                                         $g>, 
                                                                                                        <
                                                                                                         '40', 
                                                                                                         $g1, 
                                                                                                         $g1^~x
                                                                                                        >, 
                                                                                                        <
                                                                                                         '45', 
                                                                                                         '0', 
                                                                                                         '1'
                                                                                                        >, 
                                                                                                        <
                                                                                                         '42', 
                                                                                                         '0'
                                                                                                        >, 
                                                                                                        '41', 
                                                                                                        <
                                                                                                         p_psk_id, 
                                                                                                         mask(ticket_age_add,
                                                                                                              $ticket_age)
                                                                                                        >, 
                                                                                                        '0'>)
                                                                                                    >)
                                                                                              >, 
                                                                                              '6', '0x0303', 
                                                                                              '40', $g>, 
                                                                                             '1', '0x0303', 
                                                                                             ~new_nc, '0', 
                                                                                             $cipher_suites.1, 
                                                                                             '0', 
                                                                                             <'43', '0x0304'
                                                                                             >, 
                                                                                             <'10', $g1, $g>, 
                                                                                             <'40', $g, 
                                                                                              $g^~x.1>, 
                                                                                             <'45', '0', '1'
                                                                                             >, 
                                                                                             '0', '41', 
                                                                                             <p_psk_id, 
                                                                                              mask(ticket_age_add,
                                                                                                   '1')
                                                                                             >, 
                                                                                             '0'>)
                                                                                         >)
                                                                                   >, 
                                                                                   '2', '0x0303', p_ns, 
                                                                                   $cipher_suite, 
                                                                                   <'13', $sig_algs>, '40', 
                                                                                   $g, p_gy>, 
                                                                                  '8', $exts>, 
                                                                                 '13', '0', 
                                                                                 $certificate_extensions>, 
                                                                                '11', '0', pk(~ltkS)>)
                                                                            >,
                                                                            ~ltkS)
                                                                      >)
                                                                   >,
                                                                   '32'),
                                                            <'fin', '0'>, '32'), 
                                                     h(<
                                                        <
                                                         <
                                                          <
                                                           <
                                                            <
                                                             <
                                                              <'0', '1', '0x0303', ~tid, '0', $cipher_suites, 
                                                               '0', <'43', '0x0304'>, <'10', $g1, $g>, 
                                                               <'40', $g1, $g1^~x>, <'45', '0', '1'>, 
                                                               <'42', '0'>, '41', 
                                                               <p_psk_id, mask(ticket_age_add, $ticket_age)>, 
                                                               hmac(<
                                                                     Expand(Expand(Extract(Expand(ms,
                                                                                                  <'rms', 
                                                                                                   h(messages)
                                                                                                  >,
                                                                                                  '32'),
                                                                                           '0'),
                                                                                   <'res', 'pbk'>, '32'),
                                                                            <'0', '0'>, '32'), 
                                                                     h(<'0', '1', '0x0303', ~tid, '0', 
                                                                        $cipher_suites, '0', 
                                                                        <'43', '0x0304'>, <'10', $g1, $g>, 
                                                                        <'40', $g1, $g1^~x>, 
                                                                        <'45', '0', '1'>, <'42', '0'>, '41', 
                                                                        <p_psk_id, 
                                                                         mask(ticket_age_add, $ticket_age)>, 
                                                                        '0'>)
                                                                    >)
                                                              >, 
                                                              '6', '0x0303', '40', $g>, 
                                                             '1', '0x0303', ~new_nc, '0', $cipher_suites.1, 
                                                             '0', <'43', '0x0304'>, <'10', $g1, $g>, 
                                                             <'40', $g, $g^~x.1>, <'45', '0', '1'>, '0', 
                                                             '41', <p_psk_id, mask(ticket_age_add, '1')>, 
                                                             hmac(<
                                                                   Expand(Expand(Extract(Expand(ms,
                                                                                                <'rms', 
                                                                                                 h(messages)>,
                                                                                                '32'),
                                                                                         '0'),
                                                                                 <'res', 'pbk'>, '32'),
                                                                          <'0', '0'>, '32'), 
                                                                   h(<
                                                                      <
                                                                       <'0', '1', '0x0303', ~tid, '0', 
                                                                        $cipher_suites, '0', 
                                                                        <'43', '0x0304'>, <'10', $g1, $g>, 
                                                                        <'40', $g1, $g1^~x>, 
                                                                        <'45', '0', '1'>, <'42', '0'>, '41', 
                                                                        <p_psk_id, 
                                                                         mask(ticket_age_add, $ticket_age)>, 
                                                                        hmac(<
                                                                              Expand(Expand(Extract(Expand(ms,
                                                                                                           <
                                                                                                            'rms', 
                                                                                                            h(messages)
                                                                                                           >,
                                                                                                           '32'),
                                                                                                    '0'),
                                                                                            <'res', 'pbk'>,
                                                                                            '32'),
                                                                                     <'0', '0'>, '32'), 
                                                                              h(<'0', '1', '0x0303', ~tid, 
                                                                                 '0', $cipher_suites, '0', 
                                                                                 <'43', '0x0304'>, 
                                                                                 <'10', $g1, $g>, 
                                                                                 <'40', $g1, $g1^~x>, 
                                                                                 <'45', '0', '1'>, 
                                                                                 <'42', '0'>, '41', 
                                                                                 <p_psk_id, 
                                                                                  mask(ticket_age_add,
                                                                                       $ticket_age)
                                                                                 >, 
                                                                                 '0'>)
                                                                             >)
                                                                       >, 
                                                                       '6', '0x0303', '40', $g>, 
                                                                      '1', '0x0303', ~new_nc, '0', 
                                                                      $cipher_suites.1, '0', 
                                                                      <'43', '0x0304'>, <'10', $g1, $g>, 
                                                                      <'40', $g, $g^~x.1>, <'45', '0', '1'>, 
                                                                      '0', '41', 
                                                                      <p_psk_id, mask(ticket_age_add, '1')>, 
                                                                      '0'>)
                                                                  >)
                                                            >, 
                                                            '2', '0x0303', p_ns, $cipher_suite, 
                                                            <'13', $sig_algs>, '40', $g, p_gy>, 
                                                           '8', $exts>, 
                                                          '13', '0', $certificate_extensions>, 
                                                         '11', '0', pk(~ltkS)>, 
                                                        '15', 
                                                        sign(<'server_cv', 
                                                              h(<
                                                                 <
                                                                  <
                                                                   <
                                                                    <
                                                                     <
                                                                      <'0', '1', '0x0303', ~tid, '0', 
                                                                       $cipher_suites, '0', <'43', '0x0304'>, 
                                                                       <'10', $g1, $g>, <'40', $g1, $g1^~x>, 
                                                                       <'45', '0', '1'>, <'42', '0'>, '41', 
                                                                       <p_psk_id, 
                                                                        mask(ticket_age_add, $ticket_age)>, 
                                                                       hmac(<
                                                                             Expand(Expand(Extract(Expand(ms,
                                                                                                          <
                                                                                                           'rms', 
                                                                                                           h(messages)
                                                                                                          >,
                                                                                                          '32'),
                                                                                                   '0'),
                                                                                           <'res', 'pbk'>,
                                                                                           '32'),
                                                                                    <'0', '0'>, '32'), 
                                                                             h(<'0', '1', '0x0303', ~tid, 
                                                                                '0', $cipher_suites, '0', 
                                                                                <'43', '0x0304'>, 
                                                                                <'10', $g1, $g>, 
                                                                                <'40', $g1, $g1^~x>, 
                                                                                <'45', '0', '1'>, 
                                                                                <'42', '0'>, '41', 
                                                                                <p_psk_id, 
                                                                                 mask(ticket_age_add,
                                                                                      $ticket_age)
                                                                                >, 
                                                                                '0'>)
                                                                            >)
                                                                      >, 
                                                                      '6', '0x0303', '40', $g>, 
                                                                     '1', '0x0303', ~new_nc, '0', 
                                                                     $cipher_suites.1, '0', <'43', '0x0304'>, 
                                                                     <'10', $g1, $g>, <'40', $g, $g^~x.1>, 
                                                                     <'45', '0', '1'>, '0', '41', 
                                                                     <p_psk_id, mask(ticket_age_add, '1')>, 
                                                                     hmac(<
                                                                           Expand(Expand(Extract(Expand(ms,
                                                                                                        <
                                                                                                         'rms', 
                                                                                                         h(messages)
                                                                                                        >,
                                                                                                        '32'),
                                                                                                 '0'),
                                                                                         <'res', 'pbk'>,
                                                                                         '32'),
                                                                                  <'0', '0'>, '32'), 
                                                                           h(<
                                                                              <
                                                                               <'0', '1', '0x0303', ~tid, 
                                                                                '0', $cipher_suites, '0', 
                                                                                <'43', '0x0304'>, 
                                                                                <'10', $g1, $g>, 
                                                                                <'40', $g1, $g1^~x>, 
                                                                                <'45', '0', '1'>, 
                                                                                <'42', '0'>, '41', 
                                                                                <p_psk_id, 
                                                                                 mask(ticket_age_add,
                                                                                      $ticket_age)
                                                                                >, 
                                                                                hmac(<
                                                                                      Expand(Expand(Extract(Expand(ms,
                                                                                                                   <
                                                                                                                    'rms', 
                                                                                                                    h(messages)
                                                                                                                   >,
                                                                                                                   '32'),
                                                                                                            '0'),
                                                                                                    <'res', 
                                                                                                     'pbk'>,
                                                                                                    '32'),
                                                                                             <'0', '0'>,
                                                                                             '32'), 
                                                                                      h(<'0', '1', '0x0303', 
                                                                                         ~tid, '0', 
                                                                                         $cipher_suites, '0', 
                                                                                         <'43', '0x0304'>, 
                                                                                         <'10', $g1, $g>, 
                                                                                         <'40', $g1, $g1^~x>, 
                                                                                         <'45', '0', '1'>, 
                                                                                         <'42', '0'>, '41', 
                                                                                         <p_psk_id, 
                                                                                          mask(ticket_age_add,
                                                                                               $ticket_age)
                                                                                         >, 
                                                                                         '0'>)
                                                                                     >)
                                                                               >, 
                                                                               '6', '0x0303', '40', $g>, 
                                                                              '1', '0x0303', ~new_nc, '0', 
                                                                              $cipher_suites.1, '0', 
                                                                              <'43', '0x0304'>, 
                                                                              <'10', $g1, $g>, 
                                                                              <'40', $g, $g^~x.1>, 
                                                                              <'45', '0', '1'>, '0', '41', 
                                                                              <p_psk_id, 
                                                                               mask(ticket_age_add, '1')>, 
                                                                              '0'>)
                                                                          >)
                                                                    >, 
                                                                    '2', '0x0303', p_ns, $cipher_suite, 
                                                                    <'13', $sig_algs>, '40', $g, p_gy>, 
                                                                   '8', $exts>, 
                                                                  '13', '0', $certificate_extensions>, 
                                                                 '11', '0', pk(~ltkS)>)
                                                             >,
                                                             ~ltkS)
                                                       >)
                                                    >)
                                              >)
                                           >,
                                           '32'),
                                    <'adke_wk', '0'>, '32')
                  ) ▶₀ #l )
      qed
    next
      case recv_server_auth_case_09
      by contradiction /* from formulas */
    next
      case recv_server_auth_case_10
      by contradiction /* from formulas */
    next
      case recv_server_auth_case_11
      by contradiction /* from formulas */
    next
      case recv_server_auth_case_12
      by contradiction /* from formulas */
    next
      case recv_server_auth_case_13
      by contradiction /* from formulas */
    next
      case recv_server_auth_case_14
      by contradiction /* from formulas */
    next
      case recv_server_auth_case_15
      by contradiction /* from formulas */
    next
      case recv_server_auth_case_16
      by contradiction /* from formulas */
    qed
  qed
next
  case recv_client_auth
  solve( (∃ #j. (!KU( p_cats ) @ #j) ∧ #j < #vk)  ∥
         ((∀ #k. (!KU( p_cats ) @ #k) ⇒ ¬(#k < #vk)) ∧
          (∃ actor #l.
            (RevealPSK( actor, Expand(p_cats, <'adke_wk', '0'>, '32') ) @ #l)
           ∧
            #l < #vk)) )
    case case_1
    solve( F_State_S3( ~tid, $S, $C, p_res_psk, p_messages, p_nc, p_ns, p_g,
                       p_sg, p_hrr, p_x, p_y, p_gx, p_gy, p_gxy, p_psk_ke_mode, p_psk_id, p_edi,
                       p_es, p_hs, Extract('0', p_hs), p_cats, p_sats, p_hs_keyc, p_hs_keys,
                       <pas, 'auth'>, p_ems, p_rms, '0'
           ) ▶₀ #i )
      case server_auth_psk_case_1
      solve( (∃ #j.2.
               (!KU( Extract('0',
                             Extract(p_gxy, Extract(Expand(ms, <'rms', h(messages)>, '32'), '0')))
                ) @ #j.2)
              ∧
               #j.2 < #j.1)  ∥
             ((∀ #k.
                (!KU( Extract('0',
                              Extract(p_gxy, Extract(Expand(ms, <'rms', h(messages)>, '32'), '0')))
                 ) @ #k)
               ⇒
                ¬(#k < #j.1)) ∧
              (∃ actor #l.
                (RevealPSK( actor,
                            Expand(Extract('0',
                                           Extract(p_gxy,
                                                   Extract(Expand(ms, <'rms', h(messages)>, '32'), '0'))),
                                   <'clientats', 
                                    h(<
                                       <
                                        <
                                         <'0', '1', '0x0303', p_nc, '0', $cipher_suites, '0', 
                                          <'43', '0x0304'>, <'10', $g1, $g2>, <'40', $g, p_gx>, 
                                          <'45', '0', '1'>, p_edi, '41', <~ticket, mask(x, x.1)>, 
                                          hmac(<
                                                Expand(Expand(Extract(Expand(ms, <'rms', h(messages)>, '32'),
                                                                      '0'),
                                                              <'res', 'pbk'>, '32'),
                                                       <'0', '0'>, '32'), 
                                                h(<'0', '1', '0x0303', p_nc, '0', $cipher_suites, '0', 
                                                   <'43', '0x0304'>, <'10', $g1, $g2>, <'40', $g, p_gx>, 
                                                   <'45', '0', '1'>, p_edi, '41', <~ticket, mask(x, x.1)>, '0'
                                                  >)
                                               >)
                                         >, 
                                         '2', '0x0303', ~ns, $cipher_suite, <'13', $sig_algs>, 
                                         <'40', $g, $g^~y>, <'41', '0'>, p_edi>, 
                                        '8', $exts>, 
                                       '20', 
                                       hmac(<
                                             Expand(Expand(Extract(p_gxy,
                                                                   Extract(Expand(ms, <'rms', h(messages)>,
                                                                                  '32'),
                                                                           '0')),
                                                           <'serverhts', 
                                                            h(<
                                                               <
                                                                <'0', '1', '0x0303', p_nc, '0', 
                                                                 $cipher_suites, '0', <'43', '0x0304'>, 
                                                                 <'10', $g1, $g2>, <'40', $g, p_gx>, 
                                                                 <'45', '0', '1'>, p_edi, '41', 
                                                                 <~ticket, mask(x, x.1)>, 
                                                                 hmac(<
                                                                       Expand(Expand(Extract(Expand(ms,
                                                                                                    <'rms', 
                                                                                                     h(messages)
                                                                                                    >,
                                                                                                    '32'),
                                                                                             '0'),
                                                                                     <'res', 'pbk'>, '32'),
                                                                              <'0', '0'>, '32'), 
                                                                       h(<'0', '1', '0x0303', p_nc, '0', 
                                                                          $cipher_suites, '0', 
                                                                          <'43', '0x0304'>, <'10', $g1, $g2>, 
                                                                          <'40', $g, p_gx>, <'45', '0', '1'>, 
                                                                          p_edi, '41', 
                                                                          <~ticket, mask(x, x.1)>, '0'>)
                                                                      >)
                                                                >, 
                                                                '2', '0x0303', ~ns, $cipher_suite, 
                                                                <'13', $sig_algs>, <'40', $g, $g^~y>, 
                                                                <'41', '0'>, p_edi>, 
                                                               '8', $exts>)
                                                           >,
                                                           '32'),
                                                    <'fin', '0'>, '32'), 
                                             h(<
                                                <
                                                 <'0', '1', '0x0303', p_nc, '0', $cipher_suites, '0', 
                                                  <'43', '0x0304'>, <'10', $g1, $g2>, <'40', $g, p_gx>, 
                                                  <'45', '0', '1'>, p_edi, '41', <~ticket, mask(x, x.1)>, 
                                                  hmac(<
                                                        Expand(Expand(Extract(Expand(ms, <'rms', h(messages)>,
                                                                                     '32'),
                                                                              '0'),
                                                                      <'res', 'pbk'>, '32'),
                                                               <'0', '0'>, '32'), 
                                                        h(<'0', '1', '0x0303', p_nc, '0', $cipher_suites, 
                                                           '0', <'43', '0x0304'>, <'10', $g1, $g2>, 
                                                           <'40', $g, p_gx>, <'45', '0', '1'>, p_edi, '41', 
                                                           <~ticket, mask(x, x.1)>, '0'>)
                                                       >)
                                                 >, 
                                                 '2', '0x0303', ~ns, $cipher_suite, <'13', $sig_algs>, 
                                                 <'40', $g, $g^~y>, <'41', '0'>, p_edi>, 
                                                '8', $exts>)
                                            >)
                                      >)
                                   >,
                                   '32')
                 ) @ #l)
               ∧
                #l < #j.1)) )
        case case_1
        solve( (∃ #r. (RevLtk( $C ) @ #r) ∧ #r < #i)  ∥
               (∃ tid3 x #r. (RevDHExp( tid3, $C, x ) @ #r) ∧ #r < #i)  ∥
               (∃ tid4 y #r. (RevDHExp( tid4, $S, y ) @ #r) ∧ #r < #i)  ∥
               (∃ rms #r. (RevealPSK( $S, rms ) @ #r) ∧ #r < #k.1)  ∥
               (∃ rms #r. (RevealPSK( $C, rms ) @ #r) ∧ #r < #k.1) )
          case case_1
          by contradiction /* from formulas */
        next
          case case_2
          by contradiction /* from formulas */
        next
          case case_3
          by contradiction /* from formulas */
        next
          case case_4
          solve( (∃ #r. (RevLtk( $C ) @ #r) ∧ #r < #i)  ∥
                 (∃ tid3 x #r. (RevDHExp( tid3, $C, x ) @ #r) ∧ #r < #i)  ∥
                 (∃ tid4 y #r. (RevDHExp( tid4, $S, y ) @ #r) ∧ #r < #i)  ∥
                 (∃ rms #r. (RevealPSK( $S, rms ) @ #r) ∧ #r < #i)  ∥
                 (∃ rms #r. (RevealPSK( $C, rms ) @ #r) ∧ #r < #i) )
            case case_1
            by contradiction /* from formulas */
          next
            case case_2
            by contradiction /* from formulas */
          next
            case case_3
            by contradiction /* from formulas */
          next
            case case_4
            by contradiction /* from formulas */
          next
            case case_5
            by contradiction /* from formulas */
          qed
        next
          case case_5
          solve( (∃ #r. (RevLtk( $C ) @ #r) ∧ #r < #i)  ∥
                 (∃ tid3 x #r. (RevDHExp( tid3, $C, x ) @ #r) ∧ #r < #i)  ∥
                 (∃ tid4 y #r. (RevDHExp( tid4, $S, y ) @ #r) ∧ #r < #i)  ∥
                 (∃ rms #r. (RevealPSK( $S, rms ) @ #r) ∧ #r < #i)  ∥
                 (∃ rms #r. (RevealPSK( $C, rms ) @ #r) ∧ #r < #i) )
            case case_1
            by contradiction /* from formulas */
          next
            case case_2
            by contradiction /* from formulas */
          next
            case case_3
            by contradiction /* from formulas */
          next
            case case_4
            by contradiction /* from formulas */
          next
            case case_5
            by contradiction /* from formulas */
          qed
        qed
      next
        case case_2
        by solve( SecretPSK( $A,
                             Expand(Extract('0',
                                            Extract(p_gxy,
                                                    Extract(Expand(ms, <'rms', h(messages)>, '32'), '0'))),
                                    <'clientats', 
                                     h(<
                                        <
                                         <
                                          <'0', '1', '0x0303', p_nc, '0', $cipher_suites, '0', 
                                           <'43', '0x0304'>, <'10', $g1, $g2>, <'40', $g, p_gx>, 
                                           <'45', '0', '1'>, p_edi, '41', <~ticket, mask(x, x.1)>, 
                                           hmac(<
                                                 Expand(Expand(Extract(Expand(ms, <'rms', h(messages)>, '32'),
                                                                       '0'),
                                                               <'res', 'pbk'>, '32'),
                                                        <'0', '0'>, '32'), 
                                                 h(<'0', '1', '0x0303', p_nc, '0', $cipher_suites, '0', 
                                                    <'43', '0x0304'>, <'10', $g1, $g2>, <'40', $g, p_gx>, 
                                                    <'45', '0', '1'>, p_edi, '41', <~ticket, mask(x, x.1)>, 
                                                    '0'>)
                                                >)
                                          >, 
                                          '2', '0x0303', ~ns, $cipher_suite, <'13', $sig_algs>, 
                                          <'40', $g, $g^~y>, <'41', '0'>, p_edi>, 
                                         '8', $exts>, 
                                        '20', 
                                        hmac(<
                                              Expand(Expand(Extract(p_gxy,
                                                                    Extract(Expand(ms, <'rms', h(messages)>,
                                                                                   '32'),
                                                                            '0')),
                                                            <'serverhts', 
                                                             h(<
                                                                <
                                                                 <'0', '1', '0x0303', p_nc, '0', 
                                                                  $cipher_suites, '0', <'43', '0x0304'>, 
                                                                  <'10', $g1, $g2>, <'40', $g, p_gx>, 
                                                                  <'45', '0', '1'>, p_edi, '41', 
                                                                  <~ticket, mask(x, x.1)>, 
                                                                  hmac(<
                                                                        Expand(Expand(Extract(Expand(ms,
                                                                                                     <'rms', 
                                                                                                      h(messages)
                                                                                                     >,
                                                                                                     '32'),
                                                                                              '0'),
                                                                                      <'res', 'pbk'>, '32'),
                                                                               <'0', '0'>, '32'), 
                                                                        h(<'0', '1', '0x0303', p_nc, '0', 
                                                                           $cipher_suites, '0', 
                                                                           <'43', '0x0304'>, 
                                                                           <'10', $g1, $g2>, 
                                                                           <'40', $g, p_gx>, 
                                                                           <'45', '0', '1'>, p_edi, '41', 
                                                                           <~ticket, mask(x, x.1)>, '0'>)
                                                                       >)
                                                                 >, 
                                                                 '2', '0x0303', ~ns, $cipher_suite, 
                                                                 <'13', $sig_algs>, <'40', $g, $g^~y>, 
                                                                 <'41', '0'>, p_edi>, 
                                                                '8', $exts>)
                                                            >,
                                                            '32'),
                                                     <'fin', '0'>, '32'), 
                                              h(<
                                                 <
                                                  <'0', '1', '0x0303', p_nc, '0', $cipher_suites, '0', 
                                                   <'43', '0x0304'>, <'10', $g1, $g2>, <'40', $g, p_gx>, 
                                                   <'45', '0', '1'>, p_edi, '41', <~ticket, mask(x, x.1)>, 
                                                   hmac(<
                                                         Expand(Expand(Extract(Expand(ms,
                                                                                      <'rms', h(messages)>,
                                                                                      '32'),
                                                                               '0'),
                                                                       <'res', 'pbk'>, '32'),
                                                                <'0', '0'>, '32'), 
                                                         h(<'0', '1', '0x0303', p_nc, '0', $cipher_suites, 
                                                            '0', <'43', '0x0304'>, <'10', $g1, $g2>, 
                                                            <'40', $g, p_gx>, <'45', '0', '1'>, p_edi, '41', 
                                                            <~ticket, mask(x, x.1)>, '0'>)
                                                        >)
                                                  >, 
                                                  '2', '0x0303', ~ns, $cipher_suite, <'13', $sig_algs>, 
                                                  <'40', $g, $g^~y>, <'41', '0'>, p_edi>, 
                                                 '8', $exts>)
                                             >)
                                       >)
                                    >,
                                    '32')
                  ) ▶₀ #l )
      qed
    next
      case server_auth_psk_case_2
      solve( (∃ #j.2.
               (!KU( Extract('0',
                             Extract(p_gxy, Extract(Expand(ms, <'rms', h(messages)>, '32'), '0')))
                ) @ #j.2)
              ∧
               #j.2 < #j.1)  ∥
             ((∀ #k.
                (!KU( Extract('0',
                              Extract(p_gxy, Extract(Expand(ms, <'rms', h(messages)>, '32'), '0')))
                 ) @ #k)
               ⇒
                ¬(#k < #j.1)) ∧
              (∃ actor #l.
                (RevealPSK( actor,
                            Expand(Extract('0',
                                           Extract(p_gxy,
                                                   Extract(Expand(ms, <'rms', h(messages)>, '32'), '0'))),
                                   <'clientats', 
                                    h(<
                                       <
                                        <
                                         <<p_messages, '6', '0x0303', '40', $p_sg>, '1', '0x0303', p_nc, '0', 
                                          $cipher_suites, '0', <'43', '0x0304'>, <'10', $g1, $g2>, 
                                          <'40', $g, p_gx>, <'45', '0', '1'>, p_edi, '41', 
                                          <~ticket, mask(x, x.1)>, 
                                          hmac(<
                                                Expand(Expand(Extract(Expand(ms, <'rms', h(messages)>, '32'),
                                                                      '0'),
                                                              <'res', 'pbk'>, '32'),
                                                       <'0', '0'>, '32'), 
                                                h(<<p_messages, '6', '0x0303', '40', $p_sg>, '1', '0x0303', 
                                                   p_nc, '0', $cipher_suites, '0', <'43', '0x0304'>, 
                                                   <'10', $g1, $g2>, <'40', $g, p_gx>, <'45', '0', '1'>, 
                                                   p_edi, '41', <~ticket, mask(x, x.1)>, '0'>)
                                               >)
                                         >, 
                                         '2', '0x0303', ~ns, $cipher_suite, <'13', $sig_algs>, 
                                         <'40', $g, $g^~y>, <'41', '0'>, p_edi>, 
                                        '8', $exts>, 
                                       '20', 
                                       hmac(<
                                             Expand(Expand(Extract(p_gxy,
                                                                   Extract(Expand(ms, <'rms', h(messages)>,
                                                                                  '32'),
                                                                           '0')),
                                                           <'serverhts', 
                                                            h(<
                                                               <
                                                                <<p_messages, '6', '0x0303', '40', $p_sg>, 
                                                                 '1', '0x0303', p_nc, '0', $cipher_suites, 
                                                                 '0', <'43', '0x0304'>, <'10', $g1, $g2>, 
                                                                 <'40', $g, p_gx>, <'45', '0', '1'>, p_edi, 
                                                                 '41', <~ticket, mask(x, x.1)>, 
                                                                 hmac(<
                                                                       Expand(Expand(Extract(Expand(ms,
                                                                                                    <'rms', 
                                                                                                     h(messages)
                                                                                                    >,
                                                                                                    '32'),
                                                                                             '0'),
                                                                                     <'res', 'pbk'>, '32'),
                                                                              <'0', '0'>, '32'), 
                                                                       h(<
                                                                          <p_messages, '6', '0x0303', '40', 
                                                                           $p_sg>, 
                                                                          '1', '0x0303', p_nc, '0', 
                                                                          $cipher_suites, '0', 
                                                                          <'43', '0x0304'>, <'10', $g1, $g2>, 
                                                                          <'40', $g, p_gx>, <'45', '0', '1'>, 
                                                                          p_edi, '41', 
                                                                          <~ticket, mask(x, x.1)>, '0'>)
                                                                      >)
                                                                >, 
                                                                '2', '0x0303', ~ns, $cipher_suite, 
                                                                <'13', $sig_algs>, <'40', $g, $g^~y>, 
                                                                <'41', '0'>, p_edi>, 
                                                               '8', $exts>)
                                                           >,
                                                           '32'),
                                                    <'fin', '0'>, '32'), 
                                             h(<
                                                <
                                                 <<p_messages, '6', '0x0303', '40', $p_sg>, '1', '0x0303', 
                                                  p_nc, '0', $cipher_suites, '0', <'43', '0x0304'>, 
                                                  <'10', $g1, $g2>, <'40', $g, p_gx>, <'45', '0', '1'>, 
                                                  p_edi, '41', <~ticket, mask(x, x.1)>, 
                                                  hmac(<
                                                        Expand(Expand(Extract(Expand(ms, <'rms', h(messages)>,
                                                                                     '32'),
                                                                              '0'),
                                                                      <'res', 'pbk'>, '32'),
                                                               <'0', '0'>, '32'), 
                                                        h(<<p_messages, '6', '0x0303', '40', $p_sg>, '1', 
                                                           '0x0303', p_nc, '0', $cipher_suites, '0', 
                                                           <'43', '0x0304'>, <'10', $g1, $g2>, 
                                                           <'40', $g, p_gx>, <'45', '0', '1'>, p_edi, '41', 
                                                           <~ticket, mask(x, x.1)>, '0'>)
                                                       >)
                                                 >, 
                                                 '2', '0x0303', ~ns, $cipher_suite, <'13', $sig_algs>, 
                                                 <'40', $g, $g^~y>, <'41', '0'>, p_edi>, 
                                                '8', $exts>)
                                            >)
                                      >)
                                   >,
                                   '32')
                 ) @ #l)
               ∧
                #l < #j.1)) )
        case case_1
        solve( (∃ #r. (RevLtk( $C ) @ #r) ∧ #r < #i)  ∥
               (∃ tid3 x #r. (RevDHExp( tid3, $C, x ) @ #r) ∧ #r < #i)  ∥
               (∃ tid4 y #r. (RevDHExp( tid4, $S, y ) @ #r) ∧ #r < #i)  ∥
               (∃ rms #r. (RevealPSK( $S, rms ) @ #r) ∧ #r < #k.1)  ∥
               (∃ rms #r. (RevealPSK( $C, rms ) @ #r) ∧ #r < #k.1) )
          case case_1
          by contradiction /* from formulas */
        next
          case case_2
          by contradiction /* from formulas */
        next
          case case_3
          by contradiction /* from formulas */
        next
          case case_4
          solve( (∃ #r. (RevLtk( $C ) @ #r) ∧ #r < #i)  ∥
                 (∃ tid3 x #r. (RevDHExp( tid3, $C, x ) @ #r) ∧ #r < #i)  ∥
                 (∃ tid4 y #r. (RevDHExp( tid4, $S, y ) @ #r) ∧ #r < #i)  ∥
                 (∃ rms #r. (RevealPSK( $S, rms ) @ #r) ∧ #r < #i)  ∥
                 (∃ rms #r. (RevealPSK( $C, rms ) @ #r) ∧ #r < #i) )
            case case_1
            by contradiction /* from formulas */
          next
            case case_2
            by contradiction /* from formulas */
          next
            case case_3
            by contradiction /* from formulas */
          next
            case case_4
            by contradiction /* from formulas */
          next
            case case_5
            by contradiction /* from formulas */
          qed
        next
          case case_5
          solve( (∃ #r. (RevLtk( $C ) @ #r) ∧ #r < #i)  ∥
                 (∃ tid3 x #r. (RevDHExp( tid3, $C, x ) @ #r) ∧ #r < #i)  ∥
                 (∃ tid4 y #r. (RevDHExp( tid4, $S, y ) @ #r) ∧ #r < #i)  ∥
                 (∃ rms #r. (RevealPSK( $S, rms ) @ #r) ∧ #r < #i)  ∥
                 (∃ rms #r. (RevealPSK( $C, rms ) @ #r) ∧ #r < #i) )
            case case_1
            by contradiction /* from formulas */
          next
            case case_2
            by contradiction /* from formulas */
          next
            case case_3
            by contradiction /* from formulas */
          next
            case case_4
            by contradiction /* from formulas */
          next
            case case_5
            by contradiction /* from formulas */
          qed
        qed
      next
        case case_2
        by solve( SecretPSK( $A,
                             Expand(Extract('0',
                                            Extract(p_gxy,
                                                    Extract(Expand(ms, <'rms', h(messages)>, '32'), '0'))),
                                    <'clientats', 
                                     h(<
                                        <
                                         <
                                          <<p_messages, '6', '0x0303', '40', $p_sg>, '1', '0x0303', p_nc, 
                                           '0', $cipher_suites, '0', <'43', '0x0304'>, <'10', $g1, $g2>, 
                                           <'40', $g, p_gx>, <'45', '0', '1'>, p_edi, '41', 
                                           <~ticket, mask(x, x.1)>, 
                                           hmac(<
                                                 Expand(Expand(Extract(Expand(ms, <'rms', h(messages)>, '32'),
                                                                       '0'),
                                                               <'res', 'pbk'>, '32'),
                                                        <'0', '0'>, '32'), 
                                                 h(<<p_messages, '6', '0x0303', '40', $p_sg>, '1', '0x0303', 
                                                    p_nc, '0', $cipher_suites, '0', <'43', '0x0304'>, 
                                                    <'10', $g1, $g2>, <'40', $g, p_gx>, <'45', '0', '1'>, 
                                                    p_edi, '41', <~ticket, mask(x, x.1)>, '0'>)
                                                >)
                                          >, 
                                          '2', '0x0303', ~ns, $cipher_suite, <'13', $sig_algs>, 
                                          <'40', $g, $g^~y>, <'41', '0'>, p_edi>, 
                                         '8', $exts>, 
                                        '20', 
                                        hmac(<
                                              Expand(Expand(Extract(p_gxy,
                                                                    Extract(Expand(ms, <'rms', h(messages)>,
                                                                                   '32'),
                                                                            '0')),
                                                            <'serverhts', 
                                                             h(<
                                                                <
                                                                 <<p_messages, '6', '0x0303', '40', $p_sg>, 
                                                                  '1', '0x0303', p_nc, '0', $cipher_suites, 
                                                                  '0', <'43', '0x0304'>, <'10', $g1, $g2>, 
                                                                  <'40', $g, p_gx>, <'45', '0', '1'>, p_edi, 
                                                                  '41', <~ticket, mask(x, x.1)>, 
                                                                  hmac(<
                                                                        Expand(Expand(Extract(Expand(ms,
                                                                                                     <'rms', 
                                                                                                      h(messages)
                                                                                                     >,
                                                                                                     '32'),
                                                                                              '0'),
                                                                                      <'res', 'pbk'>, '32'),
                                                                               <'0', '0'>, '32'), 
                                                                        h(<
                                                                           <p_messages, '6', '0x0303', '40', 
                                                                            $p_sg>, 
                                                                           '1', '0x0303', p_nc, '0', 
                                                                           $cipher_suites, '0', 
                                                                           <'43', '0x0304'>, 
                                                                           <'10', $g1, $g2>, 
                                                                           <'40', $g, p_gx>, 
                                                                           <'45', '0', '1'>, p_edi, '41', 
                                                                           <~ticket, mask(x, x.1)>, '0'>)
                                                                       >)
                                                                 >, 
                                                                 '2', '0x0303', ~ns, $cipher_suite, 
                                                                 <'13', $sig_algs>, <'40', $g, $g^~y>, 
                                                                 <'41', '0'>, p_edi>, 
                                                                '8', $exts>)
                                                            >,
                                                            '32'),
                                                     <'fin', '0'>, '32'), 
                                              h(<
                                                 <
                                                  <<p_messages, '6', '0x0303', '40', $p_sg>, '1', '0x0303', 
                                                   p_nc, '0', $cipher_suites, '0', <'43', '0x0304'>, 
                                                   <'10', $g1, $g2>, <'40', $g, p_gx>, <'45', '0', '1'>, 
                                                   p_edi, '41', <~ticket, mask(x, x.1)>, 
                                                   hmac(<
                                                         Expand(Expand(Extract(Expand(ms,
                                                                                      <'rms', h(messages)>,
                                                                                      '32'),
                                                                               '0'),
                                                                       <'res', 'pbk'>, '32'),
                                                                <'0', '0'>, '32'), 
                                                         h(<<p_messages, '6', '0x0303', '40', $p_sg>, '1', 
                                                            '0x0303', p_nc, '0', $cipher_suites, '0', 
                                                            <'43', '0x0304'>, <'10', $g1, $g2>, 
                                                            <'40', $g, p_gx>, <'45', '0', '1'>, p_edi, '41', 
                                                            <~ticket, mask(x, x.1)>, '0'>)
                                                        >)
                                                  >, 
                                                  '2', '0x0303', ~ns, $cipher_suite, <'13', $sig_algs>, 
                                                  <'40', $g, $g^~y>, <'41', '0'>, p_edi>, 
                                                 '8', $exts>)
                                             >)
                                       >)
                                    >,
                                    '32')
                  ) ▶₀ #l )
      qed
    next
      case server_auth_psk_case_3
      by contradiction /* from formulas */
    next
      case server_auth_psk_case_4
      by contradiction /* from formulas */
    next
      case server_auth_psk_case_5
      solve( (∃ #j.2.
               (!KU( Extract('0',
                             Extract('0', Extract(Expand(ms, <'rms', h(messages)>, '32'), '0')))
                ) @ #j.2)
              ∧
               #j.2 < #j.1)  ∥
             ((∀ #k.
                (!KU( Extract('0',
                              Extract('0', Extract(Expand(ms, <'rms', h(messages)>, '32'), '0')))
                 ) @ #k)
               ⇒
                ¬(#k < #j.1)) ∧
              (∃ actor #l.
                (RevealPSK( actor,
                            Expand(Extract('0',
                                           Extract('0',
                                                   Extract(Expand(ms, <'rms', h(messages)>, '32'), '0'))),
                                   <'clientats', 
                                    h(<
                                       <
                                        <
                                         <'0', '1', '0x0303', p_nc, '0', $cipher_suites, '0', 
                                          <'43', '0x0304'>, <'10', $g1, $g2>, <'40', $new_g, p_gx>, 
                                          <'45', '0', '1'>, p_edi, '41', <~ticket, mask(x, x.1)>, 
                                          hmac(<
                                                Expand(Expand(Extract(Expand(ms, <'rms', h(messages)>, '32'),
                                                                      '0'),
                                                              <'res', 'pbk'>, '32'),
                                                       <'0', '0'>, '32'), 
                                                h(<'0', '1', '0x0303', p_nc, '0', $cipher_suites, '0', 
                                                   <'43', '0x0304'>, <'10', $g1, $g2>, <'40', $new_g, p_gx>, 
                                                   <'45', '0', '1'>, p_edi, '41', <~ticket, mask(x, x.1)>, '0'
                                                  >)
                                               >)
                                         >, 
                                         '2', '0x0303', ~ns, $cipher_suite, <'13', $sig_algs>, <'41', '0'>, 
                                         p_edi>, 
                                        '8', $exts>, 
                                       '20', 
                                       hmac(<
                                             Expand(Expand(Extract('0',
                                                                   Extract(Expand(ms, <'rms', h(messages)>,
                                                                                  '32'),
                                                                           '0')),
                                                           <'serverhts', 
                                                            h(<
                                                               <
                                                                <'0', '1', '0x0303', p_nc, '0', 
                                                                 $cipher_suites, '0', <'43', '0x0304'>, 
                                                                 <'10', $g1, $g2>, <'40', $new_g, p_gx>, 
                                                                 <'45', '0', '1'>, p_edi, '41', 
                                                                 <~ticket, mask(x, x.1)>, 
                                                                 hmac(<
                                                                       Expand(Expand(Extract(Expand(ms,
                                                                                                    <'rms', 
                                                                                                     h(messages)
                                                                                                    >,
                                                                                                    '32'),
                                                                                             '0'),
                                                                                     <'res', 'pbk'>, '32'),
                                                                              <'0', '0'>, '32'), 
                                                                       h(<'0', '1', '0x0303', p_nc, '0', 
                                                                          $cipher_suites, '0', 
                                                                          <'43', '0x0304'>, <'10', $g1, $g2>, 
                                                                          <'40', $new_g, p_gx>, 
                                                                          <'45', '0', '1'>, p_edi, '41', 
                                                                          <~ticket, mask(x, x.1)>, '0'>)
                                                                      >)
                                                                >, 
                                                                '2', '0x0303', ~ns, $cipher_suite, 
                                                                <'13', $sig_algs>, <'41', '0'>, p_edi>, 
                                                               '8', $exts>)
                                                           >,
                                                           '32'),
                                                    <'fin', '0'>, '32'), 
                                             h(<
                                                <
                                                 <'0', '1', '0x0303', p_nc, '0', $cipher_suites, '0', 
                                                  <'43', '0x0304'>, <'10', $g1, $g2>, <'40', $new_g, p_gx>, 
                                                  <'45', '0', '1'>, p_edi, '41', <~ticket, mask(x, x.1)>, 
                                                  hmac(<
                                                        Expand(Expand(Extract(Expand(ms, <'rms', h(messages)>,
                                                                                     '32'),
                                                                              '0'),
                                                                      <'res', 'pbk'>, '32'),
                                                               <'0', '0'>, '32'), 
                                                        h(<'0', '1', '0x0303', p_nc, '0', $cipher_suites, 
                                                           '0', <'43', '0x0304'>, <'10', $g1, $g2>, 
                                                           <'40', $new_g, p_gx>, <'45', '0', '1'>, p_edi, 
                                                           '41', <~ticket, mask(x, x.1)>, '0'>)
                                                       >)
                                                 >, 
                                                 '2', '0x0303', ~ns, $cipher_suite, <'13', $sig_algs>, 
                                                 <'41', '0'>, p_edi>, 
                                                '8', $exts>)
                                            >)
                                      >)
                                   >,
                                   '32')
                 ) @ #l)
               ∧
                #l < #j.1)) )
        case case_1
        solve( (∃ #r. (RevLtk( $C ) @ #r) ∧ #r < #i)  ∥
               (∃ tid3 x #r. (RevDHExp( tid3, $C, x ) @ #r) ∧ #r < #i)  ∥
               (∃ tid4 y #r. (RevDHExp( tid4, $S, y ) @ #r) ∧ #r < #i)  ∥
               (∃ rms #r. (RevealPSK( $S, rms ) @ #r) ∧ #r < #k)  ∥
               (∃ rms #r. (RevealPSK( $C, rms ) @ #r) ∧ #r < #k) )
          case case_1
          by contradiction /* from formulas */
        next
          case case_2
          by contradiction /* from formulas */
        next
          case case_3
          by contradiction /* from formulas */
        next
          case case_4
          solve( (∃ #j.4. (!KU( ms ) @ #j.4) ∧ #j.4 < #j.3)  ∥
                 ((∀ #k. (!KU( ms ) @ #k) ⇒ ¬(#k < #j.3)) ∧
                  (∃ actor #l.
                    (RevealPSK( actor, Expand(ms, <'rms', h(messages)>, '32') ) @ #l)
                   ∧
                    #l < #j.3)) )
            case case_1
            solve( SecretPSK( $S, rms ) ▶₀ #r )
              case new_session_ticket
              solve( RMode( ~tid, $S, role, psk_ke_mode ) @ #i )
                case recv_client_auth
                by contradiction /* from formulas */
              qed
            next
              case out_of_band_psk_case_1
              solve( RMode( ~tid, $S, role, psk_ke_mode ) @ #i )
                case recv_client_auth
                by contradiction /* from formulas */
              qed
            next
              case out_of_band_psk_case_2
              solve( RMode( ~tid, $S, role, psk_ke_mode ) @ #i )
                case recv_client_auth
                by contradiction /* from formulas */
              qed
            next
              case recv_new_session_ticket
              solve( RMode( ~tid, $S, role, psk_ke_mode ) @ #i )
                case recv_client_auth
                by contradiction /* from formulas */
              qed
            qed
          next
            case case_2
            solve( SecretPSK( $S, rms ) ▶₀ #r )
              case new_session_ticket
              solve( SecretPSK( $A, Expand(ms, <'rms', h(messages)>, '32') ) ▶₀ #l )
                case new_session_ticket
                solve( RMode( ~tid, $S, role, psk_ke_mode ) @ #i )
                  case recv_client_auth
                  by contradiction /* from formulas */
                qed
              next
                case recv_new_session_ticket
                solve( RMode( ~tid, $S, role, psk_ke_mode ) @ #i )
                  case recv_client_auth
                  by contradiction /* from formulas */
                qed
              qed
            next
              case out_of_band_psk_case_1
              solve( SecretPSK( $A, Expand(ms, <'rms', h(messages)>, '32') ) ▶₀ #l )
                case new_session_ticket
                solve( RMode( ~tid, $S, role, psk_ke_mode ) @ #i )
                  case recv_client_auth
                  by contradiction /* from formulas */
                qed
              next
                case recv_new_session_ticket
                solve( RMode( ~tid, $S, role, psk_ke_mode ) @ #i )
                  case recv_client_auth
                  by contradiction /* from formulas */
                qed
              qed
            next
              case out_of_band_psk_case_2
              solve( SecretPSK( $A, Expand(ms, <'rms', h(messages)>, '32') ) ▶₀ #l )
                case new_session_ticket
                solve( RMode( ~tid, $S, role, psk_ke_mode ) @ #i )
                  case recv_client_auth
                  by contradiction /* from formulas */
                qed
              next
                case recv_new_session_ticket
                solve( RMode( ~tid, $S, role, psk_ke_mode ) @ #i )
                  case recv_client_auth
                  by contradiction /* from formulas */
                qed
              qed
            next
              case recv_new_session_ticket
              solve( SecretPSK( $A, Expand(ms, <'rms', h(messages)>, '32') ) ▶₀ #l )
                case new_session_ticket
                solve( RMode( ~tid, $S, role, psk_ke_mode ) @ #i )
                  case recv_client_auth
                  by contradiction /* from formulas */
                qed
              next
                case recv_new_session_ticket
                solve( RMode( ~tid, $S, role, psk_ke_mode ) @ #i )
                  case recv_client_auth
                  by contradiction /* from formulas */
                qed
              qed
            qed
          qed
        next
          case case_5
          solve( (∃ #j.4. (!KU( ms ) @ #j.4) ∧ #j.4 < #j.3)  ∥
                 ((∀ #k. (!KU( ms ) @ #k) ⇒ ¬(#k < #j.3)) ∧
                  (∃ actor #l.
                    (RevealPSK( actor, Expand(ms, <'rms', h(messages)>, '32') ) @ #l)
                   ∧
                    #l < #j.3)) )
            case case_1
            solve( SecretPSK( $C, rms ) ▶₀ #r )
              case new_session_ticket
              solve( RMode( ~tid, $S, role, psk_ke_mode ) @ #i )
                case recv_client_auth
                by contradiction /* from formulas */
              qed
            next
              case out_of_band_psk_case_1
              solve( RMode( ~tid, $S, role, psk_ke_mode ) @ #i )
                case recv_client_auth
                by contradiction /* from formulas */
              qed
            next
              case out_of_band_psk_case_2
              solve( RMode( ~tid, $S, role, psk_ke_mode ) @ #i )
                case recv_client_auth
                by contradiction /* from formulas */
              qed
            next
              case recv_new_session_ticket
              solve( RMode( ~tid, $S, role, psk_ke_mode ) @ #i )
                case recv_client_auth
                by contradiction /* from formulas */
              qed
            qed
          next
            case case_2
            solve( SecretPSK( $C, rms ) ▶₀ #r )
              case new_session_ticket
              solve( SecretPSK( $A, Expand(ms, <'rms', h(messages)>, '32') ) ▶₀ #l )
                case new_session_ticket
                solve( RMode( ~tid, $S, role, psk_ke_mode ) @ #i )
                  case recv_client_auth
                  by contradiction /* from formulas */
                qed
              next
                case recv_new_session_ticket
                solve( RMode( ~tid, $S, role, psk_ke_mode ) @ #i )
                  case recv_client_auth
                  by contradiction /* from formulas */
                qed
              qed
            next
              case out_of_band_psk_case_1
              solve( SecretPSK( $A, Expand(ms, <'rms', h(messages)>, '32') ) ▶₀ #l )
                case new_session_ticket
                solve( RMode( ~tid, $S, role, psk_ke_mode ) @ #i )
                  case recv_client_auth
                  by contradiction /* from formulas */
                qed
              next
                case recv_new_session_ticket
                solve( RMode( ~tid, $S, role, psk_ke_mode ) @ #i )
                  case recv_client_auth
                  by contradiction /* from formulas */
                qed
              qed
            next
              case out_of_band_psk_case_2
              solve( SecretPSK( $A, Expand(ms, <'rms', h(messages)>, '32') ) ▶₀ #l )
                case new_session_ticket
                solve( RMode( ~tid, $S, role, psk_ke_mode ) @ #i )
                  case recv_client_auth
                  by contradiction /* from formulas */
                qed
              next
                case recv_new_session_ticket
                solve( RMode( ~tid, $S, role, psk_ke_mode ) @ #i )
                  case recv_client_auth
                  by contradiction /* from formulas */
                qed
              qed
            next
              case recv_new_session_ticket
              solve( SecretPSK( $A, Expand(ms, <'rms', h(messages)>, '32') ) ▶₀ #l )
                case new_session_ticket
                solve( RMode( ~tid, $S, role, psk_ke_mode ) @ #i )
                  case recv_client_auth
                  by contradiction /* from formulas */
                qed
              next
                case recv_new_session_ticket
                solve( RMode( ~tid, $S, role, psk_ke_mode ) @ #i )
                  case recv_client_auth
                  by contradiction /* from formulas */
                qed
              qed
            qed
          qed
        qed
      next
        case case_2
        by solve( SecretPSK( $A,
                             Expand(Extract('0',
                                            Extract('0',
                                                    Extract(Expand(ms, <'rms', h(messages)>, '32'), '0'))),
                                    <'clientats', 
                                     h(<
                                        <
                                         <
                                          <'0', '1', '0x0303', p_nc, '0', $cipher_suites, '0', 
                                           <'43', '0x0304'>, <'10', $g1, $g2>, <'40', $new_g, p_gx>, 
                                           <'45', '0', '1'>, p_edi, '41', <~ticket, mask(x, x.1)>, 
                                           hmac(<
                                                 Expand(Expand(Extract(Expand(ms, <'rms', h(messages)>, '32'),
                                                                       '0'),
                                                               <'res', 'pbk'>, '32'),
                                                        <'0', '0'>, '32'), 
                                                 h(<'0', '1', '0x0303', p_nc, '0', $cipher_suites, '0', 
                                                    <'43', '0x0304'>, <'10', $g1, $g2>, <'40', $new_g, p_gx>, 
                                                    <'45', '0', '1'>, p_edi, '41', <~ticket, mask(x, x.1)>, 
                                                    '0'>)
                                                >)
                                          >, 
                                          '2', '0x0303', ~ns, $cipher_suite, <'13', $sig_algs>, <'41', '0'>, 
                                          p_edi>, 
                                         '8', $exts>, 
                                        '20', 
                                        hmac(<
                                              Expand(Expand(Extract('0',
                                                                    Extract(Expand(ms, <'rms', h(messages)>,
                                                                                   '32'),
                                                                            '0')),
                                                            <'serverhts', 
                                                             h(<
                                                                <
                                                                 <'0', '1', '0x0303', p_nc, '0', 
                                                                  $cipher_suites, '0', <'43', '0x0304'>, 
                                                                  <'10', $g1, $g2>, <'40', $new_g, p_gx>, 
                                                                  <'45', '0', '1'>, p_edi, '41', 
                                                                  <~ticket, mask(x, x.1)>, 
                                                                  hmac(<
                                                                        Expand(Expand(Extract(Expand(ms,
                                                                                                     <'rms', 
                                                                                                      h(messages)
                                                                                                     >,
                                                                                                     '32'),
                                                                                              '0'),
                                                                                      <'res', 'pbk'>, '32'),
                                                                               <'0', '0'>, '32'), 
                                                                        h(<'0', '1', '0x0303', p_nc, '0', 
                                                                           $cipher_suites, '0', 
                                                                           <'43', '0x0304'>, 
                                                                           <'10', $g1, $g2>, 
                                                                           <'40', $new_g, p_gx>, 
                                                                           <'45', '0', '1'>, p_edi, '41', 
                                                                           <~ticket, mask(x, x.1)>, '0'>)
                                                                       >)
                                                                 >, 
                                                                 '2', '0x0303', ~ns, $cipher_suite, 
                                                                 <'13', $sig_algs>, <'41', '0'>, p_edi>, 
                                                                '8', $exts>)
                                                            >,
                                                            '32'),
                                                     <'fin', '0'>, '32'), 
                                              h(<
                                                 <
                                                  <'0', '1', '0x0303', p_nc, '0', $cipher_suites, '0', 
                                                   <'43', '0x0304'>, <'10', $g1, $g2>, <'40', $new_g, p_gx>, 
                                                   <'45', '0', '1'>, p_edi, '41', <~ticket, mask(x, x.1)>, 
                                                   hmac(<
                                                         Expand(Expand(Extract(Expand(ms,
                                                                                      <'rms', h(messages)>,
                                                                                      '32'),
                                                                               '0'),
                                                                       <'res', 'pbk'>, '32'),
                                                                <'0', '0'>, '32'), 
                                                         h(<'0', '1', '0x0303', p_nc, '0', $cipher_suites, 
                                                            '0', <'43', '0x0304'>, <'10', $g1, $g2>, 
                                                            <'40', $new_g, p_gx>, <'45', '0', '1'>, p_edi, 
                                                            '41', <~ticket, mask(x, x.1)>, '0'>)
                                                        >)
                                                  >, 
                                                  '2', '0x0303', ~ns, $cipher_suite, <'13', $sig_algs>, 
                                                  <'41', '0'>, p_edi>, 
                                                 '8', $exts>)
                                             >)
                                       >)
                                    >,
                                    '32')
                  ) ▶₀ #l )
      qed
    next
      case server_auth_psk_case_6
      solve( (∃ #j.2.
               (!KU( Extract('0',
                             Extract(p_gxy, Extract(Expand(ms, <'rms', h(messages)>, '32'), '0')))
                ) @ #j.2)
              ∧
               #j.2 < #j.1)  ∥
             ((∀ #k.
                (!KU( Extract('0',
                              Extract(p_gxy, Extract(Expand(ms, <'rms', h(messages)>, '32'), '0')))
                 ) @ #k)
               ⇒
                ¬(#k < #j.1)) ∧
              (∃ actor #l.
                (RevealPSK( actor,
                            Expand(Extract('0',
                                           Extract(p_gxy,
                                                   Extract(Expand(ms, <'rms', h(messages)>, '32'), '0'))),
                                   <'clientats', 
                                    h(<
                                       <
                                        <
                                         <<p_messages, '6', '0x0303', '40', $p_sg>, '1', '0x0303', p_nc, '0', 
                                          $cipher_suites, '0', <'43', '0x0304'>, <'10', $g1, $g2>, 
                                          <'40', $new_g, p_gx>, <'45', '0', '1'>, p_edi, '41', 
                                          <~ticket, mask(x, x.1)>, 
                                          hmac(<
                                                Expand(Expand(Extract(Expand(ms, <'rms', h(messages)>, '32'),
                                                                      '0'),
                                                              <'res', 'pbk'>, '32'),
                                                       <'0', '0'>, '32'), 
                                                h(<<p_messages, '6', '0x0303', '40', $p_sg>, '1', '0x0303', 
                                                   p_nc, '0', $cipher_suites, '0', <'43', '0x0304'>, 
                                                   <'10', $g1, $g2>, <'40', $new_g, p_gx>, <'45', '0', '1'>, 
                                                   p_edi, '41', <~ticket, mask(x, x.1)>, '0'>)
                                               >)
                                         >, 
                                         '2', '0x0303', ~ns, $cipher_suite, <'13', $sig_algs>, <'41', '0'>, 
                                         p_edi>, 
                                        '8', $exts>, 
                                       '20', 
                                       hmac(<
                                             Expand(Expand(Extract(p_gxy,
                                                                   Extract(Expand(ms, <'rms', h(messages)>,
                                                                                  '32'),
                                                                           '0')),
                                                           <'serverhts', 
                                                            h(<
                                                               <
                                                                <<p_messages, '6', '0x0303', '40', $p_sg>, 
                                                                 '1', '0x0303', p_nc, '0', $cipher_suites, 
                                                                 '0', <'43', '0x0304'>, <'10', $g1, $g2>, 
                                                                 <'40', $new_g, p_gx>, <'45', '0', '1'>, 
                                                                 p_edi, '41', <~ticket, mask(x, x.1)>, 
                                                                 hmac(<
                                                                       Expand(Expand(Extract(Expand(ms,
                                                                                                    <'rms', 
                                                                                                     h(messages)
                                                                                                    >,
                                                                                                    '32'),
                                                                                             '0'),
                                                                                     <'res', 'pbk'>, '32'),
                                                                              <'0', '0'>, '32'), 
                                                                       h(<
                                                                          <p_messages, '6', '0x0303', '40', 
                                                                           $p_sg>, 
                                                                          '1', '0x0303', p_nc, '0', 
                                                                          $cipher_suites, '0', 
                                                                          <'43', '0x0304'>, <'10', $g1, $g2>, 
                                                                          <'40', $new_g, p_gx>, 
                                                                          <'45', '0', '1'>, p_edi, '41', 
                                                                          <~ticket, mask(x, x.1)>, '0'>)
                                                                      >)
                                                                >, 
                                                                '2', '0x0303', ~ns, $cipher_suite, 
                                                                <'13', $sig_algs>, <'41', '0'>, p_edi>, 
                                                               '8', $exts>)
                                                           >,
                                                           '32'),
                                                    <'fin', '0'>, '32'), 
                                             h(<
                                                <
                                                 <<p_messages, '6', '0x0303', '40', $p_sg>, '1', '0x0303', 
                                                  p_nc, '0', $cipher_suites, '0', <'43', '0x0304'>, 
                                                  <'10', $g1, $g2>, <'40', $new_g, p_gx>, <'45', '0', '1'>, 
                                                  p_edi, '41', <~ticket, mask(x, x.1)>, 
                                                  hmac(<
                                                        Expand(Expand(Extract(Expand(ms, <'rms', h(messages)>,
                                                                                     '32'),
                                                                              '0'),
                                                                      <'res', 'pbk'>, '32'),
                                                               <'0', '0'>, '32'), 
                                                        h(<<p_messages, '6', '0x0303', '40', $p_sg>, '1', 
                                                           '0x0303', p_nc, '0', $cipher_suites, '0', 
                                                           <'43', '0x0304'>, <'10', $g1, $g2>, 
                                                           <'40', $new_g, p_gx>, <'45', '0', '1'>, p_edi, 
                                                           '41', <~ticket, mask(x, x.1)>, '0'>)
                                                       >)
                                                 >, 
                                                 '2', '0x0303', ~ns, $cipher_suite, <'13', $sig_algs>, 
                                                 <'41', '0'>, p_edi>, 
                                                '8', $exts>)
                                            >)
                                      >)
                                   >,
                                   '32')
                 ) @ #l)
               ∧
                #l < #j.1)) )
        case case_1
        solve( (∃ #r. (RevLtk( $C ) @ #r) ∧ #r < #i)  ∥
               (∃ tid3 x #r. (RevDHExp( tid3, $C, x ) @ #r) ∧ #r < #i)  ∥
               (∃ tid4 y #r. (RevDHExp( tid4, $S, y ) @ #r) ∧ #r < #i)  ∥
               (∃ rms #r. (RevealPSK( $S, rms ) @ #r) ∧ #r < #k.1)  ∥
               (∃ rms #r. (RevealPSK( $C, rms ) @ #r) ∧ #r < #k.1) )
          case case_1
          by contradiction /* from formulas */
        next
          case case_2
          by contradiction /* from formulas */
        next
          case case_3
          by contradiction /* from formulas */
        next
          case case_4
          solve( (∃ #j.5. (!KU( ms ) @ #j.5) ∧ #j.5 < #j.4)  ∥
                 ((∀ #k. (!KU( ms ) @ #k) ⇒ ¬(#k < #j.4)) ∧
                  (∃ actor #l.
                    (RevealPSK( actor, Expand(ms, <'rms', h(messages)>, '32') ) @ #l)
                   ∧
                    #l < #j.4)) )
            case case_1
            solve( SecretPSK( $S, rms ) ▶₀ #r )
              case new_session_ticket
              solve( RMode( ~tid, $S, role, psk_ke_mode ) @ #i )
                case recv_client_auth
                by contradiction /* from formulas */
              qed
            next
              case out_of_band_psk_case_1
              solve( RMode( ~tid, $S, role, psk_ke_mode ) @ #i )
                case recv_client_auth
                by contradiction /* from formulas */
              qed
            next
              case out_of_band_psk_case_2
              solve( RMode( ~tid, $S, role, psk_ke_mode ) @ #i )
                case recv_client_auth
                by contradiction /* from formulas */
              qed
            next
              case recv_new_session_ticket
              solve( RMode( ~tid, $S, role, psk_ke_mode ) @ #i )
                case recv_client_auth
                by contradiction /* from formulas */
              qed
            qed
          next
            case case_2
            solve( SecretPSK( $S, rms ) ▶₀ #r )
              case new_session_ticket
              solve( SecretPSK( $A, Expand(ms, <'rms', h(messages)>, '32') ) ▶₀ #l )
                case new_session_ticket
                solve( RMode( ~tid, $S, role, psk_ke_mode ) @ #i )
                  case recv_client_auth
                  by contradiction /* from formulas */
                qed
              next
                case recv_new_session_ticket
                solve( RMode( ~tid, $S, role, psk_ke_mode ) @ #i )
                  case recv_client_auth
                  by contradiction /* from formulas */
                qed
              qed
            next
              case out_of_band_psk_case_1
              solve( SecretPSK( $A, Expand(ms, <'rms', h(messages)>, '32') ) ▶₀ #l )
                case new_session_ticket
                solve( RMode( ~tid, $S, role, psk_ke_mode ) @ #i )
                  case recv_client_auth
                  by contradiction /* from formulas */
                qed
              next
                case recv_new_session_ticket
                solve( RMode( ~tid, $S, role, psk_ke_mode ) @ #i )
                  case recv_client_auth
                  by contradiction /* from formulas */
                qed
              qed
            next
              case out_of_band_psk_case_2
              solve( SecretPSK( $A, Expand(ms, <'rms', h(messages)>, '32') ) ▶₀ #l )
                case new_session_ticket
                solve( RMode( ~tid, $S, role, psk_ke_mode ) @ #i )
                  case recv_client_auth
                  by contradiction /* from formulas */
                qed
              next
                case recv_new_session_ticket
                solve( RMode( ~tid, $S, role, psk_ke_mode ) @ #i )
                  case recv_client_auth
                  by contradiction /* from formulas */
                qed
              qed
            next
              case recv_new_session_ticket
              solve( SecretPSK( $A, Expand(ms, <'rms', h(messages)>, '32') ) ▶₀ #l )
                case new_session_ticket
                solve( RMode( ~tid, $S, role, psk_ke_mode ) @ #i )
                  case recv_client_auth
                  by contradiction /* from formulas */
                qed
              next
                case recv_new_session_ticket
                solve( RMode( ~tid, $S, role, psk_ke_mode ) @ #i )
                  case recv_client_auth
                  by contradiction /* from formulas */
                qed
              qed
            qed
          qed
        next
          case case_5
          solve( (∃ #j.5. (!KU( ms ) @ #j.5) ∧ #j.5 < #j.4)  ∥
                 ((∀ #k. (!KU( ms ) @ #k) ⇒ ¬(#k < #j.4)) ∧
                  (∃ actor #l.
                    (RevealPSK( actor, Expand(ms, <'rms', h(messages)>, '32') ) @ #l)
                   ∧
                    #l < #j.4)) )
            case case_1
            solve( SecretPSK( $C, rms ) ▶₀ #r )
              case new_session_ticket
              solve( RMode( ~tid, $S, role, psk_ke_mode ) @ #i )
                case recv_client_auth
                by contradiction /* from formulas */
              qed
            next
              case out_of_band_psk_case_1
              solve( RMode( ~tid, $S, role, psk_ke_mode ) @ #i )
                case recv_client_auth
                by contradiction /* from formulas */
              qed
            next
              case out_of_band_psk_case_2
              solve( RMode( ~tid, $S, role, psk_ke_mode ) @ #i )
                case recv_client_auth
                by contradiction /* from formulas */
              qed
            next
              case recv_new_session_ticket
              solve( RMode( ~tid, $S, role, psk_ke_mode ) @ #i )
                case recv_client_auth
                by contradiction /* from formulas */
              qed
            qed
          next
            case case_2
            solve( SecretPSK( $C, rms ) ▶₀ #r )
              case new_session_ticket
              solve( SecretPSK( $A, Expand(ms, <'rms', h(messages)>, '32') ) ▶₀ #l )
                case new_session_ticket
                solve( RMode( ~tid, $S, role, psk_ke_mode ) @ #i )
                  case recv_client_auth
                  by contradiction /* from formulas */
                qed
              next
                case recv_new_session_ticket
                solve( RMode( ~tid, $S, role, psk_ke_mode ) @ #i )
                  case recv_client_auth
                  by contradiction /* from formulas */
                qed
              qed
            next
              case out_of_band_psk_case_1
              solve( SecretPSK( $A, Expand(ms, <'rms', h(messages)>, '32') ) ▶₀ #l )
                case new_session_ticket
                solve( RMode( ~tid, $S, role, psk_ke_mode ) @ #i )
                  case recv_client_auth
                  by contradiction /* from formulas */
                qed
              next
                case recv_new_session_ticket
                solve( RMode( ~tid, $S, role, psk_ke_mode ) @ #i )
                  case recv_client_auth
                  by contradiction /* from formulas */
                qed
              qed
            next
              case out_of_band_psk_case_2
              solve( SecretPSK( $A, Expand(ms, <'rms', h(messages)>, '32') ) ▶₀ #l )
                case new_session_ticket
                solve( RMode( ~tid, $S, role, psk_ke_mode ) @ #i )
                  case recv_client_auth
                  by contradiction /* from formulas */
                qed
              next
                case recv_new_session_ticket
                solve( RMode( ~tid, $S, role, psk_ke_mode ) @ #i )
                  case recv_client_auth
                  by contradiction /* from formulas */
                qed
              qed
            next
              case recv_new_session_ticket
              solve( SecretPSK( $A, Expand(ms, <'rms', h(messages)>, '32') ) ▶₀ #l )
                case new_session_ticket
                solve( RMode( ~tid, $S, role, psk_ke_mode ) @ #i )
                  case recv_client_auth
                  by contradiction /* from formulas */
                qed
              next
                case recv_new_session_ticket
                solve( RMode( ~tid, $S, role, psk_ke_mode ) @ #i )
                  case recv_client_auth
                  by contradiction /* from formulas */
                qed
              qed
            qed
          qed
        qed
      next
        case case_2
        by solve( SecretPSK( $A,
                             Expand(Extract('0',
                                            Extract(p_gxy,
                                                    Extract(Expand(ms, <'rms', h(messages)>, '32'), '0'))),
                                    <'clientats', 
                                     h(<
                                        <
                                         <
                                          <<p_messages, '6', '0x0303', '40', $p_sg>, '1', '0x0303', p_nc, 
                                           '0', $cipher_suites, '0', <'43', '0x0304'>, <'10', $g1, $g2>, 
                                           <'40', $new_g, p_gx>, <'45', '0', '1'>, p_edi, '41', 
                                           <~ticket, mask(x, x.1)>, 
                                           hmac(<
                                                 Expand(Expand(Extract(Expand(ms, <'rms', h(messages)>, '32'),
                                                                       '0'),
                                                               <'res', 'pbk'>, '32'),
                                                        <'0', '0'>, '32'), 
                                                 h(<<p_messages, '6', '0x0303', '40', $p_sg>, '1', '0x0303', 
                                                    p_nc, '0', $cipher_suites, '0', <'43', '0x0304'>, 
                                                    <'10', $g1, $g2>, <'40', $new_g, p_gx>, <'45', '0', '1'>, 
                                                    p_edi, '41', <~ticket, mask(x, x.1)>, '0'>)
                                                >)
                                          >, 
                                          '2', '0x0303', ~ns, $cipher_suite, <'13', $sig_algs>, <'41', '0'>, 
                                          p_edi>, 
                                         '8', $exts>, 
                                        '20', 
                                        hmac(<
                                              Expand(Expand(Extract(p_gxy,
                                                                    Extract(Expand(ms, <'rms', h(messages)>,
                                                                                   '32'),
                                                                            '0')),
                                                            <'serverhts', 
                                                             h(<
                                                                <
                                                                 <<p_messages, '6', '0x0303', '40', $p_sg>, 
                                                                  '1', '0x0303', p_nc, '0', $cipher_suites, 
                                                                  '0', <'43', '0x0304'>, <'10', $g1, $g2>, 
                                                                  <'40', $new_g, p_gx>, <'45', '0', '1'>, 
                                                                  p_edi, '41', <~ticket, mask(x, x.1)>, 
                                                                  hmac(<
                                                                        Expand(Expand(Extract(Expand(ms,
                                                                                                     <'rms', 
                                                                                                      h(messages)
                                                                                                     >,
                                                                                                     '32'),
                                                                                              '0'),
                                                                                      <'res', 'pbk'>, '32'),
                                                                               <'0', '0'>, '32'), 
                                                                        h(<
                                                                           <p_messages, '6', '0x0303', '40', 
                                                                            $p_sg>, 
                                                                           '1', '0x0303', p_nc, '0', 
                                                                           $cipher_suites, '0', 
                                                                           <'43', '0x0304'>, 
                                                                           <'10', $g1, $g2>, 
                                                                           <'40', $new_g, p_gx>, 
                                                                           <'45', '0', '1'>, p_edi, '41', 
                                                                           <~ticket, mask(x, x.1)>, '0'>)
                                                                       >)
                                                                 >, 
                                                                 '2', '0x0303', ~ns, $cipher_suite, 
                                                                 <'13', $sig_algs>, <'41', '0'>, p_edi>, 
                                                                '8', $exts>)
                                                            >,
                                                            '32'),
                                                     <'fin', '0'>, '32'), 
                                              h(<
                                                 <
                                                  <<p_messages, '6', '0x0303', '40', $p_sg>, '1', '0x0303', 
                                                   p_nc, '0', $cipher_suites, '0', <'43', '0x0304'>, 
                                                   <'10', $g1, $g2>, <'40', $new_g, p_gx>, <'45', '0', '1'>, 
                                                   p_edi, '41', <~ticket, mask(x, x.1)>, 
                                                   hmac(<
                                                         Expand(Expand(Extract(Expand(ms,
                                                                                      <'rms', h(messages)>,
                                                                                      '32'),
                                                                               '0'),
                                                                       <'res', 'pbk'>, '32'),
                                                                <'0', '0'>, '32'), 
                                                         h(<<p_messages, '6', '0x0303', '40', $p_sg>, '1', 
                                                            '0x0303', p_nc, '0', $cipher_suites, '0', 
                                                            <'43', '0x0304'>, <'10', $g1, $g2>, 
                                                            <'40', $new_g, p_gx>, <'45', '0', '1'>, p_edi, 
                                                            '41', <~ticket, mask(x, x.1)>, '0'>)
                                                        >)
                                                  >, 
                                                  '2', '0x0303', ~ns, $cipher_suite, <'13', $sig_algs>, 
                                                  <'41', '0'>, p_edi>, 
                                                 '8', $exts>)
                                             >)
                                       >)
                                    >,
                                    '32')
                  ) ▶₀ #l )
      qed
    next
      case server_auth_psk_case_7
      by contradiction /* from formulas */
    next
      case server_auth_psk_case_8
      by contradiction /* from formulas */
    qed
  next
    case case_2
    solve( F_State_S3( ~tid, $S, $C, p_res_psk, p_messages, p_nc, p_ns, p_g,
                       p_sg, p_hrr, p_x, p_y, p_gx, p_gy, p_gxy, p_psk_ke_mode, p_psk_id, p_edi,
                       p_es, p_hs, Extract('0', p_hs), p_cats, p_sats, p_hs_keyc, p_hs_keys,
                       <pas, 'auth'>, p_ems, p_rms, '0'
           ) ▶₀ #i )
      case server_auth_psk_case_1
      by solve( SecretPSK( $A,
                           Expand(Expand(Extract('0',
                                                 Extract(p_gxy,
                                                         Extract(Expand(ms, <'rms', h(messages)>, '32'),
                                                                 '0'))),
                                         <'clientats', 
                                          h(<
                                             <
                                              <
                                               <'0', '1', '0x0303', p_nc, '0', $cipher_suites, '0', 
                                                <'43', '0x0304'>, <'10', $g1, $g2>, <'40', $g, p_gx>, 
                                                <'45', '0', '1'>, p_edi, '41', <~ticket, mask(x, x.1)>, 
                                                hmac(<
                                                      Expand(Expand(Extract(Expand(ms, <'rms', h(messages)>,
                                                                                   '32'),
                                                                            '0'),
                                                                    <'res', 'pbk'>, '32'),
                                                             <'0', '0'>, '32'), 
                                                      h(<'0', '1', '0x0303', p_nc, '0', $cipher_suites, '0', 
                                                         <'43', '0x0304'>, <'10', $g1, $g2>, 
                                                         <'40', $g, p_gx>, <'45', '0', '1'>, p_edi, '41', 
                                                         <~ticket, mask(x, x.1)>, '0'>)
                                                     >)
                                               >, 
                                               '2', '0x0303', ~ns, $cipher_suite, <'13', $sig_algs>, 
                                               <'40', $g, $g^~y>, <'41', '0'>, p_edi>, 
                                              '8', $exts>, 
                                             '20', 
                                             hmac(<
                                                   Expand(Expand(Extract(p_gxy,
                                                                         Extract(Expand(ms,
                                                                                        <'rms', h(messages)>,
                                                                                        '32'),
                                                                                 '0')),
                                                                 <'serverhts', 
                                                                  h(<
                                                                     <
                                                                      <'0', '1', '0x0303', p_nc, '0', 
                                                                       $cipher_suites, '0', <'43', '0x0304'>, 
                                                                       <'10', $g1, $g2>, <'40', $g, p_gx>, 
                                                                       <'45', '0', '1'>, p_edi, '41', 
                                                                       <~ticket, mask(x, x.1)>, 
                                                                       hmac(<
                                                                             Expand(Expand(Extract(Expand(ms,
                                                                                                          <
                                                                                                           'rms', 
                                                                                                           h(messages)
                                                                                                          >,
                                                                                                          '32'),
                                                                                                   '0'),
                                                                                           <'res', 'pbk'>,
                                                                                           '32'),
                                                                                    <'0', '0'>, '32'), 
                                                                             h(<'0', '1', '0x0303', p_nc, 
                                                                                '0', $cipher_suites, '0', 
                                                                                <'43', '0x0304'>, 
                                                                                <'10', $g1, $g2>, 
                                                                                <'40', $g, p_gx>, 
                                                                                <'45', '0', '1'>, p_edi, 
                                                                                '41', 
                                                                                <~ticket, mask(x, x.1)>, '0'>)
                                                                            >)
                                                                      >, 
                                                                      '2', '0x0303', ~ns, $cipher_suite, 
                                                                      <'13', $sig_algs>, <'40', $g, $g^~y>, 
                                                                      <'41', '0'>, p_edi>, 
                                                                     '8', $exts>)
                                                                 >,
                                                                 '32'),
                                                          <'fin', '0'>, '32'), 
                                                   h(<
                                                      <
                                                       <'0', '1', '0x0303', p_nc, '0', $cipher_suites, '0', 
                                                        <'43', '0x0304'>, <'10', $g1, $g2>, <'40', $g, p_gx>, 
                                                        <'45', '0', '1'>, p_edi, '41', 
                                                        <~ticket, mask(x, x.1)>, 
                                                        hmac(<
                                                              Expand(Expand(Extract(Expand(ms,
                                                                                           <'rms', h(messages)
                                                                                           >,
                                                                                           '32'),
                                                                                    '0'),
                                                                            <'res', 'pbk'>, '32'),
                                                                     <'0', '0'>, '32'), 
                                                              h(<'0', '1', '0x0303', p_nc, '0', 
                                                                 $cipher_suites, '0', <'43', '0x0304'>, 
                                                                 <'10', $g1, $g2>, <'40', $g, p_gx>, 
                                                                 <'45', '0', '1'>, p_edi, '41', 
                                                                 <~ticket, mask(x, x.1)>, '0'>)
                                                             >)
                                                       >, 
                                                       '2', '0x0303', ~ns, $cipher_suite, <'13', $sig_algs>, 
                                                       <'40', $g, $g^~y>, <'41', '0'>, p_edi>, 
                                                      '8', $exts>)
                                                  >)
                                            >)
                                         >,
                                         '32'),
                                  <'adke_wk', '0'>, '32')
                ) ▶₀ #l )
    next
      case server_auth_psk_case_2
      by solve( SecretPSK( $A,
                           Expand(Expand(Extract('0',
                                                 Extract(p_gxy,
                                                         Extract(Expand(ms, <'rms', h(messages)>, '32'),
                                                                 '0'))),
                                         <'clientats', 
                                          h(<
                                             <
                                              <
                                               <<p_messages, '6', '0x0303', '40', $p_sg>, '1', '0x0303', 
                                                p_nc, '0', $cipher_suites, '0', <'43', '0x0304'>, 
                                                <'10', $g1, $g2>, <'40', $g, p_gx>, <'45', '0', '1'>, p_edi, 
                                                '41', <~ticket, mask(x, x.1)>, 
                                                hmac(<
                                                      Expand(Expand(Extract(Expand(ms, <'rms', h(messages)>,
                                                                                   '32'),
                                                                            '0'),
                                                                    <'res', 'pbk'>, '32'),
                                                             <'0', '0'>, '32'), 
                                                      h(<<p_messages, '6', '0x0303', '40', $p_sg>, '1', 
                                                         '0x0303', p_nc, '0', $cipher_suites, '0', 
                                                         <'43', '0x0304'>, <'10', $g1, $g2>, 
                                                         <'40', $g, p_gx>, <'45', '0', '1'>, p_edi, '41', 
                                                         <~ticket, mask(x, x.1)>, '0'>)
                                                     >)
                                               >, 
                                               '2', '0x0303', ~ns, $cipher_suite, <'13', $sig_algs>, 
                                               <'40', $g, $g^~y>, <'41', '0'>, p_edi>, 
                                              '8', $exts>, 
                                             '20', 
                                             hmac(<
                                                   Expand(Expand(Extract(p_gxy,
                                                                         Extract(Expand(ms,
                                                                                        <'rms', h(messages)>,
                                                                                        '32'),
                                                                                 '0')),
                                                                 <'serverhts', 
                                                                  h(<
                                                                     <
                                                                      <
                                                                       <p_messages, '6', '0x0303', '40', $p_sg
                                                                       >, 
                                                                       '1', '0x0303', p_nc, '0', 
                                                                       $cipher_suites, '0', <'43', '0x0304'>, 
                                                                       <'10', $g1, $g2>, <'40', $g, p_gx>, 
                                                                       <'45', '0', '1'>, p_edi, '41', 
                                                                       <~ticket, mask(x, x.1)>, 
                                                                       hmac(<
                                                                             Expand(Expand(Extract(Expand(ms,
                                                                                                          <
                                                                                                           'rms', 
                                                                                                           h(messages)
                                                                                                          >,
                                                                                                          '32'),
                                                                                                   '0'),
                                                                                           <'res', 'pbk'>,
                                                                                           '32'),
                                                                                    <'0', '0'>, '32'), 
                                                                             h(<
                                                                                <p_messages, '6', '0x0303', 
                                                                                 '40', $p_sg>, 
                                                                                '1', '0x0303', p_nc, '0', 
                                                                                $cipher_suites, '0', 
                                                                                <'43', '0x0304'>, 
                                                                                <'10', $g1, $g2>, 
                                                                                <'40', $g, p_gx>, 
                                                                                <'45', '0', '1'>, p_edi, 
                                                                                '41', 
                                                                                <~ticket, mask(x, x.1)>, '0'>)
                                                                            >)
                                                                      >, 
                                                                      '2', '0x0303', ~ns, $cipher_suite, 
                                                                      <'13', $sig_algs>, <'40', $g, $g^~y>, 
                                                                      <'41', '0'>, p_edi>, 
                                                                     '8', $exts>)
                                                                 >,
                                                                 '32'),
                                                          <'fin', '0'>, '32'), 
                                                   h(<
                                                      <
                                                       <<p_messages, '6', '0x0303', '40', $p_sg>, '1', 
                                                        '0x0303', p_nc, '0', $cipher_suites, '0', 
                                                        <'43', '0x0304'>, <'10', $g1, $g2>, <'40', $g, p_gx>, 
                                                        <'45', '0', '1'>, p_edi, '41', 
                                                        <~ticket, mask(x, x.1)>, 
                                                        hmac(<
                                                              Expand(Expand(Extract(Expand(ms,
                                                                                           <'rms', h(messages)
                                                                                           >,
                                                                                           '32'),
                                                                                    '0'),
                                                                            <'res', 'pbk'>, '32'),
                                                                     <'0', '0'>, '32'), 
                                                              h(<<p_messages, '6', '0x0303', '40', $p_sg>, 
                                                                 '1', '0x0303', p_nc, '0', $cipher_suites, 
                                                                 '0', <'43', '0x0304'>, <'10', $g1, $g2>, 
                                                                 <'40', $g, p_gx>, <'45', '0', '1'>, p_edi, 
                                                                 '41', <~ticket, mask(x, x.1)>, '0'>)
                                                             >)
                                                       >, 
                                                       '2', '0x0303', ~ns, $cipher_suite, <'13', $sig_algs>, 
                                                       <'40', $g, $g^~y>, <'41', '0'>, p_edi>, 
                                                      '8', $exts>)
                                                  >)
                                            >)
                                         >,
                                         '32'),
                                  <'adke_wk', '0'>, '32')
                ) ▶₀ #l )
    next
      case server_auth_psk_case_3
      by contradiction /* from formulas */
    next
      case server_auth_psk_case_4
      by contradiction /* from formulas */
    next
      case server_auth_psk_case_5
      by solve( SecretPSK( $A,
                           Expand(Expand(Extract('0',
                                                 Extract('0',
                                                         Extract(Expand(ms, <'rms', h(messages)>, '32'),
                                                                 '0'))),
                                         <'clientats', 
                                          h(<
                                             <
                                              <
                                               <'0', '1', '0x0303', p_nc, '0', $cipher_suites, '0', 
                                                <'43', '0x0304'>, <'10', $g1, $g2>, <'40', $new_g, p_gx>, 
                                                <'45', '0', '1'>, p_edi, '41', <~ticket, mask(x, x.1)>, 
                                                hmac(<
                                                      Expand(Expand(Extract(Expand(ms, <'rms', h(messages)>,
                                                                                   '32'),
                                                                            '0'),
                                                                    <'res', 'pbk'>, '32'),
                                                             <'0', '0'>, '32'), 
                                                      h(<'0', '1', '0x0303', p_nc, '0', $cipher_suites, '0', 
                                                         <'43', '0x0304'>, <'10', $g1, $g2>, 
                                                         <'40', $new_g, p_gx>, <'45', '0', '1'>, p_edi, '41', 
                                                         <~ticket, mask(x, x.1)>, '0'>)
                                                     >)
                                               >, 
                                               '2', '0x0303', ~ns, $cipher_suite, <'13', $sig_algs>, 
                                               <'41', '0'>, p_edi>, 
                                              '8', $exts>, 
                                             '20', 
                                             hmac(<
                                                   Expand(Expand(Extract('0',
                                                                         Extract(Expand(ms,
                                                                                        <'rms', h(messages)>,
                                                                                        '32'),
                                                                                 '0')),
                                                                 <'serverhts', 
                                                                  h(<
                                                                     <
                                                                      <'0', '1', '0x0303', p_nc, '0', 
                                                                       $cipher_suites, '0', <'43', '0x0304'>, 
                                                                       <'10', $g1, $g2>, 
                                                                       <'40', $new_g, p_gx>, 
                                                                       <'45', '0', '1'>, p_edi, '41', 
                                                                       <~ticket, mask(x, x.1)>, 
                                                                       hmac(<
                                                                             Expand(Expand(Extract(Expand(ms,
                                                                                                          <
                                                                                                           'rms', 
                                                                                                           h(messages)
                                                                                                          >,
                                                                                                          '32'),
                                                                                                   '0'),
                                                                                           <'res', 'pbk'>,
                                                                                           '32'),
                                                                                    <'0', '0'>, '32'), 
                                                                             h(<'0', '1', '0x0303', p_nc, 
                                                                                '0', $cipher_suites, '0', 
                                                                                <'43', '0x0304'>, 
                                                                                <'10', $g1, $g2>, 
                                                                                <'40', $new_g, p_gx>, 
                                                                                <'45', '0', '1'>, p_edi, 
                                                                                '41', 
                                                                                <~ticket, mask(x, x.1)>, '0'>)
                                                                            >)
                                                                      >, 
                                                                      '2', '0x0303', ~ns, $cipher_suite, 
                                                                      <'13', $sig_algs>, <'41', '0'>, p_edi>, 
                                                                     '8', $exts>)
                                                                 >,
                                                                 '32'),
                                                          <'fin', '0'>, '32'), 
                                                   h(<
                                                      <
                                                       <'0', '1', '0x0303', p_nc, '0', $cipher_suites, '0', 
                                                        <'43', '0x0304'>, <'10', $g1, $g2>, 
                                                        <'40', $new_g, p_gx>, <'45', '0', '1'>, p_edi, '41', 
                                                        <~ticket, mask(x, x.1)>, 
                                                        hmac(<
                                                              Expand(Expand(Extract(Expand(ms,
                                                                                           <'rms', h(messages)
                                                                                           >,
                                                                                           '32'),
                                                                                    '0'),
                                                                            <'res', 'pbk'>, '32'),
                                                                     <'0', '0'>, '32'), 
                                                              h(<'0', '1', '0x0303', p_nc, '0', 
                                                                 $cipher_suites, '0', <'43', '0x0304'>, 
                                                                 <'10', $g1, $g2>, <'40', $new_g, p_gx>, 
                                                                 <'45', '0', '1'>, p_edi, '41', 
                                                                 <~ticket, mask(x, x.1)>, '0'>)
                                                             >)
                                                       >, 
                                                       '2', '0x0303', ~ns, $cipher_suite, <'13', $sig_algs>, 
                                                       <'41', '0'>, p_edi>, 
                                                      '8', $exts>)
                                                  >)
                                            >)
                                         >,
                                         '32'),
                                  <'adke_wk', '0'>, '32')
                ) ▶₀ #l )
    next
      case server_auth_psk_case_6
      by solve( SecretPSK( $A,
                           Expand(Expand(Extract('0',
                                                 Extract(p_gxy,
                                                         Extract(Expand(ms, <'rms', h(messages)>, '32'),
                                                                 '0'))),
                                         <'clientats', 
                                          h(<
                                             <
                                              <
                                               <<p_messages, '6', '0x0303', '40', $p_sg>, '1', '0x0303', 
                                                p_nc, '0', $cipher_suites, '0', <'43', '0x0304'>, 
                                                <'10', $g1, $g2>, <'40', $new_g, p_gx>, <'45', '0', '1'>, 
                                                p_edi, '41', <~ticket, mask(x, x.1)>, 
                                                hmac(<
                                                      Expand(Expand(Extract(Expand(ms, <'rms', h(messages)>,
                                                                                   '32'),
                                                                            '0'),
                                                                    <'res', 'pbk'>, '32'),
                                                             <'0', '0'>, '32'), 
                                                      h(<<p_messages, '6', '0x0303', '40', $p_sg>, '1', 
                                                         '0x0303', p_nc, '0', $cipher_suites, '0', 
                                                         <'43', '0x0304'>, <'10', $g1, $g2>, 
                                                         <'40', $new_g, p_gx>, <'45', '0', '1'>, p_edi, '41', 
                                                         <~ticket, mask(x, x.1)>, '0'>)
                                                     >)
                                               >, 
                                               '2', '0x0303', ~ns, $cipher_suite, <'13', $sig_algs>, 
                                               <'41', '0'>, p_edi>, 
                                              '8', $exts>, 
                                             '20', 
                                             hmac(<
                                                   Expand(Expand(Extract(p_gxy,
                                                                         Extract(Expand(ms,
                                                                                        <'rms', h(messages)>,
                                                                                        '32'),
                                                                                 '0')),
                                                                 <'serverhts', 
                                                                  h(<
                                                                     <
                                                                      <
                                                                       <p_messages, '6', '0x0303', '40', $p_sg
                                                                       >, 
                                                                       '1', '0x0303', p_nc, '0', 
                                                                       $cipher_suites, '0', <'43', '0x0304'>, 
                                                                       <'10', $g1, $g2>, 
                                                                       <'40', $new_g, p_gx>, 
                                                                       <'45', '0', '1'>, p_edi, '41', 
                                                                       <~ticket, mask(x, x.1)>, 
                                                                       hmac(<
                                                                             Expand(Expand(Extract(Expand(ms,
                                                                                                          <
                                                                                                           'rms', 
                                                                                                           h(messages)
                                                                                                          >,
                                                                                                          '32'),
                                                                                                   '0'),
                                                                                           <'res', 'pbk'>,
                                                                                           '32'),
                                                                                    <'0', '0'>, '32'), 
                                                                             h(<
                                                                                <p_messages, '6', '0x0303', 
                                                                                 '40', $p_sg>, 
                                                                                '1', '0x0303', p_nc, '0', 
                                                                                $cipher_suites, '0', 
                                                                                <'43', '0x0304'>, 
                                                                                <'10', $g1, $g2>, 
                                                                                <'40', $new_g, p_gx>, 
                                                                                <'45', '0', '1'>, p_edi, 
                                                                                '41', 
                                                                                <~ticket, mask(x, x.1)>, '0'>)
                                                                            >)
                                                                      >, 
                                                                      '2', '0x0303', ~ns, $cipher_suite, 
                                                                      <'13', $sig_algs>, <'41', '0'>, p_edi>, 
                                                                     '8', $exts>)
                                                                 >,
                                                                 '32'),
                                                          <'fin', '0'>, '32'), 
                                                   h(<
                                                      <
                                                       <<p_messages, '6', '0x0303', '40', $p_sg>, '1', 
                                                        '0x0303', p_nc, '0', $cipher_suites, '0', 
                                                        <'43', '0x0304'>, <'10', $g1, $g2>, 
                                                        <'40', $new_g, p_gx>, <'45', '0', '1'>, p_edi, '41', 
                                                        <~ticket, mask(x, x.1)>, 
                                                        hmac(<
                                                              Expand(Expand(Extract(Expand(ms,
                                                                                           <'rms', h(messages)
                                                                                           >,
                                                                                           '32'),
                                                                                    '0'),
                                                                            <'res', 'pbk'>, '32'),
                                                                     <'0', '0'>, '32'), 
                                                              h(<<p_messages, '6', '0x0303', '40', $p_sg>, 
                                                                 '1', '0x0303', p_nc, '0', $cipher_suites, 
                                                                 '0', <'43', '0x0304'>, <'10', $g1, $g2>, 
                                                                 <'40', $new_g, p_gx>, <'45', '0', '1'>, 
                                                                 p_edi, '41', <~ticket, mask(x, x.1)>, '0'>)
                                                             >)
                                                       >, 
                                                       '2', '0x0303', ~ns, $cipher_suite, <'13', $sig_algs>, 
                                                       <'41', '0'>, p_edi>, 
                                                      '8', $exts>)
                                                  >)
                                            >)
                                         >,
                                         '32'),
                                  <'adke_wk', '0'>, '32')
                ) ▶₀ #l )
    next
      case server_auth_psk_case_7
      by contradiction /* from formulas */
    next
      case server_auth_psk_case_8
      by contradiction /* from formulas */
    qed
  qed
next
  case recv_client_auth_cert
  solve( (∃ #j. (!KU( p_cats ) @ #j) ∧ #j < #vk)  ∥
         ((∀ #k. (!KU( p_cats ) @ #k) ⇒ ¬(#k < #vk)) ∧
          (∃ actor #l.
            (RevealPSK( actor, Expand(p_cats, <'adke_wk', '0'>, '32') ) @ #l)
           ∧
            #l < #vk)) )
    case case_1
    solve( F_State_S3( ~tid, $S, $C, p_res_psk, p_messages, p_nc, p_ns, p_g,
                       p_sg, p_hrr, p_x, p_y, p_gx, p_gy, p_gxy, p_psk_ke_mode, p_psk_id, p_edi,
                       p_es, p_hs, Extract('0', p_hs), p_cats, p_sats, p_hs_keyc, p_hs_keys,
                       p_auth_status, p_ems, p_rms, '1'
           ) ▶₀ #i )
      case server_auth_case_01
      solve( (∃ #j.2.
               (!KU( Extract('0', Extract(p_gxy, Extract('0', '0'))) ) @ #j.2)
              ∧
               #j.2 < #j.1)  ∥
             ((∀ #k.
                (!KU( Extract('0', Extract(p_gxy, Extract('0', '0'))) ) @ #k)
               ⇒
                ¬(#k < #j.1)) ∧
              (∃ actor #l.
                (RevealPSK( actor,
                            Expand(Extract('0', Extract(p_gxy, Extract('0', '0'))),
                                   <'clientats', 
                                    h(<
                                       <
                                        <
                                         <
                                          <
                                           <
                                            <'0', '1', '0x0303', p_nc, '0', $cipher_suites, '0', 
                                             <'43', '0x0304'>, <'10', $g1, $g2>, <'13', $sig_algs>, '40', 
                                             $p_g, p_gx>, 
                                            '2', '0x0303', ~new_ns, $cipher_suite, <'13', $sig_algs.1>, '40', 
                                            $p_g, $p_g^~y>, 
                                           '8', $exts>, 
                                          '13', '0', $certificate_extensions>, 
                                         '11', '0', pk(~ltkS)>, 
                                        '15', 
                                        sign(<'server_cv', 
                                              h(<
                                                 <
                                                  <
                                                   <
                                                    <'0', '1', '0x0303', p_nc, '0', $cipher_suites, '0', 
                                                     <'43', '0x0304'>, <'10', $g1, $g2>, <'13', $sig_algs>, 
                                                     '40', $p_g, p_gx>, 
                                                    '2', '0x0303', ~new_ns, $cipher_suite, 
                                                    <'13', $sig_algs.1>, '40', $p_g, $p_g^~y>, 
                                                   '8', $exts>, 
                                                  '13', '0', $certificate_extensions>, 
                                                 '11', '0', pk(~ltkS)>)
                                             >,
                                             ~ltkS)
                                       >, 
                                       '20', 
                                       hmac(<
                                             Expand(Expand(Extract(p_gxy, Extract('0', '0')),
                                                           <'serverhts', 
                                                            h(<
                                                               <
                                                                <
                                                                 <
                                                                  <
                                                                   <'0', '1', '0x0303', p_nc, '0', 
                                                                    $cipher_suites, '0', <'43', '0x0304'>, 
                                                                    <'10', $g1, $g2>, <'13', $sig_algs>, 
                                                                    '40', $p_g, p_gx>, 
                                                                   '2', '0x0303', ~new_ns, $cipher_suite, 
                                                                   <'13', $sig_algs.1>, '40', $p_g, $p_g^~y>, 
                                                                  '8', $exts>, 
                                                                 '13', '0', $certificate_extensions>, 
                                                                '11', '0', pk(~ltkS)>, 
                                                               '15', 
                                                               sign(<'server_cv', 
                                                                     h(<
                                                                        <
                                                                         <
                                                                          <
                                                                           <'0', '1', '0x0303', p_nc, '0', 
                                                                            $cipher_suites, '0', 
                                                                            <'43', '0x0304'>, 
                                                                            <'10', $g1, $g2>, 
                                                                            <'13', $sig_algs>, '40', $p_g, 
                                                                            p_gx>, 
                                                                           '2', '0x0303', ~new_ns, 
                                                                           $cipher_suite, 
                                                                           <'13', $sig_algs.1>, '40', $p_g, 
                                                                           $p_g^~y>, 
                                                                          '8', $exts>, 
                                                                         '13', '0', $certificate_extensions>, 
                                                                        '11', '0', pk(~ltkS)>)
                                                                    >,
                                                                    ~ltkS)
                                                              >)
                                                           >,
                                                           '32'),
                                                    <'fin', '0'>, '32'), 
                                             h(<
                                                <
                                                 <
                                                  <
                                                   <
                                                    <'0', '1', '0x0303', p_nc, '0', $cipher_suites, '0', 
                                                     <'43', '0x0304'>, <'10', $g1, $g2>, <'13', $sig_algs>, 
                                                     '40', $p_g, p_gx>, 
                                                    '2', '0x0303', ~new_ns, $cipher_suite, 
                                                    <'13', $sig_algs.1>, '40', $p_g, $p_g^~y>, 
                                                   '8', $exts>, 
                                                  '13', '0', $certificate_extensions>, 
                                                 '11', '0', pk(~ltkS)>, 
                                                '15', 
                                                sign(<'server_cv', 
                                                      h(<
                                                         <
                                                          <
                                                           <
                                                            <'0', '1', '0x0303', p_nc, '0', $cipher_suites, 
                                                             '0', <'43', '0x0304'>, <'10', $g1, $g2>, 
                                                             <'13', $sig_algs>, '40', $p_g, p_gx>, 
                                                            '2', '0x0303', ~new_ns, $cipher_suite, 
                                                            <'13', $sig_algs.1>, '40', $p_g, $p_g^~y>, 
                                                           '8', $exts>, 
                                                          '13', '0', $certificate_extensions>, 
                                                         '11', '0', pk(~ltkS)>)
                                                     >,
                                                     ~ltkS)
                                               >)
                                            >)
                                      >)
                                   >,
                                   '32')
                 ) @ #l)
               ∧
                #l < #j.1)) )
        case case_1
        solve( (∃ #r. (RevLtk( $C ) @ #r) ∧ #r < #i)  ∥
               (∃ tid3 x #r. (RevDHExp( tid3, $C, x ) @ #r) ∧ #r < #i)  ∥
               (∃ tid4 y #r. (RevDHExp( tid4, $S, y ) @ #r) ∧ #r < #i)  ∥
               (∃ rms #r. (RevealPSK( $S, rms ) @ #r) ∧ #r < #k.1)  ∥
               (∃ rms #r. (RevealPSK( $C, rms ) @ #r) ∧ #r < #k.1) )
          case case_1
          by contradiction /* from formulas */
        next
          case case_2
          by contradiction /* from formulas */
        next
          case case_3
          by contradiction /* from formulas */
        next
          case case_4
          solve( (∃ #r. (RevLtk( $C ) @ #r) ∧ #r < #i)  ∥
                 (∃ tid3 x #r. (RevDHExp( tid3, $C, x ) @ #r) ∧ #r < #i)  ∥
                 (∃ tid4 y #r. (RevDHExp( tid4, $S, y ) @ #r) ∧ #r < #i)  ∥
                 (∃ rms #r. (RevealPSK( $S, rms ) @ #r) ∧ #r < #i)  ∥
                 (∃ rms #r. (RevealPSK( $C, rms ) @ #r) ∧ #r < #i) )
            case case_1
            by contradiction /* from formulas */
          next
            case case_2
            by contradiction /* from formulas */
          next
            case case_3
            by contradiction /* from formulas */
          next
            case case_4
            by contradiction /* from formulas */
          next
            case case_5
            by contradiction /* from formulas */
          qed
        next
          case case_5
          solve( (∃ #r. (RevLtk( $C ) @ #r) ∧ #r < #i)  ∥
                 (∃ tid3 x #r. (RevDHExp( tid3, $C, x ) @ #r) ∧ #r < #i)  ∥
                 (∃ tid4 y #r. (RevDHExp( tid4, $S, y ) @ #r) ∧ #r < #i)  ∥
                 (∃ rms #r. (RevealPSK( $S, rms ) @ #r) ∧ #r < #i)  ∥
                 (∃ rms #r. (RevealPSK( $C, rms ) @ #r) ∧ #r < #i) )
            case case_1
            by contradiction /* from formulas */
          next
            case case_2
            by contradiction /* from formulas */
          next
            case case_3
            by contradiction /* from formulas */
          next
            case case_4
            by contradiction /* from formulas */
          next
            case case_5
            by contradiction /* from formulas */
          qed
        qed
      next
        case case_2
        solve( !Pk( $C, pk(~ltkC) ) ▶₁ #i )
          case Register_pk
          by solve( SecretPSK( $A,
                               Expand(Extract('0', Extract(p_gxy, Extract('0', '0'))),
                                      <'clientats', 
                                       h(<
                                          <
                                           <
                                            <
                                             <
                                              <
                                               <'0', '1', '0x0303', p_nc, '0', $cipher_suites, '0', 
                                                <'43', '0x0304'>, <'10', $g1, $g2>, <'13', $sig_algs>, '40', 
                                                $p_g, p_gx>, 
                                               '2', '0x0303', ~new_ns, $cipher_suite, <'13', $sig_algs.1>, 
                                               '40', $p_g, $p_g^~y>, 
                                              '8', $exts>, 
                                             '13', '0', $certificate_extensions>, 
                                            '11', '0', pk(~ltkS)>, 
                                           '15', 
                                           sign(<'server_cv', 
                                                 h(<
                                                    <
                                                     <
                                                      <
                                                       <'0', '1', '0x0303', p_nc, '0', $cipher_suites, '0', 
                                                        <'43', '0x0304'>, <'10', $g1, $g2>, 
                                                        <'13', $sig_algs>, '40', $p_g, p_gx>, 
                                                       '2', '0x0303', ~new_ns, $cipher_suite, 
                                                       <'13', $sig_algs.1>, '40', $p_g, $p_g^~y>, 
                                                      '8', $exts>, 
                                                     '13', '0', $certificate_extensions>, 
                                                    '11', '0', pk(~ltkS)>)
                                                >,
                                                ~ltkS)
                                          >, 
                                          '20', 
                                          hmac(<
                                                Expand(Expand(Extract(p_gxy, Extract('0', '0')),
                                                              <'serverhts', 
                                                               h(<
                                                                  <
                                                                   <
                                                                    <
                                                                     <
                                                                      <'0', '1', '0x0303', p_nc, '0', 
                                                                       $cipher_suites, '0', <'43', '0x0304'>, 
                                                                       <'10', $g1, $g2>, <'13', $sig_algs>, 
                                                                       '40', $p_g, p_gx>, 
                                                                      '2', '0x0303', ~new_ns, $cipher_suite, 
                                                                      <'13', $sig_algs.1>, '40', $p_g, $p_g^~y
                                                                     >, 
                                                                     '8', $exts>, 
                                                                    '13', '0', $certificate_extensions>, 
                                                                   '11', '0', pk(~ltkS)>, 
                                                                  '15', 
                                                                  sign(<'server_cv', 
                                                                        h(<
                                                                           <
                                                                            <
                                                                             <
                                                                              <'0', '1', '0x0303', p_nc, '0', 
                                                                               $cipher_suites, '0', 
                                                                               <'43', '0x0304'>, 
                                                                               <'10', $g1, $g2>, 
                                                                               <'13', $sig_algs>, '40', $p_g, 
                                                                               p_gx>, 
                                                                              '2', '0x0303', ~new_ns, 
                                                                              $cipher_suite, 
                                                                              <'13', $sig_algs.1>, '40', 
                                                                              $p_g, $p_g^~y>, 
                                                                             '8', $exts>, 
                                                                            '13', '0', $certificate_extensions
                                                                           >, 
                                                                           '11', '0', pk(~ltkS)>)
                                                                       >,
                                                                       ~ltkS)
                                                                 >)
                                                              >,
                                                              '32'),
                                                       <'fin', '0'>, '32'), 
                                                h(<
                                                   <
                                                    <
                                                     <
                                                      <
                                                       <'0', '1', '0x0303', p_nc, '0', $cipher_suites, '0', 
                                                        <'43', '0x0304'>, <'10', $g1, $g2>, 
                                                        <'13', $sig_algs>, '40', $p_g, p_gx>, 
                                                       '2', '0x0303', ~new_ns, $cipher_suite, 
                                                       <'13', $sig_algs.1>, '40', $p_g, $p_g^~y>, 
                                                      '8', $exts>, 
                                                     '13', '0', $certificate_extensions>, 
                                                    '11', '0', pk(~ltkS)>, 
                                                   '15', 
                                                   sign(<'server_cv', 
                                                         h(<
                                                            <
                                                             <
                                                              <
                                                               <'0', '1', '0x0303', p_nc, '0', 
                                                                $cipher_suites, '0', <'43', '0x0304'>, 
                                                                <'10', $g1, $g2>, <'13', $sig_algs>, '40', 
                                                                $p_g, p_gx>, 
                                                               '2', '0x0303', ~new_ns, $cipher_suite, 
                                                               <'13', $sig_algs.1>, '40', $p_g, $p_g^~y>, 
                                                              '8', $exts>, 
                                                             '13', '0', $certificate_extensions>, 
                                                            '11', '0', pk(~ltkS)>)
                                                        >,
                                                        ~ltkS)
                                                  >)
                                               >)
                                         >)
                                      >,
                                      '32')
                    ) ▶₀ #l )
        qed
      qed
    next
      case server_auth_case_02
      solve( (∃ #j.2.
               (!KU( Extract('0', Extract(p_gxy, Extract(p_res_psk, '0'))) ) @ #j.2)
              ∧
               #j.2 < #j.1)  ∥
             ((∀ #k.
                (!KU( Extract('0', Extract(p_gxy, Extract(p_res_psk, '0'))) ) @ #k)
               ⇒
                ¬(#k < #j.1)) ∧
              (∃ actor #l.
                (RevealPSK( actor,
                            Expand(Extract('0', Extract(p_gxy, Extract(p_res_psk, '0'))),
                                   <'clientats', 
                                    h(<
                                       <
                                        <
                                         <
                                          <
                                           <
                                            <<p_messages, '6', '0x0303', '40', $p_g>, '1', '0x0303', p_nc, 
                                             '0', $cipher_suites, '0', <'43', '0x0304'>, <'10', $g1, $g2>, 
                                             <'13', $sig_algs>, '40', $p_g, p_gx>, 
                                            '2', '0x0303', ~new_ns, $cipher_suite, <'13', $sig_algs.1>, '40', 
                                            $p_g, $p_g^~y>, 
                                           '8', $exts>, 
                                          '13', '0', $certificate_extensions>, 
                                         '11', '0', pk(~ltkS)>, 
                                        '15', 
                                        sign(<'server_cv', 
                                              h(<
                                                 <
                                                  <
                                                   <
                                                    <<p_messages, '6', '0x0303', '40', $p_g>, '1', '0x0303', 
                                                     p_nc, '0', $cipher_suites, '0', <'43', '0x0304'>, 
                                                     <'10', $g1, $g2>, <'13', $sig_algs>, '40', $p_g, p_gx>, 
                                                    '2', '0x0303', ~new_ns, $cipher_suite, 
                                                    <'13', $sig_algs.1>, '40', $p_g, $p_g^~y>, 
                                                   '8', $exts>, 
                                                  '13', '0', $certificate_extensions>, 
                                                 '11', '0', pk(~ltkS)>)
                                             >,
                                             ~ltkS)
                                       >, 
                                       '20', 
                                       hmac(<
                                             Expand(Expand(Extract(p_gxy, Extract(p_res_psk, '0')),
                                                           <'serverhts', 
                                                            h(<
                                                               <
                                                                <
                                                                 <
                                                                  <
                                                                   <<p_messages, '6', '0x0303', '40', $p_g>, 
                                                                    '1', '0x0303', p_nc, '0', $cipher_suites, 
                                                                    '0', <'43', '0x0304'>, <'10', $g1, $g2>, 
                                                                    <'13', $sig_algs>, '40', $p_g, p_gx>, 
                                                                   '2', '0x0303', ~new_ns, $cipher_suite, 
                                                                   <'13', $sig_algs.1>, '40', $p_g, $p_g^~y>, 
                                                                  '8', $exts>, 
                                                                 '13', '0', $certificate_extensions>, 
                                                                '11', '0', pk(~ltkS)>, 
                                                               '15', 
                                                               sign(<'server_cv', 
                                                                     h(<
                                                                        <
                                                                         <
                                                                          <
                                                                           <
                                                                            <p_messages, '6', '0x0303', '40', 
                                                                             $p_g>, 
                                                                            '1', '0x0303', p_nc, '0', 
                                                                            $cipher_suites, '0', 
                                                                            <'43', '0x0304'>, 
                                                                            <'10', $g1, $g2>, 
                                                                            <'13', $sig_algs>, '40', $p_g, 
                                                                            p_gx>, 
                                                                           '2', '0x0303', ~new_ns, 
                                                                           $cipher_suite, 
                                                                           <'13', $sig_algs.1>, '40', $p_g, 
                                                                           $p_g^~y>, 
                                                                          '8', $exts>, 
                                                                         '13', '0', $certificate_extensions>, 
                                                                        '11', '0', pk(~ltkS)>)
                                                                    >,
                                                                    ~ltkS)
                                                              >)
                                                           >,
                                                           '32'),
                                                    <'fin', '0'>, '32'), 
                                             h(<
                                                <
                                                 <
                                                  <
                                                   <
                                                    <<p_messages, '6', '0x0303', '40', $p_g>, '1', '0x0303', 
                                                     p_nc, '0', $cipher_suites, '0', <'43', '0x0304'>, 
                                                     <'10', $g1, $g2>, <'13', $sig_algs>, '40', $p_g, p_gx>, 
                                                    '2', '0x0303', ~new_ns, $cipher_suite, 
                                                    <'13', $sig_algs.1>, '40', $p_g, $p_g^~y>, 
                                                   '8', $exts>, 
                                                  '13', '0', $certificate_extensions>, 
                                                 '11', '0', pk(~ltkS)>, 
                                                '15', 
                                                sign(<'server_cv', 
                                                      h(<
                                                         <
                                                          <
                                                           <
                                                            <<p_messages, '6', '0x0303', '40', $p_g>, '1', 
                                                             '0x0303', p_nc, '0', $cipher_suites, '0', 
                                                             <'43', '0x0304'>, <'10', $g1, $g2>, 
                                                             <'13', $sig_algs>, '40', $p_g, p_gx>, 
                                                            '2', '0x0303', ~new_ns, $cipher_suite, 
                                                            <'13', $sig_algs.1>, '40', $p_g, $p_g^~y>, 
                                                           '8', $exts>, 
                                                          '13', '0', $certificate_extensions>, 
                                                         '11', '0', pk(~ltkS)>)
                                                     >,
                                                     ~ltkS)
                                               >)
                                            >)
                                      >)
                                   >,
                                   '32')
                 ) @ #l)
               ∧
                #l < #j.1)) )
        case case_1
        solve( (∃ #r. (RevLtk( $C ) @ #r) ∧ #r < #i)  ∥
               (∃ tid3 x #r. (RevDHExp( tid3, $C, x ) @ #r) ∧ #r < #i)  ∥
               (∃ tid4 y #r. (RevDHExp( tid4, $S, y ) @ #r) ∧ #r < #i)  ∥
               (∃ rms #r. (RevealPSK( $S, rms ) @ #r) ∧ #r < #k.1)  ∥
               (∃ rms #r. (RevealPSK( $C, rms ) @ #r) ∧ #r < #k.1) )
          case case_1
          by contradiction /* from formulas */
        next
          case case_2
          by contradiction /* from formulas */
        next
          case case_3
          by contradiction /* from formulas */
        next
          case case_4
          solve( (∃ #r. (RevLtk( $C ) @ #r) ∧ #r < #i)  ∥
                 (∃ tid3 x #r. (RevDHExp( tid3, $C, x ) @ #r) ∧ #r < #i)  ∥
                 (∃ tid4 y #r. (RevDHExp( tid4, $S, y ) @ #r) ∧ #r < #i)  ∥
                 (∃ rms #r. (RevealPSK( $S, rms ) @ #r) ∧ #r < #i)  ∥
                 (∃ rms #r. (RevealPSK( $C, rms ) @ #r) ∧ #r < #i) )
            case case_1
            by contradiction /* from formulas */
          next
            case case_2
            by contradiction /* from formulas */
          next
            case case_3
            by contradiction /* from formulas */
          next
            case case_4
            by contradiction /* from formulas */
          next
            case case_5
            by contradiction /* from formulas */
          qed
        next
          case case_5
          solve( (∃ #r. (RevLtk( $C ) @ #r) ∧ #r < #i)  ∥
                 (∃ tid3 x #r. (RevDHExp( tid3, $C, x ) @ #r) ∧ #r < #i)  ∥
                 (∃ tid4 y #r. (RevDHExp( tid4, $S, y ) @ #r) ∧ #r < #i)  ∥
                 (∃ rms #r. (RevealPSK( $S, rms ) @ #r) ∧ #r < #i)  ∥
                 (∃ rms #r. (RevealPSK( $C, rms ) @ #r) ∧ #r < #i) )
            case case_1
            by contradiction /* from formulas */
          next
            case case_2
            by contradiction /* from formulas */
          next
            case case_3
            by contradiction /* from formulas */
          next
            case case_4
            by contradiction /* from formulas */
          next
            case case_5
            by contradiction /* from formulas */
          qed
        qed
      next
        case case_2
        solve( !Pk( $C, pk(~ltkC) ) ▶₁ #i )
          case Register_pk
          by solve( SecretPSK( $A,
                               Expand(Extract('0', Extract(p_gxy, Extract(p_res_psk, '0'))),
                                      <'clientats', 
                                       h(<
                                          <
                                           <
                                            <
                                             <
                                              <
                                               <<p_messages, '6', '0x0303', '40', $p_g>, '1', '0x0303', p_nc, 
                                                '0', $cipher_suites, '0', <'43', '0x0304'>, <'10', $g1, $g2>, 
                                                <'13', $sig_algs>, '40', $p_g, p_gx>, 
                                               '2', '0x0303', ~new_ns, $cipher_suite, <'13', $sig_algs.1>, 
                                               '40', $p_g, $p_g^~y>, 
                                              '8', $exts>, 
                                             '13', '0', $certificate_extensions>, 
                                            '11', '0', pk(~ltkS)>, 
                                           '15', 
                                           sign(<'server_cv', 
                                                 h(<
                                                    <
                                                     <
                                                      <
                                                       <<p_messages, '6', '0x0303', '40', $p_g>, '1', 
                                                        '0x0303', p_nc, '0', $cipher_suites, '0', 
                                                        <'43', '0x0304'>, <'10', $g1, $g2>, 
                                                        <'13', $sig_algs>, '40', $p_g, p_gx>, 
                                                       '2', '0x0303', ~new_ns, $cipher_suite, 
                                                       <'13', $sig_algs.1>, '40', $p_g, $p_g^~y>, 
                                                      '8', $exts>, 
                                                     '13', '0', $certificate_extensions>, 
                                                    '11', '0', pk(~ltkS)>)
                                                >,
                                                ~ltkS)
                                          >, 
                                          '20', 
                                          hmac(<
                                                Expand(Expand(Extract(p_gxy, Extract(p_res_psk, '0')),
                                                              <'serverhts', 
                                                               h(<
                                                                  <
                                                                   <
                                                                    <
                                                                     <
                                                                      <
                                                                       <p_messages, '6', '0x0303', '40', $p_g
                                                                       >, 
                                                                       '1', '0x0303', p_nc, '0', 
                                                                       $cipher_suites, '0', <'43', '0x0304'>, 
                                                                       <'10', $g1, $g2>, <'13', $sig_algs>, 
                                                                       '40', $p_g, p_gx>, 
                                                                      '2', '0x0303', ~new_ns, $cipher_suite, 
                                                                      <'13', $sig_algs.1>, '40', $p_g, $p_g^~y
                                                                     >, 
                                                                     '8', $exts>, 
                                                                    '13', '0', $certificate_extensions>, 
                                                                   '11', '0', pk(~ltkS)>, 
                                                                  '15', 
                                                                  sign(<'server_cv', 
                                                                        h(<
                                                                           <
                                                                            <
                                                                             <
                                                                              <
                                                                               <p_messages, '6', '0x0303', 
                                                                                '40', $p_g>, 
                                                                               '1', '0x0303', p_nc, '0', 
                                                                               $cipher_suites, '0', 
                                                                               <'43', '0x0304'>, 
                                                                               <'10', $g1, $g2>, 
                                                                               <'13', $sig_algs>, '40', $p_g, 
                                                                               p_gx>, 
                                                                              '2', '0x0303', ~new_ns, 
                                                                              $cipher_suite, 
                                                                              <'13', $sig_algs.1>, '40', 
                                                                              $p_g, $p_g^~y>, 
                                                                             '8', $exts>, 
                                                                            '13', '0', $certificate_extensions
                                                                           >, 
                                                                           '11', '0', pk(~ltkS)>)
                                                                       >,
                                                                       ~ltkS)
                                                                 >)
                                                              >,
                                                              '32'),
                                                       <'fin', '0'>, '32'), 
                                                h(<
                                                   <
                                                    <
                                                     <
                                                      <
                                                       <<p_messages, '6', '0x0303', '40', $p_g>, '1', 
                                                        '0x0303', p_nc, '0', $cipher_suites, '0', 
                                                        <'43', '0x0304'>, <'10', $g1, $g2>, 
                                                        <'13', $sig_algs>, '40', $p_g, p_gx>, 
                                                       '2', '0x0303', ~new_ns, $cipher_suite, 
                                                       <'13', $sig_algs.1>, '40', $p_g, $p_g^~y>, 
                                                      '8', $exts>, 
                                                     '13', '0', $certificate_extensions>, 
                                                    '11', '0', pk(~ltkS)>, 
                                                   '15', 
                                                   sign(<'server_cv', 
                                                         h(<
                                                            <
                                                             <
                                                              <
                                                               <<p_messages, '6', '0x0303', '40', $p_g>, '1', 
                                                                '0x0303', p_nc, '0', $cipher_suites, '0', 
                                                                <'43', '0x0304'>, <'10', $g1, $g2>, 
                                                                <'13', $sig_algs>, '40', $p_g, p_gx>, 
                                                               '2', '0x0303', ~new_ns, $cipher_suite, 
                                                               <'13', $sig_algs.1>, '40', $p_g, $p_g^~y>, 
                                                              '8', $exts>, 
                                                             '13', '0', $certificate_extensions>, 
                                                            '11', '0', pk(~ltkS)>)
                                                        >,
                                                        ~ltkS)
                                                  >)
                                               >)
                                         >)
                                      >,
                                      '32')
                    ) ▶₀ #l )
        qed
      qed
    next
      case server_auth_case_03
      solve( (∃ #j.2.
               (!KU( Extract('0', Extract(p_gxy, Extract(~res_psk, '0'))) ) @ #j.2)
              ∧
               #j.2 < #j.1)  ∥
             ((∀ #k.
                (!KU( Extract('0', Extract(p_gxy, Extract(~res_psk, '0'))) ) @ #k)
               ⇒
                ¬(#k < #j.1)) ∧
              (∃ actor #l.
                (RevealPSK( actor,
                            Expand(Extract('0', Extract(p_gxy, Extract(~res_psk, '0'))),
                                   <'clientats', 
                                    h(<
                                       <
                                        <
                                         <
                                          <
                                           <
                                            <'0', '1', '0x0303', p_nc, '0', $cipher_suites, '0', 
                                             <'43', '0x0304'>, <'10', $g1, $g2>, <'40', $p_g, p_gx>, 
                                             <'45', '0', '1'>, p_edi, '41', <~ticket, mask(x, x.1)>, 
                                             hmac(<
                                                   Expand(Expand(Extract(~res_psk, '0'), <'ext', 'pbk'>,
                                                                 '32'),
                                                          <'0', '0'>, '32'), 
                                                   h(<'0', '1', '0x0303', p_nc, '0', $cipher_suites, '0', 
                                                      <'43', '0x0304'>, <'10', $g1, $g2>, <'40', $p_g, p_gx>, 
                                                      <'45', '0', '1'>, p_edi, '41', <~ticket, mask(x, x.1)>, 
                                                      '0'>)
                                                  >)
                                            >, 
                                            '2', '0x0303', ~ns, $cipher_suite, <'13', $sig_algs>, '40', $p_g, 
                                            $p_g^~y>, 
                                           '8', $exts>, 
                                          '13', '0', $certificate_extensions>, 
                                         '11', '0', pk(~ltkS)>, 
                                        '15', 
                                        sign(<'server_cv', 
                                              h(<
                                                 <
                                                  <
                                                   <
                                                    <'0', '1', '0x0303', p_nc, '0', $cipher_suites, '0', 
                                                     <'43', '0x0304'>, <'10', $g1, $g2>, <'40', $p_g, p_gx>, 
                                                     <'45', '0', '1'>, p_edi, '41', <~ticket, mask(x, x.1)>, 
                                                     hmac(<
                                                           Expand(Expand(Extract(~res_psk, '0'),
                                                                         <'ext', 'pbk'>, '32'),
                                                                  <'0', '0'>, '32'), 
                                                           h(<'0', '1', '0x0303', p_nc, '0', $cipher_suites, 
                                                              '0', <'43', '0x0304'>, <'10', $g1, $g2>, 
                                                              <'40', $p_g, p_gx>, <'45', '0', '1'>, p_edi, 
                                                              '41', <~ticket, mask(x, x.1)>, '0'>)
                                                          >)
                                                    >, 
                                                    '2', '0x0303', ~ns, $cipher_suite, <'13', $sig_algs>, 
                                                    '40', $p_g, $p_g^~y>, 
                                                   '8', $exts>, 
                                                  '13', '0', $certificate_extensions>, 
                                                 '11', '0', pk(~ltkS)>)
                                             >,
                                             ~ltkS)
                                       >, 
                                       '20', 
                                       hmac(<
                                             Expand(Expand(Extract(p_gxy, Extract(~res_psk, '0')),
                                                           <'serverhts', 
                                                            h(<
                                                               <
                                                                <
                                                                 <
                                                                  <
                                                                   <'0', '1', '0x0303', p_nc, '0', 
                                                                    $cipher_suites, '0', <'43', '0x0304'>, 
                                                                    <'10', $g1, $g2>, <'40', $p_g, p_gx>, 
                                                                    <'45', '0', '1'>, p_edi, '41', 
                                                                    <~ticket, mask(x, x.1)>, 
                                                                    hmac(<
                                                                          Expand(Expand(Extract(~res_psk,
                                                                                                '0'),
                                                                                        <'ext', 'pbk'>, '32'),
                                                                                 <'0', '0'>, '32'), 
                                                                          h(<'0', '1', '0x0303', p_nc, '0', 
                                                                             $cipher_suites, '0', 
                                                                             <'43', '0x0304'>, 
                                                                             <'10', $g1, $g2>, 
                                                                             <'40', $p_g, p_gx>, 
                                                                             <'45', '0', '1'>, p_edi, '41', 
                                                                             <~ticket, mask(x, x.1)>, '0'>)
                                                                         >)
                                                                   >, 
                                                                   '2', '0x0303', ~ns, $cipher_suite, 
                                                                   <'13', $sig_algs>, '40', $p_g, $p_g^~y>, 
                                                                  '8', $exts>, 
                                                                 '13', '0', $certificate_extensions>, 
                                                                '11', '0', pk(~ltkS)>, 
                                                               '15', 
                                                               sign(<'server_cv', 
                                                                     h(<
                                                                        <
                                                                         <
                                                                          <
                                                                           <'0', '1', '0x0303', p_nc, '0', 
                                                                            $cipher_suites, '0', 
                                                                            <'43', '0x0304'>, 
                                                                            <'10', $g1, $g2>, 
                                                                            <'40', $p_g, p_gx>, 
                                                                            <'45', '0', '1'>, p_edi, '41', 
                                                                            <~ticket, mask(x, x.1)>, 
                                                                            hmac(<
                                                                                  Expand(Expand(Extract(~res_psk,
                                                                                                        '0'),
                                                                                                <'ext', 'pbk'
                                                                                                >,
                                                                                                '32'),
                                                                                         <'0', '0'>, '32'), 
                                                                                  h(<'0', '1', '0x0303', 
                                                                                     p_nc, '0', 
                                                                                     $cipher_suites, '0', 
                                                                                     <'43', '0x0304'>, 
                                                                                     <'10', $g1, $g2>, 
                                                                                     <'40', $p_g, p_gx>, 
                                                                                     <'45', '0', '1'>, p_edi, 
                                                                                     '41', 
                                                                                     <~ticket, mask(x, x.1)>, 
                                                                                     '0'>)
                                                                                 >)
                                                                           >, 
                                                                           '2', '0x0303', ~ns, $cipher_suite, 
                                                                           <'13', $sig_algs>, '40', $p_g, 
                                                                           $p_g^~y>, 
                                                                          '8', $exts>, 
                                                                         '13', '0', $certificate_extensions>, 
                                                                        '11', '0', pk(~ltkS)>)
                                                                    >,
                                                                    ~ltkS)
                                                              >)
                                                           >,
                                                           '32'),
                                                    <'fin', '0'>, '32'), 
                                             h(<
                                                <
                                                 <
                                                  <
                                                   <
                                                    <'0', '1', '0x0303', p_nc, '0', $cipher_suites, '0', 
                                                     <'43', '0x0304'>, <'10', $g1, $g2>, <'40', $p_g, p_gx>, 
                                                     <'45', '0', '1'>, p_edi, '41', <~ticket, mask(x, x.1)>, 
                                                     hmac(<
                                                           Expand(Expand(Extract(~res_psk, '0'),
                                                                         <'ext', 'pbk'>, '32'),
                                                                  <'0', '0'>, '32'), 
                                                           h(<'0', '1', '0x0303', p_nc, '0', $cipher_suites, 
                                                              '0', <'43', '0x0304'>, <'10', $g1, $g2>, 
                                                              <'40', $p_g, p_gx>, <'45', '0', '1'>, p_edi, 
                                                              '41', <~ticket, mask(x, x.1)>, '0'>)
                                                          >)
                                                    >, 
                                                    '2', '0x0303', ~ns, $cipher_suite, <'13', $sig_algs>, 
                                                    '40', $p_g, $p_g^~y>, 
                                                   '8', $exts>, 
                                                  '13', '0', $certificate_extensions>, 
                                                 '11', '0', pk(~ltkS)>, 
                                                '15', 
                                                sign(<'server_cv', 
                                                      h(<
                                                         <
                                                          <
                                                           <
                                                            <'0', '1', '0x0303', p_nc, '0', $cipher_suites, 
                                                             '0', <'43', '0x0304'>, <'10', $g1, $g2>, 
                                                             <'40', $p_g, p_gx>, <'45', '0', '1'>, p_edi, 
                                                             '41', <~ticket, mask(x, x.1)>, 
                                                             hmac(<
                                                                   Expand(Expand(Extract(~res_psk, '0'),
                                                                                 <'ext', 'pbk'>, '32'),
                                                                          <'0', '0'>, '32'), 
                                                                   h(<'0', '1', '0x0303', p_nc, '0', 
                                                                      $cipher_suites, '0', <'43', '0x0304'>, 
                                                                      <'10', $g1, $g2>, <'40', $p_g, p_gx>, 
                                                                      <'45', '0', '1'>, p_edi, '41', 
                                                                      <~ticket, mask(x, x.1)>, '0'>)
                                                                  >)
                                                            >, 
                                                            '2', '0x0303', ~ns, $cipher_suite, 
                                                            <'13', $sig_algs>, '40', $p_g, $p_g^~y>, 
                                                           '8', $exts>, 
                                                          '13', '0', $certificate_extensions>, 
                                                         '11', '0', pk(~ltkS)>)
                                                     >,
                                                     ~ltkS)
                                               >)
                                            >)
                                      >)
                                   >,
                                   '32')
                 ) @ #l)
               ∧
                #l < #j.1)) )
        case case_1
        solve( (∃ #r. (RevLtk( $C ) @ #r) ∧ #r < #i)  ∥
               (∃ tid3 x #r. (RevDHExp( tid3, $C, x ) @ #r) ∧ #r < #i)  ∥
               (∃ tid4 y #r. (RevDHExp( tid4, $S, y ) @ #r) ∧ #r < #i)  ∥
               (∃ rms #r. (RevealPSK( $S, rms ) @ #r) ∧ #r < #k.1)  ∥
               (∃ rms #r. (RevealPSK( $C, rms ) @ #r) ∧ #r < #k.1) )
          case case_1
          by contradiction /* from formulas */
        next
          case case_2
          by contradiction /* from formulas */
        next
          case case_3
          by contradiction /* from formulas */
        next
          case case_4
          solve( (∃ #r. (RevLtk( $C ) @ #r) ∧ #r < #i)  ∥
                 (∃ tid3 x #r. (RevDHExp( tid3, $C, x ) @ #r) ∧ #r < #i)  ∥
                 (∃ tid4 y #r. (RevDHExp( tid4, $S, y ) @ #r) ∧ #r < #i)  ∥
                 (∃ rms #r. (RevealPSK( $S, rms ) @ #r) ∧ #r < #i)  ∥
                 (∃ rms #r. (RevealPSK( $C, rms ) @ #r) ∧ #r < #i) )
            case case_1
            by contradiction /* from formulas */
          next
            case case_2
            by contradiction /* from formulas */
          next
            case case_3
            by contradiction /* from formulas */
          next
            case case_4
            by contradiction /* from formulas */
          next
            case case_5
            by contradiction /* from formulas */
          qed
        next
          case case_5
          solve( (∃ #r. (RevLtk( $C ) @ #r) ∧ #r < #i)  ∥
                 (∃ tid3 x #r. (RevDHExp( tid3, $C, x ) @ #r) ∧ #r < #i)  ∥
                 (∃ tid4 y #r. (RevDHExp( tid4, $S, y ) @ #r) ∧ #r < #i)  ∥
                 (∃ rms #r. (RevealPSK( $S, rms ) @ #r) ∧ #r < #i)  ∥
                 (∃ rms #r. (RevealPSK( $C, rms ) @ #r) ∧ #r < #i) )
            case case_1
            by contradiction /* from formulas */
          next
            case case_2
            by contradiction /* from formulas */
          next
            case case_3
            by contradiction /* from formulas */
          next
            case case_4
            by contradiction /* from formulas */
          next
            case case_5
            by contradiction /* from formulas */
          qed
        qed
      next
        case case_2
        solve( !Pk( $C, pk(~ltkC) ) ▶₁ #i )
          case Register_pk
          by solve( SecretPSK( $A,
                               Expand(Extract('0', Extract(p_gxy, Extract(~res_psk, '0'))),
                                      <'clientats', 
                                       h(<
                                          <
                                           <
                                            <
                                             <
                                              <
                                               <'0', '1', '0x0303', p_nc, '0', $cipher_suites, '0', 
                                                <'43', '0x0304'>, <'10', $g1, $g2>, <'40', $p_g, p_gx>, 
                                                <'45', '0', '1'>, p_edi, '41', <~ticket, mask(x, x.1)>, 
                                                hmac(<
                                                      Expand(Expand(Extract(~res_psk, '0'), <'ext', 'pbk'>,
                                                                    '32'),
                                                             <'0', '0'>, '32'), 
                                                      h(<'0', '1', '0x0303', p_nc, '0', $cipher_suites, '0', 
                                                         <'43', '0x0304'>, <'10', $g1, $g2>, 
                                                         <'40', $p_g, p_gx>, <'45', '0', '1'>, p_edi, '41', 
                                                         <~ticket, mask(x, x.1)>, '0'>)
                                                     >)
                                               >, 
                                               '2', '0x0303', ~ns, $cipher_suite, <'13', $sig_algs>, '40', 
                                               $p_g, $p_g^~y>, 
                                              '8', $exts>, 
                                             '13', '0', $certificate_extensions>, 
                                            '11', '0', pk(~ltkS)>, 
                                           '15', 
                                           sign(<'server_cv', 
                                                 h(<
                                                    <
                                                     <
                                                      <
                                                       <'0', '1', '0x0303', p_nc, '0', $cipher_suites, '0', 
                                                        <'43', '0x0304'>, <'10', $g1, $g2>, 
                                                        <'40', $p_g, p_gx>, <'45', '0', '1'>, p_edi, '41', 
                                                        <~ticket, mask(x, x.1)>, 
                                                        hmac(<
                                                              Expand(Expand(Extract(~res_psk, '0'),
                                                                            <'ext', 'pbk'>, '32'),
                                                                     <'0', '0'>, '32'), 
                                                              h(<'0', '1', '0x0303', p_nc, '0', 
                                                                 $cipher_suites, '0', <'43', '0x0304'>, 
                                                                 <'10', $g1, $g2>, <'40', $p_g, p_gx>, 
                                                                 <'45', '0', '1'>, p_edi, '41', 
                                                                 <~ticket, mask(x, x.1)>, '0'>)
                                                             >)
                                                       >, 
                                                       '2', '0x0303', ~ns, $cipher_suite, <'13', $sig_algs>, 
                                                       '40', $p_g, $p_g^~y>, 
                                                      '8', $exts>, 
                                                     '13', '0', $certificate_extensions>, 
                                                    '11', '0', pk(~ltkS)>)
                                                >,
                                                ~ltkS)
                                          >, 
                                          '20', 
                                          hmac(<
                                                Expand(Expand(Extract(p_gxy, Extract(~res_psk, '0')),
                                                              <'serverhts', 
                                                               h(<
                                                                  <
                                                                   <
                                                                    <
                                                                     <
                                                                      <'0', '1', '0x0303', p_nc, '0', 
                                                                       $cipher_suites, '0', <'43', '0x0304'>, 
                                                                       <'10', $g1, $g2>, <'40', $p_g, p_gx>, 
                                                                       <'45', '0', '1'>, p_edi, '41', 
                                                                       <~ticket, mask(x, x.1)>, 
                                                                       hmac(<
                                                                             Expand(Expand(Extract(~res_psk,
                                                                                                   '0'),
                                                                                           <'ext', 'pbk'>,
                                                                                           '32'),
                                                                                    <'0', '0'>, '32'), 
                                                                             h(<'0', '1', '0x0303', p_nc, 
                                                                                '0', $cipher_suites, '0', 
                                                                                <'43', '0x0304'>, 
                                                                                <'10', $g1, $g2>, 
                                                                                <'40', $p_g, p_gx>, 
                                                                                <'45', '0', '1'>, p_edi, 
                                                                                '41', 
                                                                                <~ticket, mask(x, x.1)>, '0'>)
                                                                            >)
                                                                      >, 
                                                                      '2', '0x0303', ~ns, $cipher_suite, 
                                                                      <'13', $sig_algs>, '40', $p_g, $p_g^~y
                                                                     >, 
                                                                     '8', $exts>, 
                                                                    '13', '0', $certificate_extensions>, 
                                                                   '11', '0', pk(~ltkS)>, 
                                                                  '15', 
                                                                  sign(<'server_cv', 
                                                                        h(<
                                                                           <
                                                                            <
                                                                             <
                                                                              <'0', '1', '0x0303', p_nc, '0', 
                                                                               $cipher_suites, '0', 
                                                                               <'43', '0x0304'>, 
                                                                               <'10', $g1, $g2>, 
                                                                               <'40', $p_g, p_gx>, 
                                                                               <'45', '0', '1'>, p_edi, '41', 
                                                                               <~ticket, mask(x, x.1)>, 
                                                                               hmac(<
                                                                                     Expand(Expand(Extract(~res_psk,
                                                                                                           '0'),
                                                                                                   <'ext', 
                                                                                                    'pbk'>,
                                                                                                   '32'),
                                                                                            <'0', '0'>,
                                                                                            '32'), 
                                                                                     h(<'0', '1', '0x0303', 
                                                                                        p_nc, '0', 
                                                                                        $cipher_suites, '0', 
                                                                                        <'43', '0x0304'>, 
                                                                                        <'10', $g1, $g2>, 
                                                                                        <'40', $p_g, p_gx>, 
                                                                                        <'45', '0', '1'>, 
                                                                                        p_edi, '41', 
                                                                                        <~ticket, mask(x, x.1)
                                                                                        >, 
                                                                                        '0'>)
                                                                                    >)
                                                                              >, 
                                                                              '2', '0x0303', ~ns, 
                                                                              $cipher_suite, 
                                                                              <'13', $sig_algs>, '40', $p_g, 
                                                                              $p_g^~y>, 
                                                                             '8', $exts>, 
                                                                            '13', '0', $certificate_extensions
                                                                           >, 
                                                                           '11', '0', pk(~ltkS)>)
                                                                       >,
                                                                       ~ltkS)
                                                                 >)
                                                              >,
                                                              '32'),
                                                       <'fin', '0'>, '32'), 
                                                h(<
                                                   <
                                                    <
                                                     <
                                                      <
                                                       <'0', '1', '0x0303', p_nc, '0', $cipher_suites, '0', 
                                                        <'43', '0x0304'>, <'10', $g1, $g2>, 
                                                        <'40', $p_g, p_gx>, <'45', '0', '1'>, p_edi, '41', 
                                                        <~ticket, mask(x, x.1)>, 
                                                        hmac(<
                                                              Expand(Expand(Extract(~res_psk, '0'),
                                                                            <'ext', 'pbk'>, '32'),
                                                                     <'0', '0'>, '32'), 
                                                              h(<'0', '1', '0x0303', p_nc, '0', 
                                                                 $cipher_suites, '0', <'43', '0x0304'>, 
                                                                 <'10', $g1, $g2>, <'40', $p_g, p_gx>, 
                                                                 <'45', '0', '1'>, p_edi, '41', 
                                                                 <~ticket, mask(x, x.1)>, '0'>)
                                                             >)
                                                       >, 
                                                       '2', '0x0303', ~ns, $cipher_suite, <'13', $sig_algs>, 
                                                       '40', $p_g, $p_g^~y>, 
                                                      '8', $exts>, 
                                                     '13', '0', $certificate_extensions>, 
                                                    '11', '0', pk(~ltkS)>, 
                                                   '15', 
                                                   sign(<'server_cv', 
                                                         h(<
                                                            <
                                                             <
                                                              <
                                                               <'0', '1', '0x0303', p_nc, '0', 
                                                                $cipher_suites, '0', <'43', '0x0304'>, 
                                                                <'10', $g1, $g2>, <'40', $p_g, p_gx>, 
                                                                <'45', '0', '1'>, p_edi, '41', 
                                                                <~ticket, mask(x, x.1)>, 
                                                                hmac(<
                                                                      Expand(Expand(Extract(~res_psk, '0'),
                                                                                    <'ext', 'pbk'>, '32'),
                                                                             <'0', '0'>, '32'), 
                                                                      h(<'0', '1', '0x0303', p_nc, '0', 
                                                                         $cipher_suites, '0', 
                                                                         <'43', '0x0304'>, <'10', $g1, $g2>, 
                                                                         <'40', $p_g, p_gx>, 
                                                                         <'45', '0', '1'>, p_edi, '41', 
                                                                         <~ticket, mask(x, x.1)>, '0'>)
                                                                     >)
                                                               >, 
                                                               '2', '0x0303', ~ns, $cipher_suite, 
                                                               <'13', $sig_algs>, '40', $p_g, $p_g^~y>, 
                                                              '8', $exts>, 
                                                             '13', '0', $certificate_extensions>, 
                                                            '11', '0', pk(~ltkS)>)
                                                        >,
                                                        ~ltkS)
                                                  >)
                                               >)
                                         >)
                                      >,
                                      '32')
                    ) ▶₀ #l )
        qed
      qed
    next
      case server_auth_case_04
      solve( (∃ #j.2.
               (!KU( Extract('0',
                             Extract(p_gxy, Extract(Expand(ms, <'rms', h(messages)>, '32'), '0')))
                ) @ #j.2)
              ∧
               #j.2 < #j.1)  ∥
             ((∀ #k.
                (!KU( Extract('0',
                              Extract(p_gxy, Extract(Expand(ms, <'rms', h(messages)>, '32'), '0')))
                 ) @ #k)
               ⇒
                ¬(#k < #j.1)) ∧
              (∃ actor #l.
                (RevealPSK( actor,
                            Expand(Extract('0',
                                           Extract(p_gxy,
                                                   Extract(Expand(ms, <'rms', h(messages)>, '32'), '0'))),
                                   <'clientats', 
                                    h(<
                                       <
                                        <
                                         <
                                          <
                                           <
                                            <'0', '1', '0x0303', p_nc, '0', $cipher_suites, '0', 
                                             <'43', '0x0304'>, <'10', $g1, $g2>, <'40', $p_g, p_gx>, 
                                             <'45', '0', '1'>, p_edi, '41', <~ticket, mask(x, x.1)>, 
                                             hmac(<
                                                   Expand(Expand(Extract(Expand(ms, <'rms', h(messages)>,
                                                                                '32'),
                                                                         '0'),
                                                                 <'res', 'pbk'>, '32'),
                                                          <'0', '0'>, '32'), 
                                                   h(<'0', '1', '0x0303', p_nc, '0', $cipher_suites, '0', 
                                                      <'43', '0x0304'>, <'10', $g1, $g2>, <'40', $p_g, p_gx>, 
                                                      <'45', '0', '1'>, p_edi, '41', <~ticket, mask(x, x.1)>, 
                                                      '0'>)
                                                  >)
                                            >, 
                                            '2', '0x0303', ~ns, $cipher_suite, <'13', $sig_algs>, '40', $p_g, 
                                            $p_g^~y>, 
                                           '8', $exts>, 
                                          '13', '0', $certificate_extensions>, 
                                         '11', '0', pk(~ltkS)>, 
                                        '15', 
                                        sign(<'server_cv', 
                                              h(<
                                                 <
                                                  <
                                                   <
                                                    <'0', '1', '0x0303', p_nc, '0', $cipher_suites, '0', 
                                                     <'43', '0x0304'>, <'10', $g1, $g2>, <'40', $p_g, p_gx>, 
                                                     <'45', '0', '1'>, p_edi, '41', <~ticket, mask(x, x.1)>, 
                                                     hmac(<
                                                           Expand(Expand(Extract(Expand(ms,
                                                                                        <'rms', h(messages)>,
                                                                                        '32'),
                                                                                 '0'),
                                                                         <'res', 'pbk'>, '32'),
                                                                  <'0', '0'>, '32'), 
                                                           h(<'0', '1', '0x0303', p_nc, '0', $cipher_suites, 
                                                              '0', <'43', '0x0304'>, <'10', $g1, $g2>, 
                                                              <'40', $p_g, p_gx>, <'45', '0', '1'>, p_edi, 
                                                              '41', <~ticket, mask(x, x.1)>, '0'>)
                                                          >)
                                                    >, 
                                                    '2', '0x0303', ~ns, $cipher_suite, <'13', $sig_algs>, 
                                                    '40', $p_g, $p_g^~y>, 
                                                   '8', $exts>, 
                                                  '13', '0', $certificate_extensions>, 
                                                 '11', '0', pk(~ltkS)>)
                                             >,
                                             ~ltkS)
                                       >, 
                                       '20', 
                                       hmac(<
                                             Expand(Expand(Extract(p_gxy,
                                                                   Extract(Expand(ms, <'rms', h(messages)>,
                                                                                  '32'),
                                                                           '0')),
                                                           <'serverhts', 
                                                            h(<
                                                               <
                                                                <
                                                                 <
                                                                  <
                                                                   <'0', '1', '0x0303', p_nc, '0', 
                                                                    $cipher_suites, '0', <'43', '0x0304'>, 
                                                                    <'10', $g1, $g2>, <'40', $p_g, p_gx>, 
                                                                    <'45', '0', '1'>, p_edi, '41', 
                                                                    <~ticket, mask(x, x.1)>, 
                                                                    hmac(<
                                                                          Expand(Expand(Extract(Expand(ms,
                                                                                                       <
                                                                                                        'rms', 
                                                                                                        h(messages)
                                                                                                       >,
                                                                                                       '32'),
                                                                                                '0'),
                                                                                        <'res', 'pbk'>, '32'),
                                                                                 <'0', '0'>, '32'), 
                                                                          h(<'0', '1', '0x0303', p_nc, '0', 
                                                                             $cipher_suites, '0', 
                                                                             <'43', '0x0304'>, 
                                                                             <'10', $g1, $g2>, 
                                                                             <'40', $p_g, p_gx>, 
                                                                             <'45', '0', '1'>, p_edi, '41', 
                                                                             <~ticket, mask(x, x.1)>, '0'>)
                                                                         >)
                                                                   >, 
                                                                   '2', '0x0303', ~ns, $cipher_suite, 
                                                                   <'13', $sig_algs>, '40', $p_g, $p_g^~y>, 
                                                                  '8', $exts>, 
                                                                 '13', '0', $certificate_extensions>, 
                                                                '11', '0', pk(~ltkS)>, 
                                                               '15', 
                                                               sign(<'server_cv', 
                                                                     h(<
                                                                        <
                                                                         <
                                                                          <
                                                                           <'0', '1', '0x0303', p_nc, '0', 
                                                                            $cipher_suites, '0', 
                                                                            <'43', '0x0304'>, 
                                                                            <'10', $g1, $g2>, 
                                                                            <'40', $p_g, p_gx>, 
                                                                            <'45', '0', '1'>, p_edi, '41', 
                                                                            <~ticket, mask(x, x.1)>, 
                                                                            hmac(<
                                                                                  Expand(Expand(Extract(Expand(ms,
                                                                                                               <
                                                                                                                'rms', 
                                                                                                                h(messages)
                                                                                                               >,
                                                                                                               '32'),
                                                                                                        '0'),
                                                                                                <'res', 'pbk'
                                                                                                >,
                                                                                                '32'),
                                                                                         <'0', '0'>, '32'), 
                                                                                  h(<'0', '1', '0x0303', 
                                                                                     p_nc, '0', 
                                                                                     $cipher_suites, '0', 
                                                                                     <'43', '0x0304'>, 
                                                                                     <'10', $g1, $g2>, 
                                                                                     <'40', $p_g, p_gx>, 
                                                                                     <'45', '0', '1'>, p_edi, 
                                                                                     '41', 
                                                                                     <~ticket, mask(x, x.1)>, 
                                                                                     '0'>)
                                                                                 >)
                                                                           >, 
                                                                           '2', '0x0303', ~ns, $cipher_suite, 
                                                                           <'13', $sig_algs>, '40', $p_g, 
                                                                           $p_g^~y>, 
                                                                          '8', $exts>, 
                                                                         '13', '0', $certificate_extensions>, 
                                                                        '11', '0', pk(~ltkS)>)
                                                                    >,
                                                                    ~ltkS)
                                                              >)
                                                           >,
                                                           '32'),
                                                    <'fin', '0'>, '32'), 
                                             h(<
                                                <
                                                 <
                                                  <
                                                   <
                                                    <'0', '1', '0x0303', p_nc, '0', $cipher_suites, '0', 
                                                     <'43', '0x0304'>, <'10', $g1, $g2>, <'40', $p_g, p_gx>, 
                                                     <'45', '0', '1'>, p_edi, '41', <~ticket, mask(x, x.1)>, 
                                                     hmac(<
                                                           Expand(Expand(Extract(Expand(ms,
                                                                                        <'rms', h(messages)>,
                                                                                        '32'),
                                                                                 '0'),
                                                                         <'res', 'pbk'>, '32'),
                                                                  <'0', '0'>, '32'), 
                                                           h(<'0', '1', '0x0303', p_nc, '0', $cipher_suites, 
                                                              '0', <'43', '0x0304'>, <'10', $g1, $g2>, 
                                                              <'40', $p_g, p_gx>, <'45', '0', '1'>, p_edi, 
                                                              '41', <~ticket, mask(x, x.1)>, '0'>)
                                                          >)
                                                    >, 
                                                    '2', '0x0303', ~ns, $cipher_suite, <'13', $sig_algs>, 
                                                    '40', $p_g, $p_g^~y>, 
                                                   '8', $exts>, 
                                                  '13', '0', $certificate_extensions>, 
                                                 '11', '0', pk(~ltkS)>, 
                                                '15', 
                                                sign(<'server_cv', 
                                                      h(<
                                                         <
                                                          <
                                                           <
                                                            <'0', '1', '0x0303', p_nc, '0', $cipher_suites, 
                                                             '0', <'43', '0x0304'>, <'10', $g1, $g2>, 
                                                             <'40', $p_g, p_gx>, <'45', '0', '1'>, p_edi, 
                                                             '41', <~ticket, mask(x, x.1)>, 
                                                             hmac(<
                                                                   Expand(Expand(Extract(Expand(ms,
                                                                                                <'rms', 
                                                                                                 h(messages)>,
                                                                                                '32'),
                                                                                         '0'),
                                                                                 <'res', 'pbk'>, '32'),
                                                                          <'0', '0'>, '32'), 
                                                                   h(<'0', '1', '0x0303', p_nc, '0', 
                                                                      $cipher_suites, '0', <'43', '0x0304'>, 
                                                                      <'10', $g1, $g2>, <'40', $p_g, p_gx>, 
                                                                      <'45', '0', '1'>, p_edi, '41', 
                                                                      <~ticket, mask(x, x.1)>, '0'>)
                                                                  >)
                                                            >, 
                                                            '2', '0x0303', ~ns, $cipher_suite, 
                                                            <'13', $sig_algs>, '40', $p_g, $p_g^~y>, 
                                                           '8', $exts>, 
                                                          '13', '0', $certificate_extensions>, 
                                                         '11', '0', pk(~ltkS)>)
                                                     >,
                                                     ~ltkS)
                                               >)
                                            >)
                                      >)
                                   >,
                                   '32')
                 ) @ #l)
               ∧
                #l < #j.1)) )
        case case_1
        solve( (∃ #r. (RevLtk( $C ) @ #r) ∧ #r < #i)  ∥
               (∃ tid3 x #r. (RevDHExp( tid3, $C, x ) @ #r) ∧ #r < #i)  ∥
               (∃ tid4 y #r. (RevDHExp( tid4, $S, y ) @ #r) ∧ #r < #i)  ∥
               (∃ rms #r. (RevealPSK( $S, rms ) @ #r) ∧ #r < #k.1)  ∥
               (∃ rms #r. (RevealPSK( $C, rms ) @ #r) ∧ #r < #k.1) )
          case case_1
          by contradiction /* from formulas */
        next
          case case_2
          by contradiction /* from formulas */
        next
          case case_3
          by contradiction /* from formulas */
        next
          case case_4
          solve( (∃ #r. (RevLtk( $C ) @ #r) ∧ #r < #i)  ∥
                 (∃ tid3 x #r. (RevDHExp( tid3, $C, x ) @ #r) ∧ #r < #i)  ∥
                 (∃ tid4 y #r. (RevDHExp( tid4, $S, y ) @ #r) ∧ #r < #i)  ∥
                 (∃ rms #r. (RevealPSK( $S, rms ) @ #r) ∧ #r < #i)  ∥
                 (∃ rms #r. (RevealPSK( $C, rms ) @ #r) ∧ #r < #i) )
            case case_1
            by contradiction /* from formulas */
          next
            case case_2
            by contradiction /* from formulas */
          next
            case case_3
            by contradiction /* from formulas */
          next
            case case_4
            by contradiction /* from formulas */
          next
            case case_5
            by contradiction /* from formulas */
          qed
        next
          case case_5
          solve( (∃ #r. (RevLtk( $C ) @ #r) ∧ #r < #i)  ∥
                 (∃ tid3 x #r. (RevDHExp( tid3, $C, x ) @ #r) ∧ #r < #i)  ∥
                 (∃ tid4 y #r. (RevDHExp( tid4, $S, y ) @ #r) ∧ #r < #i)  ∥
                 (∃ rms #r. (RevealPSK( $S, rms ) @ #r) ∧ #r < #i)  ∥
                 (∃ rms #r. (RevealPSK( $C, rms ) @ #r) ∧ #r < #i) )
            case case_1
            by contradiction /* from formulas */
          next
            case case_2
            by contradiction /* from formulas */
          next
            case case_3
            by contradiction /* from formulas */
          next
            case case_4
            by contradiction /* from formulas */
          next
            case case_5
            by contradiction /* from formulas */
          qed
        qed
      next
        case case_2
        solve( !Pk( $C, pk(~ltkC) ) ▶₁ #i )
          case Register_pk
          by solve( SecretPSK( $A,
                               Expand(Extract('0',
                                              Extract(p_gxy,
                                                      Extract(Expand(ms, <'rms', h(messages)>, '32'), '0'))),
                                      <'clientats', 
                                       h(<
                                          <
                                           <
                                            <
                                             <
                                              <
                                               <'0', '1', '0x0303', p_nc, '0', $cipher_suites, '0', 
                                                <'43', '0x0304'>, <'10', $g1, $g2>, <'40', $p_g, p_gx>, 
                                                <'45', '0', '1'>, p_edi, '41', <~ticket, mask(x, x.1)>, 
                                                hmac(<
                                                      Expand(Expand(Extract(Expand(ms, <'rms', h(messages)>,
                                                                                   '32'),
                                                                            '0'),
                                                                    <'res', 'pbk'>, '32'),
                                                             <'0', '0'>, '32'), 
                                                      h(<'0', '1', '0x0303', p_nc, '0', $cipher_suites, '0', 
                                                         <'43', '0x0304'>, <'10', $g1, $g2>, 
                                                         <'40', $p_g, p_gx>, <'45', '0', '1'>, p_edi, '41', 
                                                         <~ticket, mask(x, x.1)>, '0'>)
                                                     >)
                                               >, 
                                               '2', '0x0303', ~ns, $cipher_suite, <'13', $sig_algs>, '40', 
                                               $p_g, $p_g^~y>, 
                                              '8', $exts>, 
                                             '13', '0', $certificate_extensions>, 
                                            '11', '0', pk(~ltkS)>, 
                                           '15', 
                                           sign(<'server_cv', 
                                                 h(<
                                                    <
                                                     <
                                                      <
                                                       <'0', '1', '0x0303', p_nc, '0', $cipher_suites, '0', 
                                                        <'43', '0x0304'>, <'10', $g1, $g2>, 
                                                        <'40', $p_g, p_gx>, <'45', '0', '1'>, p_edi, '41', 
                                                        <~ticket, mask(x, x.1)>, 
                                                        hmac(<
                                                              Expand(Expand(Extract(Expand(ms,
                                                                                           <'rms', h(messages)
                                                                                           >,
                                                                                           '32'),
                                                                                    '0'),
                                                                            <'res', 'pbk'>, '32'),
                                                                     <'0', '0'>, '32'), 
                                                              h(<'0', '1', '0x0303', p_nc, '0', 
                                                                 $cipher_suites, '0', <'43', '0x0304'>, 
                                                                 <'10', $g1, $g2>, <'40', $p_g, p_gx>, 
                                                                 <'45', '0', '1'>, p_edi, '41', 
                                                                 <~ticket, mask(x, x.1)>, '0'>)
                                                             >)
                                                       >, 
                                                       '2', '0x0303', ~ns, $cipher_suite, <'13', $sig_algs>, 
                                                       '40', $p_g, $p_g^~y>, 
                                                      '8', $exts>, 
                                                     '13', '0', $certificate_extensions>, 
                                                    '11', '0', pk(~ltkS)>)
                                                >,
                                                ~ltkS)
                                          >, 
                                          '20', 
                                          hmac(<
                                                Expand(Expand(Extract(p_gxy,
                                                                      Extract(Expand(ms, <'rms', h(messages)>,
                                                                                     '32'),
                                                                              '0')),
                                                              <'serverhts', 
                                                               h(<
                                                                  <
                                                                   <
                                                                    <
                                                                     <
                                                                      <'0', '1', '0x0303', p_nc, '0', 
                                                                       $cipher_suites, '0', <'43', '0x0304'>, 
                                                                       <'10', $g1, $g2>, <'40', $p_g, p_gx>, 
                                                                       <'45', '0', '1'>, p_edi, '41', 
                                                                       <~ticket, mask(x, x.1)>, 
                                                                       hmac(<
                                                                             Expand(Expand(Extract(Expand(ms,
                                                                                                          <
                                                                                                           'rms', 
                                                                                                           h(messages)
                                                                                                          >,
                                                                                                          '32'),
                                                                                                   '0'),
                                                                                           <'res', 'pbk'>,
                                                                                           '32'),
                                                                                    <'0', '0'>, '32'), 
                                                                             h(<'0', '1', '0x0303', p_nc, 
                                                                                '0', $cipher_suites, '0', 
                                                                                <'43', '0x0304'>, 
                                                                                <'10', $g1, $g2>, 
                                                                                <'40', $p_g, p_gx>, 
                                                                                <'45', '0', '1'>, p_edi, 
                                                                                '41', 
                                                                                <~ticket, mask(x, x.1)>, '0'>)
                                                                            >)
                                                                      >, 
                                                                      '2', '0x0303', ~ns, $cipher_suite, 
                                                                      <'13', $sig_algs>, '40', $p_g, $p_g^~y
                                                                     >, 
                                                                     '8', $exts>, 
                                                                    '13', '0', $certificate_extensions>, 
                                                                   '11', '0', pk(~ltkS)>, 
                                                                  '15', 
                                                                  sign(<'server_cv', 
                                                                        h(<
                                                                           <
                                                                            <
                                                                             <
                                                                              <'0', '1', '0x0303', p_nc, '0', 
                                                                               $cipher_suites, '0', 
                                                                               <'43', '0x0304'>, 
                                                                               <'10', $g1, $g2>, 
                                                                               <'40', $p_g, p_gx>, 
                                                                               <'45', '0', '1'>, p_edi, '41', 
                                                                               <~ticket, mask(x, x.1)>, 
                                                                               hmac(<
                                                                                     Expand(Expand(Extract(Expand(ms,
                                                                                                                  <
                                                                                                                   'rms', 
                                                                                                                   h(messages)
                                                                                                                  >,
                                                                                                                  '32'),
                                                                                                           '0'),
                                                                                                   <'res', 
                                                                                                    'pbk'>,
                                                                                                   '32'),
                                                                                            <'0', '0'>,
                                                                                            '32'), 
                                                                                     h(<'0', '1', '0x0303', 
                                                                                        p_nc, '0', 
                                                                                        $cipher_suites, '0', 
                                                                                        <'43', '0x0304'>, 
                                                                                        <'10', $g1, $g2>, 
                                                                                        <'40', $p_g, p_gx>, 
                                                                                        <'45', '0', '1'>, 
                                                                                        p_edi, '41', 
                                                                                        <~ticket, mask(x, x.1)
                                                                                        >, 
                                                                                        '0'>)
                                                                                    >)
                                                                              >, 
                                                                              '2', '0x0303', ~ns, 
                                                                              $cipher_suite, 
                                                                              <'13', $sig_algs>, '40', $p_g, 
                                                                              $p_g^~y>, 
                                                                             '8', $exts>, 
                                                                            '13', '0', $certificate_extensions
                                                                           >, 
                                                                           '11', '0', pk(~ltkS)>)
                                                                       >,
                                                                       ~ltkS)
                                                                 >)
                                                              >,
                                                              '32'),
                                                       <'fin', '0'>, '32'), 
                                                h(<
                                                   <
                                                    <
                                                     <
                                                      <
                                                       <'0', '1', '0x0303', p_nc, '0', $cipher_suites, '0', 
                                                        <'43', '0x0304'>, <'10', $g1, $g2>, 
                                                        <'40', $p_g, p_gx>, <'45', '0', '1'>, p_edi, '41', 
                                                        <~ticket, mask(x, x.1)>, 
                                                        hmac(<
                                                              Expand(Expand(Extract(Expand(ms,
                                                                                           <'rms', h(messages)
                                                                                           >,
                                                                                           '32'),
                                                                                    '0'),
                                                                            <'res', 'pbk'>, '32'),
                                                                     <'0', '0'>, '32'), 
                                                              h(<'0', '1', '0x0303', p_nc, '0', 
                                                                 $cipher_suites, '0', <'43', '0x0304'>, 
                                                                 <'10', $g1, $g2>, <'40', $p_g, p_gx>, 
                                                                 <'45', '0', '1'>, p_edi, '41', 
                                                                 <~ticket, mask(x, x.1)>, '0'>)
                                                             >)
                                                       >, 
                                                       '2', '0x0303', ~ns, $cipher_suite, <'13', $sig_algs>, 
                                                       '40', $p_g, $p_g^~y>, 
                                                      '8', $exts>, 
                                                     '13', '0', $certificate_extensions>, 
                                                    '11', '0', pk(~ltkS)>, 
                                                   '15', 
                                                   sign(<'server_cv', 
                                                         h(<
                                                            <
                                                             <
                                                              <
                                                               <'0', '1', '0x0303', p_nc, '0', 
                                                                $cipher_suites, '0', <'43', '0x0304'>, 
                                                                <'10', $g1, $g2>, <'40', $p_g, p_gx>, 
                                                                <'45', '0', '1'>, p_edi, '41', 
                                                                <~ticket, mask(x, x.1)>, 
                                                                hmac(<
                                                                      Expand(Expand(Extract(Expand(ms,
                                                                                                   <'rms', 
                                                                                                    h(messages)
                                                                                                   >,
                                                                                                   '32'),
                                                                                            '0'),
                                                                                    <'res', 'pbk'>, '32'),
                                                                             <'0', '0'>, '32'), 
                                                                      h(<'0', '1', '0x0303', p_nc, '0', 
                                                                         $cipher_suites, '0', 
                                                                         <'43', '0x0304'>, <'10', $g1, $g2>, 
                                                                         <'40', $p_g, p_gx>, 
                                                                         <'45', '0', '1'>, p_edi, '41', 
                                                                         <~ticket, mask(x, x.1)>, '0'>)
                                                                     >)
                                                               >, 
                                                               '2', '0x0303', ~ns, $cipher_suite, 
                                                               <'13', $sig_algs>, '40', $p_g, $p_g^~y>, 
                                                              '8', $exts>, 
                                                             '13', '0', $certificate_extensions>, 
                                                            '11', '0', pk(~ltkS)>)
                                                        >,
                                                        ~ltkS)
                                                  >)
                                               >)
                                         >)
                                      >,
                                      '32')
                    ) ▶₀ #l )
        qed
      qed
    next
      case server_auth_case_05
      solve( (∃ #j.2.
               (!KU( Extract('0', Extract(p_gxy, Extract(~res_psk, '0'))) ) @ #j.2)
              ∧
               #j.2 < #j.1)  ∥
             ((∀ #k.
                (!KU( Extract('0', Extract(p_gxy, Extract(~res_psk, '0'))) ) @ #k)
               ⇒
                ¬(#k < #j.1)) ∧
              (∃ actor #l.
                (RevealPSK( actor,
                            Expand(Extract('0', Extract(p_gxy, Extract(~res_psk, '0'))),
                                   <'clientats', 
                                    h(<
                                       <
                                        <
                                         <
                                          <
                                           <
                                            <<p_messages, '6', '0x0303', '40', $p_g>, '1', '0x0303', p_nc, 
                                             '0', $cipher_suites, '0', <'43', '0x0304'>, <'10', $g1, $g2>, 
                                             <'40', $p_g, p_gx>, <'45', '0', '1'>, p_edi, '41', 
                                             <~ticket, mask(x, x.1)>, 
                                             hmac(<
                                                   Expand(Expand(Extract(~res_psk, '0'), <'ext', 'pbk'>,
                                                                 '32'),
                                                          <'0', '0'>, '32'), 
                                                   h(<<p_messages, '6', '0x0303', '40', $p_g>, '1', '0x0303', 
                                                      p_nc, '0', $cipher_suites, '0', <'43', '0x0304'>, 
                                                      <'10', $g1, $g2>, <'40', $p_g, p_gx>, <'45', '0', '1'>, 
                                                      p_edi, '41', <~ticket, mask(x, x.1)>, '0'>)
                                                  >)
                                            >, 
                                            '2', '0x0303', ~ns, $cipher_suite, <'13', $sig_algs>, '40', $p_g, 
                                            $p_g^~y>, 
                                           '8', $exts>, 
                                          '13', '0', $certificate_extensions>, 
                                         '11', '0', pk(~ltkS)>, 
                                        '15', 
                                        sign(<'server_cv', 
                                              h(<
                                                 <
                                                  <
                                                   <
                                                    <<p_messages, '6', '0x0303', '40', $p_g>, '1', '0x0303', 
                                                     p_nc, '0', $cipher_suites, '0', <'43', '0x0304'>, 
                                                     <'10', $g1, $g2>, <'40', $p_g, p_gx>, <'45', '0', '1'>, 
                                                     p_edi, '41', <~ticket, mask(x, x.1)>, 
                                                     hmac(<
                                                           Expand(Expand(Extract(~res_psk, '0'),
                                                                         <'ext', 'pbk'>, '32'),
                                                                  <'0', '0'>, '32'), 
                                                           h(<<p_messages, '6', '0x0303', '40', $p_g>, '1', 
                                                              '0x0303', p_nc, '0', $cipher_suites, '0', 
                                                              <'43', '0x0304'>, <'10', $g1, $g2>, 
                                                              <'40', $p_g, p_gx>, <'45', '0', '1'>, p_edi, 
                                                              '41', <~ticket, mask(x, x.1)>, '0'>)
                                                          >)
                                                    >, 
                                                    '2', '0x0303', ~ns, $cipher_suite, <'13', $sig_algs>, 
                                                    '40', $p_g, $p_g^~y>, 
                                                   '8', $exts>, 
                                                  '13', '0', $certificate_extensions>, 
                                                 '11', '0', pk(~ltkS)>)
                                             >,
                                             ~ltkS)
                                       >, 
                                       '20', 
                                       hmac(<
                                             Expand(Expand(Extract(p_gxy, Extract(~res_psk, '0')),
                                                           <'serverhts', 
                                                            h(<
                                                               <
                                                                <
                                                                 <
                                                                  <
                                                                   <<p_messages, '6', '0x0303', '40', $p_g>, 
                                                                    '1', '0x0303', p_nc, '0', $cipher_suites, 
                                                                    '0', <'43', '0x0304'>, <'10', $g1, $g2>, 
                                                                    <'40', $p_g, p_gx>, <'45', '0', '1'>, 
                                                                    p_edi, '41', <~ticket, mask(x, x.1)>, 
                                                                    hmac(<
                                                                          Expand(Expand(Extract(~res_psk,
                                                                                                '0'),
                                                                                        <'ext', 'pbk'>, '32'),
                                                                                 <'0', '0'>, '32'), 
                                                                          h(<
                                                                             <p_messages, '6', '0x0303', 
                                                                              '40', $p_g>, 
                                                                             '1', '0x0303', p_nc, '0', 
                                                                             $cipher_suites, '0', 
                                                                             <'43', '0x0304'>, 
                                                                             <'10', $g1, $g2>, 
                                                                             <'40', $p_g, p_gx>, 
                                                                             <'45', '0', '1'>, p_edi, '41', 
                                                                             <~ticket, mask(x, x.1)>, '0'>)
                                                                         >)
                                                                   >, 
                                                                   '2', '0x0303', ~ns, $cipher_suite, 
                                                                   <'13', $sig_algs>, '40', $p_g, $p_g^~y>, 
                                                                  '8', $exts>, 
                                                                 '13', '0', $certificate_extensions>, 
                                                                '11', '0', pk(~ltkS)>, 
                                                               '15', 
                                                               sign(<'server_cv', 
                                                                     h(<
                                                                        <
                                                                         <
                                                                          <
                                                                           <
                                                                            <p_messages, '6', '0x0303', '40', 
                                                                             $p_g>, 
                                                                            '1', '0x0303', p_nc, '0', 
                                                                            $cipher_suites, '0', 
                                                                            <'43', '0x0304'>, 
                                                                            <'10', $g1, $g2>, 
                                                                            <'40', $p_g, p_gx>, 
                                                                            <'45', '0', '1'>, p_edi, '41', 
                                                                            <~ticket, mask(x, x.1)>, 
                                                                            hmac(<
                                                                                  Expand(Expand(Extract(~res_psk,
                                                                                                        '0'),
                                                                                                <'ext', 'pbk'
                                                                                                >,
                                                                                                '32'),
                                                                                         <'0', '0'>, '32'), 
                                                                                  h(<
                                                                                     <p_messages, '6', 
                                                                                      '0x0303', '40', $p_g>, 
                                                                                     '1', '0x0303', p_nc, 
                                                                                     '0', $cipher_suites, 
                                                                                     '0', <'43', '0x0304'>, 
                                                                                     <'10', $g1, $g2>, 
                                                                                     <'40', $p_g, p_gx>, 
                                                                                     <'45', '0', '1'>, p_edi, 
                                                                                     '41', 
                                                                                     <~ticket, mask(x, x.1)>, 
                                                                                     '0'>)
                                                                                 >)
                                                                           >, 
                                                                           '2', '0x0303', ~ns, $cipher_suite, 
                                                                           <'13', $sig_algs>, '40', $p_g, 
                                                                           $p_g^~y>, 
                                                                          '8', $exts>, 
                                                                         '13', '0', $certificate_extensions>, 
                                                                        '11', '0', pk(~ltkS)>)
                                                                    >,
                                                                    ~ltkS)
                                                              >)
                                                           >,
                                                           '32'),
                                                    <'fin', '0'>, '32'), 
                                             h(<
                                                <
                                                 <
                                                  <
                                                   <
                                                    <<p_messages, '6', '0x0303', '40', $p_g>, '1', '0x0303', 
                                                     p_nc, '0', $cipher_suites, '0', <'43', '0x0304'>, 
                                                     <'10', $g1, $g2>, <'40', $p_g, p_gx>, <'45', '0', '1'>, 
                                                     p_edi, '41', <~ticket, mask(x, x.1)>, 
                                                     hmac(<
                                                           Expand(Expand(Extract(~res_psk, '0'),
                                                                         <'ext', 'pbk'>, '32'),
                                                                  <'0', '0'>, '32'), 
                                                           h(<<p_messages, '6', '0x0303', '40', $p_g>, '1', 
                                                              '0x0303', p_nc, '0', $cipher_suites, '0', 
                                                              <'43', '0x0304'>, <'10', $g1, $g2>, 
                                                              <'40', $p_g, p_gx>, <'45', '0', '1'>, p_edi, 
                                                              '41', <~ticket, mask(x, x.1)>, '0'>)
                                                          >)
                                                    >, 
                                                    '2', '0x0303', ~ns, $cipher_suite, <'13', $sig_algs>, 
                                                    '40', $p_g, $p_g^~y>, 
                                                   '8', $exts>, 
                                                  '13', '0', $certificate_extensions>, 
                                                 '11', '0', pk(~ltkS)>, 
                                                '15', 
                                                sign(<'server_cv', 
                                                      h(<
                                                         <
                                                          <
                                                           <
                                                            <<p_messages, '6', '0x0303', '40', $p_g>, '1', 
                                                             '0x0303', p_nc, '0', $cipher_suites, '0', 
                                                             <'43', '0x0304'>, <'10', $g1, $g2>, 
                                                             <'40', $p_g, p_gx>, <'45', '0', '1'>, p_edi, 
                                                             '41', <~ticket, mask(x, x.1)>, 
                                                             hmac(<
                                                                   Expand(Expand(Extract(~res_psk, '0'),
                                                                                 <'ext', 'pbk'>, '32'),
                                                                          <'0', '0'>, '32'), 
                                                                   h(<
                                                                      <p_messages, '6', '0x0303', '40', $p_g
                                                                      >, 
                                                                      '1', '0x0303', p_nc, '0', 
                                                                      $cipher_suites, '0', <'43', '0x0304'>, 
                                                                      <'10', $g1, $g2>, <'40', $p_g, p_gx>, 
                                                                      <'45', '0', '1'>, p_edi, '41', 
                                                                      <~ticket, mask(x, x.1)>, '0'>)
                                                                  >)
                                                            >, 
                                                            '2', '0x0303', ~ns, $cipher_suite, 
                                                            <'13', $sig_algs>, '40', $p_g, $p_g^~y>, 
                                                           '8', $exts>, 
                                                          '13', '0', $certificate_extensions>, 
                                                         '11', '0', pk(~ltkS)>)
                                                     >,
                                                     ~ltkS)
                                               >)
                                            >)
                                      >)
                                   >,
                                   '32')
                 ) @ #l)
               ∧
                #l < #j.1)) )
        case case_1
        solve( (∃ #r. (RevLtk( $C ) @ #r) ∧ #r < #i)  ∥
               (∃ tid3 x #r. (RevDHExp( tid3, $C, x ) @ #r) ∧ #r < #i)  ∥
               (∃ tid4 y #r. (RevDHExp( tid4, $S, y ) @ #r) ∧ #r < #i)  ∥
               (∃ rms #r. (RevealPSK( $S, rms ) @ #r) ∧ #r < #k.1)  ∥
               (∃ rms #r. (RevealPSK( $C, rms ) @ #r) ∧ #r < #k.1) )
          case case_1
          by contradiction /* from formulas */
        next
          case case_2
          by contradiction /* from formulas */
        next
          case case_3
          by contradiction /* from formulas */
        next
          case case_4
          solve( (∃ #r. (RevLtk( $C ) @ #r) ∧ #r < #i)  ∥
                 (∃ tid3 x #r. (RevDHExp( tid3, $C, x ) @ #r) ∧ #r < #i)  ∥
                 (∃ tid4 y #r. (RevDHExp( tid4, $S, y ) @ #r) ∧ #r < #i)  ∥
                 (∃ rms #r. (RevealPSK( $S, rms ) @ #r) ∧ #r < #i)  ∥
                 (∃ rms #r. (RevealPSK( $C, rms ) @ #r) ∧ #r < #i) )
            case case_1
            by contradiction /* from formulas */
          next
            case case_2
            by contradiction /* from formulas */
          next
            case case_3
            by contradiction /* from formulas */
          next
            case case_4
            by contradiction /* from formulas */
          next
            case case_5
            by contradiction /* from formulas */
          qed
        next
          case case_5
          solve( (∃ #r. (RevLtk( $C ) @ #r) ∧ #r < #i)  ∥
                 (∃ tid3 x #r. (RevDHExp( tid3, $C, x ) @ #r) ∧ #r < #i)  ∥
                 (∃ tid4 y #r. (RevDHExp( tid4, $S, y ) @ #r) ∧ #r < #i)  ∥
                 (∃ rms #r. (RevealPSK( $S, rms ) @ #r) ∧ #r < #i)  ∥
                 (∃ rms #r. (RevealPSK( $C, rms ) @ #r) ∧ #r < #i) )
            case case_1
            by contradiction /* from formulas */
          next
            case case_2
            by contradiction /* from formulas */
          next
            case case_3
            by contradiction /* from formulas */
          next
            case case_4
            by contradiction /* from formulas */
          next
            case case_5
            by contradiction /* from formulas */
          qed
        qed
      next
        case case_2
        solve( !Pk( $C, pk(~ltkC) ) ▶₁ #i )
          case Register_pk
          by solve( SecretPSK( $A,
                               Expand(Extract('0', Extract(p_gxy, Extract(~res_psk, '0'))),
                                      <'clientats', 
                                       h(<
                                          <
                                           <
                                            <
                                             <
                                              <
                                               <<p_messages, '6', '0x0303', '40', $p_g>, '1', '0x0303', p_nc, 
                                                '0', $cipher_suites, '0', <'43', '0x0304'>, <'10', $g1, $g2>, 
                                                <'40', $p_g, p_gx>, <'45', '0', '1'>, p_edi, '41', 
                                                <~ticket, mask(x, x.1)>, 
                                                hmac(<
                                                      Expand(Expand(Extract(~res_psk, '0'), <'ext', 'pbk'>,
                                                                    '32'),
                                                             <'0', '0'>, '32'), 
                                                      h(<<p_messages, '6', '0x0303', '40', $p_g>, '1', 
                                                         '0x0303', p_nc, '0', $cipher_suites, '0', 
                                                         <'43', '0x0304'>, <'10', $g1, $g2>, 
                                                         <'40', $p_g, p_gx>, <'45', '0', '1'>, p_edi, '41', 
                                                         <~ticket, mask(x, x.1)>, '0'>)
                                                     >)
                                               >, 
                                               '2', '0x0303', ~ns, $cipher_suite, <'13', $sig_algs>, '40', 
                                               $p_g, $p_g^~y>, 
                                              '8', $exts>, 
                                             '13', '0', $certificate_extensions>, 
                                            '11', '0', pk(~ltkS)>, 
                                           '15', 
                                           sign(<'server_cv', 
                                                 h(<
                                                    <
                                                     <
                                                      <
                                                       <<p_messages, '6', '0x0303', '40', $p_g>, '1', 
                                                        '0x0303', p_nc, '0', $cipher_suites, '0', 
                                                        <'43', '0x0304'>, <'10', $g1, $g2>, 
                                                        <'40', $p_g, p_gx>, <'45', '0', '1'>, p_edi, '41', 
                                                        <~ticket, mask(x, x.1)>, 
                                                        hmac(<
                                                              Expand(Expand(Extract(~res_psk, '0'),
                                                                            <'ext', 'pbk'>, '32'),
                                                                     <'0', '0'>, '32'), 
                                                              h(<<p_messages, '6', '0x0303', '40', $p_g>, 
                                                                 '1', '0x0303', p_nc, '0', $cipher_suites, 
                                                                 '0', <'43', '0x0304'>, <'10', $g1, $g2>, 
                                                                 <'40', $p_g, p_gx>, <'45', '0', '1'>, p_edi, 
                                                                 '41', <~ticket, mask(x, x.1)>, '0'>)
                                                             >)
                                                       >, 
                                                       '2', '0x0303', ~ns, $cipher_suite, <'13', $sig_algs>, 
                                                       '40', $p_g, $p_g^~y>, 
                                                      '8', $exts>, 
                                                     '13', '0', $certificate_extensions>, 
                                                    '11', '0', pk(~ltkS)>)
                                                >,
                                                ~ltkS)
                                          >, 
                                          '20', 
                                          hmac(<
                                                Expand(Expand(Extract(p_gxy, Extract(~res_psk, '0')),
                                                              <'serverhts', 
                                                               h(<
                                                                  <
                                                                   <
                                                                    <
                                                                     <
                                                                      <
                                                                       <p_messages, '6', '0x0303', '40', $p_g
                                                                       >, 
                                                                       '1', '0x0303', p_nc, '0', 
                                                                       $cipher_suites, '0', <'43', '0x0304'>, 
                                                                       <'10', $g1, $g2>, <'40', $p_g, p_gx>, 
                                                                       <'45', '0', '1'>, p_edi, '41', 
                                                                       <~ticket, mask(x, x.1)>, 
                                                                       hmac(<
                                                                             Expand(Expand(Extract(~res_psk,
                                                                                                   '0'),
                                                                                           <'ext', 'pbk'>,
                                                                                           '32'),
                                                                                    <'0', '0'>, '32'), 
                                                                             h(<
                                                                                <p_messages, '6', '0x0303', 
                                                                                 '40', $p_g>, 
                                                                                '1', '0x0303', p_nc, '0', 
                                                                                $cipher_suites, '0', 
                                                                                <'43', '0x0304'>, 
                                                                                <'10', $g1, $g2>, 
                                                                                <'40', $p_g, p_gx>, 
                                                                                <'45', '0', '1'>, p_edi, 
                                                                                '41', 
                                                                                <~ticket, mask(x, x.1)>, '0'>)
                                                                            >)
                                                                      >, 
                                                                      '2', '0x0303', ~ns, $cipher_suite, 
                                                                      <'13', $sig_algs>, '40', $p_g, $p_g^~y
                                                                     >, 
                                                                     '8', $exts>, 
                                                                    '13', '0', $certificate_extensions>, 
                                                                   '11', '0', pk(~ltkS)>, 
                                                                  '15', 
                                                                  sign(<'server_cv', 
                                                                        h(<
                                                                           <
                                                                            <
                                                                             <
                                                                              <
                                                                               <p_messages, '6', '0x0303', 
                                                                                '40', $p_g>, 
                                                                               '1', '0x0303', p_nc, '0', 
                                                                               $cipher_suites, '0', 
                                                                               <'43', '0x0304'>, 
                                                                               <'10', $g1, $g2>, 
                                                                               <'40', $p_g, p_gx>, 
                                                                               <'45', '0', '1'>, p_edi, '41', 
                                                                               <~ticket, mask(x, x.1)>, 
                                                                               hmac(<
                                                                                     Expand(Expand(Extract(~res_psk,
                                                                                                           '0'),
                                                                                                   <'ext', 
                                                                                                    'pbk'>,
                                                                                                   '32'),
                                                                                            <'0', '0'>,
                                                                                            '32'), 
                                                                                     h(<
                                                                                        <p_messages, '6', 
                                                                                         '0x0303', '40', $p_g
                                                                                        >, 
                                                                                        '1', '0x0303', p_nc, 
                                                                                        '0', $cipher_suites, 
                                                                                        '0', 
                                                                                        <'43', '0x0304'>, 
                                                                                        <'10', $g1, $g2>, 
                                                                                        <'40', $p_g, p_gx>, 
                                                                                        <'45', '0', '1'>, 
                                                                                        p_edi, '41', 
                                                                                        <~ticket, mask(x, x.1)
                                                                                        >, 
                                                                                        '0'>)
                                                                                    >)
                                                                              >, 
                                                                              '2', '0x0303', ~ns, 
                                                                              $cipher_suite, 
                                                                              <'13', $sig_algs>, '40', $p_g, 
                                                                              $p_g^~y>, 
                                                                             '8', $exts>, 
                                                                            '13', '0', $certificate_extensions
                                                                           >, 
                                                                           '11', '0', pk(~ltkS)>)
                                                                       >,
                                                                       ~ltkS)
                                                                 >)
                                                              >,
                                                              '32'),
                                                       <'fin', '0'>, '32'), 
                                                h(<
                                                   <
                                                    <
                                                     <
                                                      <
                                                       <<p_messages, '6', '0x0303', '40', $p_g>, '1', 
                                                        '0x0303', p_nc, '0', $cipher_suites, '0', 
                                                        <'43', '0x0304'>, <'10', $g1, $g2>, 
                                                        <'40', $p_g, p_gx>, <'45', '0', '1'>, p_edi, '41', 
                                                        <~ticket, mask(x, x.1)>, 
                                                        hmac(<
                                                              Expand(Expand(Extract(~res_psk, '0'),
                                                                            <'ext', 'pbk'>, '32'),
                                                                     <'0', '0'>, '32'), 
                                                              h(<<p_messages, '6', '0x0303', '40', $p_g>, 
                                                                 '1', '0x0303', p_nc, '0', $cipher_suites, 
                                                                 '0', <'43', '0x0304'>, <'10', $g1, $g2>, 
                                                                 <'40', $p_g, p_gx>, <'45', '0', '1'>, p_edi, 
                                                                 '41', <~ticket, mask(x, x.1)>, '0'>)
                                                             >)
                                                       >, 
                                                       '2', '0x0303', ~ns, $cipher_suite, <'13', $sig_algs>, 
                                                       '40', $p_g, $p_g^~y>, 
                                                      '8', $exts>, 
                                                     '13', '0', $certificate_extensions>, 
                                                    '11', '0', pk(~ltkS)>, 
                                                   '15', 
                                                   sign(<'server_cv', 
                                                         h(<
                                                            <
                                                             <
                                                              <
                                                               <<p_messages, '6', '0x0303', '40', $p_g>, '1', 
                                                                '0x0303', p_nc, '0', $cipher_suites, '0', 
                                                                <'43', '0x0304'>, <'10', $g1, $g2>, 
                                                                <'40', $p_g, p_gx>, <'45', '0', '1'>, p_edi, 
                                                                '41', <~ticket, mask(x, x.1)>, 
                                                                hmac(<
                                                                      Expand(Expand(Extract(~res_psk, '0'),
                                                                                    <'ext', 'pbk'>, '32'),
                                                                             <'0', '0'>, '32'), 
                                                                      h(<
                                                                         <p_messages, '6', '0x0303', '40', 
                                                                          $p_g>, 
                                                                         '1', '0x0303', p_nc, '0', 
                                                                         $cipher_suites, '0', 
                                                                         <'43', '0x0304'>, <'10', $g1, $g2>, 
                                                                         <'40', $p_g, p_gx>, 
                                                                         <'45', '0', '1'>, p_edi, '41', 
                                                                         <~ticket, mask(x, x.1)>, '0'>)
                                                                     >)
                                                               >, 
                                                               '2', '0x0303', ~ns, $cipher_suite, 
                                                               <'13', $sig_algs>, '40', $p_g, $p_g^~y>, 
                                                              '8', $exts>, 
                                                             '13', '0', $certificate_extensions>, 
                                                            '11', '0', pk(~ltkS)>)
                                                        >,
                                                        ~ltkS)
                                                  >)
                                               >)
                                         >)
                                      >,
                                      '32')
                    ) ▶₀ #l )
        qed
      qed
    next
      case server_auth_case_06
      solve( (∃ #j.2.
               (!KU( Extract('0',
                             Extract(p_gxy, Extract(Expand(ms, <'rms', h(messages)>, '32'), '0')))
                ) @ #j.2)
              ∧
               #j.2 < #j.1)  ∥
             ((∀ #k.
                (!KU( Extract('0',
                              Extract(p_gxy, Extract(Expand(ms, <'rms', h(messages)>, '32'), '0')))
                 ) @ #k)
               ⇒
                ¬(#k < #j.1)) ∧
              (∃ actor #l.
                (RevealPSK( actor,
                            Expand(Extract('0',
                                           Extract(p_gxy,
                                                   Extract(Expand(ms, <'rms', h(messages)>, '32'), '0'))),
                                   <'clientats', 
                                    h(<
                                       <
                                        <
                                         <
                                          <
                                           <
                                            <<p_messages, '6', '0x0303', '40', $p_g>, '1', '0x0303', p_nc, 
                                             '0', $cipher_suites, '0', <'43', '0x0304'>, <'10', $g1, $g2>, 
                                             <'40', $p_g, p_gx>, <'45', '0', '1'>, p_edi, '41', 
                                             <~ticket, mask(x, x.1)>, 
                                             hmac(<
                                                   Expand(Expand(Extract(Expand(ms, <'rms', h(messages)>,
                                                                                '32'),
                                                                         '0'),
                                                                 <'res', 'pbk'>, '32'),
                                                          <'0', '0'>, '32'), 
                                                   h(<<p_messages, '6', '0x0303', '40', $p_g>, '1', '0x0303', 
                                                      p_nc, '0', $cipher_suites, '0', <'43', '0x0304'>, 
                                                      <'10', $g1, $g2>, <'40', $p_g, p_gx>, <'45', '0', '1'>, 
                                                      p_edi, '41', <~ticket, mask(x, x.1)>, '0'>)
                                                  >)
                                            >, 
                                            '2', '0x0303', ~ns, $cipher_suite, <'13', $sig_algs>, '40', $p_g, 
                                            $p_g^~y>, 
                                           '8', $exts>, 
                                          '13', '0', $certificate_extensions>, 
                                         '11', '0', pk(~ltkS)>, 
                                        '15', 
                                        sign(<'server_cv', 
                                              h(<
                                                 <
                                                  <
                                                   <
                                                    <<p_messages, '6', '0x0303', '40', $p_g>, '1', '0x0303', 
                                                     p_nc, '0', $cipher_suites, '0', <'43', '0x0304'>, 
                                                     <'10', $g1, $g2>, <'40', $p_g, p_gx>, <'45', '0', '1'>, 
                                                     p_edi, '41', <~ticket, mask(x, x.1)>, 
                                                     hmac(<
                                                           Expand(Expand(Extract(Expand(ms,
                                                                                        <'rms', h(messages)>,
                                                                                        '32'),
                                                                                 '0'),
                                                                         <'res', 'pbk'>, '32'),
                                                                  <'0', '0'>, '32'), 
                                                           h(<<p_messages, '6', '0x0303', '40', $p_g>, '1', 
                                                              '0x0303', p_nc, '0', $cipher_suites, '0', 
                                                              <'43', '0x0304'>, <'10', $g1, $g2>, 
                                                              <'40', $p_g, p_gx>, <'45', '0', '1'>, p_edi, 
                                                              '41', <~ticket, mask(x, x.1)>, '0'>)
                                                          >)
                                                    >, 
                                                    '2', '0x0303', ~ns, $cipher_suite, <'13', $sig_algs>, 
                                                    '40', $p_g, $p_g^~y>, 
                                                   '8', $exts>, 
                                                  '13', '0', $certificate_extensions>, 
                                                 '11', '0', pk(~ltkS)>)
                                             >,
                                             ~ltkS)
                                       >, 
                                       '20', 
                                       hmac(<
                                             Expand(Expand(Extract(p_gxy,
                                                                   Extract(Expand(ms, <'rms', h(messages)>,
                                                                                  '32'),
                                                                           '0')),
                                                           <'serverhts', 
                                                            h(<
                                                               <
                                                                <
                                                                 <
                                                                  <
                                                                   <<p_messages, '6', '0x0303', '40', $p_g>, 
                                                                    '1', '0x0303', p_nc, '0', $cipher_suites, 
                                                                    '0', <'43', '0x0304'>, <'10', $g1, $g2>, 
                                                                    <'40', $p_g, p_gx>, <'45', '0', '1'>, 
                                                                    p_edi, '41', <~ticket, mask(x, x.1)>, 
                                                                    hmac(<
                                                                          Expand(Expand(Extract(Expand(ms,
                                                                                                       <
                                                                                                        'rms', 
                                                                                                        h(messages)
                                                                                                       >,
                                                                                                       '32'),
                                                                                                '0'),
                                                                                        <'res', 'pbk'>, '32'),
                                                                                 <'0', '0'>, '32'), 
                                                                          h(<
                                                                             <p_messages, '6', '0x0303', 
                                                                              '40', $p_g>, 
                                                                             '1', '0x0303', p_nc, '0', 
                                                                             $cipher_suites, '0', 
                                                                             <'43', '0x0304'>, 
                                                                             <'10', $g1, $g2>, 
                                                                             <'40', $p_g, p_gx>, 
                                                                             <'45', '0', '1'>, p_edi, '41', 
                                                                             <~ticket, mask(x, x.1)>, '0'>)
                                                                         >)
                                                                   >, 
                                                                   '2', '0x0303', ~ns, $cipher_suite, 
                                                                   <'13', $sig_algs>, '40', $p_g, $p_g^~y>, 
                                                                  '8', $exts>, 
                                                                 '13', '0', $certificate_extensions>, 
                                                                '11', '0', pk(~ltkS)>, 
                                                               '15', 
                                                               sign(<'server_cv', 
                                                                     h(<
                                                                        <
                                                                         <
                                                                          <
                                                                           <
                                                                            <p_messages, '6', '0x0303', '40', 
                                                                             $p_g>, 
                                                                            '1', '0x0303', p_nc, '0', 
                                                                            $cipher_suites, '0', 
                                                                            <'43', '0x0304'>, 
                                                                            <'10', $g1, $g2>, 
                                                                            <'40', $p_g, p_gx>, 
                                                                            <'45', '0', '1'>, p_edi, '41', 
                                                                            <~ticket, mask(x, x.1)>, 
                                                                            hmac(<
                                                                                  Expand(Expand(Extract(Expand(ms,
                                                                                                               <
                                                                                                                'rms', 
                                                                                                                h(messages)
                                                                                                               >,
                                                                                                               '32'),
                                                                                                        '0'),
                                                                                                <'res', 'pbk'
                                                                                                >,
                                                                                                '32'),
                                                                                         <'0', '0'>, '32'), 
                                                                                  h(<
                                                                                     <p_messages, '6', 
                                                                                      '0x0303', '40', $p_g>, 
                                                                                     '1', '0x0303', p_nc, 
                                                                                     '0', $cipher_suites, 
                                                                                     '0', <'43', '0x0304'>, 
                                                                                     <'10', $g1, $g2>, 
                                                                                     <'40', $p_g, p_gx>, 
                                                                                     <'45', '0', '1'>, p_edi, 
                                                                                     '41', 
                                                                                     <~ticket, mask(x, x.1)>, 
                                                                                     '0'>)
                                                                                 >)
                                                                           >, 
                                                                           '2', '0x0303', ~ns, $cipher_suite, 
                                                                           <'13', $sig_algs>, '40', $p_g, 
                                                                           $p_g^~y>, 
                                                                          '8', $exts>, 
                                                                         '13', '0', $certificate_extensions>, 
                                                                        '11', '0', pk(~ltkS)>)
                                                                    >,
                                                                    ~ltkS)
                                                              >)
                                                           >,
                                                           '32'),
                                                    <'fin', '0'>, '32'), 
                                             h(<
                                                <
                                                 <
                                                  <
                                                   <
                                                    <<p_messages, '6', '0x0303', '40', $p_g>, '1', '0x0303', 
                                                     p_nc, '0', $cipher_suites, '0', <'43', '0x0304'>, 
                                                     <'10', $g1, $g2>, <'40', $p_g, p_gx>, <'45', '0', '1'>, 
                                                     p_edi, '41', <~ticket, mask(x, x.1)>, 
                                                     hmac(<
                                                           Expand(Expand(Extract(Expand(ms,
                                                                                        <'rms', h(messages)>,
                                                                                        '32'),
                                                                                 '0'),
                                                                         <'res', 'pbk'>, '32'),
                                                                  <'0', '0'>, '32'), 
                                                           h(<<p_messages, '6', '0x0303', '40', $p_g>, '1', 
                                                              '0x0303', p_nc, '0', $cipher_suites, '0', 
                                                              <'43', '0x0304'>, <'10', $g1, $g2>, 
                                                              <'40', $p_g, p_gx>, <'45', '0', '1'>, p_edi, 
                                                              '41', <~ticket, mask(x, x.1)>, '0'>)
                                                          >)
                                                    >, 
                                                    '2', '0x0303', ~ns, $cipher_suite, <'13', $sig_algs>, 
                                                    '40', $p_g, $p_g^~y>, 
                                                   '8', $exts>, 
                                                  '13', '0', $certificate_extensions>, 
                                                 '11', '0', pk(~ltkS)>, 
                                                '15', 
                                                sign(<'server_cv', 
                                                      h(<
                                                         <
                                                          <
                                                           <
                                                            <<p_messages, '6', '0x0303', '40', $p_g>, '1', 
                                                             '0x0303', p_nc, '0', $cipher_suites, '0', 
                                                             <'43', '0x0304'>, <'10', $g1, $g2>, 
                                                             <'40', $p_g, p_gx>, <'45', '0', '1'>, p_edi, 
                                                             '41', <~ticket, mask(x, x.1)>, 
                                                             hmac(<
                                                                   Expand(Expand(Extract(Expand(ms,
                                                                                                <'rms', 
                                                                                                 h(messages)>,
                                                                                                '32'),
                                                                                         '0'),
                                                                                 <'res', 'pbk'>, '32'),
                                                                          <'0', '0'>, '32'), 
                                                                   h(<
                                                                      <p_messages, '6', '0x0303', '40', $p_g
                                                                      >, 
                                                                      '1', '0x0303', p_nc, '0', 
                                                                      $cipher_suites, '0', <'43', '0x0304'>, 
                                                                      <'10', $g1, $g2>, <'40', $p_g, p_gx>, 
                                                                      <'45', '0', '1'>, p_edi, '41', 
                                                                      <~ticket, mask(x, x.1)>, '0'>)
                                                                  >)
                                                            >, 
                                                            '2', '0x0303', ~ns, $cipher_suite, 
                                                            <'13', $sig_algs>, '40', $p_g, $p_g^~y>, 
                                                           '8', $exts>, 
                                                          '13', '0', $certificate_extensions>, 
                                                         '11', '0', pk(~ltkS)>)
                                                     >,
                                                     ~ltkS)
                                               >)
                                            >)
                                      >)
                                   >,
                                   '32')
                 ) @ #l)
               ∧
                #l < #j.1)) )
        case case_1
        solve( (∃ #r. (RevLtk( $C ) @ #r) ∧ #r < #i)  ∥
               (∃ tid3 x #r. (RevDHExp( tid3, $C, x ) @ #r) ∧ #r < #i)  ∥
               (∃ tid4 y #r. (RevDHExp( tid4, $S, y ) @ #r) ∧ #r < #i)  ∥
               (∃ rms #r. (RevealPSK( $S, rms ) @ #r) ∧ #r < #k.1)  ∥
               (∃ rms #r. (RevealPSK( $C, rms ) @ #r) ∧ #r < #k.1) )
          case case_1
          by contradiction /* from formulas */
        next
          case case_2
          by contradiction /* from formulas */
        next
          case case_3
          by contradiction /* from formulas */
        next
          case case_4
          solve( (∃ #r. (RevLtk( $C ) @ #r) ∧ #r < #i)  ∥
                 (∃ tid3 x #r. (RevDHExp( tid3, $C, x ) @ #r) ∧ #r < #i)  ∥
                 (∃ tid4 y #r. (RevDHExp( tid4, $S, y ) @ #r) ∧ #r < #i)  ∥
                 (∃ rms #r. (RevealPSK( $S, rms ) @ #r) ∧ #r < #i)  ∥
                 (∃ rms #r. (RevealPSK( $C, rms ) @ #r) ∧ #r < #i) )
            case case_1
            by contradiction /* from formulas */
          next
            case case_2
            by contradiction /* from formulas */
          next
            case case_3
            by contradiction /* from formulas */
          next
            case case_4
            by contradiction /* from formulas */
          next
            case case_5
            by contradiction /* from formulas */
          qed
        next
          case case_5
          solve( (∃ #r. (RevLtk( $C ) @ #r) ∧ #r < #i)  ∥
                 (∃ tid3 x #r. (RevDHExp( tid3, $C, x ) @ #r) ∧ #r < #i)  ∥
                 (∃ tid4 y #r. (RevDHExp( tid4, $S, y ) @ #r) ∧ #r < #i)  ∥
                 (∃ rms #r. (RevealPSK( $S, rms ) @ #r) ∧ #r < #i)  ∥
                 (∃ rms #r. (RevealPSK( $C, rms ) @ #r) ∧ #r < #i) )
            case case_1
            by contradiction /* from formulas */
          next
            case case_2
            by contradiction /* from formulas */
          next
            case case_3
            by contradiction /* from formulas */
          next
            case case_4
            by contradiction /* from formulas */
          next
            case case_5
            by contradiction /* from formulas */
          qed
        qed
      next
        case case_2
        solve( !Pk( $C, pk(~ltkC) ) ▶₁ #i )
          case Register_pk
          by solve( SecretPSK( $A,
                               Expand(Extract('0',
                                              Extract(p_gxy,
                                                      Extract(Expand(ms, <'rms', h(messages)>, '32'), '0'))),
                                      <'clientats', 
                                       h(<
                                          <
                                           <
                                            <
                                             <
                                              <
                                               <<p_messages, '6', '0x0303', '40', $p_g>, '1', '0x0303', p_nc, 
                                                '0', $cipher_suites, '0', <'43', '0x0304'>, <'10', $g1, $g2>, 
                                                <'40', $p_g, p_gx>, <'45', '0', '1'>, p_edi, '41', 
                                                <~ticket, mask(x, x.1)>, 
                                                hmac(<
                                                      Expand(Expand(Extract(Expand(ms, <'rms', h(messages)>,
                                                                                   '32'),
                                                                            '0'),
                                                                    <'res', 'pbk'>, '32'),
                                                             <'0', '0'>, '32'), 
                                                      h(<<p_messages, '6', '0x0303', '40', $p_g>, '1', 
                                                         '0x0303', p_nc, '0', $cipher_suites, '0', 
                                                         <'43', '0x0304'>, <'10', $g1, $g2>, 
                                                         <'40', $p_g, p_gx>, <'45', '0', '1'>, p_edi, '41', 
                                                         <~ticket, mask(x, x.1)>, '0'>)
                                                     >)
                                               >, 
                                               '2', '0x0303', ~ns, $cipher_suite, <'13', $sig_algs>, '40', 
                                               $p_g, $p_g^~y>, 
                                              '8', $exts>, 
                                             '13', '0', $certificate_extensions>, 
                                            '11', '0', pk(~ltkS)>, 
                                           '15', 
                                           sign(<'server_cv', 
                                                 h(<
                                                    <
                                                     <
                                                      <
                                                       <<p_messages, '6', '0x0303', '40', $p_g>, '1', 
                                                        '0x0303', p_nc, '0', $cipher_suites, '0', 
                                                        <'43', '0x0304'>, <'10', $g1, $g2>, 
                                                        <'40', $p_g, p_gx>, <'45', '0', '1'>, p_edi, '41', 
                                                        <~ticket, mask(x, x.1)>, 
                                                        hmac(<
                                                              Expand(Expand(Extract(Expand(ms,
                                                                                           <'rms', h(messages)
                                                                                           >,
                                                                                           '32'),
                                                                                    '0'),
                                                                            <'res', 'pbk'>, '32'),
                                                                     <'0', '0'>, '32'), 
                                                              h(<<p_messages, '6', '0x0303', '40', $p_g>, 
                                                                 '1', '0x0303', p_nc, '0', $cipher_suites, 
                                                                 '0', <'43', '0x0304'>, <'10', $g1, $g2>, 
                                                                 <'40', $p_g, p_gx>, <'45', '0', '1'>, p_edi, 
                                                                 '41', <~ticket, mask(x, x.1)>, '0'>)
                                                             >)
                                                       >, 
                                                       '2', '0x0303', ~ns, $cipher_suite, <'13', $sig_algs>, 
                                                       '40', $p_g, $p_g^~y>, 
                                                      '8', $exts>, 
                                                     '13', '0', $certificate_extensions>, 
                                                    '11', '0', pk(~ltkS)>)
                                                >,
                                                ~ltkS)
                                          >, 
                                          '20', 
                                          hmac(<
                                                Expand(Expand(Extract(p_gxy,
                                                                      Extract(Expand(ms, <'rms', h(messages)>,
                                                                                     '32'),
                                                                              '0')),
                                                              <'serverhts', 
                                                               h(<
                                                                  <
                                                                   <
                                                                    <
                                                                     <
                                                                      <
                                                                       <p_messages, '6', '0x0303', '40', $p_g
                                                                       >, 
                                                                       '1', '0x0303', p_nc, '0', 
                                                                       $cipher_suites, '0', <'43', '0x0304'>, 
                                                                       <'10', $g1, $g2>, <'40', $p_g, p_gx>, 
                                                                       <'45', '0', '1'>, p_edi, '41', 
                                                                       <~ticket, mask(x, x.1)>, 
                                                                       hmac(<
                                                                             Expand(Expand(Extract(Expand(ms,
                                                                                                          <
                                                                                                           'rms', 
                                                                                                           h(messages)
                                                                                                          >,
                                                                                                          '32'),
                                                                                                   '0'),
                                                                                           <'res', 'pbk'>,
                                                                                           '32'),
                                                                                    <'0', '0'>, '32'), 
                                                                             h(<
                                                                                <p_messages, '6', '0x0303', 
                                                                                 '40', $p_g>, 
                                                                                '1', '0x0303', p_nc, '0', 
                                                                                $cipher_suites, '0', 
                                                                                <'43', '0x0304'>, 
                                                                                <'10', $g1, $g2>, 
                                                                                <'40', $p_g, p_gx>, 
                                                                                <'45', '0', '1'>, p_edi, 
                                                                                '41', 
                                                                                <~ticket, mask(x, x.1)>, '0'>)
                                                                            >)
                                                                      >, 
                                                                      '2', '0x0303', ~ns, $cipher_suite, 
                                                                      <'13', $sig_algs>, '40', $p_g, $p_g^~y
                                                                     >, 
                                                                     '8', $exts>, 
                                                                    '13', '0', $certificate_extensions>, 
                                                                   '11', '0', pk(~ltkS)>, 
                                                                  '15', 
                                                                  sign(<'server_cv', 
                                                                        h(<
                                                                           <
                                                                            <
                                                                             <
                                                                              <
                                                                               <p_messages, '6', '0x0303', 
                                                                                '40', $p_g>, 
                                                                               '1', '0x0303', p_nc, '0', 
                                                                               $cipher_suites, '0', 
                                                                               <'43', '0x0304'>, 
                                                                               <'10', $g1, $g2>, 
                                                                               <'40', $p_g, p_gx>, 
                                                                               <'45', '0', '1'>, p_edi, '41', 
                                                                               <~ticket, mask(x, x.1)>, 
                                                                               hmac(<
                                                                                     Expand(Expand(Extract(Expand(ms,
                                                                                                                  <
                                                                                                                   'rms', 
                                                                                                                   h(messages)
                                                                                                                  >,
                                                                                                                  '32'),
                                                                                                           '0'),
                                                                                                   <'res', 
                                                                                                    'pbk'>,
                                                                                                   '32'),
                                                                                            <'0', '0'>,
                                                                                            '32'), 
                                                                                     h(<
                                                                                        <p_messages, '6', 
                                                                                         '0x0303', '40', $p_g
                                                                                        >, 
                                                                                        '1', '0x0303', p_nc, 
                                                                                        '0', $cipher_suites, 
                                                                                        '0', 
                                                                                        <'43', '0x0304'>, 
                                                                                        <'10', $g1, $g2>, 
                                                                                        <'40', $p_g, p_gx>, 
                                                                                        <'45', '0', '1'>, 
                                                                                        p_edi, '41', 
                                                                                        <~ticket, mask(x, x.1)
                                                                                        >, 
                                                                                        '0'>)
                                                                                    >)
                                                                              >, 
                                                                              '2', '0x0303', ~ns, 
                                                                              $cipher_suite, 
                                                                              <'13', $sig_algs>, '40', $p_g, 
                                                                              $p_g^~y>, 
                                                                             '8', $exts>, 
                                                                            '13', '0', $certificate_extensions
                                                                           >, 
                                                                           '11', '0', pk(~ltkS)>)
                                                                       >,
                                                                       ~ltkS)
                                                                 >)
                                                              >,
                                                              '32'),
                                                       <'fin', '0'>, '32'), 
                                                h(<
                                                   <
                                                    <
                                                     <
                                                      <
                                                       <<p_messages, '6', '0x0303', '40', $p_g>, '1', 
                                                        '0x0303', p_nc, '0', $cipher_suites, '0', 
                                                        <'43', '0x0304'>, <'10', $g1, $g2>, 
                                                        <'40', $p_g, p_gx>, <'45', '0', '1'>, p_edi, '41', 
                                                        <~ticket, mask(x, x.1)>, 
                                                        hmac(<
                                                              Expand(Expand(Extract(Expand(ms,
                                                                                           <'rms', h(messages)
                                                                                           >,
                                                                                           '32'),
                                                                                    '0'),
                                                                            <'res', 'pbk'>, '32'),
                                                                     <'0', '0'>, '32'), 
                                                              h(<<p_messages, '6', '0x0303', '40', $p_g>, 
                                                                 '1', '0x0303', p_nc, '0', $cipher_suites, 
                                                                 '0', <'43', '0x0304'>, <'10', $g1, $g2>, 
                                                                 <'40', $p_g, p_gx>, <'45', '0', '1'>, p_edi, 
                                                                 '41', <~ticket, mask(x, x.1)>, '0'>)
                                                             >)
                                                       >, 
                                                       '2', '0x0303', ~ns, $cipher_suite, <'13', $sig_algs>, 
                                                       '40', $p_g, $p_g^~y>, 
                                                      '8', $exts>, 
                                                     '13', '0', $certificate_extensions>, 
                                                    '11', '0', pk(~ltkS)>, 
                                                   '15', 
                                                   sign(<'server_cv', 
                                                         h(<
                                                            <
                                                             <
                                                              <
                                                               <<p_messages, '6', '0x0303', '40', $p_g>, '1', 
                                                                '0x0303', p_nc, '0', $cipher_suites, '0', 
                                                                <'43', '0x0304'>, <'10', $g1, $g2>, 
                                                                <'40', $p_g, p_gx>, <'45', '0', '1'>, p_edi, 
                                                                '41', <~ticket, mask(x, x.1)>, 
                                                                hmac(<
                                                                      Expand(Expand(Extract(Expand(ms,
                                                                                                   <'rms', 
                                                                                                    h(messages)
                                                                                                   >,
                                                                                                   '32'),
                                                                                            '0'),
                                                                                    <'res', 'pbk'>, '32'),
                                                                             <'0', '0'>, '32'), 
                                                                      h(<
                                                                         <p_messages, '6', '0x0303', '40', 
                                                                          $p_g>, 
                                                                         '1', '0x0303', p_nc, '0', 
                                                                         $cipher_suites, '0', 
                                                                         <'43', '0x0304'>, <'10', $g1, $g2>, 
                                                                         <'40', $p_g, p_gx>, 
                                                                         <'45', '0', '1'>, p_edi, '41', 
                                                                         <~ticket, mask(x, x.1)>, '0'>)
                                                                     >)
                                                               >, 
                                                               '2', '0x0303', ~ns, $cipher_suite, 
                                                               <'13', $sig_algs>, '40', $p_g, $p_g^~y>, 
                                                              '8', $exts>, 
                                                             '13', '0', $certificate_extensions>, 
                                                            '11', '0', pk(~ltkS)>)
                                                        >,
                                                        ~ltkS)
                                                  >)
                                               >)
                                         >)
                                      >,
                                      '32')
                    ) ▶₀ #l )
        qed
      qed
    next
      case server_auth_case_07
      by contradiction /* from formulas */
    next
      case server_auth_case_08
      by contradiction /* from formulas */
    next
      case server_auth_case_09
      by contradiction /* from formulas */
    next
      case server_auth_case_10
      by contradiction /* from formulas */
    next
      case server_auth_case_11
      by contradiction /* from formulas */
    next
      case server_auth_case_12
      by contradiction /* from formulas */
    qed
  next
    case case_2
    solve( F_State_S3( ~tid, $S, $C, p_res_psk, p_messages, p_nc, p_ns, p_g,
                       p_sg, p_hrr, p_x, p_y, p_gx, p_gy, p_gxy, p_psk_ke_mode, p_psk_id, p_edi,
                       p_es, p_hs, Extract('0', p_hs), p_cats, p_sats, p_hs_keyc, p_hs_keys,
                       p_auth_status, p_ems, p_rms, '1'
           ) ▶₀ #i )
      case server_auth_case_01
      solve( !Pk( $C, pk(~ltkC) ) ▶₁ #i )
        case Register_pk
        by solve( SecretPSK( $A,
                             Expand(Expand(Extract('0', Extract(p_gxy, Extract('0', '0'))),
                                           <'clientats', 
                                            h(<
                                               <
                                                <
                                                 <
                                                  <
                                                   <
                                                    <'0', '1', '0x0303', p_nc, '0', $cipher_suites, '0', 
                                                     <'43', '0x0304'>, <'10', $g1, $g2>, <'13', $sig_algs>, 
                                                     '40', $p_g, p_gx>, 
                                                    '2', '0x0303', ~new_ns, $cipher_suite, 
                                                    <'13', $sig_algs.1>, '40', $p_g, $p_g^~y>, 
                                                   '8', $exts>, 
                                                  '13', '0', $certificate_extensions>, 
                                                 '11', '0', pk(~ltkS)>, 
                                                '15', 
                                                sign(<'server_cv', 
                                                      h(<
                                                         <
                                                          <
                                                           <
                                                            <'0', '1', '0x0303', p_nc, '0', $cipher_suites, 
                                                             '0', <'43', '0x0304'>, <'10', $g1, $g2>, 
                                                             <'13', $sig_algs>, '40', $p_g, p_gx>, 
                                                            '2', '0x0303', ~new_ns, $cipher_suite, 
                                                            <'13', $sig_algs.1>, '40', $p_g, $p_g^~y>, 
                                                           '8', $exts>, 
                                                          '13', '0', $certificate_extensions>, 
                                                         '11', '0', pk(~ltkS)>)
                                                     >,
                                                     ~ltkS)
                                               >, 
                                               '20', 
                                               hmac(<
                                                     Expand(Expand(Extract(p_gxy, Extract('0', '0')),
                                                                   <'serverhts', 
                                                                    h(<
                                                                       <
                                                                        <
                                                                         <
                                                                          <
                                                                           <'0', '1', '0x0303', p_nc, '0', 
                                                                            $cipher_suites, '0', 
                                                                            <'43', '0x0304'>, 
                                                                            <'10', $g1, $g2>, 
                                                                            <'13', $sig_algs>, '40', $p_g, 
                                                                            p_gx>, 
                                                                           '2', '0x0303', ~new_ns, 
                                                                           $cipher_suite, 
                                                                           <'13', $sig_algs.1>, '40', $p_g, 
                                                                           $p_g^~y>, 
                                                                          '8', $exts>, 
                                                                         '13', '0', $certificate_extensions>, 
                                                                        '11', '0', pk(~ltkS)>, 
                                                                       '15', 
                                                                       sign(<'server_cv', 
                                                                             h(<
                                                                                <
                                                                                 <
                                                                                  <
                                                                                   <'0', '1', '0x0303', p_nc, 
                                                                                    '0', $cipher_suites, '0', 
                                                                                    <'43', '0x0304'>, 
                                                                                    <'10', $g1, $g2>, 
                                                                                    <'13', $sig_algs>, '40', 
                                                                                    $p_g, p_gx>, 
                                                                                   '2', '0x0303', ~new_ns, 
                                                                                   $cipher_suite, 
                                                                                   <'13', $sig_algs.1>, '40', 
                                                                                   $p_g, $p_g^~y>, 
                                                                                  '8', $exts>, 
                                                                                 '13', '0', 
                                                                                 $certificate_extensions>, 
                                                                                '11', '0', pk(~ltkS)>)
                                                                            >,
                                                                            ~ltkS)
                                                                      >)
                                                                   >,
                                                                   '32'),
                                                            <'fin', '0'>, '32'), 
                                                     h(<
                                                        <
                                                         <
                                                          <
                                                           <
                                                            <'0', '1', '0x0303', p_nc, '0', $cipher_suites, 
                                                             '0', <'43', '0x0304'>, <'10', $g1, $g2>, 
                                                             <'13', $sig_algs>, '40', $p_g, p_gx>, 
                                                            '2', '0x0303', ~new_ns, $cipher_suite, 
                                                            <'13', $sig_algs.1>, '40', $p_g, $p_g^~y>, 
                                                           '8', $exts>, 
                                                          '13', '0', $certificate_extensions>, 
                                                         '11', '0', pk(~ltkS)>, 
                                                        '15', 
                                                        sign(<'server_cv', 
                                                              h(<
                                                                 <
                                                                  <
                                                                   <
                                                                    <'0', '1', '0x0303', p_nc, '0', 
                                                                     $cipher_suites, '0', <'43', '0x0304'>, 
                                                                     <'10', $g1, $g2>, <'13', $sig_algs>, 
                                                                     '40', $p_g, p_gx>, 
                                                                    '2', '0x0303', ~new_ns, $cipher_suite, 
                                                                    <'13', $sig_algs.1>, '40', $p_g, $p_g^~y
                                                                   >, 
                                                                   '8', $exts>, 
                                                                  '13', '0', $certificate_extensions>, 
                                                                 '11', '0', pk(~ltkS)>)
                                                             >,
                                                             ~ltkS)
                                                       >)
                                                    >)
                                              >)
                                           >,
                                           '32'),
                                    <'adke_wk', '0'>, '32')
                  ) ▶₀ #l )
      qed
    next
      case server_auth_case_02
      solve( !Pk( $C, pk(~ltkC) ) ▶₁ #i )
        case Register_pk
        by solve( SecretPSK( $A,
                             Expand(Expand(Extract('0', Extract(p_gxy, Extract(p_res_psk, '0'))),
                                           <'clientats', 
                                            h(<
                                               <
                                                <
                                                 <
                                                  <
                                                   <
                                                    <<p_messages, '6', '0x0303', '40', $p_g>, '1', '0x0303', 
                                                     p_nc, '0', $cipher_suites, '0', <'43', '0x0304'>, 
                                                     <'10', $g1, $g2>, <'13', $sig_algs>, '40', $p_g, p_gx>, 
                                                    '2', '0x0303', ~new_ns, $cipher_suite, 
                                                    <'13', $sig_algs.1>, '40', $p_g, $p_g^~y>, 
                                                   '8', $exts>, 
                                                  '13', '0', $certificate_extensions>, 
                                                 '11', '0', pk(~ltkS)>, 
                                                '15', 
                                                sign(<'server_cv', 
                                                      h(<
                                                         <
                                                          <
                                                           <
                                                            <<p_messages, '6', '0x0303', '40', $p_g>, '1', 
                                                             '0x0303', p_nc, '0', $cipher_suites, '0', 
                                                             <'43', '0x0304'>, <'10', $g1, $g2>, 
                                                             <'13', $sig_algs>, '40', $p_g, p_gx>, 
                                                            '2', '0x0303', ~new_ns, $cipher_suite, 
                                                            <'13', $sig_algs.1>, '40', $p_g, $p_g^~y>, 
                                                           '8', $exts>, 
                                                          '13', '0', $certificate_extensions>, 
                                                         '11', '0', pk(~ltkS)>)
                                                     >,
                                                     ~ltkS)
                                               >, 
                                               '20', 
                                               hmac(<
                                                     Expand(Expand(Extract(p_gxy, Extract(p_res_psk, '0')),
                                                                   <'serverhts', 
                                                                    h(<
                                                                       <
                                                                        <
                                                                         <
                                                                          <
                                                                           <
                                                                            <p_messages, '6', '0x0303', '40', 
                                                                             $p_g>, 
                                                                            '1', '0x0303', p_nc, '0', 
                                                                            $cipher_suites, '0', 
                                                                            <'43', '0x0304'>, 
                                                                            <'10', $g1, $g2>, 
                                                                            <'13', $sig_algs>, '40', $p_g, 
                                                                            p_gx>, 
                                                                           '2', '0x0303', ~new_ns, 
                                                                           $cipher_suite, 
                                                                           <'13', $sig_algs.1>, '40', $p_g, 
                                                                           $p_g^~y>, 
                                                                          '8', $exts>, 
                                                                         '13', '0', $certificate_extensions>, 
                                                                        '11', '0', pk(~ltkS)>, 
                                                                       '15', 
                                                                       sign(<'server_cv', 
                                                                             h(<
                                                                                <
                                                                                 <
                                                                                  <
                                                                                   <
                                                                                    <p_messages, '6', 
                                                                                     '0x0303', '40', $p_g>, 
                                                                                    '1', '0x0303', p_nc, '0', 
                                                                                    $cipher_suites, '0', 
                                                                                    <'43', '0x0304'>, 
                                                                                    <'10', $g1, $g2>, 
                                                                                    <'13', $sig_algs>, '40', 
                                                                                    $p_g, p_gx>, 
                                                                                   '2', '0x0303', ~new_ns, 
                                                                                   $cipher_suite, 
                                                                                   <'13', $sig_algs.1>, '40', 
                                                                                   $p_g, $p_g^~y>, 
                                                                                  '8', $exts>, 
                                                                                 '13', '0', 
                                                                                 $certificate_extensions>, 
                                                                                '11', '0', pk(~ltkS)>)
                                                                            >,
                                                                            ~ltkS)
                                                                      >)
                                                                   >,
                                                                   '32'),
                                                            <'fin', '0'>, '32'), 
                                                     h(<
                                                        <
                                                         <
                                                          <
                                                           <
                                                            <<p_messages, '6', '0x0303', '40', $p_g>, '1', 
                                                             '0x0303', p_nc, '0', $cipher_suites, '0', 
                                                             <'43', '0x0304'>, <'10', $g1, $g2>, 
                                                             <'13', $sig_algs>, '40', $p_g, p_gx>, 
                                                            '2', '0x0303', ~new_ns, $cipher_suite, 
                                                            <'13', $sig_algs.1>, '40', $p_g, $p_g^~y>, 
                                                           '8', $exts>, 
                                                          '13', '0', $certificate_extensions>, 
                                                         '11', '0', pk(~ltkS)>, 
                                                        '15', 
                                                        sign(<'server_cv', 
                                                              h(<
                                                                 <
                                                                  <
                                                                   <
                                                                    <<p_messages, '6', '0x0303', '40', $p_g>, 
                                                                     '1', '0x0303', p_nc, '0', 
                                                                     $cipher_suites, '0', <'43', '0x0304'>, 
                                                                     <'10', $g1, $g2>, <'13', $sig_algs>, 
                                                                     '40', $p_g, p_gx>, 
                                                                    '2', '0x0303', ~new_ns, $cipher_suite, 
                                                                    <'13', $sig_algs.1>, '40', $p_g, $p_g^~y
                                                                   >, 
                                                                   '8', $exts>, 
                                                                  '13', '0', $certificate_extensions>, 
                                                                 '11', '0', pk(~ltkS)>)
                                                             >,
                                                             ~ltkS)
                                                       >)
                                                    >)
                                              >)
                                           >,
                                           '32'),
                                    <'adke_wk', '0'>, '32')
                  ) ▶₀ #l )
      qed
    next
      case server_auth_case_03
      solve( !Pk( $C, pk(~ltkC) ) ▶₁ #i )
        case Register_pk
        by solve( SecretPSK( $A,
                             Expand(Expand(Extract('0', Extract(p_gxy, Extract(~res_psk, '0'))),
                                           <'clientats', 
                                            h(<
                                               <
                                                <
                                                 <
                                                  <
                                                   <
                                                    <'0', '1', '0x0303', p_nc, '0', $cipher_suites, '0', 
                                                     <'43', '0x0304'>, <'10', $g1, $g2>, <'40', $p_g, p_gx>, 
                                                     <'45', '0', '1'>, p_edi, '41', <~ticket, mask(x, x.1)>, 
                                                     hmac(<
                                                           Expand(Expand(Extract(~res_psk, '0'),
                                                                         <'ext', 'pbk'>, '32'),
                                                                  <'0', '0'>, '32'), 
                                                           h(<'0', '1', '0x0303', p_nc, '0', $cipher_suites, 
                                                              '0', <'43', '0x0304'>, <'10', $g1, $g2>, 
                                                              <'40', $p_g, p_gx>, <'45', '0', '1'>, p_edi, 
                                                              '41', <~ticket, mask(x, x.1)>, '0'>)
                                                          >)
                                                    >, 
                                                    '2', '0x0303', ~ns, $cipher_suite, <'13', $sig_algs>, 
                                                    '40', $p_g, $p_g^~y>, 
                                                   '8', $exts>, 
                                                  '13', '0', $certificate_extensions>, 
                                                 '11', '0', pk(~ltkS)>, 
                                                '15', 
                                                sign(<'server_cv', 
                                                      h(<
                                                         <
                                                          <
                                                           <
                                                            <'0', '1', '0x0303', p_nc, '0', $cipher_suites, 
                                                             '0', <'43', '0x0304'>, <'10', $g1, $g2>, 
                                                             <'40', $p_g, p_gx>, <'45', '0', '1'>, p_edi, 
                                                             '41', <~ticket, mask(x, x.1)>, 
                                                             hmac(<
                                                                   Expand(Expand(Extract(~res_psk, '0'),
                                                                                 <'ext', 'pbk'>, '32'),
                                                                          <'0', '0'>, '32'), 
                                                                   h(<'0', '1', '0x0303', p_nc, '0', 
                                                                      $cipher_suites, '0', <'43', '0x0304'>, 
                                                                      <'10', $g1, $g2>, <'40', $p_g, p_gx>, 
                                                                      <'45', '0', '1'>, p_edi, '41', 
                                                                      <~ticket, mask(x, x.1)>, '0'>)
                                                                  >)
                                                            >, 
                                                            '2', '0x0303', ~ns, $cipher_suite, 
                                                            <'13', $sig_algs>, '40', $p_g, $p_g^~y>, 
                                                           '8', $exts>, 
                                                          '13', '0', $certificate_extensions>, 
                                                         '11', '0', pk(~ltkS)>)
                                                     >,
                                                     ~ltkS)
                                               >, 
                                               '20', 
                                               hmac(<
                                                     Expand(Expand(Extract(p_gxy, Extract(~res_psk, '0')),
                                                                   <'serverhts', 
                                                                    h(<
                                                                       <
                                                                        <
                                                                         <
                                                                          <
                                                                           <'0', '1', '0x0303', p_nc, '0', 
                                                                            $cipher_suites, '0', 
                                                                            <'43', '0x0304'>, 
                                                                            <'10', $g1, $g2>, 
                                                                            <'40', $p_g, p_gx>, 
                                                                            <'45', '0', '1'>, p_edi, '41', 
                                                                            <~ticket, mask(x, x.1)>, 
                                                                            hmac(<
                                                                                  Expand(Expand(Extract(~res_psk,
                                                                                                        '0'),
                                                                                                <'ext', 'pbk'
                                                                                                >,
                                                                                                '32'),
                                                                                         <'0', '0'>, '32'), 
                                                                                  h(<'0', '1', '0x0303', 
                                                                                     p_nc, '0', 
                                                                                     $cipher_suites, '0', 
                                                                                     <'43', '0x0304'>, 
                                                                                     <'10', $g1, $g2>, 
                                                                                     <'40', $p_g, p_gx>, 
                                                                                     <'45', '0', '1'>, p_edi, 
                                                                                     '41', 
                                                                                     <~ticket, mask(x, x.1)>, 
                                                                                     '0'>)
                                                                                 >)
                                                                           >, 
                                                                           '2', '0x0303', ~ns, $cipher_suite, 
                                                                           <'13', $sig_algs>, '40', $p_g, 
                                                                           $p_g^~y>, 
                                                                          '8', $exts>, 
                                                                         '13', '0', $certificate_extensions>, 
                                                                        '11', '0', pk(~ltkS)>, 
                                                                       '15', 
                                                                       sign(<'server_cv', 
                                                                             h(<
                                                                                <
                                                                                 <
                                                                                  <
                                                                                   <'0', '1', '0x0303', p_nc, 
                                                                                    '0', $cipher_suites, '0', 
                                                                                    <'43', '0x0304'>, 
                                                                                    <'10', $g1, $g2>, 
                                                                                    <'40', $p_g, p_gx>, 
                                                                                    <'45', '0', '1'>, p_edi, 
                                                                                    '41', 
                                                                                    <~ticket, mask(x, x.1)>, 
                                                                                    hmac(<
                                                                                          Expand(Expand(Extract(~res_psk,
                                                                                                                '0'),
                                                                                                        <
                                                                                                         'ext', 
                                                                                                         'pbk'
                                                                                                        >,
                                                                                                        '32'),
                                                                                                 <'0', '0'>,
                                                                                                 '32'), 
                                                                                          h(<'0', '1', 
                                                                                             '0x0303', p_nc, 
                                                                                             '0', 
                                                                                             $cipher_suites, 
                                                                                             '0', 
                                                                                             <'43', '0x0304'
                                                                                             >, 
                                                                                             <'10', $g1, $g2
                                                                                             >, 
                                                                                             <'40', $p_g, p_gx
                                                                                             >, 
                                                                                             <'45', '0', '1'
                                                                                             >, 
                                                                                             p_edi, '41', 
                                                                                             <~ticket, 
                                                                                              mask(x, x.1)>, 
                                                                                             '0'>)
                                                                                         >)
                                                                                   >, 
                                                                                   '2', '0x0303', ~ns, 
                                                                                   $cipher_suite, 
                                                                                   <'13', $sig_algs>, '40', 
                                                                                   $p_g, $p_g^~y>, 
                                                                                  '8', $exts>, 
                                                                                 '13', '0', 
                                                                                 $certificate_extensions>, 
                                                                                '11', '0', pk(~ltkS)>)
                                                                            >,
                                                                            ~ltkS)
                                                                      >)
                                                                   >,
                                                                   '32'),
                                                            <'fin', '0'>, '32'), 
                                                     h(<
                                                        <
                                                         <
                                                          <
                                                           <
                                                            <'0', '1', '0x0303', p_nc, '0', $cipher_suites, 
                                                             '0', <'43', '0x0304'>, <'10', $g1, $g2>, 
                                                             <'40', $p_g, p_gx>, <'45', '0', '1'>, p_edi, 
                                                             '41', <~ticket, mask(x, x.1)>, 
                                                             hmac(<
                                                                   Expand(Expand(Extract(~res_psk, '0'),
                                                                                 <'ext', 'pbk'>, '32'),
                                                                          <'0', '0'>, '32'), 
                                                                   h(<'0', '1', '0x0303', p_nc, '0', 
                                                                      $cipher_suites, '0', <'43', '0x0304'>, 
                                                                      <'10', $g1, $g2>, <'40', $p_g, p_gx>, 
                                                                      <'45', '0', '1'>, p_edi, '41', 
                                                                      <~ticket, mask(x, x.1)>, '0'>)
                                                                  >)
                                                            >, 
                                                            '2', '0x0303', ~ns, $cipher_suite, 
                                                            <'13', $sig_algs>, '40', $p_g, $p_g^~y>, 
                                                           '8', $exts>, 
                                                          '13', '0', $certificate_extensions>, 
                                                         '11', '0', pk(~ltkS)>, 
                                                        '15', 
                                                        sign(<'server_cv', 
                                                              h(<
                                                                 <
                                                                  <
                                                                   <
                                                                    <'0', '1', '0x0303', p_nc, '0', 
                                                                     $cipher_suites, '0', <'43', '0x0304'>, 
                                                                     <'10', $g1, $g2>, <'40', $p_g, p_gx>, 
                                                                     <'45', '0', '1'>, p_edi, '41', 
                                                                     <~ticket, mask(x, x.1)>, 
                                                                     hmac(<
                                                                           Expand(Expand(Extract(~res_psk,
                                                                                                 '0'),
                                                                                         <'ext', 'pbk'>,
                                                                                         '32'),
                                                                                  <'0', '0'>, '32'), 
                                                                           h(<'0', '1', '0x0303', p_nc, '0', 
                                                                              $cipher_suites, '0', 
                                                                              <'43', '0x0304'>, 
                                                                              <'10', $g1, $g2>, 
                                                                              <'40', $p_g, p_gx>, 
                                                                              <'45', '0', '1'>, p_edi, '41', 
                                                                              <~ticket, mask(x, x.1)>, '0'>)
                                                                          >)
                                                                    >, 
                                                                    '2', '0x0303', ~ns, $cipher_suite, 
                                                                    <'13', $sig_algs>, '40', $p_g, $p_g^~y>, 
                                                                   '8', $exts>, 
                                                                  '13', '0', $certificate_extensions>, 
                                                                 '11', '0', pk(~ltkS)>)
                                                             >,
                                                             ~ltkS)
                                                       >)
                                                    >)
                                              >)
                                           >,
                                           '32'),
                                    <'adke_wk', '0'>, '32')
                  ) ▶₀ #l )
      qed
    next
      case server_auth_case_04
      solve( !Pk( $C, pk(~ltkC) ) ▶₁ #i )
        case Register_pk
        by solve( SecretPSK( $A,
                             Expand(Expand(Extract('0',
                                                   Extract(p_gxy,
                                                           Extract(Expand(ms, <'rms', h(messages)>, '32'),
                                                                   '0'))),
                                           <'clientats', 
                                            h(<
                                               <
                                                <
                                                 <
                                                  <
                                                   <
                                                    <'0', '1', '0x0303', p_nc, '0', $cipher_suites, '0', 
                                                     <'43', '0x0304'>, <'10', $g1, $g2>, <'40', $p_g, p_gx>, 
                                                     <'45', '0', '1'>, p_edi, '41', <~ticket, mask(x, x.1)>, 
                                                     hmac(<
                                                           Expand(Expand(Extract(Expand(ms,
                                                                                        <'rms', h(messages)>,
                                                                                        '32'),
                                                                                 '0'),
                                                                         <'res', 'pbk'>, '32'),
                                                                  <'0', '0'>, '32'), 
                                                           h(<'0', '1', '0x0303', p_nc, '0', $cipher_suites, 
                                                              '0', <'43', '0x0304'>, <'10', $g1, $g2>, 
                                                              <'40', $p_g, p_gx>, <'45', '0', '1'>, p_edi, 
                                                              '41', <~ticket, mask(x, x.1)>, '0'>)
                                                          >)
                                                    >, 
                                                    '2', '0x0303', ~ns, $cipher_suite, <'13', $sig_algs>, 
                                                    '40', $p_g, $p_g^~y>, 
                                                   '8', $exts>, 
                                                  '13', '0', $certificate_extensions>, 
                                                 '11', '0', pk(~ltkS)>, 
                                                '15', 
                                                sign(<'server_cv', 
                                                      h(<
                                                         <
                                                          <
                                                           <
                                                            <'0', '1', '0x0303', p_nc, '0', $cipher_suites, 
                                                             '0', <'43', '0x0304'>, <'10', $g1, $g2>, 
                                                             <'40', $p_g, p_gx>, <'45', '0', '1'>, p_edi, 
                                                             '41', <~ticket, mask(x, x.1)>, 
                                                             hmac(<
                                                                   Expand(Expand(Extract(Expand(ms,
                                                                                                <'rms', 
                                                                                                 h(messages)>,
                                                                                                '32'),
                                                                                         '0'),
                                                                                 <'res', 'pbk'>, '32'),
                                                                          <'0', '0'>, '32'), 
                                                                   h(<'0', '1', '0x0303', p_nc, '0', 
                                                                      $cipher_suites, '0', <'43', '0x0304'>, 
                                                                      <'10', $g1, $g2>, <'40', $p_g, p_gx>, 
                                                                      <'45', '0', '1'>, p_edi, '41', 
                                                                      <~ticket, mask(x, x.1)>, '0'>)
                                                                  >)
                                                            >, 
                                                            '2', '0x0303', ~ns, $cipher_suite, 
                                                            <'13', $sig_algs>, '40', $p_g, $p_g^~y>, 
                                                           '8', $exts>, 
                                                          '13', '0', $certificate_extensions>, 
                                                         '11', '0', pk(~ltkS)>)
                                                     >,
                                                     ~ltkS)
                                               >, 
                                               '20', 
                                               hmac(<
                                                     Expand(Expand(Extract(p_gxy,
                                                                           Extract(Expand(ms,
                                                                                          <'rms', h(messages)
                                                                                          >,
                                                                                          '32'),
                                                                                   '0')),
                                                                   <'serverhts', 
                                                                    h(<
                                                                       <
                                                                        <
                                                                         <
                                                                          <
                                                                           <'0', '1', '0x0303', p_nc, '0', 
                                                                            $cipher_suites, '0', 
                                                                            <'43', '0x0304'>, 
                                                                            <'10', $g1, $g2>, 
                                                                            <'40', $p_g, p_gx>, 
                                                                            <'45', '0', '1'>, p_edi, '41', 
                                                                            <~ticket, mask(x, x.1)>, 
                                                                            hmac(<
                                                                                  Expand(Expand(Extract(Expand(ms,
                                                                                                               <
                                                                                                                'rms', 
                                                                                                                h(messages)
                                                                                                               >,
                                                                                                               '32'),
                                                                                                        '0'),
                                                                                                <'res', 'pbk'
                                                                                                >,
                                                                                                '32'),
                                                                                         <'0', '0'>, '32'), 
                                                                                  h(<'0', '1', '0x0303', 
                                                                                     p_nc, '0', 
                                                                                     $cipher_suites, '0', 
                                                                                     <'43', '0x0304'>, 
                                                                                     <'10', $g1, $g2>, 
                                                                                     <'40', $p_g, p_gx>, 
                                                                                     <'45', '0', '1'>, p_edi, 
                                                                                     '41', 
                                                                                     <~ticket, mask(x, x.1)>, 
                                                                                     '0'>)
                                                                                 >)
                                                                           >, 
                                                                           '2', '0x0303', ~ns, $cipher_suite, 
                                                                           <'13', $sig_algs>, '40', $p_g, 
                                                                           $p_g^~y>, 
                                                                          '8', $exts>, 
                                                                         '13', '0', $certificate_extensions>, 
                                                                        '11', '0', pk(~ltkS)>, 
                                                                       '15', 
                                                                       sign(<'server_cv', 
                                                                             h(<
                                                                                <
                                                                                 <
                                                                                  <
                                                                                   <'0', '1', '0x0303', p_nc, 
                                                                                    '0', $cipher_suites, '0', 
                                                                                    <'43', '0x0304'>, 
                                                                                    <'10', $g1, $g2>, 
                                                                                    <'40', $p_g, p_gx>, 
                                                                                    <'45', '0', '1'>, p_edi, 
                                                                                    '41', 
                                                                                    <~ticket, mask(x, x.1)>, 
                                                                                    hmac(<
                                                                                          Expand(Expand(Extract(Expand(ms,
                                                                                                                       <
                                                                                                                        'rms', 
                                                                                                                        h(messages)
                                                                                                                       >,
                                                                                                                       '32'),
                                                                                                                '0'),
                                                                                                        <
                                                                                                         'res', 
                                                                                                         'pbk'
                                                                                                        >,
                                                                                                        '32'),
                                                                                                 <'0', '0'>,
                                                                                                 '32'), 
                                                                                          h(<'0', '1', 
                                                                                             '0x0303', p_nc, 
                                                                                             '0', 
                                                                                             $cipher_suites, 
                                                                                             '0', 
                                                                                             <'43', '0x0304'
                                                                                             >, 
                                                                                             <'10', $g1, $g2
                                                                                             >, 
                                                                                             <'40', $p_g, p_gx
                                                                                             >, 
                                                                                             <'45', '0', '1'
                                                                                             >, 
                                                                                             p_edi, '41', 
                                                                                             <~ticket, 
                                                                                              mask(x, x.1)>, 
                                                                                             '0'>)
                                                                                         >)
                                                                                   >, 
                                                                                   '2', '0x0303', ~ns, 
                                                                                   $cipher_suite, 
                                                                                   <'13', $sig_algs>, '40', 
                                                                                   $p_g, $p_g^~y>, 
                                                                                  '8', $exts>, 
                                                                                 '13', '0', 
                                                                                 $certificate_extensions>, 
                                                                                '11', '0', pk(~ltkS)>)
                                                                            >,
                                                                            ~ltkS)
                                                                      >)
                                                                   >,
                                                                   '32'),
                                                            <'fin', '0'>, '32'), 
                                                     h(<
                                                        <
                                                         <
                                                          <
                                                           <
                                                            <'0', '1', '0x0303', p_nc, '0', $cipher_suites, 
                                                             '0', <'43', '0x0304'>, <'10', $g1, $g2>, 
                                                             <'40', $p_g, p_gx>, <'45', '0', '1'>, p_edi, 
                                                             '41', <~ticket, mask(x, x.1)>, 
                                                             hmac(<
                                                                   Expand(Expand(Extract(Expand(ms,
                                                                                                <'rms', 
                                                                                                 h(messages)>,
                                                                                                '32'),
                                                                                         '0'),
                                                                                 <'res', 'pbk'>, '32'),
                                                                          <'0', '0'>, '32'), 
                                                                   h(<'0', '1', '0x0303', p_nc, '0', 
                                                                      $cipher_suites, '0', <'43', '0x0304'>, 
                                                                      <'10', $g1, $g2>, <'40', $p_g, p_gx>, 
                                                                      <'45', '0', '1'>, p_edi, '41', 
                                                                      <~ticket, mask(x, x.1)>, '0'>)
                                                                  >)
                                                            >, 
                                                            '2', '0x0303', ~ns, $cipher_suite, 
                                                            <'13', $sig_algs>, '40', $p_g, $p_g^~y>, 
                                                           '8', $exts>, 
                                                          '13', '0', $certificate_extensions>, 
                                                         '11', '0', pk(~ltkS)>, 
                                                        '15', 
                                                        sign(<'server_cv', 
                                                              h(<
                                                                 <
                                                                  <
                                                                   <
                                                                    <'0', '1', '0x0303', p_nc, '0', 
                                                                     $cipher_suites, '0', <'43', '0x0304'>, 
                                                                     <'10', $g1, $g2>, <'40', $p_g, p_gx>, 
                                                                     <'45', '0', '1'>, p_edi, '41', 
                                                                     <~ticket, mask(x, x.1)>, 
                                                                     hmac(<
                                                                           Expand(Expand(Extract(Expand(ms,
                                                                                                        <
                                                                                                         'rms', 
                                                                                                         h(messages)
                                                                                                        >,
                                                                                                        '32'),
                                                                                                 '0'),
                                                                                         <'res', 'pbk'>,
                                                                                         '32'),
                                                                                  <'0', '0'>, '32'), 
                                                                           h(<'0', '1', '0x0303', p_nc, '0', 
                                                                              $cipher_suites, '0', 
                                                                              <'43', '0x0304'>, 
                                                                              <'10', $g1, $g2>, 
                                                                              <'40', $p_g, p_gx>, 
                                                                              <'45', '0', '1'>, p_edi, '41', 
                                                                              <~ticket, mask(x, x.1)>, '0'>)
                                                                          >)
                                                                    >, 
                                                                    '2', '0x0303', ~ns, $cipher_suite, 
                                                                    <'13', $sig_algs>, '40', $p_g, $p_g^~y>, 
                                                                   '8', $exts>, 
                                                                  '13', '0', $certificate_extensions>, 
                                                                 '11', '0', pk(~ltkS)>)
                                                             >,
                                                             ~ltkS)
                                                       >)
                                                    >)
                                              >)
                                           >,
                                           '32'),
                                    <'adke_wk', '0'>, '32')
                  ) ▶₀ #l )
      qed
    next
      case server_auth_case_05
      solve( !Pk( $C, pk(~ltkC) ) ▶₁ #i )
        case Register_pk
        by solve( SecretPSK( $A,
                             Expand(Expand(Extract('0', Extract(p_gxy, Extract(~res_psk, '0'))),
                                           <'clientats', 
                                            h(<
                                               <
                                                <
                                                 <
                                                  <
                                                   <
                                                    <<p_messages, '6', '0x0303', '40', $p_g>, '1', '0x0303', 
                                                     p_nc, '0', $cipher_suites, '0', <'43', '0x0304'>, 
                                                     <'10', $g1, $g2>, <'40', $p_g, p_gx>, <'45', '0', '1'>, 
                                                     p_edi, '41', <~ticket, mask(x, x.1)>, 
                                                     hmac(<
                                                           Expand(Expand(Extract(~res_psk, '0'),
                                                                         <'ext', 'pbk'>, '32'),
                                                                  <'0', '0'>, '32'), 
                                                           h(<<p_messages, '6', '0x0303', '40', $p_g>, '1', 
                                                              '0x0303', p_nc, '0', $cipher_suites, '0', 
                                                              <'43', '0x0304'>, <'10', $g1, $g2>, 
                                                              <'40', $p_g, p_gx>, <'45', '0', '1'>, p_edi, 
                                                              '41', <~ticket, mask(x, x.1)>, '0'>)
                                                          >)
                                                    >, 
                                                    '2', '0x0303', ~ns, $cipher_suite, <'13', $sig_algs>, 
                                                    '40', $p_g, $p_g^~y>, 
                                                   '8', $exts>, 
                                                  '13', '0', $certificate_extensions>, 
                                                 '11', '0', pk(~ltkS)>, 
                                                '15', 
                                                sign(<'server_cv', 
                                                      h(<
                                                         <
                                                          <
                                                           <
                                                            <<p_messages, '6', '0x0303', '40', $p_g>, '1', 
                                                             '0x0303', p_nc, '0', $cipher_suites, '0', 
                                                             <'43', '0x0304'>, <'10', $g1, $g2>, 
                                                             <'40', $p_g, p_gx>, <'45', '0', '1'>, p_edi, 
                                                             '41', <~ticket, mask(x, x.1)>, 
                                                             hmac(<
                                                                   Expand(Expand(Extract(~res_psk, '0'),
                                                                                 <'ext', 'pbk'>, '32'),
                                                                          <'0', '0'>, '32'), 
                                                                   h(<
                                                                      <p_messages, '6', '0x0303', '40', $p_g
                                                                      >, 
                                                                      '1', '0x0303', p_nc, '0', 
                                                                      $cipher_suites, '0', <'43', '0x0304'>, 
                                                                      <'10', $g1, $g2>, <'40', $p_g, p_gx>, 
                                                                      <'45', '0', '1'>, p_edi, '41', 
                                                                      <~ticket, mask(x, x.1)>, '0'>)
                                                                  >)
                                                            >, 
                                                            '2', '0x0303', ~ns, $cipher_suite, 
                                                            <'13', $sig_algs>, '40', $p_g, $p_g^~y>, 
                                                           '8', $exts>, 
                                                          '13', '0', $certificate_extensions>, 
                                                         '11', '0', pk(~ltkS)>)
                                                     >,
                                                     ~ltkS)
                                               >, 
                                               '20', 
                                               hmac(<
                                                     Expand(Expand(Extract(p_gxy, Extract(~res_psk, '0')),
                                                                   <'serverhts', 
                                                                    h(<
                                                                       <
                                                                        <
                                                                         <
                                                                          <
                                                                           <
                                                                            <p_messages, '6', '0x0303', '40', 
                                                                             $p_g>, 
                                                                            '1', '0x0303', p_nc, '0', 
                                                                            $cipher_suites, '0', 
                                                                            <'43', '0x0304'>, 
                                                                            <'10', $g1, $g2>, 
                                                                            <'40', $p_g, p_gx>, 
                                                                            <'45', '0', '1'>, p_edi, '41', 
                                                                            <~ticket, mask(x, x.1)>, 
                                                                            hmac(<
                                                                                  Expand(Expand(Extract(~res_psk,
                                                                                                        '0'),
                                                                                                <'ext', 'pbk'
                                                                                                >,
                                                                                                '32'),
                                                                                         <'0', '0'>, '32'), 
                                                                                  h(<
                                                                                     <p_messages, '6', 
                                                                                      '0x0303', '40', $p_g>, 
                                                                                     '1', '0x0303', p_nc, 
                                                                                     '0', $cipher_suites, 
                                                                                     '0', <'43', '0x0304'>, 
                                                                                     <'10', $g1, $g2>, 
                                                                                     <'40', $p_g, p_gx>, 
                                                                                     <'45', '0', '1'>, p_edi, 
                                                                                     '41', 
                                                                                     <~ticket, mask(x, x.1)>, 
                                                                                     '0'>)
                                                                                 >)
                                                                           >, 
                                                                           '2', '0x0303', ~ns, $cipher_suite, 
                                                                           <'13', $sig_algs>, '40', $p_g, 
                                                                           $p_g^~y>, 
                                                                          '8', $exts>, 
                                                                         '13', '0', $certificate_extensions>, 
                                                                        '11', '0', pk(~ltkS)>, 
                                                                       '15', 
                                                                       sign(<'server_cv', 
                                                                             h(<
                                                                                <
                                                                                 <
                                                                                  <
                                                                                   <
                                                                                    <p_messages, '6', 
                                                                                     '0x0303', '40', $p_g>, 
                                                                                    '1', '0x0303', p_nc, '0', 
                                                                                    $cipher_suites, '0', 
                                                                                    <'43', '0x0304'>, 
                                                                                    <'10', $g1, $g2>, 
                                                                                    <'40', $p_g, p_gx>, 
                                                                                    <'45', '0', '1'>, p_edi, 
                                                                                    '41', 
                                                                                    <~ticket, mask(x, x.1)>, 
                                                                                    hmac(<
                                                                                          Expand(Expand(Extract(~res_psk,
                                                                                                                '0'),
                                                                                                        <
                                                                                                         'ext', 
                                                                                                         'pbk'
                                                                                                        >,
                                                                                                        '32'),
                                                                                                 <'0', '0'>,
                                                                                                 '32'), 
                                                                                          h(<
                                                                                             <p_messages, 
                                                                                              '6', '0x0303', 
                                                                                              '40', $p_g>, 
                                                                                             '1', '0x0303', 
                                                                                             p_nc, '0', 
                                                                                             $cipher_suites, 
                                                                                             '0', 
                                                                                             <'43', '0x0304'
                                                                                             >, 
                                                                                             <'10', $g1, $g2
                                                                                             >, 
                                                                                             <'40', $p_g, p_gx
                                                                                             >, 
                                                                                             <'45', '0', '1'
                                                                                             >, 
                                                                                             p_edi, '41', 
                                                                                             <~ticket, 
                                                                                              mask(x, x.1)>, 
                                                                                             '0'>)
                                                                                         >)
                                                                                   >, 
                                                                                   '2', '0x0303', ~ns, 
                                                                                   $cipher_suite, 
                                                                                   <'13', $sig_algs>, '40', 
                                                                                   $p_g, $p_g^~y>, 
                                                                                  '8', $exts>, 
                                                                                 '13', '0', 
                                                                                 $certificate_extensions>, 
                                                                                '11', '0', pk(~ltkS)>)
                                                                            >,
                                                                            ~ltkS)
                                                                      >)
                                                                   >,
                                                                   '32'),
                                                            <'fin', '0'>, '32'), 
                                                     h(<
                                                        <
                                                         <
                                                          <
                                                           <
                                                            <<p_messages, '6', '0x0303', '40', $p_g>, '1', 
                                                             '0x0303', p_nc, '0', $cipher_suites, '0', 
                                                             <'43', '0x0304'>, <'10', $g1, $g2>, 
                                                             <'40', $p_g, p_gx>, <'45', '0', '1'>, p_edi, 
                                                             '41', <~ticket, mask(x, x.1)>, 
                                                             hmac(<
                                                                   Expand(Expand(Extract(~res_psk, '0'),
                                                                                 <'ext', 'pbk'>, '32'),
                                                                          <'0', '0'>, '32'), 
                                                                   h(<
                                                                      <p_messages, '6', '0x0303', '40', $p_g
                                                                      >, 
                                                                      '1', '0x0303', p_nc, '0', 
                                                                      $cipher_suites, '0', <'43', '0x0304'>, 
                                                                      <'10', $g1, $g2>, <'40', $p_g, p_gx>, 
                                                                      <'45', '0', '1'>, p_edi, '41', 
                                                                      <~ticket, mask(x, x.1)>, '0'>)
                                                                  >)
                                                            >, 
                                                            '2', '0x0303', ~ns, $cipher_suite, 
                                                            <'13', $sig_algs>, '40', $p_g, $p_g^~y>, 
                                                           '8', $exts>, 
                                                          '13', '0', $certificate_extensions>, 
                                                         '11', '0', pk(~ltkS)>, 
                                                        '15', 
                                                        sign(<'server_cv', 
                                                              h(<
                                                                 <
                                                                  <
                                                                   <
                                                                    <<p_messages, '6', '0x0303', '40', $p_g>, 
                                                                     '1', '0x0303', p_nc, '0', 
                                                                     $cipher_suites, '0', <'43', '0x0304'>, 
                                                                     <'10', $g1, $g2>, <'40', $p_g, p_gx>, 
                                                                     <'45', '0', '1'>, p_edi, '41', 
                                                                     <~ticket, mask(x, x.1)>, 
                                                                     hmac(<
                                                                           Expand(Expand(Extract(~res_psk,
                                                                                                 '0'),
                                                                                         <'ext', 'pbk'>,
                                                                                         '32'),
                                                                                  <'0', '0'>, '32'), 
                                                                           h(<
                                                                              <p_messages, '6', '0x0303', 
                                                                               '40', $p_g>, 
                                                                              '1', '0x0303', p_nc, '0', 
                                                                              $cipher_suites, '0', 
                                                                              <'43', '0x0304'>, 
                                                                              <'10', $g1, $g2>, 
                                                                              <'40', $p_g, p_gx>, 
                                                                              <'45', '0', '1'>, p_edi, '41', 
                                                                              <~ticket, mask(x, x.1)>, '0'>)
                                                                          >)
                                                                    >, 
                                                                    '2', '0x0303', ~ns, $cipher_suite, 
                                                                    <'13', $sig_algs>, '40', $p_g, $p_g^~y>, 
                                                                   '8', $exts>, 
                                                                  '13', '0', $certificate_extensions>, 
                                                                 '11', '0', pk(~ltkS)>)
                                                             >,
                                                             ~ltkS)
                                                       >)
                                                    >)
                                              >)
                                           >,
                                           '32'),
                                    <'adke_wk', '0'>, '32')
                  ) ▶₀ #l )
      qed
    next
      case server_auth_case_06
      solve( !Pk( $C, pk(~ltkC) ) ▶₁ #i )
        case Register_pk
        by solve( SecretPSK( $A,
                             Expand(Expand(Extract('0',
                                                   Extract(p_gxy,
                                                           Extract(Expand(ms, <'rms', h(messages)>, '32'),
                                                                   '0'))),
                                           <'clientats', 
                                            h(<
                                               <
                                                <
                                                 <
                                                  <
                                                   <
                                                    <<p_messages, '6', '0x0303', '40', $p_g>, '1', '0x0303', 
                                                     p_nc, '0', $cipher_suites, '0', <'43', '0x0304'>, 
                                                     <'10', $g1, $g2>, <'40', $p_g, p_gx>, <'45', '0', '1'>, 
                                                     p_edi, '41', <~ticket, mask(x, x.1)>, 
                                                     hmac(<
                                                           Expand(Expand(Extract(Expand(ms,
                                                                                        <'rms', h(messages)>,
                                                                                        '32'),
                                                                                 '0'),
                                                                         <'res', 'pbk'>, '32'),
                                                                  <'0', '0'>, '32'), 
                                                           h(<<p_messages, '6', '0x0303', '40', $p_g>, '1', 
                                                              '0x0303', p_nc, '0', $cipher_suites, '0', 
                                                              <'43', '0x0304'>, <'10', $g1, $g2>, 
                                                              <'40', $p_g, p_gx>, <'45', '0', '1'>, p_edi, 
                                                              '41', <~ticket, mask(x, x.1)>, '0'>)
                                                          >)
                                                    >, 
                                                    '2', '0x0303', ~ns, $cipher_suite, <'13', $sig_algs>, 
                                                    '40', $p_g, $p_g^~y>, 
                                                   '8', $exts>, 
                                                  '13', '0', $certificate_extensions>, 
                                                 '11', '0', pk(~ltkS)>, 
                                                '15', 
                                                sign(<'server_cv', 
                                                      h(<
                                                         <
                                                          <
                                                           <
                                                            <<p_messages, '6', '0x0303', '40', $p_g>, '1', 
                                                             '0x0303', p_nc, '0', $cipher_suites, '0', 
                                                             <'43', '0x0304'>, <'10', $g1, $g2>, 
                                                             <'40', $p_g, p_gx>, <'45', '0', '1'>, p_edi, 
                                                             '41', <~ticket, mask(x, x.1)>, 
                                                             hmac(<
                                                                   Expand(Expand(Extract(Expand(ms,
                                                                                                <'rms', 
                                                                                                 h(messages)>,
                                                                                                '32'),
                                                                                         '0'),
                                                                                 <'res', 'pbk'>, '32'),
                                                                          <'0', '0'>, '32'), 
                                                                   h(<
                                                                      <p_messages, '6', '0x0303', '40', $p_g
                                                                      >, 
                                                                      '1', '0x0303', p_nc, '0', 
                                                                      $cipher_suites, '0', <'43', '0x0304'>, 
                                                                      <'10', $g1, $g2>, <'40', $p_g, p_gx>, 
                                                                      <'45', '0', '1'>, p_edi, '41', 
                                                                      <~ticket, mask(x, x.1)>, '0'>)
                                                                  >)
                                                            >, 
                                                            '2', '0x0303', ~ns, $cipher_suite, 
                                                            <'13', $sig_algs>, '40', $p_g, $p_g^~y>, 
                                                           '8', $exts>, 
                                                          '13', '0', $certificate_extensions>, 
                                                         '11', '0', pk(~ltkS)>)
                                                     >,
                                                     ~ltkS)
                                               >, 
                                               '20', 
                                               hmac(<
                                                     Expand(Expand(Extract(p_gxy,
                                                                           Extract(Expand(ms,
                                                                                          <'rms', h(messages)
                                                                                          >,
                                                                                          '32'),
                                                                                   '0')),
                                                                   <'serverhts', 
                                                                    h(<
                                                                       <
                                                                        <
                                                                         <
                                                                          <
                                                                           <
                                                                            <p_messages, '6', '0x0303', '40', 
                                                                             $p_g>, 
                                                                            '1', '0x0303', p_nc, '0', 
                                                                            $cipher_suites, '0', 
                                                                            <'43', '0x0304'>, 
                                                                            <'10', $g1, $g2>, 
                                                                            <'40', $p_g, p_gx>, 
                                                                            <'45', '0', '1'>, p_edi, '41', 
                                                                            <~ticket, mask(x, x.1)>, 
                                                                            hmac(<
                                                                                  Expand(Expand(Extract(Expand(ms,
                                                                                                               <
                                                                                                                'rms', 
                                                                                                                h(messages)
                                                                                                               >,
                                                                                                               '32'),
                                                                                                        '0'),
                                                                                                <'res', 'pbk'
                                                                                                >,
                                                                                                '32'),
                                                                                         <'0', '0'>, '32'), 
                                                                                  h(<
                                                                                     <p_messages, '6', 
                                                                                      '0x0303', '40', $p_g>, 
                                                                                     '1', '0x0303', p_nc, 
                                                                                     '0', $cipher_suites, 
                                                                                     '0', <'43', '0x0304'>, 
                                                                                     <'10', $g1, $g2>, 
                                                                                     <'40', $p_g, p_gx>, 
                                                                                     <'45', '0', '1'>, p_edi, 
                                                                                     '41', 
                                                                                     <~ticket, mask(x, x.1)>, 
                                                                                     '0'>)
                                                                                 >)
                                                                           >, 
                                                                           '2', '0x0303', ~ns, $cipher_suite, 
                                                                           <'13', $sig_algs>, '40', $p_g, 
                                                                           $p_g^~y>, 
                                                                          '8', $exts>, 
                                                                         '13', '0', $certificate_extensions>, 
                                                                        '11', '0', pk(~ltkS)>, 
                                                                       '15', 
                                                                       sign(<'server_cv', 
                                                                             h(<
                                                                                <
                                                                                 <
                                                                                  <
                                                                                   <
                                                                                    <p_messages, '6', 
                                                                                     '0x0303', '40', $p_g>, 
                                                                                    '1', '0x0303', p_nc, '0', 
                                                                                    $cipher_suites, '0', 
                                                                                    <'43', '0x0304'>, 
                                                                                    <'10', $g1, $g2>, 
                                                                                    <'40', $p_g, p_gx>, 
                                                                                    <'45', '0', '1'>, p_edi, 
                                                                                    '41', 
                                                                                    <~ticket, mask(x, x.1)>, 
                                                                                    hmac(<
                                                                                          Expand(Expand(Extract(Expand(ms,
                                                                                                                       <
                                                                                                                        'rms', 
                                                                                                                        h(messages)
                                                                                                                       >,
                                                                                                                       '32'),
                                                                                                                '0'),
                                                                                                        <
                                                                                                         'res', 
                                                                                                         'pbk'
                                                                                                        >,
                                                                                                        '32'),
                                                                                                 <'0', '0'>,
                                                                                                 '32'), 
                                                                                          h(<
                                                                                             <p_messages, 
                                                                                              '6', '0x0303', 
                                                                                              '40', $p_g>, 
                                                                                             '1', '0x0303', 
                                                                                             p_nc, '0', 
                                                                                             $cipher_suites, 
                                                                                             '0', 
                                                                                             <'43', '0x0304'
                                                                                             >, 
                                                                                             <'10', $g1, $g2
                                                                                             >, 
                                                                                             <'40', $p_g, p_gx
                                                                                             >, 
                                                                                             <'45', '0', '1'
                                                                                             >, 
                                                                                             p_edi, '41', 
                                                                                             <~ticket, 
                                                                                              mask(x, x.1)>, 
                                                                                             '0'>)
                                                                                         >)
                                                                                   >, 
                                                                                   '2', '0x0303', ~ns, 
                                                                                   $cipher_suite, 
                                                                                   <'13', $sig_algs>, '40', 
                                                                                   $p_g, $p_g^~y>, 
                                                                                  '8', $exts>, 
                                                                                 '13', '0', 
                                                                                 $certificate_extensions>, 
                                                                                '11', '0', pk(~ltkS)>)
                                                                            >,
                                                                            ~ltkS)
                                                                      >)
                                                                   >,
                                                                   '32'),
                                                            <'fin', '0'>, '32'), 
                                                     h(<
                                                        <
                                                         <
                                                          <
                                                           <
                                                            <<p_messages, '6', '0x0303', '40', $p_g>, '1', 
                                                             '0x0303', p_nc, '0', $cipher_suites, '0', 
                                                             <'43', '0x0304'>, <'10', $g1, $g2>, 
                                                             <'40', $p_g, p_gx>, <'45', '0', '1'>, p_edi, 
                                                             '41', <~ticket, mask(x, x.1)>, 
                                                             hmac(<
                                                                   Expand(Expand(Extract(Expand(ms,
                                                                                                <'rms', 
                                                                                                 h(messages)>,
                                                                                                '32'),
                                                                                         '0'),
                                                                                 <'res', 'pbk'>, '32'),
                                                                          <'0', '0'>, '32'), 
                                                                   h(<
                                                                      <p_messages, '6', '0x0303', '40', $p_g
                                                                      >, 
                                                                      '1', '0x0303', p_nc, '0', 
                                                                      $cipher_suites, '0', <'43', '0x0304'>, 
                                                                      <'10', $g1, $g2>, <'40', $p_g, p_gx>, 
                                                                      <'45', '0', '1'>, p_edi, '41', 
                                                                      <~ticket, mask(x, x.1)>, '0'>)
                                                                  >)
                                                            >, 
                                                            '2', '0x0303', ~ns, $cipher_suite, 
                                                            <'13', $sig_algs>, '40', $p_g, $p_g^~y>, 
                                                           '8', $exts>, 
                                                          '13', '0', $certificate_extensions>, 
                                                         '11', '0', pk(~ltkS)>, 
                                                        '15', 
                                                        sign(<'server_cv', 
                                                              h(<
                                                                 <
                                                                  <
                                                                   <
                                                                    <<p_messages, '6', '0x0303', '40', $p_g>, 
                                                                     '1', '0x0303', p_nc, '0', 
                                                                     $cipher_suites, '0', <'43', '0x0304'>, 
                                                                     <'10', $g1, $g2>, <'40', $p_g, p_gx>, 
                                                                     <'45', '0', '1'>, p_edi, '41', 
                                                                     <~ticket, mask(x, x.1)>, 
                                                                     hmac(<
                                                                           Expand(Expand(Extract(Expand(ms,
                                                                                                        <
                                                                                                         'rms', 
                                                                                                         h(messages)
                                                                                                        >,
                                                                                                        '32'),
                                                                                                 '0'),
                                                                                         <'res', 'pbk'>,
                                                                                         '32'),
                                                                                  <'0', '0'>, '32'), 
                                                                           h(<
                                                                              <p_messages, '6', '0x0303', 
                                                                               '40', $p_g>, 
                                                                              '1', '0x0303', p_nc, '0', 
                                                                              $cipher_suites, '0', 
                                                                              <'43', '0x0304'>, 
                                                                              <'10', $g1, $g2>, 
                                                                              <'40', $p_g, p_gx>, 
                                                                              <'45', '0', '1'>, p_edi, '41', 
                                                                              <~ticket, mask(x, x.1)>, '0'>)
                                                                          >)
                                                                    >, 
                                                                    '2', '0x0303', ~ns, $cipher_suite, 
                                                                    <'13', $sig_algs>, '40', $p_g, $p_g^~y>, 
                                                                   '8', $exts>, 
                                                                  '13', '0', $certificate_extensions>, 
                                                                 '11', '0', pk(~ltkS)>)
                                                             >,
                                                             ~ltkS)
                                                       >)
                                                    >)
                                              >)
                                           >,
                                           '32'),
                                    <'adke_wk', '0'>, '32')
                  ) ▶₀ #l )
      qed
    next
      case server_auth_case_07
      by contradiction /* from formulas */
    next
      case server_auth_case_08
      by contradiction /* from formulas */
    next
      case server_auth_case_09
      by contradiction /* from formulas */
    next
      case server_auth_case_10
      by contradiction /* from formulas */
    next
      case server_auth_case_11
      by contradiction /* from formulas */
    next
      case server_auth_case_12
      by contradiction /* from formulas */
    qed
  qed
qed

lemma unique_session_keys:
  all-traces
  "∀ tid tid2 actor peer peer2 kr kw as as2 #i #j.
    ((SessionKey( tid, actor, peer, as, <kr, kw> ) @ #i) ∧
     (SessionKey( tid2, actor, peer2, as2, <kr, kw> ) @ #j)) ⇒
    (#i = #j)"
/*
guarded formula characterizing all counter-examples:
"∃ tid tid2 actor peer peer2 kr kw as as2 #i #j.
  (SessionKey( tid, actor, peer, as, <kr, kw> ) @ #i) ∧
  (SessionKey( tid2, actor, peer2, as2, <kr, kw> ) @ #j)
 ∧
  ¬(#i = #j)"
*/
by sorry

lemma consistent_nonces [reuse]:
  all-traces
  "∀ tid actor role nonces #i.
    (CNonces( tid, actor, role, nonces ) @ #i) ⇒
    (∃ #j. RNonces( tid, actor, role, nonces ) @ #j)"
/*
guarded formula characterizing all counter-examples:
"∃ tid actor role nonces #i.
  (CNonces( tid, actor, role, nonces ) @ #i)
 ∧
  ∀ #j. (RNonces( tid, actor, role, nonces ) @ #j) ⇒ ⊥"
*/
by sorry

lemma auth_psk [reuse, use_induction, hide_lemma=posths_rms_weak]:
  all-traces
  "∀ tid tid2 actor actor2 role role2 peer peer2 rms messages aas #i #j #k.
    ((((RRMS( tid, actor, role, <peer2, rms, messages> ) @ #i) ∧
       (RRMS( tid2, peer, role2, <actor2, rms, messages> ) @ #j)) ∧
      (CIdentity( tid, actor, role, <peer2, aas, 'auth'> ) @ #k)) ∧
     (¬(role = role2))) ⇒
    ((peer2 = peer) ∨ (∃ #r. (RevLtk( peer2 ) @ #r) ∧ (#r < #k)))"
/*
guarded formula characterizing all counter-examples:
"∃ tid tid2 actor actor2 role role2 peer peer2 rms messages aas #i #j #k.
  (RRMS( tid, actor, role, <peer2, rms, messages> ) @ #i) ∧
  (RRMS( tid2, peer, role2, <actor2, rms, messages> ) @ #j) ∧
  (CIdentity( tid, actor, role, <peer2, aas, 'auth'> ) @ #k)
 ∧
  (¬(role = role2)) ∧
  (¬(peer2 = peer)) ∧
  (∀ #r. (RevLtk( peer2 ) @ #r) ⇒ ¬(#r < #k))"
*/
by sorry

lemma entity_authentication [reuse, use_induction]:
  all-traces
  "∀ tid actor peer nonces cas #i.
    (((((((CNonces( tid, actor, 'client', nonces ) @ #i) ∧
          (CIdentity( tid, actor, 'client', <peer, cas, 'auth'> ) @ #i)) ∧
         (¬(∃ #r. (RevLtk( peer ) @ #r) ∧ (#r < #i)))) ∧
        (¬(∃ tid3 x #r. (RevDHExp( tid3, peer, x ) @ #r) ∧ (#r < #i)))) ∧
       (¬(∃ tid4 y #r. (RevDHExp( tid4, actor, y ) @ #r) ∧ (#r < #i)))) ∧
      (¬(∃ rms #r. RevealPSK( actor, rms ) @ #r))) ∧
     (¬(∃ rms #r. RevealPSK( peer, rms ) @ #r))) ⇒
    (∃ tid2 #j. (RNonces( tid2, peer, 'server', nonces ) @ #j) ∧ (#j < #i))"
/*
guarded formula characterizing all counter-examples:
"∃ tid actor peer nonces cas #i.
  (CNonces( tid, actor, 'client', nonces ) @ #i) ∧
  (CIdentity( tid, actor, 'client', <peer, cas, 'auth'> ) @ #i)
 ∧
  (∀ #r. (RevLtk( peer ) @ #r) ⇒ ¬(#r < #i)) ∧
  (∀ tid3 x #r. (RevDHExp( tid3, peer, x ) @ #r) ⇒ ¬(#r < #i)) ∧
  (∀ tid4 y #r. (RevDHExp( tid4, actor, y ) @ #r) ⇒ ¬(#r < #i)) ∧
  (∀ rms #r. (RevealPSK( actor, rms ) @ #r) ⇒ ⊥) ∧
  (∀ rms #r. (RevealPSK( peer, rms ) @ #r) ⇒ ⊥) ∧
  (∀ tid2 #j. (RNonces( tid2, peer, 'server', nonces ) @ #j) ⇒ ¬(#j < #i))"
*/
by sorry

lemma transcript_agreement [reuse]:
  all-traces
  "∀ tid actor peer transcript cas #i.
    (((((((CTranscript( tid, actor, 'client', transcript ) @ #i) ∧
          (CIdentity( tid, actor, 'client', <peer, cas, 'auth'> ) @ #i)) ∧
         (¬(∃ #r. (RevLtk( peer ) @ #r) ∧ (#r < #i)))) ∧
        (¬(∃ tid3 x #r. (RevDHExp( tid3, peer, x ) @ #r) ∧ (#r < #i)))) ∧
       (¬(∃ tid4 y #r. (RevDHExp( tid4, actor, y ) @ #r) ∧ (#r < #i)))) ∧
      (¬(∃ rms #r. RevealPSK( actor, rms ) @ #r))) ∧
     (¬(∃ rms #r. RevealPSK( peer, rms ) @ #r))) ⇒
    (∃ tid2 #j.
      (RTranscript( tid2, peer, 'server', transcript ) @ #j) ∧ (#j < #i))"
/*
guarded formula characterizing all counter-examples:
"∃ tid actor peer transcript cas #i.
  (CTranscript( tid, actor, 'client', transcript ) @ #i) ∧
  (CIdentity( tid, actor, 'client', <peer, cas, 'auth'> ) @ #i)
 ∧
  (∀ #r. (RevLtk( peer ) @ #r) ⇒ ¬(#r < #i)) ∧
  (∀ tid3 x #r. (RevDHExp( tid3, peer, x ) @ #r) ⇒ ¬(#r < #i)) ∧
  (∀ tid4 y #r. (RevDHExp( tid4, actor, y ) @ #r) ⇒ ¬(#r < #i)) ∧
  (∀ rms #r. (RevealPSK( actor, rms ) @ #r) ⇒ ⊥) ∧
  (∀ rms #r. (RevealPSK( peer, rms ) @ #r) ⇒ ⊥) ∧
  (∀ tid2 #j.
    (RTranscript( tid2, peer, 'server', transcript ) @ #j) ⇒ ¬(#j < #i))"
*/
by sorry

lemma mutual_entity_authentication [reuse, use_induction]:
  all-traces
  "∀ tid actor peer nonces #i.
    (((((((CNonces( tid, actor, 'server', nonces ) @ #i) ∧
          (CIdentity( tid, actor, 'server', <peer, 'auth', 'auth'> ) @ #i)) ∧
         (¬(∃ #r. (RevLtk( peer ) @ #r) ∧ (#r < #i)))) ∧
        (¬(∃ tid3 x #r. (RevDHExp( tid3, peer, x ) @ #r) ∧ (#r < #i)))) ∧
       (¬(∃ tid4 y #r. (RevDHExp( tid4, actor, y ) @ #r) ∧ (#r < #i)))) ∧
      (¬(∃ rms #r. RevealPSK( actor, rms ) @ #r))) ∧
     (¬(∃ rms #r. RevealPSK( peer, rms ) @ #r))) ⇒
    (∃ tid2 #j. (RNonces( tid2, peer, 'client', nonces ) @ #j) ∧ (#j < #i))"
/*
guarded formula characterizing all counter-examples:
"∃ tid actor peer nonces #i.
  (CNonces( tid, actor, 'server', nonces ) @ #i) ∧
  (CIdentity( tid, actor, 'server', <peer, 'auth', 'auth'> ) @ #i)
 ∧
  (∀ #r. (RevLtk( peer ) @ #r) ⇒ ¬(#r < #i)) ∧
  (∀ tid3 x #r. (RevDHExp( tid3, peer, x ) @ #r) ⇒ ¬(#r < #i)) ∧
  (∀ tid4 y #r. (RevDHExp( tid4, actor, y ) @ #r) ⇒ ¬(#r < #i)) ∧
  (∀ rms #r. (RevealPSK( actor, rms ) @ #r) ⇒ ⊥) ∧
  (∀ rms #r. (RevealPSK( peer, rms ) @ #r) ⇒ ⊥) ∧
  (∀ tid2 #j. (RNonces( tid2, peer, 'client', nonces ) @ #j) ⇒ ¬(#j < #i))"
*/
by sorry

lemma mutual_transcript_agreement [reuse]:
  all-traces
  "∀ tid actor transcript peer #i.
    (((((((CTranscript( tid, actor, 'server', transcript ) @ #i) ∧
          (CIdentity( tid, actor, 'server', <peer, 'auth', 'auth'> ) @ #i)) ∧
         (¬(∃ #r. (RevLtk( peer ) @ #r) ∧ (#r < #i)))) ∧
        (¬(∃ tid3 x #r. (RevDHExp( tid3, peer, x ) @ #r) ∧ (#r < #i)))) ∧
       (¬(∃ tid4 y #r. (RevDHExp( tid4, actor, y ) @ #r) ∧ (#r < #i)))) ∧
      (¬(∃ rms #r. RevealPSK( actor, rms ) @ #r))) ∧
     (¬(∃ rms #r. RevealPSK( peer, rms ) @ #r))) ⇒
    (∃ tid2 #j.
      (RTranscript( tid2, peer, 'client', transcript ) @ #j) ∧ (#j < #i))"
/*
guarded formula characterizing all counter-examples:
"∃ tid actor transcript peer #i.
  (CTranscript( tid, actor, 'server', transcript ) @ #i) ∧
  (CIdentity( tid, actor, 'server', <peer, 'auth', 'auth'> ) @ #i)
 ∧
  (∀ #r. (RevLtk( peer ) @ #r) ⇒ ¬(#r < #i)) ∧
  (∀ tid3 x #r. (RevDHExp( tid3, peer, x ) @ #r) ⇒ ¬(#r < #i)) ∧
  (∀ tid4 y #r. (RevDHExp( tid4, actor, y ) @ #r) ⇒ ¬(#r < #i)) ∧
  (∀ rms #r. (RevealPSK( actor, rms ) @ #r) ⇒ ⊥) ∧
  (∀ rms #r. (RevealPSK( peer, rms ) @ #r) ⇒ ⊥) ∧
  (∀ tid2 #j.
    (RTranscript( tid2, peer, 'client', transcript ) @ #j) ⇒ ¬(#j < #i))"
*/
by sorry

lemma injective_mutual_entity_authentication [reuse, use_induction]:
  all-traces
  "∀ tid actor peer role nonces aas #i.
    (((((((CNonces( tid, actor, role, nonces ) @ #i) ∧
          (CIdentity( tid, actor, role, <peer, aas, 'auth'> ) @ #i)) ∧
         (¬(∃ #r. (RevLtk( peer ) @ #r) ∧ (#r < #i)))) ∧
        (¬(∃ tid3 x #r. (RevDHExp( tid3, peer, x ) @ #r) ∧ (#r < #i)))) ∧
       (¬(∃ tid4 y #r. (RevDHExp( tid4, actor, y ) @ #r) ∧ (#r < #i)))) ∧
      (¬(∃ rms #r. RevealPSK( actor, rms ) @ #r))) ∧
     (¬(∃ rms #r. RevealPSK( peer, rms ) @ #r))) ⇒
    (∃ role2 tid2 #j.
      (((RNonces( tid2, peer, role2, nonces ) @ #j) ∧ (#j < #i)) ∧
       (¬(role = role2))) ∧
      (∀ tid3 peer2 #k.
        (RNonces( tid3, peer2, role2, nonces ) @ #k) ⇒ (#k = #j)))"
/*
guarded formula characterizing all counter-examples:
"∃ tid actor peer role nonces aas #i.
  (CNonces( tid, actor, role, nonces ) @ #i) ∧
  (CIdentity( tid, actor, role, <peer, aas, 'auth'> ) @ #i)
 ∧
  (∀ #r. (RevLtk( peer ) @ #r) ⇒ ¬(#r < #i)) ∧
  (∀ tid3 x #r. (RevDHExp( tid3, peer, x ) @ #r) ⇒ ¬(#r < #i)) ∧
  (∀ tid4 y #r. (RevDHExp( tid4, actor, y ) @ #r) ⇒ ¬(#r < #i)) ∧
  (∀ rms #r. (RevealPSK( actor, rms ) @ #r) ⇒ ⊥) ∧
  (∀ rms #r. (RevealPSK( peer, rms ) @ #r) ⇒ ⊥) ∧
  (∀ role2 tid2 #j.
    (RNonces( tid2, peer, role2, nonces ) @ #j)
   ⇒
    ((¬(#j < #i)) ∨
     (role = role2) ∨
     (∃ tid3 peer2 #k.
       (RNonces( tid3, peer2, role2, nonces ) @ #k) ∧ ¬(#k = #j))))"
*/
by sorry

lemma session_key_agreement:
  all-traces
  "∀ tid tid2 actor peer actor2 peer2 nonces keys keys2 as as2 #i #j #k #l.
    (((((((((SessionKey( tid, actor, peer2, as, keys ) @ #i) ∧
            (RNonces( tid, actor, 'client', nonces ) @ #j)) ∧
           (SessionKey( tid2, peer, actor2, as2, keys2 ) @ #k)) ∧
          (RNonces( tid2, peer, 'server', nonces ) @ #l)) ∧
         (¬(∃ #r. ((RevLtk( peer ) @ #r) ∧ (#r < #i)) ∧ (#r < #k)))) ∧
        (¬(∃ tid3 x #r.
            ((RevDHExp( tid3, peer, x ) @ #r) ∧ (#r < #i)) ∧ (#r < #k)))) ∧
       (¬(∃ tid4 y #r.
           ((RevDHExp( tid4, actor, y ) @ #r) ∧ (#r < #i)) ∧ (#r < #k)))) ∧
      (¬(∃ rms #r.
          ((RevealPSK( actor, rms ) @ #r) ∧ (#r < #i)) ∧ (#r < #k)))) ∧
     (¬(∃ rms #r. ((RevealPSK( peer, rms ) @ #r) ∧ (#r < #i)) ∧ (#r < #k)))) ⇒
    (keys = keys2)"
/*
guarded formula characterizing all counter-examples:
"∃ tid tid2 actor peer actor2 peer2 nonces keys keys2 as as2 #i #j #k #l.
  (SessionKey( tid, actor, peer2, as, keys ) @ #i) ∧
  (RNonces( tid, actor, 'client', nonces ) @ #j) ∧
  (SessionKey( tid2, peer, actor2, as2, keys2 ) @ #k) ∧
  (RNonces( tid2, peer, 'server', nonces ) @ #l)
 ∧
  (∀ #r. (RevLtk( peer ) @ #r) ⇒ ((¬(#r < #i)) ∨ (¬(#r < #k)))) ∧
  (∀ tid3 x #r.
    (RevDHExp( tid3, peer, x ) @ #r) ⇒ ((¬(#r < #i)) ∨ (¬(#r < #k)))) ∧
  (∀ tid4 y #r.
    (RevDHExp( tid4, actor, y ) @ #r) ⇒ ((¬(#r < #i)) ∨ (¬(#r < #k)))) ∧
  (∀ rms #r.
    (RevealPSK( actor, rms ) @ #r) ⇒ ((¬(#r < #i)) ∨ (¬(#r < #k)))) ∧
  (∀ rms #r.
    (RevealPSK( peer, rms ) @ #r) ⇒ ((¬(#r < #i)) ∨ (¬(#r < #k)))) ∧
  (¬(keys = keys2))"
*/
by sorry

/* All well-formedness checks were successful. */

end
